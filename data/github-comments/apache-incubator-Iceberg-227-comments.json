[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410869692","html_url":"https://github.com/apache/iceberg/pull/6695#issuecomment-1410869692","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6695","id":1410869692,"node_id":"IC_kwDOCW7NX85UGCm8","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-31T18:24:43Z","updated_at":"2023-01-31T18:24:43Z","author_association":"CONTRIBUTOR","body":"I should be able to take a look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410869692/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410876532","html_url":"https://github.com/apache/iceberg/pull/6695#issuecomment-1410876532","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6695","id":1410876532,"node_id":"IC_kwDOCW7NX85UGER0","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-31T18:30:46Z","updated_at":"2023-01-31T18:30:46Z","author_association":"CONTRIBUTOR","body":"The change makes sense but we must be able to rewrite large manifests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410876532/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410923876","html_url":"https://github.com/apache/iceberg/pull/6090#issuecomment-1410923876","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6090","id":1410923876,"node_id":"IC_kwDOCW7NX85UGP1k","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-31T19:10:49Z","updated_at":"2023-01-31T19:10:49Z","author_association":"CONTRIBUTOR","body":"Thanks, @ajantha-bhat! I made some comments in tests to fix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410923876/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410945521","html_url":"https://github.com/apache/iceberg/issues/6679#issuecomment-1410945521","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6679","id":1410945521,"node_id":"IC_kwDOCW7NX85UGVHx","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-31T19:26:37Z","updated_at":"2023-01-31T19:26:37Z","author_association":"CONTRIBUTOR","body":"I would be careful with `range` as it may cause performance regressions. Especially, for MERGE. The range distribution requires sampling that leads to double scanning and re-evaluating of particular nodes in the plan. This will cause the same issues we have today where the default would perform poorly. \r\n\r\nThe upcoming Spark 3.4 has support for rebalancing partitions via AQE for hash distributions requested by v2 writes. That means, we can request a hash distribution without worrying about having too much data per task and OOM. I'd rather switch to `hash` as default and let users configure if it fails. I don't know a single use case where the range distribution performs well in MERGE at any reasonable scale.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410945521/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410946484","html_url":"https://github.com/apache/iceberg/pull/6432#issuecomment-1410946484","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6432","id":1410946484,"node_id":"IC_kwDOCW7NX85UGVW0","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-31T19:27:28Z","updated_at":"2023-01-31T19:29:58Z","author_association":"CONTRIBUTOR","body":"The changes look good, but Spark OOMed. I kicked off the tests to run again. This could be something to fix since the parallelism will require copying delete positions. I don't think this would cause a problem, but we'll see if tests are consistently broken.\r\n\r\nThanks for your work here, @rbalamohan! Good to have this progressing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410946484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410949529","html_url":"https://github.com/apache/iceberg/pull/6683#issuecomment-1410949529","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6683","id":1410949529,"node_id":"IC_kwDOCW7NX85UGWGZ","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-31T19:30:13Z","updated_at":"2023-01-31T19:30:13Z","author_association":"CONTRIBUTOR","body":"I think we need a section showing examples we have in `TestSparkDistributionAndOrderingUtil` once we agree on #6679.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410949529/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410951836","html_url":"https://github.com/apache/iceberg/pull/6683#issuecomment-1410951836","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6683","id":1410951836,"node_id":"IC_kwDOCW7NX85UGWqc","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-31T19:32:15Z","updated_at":"2023-01-31T19:32:15Z","author_association":"CONTRIBUTOR","body":"I am going to merge this one for now. We can add a section about tradeoffs later.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410951836/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410952802","html_url":"https://github.com/apache/iceberg/pull/6683#issuecomment-1410952802","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6683","id":1410952802,"node_id":"IC_kwDOCW7NX85UGW5i","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-31T19:33:08Z","updated_at":"2023-01-31T19:33:08Z","author_association":"CONTRIBUTOR","body":"Thanks, @singhpk234! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410952802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410953886","html_url":"https://github.com/apache/iceberg/pull/6673#issuecomment-1410953886","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6673","id":1410953886,"node_id":"IC_kwDOCW7NX85UGXKe","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-31T19:34:08Z","updated_at":"2023-01-31T19:34:08Z","author_association":"CONTRIBUTOR","body":"Thanks, @Fokko! Nice work.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410953886/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410958514","html_url":"https://github.com/apache/iceberg/pull/6701#issuecomment-1410958514","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6701","id":1410958514,"node_id":"IC_kwDOCW7NX85UGYSy","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-31T19:38:26Z","updated_at":"2023-01-31T19:38:26Z","author_association":"CONTRIBUTOR","body":"The reason why this wasn't in the original spec is because we can technically update it by getting the highest assigned ID from the new schema. Because it didn't strictly need to be part of the spec here, we omitted it. Still, we send this in the actual implementation because it simplifies the server side.\r\n\r\nI'm ambivalent about whether we actually should include this in the spec. Keeping the spec simple is usually the best option. But I can see the argument for doing this. Maybe we should update the test service to no longer require the `last-column-id`.\r\n\r\nFYI @bryanck.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410958514/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410959675","html_url":"https://github.com/apache/iceberg/pull/5280#issuecomment-1410959675","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5280","id":1410959675,"node_id":"IC_kwDOCW7NX85UGYk7","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-31T19:39:28Z","updated_at":"2023-01-31T19:39:28Z","author_association":"CONTRIBUTOR","body":"Oops, I missed this PR and merged #6683 instead as that one popped up earlier in my feed. Sorry, @dramaticlly!\r\nI am going to close this one as that PR covers this.\r\n\r\nWe will need to add a section with examples from `TestSparkDistributionAndOrderingUtil` once #6679 is resolved.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410959675/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410960780","html_url":"https://github.com/apache/iceberg/issues/6679#issuecomment-1410960780","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6679","id":1410960780,"node_id":"IC_kwDOCW7NX85UGY2M","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-31T19:40:30Z","updated_at":"2023-01-31T19:40:30Z","author_association":"CONTRIBUTOR","body":"We have examples in `TestSparkDistributionAndOrderingUtil` that should become a section in the docs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410960780/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410962799","html_url":"https://github.com/apache/iceberg/pull/6696#issuecomment-1410962799","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6696","id":1410962799,"node_id":"IC_kwDOCW7NX85UGZVv","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-31T19:42:20Z","updated_at":"2023-01-31T19:42:20Z","author_association":"CONTRIBUTOR","body":"@ajantha-bhat, can you please run benchmarks to ensure there are no regressions?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410962799/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410979830","html_url":"https://github.com/apache/iceberg/pull/6682#issuecomment-1410979830","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6682","id":1410979830,"node_id":"IC_kwDOCW7NX85UGdf2","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-31T19:58:06Z","updated_at":"2023-01-31T19:58:06Z","author_association":"CONTRIBUTOR","body":"I am getting to this today, hopefully.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1410979830/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411019041","html_url":"https://github.com/apache/iceberg/pull/6653#issuecomment-1411019041","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6653","id":1411019041,"node_id":"IC_kwDOCW7NX85UGnEh","user":{"login":"deniskuzZ","id":2761528,"node_id":"MDQ6VXNlcjI3NjE1Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/2761528?v=4","gravatar_id":"","url":"https://api.github.com/users/deniskuzZ","html_url":"https://github.com/deniskuzZ","followers_url":"https://api.github.com/users/deniskuzZ/followers","following_url":"https://api.github.com/users/deniskuzZ/following{/other_user}","gists_url":"https://api.github.com/users/deniskuzZ/gists{/gist_id}","starred_url":"https://api.github.com/users/deniskuzZ/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deniskuzZ/subscriptions","organizations_url":"https://api.github.com/users/deniskuzZ/orgs","repos_url":"https://api.github.com/users/deniskuzZ/repos","events_url":"https://api.github.com/users/deniskuzZ/events{/privacy}","received_events_url":"https://api.github.com/users/deniskuzZ/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-31T20:26:58Z","updated_at":"2023-01-31T20:26:58Z","author_association":"MEMBER","body":"@Fokko could you please take a look","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411019041/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411097955","html_url":"https://github.com/apache/iceberg/issues/6667#issuecomment-1411097955","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6667","id":1411097955,"node_id":"IC_kwDOCW7NX85UG6Vj","user":{"login":"GabeChurch","id":31358000,"node_id":"MDQ6VXNlcjMxMzU4MDAw","avatar_url":"https://avatars.githubusercontent.com/u/31358000?v=4","gravatar_id":"","url":"https://api.github.com/users/GabeChurch","html_url":"https://github.com/GabeChurch","followers_url":"https://api.github.com/users/GabeChurch/followers","following_url":"https://api.github.com/users/GabeChurch/following{/other_user}","gists_url":"https://api.github.com/users/GabeChurch/gists{/gist_id}","starred_url":"https://api.github.com/users/GabeChurch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GabeChurch/subscriptions","organizations_url":"https://api.github.com/users/GabeChurch/orgs","repos_url":"https://api.github.com/users/GabeChurch/repos","events_url":"https://api.github.com/users/GabeChurch/events{/privacy}","received_events_url":"https://api.github.com/users/GabeChurch/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-31T21:33:36Z","updated_at":"2023-01-31T21:33:36Z","author_association":"NONE","body":"Closing as I found a workaround mentioned above. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411097955/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411251107","html_url":"https://github.com/apache/iceberg/issues/5356#issuecomment-1411251107","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5356","id":1411251107,"node_id":"IC_kwDOCW7NX85UHfuj","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T00:13:10Z","updated_at":"2023-02-01T00:13:10Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411251107/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411251195","html_url":"https://github.com/apache/iceberg/issues/5243#issuecomment-1411251195","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5243","id":1411251195,"node_id":"IC_kwDOCW7NX85UHfv7","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T00:13:15Z","updated_at":"2023-02-01T00:13:15Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411251195/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411314813","html_url":"https://github.com/apache/iceberg/pull/6703#issuecomment-1411314813","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6703","id":1411314813,"node_id":"IC_kwDOCW7NX85UHvR9","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T01:28:14Z","updated_at":"2023-02-01T01:28:14Z","author_association":"CONTRIBUTOR","body":"This PR needs a bit of TLC; it looks like the adlfs test also throws some warnings that we need to fix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411314813/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411351099","html_url":"https://github.com/apache/iceberg/issues/6708#issuecomment-1411351099","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6708","id":1411351099,"node_id":"IC_kwDOCW7NX85UH4I7","user":{"login":"zhangjiuyang1993","id":23301932,"node_id":"MDQ6VXNlcjIzMzAxOTMy","avatar_url":"https://avatars.githubusercontent.com/u/23301932?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjiuyang1993","html_url":"https://github.com/zhangjiuyang1993","followers_url":"https://api.github.com/users/zhangjiuyang1993/followers","following_url":"https://api.github.com/users/zhangjiuyang1993/following{/other_user}","gists_url":"https://api.github.com/users/zhangjiuyang1993/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjiuyang1993/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjiuyang1993/subscriptions","organizations_url":"https://api.github.com/users/zhangjiuyang1993/orgs","repos_url":"https://api.github.com/users/zhangjiuyang1993/repos","events_url":"https://api.github.com/users/zhangjiuyang1993/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjiuyang1993/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T02:13:53Z","updated_at":"2023-02-01T02:13:53Z","author_association":"NONE","body":"It works. Thanks a lot.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411351099/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411367934","html_url":"https://github.com/apache/iceberg/issues/6708#issuecomment-1411367934","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6708","id":1411367934,"node_id":"IC_kwDOCW7NX85UH8P-","user":{"login":"zhangjiuyang1993","id":23301932,"node_id":"MDQ6VXNlcjIzMzAxOTMy","avatar_url":"https://avatars.githubusercontent.com/u/23301932?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjiuyang1993","html_url":"https://github.com/zhangjiuyang1993","followers_url":"https://api.github.com/users/zhangjiuyang1993/followers","following_url":"https://api.github.com/users/zhangjiuyang1993/following{/other_user}","gists_url":"https://api.github.com/users/zhangjiuyang1993/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjiuyang1993/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjiuyang1993/subscriptions","organizations_url":"https://api.github.com/users/zhangjiuyang1993/orgs","repos_url":"https://api.github.com/users/zhangjiuyang1993/repos","events_url":"https://api.github.com/users/zhangjiuyang1993/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjiuyang1993/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T02:32:35Z","updated_at":"2023-02-01T02:32:35Z","author_association":"NONE","body":"While I run this command:\r\ndf = spark.read.parquet(\"/home/iceberg/data/yellow_tripdata_2021-04.parquet\")\r\ndf.write.saveAsTable(\"nyc.taxis\")\r\nIt occurs errors:\r\nERROR:root:Exception while sending command.                         (0 + 4) / 4]\r\nTraceback (most recent call last):\r\n  File \"/opt/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/clientserver.py\", line 516, in send_command\r\n    raise Py4JNetworkError(\"Answer from Java side is empty\")\r\npy4j.protocol.Py4JNetworkError: Answer from Java side is empty\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/opt/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/java_gateway.py\", line 1038, in send_command\r\n    response = connection.send_command(command)\r\n  File \"/opt/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/clientserver.py\", line 539, in send_command\r\n    raise Py4JNetworkError(\r\npy4j.protocol.Py4JNetworkError: Error while sending or receiving\r\nERROR:root:Exception while sending command.\r\nTraceback (most recent call last):\r\n  File \"/opt/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/clientserver.py\", line 516, in send_command\r\n    raise Py4JNetworkError(\"Answer from Java side is empty\")\r\npy4j.protocol.Py4JNetworkError: Answer from Java side is empty\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/opt/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/java_gateway.py\", line 1038, in send_command\r\n    response = connection.send_command(command)\r\n  File \"/opt/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/clientserver.py\", line 539, in send_command\r\n    raise Py4JNetworkError(\r\npy4j.protocol.Py4JNetworkError: Error while sending or receiving","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411367934/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411368041","html_url":"https://github.com/apache/iceberg/issues/6708#issuecomment-1411368041","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6708","id":1411368041,"node_id":"IC_kwDOCW7NX85UH8Rp","user":{"login":"zhangjiuyang1993","id":23301932,"node_id":"MDQ6VXNlcjIzMzAxOTMy","avatar_url":"https://avatars.githubusercontent.com/u/23301932?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjiuyang1993","html_url":"https://github.com/zhangjiuyang1993","followers_url":"https://api.github.com/users/zhangjiuyang1993/followers","following_url":"https://api.github.com/users/zhangjiuyang1993/following{/other_user}","gists_url":"https://api.github.com/users/zhangjiuyang1993/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjiuyang1993/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjiuyang1993/subscriptions","organizations_url":"https://api.github.com/users/zhangjiuyang1993/orgs","repos_url":"https://api.github.com/users/zhangjiuyang1993/repos","events_url":"https://api.github.com/users/zhangjiuyang1993/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjiuyang1993/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T02:32:47Z","updated_at":"2023-02-01T02:32:47Z","author_association":"NONE","body":"@nastra ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411368041/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411374328","html_url":"https://github.com/apache/iceberg/pull/6695#issuecomment-1411374328","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6695","id":1411374328,"node_id":"IC_kwDOCW7NX85UH9z4","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T02:43:13Z","updated_at":"2023-02-01T02:46:30Z","author_association":"MEMBER","body":"> The change makes sense but we must be able to rewrite large manifests.\r\n\r\n@aokolnychyi: Rewriting one big manifest into smaller manifests still works with this change and we have testcases for it. \r\nIt works because `targetNumManifests` will be more than one in that case. So, it won't enter the new code.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411374328/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411402841","html_url":"https://github.com/apache/iceberg/issues/6708#issuecomment-1411402841","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6708","id":1411402841,"node_id":"IC_kwDOCW7NX85UIExZ","user":{"login":"zhangjiuyang1993","id":23301932,"node_id":"MDQ6VXNlcjIzMzAxOTMy","avatar_url":"https://avatars.githubusercontent.com/u/23301932?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjiuyang1993","html_url":"https://github.com/zhangjiuyang1993","followers_url":"https://api.github.com/users/zhangjiuyang1993/followers","following_url":"https://api.github.com/users/zhangjiuyang1993/following{/other_user}","gists_url":"https://api.github.com/users/zhangjiuyang1993/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjiuyang1993/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjiuyang1993/subscriptions","organizations_url":"https://api.github.com/users/zhangjiuyang1993/orgs","repos_url":"https://api.github.com/users/zhangjiuyang1993/repos","events_url":"https://api.github.com/users/zhangjiuyang1993/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjiuyang1993/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T03:13:52Z","updated_at":"2023-02-01T03:13:52Z","author_association":"NONE","body":"Sometimes i run some sql scripts, the server occurs connection refusedï¼Œfor example:\r\n%%sql\r\n\r\nSELECT COUNT(*) as cnt\r\nFROM nyc.taxis\r\n\r\n---------------------------------------------------------------------------\r\nConnectionRefusedError                    Traceback (most recent call last)\r\nCell In[15], line 1\r\n----> 1 get_ipython().run_cell_magic('sql', '', '\\nSELECT COUNT(*) as cnt\\nFROM nyc.taxis\\n')\r\n\r\nFile /usr/local/lib/python3.9/site-packages/IPython/core/interactiveshell.py:2422, in InteractiveShell.run_cell_magic(self, magic_name, line, cell)\r\n   2420 with self.builtin_trap:\r\n   2421     args = (magic_arg_s, cell)\r\n-> 2422     result = fn(*args, **kwargs)\r\n   2423 return result\r\n\r\nFile ~/.ipython/profile_default/startup/00-prettytables.py:61, in sql(line, cell)\r\n     59         return _to_table(df, num_rows=args.limit)\r\n     60 else:\r\n---> 61     return _to_table(spark.sql(cell))\r\n\r\nFile /opt/spark/python/pyspark/sql/session.py:1034, in SparkSession.sql(self, sqlQuery, **kwargs)\r\n   1032     sqlQuery = formatter.format(sqlQuery, **kwargs)\r\n   1033 try:\r\n-> 1034     return DataFrame(self._jsparkSession.sql(sqlQuery), self)\r\n   1035 finally:\r\n   1036     if len(kwargs) > 0:\r\n\r\nFile /opt/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/java_gateway.py:1320, in JavaMember.__call__(self, *args)\r\n   1313 args_command, temp_args = self._build_args(*args)\r\n   1315 command = proto.CALL_COMMAND_NAME +\\\r\n   1316     self.command_header +\\\r\n   1317     args_command +\\\r\n   1318     proto.END_COMMAND_PART\r\n-> 1320 answer = self.gateway_client.send_command(command)\r\n   1321 return_value = get_return_value(\r\n   1322     answer, self.gateway_client, self.target_id, self.name)\r\n   1324 for temp_arg in temp_args:\r\n\r\nFile /opt/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/java_gateway.py:1036, in GatewayClient.send_command(self, command, retry, binary)\r\n   1015 def send_command(self, command, retry=True, binary=False):\r\n   1016     \"\"\"Sends a command to the JVM. This method is not intended to be\r\n   1017        called directly by Py4J users. It is usually called by\r\n   1018        :class:`JavaMember` instances.\r\n   (...)\r\n   1034      if `binary` is `True`.\r\n   1035     \"\"\"\r\n-> 1036     connection = self._get_connection()\r\n   1037     try:\r\n   1038         response = connection.send_command(command)\r\n\r\nFile /opt/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/clientserver.py:284, in JavaClient._get_connection(self)\r\n    281     pass\r\n    283 if connection is None or connection.socket is None:\r\n--> 284     connection = self._create_new_connection()\r\n    285 return connection\r\n\r\nFile /opt/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/clientserver.py:291, in JavaClient._create_new_connection(self)\r\n    287 def _create_new_connection(self):\r\n    288     connection = ClientServerConnection(\r\n    289         self.java_parameters, self.python_parameters,\r\n    290         self.gateway_property, self)\r\n--> 291     connection.connect_to_java_server()\r\n    292     self.set_thread_connection(connection)\r\n    293     return connection\r\n\r\nFile /opt/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/clientserver.py:438, in ClientServerConnection.connect_to_java_server(self)\r\n    435 if self.ssl_context:\r\n    436     self.socket = self.ssl_context.wrap_socket(\r\n    437         self.socket, server_hostname=self.java_address)\r\n--> 438 self.socket.connect((self.java_address, self.java_port))\r\n    439 self.stream = self.socket.makefile(\"rb\")\r\n    440 self.is_connected = True\r\n\r\nConnectionRefusedError: [Errno 111] Connection refused","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411402841/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411455250","html_url":"https://github.com/apache/iceberg/pull/6712#issuecomment-1411455250","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6712","id":1411455250,"node_id":"IC_kwDOCW7NX85UIRkS","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T04:42:08Z","updated_at":"2023-02-01T04:42:08Z","author_association":"MEMBER","body":"cc: @snazy, @dimas-b  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411455250/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411531635","html_url":"https://github.com/apache/iceberg/issues/6715#issuecomment-1411531635","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6715","id":1411531635,"node_id":"IC_kwDOCW7NX85UIkNz","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T06:26:59Z","updated_at":"2023-02-01T06:26:59Z","author_association":"CONTRIBUTOR","body":"If we have to load both http clients to the claasspath, it seems like a big we should fix. I thought when we introduced the config to switch between url and Apache client we already tested that case, but seems not. I am currently short of bandwidth, ping a few people to see if anyone is interested in picking it up\r\n\r\n@amogh-jahagirdar @singhpk234 @JonasJ-ap @xiaoxuandev @aajisaka ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411531635/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411534472","html_url":"https://github.com/apache/iceberg/pull/6696#issuecomment-1411534472","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6696","id":1411534472,"node_id":"IC_kwDOCW7NX85UIk6I","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T06:30:52Z","updated_at":"2023-02-04T11:49:10Z","author_association":"MEMBER","body":">  @ajantha-bhat, can you please run benchmarks to ensure there are no regressions?\r\n\r\n\r\nBenchmarks:\r\n[With Arrow 10.0.1] https://github.com/ajantha-bhat/iceberg/actions/runs/4061513944 - 6min 30 sec\r\n[With Arrow-11.0.0] https://github.com/ajantha-bhat/iceberg/actions/runs/4061518292 - 6min 4 sec\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411534472/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411554799","html_url":"https://github.com/apache/iceberg/pull/6651#issuecomment-1411554799","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6651","id":1411554799,"node_id":"IC_kwDOCW7NX85UIp3v","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T07:00:39Z","updated_at":"2023-02-01T07:00:53Z","author_association":"CONTRIBUTOR","body":"@namrathamyske I raised a [PR](https://github.com/namrathamyske/iceberg/pull/25/files) to your branch to address the remaining comments, let me know your thoughts. I also did an inspection of the code and don't think we need to remove the check here https://github.com/apache/iceberg/pull/6651#discussion_r1085890400. We can wait for CI though to verify all cases and then see a path forward if anything else fails like @rdblue mentioned.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411554799/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411576490","html_url":"https://github.com/apache/iceberg/pull/6717#issuecomment-1411576490","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6717","id":1411576490,"node_id":"IC_kwDOCW7NX85UIvKq","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T07:21:04Z","updated_at":"2023-02-01T07:21:04Z","author_association":"CONTRIBUTOR","body":"Thanks for the fix @namrathamyske ! left some comments","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411576490/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411577821","html_url":"https://github.com/apache/iceberg/pull/6090#issuecomment-1411577821","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6090","id":1411577821,"node_id":"IC_kwDOCW7NX85UIvfd","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T07:22:27Z","updated_at":"2023-02-01T07:22:27Z","author_association":"MEMBER","body":"> Thanks, @ajantha-bhat! I made some comments in tests to fix.\r\n\r\nThanks for the review. I have addressed the comments. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411577821/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411736076","html_url":"https://github.com/apache/iceberg/pull/6624#issuecomment-1411736076","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6624","id":1411736076,"node_id":"IC_kwDOCW7NX85UJWIM","user":{"login":"kingeasternsun","id":5291739,"node_id":"MDQ6VXNlcjUyOTE3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/5291739?v=4","gravatar_id":"","url":"https://api.github.com/users/kingeasternsun","html_url":"https://github.com/kingeasternsun","followers_url":"https://api.github.com/users/kingeasternsun/followers","following_url":"https://api.github.com/users/kingeasternsun/following{/other_user}","gists_url":"https://api.github.com/users/kingeasternsun/gists{/gist_id}","starred_url":"https://api.github.com/users/kingeasternsun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingeasternsun/subscriptions","organizations_url":"https://api.github.com/users/kingeasternsun/orgs","repos_url":"https://api.github.com/users/kingeasternsun/repos","events_url":"https://api.github.com/users/kingeasternsun/events{/privacy}","received_events_url":"https://api.github.com/users/kingeasternsun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T09:30:14Z","updated_at":"2023-02-01T09:30:14Z","author_association":"CONTRIBUTOR","body":"Hi, should I squash the commits before merge @RussellSpitzer @jackye1995 @amogh-jahagirdar ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1411736076/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412198557","html_url":"https://github.com/apache/iceberg/issues/6718#issuecomment-1412198557","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6718","id":1412198557,"node_id":"IC_kwDOCW7NX85ULHCd","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T14:58:53Z","updated_at":"2023-02-01T14:58:53Z","author_association":"CONTRIBUTOR","body":"@cw-pradyumna I think this is the same issue as issue #6715. I am closing this one as duplicate. feel free to repopen it if you think otherwise.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412198557/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412217590","html_url":"https://github.com/apache/iceberg/pull/6581#issuecomment-1412217590","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6581","id":1412217590,"node_id":"IC_kwDOCW7NX85ULLr2","user":{"login":"manuzhang","id":1191767,"node_id":"MDQ6VXNlcjExOTE3Njc=","avatar_url":"https://avatars.githubusercontent.com/u/1191767?v=4","gravatar_id":"","url":"https://api.github.com/users/manuzhang","html_url":"https://github.com/manuzhang","followers_url":"https://api.github.com/users/manuzhang/followers","following_url":"https://api.github.com/users/manuzhang/following{/other_user}","gists_url":"https://api.github.com/users/manuzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/manuzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manuzhang/subscriptions","organizations_url":"https://api.github.com/users/manuzhang/orgs","repos_url":"https://api.github.com/users/manuzhang/repos","events_url":"https://api.github.com/users/manuzhang/events{/privacy}","received_events_url":"https://api.github.com/users/manuzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T15:08:56Z","updated_at":"2023-02-01T15:09:08Z","author_association":"COLLABORATOR","body":"> One idea is to bundle this with RewriteDataFiles, and if trigger optimistically if these conditions are met, or trigger in any case in hopes it will remove delete files as, as its relatively cheap.\r\n\r\n@szehon-ho Have you considered `partial-progress.enabled=true`? Currently, delete files can't be removed when some file groups (partitions) are compacted and committed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412217590/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412223645","html_url":"https://github.com/apache/iceberg/issues/6718#issuecomment-1412223645","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6718","id":1412223645,"node_id":"IC_kwDOCW7NX85ULNKd","user":{"login":"cw-pradyumna","id":87021699,"node_id":"MDQ6VXNlcjg3MDIxNjk5","avatar_url":"https://avatars.githubusercontent.com/u/87021699?v=4","gravatar_id":"","url":"https://api.github.com/users/cw-pradyumna","html_url":"https://github.com/cw-pradyumna","followers_url":"https://api.github.com/users/cw-pradyumna/followers","following_url":"https://api.github.com/users/cw-pradyumna/following{/other_user}","gists_url":"https://api.github.com/users/cw-pradyumna/gists{/gist_id}","starred_url":"https://api.github.com/users/cw-pradyumna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cw-pradyumna/subscriptions","organizations_url":"https://api.github.com/users/cw-pradyumna/orgs","repos_url":"https://api.github.com/users/cw-pradyumna/repos","events_url":"https://api.github.com/users/cw-pradyumna/events{/privacy}","received_events_url":"https://api.github.com/users/cw-pradyumna/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T15:12:03Z","updated_at":"2023-02-01T15:12:22Z","author_association":"NONE","body":"> @cw-pradyumna I think this is the same issue as issue #6715. I am closing this one as duplicate. feel free to repopen it if you think otherwise.\n\nOk @stevenzwu, if it's the same then no problem. I had read through #6715 but I thought it was something else, so I made this issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412223645/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412230746","html_url":"https://github.com/apache/iceberg/issues/6718#issuecomment-1412230746","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6718","id":1412230746,"node_id":"IC_kwDOCW7NX85ULO5a","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T15:16:06Z","updated_at":"2023-02-01T15:16:06Z","author_association":"CONTRIBUTOR","body":"@cw-pradyumna can you try the system property that I mentioned in the other issue?\r\n```\r\n-Dsoftware.amazon.awssdk.http.service.impl=software.amazon.awssdk.http.apache.ApacheSdkHttpService\r\n```\r\n\r\nalso can you verify if the runtime classpath loaded both url-connection-client and apache-httpclient jars?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412230746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412278054","html_url":"https://github.com/apache/iceberg/pull/6722#issuecomment-1412278054","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6722","id":1412278054,"node_id":"IC_kwDOCW7NX85ULacm","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T15:45:55Z","updated_at":"2023-02-01T15:45:55Z","author_association":"CONTRIBUTOR","body":"Seems that more people have this issue: https://github.com/p1c2u/openapi-spec-validator/issues/192","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412278054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412280147","html_url":"https://github.com/apache/iceberg/issues/6708#issuecomment-1412280147","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6708","id":1412280147,"node_id":"IC_kwDOCW7NX85ULa9T","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T15:47:17Z","updated_at":"2023-02-01T15:47:17Z","author_association":"CONTRIBUTOR","body":"This seems like a network issue. Is any of the components from the quickstart demo not reachable maybe?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412280147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412417816","html_url":"https://github.com/apache/iceberg/pull/6571#issuecomment-1412417816","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6571","id":1412417816,"node_id":"IC_kwDOCW7NX85UL8kY","user":{"login":"pauetpupa","id":45318230,"node_id":"MDQ6VXNlcjQ1MzE4MjMw","avatar_url":"https://avatars.githubusercontent.com/u/45318230?v=4","gravatar_id":"","url":"https://api.github.com/users/pauetpupa","html_url":"https://github.com/pauetpupa","followers_url":"https://api.github.com/users/pauetpupa/followers","following_url":"https://api.github.com/users/pauetpupa/following{/other_user}","gists_url":"https://api.github.com/users/pauetpupa/gists{/gist_id}","starred_url":"https://api.github.com/users/pauetpupa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pauetpupa/subscriptions","organizations_url":"https://api.github.com/users/pauetpupa/orgs","repos_url":"https://api.github.com/users/pauetpupa/repos","events_url":"https://api.github.com/users/pauetpupa/events{/privacy}","received_events_url":"https://api.github.com/users/pauetpupa/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T17:12:18Z","updated_at":"2023-02-01T17:12:18Z","author_association":"NONE","body":"This demo really helped me, thank you so much!!!\r\nBut at this point I have one question:\r\n\r\nHow can I modify a little bit the code (I don't know if the `genericTaskWriter` or what) to allow writing records that into already closed files?\r\nIn my case, I receive multiple values unsorted so in the case of ingesting them using spark I enable the fanout (or I sort them first). Is there a way using the the java api to do the same? or should I parse all the values first and sort them?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412417816/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412428015","html_url":"https://github.com/apache/iceberg/issues/5370#issuecomment-1412428015","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5370","id":1412428015,"node_id":"IC_kwDOCW7NX85UL_Dv","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T17:19:01Z","updated_at":"2023-02-01T17:19:01Z","author_association":"COLLABORATOR","body":"Marking as closed as https://github.com/apache/iceberg/pull/5376 is done, unless there's further asks here","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412428015/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412448278","html_url":"https://github.com/apache/iceberg/pull/6581#issuecomment-1412448278","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6581","id":1412448278,"node_id":"IC_kwDOCW7NX85UMEAW","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T17:31:29Z","updated_at":"2023-02-01T17:31:29Z","author_association":"COLLABORATOR","body":"Thanks all for reviews.  After thinking, this will be good to have, but as the complete 100% position delete removal will be done via minor compaction of delete files (first part of the effort is here: https://github.com/apache/iceberg/pull/6365, more to come).  Will work on that first.\r\n\r\n@amogh-jahagirdar yea I initially thought it would be useful as a standalone action, but some chats with @aokolnychyi and maybe its a bit too tricky for user to know when to run it.  Still open though.\r\n\r\n@manuzhang do you mean integrating this commit with existing partial commits?  Initially envisoning a separate commit altogether at the end of RewriteDataFiles.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412448278/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412455363","html_url":"https://github.com/apache/iceberg/pull/4812#issuecomment-1412455363","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4812","id":1412455363,"node_id":"IC_kwDOCW7NX85UMFvD","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T17:36:50Z","updated_at":"2023-02-01T17:36:50Z","author_association":"COLLABORATOR","body":"Closing as it's now broken into smaller prs","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412455363/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412839741","html_url":"https://github.com/apache/iceberg/issues/6715#issuecomment-1412839741","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6715","id":1412839741,"node_id":"IC_kwDOCW7NX85UNjk9","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T22:41:40Z","updated_at":"2023-02-01T22:41:40Z","author_association":"CONTRIBUTOR","body":">  I thought when we introduced the config to switch between url and Apache client\r\n\r\nThat config switch code in `AwsProperties` introduced the problem of requiring both url and apache client jars, which then confused `ClasspathSdkHttpServiceProvider` for `WebIdentityTokenFileCredentialsProvider`.\r\n\r\n@jackye1995 and others, what do you think of the proposal of using reflection to avoid the runtime requirements of both jars, while still supporting the switch config? It would be good to agree on the direction first. Then we can figure out who can pick it up. I will look into my availability.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412839741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412889584","html_url":"https://github.com/apache/iceberg/issues/6715#issuecomment-1412889584","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6715","id":1412889584,"node_id":"IC_kwDOCW7NX85UNvvw","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-01T23:17:11Z","updated_at":"2023-02-01T23:17:11Z","author_association":"CONTRIBUTOR","body":"> what do you think of the proposal of using reflection to avoid the runtime requirements of both jars\r\n\r\nYes that's also the direction I am thinking about.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412889584/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412931250","html_url":"https://github.com/apache/iceberg/issues/6715#issuecomment-1412931250","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6715","id":1412931250,"node_id":"IC_kwDOCW7NX85UN56y","user":{"login":"JonasJ-ap","id":55990951,"node_id":"MDQ6VXNlcjU1OTkwOTUx","avatar_url":"https://avatars.githubusercontent.com/u/55990951?v=4","gravatar_id":"","url":"https://api.github.com/users/JonasJ-ap","html_url":"https://github.com/JonasJ-ap","followers_url":"https://api.github.com/users/JonasJ-ap/followers","following_url":"https://api.github.com/users/JonasJ-ap/following{/other_user}","gists_url":"https://api.github.com/users/JonasJ-ap/gists{/gist_id}","starred_url":"https://api.github.com/users/JonasJ-ap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JonasJ-ap/subscriptions","organizations_url":"https://api.github.com/users/JonasJ-ap/orgs","repos_url":"https://api.github.com/users/JonasJ-ap/repos","events_url":"https://api.github.com/users/JonasJ-ap/events{/privacy}","received_events_url":"https://api.github.com/users/JonasJ-ap/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T00:05:45Z","updated_at":"2023-02-02T00:05:45Z","author_association":"CONTRIBUTOR","body":"I am interested in picking this up and implementing the proprosal. Could you please assign this to me?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412931250/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412937999","html_url":"https://github.com/apache/iceberg/issues/5333#issuecomment-1412937999","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5333","id":1412937999,"node_id":"IC_kwDOCW7NX85UN7kP","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T00:12:19Z","updated_at":"2023-02-02T00:12:19Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412937999/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412938081","html_url":"https://github.com/apache/iceberg/issues/5231#issuecomment-1412938081","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5231","id":1412938081,"node_id":"IC_kwDOCW7NX85UN7lh","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T00:12:21Z","updated_at":"2023-02-02T00:12:21Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412938081/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412985751","html_url":"https://github.com/apache/iceberg/pull/6717#issuecomment-1412985751","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6717","id":1412985751,"node_id":"IC_kwDOCW7NX85UOHOX","user":{"login":"namrathamyske","id":17932873,"node_id":"MDQ6VXNlcjE3OTMyODcz","avatar_url":"https://avatars.githubusercontent.com/u/17932873?v=4","gravatar_id":"","url":"https://api.github.com/users/namrathamyske","html_url":"https://github.com/namrathamyske","followers_url":"https://api.github.com/users/namrathamyske/followers","following_url":"https://api.github.com/users/namrathamyske/following{/other_user}","gists_url":"https://api.github.com/users/namrathamyske/gists{/gist_id}","starred_url":"https://api.github.com/users/namrathamyske/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/namrathamyske/subscriptions","organizations_url":"https://api.github.com/users/namrathamyske/orgs","repos_url":"https://api.github.com/users/namrathamyske/repos","events_url":"https://api.github.com/users/namrathamyske/events{/privacy}","received_events_url":"https://api.github.com/users/namrathamyske/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T00:48:17Z","updated_at":"2023-02-02T00:48:17Z","author_association":"CONTRIBUTOR","body":"Thanks @jackieo168 for coming up with this!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412985751/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412990170","html_url":"https://github.com/apache/iceberg/pull/5412#issuecomment-1412990170","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5412","id":1412990170,"node_id":"IC_kwDOCW7NX85UOITa","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T00:52:41Z","updated_at":"2023-02-02T00:52:41Z","author_association":"CONTRIBUTOR","body":"closed in favor of #6682, which cover more comprehensive spark actions and also implement bulk deletion for HadoopFileIO","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1412990170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413013311","html_url":"https://github.com/apache/iceberg/pull/6581#issuecomment-1413013311","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6581","id":1413013311,"node_id":"IC_kwDOCW7NX85UON8_","user":{"login":"manuzhang","id":1191767,"node_id":"MDQ6VXNlcjExOTE3Njc=","avatar_url":"https://avatars.githubusercontent.com/u/1191767?v=4","gravatar_id":"","url":"https://api.github.com/users/manuzhang","html_url":"https://github.com/manuzhang","followers_url":"https://api.github.com/users/manuzhang/followers","following_url":"https://api.github.com/users/manuzhang/following{/other_user}","gists_url":"https://api.github.com/users/manuzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/manuzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manuzhang/subscriptions","organizations_url":"https://api.github.com/users/manuzhang/orgs","repos_url":"https://api.github.com/users/manuzhang/repos","events_url":"https://api.github.com/users/manuzhang/events{/privacy}","received_events_url":"https://api.github.com/users/manuzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T01:25:22Z","updated_at":"2023-02-02T01:28:45Z","author_association":"COLLABORATOR","body":"@szehon-ho yes, integrating removing delete files per partition with partial commits. When new position delete files are generated during RewriteDataFiles with partial commits, all following commits will fail and no delete files will be removed at the end. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413013311/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413050964","html_url":"https://github.com/apache/iceberg/issues/6708#issuecomment-1413050964","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6708","id":1413050964,"node_id":"IC_kwDOCW7NX85UOXJU","user":{"login":"zhangjiuyang1993","id":23301932,"node_id":"MDQ6VXNlcjIzMzAxOTMy","avatar_url":"https://avatars.githubusercontent.com/u/23301932?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjiuyang1993","html_url":"https://github.com/zhangjiuyang1993","followers_url":"https://api.github.com/users/zhangjiuyang1993/followers","following_url":"https://api.github.com/users/zhangjiuyang1993/following{/other_user}","gists_url":"https://api.github.com/users/zhangjiuyang1993/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjiuyang1993/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjiuyang1993/subscriptions","organizations_url":"https://api.github.com/users/zhangjiuyang1993/orgs","repos_url":"https://api.github.com/users/zhangjiuyang1993/repos","events_url":"https://api.github.com/users/zhangjiuyang1993/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjiuyang1993/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T02:10:53Z","updated_at":"2023-02-02T02:10:53Z","author_association":"NONE","body":"No, the quickstart demo sometimes is not reachable.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413050964/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413075164","html_url":"https://github.com/apache/iceberg/issues/6693#issuecomment-1413075164","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6693","id":1413075164,"node_id":"IC_kwDOCW7NX85UOdDc","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T02:49:18Z","updated_at":"2023-02-02T02:49:18Z","author_association":"CONTRIBUTOR","body":"I suggest changing \"You can also view documentations of using Iceberg with other compute engine under the Engines tab.\" to \"You can also view documentation of using Iceberg with other compute engines under each engine (e.g., Flink, Hive).\"","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413075164/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413084268","html_url":"https://github.com/apache/iceberg/pull/6571#issuecomment-1413084268","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6571","id":1413084268,"node_id":"IC_kwDOCW7NX85UOfRs","user":{"login":"youngxinler","id":36697727,"node_id":"MDQ6VXNlcjM2Njk3NzI3","avatar_url":"https://avatars.githubusercontent.com/u/36697727?v=4","gravatar_id":"","url":"https://api.github.com/users/youngxinler","html_url":"https://github.com/youngxinler","followers_url":"https://api.github.com/users/youngxinler/followers","following_url":"https://api.github.com/users/youngxinler/following{/other_user}","gists_url":"https://api.github.com/users/youngxinler/gists{/gist_id}","starred_url":"https://api.github.com/users/youngxinler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/youngxinler/subscriptions","organizations_url":"https://api.github.com/users/youngxinler/orgs","repos_url":"https://api.github.com/users/youngxinler/repos","events_url":"https://api.github.com/users/youngxinler/events{/privacy}","received_events_url":"https://api.github.com/users/youngxinler/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T03:03:31Z","updated_at":"2023-02-02T03:03:31Z","author_association":"CONTRIBUTOR","body":"@pauetpupa Glad this helped you,  about SortOrder i don't know much,  i think GenericTaskWriter not support write order, it use RollingFileWriter to write data directly.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413084268/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413086378","html_url":"https://github.com/apache/iceberg/pull/6571#issuecomment-1413086378","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6571","id":1413086378,"node_id":"IC_kwDOCW7NX85UOfyq","user":{"login":"youngxinler","id":36697727,"node_id":"MDQ6VXNlcjM2Njk3NzI3","avatar_url":"https://avatars.githubusercontent.com/u/36697727?v=4","gravatar_id":"","url":"https://api.github.com/users/youngxinler","html_url":"https://github.com/youngxinler","followers_url":"https://api.github.com/users/youngxinler/followers","following_url":"https://api.github.com/users/youngxinler/following{/other_user}","gists_url":"https://api.github.com/users/youngxinler/gists{/gist_id}","starred_url":"https://api.github.com/users/youngxinler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/youngxinler/subscriptions","organizations_url":"https://api.github.com/users/youngxinler/orgs","repos_url":"https://api.github.com/users/youngxinler/repos","events_url":"https://api.github.com/users/youngxinler/events{/privacy}","received_events_url":"https://api.github.com/users/youngxinler/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T03:06:06Z","updated_at":"2023-02-02T03:06:06Z","author_association":"CONTRIBUTOR","body":"@jackye1995 Can I trouble you if you have time to do a review?  about Data: java api add GenericTaskWriter .  thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413086378/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413165879","html_url":"https://github.com/apache/iceberg/issues/6715#issuecomment-1413165879","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6715","id":1413165879,"node_id":"IC_kwDOCW7NX85UOzM3","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T05:17:41Z","updated_at":"2023-02-02T05:17:41Z","author_association":"CONTRIBUTOR","body":"@JonasJ-ap assigned the issue to you. you should be able to reproduce it with latest code and run Spark/Flink with EKS service account.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413165879/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413198457","html_url":"https://github.com/apache/iceberg/pull/6698#issuecomment-1413198457","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6698","id":1413198457,"node_id":"IC_kwDOCW7NX85UO7J5","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T06:02:51Z","updated_at":"2023-02-02T06:02:51Z","author_association":"CONTRIBUTOR","body":"For the reference, the previous discussions:\r\n- Hive: Add UGI to the key in CachedClientPool #6175\r\n- Hive: More distinctive cached client pool key to avoid conflict #5378","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413198457/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413222159","html_url":"https://github.com/apache/iceberg/pull/6682#issuecomment-1413222159","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6682","id":1413222159,"node_id":"IC_kwDOCW7NX85UPA8P","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T06:33:36Z","updated_at":"2023-02-02T06:33:36Z","author_association":"CONTRIBUTOR","body":"I agree with the overall direction but I'd try to support the existing API to avoid massive deprecation and simplify the implementation. It will be hard to test all possible scenarios.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413222159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413262948","html_url":"https://github.com/apache/iceberg/issues/5043#issuecomment-1413262948","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5043","id":1413262948,"node_id":"IC_kwDOCW7NX85UPK5k","user":{"login":"kingwind94","id":22868377,"node_id":"MDQ6VXNlcjIyODY4Mzc3","avatar_url":"https://avatars.githubusercontent.com/u/22868377?v=4","gravatar_id":"","url":"https://api.github.com/users/kingwind94","html_url":"https://github.com/kingwind94","followers_url":"https://api.github.com/users/kingwind94/followers","following_url":"https://api.github.com/users/kingwind94/following{/other_user}","gists_url":"https://api.github.com/users/kingwind94/gists{/gist_id}","starred_url":"https://api.github.com/users/kingwind94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingwind94/subscriptions","organizations_url":"https://api.github.com/users/kingwind94/orgs","repos_url":"https://api.github.com/users/kingwind94/repos","events_url":"https://api.github.com/users/kingwind94/events{/privacy}","received_events_url":"https://api.github.com/users/kingwind94/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T07:22:09Z","updated_at":"2023-02-02T07:22:09Z","author_association":"NONE","body":"got same problem, have any fixs now?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413262948/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413315464","html_url":"https://github.com/apache/iceberg/issues/5043#issuecomment-1413315464","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5043","id":1413315464,"node_id":"IC_kwDOCW7NX85UPXuI","user":{"login":"kingwind94","id":22868377,"node_id":"MDQ6VXNlcjIyODY4Mzc3","avatar_url":"https://avatars.githubusercontent.com/u/22868377?v=4","gravatar_id":"","url":"https://api.github.com/users/kingwind94","html_url":"https://github.com/kingwind94","followers_url":"https://api.github.com/users/kingwind94/followers","following_url":"https://api.github.com/users/kingwind94/following{/other_user}","gists_url":"https://api.github.com/users/kingwind94/gists{/gist_id}","starred_url":"https://api.github.com/users/kingwind94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingwind94/subscriptions","organizations_url":"https://api.github.com/users/kingwind94/orgs","repos_url":"https://api.github.com/users/kingwind94/repos","events_url":"https://api.github.com/users/kingwind94/events{/privacy}","received_events_url":"https://api.github.com/users/kingwind94/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T08:15:26Z","updated_at":"2023-02-02T08:15:38Z","author_association":"NONE","body":"I fixed it! You must have -D (delete rowkind) rowdata in your cdc datastream. Check your BaseDeltaTaskWriter, fix your write(RowData row)  method as below\r\n```\r\n      case DELETE:\r\n        if (upsert) {\r\n          writer.deleteKey(keyProjection.wrap(row));\r\n        } else {\r\n          writer.delete(row);\r\n        }\r\n        break;\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413315464/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413328965","html_url":"https://github.com/apache/iceberg/issues/5977#issuecomment-1413328965","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5977","id":1413328965,"node_id":"IC_kwDOCW7NX85UPbBF","user":{"login":"mjf-89","id":1841657,"node_id":"MDQ6VXNlcjE4NDE2NTc=","avatar_url":"https://avatars.githubusercontent.com/u/1841657?v=4","gravatar_id":"","url":"https://api.github.com/users/mjf-89","html_url":"https://github.com/mjf-89","followers_url":"https://api.github.com/users/mjf-89/followers","following_url":"https://api.github.com/users/mjf-89/following{/other_user}","gists_url":"https://api.github.com/users/mjf-89/gists{/gist_id}","starred_url":"https://api.github.com/users/mjf-89/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mjf-89/subscriptions","organizations_url":"https://api.github.com/users/mjf-89/orgs","repos_url":"https://api.github.com/users/mjf-89/repos","events_url":"https://api.github.com/users/mjf-89/events{/privacy}","received_events_url":"https://api.github.com/users/mjf-89/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T08:26:42Z","updated_at":"2023-02-02T08:27:01Z","author_association":"NONE","body":"Hi, I don't have a deep understanding of pyspark internals but I think that you can write to a partitioned iceberg table with the following approach:\r\n\r\n```\r\n# registering iceberg udf for partition transformation bucket(32,string_column)\r\nspark.sparkContext._jvm.org.apache.iceberg.spark.IcebergSpark.registerBucketUDF(spark._jsparkSession,'iceberg_bucket_str_32',spark.sparkContext._jvm.org.apache.spark.sql.types.DataTypes.StringType,32)\r\n\r\n# sorting using the registerd udf and write to the partitioned iceberg table\r\ndf.sortWithinPartitions(F.expr(\"iceberg_bucket_str_32(string_column)\")) \\\r\n  .writeTo(\"iceberg_table\") \\\r\n  .using(\"iceberg\") \\\r\n  .partitionedBy(F.bucket(32,\"string_column\")) \r\n```\r\nAnother option as far as I understand is to avoid sorting and use the fanout writer instead:\r\n```\r\ndf.writeTo(\"iceberg_table\") \\\r\n  .using('iceberg') \\\r\n  .option(\"fanout-enabled\", \"true\") \\\r\n  .partitionedBy(F.bucket(32,\"esum_id\")) \\\r\n  .createOrReplace()\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413328965/reactions","total_count":13,"+1":7,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":6,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413400733","html_url":"https://github.com/apache/iceberg/issues/6709#issuecomment-1413400733","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6709","id":1413400733,"node_id":"IC_kwDOCW7NX85UPsid","user":{"login":"boroknagyz","id":12861880,"node_id":"MDQ6VXNlcjEyODYxODgw","avatar_url":"https://avatars.githubusercontent.com/u/12861880?v=4","gravatar_id":"","url":"https://api.github.com/users/boroknagyz","html_url":"https://github.com/boroknagyz","followers_url":"https://api.github.com/users/boroknagyz/followers","following_url":"https://api.github.com/users/boroknagyz/following{/other_user}","gists_url":"https://api.github.com/users/boroknagyz/gists{/gist_id}","starred_url":"https://api.github.com/users/boroknagyz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/boroknagyz/subscriptions","organizations_url":"https://api.github.com/users/boroknagyz/orgs","repos_url":"https://api.github.com/users/boroknagyz/repos","events_url":"https://api.github.com/users/boroknagyz/events{/privacy}","received_events_url":"https://api.github.com/users/boroknagyz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T09:21:30Z","updated_at":"2023-02-02T09:21:30Z","author_association":"CONTRIBUTOR","body":"I think we cannot assume that numRows(table) is equal to numRows(data files) - numRows(position delete files).\r\n\r\nBecause\r\n\r\n- Concurent deletes might create delete files that reference the same rows:\r\nhttps://github.com/apache/iceberg/blob/cecb10bb8ab0458fb3f6a650692a8e432f08cbd2/api/src/main/java/org/apache/iceberg/RowDelta.java#L131-L133\r\n\r\n- Partial compactions, e.g.:\r\n\r\n1. Table has data files: A, B, X and delete file: D\r\n2. D references A and B\r\n3. Now we rewrite the small files which are A and X\r\n4. So now the table has data files AX', B, and delete file D\r\n    (AX' doesn't have any deleted rows)\r\n5. In this case numRows(table) is not equal to numRows(dataFiles) - numRows(deleteFiles)\r\n\r\n(Though the above could be fixed by rewriting the delete file to D' to only reference rows in B. But I'm unsure if Iceberg does such a thing)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413400733/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413425607","html_url":"https://github.com/apache/iceberg/issues/6713#issuecomment-1413425607","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6713","id":1413425607,"node_id":"IC_kwDOCW7NX85UPynH","user":{"login":"jedrek-VL","id":113910686,"node_id":"U_kgDOBsojng","avatar_url":"https://avatars.githubusercontent.com/u/113910686?v=4","gravatar_id":"","url":"https://api.github.com/users/jedrek-VL","html_url":"https://github.com/jedrek-VL","followers_url":"https://api.github.com/users/jedrek-VL/followers","following_url":"https://api.github.com/users/jedrek-VL/following{/other_user}","gists_url":"https://api.github.com/users/jedrek-VL/gists{/gist_id}","starred_url":"https://api.github.com/users/jedrek-VL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jedrek-VL/subscriptions","organizations_url":"https://api.github.com/users/jedrek-VL/orgs","repos_url":"https://api.github.com/users/jedrek-VL/repos","events_url":"https://api.github.com/users/jedrek-VL/events{/privacy}","received_events_url":"https://api.github.com/users/jedrek-VL/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T09:39:18Z","updated_at":"2023-02-02T09:39:18Z","author_association":"NONE","body":"Ok, I managed to make it work by replacing the `load_catalog` code by the following:\r\n\r\n```\r\ncatalog = load_catalog('default', **{\r\n        'uri': 'http://localhost:8181',\r\n        's3.endpoint': 'http://localhost:9000',\r\n        's3.access-key-id': 'admin',\r\n        's3.secret-access-key': 'password',\r\n    })\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413425607/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413808807","html_url":"https://github.com/apache/iceberg/pull/6712#issuecomment-1413808807","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6712","id":1413808807,"node_id":"IC_kwDOCW7NX85URQKn","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T14:12:05Z","updated_at":"2023-02-02T14:12:05Z","author_association":"MEMBER","body":"Thanks @dimas-b for the review. \r\n@snazy : Do you have any suggestions for this PR? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413808807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413913229","html_url":"https://github.com/apache/iceberg/issues/6713#issuecomment-1413913229","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6713","id":1413913229,"node_id":"IC_kwDOCW7NX85URpqN","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T15:19:50Z","updated_at":"2023-02-02T15:19:50Z","author_association":"CONTRIBUTOR","body":"Thanks @jedrek-VL for the comprehensive write-up. I'm just seeing this now. Yesterday the docker image was updated with a PyIceberg notebook, I would recommend pulling the latest containers `docker-compose pull` and it should work right away.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413913229/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413922192","html_url":"https://github.com/apache/iceberg/pull/6653#issuecomment-1413922192","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6653","id":1413922192,"node_id":"IC_kwDOCW7NX85URr2Q","user":{"login":"deniskuzZ","id":2761528,"node_id":"MDQ6VXNlcjI3NjE1Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/2761528?v=4","gravatar_id":"","url":"https://api.github.com/users/deniskuzZ","html_url":"https://github.com/deniskuzZ","followers_url":"https://api.github.com/users/deniskuzZ/followers","following_url":"https://api.github.com/users/deniskuzZ/following{/other_user}","gists_url":"https://api.github.com/users/deniskuzZ/gists{/gist_id}","starred_url":"https://api.github.com/users/deniskuzZ/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deniskuzZ/subscriptions","organizations_url":"https://api.github.com/users/deniskuzZ/orgs","repos_url":"https://api.github.com/users/deniskuzZ/repos","events_url":"https://api.github.com/users/deniskuzZ/events{/privacy}","received_events_url":"https://api.github.com/users/deniskuzZ/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T15:25:40Z","updated_at":"2023-02-02T15:25:55Z","author_association":"MEMBER","body":"hi @pvary, could you please help with the review?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413922192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413952926","html_url":"https://github.com/apache/iceberg/pull/6653#issuecomment-1413952926","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6653","id":1413952926,"node_id":"IC_kwDOCW7NX85URzWe","user":{"login":"deniskuzZ","id":2761528,"node_id":"MDQ6VXNlcjI3NjE1Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/2761528?v=4","gravatar_id":"","url":"https://api.github.com/users/deniskuzZ","html_url":"https://github.com/deniskuzZ","followers_url":"https://api.github.com/users/deniskuzZ/followers","following_url":"https://api.github.com/users/deniskuzZ/following{/other_user}","gists_url":"https://api.github.com/users/deniskuzZ/gists{/gist_id}","starred_url":"https://api.github.com/users/deniskuzZ/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deniskuzZ/subscriptions","organizations_url":"https://api.github.com/users/deniskuzZ/orgs","repos_url":"https://api.github.com/users/deniskuzZ/repos","events_url":"https://api.github.com/users/deniskuzZ/events{/privacy}","received_events_url":"https://api.github.com/users/deniskuzZ/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T15:45:43Z","updated_at":"2023-02-02T15:45:43Z","author_association":"MEMBER","body":"> Sorry for the late reply, I was traveling the last few days. I like this solution. It is until Iceberg 2.0.0 that we have to keep the lazy and non-lazy versions of initializing a PartitionSpec using a transform.\r\n\r\nThank you!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413952926/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413975497","html_url":"https://github.com/apache/iceberg/pull/6674#issuecomment-1413975497","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6674","id":1413975497,"node_id":"IC_kwDOCW7NX85UR43J","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T15:59:42Z","updated_at":"2023-02-02T15:59:42Z","author_association":"CONTRIBUTOR","body":"would be good to also get feedback from @danielcweeks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413975497/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413976249","html_url":"https://github.com/apache/iceberg/pull/6482#issuecomment-1413976249","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6482","id":1413976249,"node_id":"IC_kwDOCW7NX85UR5C5","user":{"login":"zhangbutao","id":9760681,"node_id":"MDQ6VXNlcjk3NjA2ODE=","avatar_url":"https://avatars.githubusercontent.com/u/9760681?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangbutao","html_url":"https://github.com/zhangbutao","followers_url":"https://api.github.com/users/zhangbutao/followers","following_url":"https://api.github.com/users/zhangbutao/following{/other_user}","gists_url":"https://api.github.com/users/zhangbutao/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangbutao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangbutao/subscriptions","organizations_url":"https://api.github.com/users/zhangbutao/orgs","repos_url":"https://api.github.com/users/zhangbutao/repos","events_url":"https://api.github.com/users/zhangbutao/events{/privacy}","received_events_url":"https://api.github.com/users/zhangbutao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T16:00:12Z","updated_at":"2023-02-02T16:00:12Z","author_association":"CONTRIBUTOR","body":"> Sorry for being late to the party here, I was traveling the last few days. I would be in favor of #6653 if that also solves your problem.\r\n\r\nNever mind :). Yes, https://github.com/apache/iceberg/pull/6653 can also fix this issue.  Feel free to close this PR if not needed. Thank you.  @Fokko ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1413976249/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414042971","html_url":"https://github.com/apache/iceberg/issues/6620#issuecomment-1414042971","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6620","id":1414042971,"node_id":"IC_kwDOCW7NX85USJVb","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T16:43:56Z","updated_at":"2023-02-02T16:43:56Z","author_association":"CONTRIBUTOR","body":"Thanks for pining for me @srilman \r\n\r\nMost libraries can vary the version, and some are fixed. For example, `aiobotocore` is linked to `boto3`. For Arrow, I think you're okay using an older version.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414042971/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414044966","html_url":"https://github.com/apache/iceberg/pull/6482#issuecomment-1414044966","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6482","id":1414044966,"node_id":"IC_kwDOCW7NX85USJ0m","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T16:45:11Z","updated_at":"2023-02-02T16:45:11Z","author_association":"CONTRIBUTOR","body":"Thanks for letting me know and creating the PR in the first place, much appreciated ðŸ‘ðŸ» ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414044966/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414051660","html_url":"https://github.com/apache/iceberg/issues/6713#issuecomment-1414051660","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6713","id":1414051660,"node_id":"IC_kwDOCW7NX85USLdM","user":{"login":"jedrek-VL","id":113910686,"node_id":"U_kgDOBsojng","avatar_url":"https://avatars.githubusercontent.com/u/113910686?v=4","gravatar_id":"","url":"https://api.github.com/users/jedrek-VL","html_url":"https://github.com/jedrek-VL","followers_url":"https://api.github.com/users/jedrek-VL/followers","following_url":"https://api.github.com/users/jedrek-VL/following{/other_user}","gists_url":"https://api.github.com/users/jedrek-VL/gists{/gist_id}","starred_url":"https://api.github.com/users/jedrek-VL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jedrek-VL/subscriptions","organizations_url":"https://api.github.com/users/jedrek-VL/orgs","repos_url":"https://api.github.com/users/jedrek-VL/repos","events_url":"https://api.github.com/users/jedrek-VL/events{/privacy}","received_events_url":"https://api.github.com/users/jedrek-VL/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T16:49:59Z","updated_at":"2023-02-02T16:49:59Z","author_association":"NONE","body":"Right. I saw the new docker images and that's how I found out what I was missing :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414051660/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414053888","html_url":"https://github.com/apache/iceberg/issues/6725#issuecomment-1414053888","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6725","id":1414053888,"node_id":"IC_kwDOCW7NX85USMAA","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T16:51:39Z","updated_at":"2023-02-02T16:51:39Z","author_association":"MEMBER","body":"There is no such thing in iceberg. If there is data in a partition the commit has suceeded. So if for example you do a Spark Query and there is data in the partition, that means your operation inserting into that partition finished. If you have multiple operations appending into the same partition that would require application logic to differentiate.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414053888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414172576","html_url":"https://github.com/apache/iceberg/pull/6720#issuecomment-1414172576","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6720","id":1414172576,"node_id":"IC_kwDOCW7NX85USo-g","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T18:20:03Z","updated_at":"2023-02-02T18:20:03Z","author_association":"CONTRIBUTOR","body":"Sounds reasonable to me. We could also version the docs eventually.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414172576/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414201166","html_url":"https://github.com/apache/iceberg/pull/6701#issuecomment-1414201166","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6701","id":1414201166,"node_id":"IC_kwDOCW7NX85USv9O","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T18:44:58Z","updated_at":"2023-02-02T18:44:58Z","author_association":"MEMBER","body":"(Side note: I no longer use the the rest-spec in my experiments - for various reasons - and use the JSON serialization from `iceberg-core`.)\r\n\r\nBut IMO the spec should exactly reflect the behavior (or better. vice versa). Otherwise, what's the point of having a _specification_, if the actual behavior is different. Users that do not use the JSON code in `iceberg-core` or the provided Python client will rely on the OpenAPI spec, potentially to generate `curl` requests or even generate their own client code  from that spec.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414201166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414203692","html_url":"https://github.com/apache/iceberg/pull/6700#issuecomment-1414203692","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6700","id":1414203692,"node_id":"IC_kwDOCW7NX85USwks","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T18:47:18Z","updated_at":"2023-02-02T18:47:18Z","author_association":"MEMBER","body":"I needed this, while I was trying (without success for many reasons) to generate JAX-RS code from the spec. Such an approach would need this change.\r\n\r\nI'm okay to leave it as it is. Mostly because I could not find at least one openapi-spec-2-JAX-RS code generator that actually works, and therefore use the JSON serialization from `iceberg-core`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414203692/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414242918","html_url":"https://github.com/apache/iceberg/issues/6727#issuecomment-1414242918","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6727","id":1414242918,"node_id":"IC_kwDOCW7NX85US6Jm","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T19:19:47Z","updated_at":"2023-02-02T19:19:47Z","author_association":"MEMBER","body":"(Sorry, my bad, seems that _both_ can happen.)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414242918/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414426100","html_url":"https://github.com/apache/iceberg/pull/6648#issuecomment-1414426100","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6648","id":1414426100,"node_id":"IC_kwDOCW7NX85UTm30","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T21:54:26Z","updated_at":"2023-02-02T21:54:26Z","author_association":"CONTRIBUTOR","body":"Thanks for the detailed explanations @pvary I agree it does seem difficult to reconcile the two abstractions at this point. The only thing on my side is can we confirm if all the public classes/interfaces really need to be public? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414426100/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414441586","html_url":"https://github.com/apache/iceberg/pull/6638#issuecomment-1414441586","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6638","id":1414441586,"node_id":"IC_kwDOCW7NX85UTqpy","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T22:09:51Z","updated_at":"2023-02-02T22:11:10Z","author_association":"CONTRIBUTOR","body":"Thanks for the review @flyrain really appreciate it! \r\n\r\nSo there are a few operations:\r\n\r\n\r\n1.) replaceBranch: Replace branch will change the snapshot that the branch points to. Nothing will be removed here. The same principle applies for replaceTag.\r\n\r\n2.) The removeBranch API (DROP BRANCH in SQL): This will remove the branch from the references in metadata. When this is committed it's an immediate removal of the reference.\r\n\r\nCorrect that a branch will be cleaned up during snapshot expiration if it is past the reference retention age `maxRefAgeMs` in the code. The updated expiration algorithm which considers branching and tagging can be found here https://iceberg.apache.org/spec/#snapshot-retention-policy\r\n\r\nI'm also working on a PR for a dedicated branching/tagging doc page which has some details there. https://github.com/apache/iceberg/pull/6723 appreciate any feedback on this as well if anything is unclear! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414441586/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414446899","html_url":"https://github.com/apache/iceberg/issues/2040#issuecomment-1414446899","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2040","id":1414446899,"node_id":"IC_kwDOCW7NX85UTr8z","user":{"login":"haydenflinner","id":14845292,"node_id":"MDQ6VXNlcjE0ODQ1Mjky","avatar_url":"https://avatars.githubusercontent.com/u/14845292?v=4","gravatar_id":"","url":"https://api.github.com/users/haydenflinner","html_url":"https://github.com/haydenflinner","followers_url":"https://api.github.com/users/haydenflinner/followers","following_url":"https://api.github.com/users/haydenflinner/following{/other_user}","gists_url":"https://api.github.com/users/haydenflinner/gists{/gist_id}","starred_url":"https://api.github.com/users/haydenflinner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haydenflinner/subscriptions","organizations_url":"https://api.github.com/users/haydenflinner/orgs","repos_url":"https://api.github.com/users/haydenflinner/repos","events_url":"https://api.github.com/users/haydenflinner/events{/privacy}","received_events_url":"https://api.github.com/users/haydenflinner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T22:15:24Z","updated_at":"2023-02-02T22:16:00Z","author_association":"NONE","body":"Same thing here (Spark 3.3_2.12, Iceberg 1.1.0) , happening whether I use INSERT INTO or the dataframe API. How annoying. Is there really no solution besides messing with the dataframe schema to ensure it has the same number of columns as the iceberg table? Seems annoying to evolve the table this way.\r\n\r\n```\r\n    # spark.sql(\r\n    #     f\"\"\"CREATE OR REPLACE TEMPORARY VIEW myview USING parquet\r\n    #             OPTIONS (path \"{path}\")\"\"\"\r\n    # )\r\n    # log.info(\"calling-insert\")\r\n    # spark.sql(f\"INSERT INTO {tablename}({', '.join(df.columns)}) SELECT * FROM myview\")\r\n\r\n---> leads to:\r\n    # Table columns: 'server_name', 'backed_up_path', 'backed_up_filesize', 'num_lines', 'backed_up_ts', 'start_ts', 'end_ts', 'first_x_ts', 'last_x_ts'\r\n    # Data columns: 'server_name', 'backed_up_path', 'backed_up_filesize'\r\n```\r\nor\r\n```\r\n    df.to_parquet(path, index=False, allow_truncated_timestamps=True, coerce_timestamps='us')\r\n    spark = _get_spark()\r\n    spark.sql(\"use dev_catalog\")\r\n    sdf = spark.read.parquet(path)\r\n    sdf.writeTo(f\"dev_catalog.{tablename}\").append()\r\n--> leads to:\r\nAnalysisException: Cannot write incompatible data to table 'dev_catalog.logfiles':\r\n- Cannot write nullable values to non-null column 'backed_up_path'\r\n- Cannot find data for output column 'num_lines'\r\n- Cannot find data for output column 'backed_up_ts'\r\n- Cannot find data for output column 'start_ts'\r\n- Cannot find data for output column 'end_ts'\r\n- Cannot find data for output column 'first_x_ts'\r\n- Cannot find data for output column 'last_x_ts'\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414446899/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414466758","html_url":"https://github.com/apache/iceberg/issues/2040#issuecomment-1414466758","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2040","id":1414466758,"node_id":"IC_kwDOCW7NX85UTwzG","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T22:36:53Z","updated_at":"2023-02-02T22:37:27Z","author_association":"MEMBER","body":"Both Spark and Iceberg have their own checks to determine whether an input schema is valid for writing to a given table. The Spark checks are first and require that all of the columns present in the output table are also present in the Dataframe writing to that table. To fix this a flag is allowed to be set which will disable the Spark Checks for compatible schema and instead it will only use the Iceberg check. This is accomplished by setting write.spark.accept-any-schema in the table properties.\r\n\r\n```\r\n  public static final String SPARK_WRITE_ACCEPT_ANY_SCHEMA = \"write.spark.accept-any-schema\";\r\n```\r\n\r\nAnyone who wants to add this to the Doc's has my gratitude. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414466758/reactions","total_count":5,"+1":0,"-1":0,"laugh":0,"hooray":5,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414473094","html_url":"https://github.com/apache/iceberg/pull/6637#issuecomment-1414473094","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6637","id":1414473094,"node_id":"IC_kwDOCW7NX85UTyWG","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T22:43:12Z","updated_at":"2023-02-03T01:42:05Z","author_association":"CONTRIBUTOR","body":"@hililiwei similar to https://github.com/apache/iceberg/pull/6638 could this PR encapsulate create/replace? We came to the conclusion on the replaceBranch PR it made more sense to just combine them. at the end of the day the logical plan needs to pass through whether it's a replace or not and it is a bit more concise in the grammar definition to combine them while still maintaining readability","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414473094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414492620","html_url":"https://github.com/apache/iceberg/pull/6638#issuecomment-1414492620","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6638","id":1414492620,"node_id":"IC_kwDOCW7NX85UT3HM","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T23:08:01Z","updated_at":"2023-02-02T23:08:01Z","author_association":"CONTRIBUTOR","body":"Looks like we have enough votes and all comments are addressed. I will go ahead to merge this, and we can address further comments in subsequent PRs like #6637 \r\n\r\nThanks @amogh-jahagirdar and @hililiwei for the work, thanks @yyanyy and @flyrain for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414492620/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414496739","html_url":"https://github.com/apache/iceberg/pull/6638#issuecomment-1414496739","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6638","id":1414496739,"node_id":"IC_kwDOCW7NX85UT4Hj","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-02T23:12:17Z","updated_at":"2023-02-02T23:12:17Z","author_association":"CONTRIBUTOR","body":"Thanks for the reviews  @flyrain @jackye1995 @yyanyy @hililiwei! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414496739/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414537028","html_url":"https://github.com/apache/iceberg/issues/5163#issuecomment-1414537028","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5163","id":1414537028,"node_id":"IC_kwDOCW7NX85UUB9E","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-03T00:12:08Z","updated_at":"2023-02-03T00:12:08Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414537028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414537066","html_url":"https://github.com/apache/iceberg/issues/4607#issuecomment-1414537066","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4607","id":1414537066,"node_id":"IC_kwDOCW7NX85UUB9q","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-03T00:12:11Z","updated_at":"2023-02-03T00:12:11Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414537066/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414545406","html_url":"https://github.com/apache/iceberg/pull/6695#issuecomment-1414545406","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6695","id":1414545406,"node_id":"IC_kwDOCW7NX85UUD_-","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-03T00:23:18Z","updated_at":"2023-02-03T00:23:18Z","author_association":"CONTRIBUTOR","body":"My bad, I overlooked the condition, @ajantha-bhat!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414545406/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414546166","html_url":"https://github.com/apache/iceberg/pull/6695#issuecomment-1414546166","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6695","id":1414546166,"node_id":"IC_kwDOCW7NX85UUEL2","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-03T00:24:18Z","updated_at":"2023-02-03T00:24:18Z","author_association":"CONTRIBUTOR","body":"Thanks, @ajantha-bhat! I merged this. Would you mind following up with cherry-picks to other versions?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414546166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414548715","html_url":"https://github.com/apache/iceberg/pull/6700#issuecomment-1414548715","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6700","id":1414548715,"node_id":"IC_kwDOCW7NX85UUEzr","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-03T00:27:25Z","updated_at":"2023-02-03T00:27:25Z","author_association":"CONTRIBUTOR","body":"Sounds good, @snazy. Would you mind closing this one and re-opening if needed? Trying to reduce the number of open PRs against our repo.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414548715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414576132","html_url":"https://github.com/apache/iceberg/pull/6637#issuecomment-1414576132","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6637","id":1414576132,"node_id":"IC_kwDOCW7NX85UULgE","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-03T01:08:38Z","updated_at":"2023-02-03T01:08:38Z","author_association":"CONTRIBUTOR","body":"> could this PR encapsulate create/replace?\r\n\r\n+1\r\n\r\nLet me know when this is updated, I will take another look!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414576132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414586011","html_url":"https://github.com/apache/iceberg/pull/5029#issuecomment-1414586011","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5029","id":1414586011,"node_id":"IC_kwDOCW7NX85UUN6b","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-03T01:24:28Z","updated_at":"2023-02-03T01:24:28Z","author_association":"CONTRIBUTOR","body":"@stevenzwu since you are reviewing #6660, could you also take a look at this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414586011/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414692489","html_url":"https://github.com/apache/iceberg/pull/6695#issuecomment-1414692489","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6695","id":1414692489,"node_id":"IC_kwDOCW7NX85UUn6J","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-03T02:25:19Z","updated_at":"2023-02-03T02:25:19Z","author_association":"MEMBER","body":"> Thanks, @ajantha-bhat! I merged this. Would you mind following up with cherry-picks to other versions?\r\n\r\nThanks for merging. Today I will work on backporting this PR to other spark versions. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414692489/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414694746","html_url":"https://github.com/apache/iceberg/issues/3127#issuecomment-1414694746","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3127","id":1414694746,"node_id":"IC_kwDOCW7NX85UUoda","user":{"login":"lurnagao-dahua","id":91278331,"node_id":"MDQ6VXNlcjkxMjc4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/91278331?v=4","gravatar_id":"","url":"https://api.github.com/users/lurnagao-dahua","html_url":"https://github.com/lurnagao-dahua","followers_url":"https://api.github.com/users/lurnagao-dahua/followers","following_url":"https://api.github.com/users/lurnagao-dahua/following{/other_user}","gists_url":"https://api.github.com/users/lurnagao-dahua/gists{/gist_id}","starred_url":"https://api.github.com/users/lurnagao-dahua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lurnagao-dahua/subscriptions","organizations_url":"https://api.github.com/users/lurnagao-dahua/orgs","repos_url":"https://api.github.com/users/lurnagao-dahua/repos","events_url":"https://api.github.com/users/lurnagao-dahua/events{/privacy}","received_events_url":"https://api.github.com/users/lurnagao-dahua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-03T02:26:45Z","updated_at":"2023-02-03T02:26:45Z","author_association":"CONTRIBUTOR","body":"the same problem by using hivecli(2.3.7) + mr + insert into iceberg_table(0.13.2)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414694746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414849197","html_url":"https://github.com/apache/iceberg/pull/6410#issuecomment-1414849197","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6410","id":1414849197,"node_id":"IC_kwDOCW7NX85UVOKt","user":{"login":"kmozaid","id":8354145,"node_id":"MDQ6VXNlcjgzNTQxNDU=","avatar_url":"https://avatars.githubusercontent.com/u/8354145?v=4","gravatar_id":"","url":"https://api.github.com/users/kmozaid","html_url":"https://github.com/kmozaid","followers_url":"https://api.github.com/users/kmozaid/followers","following_url":"https://api.github.com/users/kmozaid/following{/other_user}","gists_url":"https://api.github.com/users/kmozaid/gists{/gist_id}","starred_url":"https://api.github.com/users/kmozaid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kmozaid/subscriptions","organizations_url":"https://api.github.com/users/kmozaid/orgs","repos_url":"https://api.github.com/users/kmozaid/repos","events_url":"https://api.github.com/users/kmozaid/events{/privacy}","received_events_url":"https://api.github.com/users/kmozaid/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-03T03:58:39Z","updated_at":"2023-02-03T03:58:39Z","author_association":"CONTRIBUTOR","body":"@gaborkaszab @szehon-ho  Could you please trigger workflows?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414849197/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414874764","html_url":"https://github.com/apache/iceberg/issues/6725#issuecomment-1414874764","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6725","id":1414874764,"node_id":"IC_kwDOCW7NX85UVUaM","user":{"login":"0xffmeta","id":98149057,"node_id":"U_kgDOBdmiwQ","avatar_url":"https://avatars.githubusercontent.com/u/98149057?v=4","gravatar_id":"","url":"https://api.github.com/users/0xffmeta","html_url":"https://github.com/0xffmeta","followers_url":"https://api.github.com/users/0xffmeta/followers","following_url":"https://api.github.com/users/0xffmeta/following{/other_user}","gists_url":"https://api.github.com/users/0xffmeta/gists{/gist_id}","starred_url":"https://api.github.com/users/0xffmeta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/0xffmeta/subscriptions","organizations_url":"https://api.github.com/users/0xffmeta/orgs","repos_url":"https://api.github.com/users/0xffmeta/repos","events_url":"https://api.github.com/users/0xffmeta/events{/privacy}","received_events_url":"https://api.github.com/users/0xffmeta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-03T04:12:18Z","updated_at":"2023-02-03T04:12:18Z","author_association":"CONTRIBUTOR","body":"Do you think we can add one configuration to allow iceberg output the `_SUCCESS` file to external path? For most of the use cases in our company, we need to listen to the sensor file to trigger the downstream jobs in airflow. Otherwise, we need to connect to the query engine for the partition info. \r\nSo I think it might be a common case for other users as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414874764/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414972569","html_url":"https://github.com/apache/iceberg/issues/6725#issuecomment-1414972569","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6725","id":1414972569,"node_id":"IC_kwDOCW7NX85UVsSZ","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-03T05:05:07Z","updated_at":"2023-02-03T05:05:07Z","author_association":"MEMBER","body":"That doesn't make sense to me. Would we add success on just the first time? What happens on subsequent modifications?\n\nIt's way simpler to just use the Java api(if you don't want to use a full engine) to see if there are any files for a given partition. \n\nIn Iceberg we also don't require files to be in any specific directory, so for example with object store location provider we end up with basically every file in its own path. Where would we keep the success file then? Again the source of truth for an iceberg table is only known by reading the current metadata.json so the Java APIs are the way to go if you don't want to use Spark or trino. \n\nOr if you want you can just listen for changes in the catalog, whenever metadata location properly has changed, you know the table has been committed to.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1414972569/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1415230512","html_url":"https://github.com/apache/iceberg/pull/6695#issuecomment-1415230512","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6695","id":1415230512,"node_id":"IC_kwDOCW7NX85UWrQw","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-03T07:33:48Z","updated_at":"2023-02-03T07:33:48Z","author_association":"MEMBER","body":"@aokolnychyi: back ported PR details. \r\n3.2: https://github.com/apache/iceberg/pull/6730\r\n3.1: https://github.com/apache/iceberg/pull/6731\r\n2.4: https://github.com/apache/iceberg/pull/6733","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1415230512/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1415254316","html_url":"https://github.com/apache/iceberg/issues/6725#issuecomment-1415254316","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6725","id":1415254316,"node_id":"IC_kwDOCW7NX85UWxEs","user":{"login":"0xffmeta","id":98149057,"node_id":"U_kgDOBdmiwQ","avatar_url":"https://avatars.githubusercontent.com/u/98149057?v=4","gravatar_id":"","url":"https://api.github.com/users/0xffmeta","html_url":"https://github.com/0xffmeta","followers_url":"https://api.github.com/users/0xffmeta/followers","following_url":"https://api.github.com/users/0xffmeta/following{/other_user}","gists_url":"https://api.github.com/users/0xffmeta/gists{/gist_id}","starred_url":"https://api.github.com/users/0xffmeta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/0xffmeta/subscriptions","organizations_url":"https://api.github.com/users/0xffmeta/orgs","repos_url":"https://api.github.com/users/0xffmeta/repos","events_url":"https://api.github.com/users/0xffmeta/events{/privacy}","received_events_url":"https://api.github.com/users/0xffmeta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-03T07:46:48Z","updated_at":"2023-02-03T07:46:48Z","author_association":"CONTRIBUTOR","body":"For our case, we just need to add success file for the first time to let the downstream know that the daily or hourly partition is ready to consume. On subsequent update, we leverage the timestamp of the success file to dertermain the downstream behaviour. \r\n\r\nAgree that we should maintian only one source of truth, and it's a good idea to use the Java api to fetch the information. \r\n\r\nMany thanks for your explanation!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1415254316/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1415854391","html_url":"https://github.com/apache/iceberg/pull/6648#issuecomment-1415854391","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6648","id":1415854391,"node_id":"IC_kwDOCW7NX85UZDk3","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-03T13:13:19Z","updated_at":"2023-02-03T13:13:19Z","author_association":"CONTRIBUTOR","body":"Merged to master.\r\nThanks @szehon-ho and @amogh-jahagirdar for the reviews!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1415854391/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1415973878","html_url":"https://github.com/apache/iceberg/pull/6570#issuecomment-1415973878","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6570","id":1415973878,"node_id":"IC_kwDOCW7NX85UZgv2","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-03T14:45:56Z","updated_at":"2023-02-03T14:45:56Z","author_association":"CONTRIBUTOR","body":"@szehon-ho, @RussellSpitzer: Updated after the merge of the lock refactor.\r\nThis is a much smaller/straightforward change now.\r\nCould you please review?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1415973878/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1416063538","html_url":"https://github.com/apache/iceberg/pull/6712#issuecomment-1416063538","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6712","id":1416063538,"node_id":"IC_kwDOCW7NX85UZ2oy","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-03T15:57:06Z","updated_at":"2023-02-03T15:57:06Z","author_association":"MEMBER","body":"> Letâ€™s wait with this one until Nessieâ€˜s v2 API is out of beta and included in a Nessie release.\r\nRushing this likely causes more trouble Than necessary\r\n\r\nACK. \r\nMoved to Draft considering V2 APIs cannot change much once we expose them to the users via iceberg release. \r\nPR can wait till v2 to move out of \"beta\" status. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1416063538/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1416139097","html_url":"https://github.com/apache/iceberg/pull/6728#issuecomment-1416139097","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6728","id":1416139097,"node_id":"IC_kwDOCW7NX85UaJFZ","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-03T16:56:27Z","updated_at":"2023-02-03T16:56:27Z","author_association":"CONTRIBUTOR","body":"Thanks for the fixes, let's definitely enable scala checkstyle asap to avoid issues like this.\r\n\r\nAlso I think there are some other fixes in the tests that Liwei found, could you also fix those?\r\n\r\nAnd the title of the PR should probably change.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1416139097/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]