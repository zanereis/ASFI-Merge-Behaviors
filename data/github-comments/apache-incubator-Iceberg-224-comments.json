[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386216107","html_url":"https://github.com/apache/iceberg/issues/6587#issuecomment-1386216107","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6587","id":1386216107,"node_id":"IC_kwDOCW7NX85Sn_qr","user":{"login":"dmgcodevil","id":1413873,"node_id":"MDQ6VXNlcjE0MTM4NzM=","avatar_url":"https://avatars.githubusercontent.com/u/1413873?v=4","gravatar_id":"","url":"https://api.github.com/users/dmgcodevil","html_url":"https://github.com/dmgcodevil","followers_url":"https://api.github.com/users/dmgcodevil/followers","following_url":"https://api.github.com/users/dmgcodevil/following{/other_user}","gists_url":"https://api.github.com/users/dmgcodevil/gists{/gist_id}","starred_url":"https://api.github.com/users/dmgcodevil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmgcodevil/subscriptions","organizations_url":"https://api.github.com/users/dmgcodevil/orgs","repos_url":"https://api.github.com/users/dmgcodevil/repos","events_url":"https://api.github.com/users/dmgcodevil/events{/privacy}","received_events_url":"https://api.github.com/users/dmgcodevil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-17T23:20:04Z","updated_at":"2023-01-17T23:20:04Z","author_association":"CONTRIBUTOR","body":"Partition spec before update:\r\n\r\n```\r\n    \"fields\" : [ {\r\n      \"name\" : \"timestamp1_day\",\r\n      \"transform\" : \"day\",\r\n      \"source-id\" : 2,\r\n      \"field-id\" : 1000\r\n    } ]\r\n```\r\n\r\nAfter:\r\n\r\n```\r\n    \"fields\" : [ {\r\n      \"name\" : \"timestamp1_day\",\r\n      \"transform\" : \"void\",\r\n      \"source-id\" : 2,\r\n      \"field-id\" : 1000\r\n    }, {\r\n      \"name\" : \"timestamp2_day\",\r\n      \"transform\" : \"day\",\r\n      \"source-id\" : 3,\r\n      \"field-id\" : 1001\r\n    } ]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386216107/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386250259","html_url":"https://github.com/apache/iceberg/issues/6587#issuecomment-1386250259","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6587","id":1386250259,"node_id":"IC_kwDOCW7NX85SoIAT","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-17T23:48:35Z","updated_at":"2023-01-17T23:48:46Z","author_association":"MEMBER","body":"That is valid, it basically represents a transform that previously existed but was dropped. This is how V1 tables have to represent table structure. This could be one of several bugs though that were fixed in 0.13 that handled partition evolution","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386250259/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386268825","html_url":"https://github.com/apache/iceberg/issues/5058#issuecomment-1386268825","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5058","id":1386268825,"node_id":"IC_kwDOCW7NX85SoMiZ","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T00:11:53Z","updated_at":"2023-01-18T00:11:53Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386268825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386268858","html_url":"https://github.com/apache/iceberg/issues/4930#issuecomment-1386268858","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4930","id":1386268858,"node_id":"IC_kwDOCW7NX85SoMi6","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T00:11:55Z","updated_at":"2023-01-18T00:11:55Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386268858/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386282157","html_url":"https://github.com/apache/iceberg/pull/6432#issuecomment-1386282157","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6432","id":1386282157,"node_id":"IC_kwDOCW7NX85SoPyt","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T00:27:42Z","updated_at":"2023-01-18T00:27:42Z","author_association":"CONTRIBUTOR","body":"Thanks, @rbalamohan! It's close, just a couple more things to fix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386282157/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386283202","html_url":"https://github.com/apache/iceberg/pull/6252#issuecomment-1386283202","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6252","id":1386283202,"node_id":"IC_kwDOCW7NX85SoQDC","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T00:28:53Z","updated_at":"2023-01-18T00:28:53Z","author_association":"CONTRIBUTOR","body":"@huaxingao, I was hoping that you would take over the PR. I'm sorry that I missed your note saying that you were waiting for me to get it in! Please incorporate those changes into yours.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386283202/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386287383","html_url":"https://github.com/apache/iceberg/pull/6252#issuecomment-1386287383","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6252","id":1386287383,"node_id":"IC_kwDOCW7NX85SoREX","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T00:33:19Z","updated_at":"2023-01-18T00:33:19Z","author_association":"CONTRIBUTOR","body":"@rdblue \r\n> I was hoping that you would take over the PR\r\n\r\nWill do. Thank you very much for your reply!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386287383/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386288340","html_url":"https://github.com/apache/iceberg/pull/6611#issuecomment-1386288340","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6611","id":1386288340,"node_id":"IC_kwDOCW7NX85SoRTU","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T00:34:27Z","updated_at":"2023-01-18T00:34:27Z","author_association":"CONTRIBUTOR","body":"I think the reason it was optional is to support cases where views are created via API rather than by a SQL parser. If you don't have an analyzer, you may not know the output of the SQL query.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386288340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386300159","html_url":"https://github.com/apache/iceberg/issues/6587#issuecomment-1386300159","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6587","id":1386300159,"node_id":"IC_kwDOCW7NX85SoUL_","user":{"login":"dmgcodevil","id":1413873,"node_id":"MDQ6VXNlcjE0MTM4NzM=","avatar_url":"https://avatars.githubusercontent.com/u/1413873?v=4","gravatar_id":"","url":"https://api.github.com/users/dmgcodevil","html_url":"https://github.com/dmgcodevil","followers_url":"https://api.github.com/users/dmgcodevil/followers","following_url":"https://api.github.com/users/dmgcodevil/following{/other_user}","gists_url":"https://api.github.com/users/dmgcodevil/gists{/gist_id}","starred_url":"https://api.github.com/users/dmgcodevil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmgcodevil/subscriptions","organizations_url":"https://api.github.com/users/dmgcodevil/orgs","repos_url":"https://api.github.com/users/dmgcodevil/repos","events_url":"https://api.github.com/users/dmgcodevil/events{/privacy}","received_events_url":"https://api.github.com/users/dmgcodevil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T00:49:22Z","updated_at":"2023-01-18T01:18:43Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer I forgot that we also partition by another field using `bucket` transform. original spec:\r\n\r\n```json\r\n  \"partition-spec\" : [ {\r\n    \"name\" : \"timestamp1_day\",\r\n    \"transform\" : \"day\",\r\n    \"source-id\" : 2,\r\n    \"field-id\" : 1000\r\n  }, {\r\n    \"name\" : \"id_bucket\",\r\n    \"transform\" : \"bucket[5]\",\r\n    \"source-id\" : 1,\r\n    \"field-id\" : 1001\r\n  } ],\r\n```\r\n\r\nFolder structure:\r\n\r\n```\r\n/timestamp1_day=2023-01-01/id_bucket=1/\r\n```\r\n\r\n\r\nAfter update:\r\n\r\nSpec:\r\n\r\n\r\n```json\r\n  \"partition-spec\" : [ {\r\n    \"name\" : \"timestamp1_day\",\r\n    \"transform\" : \"void\",\r\n    \"source-id\" : 2,\r\n    \"field-id\" : 1000\r\n  }, {\r\n    \"name\" : \"id_bucket\",\r\n    \"transform\" : \"bucket[5]\",\r\n    \"source-id\" : 1,\r\n    \"field-id\" : 1001\r\n  }, {\r\n    \"name\" : \"timestamp2_day\",\r\n    \"transform\" : \"day\",\r\n    \"source-id\" : 3,\r\n    \"field-id\" : 1002\r\n  } ]\r\n```\r\n\r\nFolder structure:\r\n\r\n```\r\n/timestamp1_day=null/id_bucket=1/timestamp2_day=2023-01-03/\r\n```\r\n\r\nThe folder structure is different from the original, i.e.: `id_bucket`  comes before `timestamp2_day`. Is it expected?\r\n\r\nI **reproduced** `Wrong class, java.lang.Long, for object: 19367`, \r\n\r\nCompaction is not working work for the uncompacted files created using the original spec.\r\n\r\nI updated my [example](https://bbgithub.dev.bloomberg.com/gist/rpliashkou/40f63ae0c2db036cfb2840185d916296)\r\n\r\nCould someone please advice what I can do to compact the old files?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386300159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386332134","html_url":"https://github.com/apache/iceberg/issues/6587#issuecomment-1386332134","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6587","id":1386332134,"node_id":"IC_kwDOCW7NX85Sob_m","user":{"login":"dmgcodevil","id":1413873,"node_id":"MDQ6VXNlcjE0MTM4NzM=","avatar_url":"https://avatars.githubusercontent.com/u/1413873?v=4","gravatar_id":"","url":"https://api.github.com/users/dmgcodevil","html_url":"https://github.com/dmgcodevil","followers_url":"https://api.github.com/users/dmgcodevil/followers","following_url":"https://api.github.com/users/dmgcodevil/following{/other_user}","gists_url":"https://api.github.com/users/dmgcodevil/gists{/gist_id}","starred_url":"https://api.github.com/users/dmgcodevil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmgcodevil/subscriptions","organizations_url":"https://api.github.com/users/dmgcodevil/orgs","repos_url":"https://api.github.com/users/dmgcodevil/repos","events_url":"https://api.github.com/users/dmgcodevil/events{/privacy}","received_events_url":"https://api.github.com/users/dmgcodevil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T01:26:40Z","updated_at":"2023-01-18T01:26:40Z","author_association":"CONTRIBUTOR","body":"cc/ @RussellSpitzer","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386332134/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386354696","html_url":"https://github.com/apache/iceberg/pull/6611#issuecomment-1386354696","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6611","id":1386354696,"node_id":"IC_kwDOCW7NX85SohgI","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T01:56:46Z","updated_at":"2023-01-18T01:56:46Z","author_association":"CONTRIBUTOR","body":"> I think the reason it was optional is to support cases where views are created via API rather than by a SQL parser\r\n\r\nNice that we are clarifying this now. If we support this case of no schema, it means the view will \"auto-update\" itself when the source table schemas change. This might be a good thing or bad thing depending on the use case. \r\n\r\nI think in most database systems at this moment, view schema is fixed at creation time. For example, if we support this in Trino, since we cannot derive the schema and cannot fulfill the `List<ViewColumn> columns` part of the `ConnectorViewDefinition`, we will fail at`checkViewStaleness`. Core Trino logic needs to be updated to support this case, but it is still achieveable.\r\n\r\nI also checked mySQL, https://dev.mysql.com/doc/refman/8.0/en/alter-table.html, the wording here for ALTER TABLE RENAME COLUMN:\r\n\r\n>  Views and stored programs that refer to the renamed column. You must manually alter the definition of these objects to refer to the new column name. \r\n\r\nseems to suggest the view schema definition is fixed.\r\n\r\nI don't know if there is any ANSI definition or other places that specify a fixed schema is a requirement for view. Is anyone aware of that?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386354696/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386371990","html_url":"https://github.com/apache/iceberg/issues/6587#issuecomment-1386371990","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6587","id":1386371990,"node_id":"IC_kwDOCW7NX85SoluW","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T02:13:59Z","updated_at":"2023-01-18T02:13:59Z","author_association":"MEMBER","body":"Have you tried with more recent version? The directory structure really doesn't matter and I'm pretty sure you are just hitting an older version bug.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386371990/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386396949","html_url":"https://github.com/apache/iceberg/pull/5234#issuecomment-1386396949","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5234","id":1386396949,"node_id":"IC_kwDOCW7NX85Sor0V","user":{"login":"namrathamyske","id":17932873,"node_id":"MDQ6VXNlcjE3OTMyODcz","avatar_url":"https://avatars.githubusercontent.com/u/17932873?v=4","gravatar_id":"","url":"https://api.github.com/users/namrathamyske","html_url":"https://github.com/namrathamyske","followers_url":"https://api.github.com/users/namrathamyske/followers","following_url":"https://api.github.com/users/namrathamyske/following{/other_user}","gists_url":"https://api.github.com/users/namrathamyske/gists{/gist_id}","starred_url":"https://api.github.com/users/namrathamyske/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/namrathamyske/subscriptions","organizations_url":"https://api.github.com/users/namrathamyske/orgs","repos_url":"https://api.github.com/users/namrathamyske/repos","events_url":"https://api.github.com/users/namrathamyske/events{/privacy}","received_events_url":"https://api.github.com/users/namrathamyske/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T02:46:08Z","updated_at":"2023-01-18T02:46:08Z","author_association":"CONTRIBUTOR","body":"@rdblue Appreciate your feedback on this!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386396949/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386445704","html_url":"https://github.com/apache/iceberg/issues/6455#issuecomment-1386445704","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6455","id":1386445704,"node_id":"IC_kwDOCW7NX85So3uI","user":{"login":"xuzhiwen1255","id":105710753,"node_id":"U_kgDOBk0EoQ","avatar_url":"https://avatars.githubusercontent.com/u/105710753?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzhiwen1255","html_url":"https://github.com/xuzhiwen1255","followers_url":"https://api.github.com/users/xuzhiwen1255/followers","following_url":"https://api.github.com/users/xuzhiwen1255/following{/other_user}","gists_url":"https://api.github.com/users/xuzhiwen1255/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzhiwen1255/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzhiwen1255/subscriptions","organizations_url":"https://api.github.com/users/xuzhiwen1255/orgs","repos_url":"https://api.github.com/users/xuzhiwen1255/repos","events_url":"https://api.github.com/users/xuzhiwen1255/events{/privacy}","received_events_url":"https://api.github.com/users/xuzhiwen1255/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T03:50:39Z","updated_at":"2023-01-18T03:50:39Z","author_association":"CONTRIBUTOR","body":"I found the cause of the problem and tried to solve it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386445704/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386446054","html_url":"https://github.com/apache/iceberg/pull/6614#issuecomment-1386446054","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6614","id":1386446054,"node_id":"IC_kwDOCW7NX85So3zm","user":{"login":"xuzhiwen1255","id":105710753,"node_id":"U_kgDOBk0EoQ","avatar_url":"https://avatars.githubusercontent.com/u/105710753?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzhiwen1255","html_url":"https://github.com/xuzhiwen1255","followers_url":"https://api.github.com/users/xuzhiwen1255/followers","following_url":"https://api.github.com/users/xuzhiwen1255/following{/other_user}","gists_url":"https://api.github.com/users/xuzhiwen1255/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzhiwen1255/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzhiwen1255/subscriptions","organizations_url":"https://api.github.com/users/xuzhiwen1255/orgs","repos_url":"https://api.github.com/users/xuzhiwen1255/repos","events_url":"https://api.github.com/users/xuzhiwen1255/events{/privacy}","received_events_url":"https://api.github.com/users/xuzhiwen1255/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T03:51:18Z","updated_at":"2023-01-18T03:51:18Z","author_association":"CONTRIBUTOR","body":"@stevenzwu Can you have a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386446054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386456036","html_url":"https://github.com/apache/iceberg/issues/6587#issuecomment-1386456036","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6587","id":1386456036,"node_id":"IC_kwDOCW7NX85So6Pk","user":{"login":"dmgcodevil","id":1413873,"node_id":"MDQ6VXNlcjE0MTM4NzM=","avatar_url":"https://avatars.githubusercontent.com/u/1413873?v=4","gravatar_id":"","url":"https://api.github.com/users/dmgcodevil","html_url":"https://github.com/dmgcodevil","followers_url":"https://api.github.com/users/dmgcodevil/followers","following_url":"https://api.github.com/users/dmgcodevil/following{/other_user}","gists_url":"https://api.github.com/users/dmgcodevil/gists{/gist_id}","starred_url":"https://api.github.com/users/dmgcodevil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmgcodevil/subscriptions","organizations_url":"https://api.github.com/users/dmgcodevil/orgs","repos_url":"https://api.github.com/users/dmgcodevil/repos","events_url":"https://api.github.com/users/dmgcodevil/events{/privacy}","received_events_url":"https://api.github.com/users/dmgcodevil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T04:06:18Z","updated_at":"2023-01-18T04:06:18Z","author_association":"CONTRIBUTOR","body":"I tried `0.13.2` and got the following error:\r\n\r\n```\r\nRequired table missing : \"DBS\" in Catalog \"\" Schema \"\". DataNucleus requires this table to perform its persistence operations. Either your MetaData is incorrect, or you need to enable \"datanucleus.schema.autoCreateTables\"\r\norg.datanucleus.store.rdbms.exceptions.MissingTableException: Required table missing : \"DBS\" in Catalog \"\" Schema \"\". DataNucleus requires this table to perform its persistence operations. Either your MetaData is incorrect, or you need to enable \"datanucleus.schema.autoCreateTables\"\r\n\tat org.datanucleus.store.rdbms.table.AbstractTable.exists(AbstractTable.java:606)\r\n\tat org.datanucleus.store.rdbms.RDBMSStoreManager$ClassAdder.performTablesValidation(RDBMSStoreManager.java:3385)\r\n\tat org.datanucleus.store.rdbms.RDBMSStoreManager$ClassAdder.run(RDBMSStoreManager.java:2896)\r\n\tat org.datanucleus.store.rdbms.AbstractSchemaTransaction.execute(AbstractSchemaTransaction.java:119)\r\n\tat org.datanucleus.store.rdbms.RDBMSStoreManager.manageClasses(RDBMSStoreManager.java:1627)\r\n\tat org.datanucleus.store.rdbms.RDBMSStoreManager.getDatastoreClass(RDBMSStoreManager.java:672)\r\n\tat org.datanucleus.store.rdbms.query.RDBMSQueryUtils.getStatementForCandidates(RDBMSQueryUtils.java:425)\r\n\tat org.datanucleus.store.rdbms.query.JDOQLQuery.compileQueryFull(JDOQLQuery.java:865)\r\n\tat org.datanucleus.store.rdbms.query.JDOQLQuery.compileInternal(JDOQLQuery.java:347)\r\n\tat org.datanucleus.store.query.Query.executeQuery(Query.java:1816)\r\n\tat org.datanucleus.store.query.Query.executeWithArray(Query.java:1744)\r\n\tat org.datanucleus.store.query.Query.execute(Query.java:1726)\r\n\tat org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:374)\r\n\tat org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:216)\r\n\tat org.apache.hadoop.hive.metastore.MetaStoreDirectSql.ensureDbInit(MetaStoreDirectSql.java:181\r\n```\r\n\r\nIs it because we are running the old version of hive metastore ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386456036/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386459320","html_url":"https://github.com/apache/iceberg/issues/6587#issuecomment-1386459320","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6587","id":1386459320,"node_id":"IC_kwDOCW7NX85So7C4","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T04:10:38Z","updated_at":"2023-01-18T04:10:38Z","author_association":"MEMBER","body":"That is because released are Flink version specific after that point, latest release is now is 1.1\n\nhttps://repo.maven.apache.org/maven2/org/apache/iceberg/iceberg-flink-runtime-1.16/1.1.0/\n\nNot that the Flink version should matter here. It's the latest Spark version you should be using since that's what is compacting\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386459320/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386460001","html_url":"https://github.com/apache/iceberg/issues/6587#issuecomment-1386460001","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6587","id":1386460001,"node_id":"IC_kwDOCW7NX85So7Nh","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T04:11:24Z","updated_at":"2023-01-18T04:12:29Z","author_association":"MEMBER","body":"Your metastore error says that no external hive metastore was configured and it's falling back to local file based hive mode. That's probably not what you want\n\nI could have that wrong though, it may just be wrong hms version for the client...","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386460001/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386579067","html_url":"https://github.com/apache/iceberg/pull/6432#issuecomment-1386579067","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6432","id":1386579067,"node_id":"IC_kwDOCW7NX85SpYR7","user":{"login":"rbalamohan","id":7969713,"node_id":"MDQ6VXNlcjc5Njk3MTM=","avatar_url":"https://avatars.githubusercontent.com/u/7969713?v=4","gravatar_id":"","url":"https://api.github.com/users/rbalamohan","html_url":"https://github.com/rbalamohan","followers_url":"https://api.github.com/users/rbalamohan/followers","following_url":"https://api.github.com/users/rbalamohan/following{/other_user}","gists_url":"https://api.github.com/users/rbalamohan/gists{/gist_id}","starred_url":"https://api.github.com/users/rbalamohan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rbalamohan/subscriptions","organizations_url":"https://api.github.com/users/rbalamohan/orgs","repos_url":"https://api.github.com/users/rbalamohan/repos","events_url":"https://api.github.com/users/rbalamohan/events{/privacy}","received_events_url":"https://api.github.com/users/rbalamohan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T07:00:43Z","updated_at":"2023-01-18T07:00:43Z","author_association":"CONTRIBUTOR","body":"Addressed review comments in latest PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386579067/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386690853","html_url":"https://github.com/apache/iceberg/pull/6074#issuecomment-1386690853","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6074","id":1386690853,"node_id":"IC_kwDOCW7NX85Spzkl","user":{"login":"gaborkaszab","id":29145491,"node_id":"MDQ6VXNlcjI5MTQ1NDkx","avatar_url":"https://avatars.githubusercontent.com/u/29145491?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborkaszab","html_url":"https://github.com/gaborkaszab","followers_url":"https://api.github.com/users/gaborkaszab/followers","following_url":"https://api.github.com/users/gaborkaszab/following{/other_user}","gists_url":"https://api.github.com/users/gaborkaszab/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborkaszab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborkaszab/subscriptions","organizations_url":"https://api.github.com/users/gaborkaszab/orgs","repos_url":"https://api.github.com/users/gaborkaszab/repos","events_url":"https://api.github.com/users/gaborkaszab/events{/privacy}","received_events_url":"https://api.github.com/users/gaborkaszab/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T08:48:33Z","updated_at":"2023-01-18T08:48:33Z","author_association":"COLLABORATOR","body":"Hey @rdblue,\r\nI added this to the 1.2.0 milestone if I'm not mistaken there is only an open question wrt a Precondition check, and a related Impala commit has been waiting for this since Oct.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386690853/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386711261","html_url":"https://github.com/apache/iceberg/pull/6578#issuecomment-1386711261","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6578","id":1386711261,"node_id":"IC_kwDOCW7NX85Sp4jd","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T09:04:38Z","updated_at":"2023-01-18T09:04:38Z","author_association":"CONTRIBUTOR","body":"We dicussed offline with @danielcweeks and @rdblue to slim down the PR to only cover `POST` requests for now as that is the only type of request we need the response headers from in #6169 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1386711261/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1387321574","html_url":"https://github.com/apache/iceberg/issues/4563#issuecomment-1387321574","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4563","id":1387321574,"node_id":"IC_kwDOCW7NX85SsNjm","user":{"login":"alexjo2144","id":7109804,"node_id":"MDQ6VXNlcjcxMDk4MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/7109804?v=4","gravatar_id":"","url":"https://api.github.com/users/alexjo2144","html_url":"https://github.com/alexjo2144","followers_url":"https://api.github.com/users/alexjo2144/followers","following_url":"https://api.github.com/users/alexjo2144/following{/other_user}","gists_url":"https://api.github.com/users/alexjo2144/gists{/gist_id}","starred_url":"https://api.github.com/users/alexjo2144/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexjo2144/subscriptions","organizations_url":"https://api.github.com/users/alexjo2144/orgs","repos_url":"https://api.github.com/users/alexjo2144/repos","events_url":"https://api.github.com/users/alexjo2144/events{/privacy}","received_events_url":"https://api.github.com/users/alexjo2144/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T16:08:45Z","updated_at":"2023-01-18T16:08:45Z","author_association":"CONTRIBUTOR","body":"This should be reopened","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1387321574/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1387375582","html_url":"https://github.com/apache/iceberg/issues/6615#issuecomment-1387375582","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6615","id":1387375582,"node_id":"IC_kwDOCW7NX85Ssave","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T16:46:57Z","updated_at":"2023-01-18T16:46:57Z","author_association":"MEMBER","body":"Do you have the full error? There is nothing specific I can think of that would prohibit this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1387375582/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1387383457","html_url":"https://github.com/apache/iceberg/issues/6587#issuecomment-1387383457","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6587","id":1387383457,"node_id":"IC_kwDOCW7NX85Sscqh","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T16:52:40Z","updated_at":"2023-01-18T16:52:40Z","author_association":"MEMBER","body":"Looking at this again now, the error says you are using a direct RDBMS as your hive metastore, is this correct? I'm not as familiar with how this works but I do believe it means that it is missing expected tables and the direct rdbms hive client isn't currently enabled to make them. If you have already been using this RDBMS as hive it probably does mean it was previously used directly with a different version. If you are running a stand alone hive metastore I would connect to that directly.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1387383457/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1387393382","html_url":"https://github.com/apache/iceberg/issues/6587#issuecomment-1387393382","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6587","id":1387393382,"node_id":"IC_kwDOCW7NX85SsfFm","user":{"login":"dmgcodevil","id":1413873,"node_id":"MDQ6VXNlcjE0MTM4NzM=","avatar_url":"https://avatars.githubusercontent.com/u/1413873?v=4","gravatar_id":"","url":"https://api.github.com/users/dmgcodevil","html_url":"https://github.com/dmgcodevil","followers_url":"https://api.github.com/users/dmgcodevil/followers","following_url":"https://api.github.com/users/dmgcodevil/following{/other_user}","gists_url":"https://api.github.com/users/dmgcodevil/gists{/gist_id}","starred_url":"https://api.github.com/users/dmgcodevil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmgcodevil/subscriptions","organizations_url":"https://api.github.com/users/dmgcodevil/orgs","repos_url":"https://api.github.com/users/dmgcodevil/repos","events_url":"https://api.github.com/users/dmgcodevil/events{/privacy}","received_events_url":"https://api.github.com/users/dmgcodevil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T16:59:43Z","updated_at":"2023-01-18T16:59:43Z","author_association":"CONTRIBUTOR","body":"Yes, we are using a standalone metastore backed by MySql database. I tested `0.13.2` w/o metastore and it's working. I believe we need to update the metastore db schema","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1387393382/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1387440358","html_url":"https://github.com/apache/iceberg/pull/6324#issuecomment-1387440358","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6324","id":1387440358,"node_id":"IC_kwDOCW7NX85Ssqjm","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T17:19:11Z","updated_at":"2023-01-18T17:19:11Z","author_association":"CONTRIBUTOR","body":"Thanks, @haizhou-zhao!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1387440358/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1387520958","html_url":"https://github.com/apache/iceberg/pull/6575#issuecomment-1387520958","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6575","id":1387520958,"node_id":"IC_kwDOCW7NX85Ss-O-","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T18:25:43Z","updated_at":"2023-01-18T18:25:43Z","author_association":"CONTRIBUTOR","body":"> we also need to update this SQL syntax in https://github.com/apache/iceberg/blob/master/docs/spark-queries.md#sql\r\n\r\nI think @amogh-jahagirdar is working on a more detailed doc for branching and tagging, I will leave this part to him 😝 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1387520958/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1387592902","html_url":"https://github.com/apache/iceberg/pull/6614#issuecomment-1387592902","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6614","id":1387592902,"node_id":"IC_kwDOCW7NX85StPzG","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T18:56:14Z","updated_at":"2023-01-18T18:57:54Z","author_association":"CONTRIBUTOR","body":"@xuzhiwen1255 thanks a lot for the root cause analysis. I agree with your conclusion. Let's discuss what is the right fix though. I am not sure we should add the extra complexity for `JdbcCatalog` and `ClientPoolImpl`.\r\n\r\nI was wondering why this doesn't happen for `HiveCatalog`. Turns out the difference is that `JdbcCatalog` is `Closeable`. Flink `TableLoader` has the following close behavior, which seems fine to me.\r\n```\r\n    @Override\r\n    public void close() throws IOException {\r\n      if (catalog instanceof Closeable) {\r\n        ((Closeable) catalog).close();\r\n      }\r\n    }\r\n```\r\n\r\nBoth `FlinkSource` and the new FLIP-27 `IcebergSource` has the same usage pattern of `TableLoader` in the source construction. Here is the code snippet from `FlinkSource`.\r\n```\r\n    public FlinkInputFormat buildFormat() {\r\n      Preconditions.checkNotNull(tableLoader, \"TableLoader should not be null\");\r\n\r\n      Schema icebergSchema;\r\n      FileIO io;\r\n      EncryptionManager encryption;\r\n      if (table == null) {\r\n        // load required fields by table loader.\r\n        tableLoader.open();\r\n        try (TableLoader loader = tableLoader) {\r\n          table = loader.loadTable();\r\n          icebergSchema = table.schema();\r\n          io = table.io();\r\n          encryption = table.encryption();\r\n        } catch (IOException e) {\r\n          throw new UncheckedIOException(e);\r\n        }\r\n      } else {\r\n```\r\n\r\nI guess issue #6455 is probably the firs report of using closeable `JdbcCatalog` in Flink source. Both `FlinkSource` and FLIP-27 `IcebergSource` need to load a `Table` object to extract fields like schema, io, etc. \r\n\r\nThis issue/PR pointed out the problem of reusing the `TableLoader` object for internal table loading inside the `FlinkSource` or `IcebergSource`. One alternative fix is to add a `clone()` method to Flink `TableLoader` interface. Then the source internal usage of `TableLoader` can open and close the cloned `TableLoader` object, which avoids the close of the original `TableLoader` object.\r\n\r\nThis is a more fundamental change. Hence, I would like to get more feedbacks from @hililiwei @pvary @rdblue .\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1387592902/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1387599939","html_url":"https://github.com/apache/iceberg/pull/6614#issuecomment-1387599939","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6614","id":1387599939,"node_id":"IC_kwDOCW7NX85StRhD","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T18:59:13Z","updated_at":"2023-01-18T18:59:13Z","author_association":"CONTRIBUTOR","body":"BTW, this usage pattern of `TableLoader` also exists in `FlinkSink`.\r\n\r\n```\r\n    private <T> DataStreamSink<T> chainIcebergOperators() {\r\n      Preconditions.checkArgument(\r\n          inputCreator != null,\r\n          \"Please use forRowData() or forMapperOutputType() to initialize the input DataStream.\");\r\n      Preconditions.checkNotNull(tableLoader, \"Table loader shouldn't be null\");\r\n\r\n      DataStream<RowData> rowDataInput = inputCreator.apply(uidPrefix);\r\n\r\n      if (table == null) {\r\n        tableLoader.open();\r\n        try (TableLoader loader = tableLoader) {\r\n          this.table = loader.loadTable();\r\n        } catch (IOException e) {\r\n          throw new UncheckedIOException(\r\n              \"Failed to load iceberg table from table loader: \" + tableLoader, e);\r\n        }\r\n      }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1387599939/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1387630786","html_url":"https://github.com/apache/iceberg/pull/6581#issuecomment-1387630786","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6581","id":1387630786,"node_id":"IC_kwDOCW7NX85StZDC","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T19:17:43Z","updated_at":"2023-01-18T19:21:41Z","author_association":"COLLABORATOR","body":"Chatting with @aokolnychyi , @RussellSpitzer , to do an analysis on when this can be useful.\r\n\r\n\r\nThere will be two types of operations that can remove delete files:\r\n\r\n| Operation   | Cost | File Type | Description |\r\n| --- | --- | --- | --- | \r\n| RemoveDanglingDeletes (this one)   |  Metadata-Only, cost will be like querying files/partition table  |  Both | Removes position deletes with sequence number less than that of the min sequence number of all data files in each partition |\r\n| RewritePositionDeletes (to be developed)  |   Data-operation, need to read/write all concerned delete files | Position only (Equality Deletes will need to be converted to PositionDeletes) | Read all position delete files satisfying given filter, write them back out , filtering out position delete entries that refer to data files that no longer exist |\r\n\r\nAnalysis: RemoveDanglingDeleteFiles is cheaper and simpler, and can work across both types of files out of the box.  However, to get it to exactly work, we need the following conditions:  RewriteDataFiles being run with:\r\n* Filter that includes entire partition(s)\r\n* All data files in the partition with delete files gets rewritten, ie any of these:\r\n  * rewrite-all=true\r\n  * delete-file-threshold=1\r\n  * All data files happen to meet the criteria of rewrite without these flags.\r\n* 'use-starting-sequence-number' needs to be false.  This is to properly identify old delete files as invalid using sequence number rule.  This is only needed for position-deletes, as equality-deletes are not applied to equivalent sequence number.\r\n\r\nNote RemoveDanglingDeleteFiles can still remove some delete files if these conditions are not met, but just it may not do so for all dangling delete files, because an old data file (one with a low sequence number) not rewritten in a partition will prevent delete files from getting removed.\r\n\r\nSo Im open to whether there is a good use-case of this.  One idea is to bundle this with RewriteDataFiles, and if trigger optimistically if these conditions are met, or trigger in any case in hopes it will remove delete files as, as its relatively cheap.\r\n\r\nOtherwise, the complete solution (all to be developed) would be:\r\nFor position deletes, run RewritePositionDeletes across all partitions\r\nFor equality deletes, run ConvertToPosDeletes, then RewritePositionDeletes across all partitions.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1387630786/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1387728844","html_url":"https://github.com/apache/iceberg/pull/6588#issuecomment-1387728844","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6588","id":1387728844,"node_id":"IC_kwDOCW7NX85Stw_M","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T20:21:02Z","updated_at":"2023-01-18T20:21:02Z","author_association":"CONTRIBUTOR","body":"Let me take a look soon.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1387728844/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396089374","html_url":"https://github.com/apache/iceberg/pull/6621#issuecomment-1396089374","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6621","id":1396089374,"node_id":"IC_kwDOCW7NX85TNqIe","user":{"login":"haizhou-zhao","id":6187287,"node_id":"MDQ6VXNlcjYxODcyODc=","avatar_url":"https://avatars.githubusercontent.com/u/6187287?v=4","gravatar_id":"","url":"https://api.github.com/users/haizhou-zhao","html_url":"https://github.com/haizhou-zhao","followers_url":"https://api.github.com/users/haizhou-zhao/followers","following_url":"https://api.github.com/users/haizhou-zhao/following{/other_user}","gists_url":"https://api.github.com/users/haizhou-zhao/gists{/gist_id}","starred_url":"https://api.github.com/users/haizhou-zhao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haizhou-zhao/subscriptions","organizations_url":"https://api.github.com/users/haizhou-zhao/orgs","repos_url":"https://api.github.com/users/haizhou-zhao/repos","events_url":"https://api.github.com/users/haizhou-zhao/events{/privacy}","received_events_url":"https://api.github.com/users/haizhou-zhao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T21:07:34Z","updated_at":"2023-01-18T21:07:34Z","author_association":"CONTRIBUTOR","body":"@gaborkaszab @danielcweeks @szehon-ho This is a follow up on previous PR at https://github.com/apache/iceberg/pull/6324, where @gaborkaszab and I discussed and believe it would be great to support alter/drop table ownership operations for HiveCatalog.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396089374/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396138663","html_url":"https://github.com/apache/iceberg/pull/6618#issuecomment-1396138663","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6618","id":1396138663,"node_id":"IC_kwDOCW7NX85TN2Kn","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T21:55:18Z","updated_at":"2023-01-18T21:55:18Z","author_association":"CONTRIBUTOR","body":"Thanks for fixing this @amogh-jahagirdar , and thanks for everyone's review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396138663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396195901","html_url":"https://github.com/apache/iceberg/pull/6611#issuecomment-1396195901","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6611","id":1396195901,"node_id":"IC_kwDOCW7NX85TOEI9","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T22:46:39Z","updated_at":"2023-01-18T22:46:39Z","author_association":"CONTRIBUTOR","body":"Now I think about it, I guess if there is already an existing use case for schema not present, then we probably have to support that regardless of any existing standards. So I think we can close this PR for now. @amogh-jahagirdar ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396195901/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396207315","html_url":"https://github.com/apache/iceberg/pull/6588#issuecomment-1396207315","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6588","id":1396207315,"node_id":"IC_kwDOCW7NX85TOG7T","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T23:02:03Z","updated_at":"2023-01-18T23:02:03Z","author_association":"MEMBER","body":"Talking with @aokolnychyi we decided we are going to take a slightly broader approach here. Rather than allowing each action to define it's own method of deleting and using custom executor services, we will fall back to each FileIO's bulk delete support. We will then add a basic parallel default delete to HDFS for bulk delete.\r\n\r\nAfter doing this we will deprecate all the \"parallel delete\" methods from the actions and procedures instead instructing users to use their IO specific parallelism controls.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396207315/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396222277","html_url":"https://github.com/apache/iceberg/pull/6611#issuecomment-1396222277","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6611","id":1396222277,"node_id":"IC_kwDOCW7NX85TOKlF","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T23:19:53Z","updated_at":"2023-01-18T23:19:53Z","author_association":"CONTRIBUTOR","body":"Thanks for the explanation @rdblue in that case yes I think it makes sense just to treat schema as optional in SQL view representation and close this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396222277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396243591","html_url":"https://github.com/apache/iceberg/pull/6575#issuecomment-1396243591","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6575","id":1396243591,"node_id":"IC_kwDOCW7NX85TOPyH","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-18T23:49:50Z","updated_at":"2023-01-18T23:49:50Z","author_association":"CONTRIBUTOR","body":"Thanks for the review everyone, I think there are enough votes and all concerns are addressed, I will go ahead merging this PR!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396243591/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396265183","html_url":"https://github.com/apache/iceberg/issues/5333#issuecomment-1396265183","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5333","id":1396265183,"node_id":"IC_kwDOCW7NX85TOVDf","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T00:11:39Z","updated_at":"2023-01-19T00:11:39Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396265183/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396265308","html_url":"https://github.com/apache/iceberg/issues/5219#issuecomment-1396265308","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5219","id":1396265308,"node_id":"IC_kwDOCW7NX85TOVFc","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T00:11:45Z","updated_at":"2023-01-19T00:11:45Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396265308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396265364","html_url":"https://github.com/apache/iceberg/issues/5140#issuecomment-1396265364","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5140","id":1396265364,"node_id":"IC_kwDOCW7NX85TOVGU","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T00:11:49Z","updated_at":"2023-01-19T00:11:49Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396265364/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396490947","html_url":"https://github.com/apache/iceberg/pull/6571#issuecomment-1396490947","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6571","id":1396490947,"node_id":"IC_kwDOCW7NX85TPMLD","user":{"login":"youngxinler","id":36697727,"node_id":"MDQ6VXNlcjM2Njk3NzI3","avatar_url":"https://avatars.githubusercontent.com/u/36697727?v=4","gravatar_id":"","url":"https://api.github.com/users/youngxinler","html_url":"https://github.com/youngxinler","followers_url":"https://api.github.com/users/youngxinler/followers","following_url":"https://api.github.com/users/youngxinler/following{/other_user}","gists_url":"https://api.github.com/users/youngxinler/gists{/gist_id}","starred_url":"https://api.github.com/users/youngxinler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/youngxinler/subscriptions","organizations_url":"https://api.github.com/users/youngxinler/orgs","repos_url":"https://api.github.com/users/youngxinler/repos","events_url":"https://api.github.com/users/youngxinler/events{/privacy}","received_events_url":"https://api.github.com/users/youngxinler/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T06:19:12Z","updated_at":"2023-01-19T06:19:12Z","author_association":"CONTRIBUTOR","body":"@jackye1995 @rdblue Can I trouble you if you have time to do a review?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396490947/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396504461","html_url":"https://github.com/apache/iceberg/pull/6614#issuecomment-1396504461","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6614","id":1396504461,"node_id":"IC_kwDOCW7NX85TPPeN","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T06:37:39Z","updated_at":"2023-01-19T06:41:55Z","author_association":"CONTRIBUTOR","body":"I need to think about this some more, but it feels strange to me that something which does not own an object 'closes' it.\r\n\r\nIf I understand correctly the `TabeLoader` is serializable, so in theory it should be cloneable too. We should also check the implications of this on the underlying JDBC/HMS pools as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396504461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396566666","html_url":"https://github.com/apache/iceberg/pull/6358#issuecomment-1396566666","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6358","id":1396566666,"node_id":"IC_kwDOCW7NX85TPeqK","user":{"login":"aajisaka","id":3403122,"node_id":"MDQ6VXNlcjM0MDMxMjI=","avatar_url":"https://avatars.githubusercontent.com/u/3403122?v=4","gravatar_id":"","url":"https://api.github.com/users/aajisaka","html_url":"https://github.com/aajisaka","followers_url":"https://api.github.com/users/aajisaka/followers","following_url":"https://api.github.com/users/aajisaka/following{/other_user}","gists_url":"https://api.github.com/users/aajisaka/gists{/gist_id}","starred_url":"https://api.github.com/users/aajisaka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aajisaka/subscriptions","organizations_url":"https://api.github.com/users/aajisaka/orgs","repos_url":"https://api.github.com/users/aajisaka/repos","events_url":"https://api.github.com/users/aajisaka/events{/privacy}","received_events_url":"https://api.github.com/users/aajisaka/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T07:52:33Z","updated_at":"2023-01-19T07:52:33Z","author_association":"MEMBER","body":"Can someone review the latest version?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396566666/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396585110","html_url":"https://github.com/apache/iceberg/pull/6609#issuecomment-1396585110","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6609","id":1396585110,"node_id":"IC_kwDOCW7NX85TPjKW","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T08:07:45Z","updated_at":"2023-01-19T08:07:45Z","author_association":"CONTRIBUTOR","body":"@rdblue thanks for reviewing, I've renamed the method and this should be good to merge now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396585110/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396606776","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1396606776","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1396606776,"node_id":"IC_kwDOCW7NX85TPoc4","user":{"login":"wmoustafa","id":10084105,"node_id":"MDQ6VXNlcjEwMDg0MTA1","avatar_url":"https://avatars.githubusercontent.com/u/10084105?v=4","gravatar_id":"","url":"https://api.github.com/users/wmoustafa","html_url":"https://github.com/wmoustafa","followers_url":"https://api.github.com/users/wmoustafa/followers","following_url":"https://api.github.com/users/wmoustafa/following{/other_user}","gists_url":"https://api.github.com/users/wmoustafa/gists{/gist_id}","starred_url":"https://api.github.com/users/wmoustafa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wmoustafa/subscriptions","organizations_url":"https://api.github.com/users/wmoustafa/orgs","repos_url":"https://api.github.com/users/wmoustafa/repos","events_url":"https://api.github.com/users/wmoustafa/events{/privacy}","received_events_url":"https://api.github.com/users/wmoustafa/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T08:27:59Z","updated_at":"2023-01-19T08:27:59Z","author_association":"CONTRIBUTOR","body":"I think refresh strategy is up to the engine to decide, and it could very well depend on some runtime factors/stats. So same view could leverage different refresh methods over time.\r\n\r\nI think there could be a hybrid design between Design 1 and Design 2, where some of the MV props (e.g., `allow-stale-data`) and pointer to storage table are kept in common view (as it is the case now in Design 1), while underlying table snapshot information are stored in storage table snapshot properties as @rdblue suggested (as it is the case now in Design 2). Reasoning for the pointer direction (view to table or table to view is discussed in [this thread ](https://docs.google.com/document/d/1QAuy-meSZ6Oy37iPym8sV_n7R2yKZOHunVR-ZWhhZ6Q/edit?disco=AAAAnaz8eEs)in the design doc).\r\n\r\n`allow-stale-data` could be enhanced to `allow-stale-data-within-ms`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396606776/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396778042","html_url":"https://github.com/apache/iceberg/issues/6615#issuecomment-1396778042","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6615","id":1396778042,"node_id":"IC_kwDOCW7NX85TQSQ6","user":{"login":"alex2308","id":14580661,"node_id":"MDQ6VXNlcjE0NTgwNjYx","avatar_url":"https://avatars.githubusercontent.com/u/14580661?v=4","gravatar_id":"","url":"https://api.github.com/users/alex2308","html_url":"https://github.com/alex2308","followers_url":"https://api.github.com/users/alex2308/followers","following_url":"https://api.github.com/users/alex2308/following{/other_user}","gists_url":"https://api.github.com/users/alex2308/gists{/gist_id}","starred_url":"https://api.github.com/users/alex2308/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alex2308/subscriptions","organizations_url":"https://api.github.com/users/alex2308/orgs","repos_url":"https://api.github.com/users/alex2308/repos","events_url":"https://api.github.com/users/alex2308/events{/privacy}","received_events_url":"https://api.github.com/users/alex2308/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T10:50:33Z","updated_at":"2023-01-19T10:50:33Z","author_association":"NONE","body":"That is the full error I receive in my notebook when running the MERGE INTO:\r\n\r\nAn error was encountered:\r\nrequirement failed\r\nTraceback (most recent call last):\r\n  File \"/mnt/yarn/usercache/livy/appcache/application_1674031569861_0002/container_1674031569861_0002_01_000001/pyspark.zip/pyspark/sql/session.py\", line 1034, in sql\r\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self)\r\n  File \"/mnt/yarn/usercache/livy/appcache/application_1674031569861_0002/container_1674031569861_0002_01_000001/py4j-0.10.9.5-src.zip/py4j/java_gateway.py\", line 1322, in __call__\r\n    answer, self.gateway_client, self.target_id, self.name)\r\n  File \"/mnt/yarn/usercache/livy/appcache/application_1674031569861_0002/container_1674031569861_0002_01_000001/pyspark.zip/pyspark/sql/utils.py\", line 196, in deco\r\n    raise converted from None\r\npyspark.sql.utils.IllegalArgumentException: requirement failed","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396778042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396826805","html_url":"https://github.com/apache/iceberg/pull/4602#issuecomment-1396826805","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4602","id":1396826805,"node_id":"IC_kwDOCW7NX85TQeK1","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T11:25:16Z","updated_at":"2023-01-19T11:25:16Z","author_association":"CONTRIBUTOR","body":"@felixYyu could you please rebase and address https://github.com/apache/iceberg/pull/4602#discussion_r987088357 so that we can get this PR reviewed & merged?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396826805/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396863614","html_url":"https://github.com/apache/iceberg/pull/6614#issuecomment-1396863614","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6614","id":1396863614,"node_id":"IC_kwDOCW7NX85TQnJ-","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T12:00:02Z","updated_at":"2023-01-19T15:48:44Z","author_association":"CONTRIBUTOR","body":"> This issue/PR pointed out the problem of reusing the TableLoader object for internal table loading inside the FlinkSource or IcebergSource. One alternative fix is to add a clone() method to Flink TableLoader interface. Then the source internal usage of TableLoader can open and close the cloned TableLoader object, which avoids the close of the original TableLoader object.\r\n\r\nWe can actually try to solve this problem from the inside of TableLoader, it makes sense to me to clone a table.\r\n\r\nBut I also wonder if: If a catalog is closed, do tables loaded with its internal objects need to be kept available?\r\n* If the answer is yes, `jdbcCatalog` doesn't seem to guarantee it. It closes its `jdbc pool` when it closes, this is one of the causes of this issuse.\r\nConsider the following code:\r\n```\r\nTable table = jdbcCatalog.loadTable(tableIdent);\r\njdbcCatalog.close();\r\n```\r\nThe `table` can not be used because its `JdbcClientPool` is closed.\r\n* If the answer is no, I'm going to vote for clone table plan.\r\n\r\nPlease correct me if I make a mistake. I need to continue thinking about this as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396863614/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396924742","html_url":"https://github.com/apache/iceberg/issues/6257#issuecomment-1396924742","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6257","id":1396924742,"node_id":"IC_kwDOCW7NX85TQ2FG","user":{"login":"gaborkaszab","id":29145491,"node_id":"MDQ6VXNlcjI5MTQ1NDkx","avatar_url":"https://avatars.githubusercontent.com/u/29145491?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborkaszab","html_url":"https://github.com/gaborkaszab","followers_url":"https://api.github.com/users/gaborkaszab/followers","following_url":"https://api.github.com/users/gaborkaszab/following{/other_user}","gists_url":"https://api.github.com/users/gaborkaszab/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborkaszab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborkaszab/subscriptions","organizations_url":"https://api.github.com/users/gaborkaszab/orgs","repos_url":"https://api.github.com/users/gaborkaszab/repos","events_url":"https://api.github.com/users/gaborkaszab/events{/privacy}","received_events_url":"https://api.github.com/users/gaborkaszab/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T12:48:55Z","updated_at":"2023-01-19T12:48:55Z","author_association":"COLLABORATOR","body":"The \"old\" partitions are present in the output of a partition metadata table query when the table has merge-on-read for updates. This is because for the partition metadata table the delete files are not applied to the data files to see what partitions are remaining. I think this is a bit misleading because now querying the partitions metadata table can have different results depending on copy-on-write or merge-on-read was used.\r\n\r\nIn order to fix this the delete files should be applied but that would break the idea of metadata table queries being lightweight and only requiring table metadata to produce the output. Regardless, I still think fixing this by applying the delete files would make sense (behind a flag?).\r\nCould you please share your thoughts, @szehon-ho @rdblue @danielcweeks ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396924742/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396954141","html_url":"https://github.com/apache/iceberg/pull/6474#issuecomment-1396954141","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6474","id":1396954141,"node_id":"IC_kwDOCW7NX85TQ9Qd","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T13:10:58Z","updated_at":"2023-01-19T13:10:58Z","author_association":"MEMBER","body":"> looks good to me\r\n\r\nthanks for your review @jackye1995 !\r\n\r\n>  would be good if we reach some consensus about the way for null check\r\n\r\ni prefer `checkNotNull`, but it's up for the project to decide\r\ni just hope this future decision isn't required for the merge here\r\n\r\nBTW, I am  the library's  user more frequently than its contributor. As a user, I would benefit from explicit indication which API methods accept nulls, and even more -- which can return nulls.\r\nWe keep asking \"can this be null\" question in PR reviews (eg here https://github.com/trinodb/trino/pull/14869#discussion_r1072388756)\r\nbut more often than not, we _forget_ to ask that question, potentially setting us to NPE failures.\r\n\r\nThis too, I would prefer to be a follow up, not a prerequisite for a merge here.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1396954141/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397035509","html_url":"https://github.com/apache/iceberg/pull/3973#issuecomment-1397035509","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3973","id":1397035509,"node_id":"IC_kwDOCW7NX85TRRH1","user":{"login":"kingeasternsun","id":5291739,"node_id":"MDQ6VXNlcjUyOTE3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/5291739?v=4","gravatar_id":"","url":"https://api.github.com/users/kingeasternsun","html_url":"https://github.com/kingeasternsun","followers_url":"https://api.github.com/users/kingeasternsun/followers","following_url":"https://api.github.com/users/kingeasternsun/following{/other_user}","gists_url":"https://api.github.com/users/kingeasternsun/gists{/gist_id}","starred_url":"https://api.github.com/users/kingeasternsun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingeasternsun/subscriptions","organizations_url":"https://api.github.com/users/kingeasternsun/orgs","repos_url":"https://api.github.com/users/kingeasternsun/repos","events_url":"https://api.github.com/users/kingeasternsun/events{/privacy}","received_events_url":"https://api.github.com/users/kingeasternsun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T14:07:40Z","updated_at":"2023-01-19T14:07:40Z","author_association":"CONTRIBUTOR","body":"Thanks  @RussellSpitzer  for your reviews, because the `BaseMigrateTableSparkAction.java` and  `BaseSnapshotTableSparkAction.java` not exist anymore, So I created a new PR https://github.com/apache/iceberg/pull/6624 based on the newest version, appreciate four your reviews. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397035509/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397047250","html_url":"https://github.com/apache/iceberg/pull/6474#issuecomment-1397047250","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6474","id":1397047250,"node_id":"IC_kwDOCW7NX85TRT_S","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T14:16:10Z","updated_at":"2023-01-19T14:16:10Z","author_association":"CONTRIBUTOR","body":"> BTW, I am the library's user more frequently than its contributor. As a user, I would benefit from explicit indication which API methods accept nulls, and even more -- which can return nulls. We keep asking \"can this be null\" question in PR reviews (eg here [trinodb/trino#14869 (comment)](https://github.com/trinodb/trino/pull/14869#discussion_r1072388756)) but more often than not, we _forget_ to ask that question, potentially setting us to NPE failures.\r\n> \r\n> This too, I would prefer to be a follow up, not a prerequisite for a merge here.\r\n\r\nI agree that it would improve things when it's more obvious that certain things can/cannot be null, e.g. through `@Nullable`. Maybe this is something we should mention on the ML to raise awareness?\r\n\r\nRe: cNN vs cA I think it's fine to go ahead and get this merged with what you prefer (assuming the error message is updated as mentioned above) as we don't want to block things from getting in while this is discussed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397047250/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397244506","html_url":"https://github.com/apache/iceberg/pull/6622#issuecomment-1397244506","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6622","id":1397244506,"node_id":"IC_kwDOCW7NX85TSEJa","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T16:22:56Z","updated_at":"2023-01-19T16:22:56Z","author_association":"CONTRIBUTOR","body":"@rdblue Could you please take a look when you have time? I am not so sure if I added you as co-author correctly. It looks suspicious.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397244506/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397252089","html_url":"https://github.com/apache/iceberg/issues/6615#issuecomment-1397252089","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6615","id":1397252089,"node_id":"IC_kwDOCW7NX85TSF_5","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T16:26:22Z","updated_at":"2023-01-19T16:26:22Z","author_association":"MEMBER","body":"Looks like Python is swallowing the error there ... there may be an error in the JVM log or the SparkUI that actually has real info in it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397252089/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397260633","html_url":"https://github.com/apache/iceberg/pull/6474#issuecomment-1397260633","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6474","id":1397260633,"node_id":"IC_kwDOCW7NX85TSIFZ","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T16:30:18Z","updated_at":"2023-01-19T16:30:18Z","author_association":"CONTRIBUTOR","body":"> We keep asking \"can this be null\" question in PR reviews\r\n\r\nYes this is the consequence of different styles of the projects. I like Trino's approach of checking null at every constructor and also use Optional as much as possible. For Iceberg, it would be ideal if nullability is at least indicated in documentation.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397260633/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397262420","html_url":"https://github.com/apache/iceberg/pull/6474#issuecomment-1397262420","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6474","id":1397262420,"node_id":"IC_kwDOCW7NX85TSIhU","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T16:31:00Z","updated_at":"2023-01-19T16:31:00Z","author_association":"CONTRIBUTOR","body":"I will merge this PR as suggested, and will create a Github issue for further discussion.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397262420/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397299644","html_url":"https://github.com/apache/iceberg/pull/6614#issuecomment-1397299644","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6614","id":1397299644,"node_id":"IC_kwDOCW7NX85TSRm8","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T16:54:57Z","updated_at":"2023-01-19T16:54:57Z","author_association":"CONTRIBUTOR","body":"> If a catalog is closed, do tables loaded with its internal objects need to be kept available?\r\n\r\n@hililiwei I think you have a good question here. if catalog is closed, should `Table` object loaded by the catalog be useable? it is unclear to me what's the answer. @rdblue, what's your take?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397299644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397302003","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1397302003","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1397302003,"node_id":"IC_kwDOCW7NX85TSSLz","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T16:56:38Z","updated_at":"2023-01-19T17:04:16Z","author_association":"CONTRIBUTOR","body":"> while underlying table snapshot information are stored in storage table snapshot properties \r\n\r\n+1, I think we are on the same page on this.\r\n\r\nIn my view it's still design 1. To me the difference of design 1 and 2 is what you read as the entry point, is that the view, or is that the storage table. So to me it's always the view.  Maybe that's the confusion point that I totally missed, what you guys have been saying design 2 is just storing some information in storage table.\r\n\r\nInformation about refresh definitely makes sense to be stored in the storage table corresponding to each snapshot. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397302003/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397349062","html_url":"https://github.com/apache/iceberg/issues/6257#issuecomment-1397349062","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6257","id":1397349062,"node_id":"IC_kwDOCW7NX85TSdrG","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T17:29:00Z","updated_at":"2023-01-19T17:29:14Z","author_association":"COLLABORATOR","body":"What would the algorithm be?  If the partition has delete files, try to do a full MOR, and check if records are null?  Personally, sounds a bit extreme, I would think a good first step is just add a column for delete_files (It may be easier after my new change in #6365).  After all, we do have a partition existing, just its of invalid delete files.  Interested to hear others thoughts as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397349062/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397386343","html_url":"https://github.com/apache/iceberg/pull/6626#issuecomment-1397386343","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6626","id":1397386343,"node_id":"IC_kwDOCW7NX85TSmxn","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T17:55:53Z","updated_at":"2023-01-19T17:55:53Z","author_association":"CONTRIBUTOR","body":"If we are checking non null, I think the current error message still makes more sense?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397386343/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397395046","html_url":"https://github.com/apache/iceberg/pull/6586#issuecomment-1397395046","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6586","id":1397395046,"node_id":"IC_kwDOCW7NX85TSo5m","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T18:02:54Z","updated_at":"2023-01-19T18:02:54Z","author_association":"CONTRIBUTOR","body":"@aajisaka can you also take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397395046/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397400315","html_url":"https://github.com/apache/iceberg/pull/6626#issuecomment-1397400315","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6626","id":1397400315,"node_id":"IC_kwDOCW7NX85TSqL7","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T18:06:47Z","updated_at":"2023-01-19T18:06:47Z","author_association":"CONTRIBUTOR","body":"> If we are checking non null, I think the current error message still makes more sense?\r\n\r\nnot sure, usually it's been called out on my own PRs to adjust the error msg to that particular format (hence the reason I mentioned it on the other PR), which is being used across other places in Iceberg","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397400315/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397579647","html_url":"https://github.com/apache/iceberg/pull/6626#issuecomment-1397579647","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6626","id":1397579647,"node_id":"IC_kwDOCW7NX85TTV9_","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T20:44:48Z","updated_at":"2023-01-19T20:44:48Z","author_association":"CONTRIBUTOR","body":"> not sure, usually it's been called out on my own PRs to adjust the error msg to that particular format (hence the reason I mentioned it on the other PR), which is being used across other places in Iceberg\r\n\r\nIn that case, would it be better for us to change all the related null checks to checkArgument, and update the checkstyle rule for it to avoid use of checkNotNull? I think we could take this opportunity to set some standards.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397579647/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397589244","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1397589244","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1397589244,"node_id":"IC_kwDOCW7NX85TTYT8","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T20:50:16Z","updated_at":"2023-01-19T20:50:16Z","author_association":"CONTRIBUTOR","body":"So just want to push the progress forward, I think we have some kind of loose consensus that:\r\n1. view + storage table is likely the general approach to go\r\n2. view stores pointer to the storage table, or potentially multiple storage tables\r\n3. storage table should store the information about each refresh as table snapshot properties, some reverse pointer to the view is also good to have\r\n\r\nIs that the right understanding? @rdblue @JanKaul @wmoustafa ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397589244/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397595262","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1397595262","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1397595262,"node_id":"IC_kwDOCW7NX85TTZx-","user":{"login":"wmoustafa","id":10084105,"node_id":"MDQ6VXNlcjEwMDg0MTA1","avatar_url":"https://avatars.githubusercontent.com/u/10084105?v=4","gravatar_id":"","url":"https://api.github.com/users/wmoustafa","html_url":"https://github.com/wmoustafa","followers_url":"https://api.github.com/users/wmoustafa/followers","following_url":"https://api.github.com/users/wmoustafa/following{/other_user}","gists_url":"https://api.github.com/users/wmoustafa/gists{/gist_id}","starred_url":"https://api.github.com/users/wmoustafa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wmoustafa/subscriptions","organizations_url":"https://api.github.com/users/wmoustafa/orgs","repos_url":"https://api.github.com/users/wmoustafa/repos","events_url":"https://api.github.com/users/wmoustafa/events{/privacy}","received_events_url":"https://api.github.com/users/wmoustafa/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T20:53:48Z","updated_at":"2023-01-19T20:53:48Z","author_association":"CONTRIBUTOR","body":"Agreed. Reverse pointer to the view will be hard to maintain, so I am inclined to not having it.\r\n\r\nI would say each view version could optionally map to a new storage table (say the view evolved in a backward incompatible way). Not sure if there is a strong use case for multiple tables for the same view version.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397595262/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397701478","html_url":"https://github.com/apache/iceberg/pull/6624#issuecomment-1397701478","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6624","id":1397701478,"node_id":"IC_kwDOCW7NX85TTztm","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T22:35:09Z","updated_at":"2023-01-19T23:26:32Z","author_association":"CONTRIBUTOR","body":"Left a review, thanks for the contribution @kingeasternsun !  Also looks like spotless checks are failing which you can fix by running `./gradlew :iceberg-api:spotlessJavaCheck`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397701478/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397711644","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1397711644","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1397711644,"node_id":"IC_kwDOCW7NX85TT2Mc","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T22:48:33Z","updated_at":"2023-01-19T22:48:33Z","author_association":"CONTRIBUTOR","body":"> Not sure if there is a strong use case for multiple tables for the same view version.\r\n\r\nI am thinking about the case where based on the predicate operating on the view, we can choose intelligently what storage table to use.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397711644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397732221","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1397732221","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1397732221,"node_id":"IC_kwDOCW7NX85TT7N9","user":{"login":"wmoustafa","id":10084105,"node_id":"MDQ6VXNlcjEwMDg0MTA1","avatar_url":"https://avatars.githubusercontent.com/u/10084105?v=4","gravatar_id":"","url":"https://api.github.com/users/wmoustafa","html_url":"https://github.com/wmoustafa","followers_url":"https://api.github.com/users/wmoustafa/followers","following_url":"https://api.github.com/users/wmoustafa/following{/other_user}","gists_url":"https://api.github.com/users/wmoustafa/gists{/gist_id}","starred_url":"https://api.github.com/users/wmoustafa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wmoustafa/subscriptions","organizations_url":"https://api.github.com/users/wmoustafa/orgs","repos_url":"https://api.github.com/users/wmoustafa/repos","events_url":"https://api.github.com/users/wmoustafa/events{/privacy}","received_events_url":"https://api.github.com/users/wmoustafa/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T23:15:44Z","updated_at":"2023-01-19T23:15:44Z","author_association":"CONTRIBUTOR","body":"> I am thinking about the case where based on the predicate operating on the view, we can choose intelligently what storage table to use.\r\n\r\nI think this is potentially a generic use case for all tables, not only MV storage tables. Generically speaking, a table (MV or not), identified by a UUID, could have multiple storage layouts, and execution engines can choose the best storage layout. MV still points to a single UUID.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397732221/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397742071","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1397742071","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1397742071,"node_id":"IC_kwDOCW7NX85TT9n3","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T23:30:29Z","updated_at":"2023-01-19T23:30:29Z","author_association":"CONTRIBUTOR","body":"> Generically speaking, a table (MV or not), identified by a UUID, could have multiple storage layouts, and execution engines can choose the best storage layout.\r\n\r\nThat's correct, but technically it could be argued that we can model everything as a view, backed by multiple storage tables, and we don't need to add more complexity into the table spec to support multiple storage layouts.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397742071/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397751094","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1397751094","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1397751094,"node_id":"IC_kwDOCW7NX85TT_02","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T23:45:44Z","updated_at":"2023-01-19T23:46:11Z","author_association":"CONTRIBUTOR","body":"I don't know if it would work or too crazy, just to throw the idea out that I just came up with:\r\n\r\nWe could potentially make MV a representation in view spec, in parallel to the SQL representation. So for a materialized view, it could have 2 representations:\r\n\r\n```\r\n[\r\n  {\r\n      \"type\" : \"sql\",\r\n      \"sql\" : \"SELECT \\\"count\\\"(*) my_cnt\\nFROM\\n  base_tab\\n\",\r\n      \"dialect\" : \"spark\",\r\n      \"schema-id\" : 2,\r\n      \"default-catalog\" : \"iceberg\",\r\n      \"default-namespace\" : [ \"anorwood\" ]\r\n    },\r\n    {\r\n      \"type\" : \"materialized\",\r\n      \"namespace\": \"some_namespace\"\r\n      \"table\" : \"some_storage_table\"\r\n    }\r\n]\r\n```\r\n\r\nBy doing so, you could support a case where 1 view does not really have a SQL representation, but just a few different table layouts:\r\n\r\n```\r\n[\r\n  {\r\n      \"type\" : \"materialized\",\r\n      \"namespace\": \"some_namespace\"\r\n      \"table\" : \"some_storage_table_partitioned_by_col1\"\r\n   },\r\n  {\r\n      \"type\" : \"materialized\",\r\n      \"namespace\": \"some_namespace\"\r\n      \"table\" : \"some_storage_table_partitioned_by_col2\"\r\n    }\r\n]\r\n```\r\n\r\nwhich satisfies the use case described by Walaa.\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397751094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397753231","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1397753231","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1397753231,"node_id":"IC_kwDOCW7NX85TUAWP","user":{"login":"wmoustafa","id":10084105,"node_id":"MDQ6VXNlcjEwMDg0MTA1","avatar_url":"https://avatars.githubusercontent.com/u/10084105?v=4","gravatar_id":"","url":"https://api.github.com/users/wmoustafa","html_url":"https://github.com/wmoustafa","followers_url":"https://api.github.com/users/wmoustafa/followers","following_url":"https://api.github.com/users/wmoustafa/following{/other_user}","gists_url":"https://api.github.com/users/wmoustafa/gists{/gist_id}","starred_url":"https://api.github.com/users/wmoustafa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wmoustafa/subscriptions","organizations_url":"https://api.github.com/users/wmoustafa/orgs","repos_url":"https://api.github.com/users/wmoustafa/repos","events_url":"https://api.github.com/users/wmoustafa/events{/privacy}","received_events_url":"https://api.github.com/users/wmoustafa/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T23:49:12Z","updated_at":"2023-01-19T23:50:56Z","author_association":"CONTRIBUTOR","body":"To clarify, I was saying that multiple representations are outside the scope of MVs, and could be part of standard table spec. Not sure if the proposal above is along the same lines (mentioning since I see `materialized` references above).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397753231/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397753619","html_url":"https://github.com/apache/iceberg/pull/6598#issuecomment-1397753619","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6598","id":1397753619,"node_id":"IC_kwDOCW7NX85TUAcT","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T23:49:51Z","updated_at":"2023-01-19T23:51:44Z","author_association":"CONTRIBUTOR","body":"We probably want to establish a standard in the community at this point on Immutable/Nullable or not. Right now we're in this partial state, where it's used in some cases. Defining a standard can help focus the discussion on fundamental areas. \r\n\r\nI do think Immutables are really nice at keeping boiler plate code to a minimum but I don't have a strong opinion other than just setting a standard practice in Iceberg :) \r\n\r\nMaybe it's worth kicking off on the mailing list just to get the wider community's perspective?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397753619/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397757916","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1397757916","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1397757916,"node_id":"IC_kwDOCW7NX85TUBfc","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-19T23:57:24Z","updated_at":"2023-01-19T23:57:24Z","author_association":"CONTRIBUTOR","body":"I am referring to the **view spec**, using the example here: https://iceberg.apache.org/view-spec/#appendix-a-an-example\r\n\r\nSo in design 1 where we say we want to have a pointer from view to storage table, the pointer is a new type of representation `materialized`.\r\n\r\nWe already support multiple representations as of today in the view spec, but today it only can have multiple SQL representations. \r\n\r\nBy adding this new type, it means a view can be backed by multiple storage tables, by adding more `materialized` representations. \r\n\r\nThe use case that you said about a table having multiple storage layout could also be modeled as a view with multiple `materialized` representations and no any SQL representation.\r\n\r\nIt's just a thought, not fully flushed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397757916/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397768506","html_url":"https://github.com/apache/iceberg/issues/5339#issuecomment-1397768506","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5339","id":1397768506,"node_id":"IC_kwDOCW7NX85TUEE6","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T00:12:17Z","updated_at":"2023-01-20T00:12:17Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397768506/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397789606","html_url":"https://github.com/apache/iceberg/pull/6617#issuecomment-1397789606","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6617","id":1397789606,"node_id":"IC_kwDOCW7NX85TUJOm","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T00:42:21Z","updated_at":"2023-01-20T00:42:21Z","author_association":"CONTRIBUTOR","body":"Ping some people for thoughts around the syntax: @rdblue @RussellSpitzer @nastra ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397789606/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397819184","html_url":"https://github.com/apache/iceberg/issues/6587#issuecomment-1397819184","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6587","id":1397819184,"node_id":"IC_kwDOCW7NX85TUQcw","user":{"login":"dmgcodevil","id":1413873,"node_id":"MDQ6VXNlcjE0MTM4NzM=","avatar_url":"https://avatars.githubusercontent.com/u/1413873?v=4","gravatar_id":"","url":"https://api.github.com/users/dmgcodevil","html_url":"https://github.com/dmgcodevil","followers_url":"https://api.github.com/users/dmgcodevil/followers","following_url":"https://api.github.com/users/dmgcodevil/following{/other_user}","gists_url":"https://api.github.com/users/dmgcodevil/gists{/gist_id}","starred_url":"https://api.github.com/users/dmgcodevil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmgcodevil/subscriptions","organizations_url":"https://api.github.com/users/dmgcodevil/orgs","repos_url":"https://api.github.com/users/dmgcodevil/repos","events_url":"https://api.github.com/users/dmgcodevil/events{/privacy}","received_events_url":"https://api.github.com/users/dmgcodevil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T01:32:42Z","updated_at":"2023-01-20T01:32:42Z","author_association":"CONTRIBUTOR","body":"Delete orphan files action is also affected after the schema change:\r\n\r\n```\r\njava.lang.ClassCastException: java.lang.Long cannot be cast to java.lang.Void\r\n\tat org.apache.iceberg.transforms.VoidTransform.toHumanString(VoidTransform.java:27)\r\n\tat org.apache.iceberg.ManifestsTable.partitionSummariesToRows(ManifestsTable.java:131)\r\n\tat org.apache.iceberg.ManifestsTable.manifestFileToRow(ManifestsTable.java:115)\r\n\tat org.apache.iceberg.AllManifestsTable$ManifestListReadTask.lambda$rows$0(AllManifestsTable.java:194)\r\n\tat org.apache.iceberg.io.CloseableIterable$4$1.next(CloseableIterable.java:113)\r\n\tat org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)\r\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)\r\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:52)\r\n\tat org.apache.spark.scheduler.Task.run(Task.scala:127)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:462)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1377)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:465)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:750)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397819184/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397847153","html_url":"https://github.com/apache/iceberg/issues/6606#issuecomment-1397847153","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6606","id":1397847153,"node_id":"IC_kwDOCW7NX85TUXRx","user":{"login":"cgpoh","id":11516015,"node_id":"MDQ6VXNlcjExNTE2MDE1","avatar_url":"https://avatars.githubusercontent.com/u/11516015?v=4","gravatar_id":"","url":"https://api.github.com/users/cgpoh","html_url":"https://github.com/cgpoh","followers_url":"https://api.github.com/users/cgpoh/followers","following_url":"https://api.github.com/users/cgpoh/following{/other_user}","gists_url":"https://api.github.com/users/cgpoh/gists{/gist_id}","starred_url":"https://api.github.com/users/cgpoh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cgpoh/subscriptions","organizations_url":"https://api.github.com/users/cgpoh/orgs","repos_url":"https://api.github.com/users/cgpoh/repos","events_url":"https://api.github.com/users/cgpoh/events{/privacy}","received_events_url":"https://api.github.com/users/cgpoh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T02:21:27Z","updated_at":"2023-01-20T02:21:27Z","author_association":"CONTRIBUTOR","body":"After looking into the code, realised that instead of having s3.connection.maximum in flink configuration, I should set the values in Hadoop configuration and pass in the configuration to HiveCatalog instead.\r\n\r\n```kotlin\r\nval conf = Configuration()\r\nconf[\"fs.s3a.connection.maximum\"] = 100\r\nval catalogLoader = CatalogLoader.hive(hiveCatalogName, conf, properties)\r\n```\r\n\r\nwith this, I can see the maximum connection is set to 100 in the log. I will close this issue for now as my job is running for 24hrs","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397847153/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397859049","html_url":"https://github.com/apache/iceberg/pull/6629#issuecomment-1397859049","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6629","id":1397859049,"node_id":"IC_kwDOCW7NX85TUaLp","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T02:43:59Z","updated_at":"2023-01-20T02:43:59Z","author_association":"MEMBER","body":"cc: @nastra, @Fokko  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397859049/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397883260","html_url":"https://github.com/apache/iceberg/pull/6588#issuecomment-1397883260","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6588","id":1397883260,"node_id":"IC_kwDOCW7NX85TUgF8","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T03:32:06Z","updated_at":"2023-01-20T03:32:06Z","author_association":"CONTRIBUTOR","body":"Thanks for clarifying @RussellSpitzer I think it makes a ton of sense to leave the specifics of bulk vs parallel to the FileIO abstraction. In this case, we leverage bulk delete wherever possible (S3) and then do parallel deletions for file systems which don't support bulk ops like HDFS to improve the throughput of deletions","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397883260/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397888851","html_url":"https://github.com/apache/iceberg/issues/6619#issuecomment-1397888851","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6619","id":1397888851,"node_id":"IC_kwDOCW7NX85TUhdT","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T03:46:05Z","updated_at":"2023-01-20T03:50:55Z","author_association":"CONTRIBUTOR","body":"Thanks for creating this issue, @anthonysgro could you provide more details on how you're recreating the table and pointing the location and how AWS Backup fits in?\r\n\r\nAs far as my understanding goes, for disaster recovery for Iceberg tables generally it's recommended to use S3 multi-region access points . You can check out https://github.com/apache/iceberg/issues/5779 this discussion for more details.\r\n\r\nSome docs which explain: \r\n\r\nhttps://aws.amazon.com/s3/features/multi-region-access-points/\r\nhttps://iceberg.apache.org/docs/latest/aws/#s3-access-points\r\n\r\nIf you desire S3 access point integration in Athena specifically, feel free to ping me on Slack! \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397888851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397956873","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1397956873","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1397956873,"node_id":"IC_kwDOCW7NX85TUyEJ","user":{"login":"JanKaul","id":19823005,"node_id":"MDQ6VXNlcjE5ODIzMDA1","avatar_url":"https://avatars.githubusercontent.com/u/19823005?v=4","gravatar_id":"","url":"https://api.github.com/users/JanKaul","html_url":"https://github.com/JanKaul","followers_url":"https://api.github.com/users/JanKaul/followers","following_url":"https://api.github.com/users/JanKaul/following{/other_user}","gists_url":"https://api.github.com/users/JanKaul/gists{/gist_id}","starred_url":"https://api.github.com/users/JanKaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JanKaul/subscriptions","organizations_url":"https://api.github.com/users/JanKaul/orgs","repos_url":"https://api.github.com/users/JanKaul/repos","events_url":"https://api.github.com/users/JanKaul/events{/privacy}","received_events_url":"https://api.github.com/users/JanKaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T06:02:23Z","updated_at":"2023-01-20T06:02:23Z","author_association":"NONE","body":"> I don't know if it would work or too crazy, just to throw the idea out that I just came up with:\n> \n> We could potentially make MV a representation in view spec, in parallel to the SQL representation. So for a materialized view, it could have 2 representations:\n> \n> ```\n> [\n>   {\n>       \"type\" : \"sql\",\n>       \"sql\" : \"SELECT \\\"count\\\"(*) my_cnt\\nFROM\\n  base_tab\\n\",\n>       \"dialect\" : \"spark\",\n>       \"schema-id\" : 2,\n>       \"default-catalog\" : \"iceberg\",\n>       \"default-namespace\" : [ \"anorwood\" ]\n>     },\n>     {\n>       \"type\" : \"materialized\",\n>       \"namespace\": \"some_namespace\"\n>       \"table\" : \"some_storage_table\"\n>     }\n> ]\n> ```\n> \n> By doing so, you could support a case where 1 view does not really have a SQL representation, but just a few different table layouts:\n> \n> ```\n> [\n>   {\n>       \"type\" : \"materialized\",\n>       \"namespace\": \"some_namespace\"\n>       \"table\" : \"some_storage_table_partitioned_by_col1\"\n>    },\n>   {\n>       \"type\" : \"materialized\",\n>       \"namespace\": \"some_namespace\"\n>       \"table\" : \"some_storage_table_partitioned_by_col2\"\n>     }\n> ]\n> ```\n> \n> which satisfies the use case described by Walaa.\n> \n> \n> \n> \n> \n\nGreat idea! I think this is a very clean solution to store the metadata. However I would rename the type to `sql_materialized` in case there are other representations in the future.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397956873/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397987523","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1397987523","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1397987523,"node_id":"IC_kwDOCW7NX85TU5jD","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T06:53:38Z","updated_at":"2023-01-20T06:53:38Z","author_association":"CONTRIBUTOR","body":"@JanKaul if you agree with the summarized consensus we have mostly reached there, for the sake of moving the progress of the discussion forward, could you update the Google doc with the design, and describe the spec changes based on the discussions and suggestions here and combine with your original idea? So that we can start to review the spec contents 💪 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1397987523/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398007171","html_url":"https://github.com/apache/iceberg/pull/6626#issuecomment-1398007171","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6626","id":1398007171,"node_id":"IC_kwDOCW7NX85TU-WD","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T07:21:21Z","updated_at":"2023-01-20T07:21:21Z","author_association":"CONTRIBUTOR","body":"> > not sure, usually it's been called out on my own PRs to adjust the error msg to that particular format (hence the reason I mentioned it on the other PR), which is being used across other places in Iceberg\r\n> \r\n> In that case, would it be better for us to change all the related null checks to checkArgument, and update the checkstyle rule for it to avoid use of checkNotNull? I think we could take this opportunity to set some standards.\r\n\r\nI think it's definitely worth discussing this so that people know what the accepted approach is and enforce it via checkstyle.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398007171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398096721","html_url":"https://github.com/apache/iceberg/issues/6625#issuecomment-1398096721","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6625","id":1398096721,"node_id":"IC_kwDOCW7NX85TVUNR","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T09:05:05Z","updated_at":"2023-01-20T09:05:05Z","author_association":"MEMBER","body":"> Also there is little indication in the codebase of which field could potentially be null. This causes a lot of confusions for external engine integrations like Trino.\r\n\r\nI am happy to contribute annotations for nullable or non-null elements, if that's what we agree to do.\r\nThis could look e.g. like this https://github.com/apache/iceberg/pull/4978, or maybe someone has better suggestions.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398096721/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398101212","html_url":"https://github.com/apache/iceberg/pull/6474#issuecomment-1398101212","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6474","id":1398101212,"node_id":"IC_kwDOCW7NX85TVVTc","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T09:07:55Z","updated_at":"2023-01-20T09:07:55Z","author_association":"MEMBER","body":"> Yes this is the consequence of different styles of the projects.\r\n\r\nThat's a good point.\r\nI accept the inherent friction being result of that, but I do hope some of that friction is avoidable.\r\n\r\n>  I like Trino's approach of checking null at every constructor and also use Optional as much as possible. \r\n\r\nI like it too. That's why I fully supported @kokosing's push for to leverage Optional whenever possible.\r\nThere are still some rare places that would benefit from improvement, but we're generally in quite a good shape with null-unfriendliness. \r\n\r\n> For Iceberg, it would be ideal if nullability is at least indicated in documentation.\r\n\r\n100% agreed, especially if you mean API-level documentation (javadoc, annotations), as that's what library users will see in their IDEs.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398101212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398101458","html_url":"https://github.com/apache/iceberg/pull/6474#issuecomment-1398101458","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6474","id":1398101458,"node_id":"IC_kwDOCW7NX85TVVXS","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T09:08:02Z","updated_at":"2023-01-20T09:08:02Z","author_association":"MEMBER","body":"thanks for the merge!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398101458/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398113386","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1398113386","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1398113386,"node_id":"IC_kwDOCW7NX85TVYRq","user":{"login":"JanKaul","id":19823005,"node_id":"MDQ6VXNlcjE5ODIzMDA1","avatar_url":"https://avatars.githubusercontent.com/u/19823005?v=4","gravatar_id":"","url":"https://api.github.com/users/JanKaul","html_url":"https://github.com/JanKaul","followers_url":"https://api.github.com/users/JanKaul/followers","following_url":"https://api.github.com/users/JanKaul/following{/other_user}","gists_url":"https://api.github.com/users/JanKaul/gists{/gist_id}","starred_url":"https://api.github.com/users/JanKaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JanKaul/subscriptions","organizations_url":"https://api.github.com/users/JanKaul/orgs","repos_url":"https://api.github.com/users/JanKaul/repos","events_url":"https://api.github.com/users/JanKaul/events{/privacy}","received_events_url":"https://api.github.com/users/JanKaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T09:15:20Z","updated_at":"2023-01-20T09:44:28Z","author_association":"NONE","body":"Yes, I agree with the proposed design 1. I'm not entirely sure what @rdblue prefers.\r\n\r\nI will update the Google doc accordingly.\r\n\r\nThe next question for me is where and how to store the refresh(freshness) information. There are currently two proposed solutions:\r\n\r\n1. Store refresh information in the summary field of a storage table snapshot\r\n2. Store refresh information in storage table properties\r\n\r\nI will create a section in the Google doc that summarizes these options.\r\n\r\nReact with the following if you prefer one of the solutions: \r\n:tada: for solution 1\r\n:rocket: for solution 2","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398113386/reactions","total_count":3,"+1":0,"-1":0,"laugh":0,"hooray":3,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398154903","html_url":"https://github.com/apache/iceberg/pull/6624#issuecomment-1398154903","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6624","id":1398154903,"node_id":"IC_kwDOCW7NX85TViaX","user":{"login":"kingeasternsun","id":5291739,"node_id":"MDQ6VXNlcjUyOTE3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/5291739?v=4","gravatar_id":"","url":"https://api.github.com/users/kingeasternsun","html_url":"https://github.com/kingeasternsun","followers_url":"https://api.github.com/users/kingeasternsun/followers","following_url":"https://api.github.com/users/kingeasternsun/following{/other_user}","gists_url":"https://api.github.com/users/kingeasternsun/gists{/gist_id}","starred_url":"https://api.github.com/users/kingeasternsun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingeasternsun/subscriptions","organizations_url":"https://api.github.com/users/kingeasternsun/orgs","repos_url":"https://api.github.com/users/kingeasternsun/repos","events_url":"https://api.github.com/users/kingeasternsun/events{/privacy}","received_events_url":"https://api.github.com/users/kingeasternsun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T09:55:14Z","updated_at":"2023-01-20T09:55:14Z","author_association":"CONTRIBUTOR","body":"> Left a review, thanks for the contribution @kingeasternsun ! Also looks like spotless checks are failing which you can fix by running `./gradlew :iceberg-api:spotlessJavaCheck`\r\n\r\nThanks for your advice, I have fixed them. Will you merge this please.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398154903/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398211777","html_url":"https://github.com/apache/iceberg/pull/6628#issuecomment-1398211777","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6628","id":1398211777,"node_id":"IC_kwDOCW7NX85TVwTB","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T10:48:12Z","updated_at":"2023-01-20T10:48:12Z","author_association":"MEMBER","body":"I think we can bump it to `0.47.1` now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398211777/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398240262","html_url":"https://github.com/apache/iceberg/issues/2040#issuecomment-1398240262","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2040","id":1398240262,"node_id":"IC_kwDOCW7NX85TV3QG","user":{"login":"mriveraFacephi","id":93125577,"node_id":"U_kgDOBYz7yQ","avatar_url":"https://avatars.githubusercontent.com/u/93125577?v=4","gravatar_id":"","url":"https://api.github.com/users/mriveraFacephi","html_url":"https://github.com/mriveraFacephi","followers_url":"https://api.github.com/users/mriveraFacephi/followers","following_url":"https://api.github.com/users/mriveraFacephi/following{/other_user}","gists_url":"https://api.github.com/users/mriveraFacephi/gists{/gist_id}","starred_url":"https://api.github.com/users/mriveraFacephi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mriveraFacephi/subscriptions","organizations_url":"https://api.github.com/users/mriveraFacephi/orgs","repos_url":"https://api.github.com/users/mriveraFacephi/repos","events_url":"https://api.github.com/users/mriveraFacephi/events{/privacy}","received_events_url":"https://api.github.com/users/mriveraFacephi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T11:15:05Z","updated_at":"2023-01-20T11:15:05Z","author_association":"NONE","body":"Same problem here with Spark 3.1.1 and Iceberg 0.13.1. I'm trying to write dataframe by using the Spark v2 API command writeTo. \r\nEvery column in my schema is nullable. In my case, I'm using AWS Glue, and the table metadata looks like:\r\n`\"Columns\": [\r\n      {\r\n        \"Name\": \"col\",\r\n        \"Type\": \"string\",\r\n        \"Parameters\": {\r\n          \"iceberg.field.current\": \"true\",\r\n          \"iceberg.field.id\": \"1\",\r\n          **\"iceberg.field.optional\": \"true\"**\r\n        }\r\n      },...`\r\n\r\nThanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398240262/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398396353","html_url":"https://github.com/apache/iceberg/issues/6257#issuecomment-1398396353","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6257","id":1398396353,"node_id":"IC_kwDOCW7NX85TWdXB","user":{"login":"gaborkaszab","id":29145491,"node_id":"MDQ6VXNlcjI5MTQ1NDkx","avatar_url":"https://avatars.githubusercontent.com/u/29145491?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborkaszab","html_url":"https://github.com/gaborkaszab","followers_url":"https://api.github.com/users/gaborkaszab/followers","following_url":"https://api.github.com/users/gaborkaszab/following{/other_user}","gists_url":"https://api.github.com/users/gaborkaszab/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborkaszab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborkaszab/subscriptions","organizations_url":"https://api.github.com/users/gaborkaszab/orgs","repos_url":"https://api.github.com/users/gaborkaszab/repos","events_url":"https://api.github.com/users/gaborkaszab/events{/privacy}","received_events_url":"https://api.github.com/users/gaborkaszab/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T13:31:39Z","updated_at":"2023-01-20T13:31:39Z","author_association":"COLLABORATOR","body":"> What would the algorithm be? If the partition has delete files, try to do a full MOR, and check if records are null? Personally, sounds a bit extreme, I would think a good first step is just add a column for delete_files (It may be easier after my new change in #6365). After all, we do have a partition existing, just its of invalid delete files. Interested to hear others thoughts as well.\r\n\r\nWell, giving this a second (and a third) thought I have to admit that applying delete file on the data files to get the partitions is too heavyweight. I'm wondering if we should document this behaviour somewhere as I remember on Slack there was someone confused about the 'record_count' column of the metadata table not adding up to the same value what count(*) gives.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398396353/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398572156","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1398572156","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1398572156,"node_id":"IC_kwDOCW7NX85TXIR8","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T15:38:02Z","updated_at":"2023-01-20T15:38:02Z","author_association":"CONTRIBUTOR","body":"I would +1 on storing in snapshot summary, because:\r\n1. snapshot corresponds very well to MV refresh, there is a 1:1 relationship between them.\r\n2. table properties is not versioned as well as snapshot, you cannot access previous able properties of a storage table easily\r\n\r\nI also agree with the suggestion of Ryan about the information to store, although I think storing the source tables referenced might be a bit hard, it requires statement analysis of the view.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398572156/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398577729","html_url":"https://github.com/apache/iceberg/issues/6625#issuecomment-1398577729","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6625","id":1398577729,"node_id":"IC_kwDOCW7NX85TXJpB","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T15:42:45Z","updated_at":"2023-01-20T15:42:45Z","author_association":"CONTRIBUTOR","body":"@nastra any thoughts?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398577729/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398623955","html_url":"https://github.com/apache/iceberg/issues/6625#issuecomment-1398623955","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6625","id":1398623955,"node_id":"IC_kwDOCW7NX85TXU7T","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T16:21:52Z","updated_at":"2023-01-20T16:21:52Z","author_association":"CONTRIBUTOR","body":"I also like annotations like `@Nullable` to indicate that certain things in the API can be nullable as this makes it easier to consume that particular API and reason about it. \r\nMaybe we don't need something like `@NonNull` (given that we'd have to agree from which library we'd want to use that annotation) if we could imply that whatever doesn't have `@Nullable` is automatically non-null.\r\nAn alternative would be the usage of `Optional`, but `@Nullable` would be my preferred option.\r\nHowever, I'd like to hear opinions & thoughts from other people as well on that topic.\r\n\r\n@jackye1995 should we maybe raise this discussion topic on the mailing list in order to increase visibility for people?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398623955/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398630489","html_url":"https://github.com/apache/iceberg/issues/6625#issuecomment-1398630489","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6625","id":1398630489,"node_id":"IC_kwDOCW7NX85TXWhZ","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T16:27:31Z","updated_at":"2023-01-20T16:27:31Z","author_association":"CONTRIBUTOR","body":"> should we maybe raise this discussion topic on the mailing list in order to increase visibility for people?\r\n\r\nYes agree, let's do that so we can reach a consensus and proceed to implementation. If there is no response we can raise it during the next sync meeting.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398630489/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398722055","html_url":"https://github.com/apache/iceberg/pull/6631#issuecomment-1398722055","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6631","id":1398722055,"node_id":"IC_kwDOCW7NX85TXs4H","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T17:32:39Z","updated_at":"2023-01-20T17:32:39Z","author_association":"CONTRIBUTOR","body":"I checked the following diff and found nothing related to the classes touched by PR #6584 \r\n\r\n```\r\n git diff --no-index  flink/v1.14/flink/src/ flink/v1.16/flink/src\r\n git diff --no-index  flink/v1.15/flink/src/ flink/v1.16/flink/src\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398722055/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398725654","html_url":"https://github.com/apache/iceberg/issues/6632#issuecomment-1398725654","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6632","id":1398725654,"node_id":"IC_kwDOCW7NX85TXtwW","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T17:36:17Z","updated_at":"2023-01-20T17:36:17Z","author_association":"CONTRIBUTOR","body":"I'm working on a fix for this @jackye1995 could you assign this to me? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398725654/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398734413","html_url":"https://github.com/apache/iceberg/issues/6632#issuecomment-1398734413","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6632","id":1398734413,"node_id":"IC_kwDOCW7NX85TXv5N","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T17:44:39Z","updated_at":"2023-01-20T17:44:39Z","author_association":"CONTRIBUTOR","body":"Sure, assigned!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398734413/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398780784","html_url":"https://github.com/apache/iceberg/pull/6627#issuecomment-1398780784","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6627","id":1398780784,"node_id":"IC_kwDOCW7NX85TX7Nw","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T18:31:55Z","updated_at":"2023-01-20T18:31:55Z","author_association":"CONTRIBUTOR","body":"Thanks for the update and reviews!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398780784/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398781852","html_url":"https://github.com/apache/iceberg/pull/6586#issuecomment-1398781852","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6586","id":1398781852,"node_id":"IC_kwDOCW7NX85TX7ec","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-20T18:33:02Z","updated_at":"2023-01-20T18:33:02Z","author_association":"CONTRIBUTOR","body":"Thanks for testing with Glue @aajisaka ! And thanks for the review @amogh-jahagirdar @nastra ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1398781852/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]