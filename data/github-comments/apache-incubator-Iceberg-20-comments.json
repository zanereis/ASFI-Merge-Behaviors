[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552053312","html_url":"https://github.com/apache/iceberg/pull/619#issuecomment-552053312","issue_url":"https://api.github.com/repos/apache/iceberg/issues/619","id":552053312,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjA1MzMxMg==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-09T01:46:00Z","updated_at":"2019-11-09T01:46:00Z","author_association":"COLLABORATOR","body":"@rdblue, Good idea. Let me update it","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552053312/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552055249","html_url":"https://github.com/apache/iceberg/pull/619#issuecomment-552055249","issue_url":"https://api.github.com/repos/apache/iceberg/issues/619","id":552055249,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjA1NTI0OQ==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-09T02:07:08Z","updated_at":"2019-11-09T02:30:20Z","author_association":"COLLABORATOR","body":"@rdblue, sorry I forgot that this visitor is different from `IndexByName` visitor since it directly returns null in `list` and `map` function. That is because we don't push `filedNames` in case of `List` and `Map` when visiting the schema, so the `testMixedTypes` test fails if we apply validation in `IndexByName`.\r\n\r\nFor example, when we define a mixed typed schema such as:\r\n```java\r\n    Schema schema = new Schema(\r\n        required(1, \"list_of_lists\",\r\n            ListType.ofOptional(2, ListType.ofOptional(3, StructType.of(\r\n                required(4, \"id\", LongType.get()))\r\n            ))));\r\n```\r\nIt throws exception like: \r\n`Invalid schema: multiple fields for name list_of_lists.element: 3 and 2\r\norg.apache.iceberg.exceptions.ValidationException: Invalid schema: multiple fields for name list_of_lists.element: 3 and 2\r\n`\r\n\r\nThe map returned by `TypeUtil.indexByName` actually cannot express the concept of list of list.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552055249/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552239946","html_url":"https://github.com/apache/iceberg/pull/589#issuecomment-552239946","issue_url":"https://api.github.com/repos/apache/iceberg/issues/589","id":552239946,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjIzOTk0Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-10T22:06:27Z","updated_at":"2019-11-10T22:06:27Z","author_association":"CONTRIBUTOR","body":"> Whether to keep Direction and NullOrder as enums or convert them to booleans\r\n\r\nI think that an enum works best in a builder API, but enums are best for the metadata format and table metadata API. We want to avoid passing boolean options as config, but we do want to model the data in the API as tightly as possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552239946/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552240175","html_url":"https://github.com/apache/iceberg/pull/589#issuecomment-552240175","issue_url":"https://api.github.com/repos/apache/iceberg/issues/589","id":552240175,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjI0MDE3NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-10T22:09:17Z","updated_at":"2019-11-10T22:09:17Z","author_association":"CONTRIBUTOR","body":"> Whether we need to have the actual logic for sort transformations in Iceberg or in query engines.\r\n\r\nI'd like to reuse the existing `Transform` classes, if possible. It would also be nice to add transforms to the `Expressions` API so that we can pass an expression, like `bucket(\"id\", 16)`, into the sort order builders.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552240175/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552240553","html_url":"https://github.com/apache/iceberg/pull/589#issuecomment-552240553","issue_url":"https://api.github.com/repos/apache/iceberg/issues/589","id":552240553,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjI0MDU1Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-10T22:13:40Z","updated_at":"2019-11-10T22:13:40Z","author_association":"CONTRIBUTOR","body":"> Avoid major changes in the Catalog API\r\n\r\nYeah, this is getting large. Maybe we should switch to a builder pattern for table creation as well, like this:\r\n\r\n```java\r\ncatalog.newTable(TableIdentifier.of(\"db\", \"table\"))\r\n    .addColumn(\"id\", IntegerType.get())\r\n    .addColumn(\"ts\", TimestampType.withZone())\r\n    .addColumn(\"data\", StringType.get())\r\n    .partitionBy(day(\"ts\"), bucket(\"id\", 16))\r\n    .orderBy(day(\"ts\"), bucket(\"id\", 16), identity(\"id\"))\r\n    .location(\"s3://bucket/warehouse/db.db/table\")\r\n    .create()\r\n```\r\n\r\nWe could use actions `create`, `createTransation`, `replaceTransaction`, and `createOrReplaceTransaction` instead of separate methods.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552240553/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552245568","html_url":"https://github.com/apache/iceberg/pull/619#issuecomment-552245568","issue_url":"https://api.github.com/repos/apache/iceberg/issues/619","id":552245568,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjI0NTU2OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-10T23:16:20Z","updated_at":"2019-11-10T23:16:20Z","author_association":"CONTRIBUTOR","body":"@chenjunjiedada, ignoring the problem when the name is \"element\" seems to solve that case:\r\n\r\n```java\r\n    Integer existingFieldId = nameToId.put(fullName, fieldId);\r\n    if (existingFieldId != null && !\"element\".equals(name)) {\r\n      throw new ValidationException(\r\n          \"Invalid schema: multiple fields for name %s: %s and %s\", fullName, existingFieldId, fieldId);\r\n    }\r\n```\r\n\r\nI think that's a reasonable fix for now. I think we should also go back and fix how these indexes are produced. The field names are only used in `IndexByName`, so I think we can fix this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552245568/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552245887","html_url":"https://github.com/apache/iceberg/pull/497#issuecomment-552245887","issue_url":"https://api.github.com/repos/apache/iceberg/issues/497","id":552245887,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjI0NTg4Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-10T23:20:27Z","updated_at":"2019-11-10T23:20:27Z","author_association":"CONTRIBUTOR","body":"@yathindranath, are you still working on this? Is there anything we can help with?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552245887/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552250455","html_url":"https://github.com/apache/iceberg/pull/619#issuecomment-552250455","issue_url":"https://api.github.com/repos/apache/iceberg/issues/619","id":552250455,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjI1MDQ1NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-11T00:12:54Z","updated_at":"2019-11-11T00:12:54Z","author_association":"CONTRIBUTOR","body":"@chenjunjiedada, I submitted a fix for the indexing problem with the `ValidationException` in #627. Can you take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552250455/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552250477","html_url":"https://github.com/apache/iceberg/pull/627#issuecomment-552250477","issue_url":"https://api.github.com/repos/apache/iceberg/issues/627","id":552250477,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjI1MDQ3Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-11T00:13:04Z","updated_at":"2019-11-11T00:13:04Z","author_association":"CONTRIBUTOR","body":"FYI @rdsr","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552250477/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552251126","html_url":"https://github.com/apache/iceberg/pull/585#issuecomment-552251126","issue_url":"https://api.github.com/repos/apache/iceberg/issues/585","id":552251126,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjI1MTEyNg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-11T00:18:59Z","updated_at":"2019-11-11T00:18:59Z","author_association":"CONTRIBUTOR","body":"@andrei-ionescu, let me know if you need any assistance with this. I think it will be great to get this fixed and remove the hacky unsafe projections in Spark!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552251126/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552257139","html_url":"https://github.com/apache/iceberg/pull/529#issuecomment-552257139","issue_url":"https://api.github.com/repos/apache/iceberg/issues/529","id":552257139,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjI1NzEzOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-11T01:14:23Z","updated_at":"2019-11-11T01:14:23Z","author_association":"CONTRIBUTOR","body":"Thanks @chenjunjiedada! I've left a fairly thorough review. It will be great to get this in!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552257139/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552294753","html_url":"https://github.com/apache/iceberg/pull/627#issuecomment-552294753","issue_url":"https://api.github.com/repos/apache/iceberg/issues/627","id":552294753,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjI5NDc1Mw==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-11T05:05:50Z","updated_at":"2019-11-11T05:05:50Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue I'll take a look","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552294753/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552307470","html_url":"https://github.com/apache/iceberg/pull/619#issuecomment-552307470","issue_url":"https://api.github.com/repos/apache/iceberg/issues/619","id":552307470,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjMwNzQ3MA==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-11T06:11:14Z","updated_at":"2019-11-11T06:11:14Z","author_association":"COLLABORATOR","body":"Sure, will take a look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552307470/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552441091","html_url":"https://github.com/apache/iceberg/pull/624#issuecomment-552441091","issue_url":"https://api.github.com/repos/apache/iceberg/issues/624","id":552441091,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjQ0MTA5MQ==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-11T13:16:07Z","updated_at":"2019-11-11T13:16:07Z","author_association":"COLLABORATOR","body":"LGTM, +1.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552441091/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552485021","html_url":"https://github.com/apache/iceberg/issues/621#issuecomment-552485021","issue_url":"https://api.github.com/repos/apache/iceberg/issues/621","id":552485021,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjQ4NTAyMQ==","user":{"login":"asheeshgarg","id":4348671,"node_id":"MDQ6VXNlcjQzNDg2NzE=","avatar_url":"https://avatars.githubusercontent.com/u/4348671?v=4","gravatar_id":"","url":"https://api.github.com/users/asheeshgarg","html_url":"https://github.com/asheeshgarg","followers_url":"https://api.github.com/users/asheeshgarg/followers","following_url":"https://api.github.com/users/asheeshgarg/following{/other_user}","gists_url":"https://api.github.com/users/asheeshgarg/gists{/gist_id}","starred_url":"https://api.github.com/users/asheeshgarg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asheeshgarg/subscriptions","organizations_url":"https://api.github.com/users/asheeshgarg/orgs","repos_url":"https://api.github.com/users/asheeshgarg/repos","events_url":"https://api.github.com/users/asheeshgarg/events{/privacy}","received_events_url":"https://api.github.com/users/asheeshgarg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-11T15:14:36Z","updated_at":"2019-12-18T21:48:34Z","author_association":"NONE","body":"```scala\r\ndef writeData(dataFrame: DataFrame, path: String, format: String, mode: SaveMode): Unit = {\r\n  val tables = new HadoopTables(spark.sparkContext.hadoopConfiguration)\r\n  val schema = SparkSchemaUtil.convert(dataFrame.schema)\r\n  val partitionSpec = PartitionSpec.builderFor(SparkSchemaUtil.convert(dataFrame.schema)).build()\r\n  tables.create(schema, partitionSpec, path)\r\n  dataFrame\r\n    .write\r\n    .format(format)\r\n    .mode(mode)\r\n    .partitionBy(\"DATE\")\r\n    .save(path)\r\n}\r\nval icebergTableLoc = s\"${storeLocation}/iceberg/eqty/reference\"\r\nwriteData(refDf, deltaLakeTableLoc, \"iceberg\", SaveMode.Append)\r\n\r\nval icebergTableLoc = s\"${storeLocation}/iceberg/eqty/pricing\"\r\nwriteData(pricingDf, icebergTableLoc, \"iceberg\", SaveMode.Append)\r\n```\r\n\r\nAbove method is used to generate the data which 30 days of the reference and pricing data.\r\nData loaded is pariting by date so I see roughly equally sized data in the reference and pricing store in the parquet file created in iceberg.\r\n\r\nRead operation is performed using\r\n```scala\r\n  spark.read.format(\"iceberg\").load(\"iceberg/eqty/reference\").join(spark.read.format(\"iceberg\").load(\"iceberg/eqty/pricing\"),Seq(\"ID_BB_GLOBAL\",\"DATE\")).count()\r\n```\r\n\r\nAs soon as you do this you see the error I mentioned in the original request.\r\nIf you repartition data to more partition it worked.\r\n\r\nAs mentioned it worked directly with raw Parquet and I also tried the similar join using Apache delta it worked. So size of the data is really fine. \r\nAs we don't want to arbitrarily reparation the data.\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552485021/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552529517","html_url":"https://github.com/apache/iceberg/pull/627#issuecomment-552529517","issue_url":"https://api.github.com/repos/apache/iceberg/issues/627","id":552529517,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjUyOTUxNw==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-11T17:07:08Z","updated_at":"2019-11-11T17:07:08Z","author_association":"COLLABORATOR","body":"Looks like it still not work for list of list.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552529517/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552575663","html_url":"https://github.com/apache/iceberg/pull/497#issuecomment-552575663","issue_url":"https://api.github.com/repos/apache/iceberg/issues/497","id":552575663,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjU3NTY2Mw==","user":{"login":"yp-oss","id":15472649,"node_id":"MDQ6VXNlcjE1NDcyNjQ5","avatar_url":"https://avatars.githubusercontent.com/u/15472649?v=4","gravatar_id":"","url":"https://api.github.com/users/yp-oss","html_url":"https://github.com/yp-oss","followers_url":"https://api.github.com/users/yp-oss/followers","following_url":"https://api.github.com/users/yp-oss/following{/other_user}","gists_url":"https://api.github.com/users/yp-oss/gists{/gist_id}","starred_url":"https://api.github.com/users/yp-oss/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yp-oss/subscriptions","organizations_url":"https://api.github.com/users/yp-oss/orgs","repos_url":"https://api.github.com/users/yp-oss/repos","events_url":"https://api.github.com/users/yp-oss/events{/privacy}","received_events_url":"https://api.github.com/users/yp-oss/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-11T19:15:38Z","updated_at":"2019-11-11T19:15:38Z","author_association":"NONE","body":"@rdblue, I haven't got a chance to work on it as per the comments. We're debating internally whether `expireOlderThan` and `retainLast` should be independent or is it always required to call `expireOlderThan` with `retainLast`? I'll get back on this soon.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552575663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552590307","html_url":"https://github.com/apache/iceberg/issues/626#issuecomment-552590307","issue_url":"https://api.github.com/repos/apache/iceberg/issues/626","id":552590307,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjU5MDMwNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-11T19:55:49Z","updated_at":"2019-11-11T19:55:49Z","author_association":"CONTRIBUTOR","body":"No, the `HiveCatalog` in Iceberg should follow the conventions of Hive, and Hive only supports one namespace level, called \"database\".","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552590307/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552590443","html_url":"https://github.com/apache/iceberg/issues/623#issuecomment-552590443","issue_url":"https://api.github.com/repos/apache/iceberg/issues/623","id":552590443,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjU5MDQ0Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-11T19:56:14Z","updated_at":"2019-11-11T19:56:14Z","author_association":"CONTRIBUTOR","body":"Sounds good to me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552590443/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552612499","html_url":"https://github.com/apache/iceberg/pull/624#issuecomment-552612499","issue_url":"https://api.github.com/repos/apache/iceberg/issues/624","id":552612499,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjYxMjQ5OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-11T20:57:34Z","updated_at":"2019-11-11T20:57:34Z","author_association":"CONTRIBUTOR","body":"Thanks @aokolnychyi! Merged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552612499/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552635281","html_url":"https://github.com/apache/iceberg/pull/588#issuecomment-552635281","issue_url":"https://api.github.com/repos/apache/iceberg/issues/588","id":552635281,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjYzNTI4MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-11T21:58:20Z","updated_at":"2019-11-11T21:58:20Z","author_association":"CONTRIBUTOR","body":"@chenjunjiedada, I think a good place to start would be to add `lastSequenceNumber` field to `Snapshot` that increments each commit, then we can move to the rest of the metadata files from there, starting with `ManifestList`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552635281/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552636907","html_url":"https://github.com/apache/iceberg/pull/627#issuecomment-552636907","issue_url":"https://api.github.com/repos/apache/iceberg/issues/627","id":552636907,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjYzNjkwNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-11T22:02:28Z","updated_at":"2019-11-11T22:02:28Z","author_association":"CONTRIBUTOR","body":"@chenjunjiedada, what do you mean? This works to index the test case you posted.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552636907/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552654828","html_url":"https://github.com/apache/iceberg/pull/497#issuecomment-552654828","issue_url":"https://api.github.com/repos/apache/iceberg/issues/497","id":552654828,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjY1NDgyOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-11T22:56:54Z","updated_at":"2019-11-11T22:56:54Z","author_association":"CONTRIBUTOR","body":"I think the two calls should be independent, but I think we will likely add a table default for the expiration period. If we do that, then `retainLast` would always be combined with an expiration.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552654828/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552671527","html_url":"https://github.com/apache/iceberg/pull/512#issuecomment-552671527","issue_url":"https://api.github.com/repos/apache/iceberg/issues/512","id":552671527,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjY3MTUyNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-11T23:56:35Z","updated_at":"2019-11-11T23:56:35Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi, there is just one problem with `cleanUncommitted`. Everything else is minor, though would be nice to fix the nits.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552671527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552770181","html_url":"https://github.com/apache/iceberg/issues/480#issuecomment-552770181","issue_url":"https://api.github.com/repos/apache/iceberg/issues/480","id":552770181,"node_id":"MDEyOklzc3VlQ29tbWVudDU1Mjc3MDE4MQ==","user":{"login":"manishmalhotrawork","id":22434010,"node_id":"MDQ6VXNlcjIyNDM0MDEw","avatar_url":"https://avatars.githubusercontent.com/u/22434010?v=4","gravatar_id":"","url":"https://api.github.com/users/manishmalhotrawork","html_url":"https://github.com/manishmalhotrawork","followers_url":"https://api.github.com/users/manishmalhotrawork/followers","following_url":"https://api.github.com/users/manishmalhotrawork/following{/other_user}","gists_url":"https://api.github.com/users/manishmalhotrawork/gists{/gist_id}","starred_url":"https://api.github.com/users/manishmalhotrawork/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manishmalhotrawork/subscriptions","organizations_url":"https://api.github.com/users/manishmalhotrawork/orgs","repos_url":"https://api.github.com/users/manishmalhotrawork/repos","events_url":"https://api.github.com/users/manishmalhotrawork/events{/privacy}","received_events_url":"https://api.github.com/users/manishmalhotrawork/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-12T07:30:16Z","updated_at":"2019-11-12T07:30:16Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi trying to understand the problem and thinking loud for solution. \r\n\r\nso, would the fix be to group manifests by partition spec before cluster by `clusterFunction`.\r\nso for group of each partition spec's manifest files, the cluster by logic will be applied, where currently its applied for every manifests irrespective of the underlying manifests partition spec.\r\n\r\n```              try (ManifestReader reader =\r\n                     ManifestReader.read(ops.io().newInputFile(manifest.path()), ops.current().specsById())) {\r\n                FilteredManifest filteredManifest = reader.select(Arrays.asList(\"*\"));\r\n                filteredManifest.liveEntries().forEach(\r\n                    entry -> appendEntry(entry, clusterByFunc.apply(entry.file()))\r\n                );\r\n```\r\nManifest files grouped by partition spec is done in `MergingSnapshotProducer` at [this line](https://github.com/apache/incubator-iceberg/blob/master/core/src/main/java/org/apache/iceberg/MergingSnapshotProducer.java#L269). So similar logic can be applied.\r\n\r\nOne more interesting point, \r\nas per [this line](https://github.com/apache/incubator-iceberg/blob/master/core/src/main/java/org/apache/iceberg/BaseRewriteManifests.java#L242) ManifestFileWriter is created using the `TableOperations.current.spec` which will be used to create all `ManifestWriters`, though `ManifestReader` is created based on the `partitionSpec` belongs to the Manifest File, as per [this line](https://github.com/apache/incubator-iceberg/blob/master/core/src/main/java/org/apache/iceberg/BaseRewriteManifests.java#L176)\r\n\r\nNot sure if my understanding is correct or not, So that is also part of the problem ?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552770181/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552985356","html_url":"https://github.com/apache/iceberg/pull/574#issuecomment-552985356","issue_url":"https://api.github.com/repos/apache/iceberg/issues/574","id":552985356,"node_id":"MDEyOklzc3VlQ29tbWVudDU1Mjk4NTM1Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-12T16:58:11Z","updated_at":"2019-11-12T16:58:11Z","author_association":"CONTRIBUTOR","body":"Merged. Thanks for reviewing, @rdsr!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552985356/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552988585","html_url":"https://github.com/apache/iceberg/pull/512#issuecomment-552988585","issue_url":"https://api.github.com/repos/apache/iceberg/issues/512","id":552988585,"node_id":"MDEyOklzc3VlQ29tbWVudDU1Mjk4ODU4NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-12T17:05:00Z","updated_at":"2019-11-12T17:05:00Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi, looks like there's a test failure, but I think this is ready to merge when that's fixed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552988585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552990744","html_url":"https://github.com/apache/iceberg/pull/512#issuecomment-552990744","issue_url":"https://api.github.com/repos/apache/iceberg/issues/512","id":552990744,"node_id":"MDEyOklzc3VlQ29tbWVudDU1Mjk5MDc0NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-12T17:09:31Z","updated_at":"2019-11-12T17:09:31Z","author_association":"CONTRIBUTOR","body":"@rdblue, thanks for the review. I modified an error message and forgot to update a test. Updated the PR now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552990744/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552992898","html_url":"https://github.com/apache/iceberg/pull/529#issuecomment-552992898","issue_url":"https://api.github.com/repos/apache/iceberg/issues/529","id":552992898,"node_id":"MDEyOklzc3VlQ29tbWVudDU1Mjk5Mjg5OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-12T17:14:17Z","updated_at":"2019-11-12T17:14:17Z","author_association":"CONTRIBUTOR","body":"Thanks @chenjunjiedada! I'll merge this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552992898/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553000016","html_url":"https://github.com/apache/iceberg/pull/512#issuecomment-553000016","issue_url":"https://api.github.com/repos/apache/iceberg/issues/512","id":553000016,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzAwMDAxNg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-12T17:28:39Z","updated_at":"2019-11-12T17:28:39Z","author_association":"CONTRIBUTOR","body":"Seems like some Python tests failed this time.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553000016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553016034","html_url":"https://github.com/apache/iceberg/pull/512#issuecomment-553016034","issue_url":"https://api.github.com/repos/apache/iceberg/issues/512","id":553016034,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzAxNjAzNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-12T18:01:20Z","updated_at":"2019-11-12T18:01:20Z","author_association":"CONTRIBUTOR","body":"Yeah, looks like python is having trouble. We'll look into it, but it shouldn't block this commit.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553016034/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553018400","html_url":"https://github.com/apache/iceberg/issues/607#issuecomment-553018400","issue_url":"https://api.github.com/repos/apache/iceberg/issues/607","id":553018400,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzAxODQwMA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-12T18:04:05Z","updated_at":"2019-11-12T18:04:05Z","author_association":"CONTRIBUTOR","body":"This was fixed in #624","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553018400/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553018562","html_url":"https://github.com/apache/iceberg/issues/597#issuecomment-553018562","issue_url":"https://api.github.com/repos/apache/iceberg/issues/597","id":553018562,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzAxODU2Mg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-12T18:04:28Z","updated_at":"2019-11-12T18:04:28Z","author_association":"CONTRIBUTOR","body":"This was fixed in #624","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553018562/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553029461","html_url":"https://github.com/apache/iceberg/pull/585#issuecomment-553029461","issue_url":"https://api.github.com/repos/apache/iceberg/issues/585","id":553029461,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzAyOTQ2MQ==","user":{"login":"andrei-ionescu","id":3389505,"node_id":"MDQ6VXNlcjMzODk1MDU=","avatar_url":"https://avatars.githubusercontent.com/u/3389505?v=4","gravatar_id":"","url":"https://api.github.com/users/andrei-ionescu","html_url":"https://github.com/andrei-ionescu","followers_url":"https://api.github.com/users/andrei-ionescu/followers","following_url":"https://api.github.com/users/andrei-ionescu/following{/other_user}","gists_url":"https://api.github.com/users/andrei-ionescu/gists{/gist_id}","starred_url":"https://api.github.com/users/andrei-ionescu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrei-ionescu/subscriptions","organizations_url":"https://api.github.com/users/andrei-ionescu/orgs","repos_url":"https://api.github.com/users/andrei-ionescu/repos","events_url":"https://api.github.com/users/andrei-ionescu/events{/privacy}","received_events_url":"https://api.github.com/users/andrei-ionescu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-12T18:18:54Z","updated_at":"2019-11-12T18:18:54Z","author_association":"CONTRIBUTOR","body":"@rdblue I'll try to change the code so that it won't need the unsafe projection anymore. I'll try have that as a separate commit. If I get stuck I'll get back to you. Thanks for support.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553029461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553030461","html_url":"https://github.com/apache/iceberg/pull/514#issuecomment-553030461","issue_url":"https://api.github.com/repos/apache/iceberg/issues/514","id":553030461,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzAzMDQ2MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-12T18:21:00Z","updated_at":"2019-11-12T18:21:00Z","author_association":"CONTRIBUTOR","body":"One last Javadoc update and I think we can commit this. Thanks, @andrei-ionescu!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553030461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553033141","html_url":"https://github.com/apache/iceberg/pull/590#issuecomment-553033141","issue_url":"https://api.github.com/repos/apache/iceberg/issues/590","id":553033141,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzAzMzE0MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-12T18:26:24Z","updated_at":"2019-11-12T18:26:24Z","author_association":"CONTRIBUTOR","body":"@xabriel, have you had a chance to look at the question I asked about behavior when using `spark.read.schema(...)`?\r\n\r\nI think that using this method to project should have the same behavior as a projection in dataframes, so projecting a field that isn't in the table schema should be an error.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553033141/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553036160","html_url":"https://github.com/apache/iceberg/pull/630#issuecomment-553036160","issue_url":"https://api.github.com/repos/apache/iceberg/issues/630","id":553036160,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzAzNjE2MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-12T18:28:16Z","updated_at":"2019-11-12T18:28:16Z","author_association":"CONTRIBUTOR","body":"Thanks, @TGooch44! I'll merge this once tests are passing to get CI passing again for pull requests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553036160/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553042362","html_url":"https://github.com/apache/iceberg/pull/590#issuecomment-553042362","issue_url":"https://api.github.com/repos/apache/iceberg/issues/590","id":553042362,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzA0MjM2Mg==","user":{"login":"xabriel","id":218555,"node_id":"MDQ6VXNlcjIxODU1NQ==","avatar_url":"https://avatars.githubusercontent.com/u/218555?v=4","gravatar_id":"","url":"https://api.github.com/users/xabriel","html_url":"https://github.com/xabriel","followers_url":"https://api.github.com/users/xabriel/followers","following_url":"https://api.github.com/users/xabriel/following{/other_user}","gists_url":"https://api.github.com/users/xabriel/gists{/gist_id}","starred_url":"https://api.github.com/users/xabriel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xabriel/subscriptions","organizations_url":"https://api.github.com/users/xabriel/orgs","repos_url":"https://api.github.com/users/xabriel/repos","events_url":"https://api.github.com/users/xabriel/events{/privacy}","received_events_url":"https://api.github.com/users/xabriel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-12T18:36:22Z","updated_at":"2019-11-12T18:36:22Z","author_association":"CONTRIBUTOR","body":"@rdblue agreed. Haven't had a chance to refactor, but it is on my queue. Will get back to you ASAP.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553042362/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553047957","html_url":"https://github.com/apache/iceberg/pull/590#issuecomment-553047957","issue_url":"https://api.github.com/repos/apache/iceberg/issues/590","id":553047957,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzA0Nzk1Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-12T18:42:41Z","updated_at":"2019-11-12T18:42:41Z","author_association":"CONTRIBUTOR","body":"No rush, I just wanted to make sure you weren't blocked by me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553047957/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553077410","html_url":"https://github.com/apache/iceberg/pull/630#issuecomment-553077410","issue_url":"https://api.github.com/repos/apache/iceberg/issues/630","id":553077410,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzA3NzQxMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-12T19:31:35Z","updated_at":"2019-11-12T19:31:35Z","author_association":"CONTRIBUTOR","body":"Merged. Thanks for the quick fix, @TGooch44!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553077410/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553154374","html_url":"https://github.com/apache/iceberg/pull/569#issuecomment-553154374","issue_url":"https://api.github.com/repos/apache/iceberg/issues/569","id":553154374,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzE1NDM3NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-12T22:52:28Z","updated_at":"2019-11-12T22:52:28Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi, `SerializableConfiguration` is public now and annotated with `@DeveloperApi`: https://github.com/apache/spark/commit/bd05339171db00c2f2dd89702f9500ed6e1e321a\r\n\r\nI think it should be fine to rely on it. It's a little ugly, but better than needing special registration for Kryo.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553154374/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553155565","html_url":"https://github.com/apache/iceberg/pull/514#issuecomment-553155565","issue_url":"https://api.github.com/repos/apache/iceberg/issues/514","id":553155565,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzE1NTU2NQ==","user":{"login":"andrei-ionescu","id":3389505,"node_id":"MDQ6VXNlcjMzODk1MDU=","avatar_url":"https://avatars.githubusercontent.com/u/3389505?v=4","gravatar_id":"","url":"https://api.github.com/users/andrei-ionescu","html_url":"https://github.com/andrei-ionescu","followers_url":"https://api.github.com/users/andrei-ionescu/followers","following_url":"https://api.github.com/users/andrei-ionescu/following{/other_user}","gists_url":"https://api.github.com/users/andrei-ionescu/gists{/gist_id}","starred_url":"https://api.github.com/users/andrei-ionescu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrei-ionescu/subscriptions","organizations_url":"https://api.github.com/users/andrei-ionescu/orgs","repos_url":"https://api.github.com/users/andrei-ionescu/repos","events_url":"https://api.github.com/users/andrei-ionescu/events{/privacy}","received_events_url":"https://api.github.com/users/andrei-ionescu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-12T22:56:22Z","updated_at":"2019-11-12T22:56:22Z","author_association":"CONTRIBUTOR","body":"@rdblue Modified the Javadoc and squashed the commits into one commit.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553155565/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553173473","html_url":"https://github.com/apache/iceberg/pull/627#issuecomment-553173473","issue_url":"https://api.github.com/repos/apache/iceberg/issues/627","id":553173473,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzE3MzQ3Mw==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T00:00:13Z","updated_at":"2019-11-13T00:00:13Z","author_association":"COLLABORATOR","body":"@rdblue, in commit ed3e3cb, the unit test in case of list of list case gets NPE, while it works with the latest commit. I 'm not sure what had been fixed since both of them is lazy initialization.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553173473/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553177901","html_url":"https://github.com/apache/iceberg/issues/626#issuecomment-553177901","issue_url":"https://api.github.com/repos/apache/iceberg/issues/626","id":553177901,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzE3NzkwMQ==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T00:15:55Z","updated_at":"2019-11-13T00:15:55Z","author_association":"COLLABORATOR","body":"I see. Thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553177901/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553190551","html_url":"https://github.com/apache/iceberg/pull/627#issuecomment-553190551","issue_url":"https://api.github.com/repos/apache/iceberg/issues/627","id":553190551,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzE5MDU1MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T01:09:13Z","updated_at":"2019-11-13T01:09:13Z","author_association":"CONTRIBUTOR","body":"@chenjunjiedada, the problem in that commit was that not all of the visitor methods return a non-null map, so calling `size` on child results could fail. All we need to do is to iterate through the list to index the children, which is why we now use `Lists.newArrayList`. Since we also have to do something to consume the output, we call `size` on that list.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553190551/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553197793","html_url":"https://github.com/apache/iceberg/pull/514#issuecomment-553197793","issue_url":"https://api.github.com/repos/apache/iceberg/issues/514","id":553197793,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzE5Nzc5Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T01:40:07Z","updated_at":"2019-11-13T01:40:07Z","author_association":"CONTRIBUTOR","body":"Merged. Thanks for contributing this fix, @andrei-ionescu!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553197793/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553215168","html_url":"https://github.com/apache/iceberg/pull/627#issuecomment-553215168","issue_url":"https://api.github.com/repos/apache/iceberg/issues/627","id":553215168,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzIxNTE2OA==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T02:54:58Z","updated_at":"2019-11-13T02:54:58Z","author_association":"COLLABORATOR","body":"LGTM, +1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553215168/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553224995","html_url":"https://github.com/apache/iceberg/pull/627#issuecomment-553224995","issue_url":"https://api.github.com/repos/apache/iceberg/issues/627","id":553224995,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzIyNDk5NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T03:41:06Z","updated_at":"2019-11-13T03:41:06Z","author_association":"CONTRIBUTOR","body":"Thanks, @chenjunjiedada! I'll merge this. Can you update #619 to use this validation instead?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553224995/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553444586","html_url":"https://github.com/apache/iceberg/issues/636#issuecomment-553444586","issue_url":"https://api.github.com/repos/apache/iceberg/issues/636","id":553444586,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzQ0NDU4Ng==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T15:08:47Z","updated_at":"2019-11-13T15:08:47Z","author_association":"CONTRIBUTOR","body":"I'll fix it","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553444586/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553459833","html_url":"https://github.com/apache/iceberg/pull/585#issuecomment-553459833","issue_url":"https://api.github.com/repos/apache/iceberg/issues/585","id":553459833,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzQ1OTgzMw==","user":{"login":"andrei-ionescu","id":3389505,"node_id":"MDQ6VXNlcjMzODk1MDU=","avatar_url":"https://avatars.githubusercontent.com/u/3389505?v=4","gravatar_id":"","url":"https://api.github.com/users/andrei-ionescu","html_url":"https://github.com/andrei-ionescu","followers_url":"https://api.github.com/users/andrei-ionescu/followers","following_url":"https://api.github.com/users/andrei-ionescu/following{/other_user}","gists_url":"https://api.github.com/users/andrei-ionescu/gists{/gist_id}","starred_url":"https://api.github.com/users/andrei-ionescu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrei-ionescu/subscriptions","organizations_url":"https://api.github.com/users/andrei-ionescu/orgs","repos_url":"https://api.github.com/users/andrei-ionescu/repos","events_url":"https://api.github.com/users/andrei-ionescu/events{/privacy}","received_events_url":"https://api.github.com/users/andrei-ionescu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T15:42:30Z","updated_at":"2019-11-13T15:42:30Z","author_association":"CONTRIBUTOR","body":"@rdblue I added a new commit with the implementation without the unsafe projection. Can you check it please?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553459833/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553468871","html_url":"https://github.com/apache/iceberg/issues/638#issuecomment-553468871","issue_url":"https://api.github.com/repos/apache/iceberg/issues/638","id":553468871,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzQ2ODg3MQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T16:02:42Z","updated_at":"2019-11-13T16:02:42Z","author_association":"CONTRIBUTOR","body":"@Fokko did we deliberately add `gradle/wrapper/gradle-wrapper.jar`?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553468871/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553475759","html_url":"https://github.com/apache/iceberg/issues/638#issuecomment-553475759","issue_url":"https://api.github.com/repos/apache/iceberg/issues/638","id":553475759,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzQ3NTc1OQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T16:18:21Z","updated_at":"2019-11-13T16:18:21Z","author_association":"CONTRIBUTOR","body":"It seems it should be downloaded according to [this](https://github.com/apache/incubator-iceberg/commit/789eba39012b7a18076e09662af7624101b0e060#diff-eb34851cc3b98933dbb0a257c9b7b097) commit.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553475759/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553481046","html_url":"https://github.com/apache/iceberg/issues/638#issuecomment-553481046","issue_url":"https://api.github.com/repos/apache/iceberg/issues/638","id":553481046,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzQ4MTA0Ng==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T16:30:06Z","updated_at":"2019-11-13T16:30:06Z","author_association":"CONTRIBUTOR","body":"Oops! My mistake. This jar should not be part of the repo. I've created a PR: https://github.com/apache/incubator-iceberg/pull/639","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553481046/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553496046","html_url":"https://github.com/apache/iceberg/pull/637#issuecomment-553496046","issue_url":"https://api.github.com/repos/apache/iceberg/issues/637","id":553496046,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzQ5NjA0Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T17:03:46Z","updated_at":"2019-11-13T17:03:46Z","author_association":"CONTRIBUTOR","body":"Looks great! Good idea.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553496046/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553522805","html_url":"https://github.com/apache/iceberg/pull/635#issuecomment-553522805","issue_url":"https://api.github.com/repos/apache/iceberg/issues/635","id":553522805,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzUyMjgwNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T17:49:12Z","updated_at":"2019-11-13T17:49:12Z","author_association":"CONTRIBUTOR","body":"Works great for me!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553522805/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553549184","html_url":"https://github.com/apache/iceberg/pull/590#issuecomment-553549184","issue_url":"https://api.github.com/repos/apache/iceberg/issues/590","id":553549184,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzU0OTE4NA==","user":{"login":"xabriel","id":218555,"node_id":"MDQ6VXNlcjIxODU1NQ==","avatar_url":"https://avatars.githubusercontent.com/u/218555?v=4","gravatar_id":"","url":"https://api.github.com/users/xabriel","html_url":"https://github.com/xabriel","followers_url":"https://api.github.com/users/xabriel/followers","following_url":"https://api.github.com/users/xabriel/following{/other_user}","gists_url":"https://api.github.com/users/xabriel/gists{/gist_id}","starred_url":"https://api.github.com/users/xabriel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xabriel/subscriptions","organizations_url":"https://api.github.com/users/xabriel/orgs","repos_url":"https://api.github.com/users/xabriel/repos","events_url":"https://api.github.com/users/xabriel/events{/privacy}","received_events_url":"https://api.github.com/users/xabriel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T18:56:46Z","updated_at":"2019-11-13T18:56:46Z","author_association":"CONTRIBUTOR","body":"This one is ready for re-review @rdblue. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553549184/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553599114","html_url":"https://github.com/apache/iceberg/pull/590#issuecomment-553599114","issue_url":"https://api.github.com/repos/apache/iceberg/issues/590","id":553599114,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzU5OTExNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T20:57:47Z","updated_at":"2019-11-13T20:57:47Z","author_association":"CONTRIBUTOR","body":"Looks great! Thanks @xabriel!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553599114/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553599760","html_url":"https://github.com/apache/iceberg/pull/642#issuecomment-553599760","issue_url":"https://api.github.com/repos/apache/iceberg/issues/642","id":553599760,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzU5OTc2MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T20:59:33Z","updated_at":"2019-11-13T20:59:33Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553599760/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553607106","html_url":"https://github.com/apache/iceberg/pull/524#issuecomment-553607106","issue_url":"https://api.github.com/repos/apache/iceberg/issues/524","id":553607106,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzYwNzEwNg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T21:18:55Z","updated_at":"2019-11-13T21:18:55Z","author_association":"CONTRIBUTOR","body":"Thanks for the update, @manishmalhotrawork! Looks like it's almost ready, but I caught one thing that needs to be fixed (use `firstAppendedManifest`).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553607106/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553618271","html_url":"https://github.com/apache/iceberg/pull/631#issuecomment-553618271","issue_url":"https://api.github.com/repos/apache/iceberg/issues/631","id":553618271,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzYxODI3MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T21:45:33Z","updated_at":"2019-11-13T21:45:33Z","author_association":"CONTRIBUTOR","body":"Thanks for working on this, @yathindranath! Looks like a great start and it shouldn't need too many changes to get it in.\r\n\r\nFYI @arina-ielchiieva.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553618271/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553623834","html_url":"https://github.com/apache/iceberg/pull/640#issuecomment-553623834","issue_url":"https://api.github.com/repos/apache/iceberg/issues/640","id":553623834,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzYyMzgzNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T22:00:07Z","updated_at":"2019-11-13T22:00:07Z","author_association":"CONTRIBUTOR","body":"Nice work! Thanks for catching this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553623834/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553624446","html_url":"https://github.com/apache/iceberg/pull/587#issuecomment-553624446","issue_url":"https://api.github.com/repos/apache/iceberg/issues/587","id":553624446,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzYyNDQ0Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T22:01:36Z","updated_at":"2019-11-13T22:01:36Z","author_association":"CONTRIBUTOR","body":"@Fokko, what's the status of this PR? Since this isn't shaded in the release, is this still valid?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553624446/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553625581","html_url":"https://github.com/apache/iceberg/pull/491#issuecomment-553625581","issue_url":"https://api.github.com/repos/apache/iceberg/issues/491","id":553625581,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzYyNTU4MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-13T22:04:30Z","updated_at":"2019-11-13T22:04:30Z","author_association":"CONTRIBUTOR","body":"Sorry for the late reply. @ppadma, I don't understand how the use case you described requires files to be relative to the manifests. If you move the manifests, you'd have to move the data files as well. If you just add the manifests to the new table, then the paths would still point to the other data locations. So it seems to me that making paths relative to the manifests doesn't really help?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553625581/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553768867","html_url":"https://github.com/apache/iceberg/pull/587#issuecomment-553768867","issue_url":"https://api.github.com/repos/apache/iceberg/issues/587","id":553768867,"node_id":"MDEyOklzc3VlQ29tbWVudDU1Mzc2ODg2Nw==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-14T07:51:58Z","updated_at":"2019-11-14T07:51:58Z","author_association":"CONTRIBUTOR","body":"@rdblue I've been busy, just switching to a new project. I've updated the PR with the comments. I think it is good to go, let me know if you have any more questions.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553768867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553971336","html_url":"https://github.com/apache/iceberg/pull/585#issuecomment-553971336","issue_url":"https://api.github.com/repos/apache/iceberg/issues/585","id":553971336,"node_id":"MDEyOklzc3VlQ29tbWVudDU1Mzk3MTMzNg==","user":{"login":"andrei-ionescu","id":3389505,"node_id":"MDQ6VXNlcjMzODk1MDU=","avatar_url":"https://avatars.githubusercontent.com/u/3389505?v=4","gravatar_id":"","url":"https://api.github.com/users/andrei-ionescu","html_url":"https://github.com/andrei-ionescu","followers_url":"https://api.github.com/users/andrei-ionescu/followers","following_url":"https://api.github.com/users/andrei-ionescu/following{/other_user}","gists_url":"https://api.github.com/users/andrei-ionescu/gists{/gist_id}","starred_url":"https://api.github.com/users/andrei-ionescu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrei-ionescu/subscriptions","organizations_url":"https://api.github.com/users/andrei-ionescu/orgs","repos_url":"https://api.github.com/users/andrei-ionescu/repos","events_url":"https://api.github.com/users/andrei-ionescu/events{/privacy}","received_events_url":"https://api.github.com/users/andrei-ionescu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-14T16:38:59Z","updated_at":"2019-11-14T16:38:59Z","author_association":"CONTRIBUTOR","body":"@rdblue I modified the code and used a lambda function instead of the Guava version. I also rebased it and resolved conflicts. Please have another look when you have some spare time. Thank you.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/553971336/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554010209","html_url":"https://github.com/apache/iceberg/issues/643#issuecomment-554010209","issue_url":"https://api.github.com/repos/apache/iceberg/issues/643","id":554010209,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDAxMDIwOQ==","user":{"login":"asheeshgarg","id":4348671,"node_id":"MDQ6VXNlcjQzNDg2NzE=","avatar_url":"https://avatars.githubusercontent.com/u/4348671?v=4","gravatar_id":"","url":"https://api.github.com/users/asheeshgarg","html_url":"https://github.com/asheeshgarg","followers_url":"https://api.github.com/users/asheeshgarg/followers","following_url":"https://api.github.com/users/asheeshgarg/following{/other_user}","gists_url":"https://api.github.com/users/asheeshgarg/gists{/gist_id}","starred_url":"https://api.github.com/users/asheeshgarg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asheeshgarg/subscriptions","organizations_url":"https://api.github.com/users/asheeshgarg/orgs","repos_url":"https://api.github.com/users/asheeshgarg/repos","events_url":"https://api.github.com/users/asheeshgarg/events{/privacy}","received_events_url":"https://api.github.com/users/asheeshgarg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-14T18:10:34Z","updated_at":"2019-11-14T18:10:34Z","author_association":"NONE","body":"I see the pull request https://github.com/apache/incubator-iceberg/pull/544 for loading the data. closing the issue","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554010209/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554039169","html_url":"https://github.com/apache/iceberg/pull/631#issuecomment-554039169","issue_url":"https://api.github.com/repos/apache/iceberg/issues/631","id":554039169,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDAzOTE2OQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-14T19:21:19Z","updated_at":"2019-11-14T19:21:19Z","author_association":"CONTRIBUTOR","body":"One question I have is about potentially orphan files. In the current implementation, we don't retry in `deleteRemovedMetadata` and we don't persist removed entries in the JSON files.\r\n\r\n@yathindranath, you mentioned some logic you want to add while expiring snapshots. How will that look like? \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554039169/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554040178","html_url":"https://github.com/apache/iceberg/issues/592#issuecomment-554040178","issue_url":"https://api.github.com/repos/apache/iceberg/issues/592","id":554040178,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDA0MDE3OA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-14T19:23:52Z","updated_at":"2019-11-14T19:23:52Z","author_association":"CONTRIBUTOR","body":"This was resolved in #624","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554040178/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554042012","html_url":"https://github.com/apache/iceberg/issues/494#issuecomment-554042012","issue_url":"https://api.github.com/repos/apache/iceberg/issues/494","id":554042012,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDA0MjAxMg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-14T19:28:34Z","updated_at":"2019-11-14T19:28:34Z","author_association":"CONTRIBUTOR","body":"This was fixed in #641. @holdenk, please reopen if the fix wasn't sufficient.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554042012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554045403","html_url":"https://github.com/apache/iceberg/issues/480#issuecomment-554045403","issue_url":"https://api.github.com/repos/apache/iceberg/issues/480","id":554045403,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDA0NTQwMw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-14T19:36:55Z","updated_at":"2019-11-14T19:36:55Z","author_association":"CONTRIBUTOR","body":"@manishmalhotrawork, I think you got the problem correctly. We need to take into account that there might be multiple partition specs in a table. We can get a map of partition specs from `Table` and use that to correctly initialize `ManifestWriter`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554045403/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554046606","html_url":"https://github.com/apache/iceberg/issues/480#issuecomment-554046606","issue_url":"https://api.github.com/repos/apache/iceberg/issues/480","id":554046606,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDA0NjYwNg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-14T19:40:10Z","updated_at":"2019-11-14T19:40:10Z","author_association":"CONTRIBUTOR","body":"@manishmalhotrawork, do you want to submit a PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554046606/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554109488","html_url":"https://github.com/apache/iceberg/issues/522#issuecomment-554109488","issue_url":"https://api.github.com/repos/apache/iceberg/issues/522","id":554109488,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDEwOTQ4OA==","user":{"login":"samarthjain","id":1642180,"node_id":"MDQ6VXNlcjE2NDIxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1642180?v=4","gravatar_id":"","url":"https://api.github.com/users/samarthjain","html_url":"https://github.com/samarthjain","followers_url":"https://api.github.com/users/samarthjain/followers","following_url":"https://api.github.com/users/samarthjain/following{/other_user}","gists_url":"https://api.github.com/users/samarthjain/gists{/gist_id}","starred_url":"https://api.github.com/users/samarthjain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samarthjain/subscriptions","organizations_url":"https://api.github.com/users/samarthjain/orgs","repos_url":"https://api.github.com/users/samarthjain/repos","events_url":"https://api.github.com/users/samarthjain/events{/privacy}","received_events_url":"https://api.github.com/users/samarthjain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-14T22:25:52Z","updated_at":"2019-11-14T22:25:52Z","author_association":"COLLABORATOR","body":"@prodeezy - #311 looks like a duplicate of this one. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554109488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554110037","html_url":"https://github.com/apache/iceberg/issues/518#issuecomment-554110037","issue_url":"https://api.github.com/repos/apache/iceberg/issues/518","id":554110037,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDExMDAzNw==","user":{"login":"samarthjain","id":1642180,"node_id":"MDQ6VXNlcjE2NDIxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1642180?v=4","gravatar_id":"","url":"https://api.github.com/users/samarthjain","html_url":"https://github.com/samarthjain","followers_url":"https://api.github.com/users/samarthjain/followers","following_url":"https://api.github.com/users/samarthjain/following{/other_user}","gists_url":"https://api.github.com/users/samarthjain/gists{/gist_id}","starred_url":"https://api.github.com/users/samarthjain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samarthjain/subscriptions","organizations_url":"https://api.github.com/users/samarthjain/orgs","repos_url":"https://api.github.com/users/samarthjain/repos","events_url":"https://api.github.com/users/samarthjain/events{/privacy}","received_events_url":"https://api.github.com/users/samarthjain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-14T22:27:18Z","updated_at":"2019-11-14T22:27:18Z","author_association":"COLLABORATOR","body":"Support for dictionary encoded data was merged to the vectorized_read branch. \r\nhttps://github.com/apache/incubator-iceberg/pull/634\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554110037/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554119345","html_url":"https://github.com/apache/iceberg/issues/311#issuecomment-554119345","issue_url":"https://api.github.com/repos/apache/iceberg/issues/311","id":554119345,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDExOTM0NQ==","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-14T22:50:14Z","updated_at":"2019-11-14T22:50:14Z","author_association":"CONTRIBUTOR","body":"this duplicates https://github.com/apache/incubator-iceberg/issues/522","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554119345/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554152156","html_url":"https://github.com/apache/iceberg/issues/520#issuecomment-554152156","issue_url":"https://api.github.com/repos/apache/iceberg/issues/520","id":554152156,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDE1MjE1Ng==","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-15T00:31:42Z","updated_at":"2019-11-15T00:31:42Z","author_association":"CONTRIBUTOR","body":"@samarthjain  https://github.com/apache/incubator-iceberg/issues/645 duplicates this? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554152156/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554153527","html_url":"https://github.com/apache/iceberg/issues/520#issuecomment-554153527","issue_url":"https://api.github.com/repos/apache/iceberg/issues/520","id":554153527,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDE1MzUyNw==","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-15T00:36:31Z","updated_at":"2019-11-15T00:36:31Z","author_association":"CONTRIBUTOR","body":"Added goal in this is to merge the two readers (vectorized and non-vectorized) into one and make that reader handle enabling vectorization accordingly. Enabling should depend on override config and projection schema (revert to row-oriented if schema has complex types)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554153527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554168010","html_url":"https://github.com/apache/iceberg/pull/631#issuecomment-554168010","issue_url":"https://api.github.com/repos/apache/iceberg/issues/631","id":554168010,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDE2ODAxMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-15T01:30:45Z","updated_at":"2019-11-15T01:30:45Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi, I think if we add expiration during ExpireSnapshots, then that's when the number of metadata versions would be pruned. For example, expiration might keep 10 previous metadata file references. Between expiration calls, the ones tracked continues to grow.\r\n\r\nIf that's the case, then to keep metadata from getting too large, we would drop at some maximum number of versions at commit time, and delete the file if that property is set. So the cleanup implemented here is a failsafe and the preferred way to expire is through snapshot expiration.\r\n\r\nThen 100 maximum old versions makes sense, and expiration might bring it down to 10 or 3 or something.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554168010/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554173383","html_url":"https://github.com/apache/iceberg/pull/631#issuecomment-554173383","issue_url":"https://api.github.com/repos/apache/iceberg/issues/631","id":554173383,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDE3MzM4Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-15T01:53:53Z","updated_at":"2019-11-15T01:53:53Z","author_association":"CONTRIBUTOR","body":"Looks nearly ready, other than a few minor things","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554173383/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554257734","html_url":"https://github.com/apache/iceberg/issues/623#issuecomment-554257734","issue_url":"https://api.github.com/repos/apache/iceberg/issues/623","id":554257734,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDI1NzczNA==","user":{"login":"jerryshao","id":850797,"node_id":"MDQ6VXNlcjg1MDc5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/850797?v=4","gravatar_id":"","url":"https://api.github.com/users/jerryshao","html_url":"https://github.com/jerryshao","followers_url":"https://api.github.com/users/jerryshao/followers","following_url":"https://api.github.com/users/jerryshao/following{/other_user}","gists_url":"https://api.github.com/users/jerryshao/gists{/gist_id}","starred_url":"https://api.github.com/users/jerryshao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerryshao/subscriptions","organizations_url":"https://api.github.com/users/jerryshao/orgs","repos_url":"https://api.github.com/users/jerryshao/repos","events_url":"https://api.github.com/users/jerryshao/events{/privacy}","received_events_url":"https://api.github.com/users/jerryshao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-15T08:10:38Z","updated_at":"2019-11-15T08:10:38Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue for your comments, I will work on this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554257734/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554408360","html_url":"https://github.com/apache/iceberg/pull/588#issuecomment-554408360","issue_url":"https://api.github.com/repos/apache/iceberg/issues/588","id":554408360,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDQwODM2MA==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-15T15:38:09Z","updated_at":"2019-11-15T15:38:09Z","author_association":"COLLABORATOR","body":"@rdblue , sorry for the late response. I will update this weekend.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554408360/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554477543","html_url":"https://github.com/apache/iceberg/pull/524#issuecomment-554477543","issue_url":"https://api.github.com/repos/apache/iceberg/issues/524","id":554477543,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDQ3NzU0Mw==","user":{"login":"manishmalhotrawork","id":22434010,"node_id":"MDQ6VXNlcjIyNDM0MDEw","avatar_url":"https://avatars.githubusercontent.com/u/22434010?v=4","gravatar_id":"","url":"https://api.github.com/users/manishmalhotrawork","html_url":"https://github.com/manishmalhotrawork","followers_url":"https://api.github.com/users/manishmalhotrawork/followers","following_url":"https://api.github.com/users/manishmalhotrawork/following{/other_user}","gists_url":"https://api.github.com/users/manishmalhotrawork/gists{/gist_id}","starred_url":"https://api.github.com/users/manishmalhotrawork/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manishmalhotrawork/subscriptions","organizations_url":"https://api.github.com/users/manishmalhotrawork/orgs","repos_url":"https://api.github.com/users/manishmalhotrawork/repos","events_url":"https://api.github.com/users/manishmalhotrawork/events{/privacy}","received_events_url":"https://api.github.com/users/manishmalhotrawork/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-15T18:34:45Z","updated_at":"2019-11-15T18:34:45Z","author_association":"CONTRIBUTOR","body":"test please","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554477543/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554480422","html_url":"https://github.com/apache/iceberg/pull/524#issuecomment-554480422","issue_url":"https://api.github.com/repos/apache/iceberg/issues/524","id":554480422,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDQ4MDQyMg==","user":{"login":"manishmalhotrawork","id":22434010,"node_id":"MDQ6VXNlcjIyNDM0MDEw","avatar_url":"https://avatars.githubusercontent.com/u/22434010?v=4","gravatar_id":"","url":"https://api.github.com/users/manishmalhotrawork","html_url":"https://github.com/manishmalhotrawork","followers_url":"https://api.github.com/users/manishmalhotrawork/followers","following_url":"https://api.github.com/users/manishmalhotrawork/following{/other_user}","gists_url":"https://api.github.com/users/manishmalhotrawork/gists{/gist_id}","starred_url":"https://api.github.com/users/manishmalhotrawork/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manishmalhotrawork/subscriptions","organizations_url":"https://api.github.com/users/manishmalhotrawork/orgs","repos_url":"https://api.github.com/users/manishmalhotrawork/repos","events_url":"https://api.github.com/users/manishmalhotrawork/events{/privacy}","received_events_url":"https://api.github.com/users/manishmalhotrawork/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-15T18:42:59Z","updated_at":"2019-11-15T18:42:59Z","author_association":"CONTRIBUTOR","body":"@rdblue please review, updated the logic to use `firstAppendedManifest` as discussed above. thanks !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554480422/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554484218","html_url":"https://github.com/apache/iceberg/pull/524#issuecomment-554484218","issue_url":"https://api.github.com/repos/apache/iceberg/issues/524","id":554484218,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDQ4NDIxOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-15T18:53:55Z","updated_at":"2019-11-15T18:53:55Z","author_association":"CONTRIBUTOR","body":"Tests look fine. Python failed, but Java passed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554484218/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554484451","html_url":"https://github.com/apache/iceberg/issues/621#issuecomment-554484451","issue_url":"https://api.github.com/repos/apache/iceberg/issues/621","id":554484451,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDQ4NDQ1MQ==","user":{"login":"asheeshgarg","id":4348671,"node_id":"MDQ6VXNlcjQzNDg2NzE=","avatar_url":"https://avatars.githubusercontent.com/u/4348671?v=4","gravatar_id":"","url":"https://api.github.com/users/asheeshgarg","html_url":"https://github.com/asheeshgarg","followers_url":"https://api.github.com/users/asheeshgarg/followers","following_url":"https://api.github.com/users/asheeshgarg/following{/other_user}","gists_url":"https://api.github.com/users/asheeshgarg/gists{/gist_id}","starred_url":"https://api.github.com/users/asheeshgarg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asheeshgarg/subscriptions","organizations_url":"https://api.github.com/users/asheeshgarg/orgs","repos_url":"https://api.github.com/users/asheeshgarg/repos","events_url":"https://api.github.com/users/asheeshgarg/events{/privacy}","received_events_url":"https://api.github.com/users/asheeshgarg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-15T18:54:29Z","updated_at":"2019-12-18T21:49:10Z","author_association":"NONE","body":"Ran the spark with debug logging and I have following observations\r\n\r\n```\r\n19/11/15 15:59:36 INFO Executor: Starting executor ID driver on host localhost\r\n19/11/15 15:59:36 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 45811.\r\n19/11/15 15:59:36 INFO NettyBlockTransferService: Server created on 100.80.47.20:45811\r\n19/11/15 15:59:36 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy\r\n19/11/15 15:59:36 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 100.80.47.20, 45811, None)\r\n19/11/15 15:59:36 INFO BlockManagerMasterEndpoint: Registering block manager 100.80.47.20:45811 with 34.0 GB RAM, BlockManagerId(driver, 100.80.47.20, 45811, None)\r\n19/11/15 15:59:36 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 100.80.47.20, 45811, None)\r\n19/11/15 15:59:36 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 100.80.47.20, 45811, None)\r\n19/11/15 15:59:37 INFO SharedState: loading hive config file: file:/hadoop/conf/hive-site.xml\r\n19/11/15 15:59:37 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/job/spark-warehouse').\r\n19/11/15 15:59:37 INFO SharedState: Warehouse path is 'file:/job/spark-warehouse'.\r\n19/11/15 15:59:37 INFO StateStoreCoordinatorRef: Registered StateStoreCoordinator endpoint\r\n19/11/15 15:59:42 INFO TableScan: Scanning table hdfs:///user/datalake/iceberg/eqty/reference snapshot 5286228287138102009 created at 2019-11-05 21:40:03.510 with filter true\r\n19/11/15 15:59:42 INFO TableScan: Scanning table hdfs:///user/datalake/iceberg/eqty/pricing snapshot 9199449611237852387 created at 2019-11-05 22:14:58.716 with filter true\r\n19/11/15 15:59:43 INFO DataSourceV2Strategy: \r\n\r\n19/11/15 15:59:46 INFO CodeGenerator: Code generated in 12.349638 ms\r\n19/11/15 15:59:46 INFO ZlibFactory: Successfully loaded & initialized native-zlib library\r\n19/11/15 15:59:46 INFO CodecPool: Got brand-new decompressor [.gz]\r\n19/11/15 15:59:47 INFO MemoryStore: Block taskresult_0 stored as bytes in memory (estimated size 7.8 MB, free 34.0 GB)\r\n19/11/15 15:59:47 INFO BlockManagerInfo: Added taskresult_0 in memory on 100.80.47.20:45811 (size: 7.8 MB, free: 34.0 GB)\r\n19/11/15 15:59:47 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 8178722 bytes result sent via BlockManager)\r\n19/11/15 15:59:47 INFO TaskSetManager: Starting task 1.0 in stage 0.0 (TID 1, localhost, executor driver, partition 1, PROCESS_LOCAL, 138170 bytes)\r\n19/11/15 15:59:47 INFO Executor: Running task 1.0 in stage 0.0 (TID 1)\r\n19/11/15 15:59:48 INFO TransportClientFactory: Successfully created connection to /100.80.47.20:45811 after 59 ms (0 ms spent in bootstraps)\r\n19/11/15 15:59:48 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /100.80.47.20:45811 is closed\r\n19/11/15 15:59:48 ERROR OneForOneBlockFetcher: Failed while starting block fetches\r\njava.io.IOException: Connection from /100.80.47.20:45811 closed\r\n\tat org.apache.spark.network.client.TransportResponseHandler.channelInactive(TransportResponseHandler.java:146)\r\n\tat org.apache.spark.network.server.TransportChannelHandler.channelInactive(TransportChannelHandler.java:108)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:245)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:231)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:224)\r\n```\r\n**The executor dies immediately with the block fetch is called. The TableScan seems to be returning table label information \r\n```\r\n19/11/15 15:59:42 INFO TableScan: Scanning table hdfs:///user/datalake/iceberg/eqty/reference snapshot 5286228287138102009 created at 2019-11-05 21:40:03.510 with filter true\r\n19/11/15 15:59:42 INFO TableScan: Scanning table hdfs:///user/datalake/iceberg/eqty/pricing snapshot 9199449611237852387 created at 2019-11-05 22:14:58.716 with filter true\r\n```\r\nDoes it include how many parquet files it has? It immediately fails make me think the code generated by the sql executor has some issues. If needed I can add the logs for sql generated by spark.**\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554484451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554488385","html_url":"https://github.com/apache/iceberg/issues/621#issuecomment-554488385","issue_url":"https://api.github.com/repos/apache/iceberg/issues/621","id":554488385,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDQ4ODM4NQ==","user":{"login":"asheeshgarg","id":4348671,"node_id":"MDQ6VXNlcjQzNDg2NzE=","avatar_url":"https://avatars.githubusercontent.com/u/4348671?v=4","gravatar_id":"","url":"https://api.github.com/users/asheeshgarg","html_url":"https://github.com/asheeshgarg","followers_url":"https://api.github.com/users/asheeshgarg/followers","following_url":"https://api.github.com/users/asheeshgarg/following{/other_user}","gists_url":"https://api.github.com/users/asheeshgarg/gists{/gist_id}","starred_url":"https://api.github.com/users/asheeshgarg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asheeshgarg/subscriptions","organizations_url":"https://api.github.com/users/asheeshgarg/orgs","repos_url":"https://api.github.com/users/asheeshgarg/repos","events_url":"https://api.github.com/users/asheeshgarg/events{/privacy}","received_events_url":"https://api.github.com/users/asheeshgarg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-15T19:05:50Z","updated_at":"2019-12-18T21:49:26Z","author_association":"NONE","body":"Following is the code generated from spark\r\n```java\r\nDEBUG CodeGenerator: \r\n/* 001 */ public Object generate(Object[] references) {\r\n/* 002 */   return new GeneratedIteratorForCodegenStage1(references);\r\n/* 003 */ }\r\n/* 004 */\r\n/* 005 */ // codegenStageId=1\r\n/* 006 */ final class GeneratedIteratorForCodegenStage1 extends org.apache.spark.sql.execution.BufferedRowIterator {\r\n/* 007 */   private Object[] references;\r\n/* 008 */   private scala.collection.Iterator[] inputs;\r\n/* 009 */   private org.apache.spark.sql.catalyst.expressions.codegen.UnsafeRowWriter[] filter_mutableStateArray_0 = new org.apache.spark.sql.catalyst.expressions.codegen.UnsafeRowWriter[2];\r\n/* 010 */   private scala.collection.Iterator[] datasourcev2scan_mutableStateArray_0 = new scala.collection.Iterator[1];\r\n/* 011 */\r\n/* 012 */   public GeneratedIteratorForCodegenStage1(Object[] references) {\r\n/* 013 */     this.references = references;\r\n/* 014 */   }\r\n/* 015 */\r\n/* 016 */   public void init(int index, scala.collection.Iterator[] inputs) {\r\n/* 017 */     partitionIndex = index;\r\n/* 018 */     this.inputs = inputs;\r\n/* 019 */     datasourcev2scan_mutableStateArray_0[0] = inputs[0];\r\n/* 020 */     filter_mutableStateArray_0[0] = new org.apache.spark.sql.catalyst.expressions.codegen.UnsafeRowWriter(2, 32);\r\n/* 021 */     filter_mutableStateArray_0[1] = new org.apache.spark.sql.catalyst.expressions.codegen.UnsafeRowWriter(2, 32);\r\n/* 022 */\r\n/* 023 */   }\r\n/* 024 */\r\n/* 025 */   protected void processNext() throws java.io.IOException {\r\n/* 026 */     while (datasourcev2scan_mutableStateArray_0[0].hasNext()) {\r\n/* 027 */       InternalRow datasourcev2scan_row_0 = (InternalRow) datasourcev2scan_mutableStateArray_0[0].next();\r\n/* 028 */       ((org.apache.spark.sql.execution.metric.SQLMetric) references[0] /* numOutputRows */).add(1);\r\n/* 029 */       do {\r\n/* 030 */         boolean datasourcev2scan_isNull_1 = datasourcev2scan_row_0.isNullAt(1);\r\n/* 031 */         UTF8String datasourcev2scan_value_1 = datasourcev2scan_isNull_1 ?\r\n/* 032 */         null : (datasourcev2scan_row_0.getUTF8String(1));\r\n/* 033 */\r\n/* 034 */         if (!(!datasourcev2scan_isNull_1)) continue;\r\n/* 035 */\r\n/* 036 */         ((org.apache.spark.sql.execution.metric.SQLMetric) references[1] /* numOutputRows */).add(1);\r\n/* 037 */\r\n/* 038 */         int datasourcev2scan_value_0 = datasourcev2scan_row_0.getInt(0);\r\n/* 039 */         filter_mutableStateArray_0[1].reset();\r\n/* 040 */\r\n/* 041 */         filter_mutableStateArray_0[1].write(0, datasourcev2scan_value_0);\r\n/* 042 */\r\n/* 043 */         if (false) {\r\n/* 044 */           filter_mutableStateArray_0[1].setNullAt(1);\r\n/* 045 */         } else {\r\n/* 046 */           filter_mutableStateArray_0[1].write(1, datasourcev2scan_value_1);\r\n/* 047 */         }\r\n/* 048 */         append((filter_mutableStateArray_0[1].getRow()));\r\n/* 049 */\r\n/* 050 */       } while(false);\r\n/* 051 */       if (shouldStop()) return;\r\n/* 052 */     }\r\n/* 053 */   }\r\n/* 054 */\r\n/* 055 */ }\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554488385/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554495511","html_url":"https://github.com/apache/iceberg/issues/621#issuecomment-554495511","issue_url":"https://api.github.com/repos/apache/iceberg/issues/621","id":554495511,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDQ5NTUxMQ==","user":{"login":"asheeshgarg","id":4348671,"node_id":"MDQ6VXNlcjQzNDg2NzE=","avatar_url":"https://avatars.githubusercontent.com/u/4348671?v=4","gravatar_id":"","url":"https://api.github.com/users/asheeshgarg","html_url":"https://github.com/asheeshgarg","followers_url":"https://api.github.com/users/asheeshgarg/followers","following_url":"https://api.github.com/users/asheeshgarg/following{/other_user}","gists_url":"https://api.github.com/users/asheeshgarg/gists{/gist_id}","starred_url":"https://api.github.com/users/asheeshgarg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asheeshgarg/subscriptions","organizations_url":"https://api.github.com/users/asheeshgarg/orgs","repos_url":"https://api.github.com/users/asheeshgarg/repos","events_url":"https://api.github.com/users/asheeshgarg/events{/privacy}","received_events_url":"https://api.github.com/users/asheeshgarg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-15T19:27:01Z","updated_at":"2019-11-15T19:27:01Z","author_association":"NONE","body":"Also if I disable spark.sql.autoBroadcastJoinThreshold=-1 it works fine as well","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554495511/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554604126","html_url":"https://github.com/apache/iceberg/issues/480#issuecomment-554604126","issue_url":"https://api.github.com/repos/apache/iceberg/issues/480","id":554604126,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDYwNDEyNg==","user":{"login":"manishmalhotrawork","id":22434010,"node_id":"MDQ6VXNlcjIyNDM0MDEw","avatar_url":"https://avatars.githubusercontent.com/u/22434010?v=4","gravatar_id":"","url":"https://api.github.com/users/manishmalhotrawork","html_url":"https://github.com/manishmalhotrawork","followers_url":"https://api.github.com/users/manishmalhotrawork/followers","following_url":"https://api.github.com/users/manishmalhotrawork/following{/other_user}","gists_url":"https://api.github.com/users/manishmalhotrawork/gists{/gist_id}","starred_url":"https://api.github.com/users/manishmalhotrawork/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manishmalhotrawork/subscriptions","organizations_url":"https://api.github.com/users/manishmalhotrawork/orgs","repos_url":"https://api.github.com/users/manishmalhotrawork/repos","events_url":"https://api.github.com/users/manishmalhotrawork/events{/privacy}","received_events_url":"https://api.github.com/users/manishmalhotrawork/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-16T04:45:37Z","updated_at":"2019-11-16T04:45:37Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi yes, let me submit PR. thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554604126/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554612645","html_url":"https://github.com/apache/iceberg/issues/645#issuecomment-554612645","issue_url":"https://api.github.com/repos/apache/iceberg/issues/645","id":554612645,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDYxMjY0NQ==","user":{"login":"samarthjain","id":1642180,"node_id":"MDQ6VXNlcjE2NDIxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1642180?v=4","gravatar_id":"","url":"https://api.github.com/users/samarthjain","html_url":"https://github.com/samarthjain","followers_url":"https://api.github.com/users/samarthjain/followers","following_url":"https://api.github.com/users/samarthjain/following{/other_user}","gists_url":"https://api.github.com/users/samarthjain/gists{/gist_id}","starred_url":"https://api.github.com/users/samarthjain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samarthjain/subscriptions","organizations_url":"https://api.github.com/users/samarthjain/orgs","repos_url":"https://api.github.com/users/samarthjain/repos","events_url":"https://api.github.com/users/samarthjain/events{/privacy}","received_events_url":"https://api.github.com/users/samarthjain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-16T07:20:49Z","updated_at":"2019-11-16T07:20:49Z","author_association":"COLLABORATOR","body":"Duplicate of #520 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554612645/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554666093","html_url":"https://github.com/apache/iceberg/issues/179#issuecomment-554666093","issue_url":"https://api.github.com/repos/apache/iceberg/issues/179","id":554666093,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDY2NjA5Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-16T19:18:36Z","updated_at":"2019-11-16T19:18:36Z","author_association":"CONTRIBUTOR","body":"I haven't heard from anyone for a while. I would like to pick this up myself unless someone has a prototype to share.\r\n\r\nHere are my thoughts:\r\n- When we start a stream, we should be able to stream out all currently present data in addition to what will arrive later.\r\n- As we might start a stream on a table with a lot of content, we should be able to split data into multiple batches either based on the number of files/records or based on batch size. Also, we need to take into account that files in the current snapshot could be added by already expired snapshots and we might not have metadata for those snapshots.\r\n- It should be possible to configure what operations are possible on the table while we are streaming out. We can have a config per operation or a list of allowed operations.\r\n  - If the operation is not supported, then throw an exception.\r\n  - If `add`, then stream the added data out (allowed by default).\r\n  - If `rewrite`, then ignore such snapshots (allowed by default).\r\n  - If `delete`, then ignore such snapshots (NOT allowed by default). Sometimes, we can delete data without impacting the correctness of a stream.\r\n  - If `overwrite`, then stream the data out (NOT allowed by default). Consumers will have to deal with duplicates as we use this operation for eager updates.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554666093/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554674533","html_url":"https://github.com/apache/iceberg/pull/524#issuecomment-554674533","issue_url":"https://api.github.com/repos/apache/iceberg/issues/524","id":554674533,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDY3NDUzMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-16T21:08:32Z","updated_at":"2019-11-16T21:08:32Z","author_association":"CONTRIBUTOR","body":"Merged. Thanks for working on this, @manishmalhotrawork!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554674533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554809619","html_url":"https://github.com/apache/iceberg/pull/652#issuecomment-554809619","issue_url":"https://api.github.com/repos/apache/iceberg/issues/652","id":554809619,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDgwOTYxOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-18T01:00:59Z","updated_at":"2019-11-18T01:00:59Z","author_association":"CONTRIBUTOR","body":"@jzhuge FYI","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554809619/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554825154","html_url":"https://github.com/apache/iceberg/pull/652#issuecomment-554825154","issue_url":"https://api.github.com/repos/apache/iceberg/issues/652","id":554825154,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDgyNTE1NA==","user":{"login":"jzhuge","id":1883812,"node_id":"MDQ6VXNlcjE4ODM4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1883812?v=4","gravatar_id":"","url":"https://api.github.com/users/jzhuge","html_url":"https://github.com/jzhuge","followers_url":"https://api.github.com/users/jzhuge/followers","following_url":"https://api.github.com/users/jzhuge/following{/other_user}","gists_url":"https://api.github.com/users/jzhuge/gists{/gist_id}","starred_url":"https://api.github.com/users/jzhuge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzhuge/subscriptions","organizations_url":"https://api.github.com/users/jzhuge/orgs","repos_url":"https://api.github.com/users/jzhuge/repos","events_url":"https://api.github.com/users/jzhuge/events{/privacy}","received_events_url":"https://api.github.com/users/jzhuge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-18T02:35:22Z","updated_at":"2019-11-18T02:35:22Z","author_association":"MEMBER","body":"+1 LGTM\r\n\r\nA bit of context:\r\n\r\n- This is to handle an metadata JSON file created before #264. JSON field `table-uuid` does not exist, thus `metadata.uuid()` returns null.\r\n- If you still have pre #264 writer running (not recommended), you might have to disable the checkState temporarily.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554825154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554858685","html_url":"https://github.com/apache/iceberg/pull/524#issuecomment-554858685","issue_url":"https://api.github.com/repos/apache/iceberg/issues/524","id":554858685,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDg1ODY4NQ==","user":{"login":"manishmalhotrawork","id":22434010,"node_id":"MDQ6VXNlcjIyNDM0MDEw","avatar_url":"https://avatars.githubusercontent.com/u/22434010?v=4","gravatar_id":"","url":"https://api.github.com/users/manishmalhotrawork","html_url":"https://github.com/manishmalhotrawork","followers_url":"https://api.github.com/users/manishmalhotrawork/followers","following_url":"https://api.github.com/users/manishmalhotrawork/following{/other_user}","gists_url":"https://api.github.com/users/manishmalhotrawork/gists{/gist_id}","starred_url":"https://api.github.com/users/manishmalhotrawork/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manishmalhotrawork/subscriptions","organizations_url":"https://api.github.com/users/manishmalhotrawork/orgs","repos_url":"https://api.github.com/users/manishmalhotrawork/repos","events_url":"https://api.github.com/users/manishmalhotrawork/events{/privacy}","received_events_url":"https://api.github.com/users/manishmalhotrawork/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-18T05:31:32Z","updated_at":"2019-11-18T05:31:32Z","author_association":"CONTRIBUTOR","body":"@rdblue thanks a lot for your help  !!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554858685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554872587","html_url":"https://github.com/apache/iceberg/pull/588#issuecomment-554872587","issue_url":"https://api.github.com/repos/apache/iceberg/issues/588","id":554872587,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDg3MjU4Nw==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-18T06:31:09Z","updated_at":"2019-11-18T06:31:09Z","author_association":"COLLABORATOR","body":"@rdblue, PR updated. Here I use `sequenceNumber` instead of `lastSequenceNumber` since it is referred to the current snapshot and need to be serialized, make sense?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/554872587/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/555505610","html_url":"https://github.com/apache/iceberg/pull/656#issuecomment-555505610","issue_url":"https://api.github.com/repos/apache/iceberg/issues/656","id":555505610,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NTUwNTYxMA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-19T13:24:02Z","updated_at":"2019-11-19T13:24:02Z","author_association":"CONTRIBUTOR","body":"We will need to fix #413 to properly support case sensitivity.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/555505610/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/555539304","html_url":"https://github.com/apache/iceberg/pull/654#issuecomment-555539304","issue_url":"https://api.github.com/repos/apache/iceberg/issues/654","id":555539304,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NTUzOTMwNA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-19T14:44:33Z","updated_at":"2019-11-19T14:44:33Z","author_association":"CONTRIBUTOR","body":"I am wondering if there will be any unexpected consequences for throwing `NoSuchTableException` instead of `ValidationException` or `IllegalArgumentException`. For example, `tableExists` in Iceberg and Spark catalogs is implemented in a way that will swallow the exception and simply report `false`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/555539304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/555549622","html_url":"https://github.com/apache/iceberg/pull/653#issuecomment-555549622","issue_url":"https://api.github.com/repos/apache/iceberg/issues/653","id":555549622,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NTU0OTYyMg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-19T15:07:19Z","updated_at":"2019-11-19T15:07:19Z","author_association":"CONTRIBUTOR","body":"Don't have any comments except what @jerryshao already asked.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/555549622/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/555572328","html_url":"https://github.com/apache/iceberg/pull/652#issuecomment-555572328","issue_url":"https://api.github.com/repos/apache/iceberg/issues/652","id":555572328,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NTU3MjMyOA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-19T15:55:56Z","updated_at":"2019-11-19T15:56:35Z","author_association":"CONTRIBUTOR","body":"I think this PR would also resolve the problem when users upgraded to an Iceberg version that started assigning table UUIDs but their first operation wasn't a child of `SnapshotProducer` (e.g. update table properties). Such operations would write an explicit `null` as the table UUID that will corrupt the old logic.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/555572328/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/555623863","html_url":"https://github.com/apache/iceberg/pull/654#issuecomment-555623863","issue_url":"https://api.github.com/repos/apache/iceberg/issues/654","id":555623863,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NTYyMzg2Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-19T17:42:45Z","updated_at":"2019-11-19T17:42:45Z","author_association":"CONTRIBUTOR","body":"> tableExists in Iceberg and Spark catalogs is implemented in a way that will swallow the exception and simply report false\r\n\r\nI think that's the expected behavior. That's why I updated this to throw `NoSuchTableException`. Shouldn't `tableExists` always return a boolean and not throw a `ValidationException`? I think users expect `tableExists` to be safe if they pass in an identifier.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/555623863/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/555629979","html_url":"https://github.com/apache/iceberg/pull/657#issuecomment-555629979","issue_url":"https://api.github.com/repos/apache/iceberg/issues/657","id":555629979,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NTYyOTk3OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-19T17:57:20Z","updated_at":"2019-11-19T17:57:20Z","author_association":"CONTRIBUTOR","body":"Looks good to me. Thanks for fixing this, @jerryshao!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/555629979/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]