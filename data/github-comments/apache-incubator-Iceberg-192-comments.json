[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209733705","html_url":"https://github.com/apache/iceberg/issues/5477#issuecomment-1209733705","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5477","id":1209733705,"node_id":"IC_kwDOCW7NX85IGxJJ","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T18:27:59Z","updated_at":"2022-08-09T18:27:59Z","author_association":"CONTRIBUTOR","body":"Ideally this could be documented either:\r\n1. generically, so we don't have to update it - possibly linking to the `dev/stage-binaries.sh` script to show the complete set of options (though this could create confusion).\r\n2. pulled from the repository somehow so that the versioned docs always have the complete set of commands. But we'd want to emphasize when is it important to use certain ones (like the scala version only affects Spark 3.2 and 3.3).\r\n\r\nIf you want to try this one out @deadwind4, I don't think you'll hear any objections. I would cc @samredai in case he has any concerns or existing knowledge of anything on going related to this ðŸ™‚ ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209733705/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209742236","html_url":"https://github.com/apache/iceberg/issues/5381#issuecomment-1209742236","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5381","id":1209742236,"node_id":"IC_kwDOCW7NX85IGzOc","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T18:36:16Z","updated_at":"2022-08-09T18:36:16Z","author_association":"CONTRIBUTOR","body":"I work at Tabular and as such don't use the Glue catalog super regularly in my day to day, but the error message mentions that the assumed role, `role_a`, is not authorized to perform `glue:GetUserDefinedFunctions` on ` arn:aws:glue:us-east-2:account_b:catalog` because there's no resource policy on ` arn:aws:glue:us-east-2:account_b:catalog` that allows anything to access that.\r\n\r\nI think this is one of those cases where permissions need to be defined bidirectionally -- that is, not only does the `role_a` or `role_b` need to be allowed `glue:GetUserDefinedFunctions` specifically on this resource (or on `*`), but there needs to be a corresponding policy _on that resource_ that allows those roles (or the primary role) to access it in the same way.\r\n\r\n\r\nTo troubleshoot:\r\n1, I'd try to make sure that the original role (the one that is being asxsumed) can perform the operation.\r\n2. If the above can be done, then the policies from the above can be cherry-picked for the assume role.\r\n\r\nIf you get the first role to work, but not the assumed role and you're sure that you have the same permission sets on both, then this might be a problem within AWS assume role. But I think that the bidirectional setup is required when going across accounts (such that not only can `role_a` assume `role_b`, but also that `role_b` is explicitly allowed by those resources to perform those operations).\r\n\r\nThis document probably explains it much better than I can: https://docs.aws.amazon.com/glue/latest/dg/cross-account-access.html","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209742236/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209745759","html_url":"https://github.com/apache/iceberg/issues/5381#issuecomment-1209745759","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5381","id":1209745759,"node_id":"IC_kwDOCW7NX85IG0Ff","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T18:40:08Z","updated_at":"2022-08-09T18:40:08Z","author_association":"CONTRIBUTOR","body":"TLDR - In the role that lists resources, I think you're missing a resource arn similiar to the following: `\"arn:aws:glue:us-east-1:123456789012:userDefinedFunction/` - specifically referencing `userDefinedFunction`. As `GetUserDefinedFunction` action is what it's trying to do and is not successfully able to.\r\n\r\nSee that `userDefinedFunction` is the one resource arn type not listed in your policy above: https://docs.aws.amazon.com/glue/latest/dg/glue-specifying-resource-arns.html#data-catalog-resource-arns","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209745759/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209758658","html_url":"https://github.com/apache/iceberg/pull/5478#issuecomment-1209758658","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5478","id":1209758658,"node_id":"IC_kwDOCW7NX85IG3PC","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T18:54:21Z","updated_at":"2022-08-09T18:58:13Z","author_association":"CONTRIBUTOR","body":"For the log that is causing confusion for users because the distributed engines (in this case Spark) then go on to do some cleanup, maybe we can update the log to state something similar to we're \"skipping clean up during current iteration, cleanup might occur later if this action is run from a distributed processing engine\"? Then possibly add logs to Spark as well?\r\n\r\n> I would like a lot to distinguish between \"didn't try\" and \"nothing to clean up\" -- even when \"nothing to clean up\" is because there were no expired files.\r\n\r\nMaybe we need a flag for `delayedFileCleanup` or just generally `runningViaDistributedAction` -- and then let Spark / engines control the logs?\r\n\r\nI don't love it, but throwing it out there as the current logging is admittedly confusing when the Spark action runs. And the Spark action / procedure is likely the most common way users interact with this action.\r\n\r\nEDIT - Given that snapshot expiration can happen at the end of any write, I see the significance of these logs and the Spark action is arguably not the most common way this occurs, though the most common way that users explicitly run this action is still likely through Spark.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209758658/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209827218","html_url":"https://github.com/apache/iceberg/pull/5470#issuecomment-1209827218","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5470","id":1209827218,"node_id":"IC_kwDOCW7NX85IHH-S","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T20:12:48Z","updated_at":"2022-08-09T20:12:48Z","author_association":"CONTRIBUTOR","body":"Thanks, @dependabot!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209827218/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209847041","html_url":"https://github.com/apache/iceberg/issues/5461#issuecomment-1209847041","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5461","id":1209847041,"node_id":"IC_kwDOCW7NX85IHM0B","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T20:34:00Z","updated_at":"2022-08-09T20:34:00Z","author_association":"CONTRIBUTOR","body":"As @kbendick mentioned, there should be an exception in the logs for the application. It would be great to check the application log for `job_1659792265699_0058`.\r\n\r\nAlso it would be great to have the exact Hive version as well.\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209847041/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209893192","html_url":"https://github.com/apache/iceberg/pull/5443#issuecomment-1209893192","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5443","id":1209893192,"node_id":"IC_kwDOCW7NX85IHYFI","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T21:02:24Z","updated_at":"2022-08-09T21:02:24Z","author_association":"CONTRIBUTOR","body":"LGTM too","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209893192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209896487","html_url":"https://github.com/apache/iceberg/pull/5469#issuecomment-1209896487","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5469","id":1209896487,"node_id":"IC_kwDOCW7NX85IHY4n","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T21:06:15Z","updated_at":"2022-08-09T21:06:15Z","author_association":"CONTRIBUTOR","body":"cc @kbendick @rdblue @flyrain @szehon-ho @RussellSpitzer @karuppayya @anuragmantri ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209896487/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209899727","html_url":"https://github.com/apache/iceberg/pull/5431#issuecomment-1209899727","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5431","id":1209899727,"node_id":"IC_kwDOCW7NX85IHZrP","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T21:10:16Z","updated_at":"2022-08-09T21:10:16Z","author_association":"CONTRIBUTOR","body":"cc @rdblue PTAL when you have time. I've addressed all of your feedback. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209899727/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209916257","html_url":"https://github.com/apache/iceberg/pull/5469#issuecomment-1209916257","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5469","id":1209916257,"node_id":"IC_kwDOCW7NX85IHdth","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T21:31:46Z","updated_at":"2022-08-09T21:31:46Z","author_association":"CONTRIBUTOR","body":"@karuppayya is working on benchmarks for actions. We will make sure to test everything before it is released.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209916257/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209917378","html_url":"https://github.com/apache/iceberg/pull/5469#issuecomment-1209917378","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5469","id":1209917378,"node_id":"IC_kwDOCW7NX85IHd_C","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T21:33:23Z","updated_at":"2022-08-09T21:33:23Z","author_association":"CONTRIBUTOR","body":"> @karuppayya is working on benchmarks for actions. We will make sure to test everything before it is released.\r\n\r\nCool. I don't have any issues on the technical merits of the PR and the typed values would be _much_ nicer to work with if there's no major performance overhead. Thanks @aokolnychyi!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209917378/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210011593","html_url":"https://github.com/apache/iceberg/issues/4086#issuecomment-1210011593","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4086","id":1210011593,"node_id":"IC_kwDOCW7NX85IH0_J","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T00:11:39Z","updated_at":"2022-08-10T00:11:39Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210011593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210011606","html_url":"https://github.com/apache/iceberg/issues/4074#issuecomment-1210011606","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4074","id":1210011606,"node_id":"IC_kwDOCW7NX85IH0_W","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T00:11:41Z","updated_at":"2022-08-10T00:11:41Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210011606/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210011668","html_url":"https://github.com/apache/iceberg/issues/3951#issuecomment-1210011668","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3951","id":1210011668,"node_id":"IC_kwDOCW7NX85IH1AU","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T00:11:50Z","updated_at":"2022-08-10T00:11:50Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210011668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210045376","html_url":"https://github.com/apache/iceberg/pull/5469#issuecomment-1210045376","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5469","id":1210045376,"node_id":"IC_kwDOCW7NX85IH9PA","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T01:18:51Z","updated_at":"2022-08-10T01:18:51Z","author_association":"CONTRIBUTOR","body":"> I like the using of type beans (I guess my fault for not using that originally :)\r\n\r\n@szehon-ho, I think we just historically used `Row` in all these methods. There are more and more use cases where we can benefit from more specific types so it seems beneficial to switch now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210045376/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210054609","html_url":"https://github.com/apache/iceberg/pull/5346#issuecomment-1210054609","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5346","id":1210054609,"node_id":"IC_kwDOCW7NX85IH_fR","user":{"login":"zhaomin1423","id":49054376,"node_id":"MDQ6VXNlcjQ5MDU0Mzc2","avatar_url":"https://avatars.githubusercontent.com/u/49054376?v=4","gravatar_id":"","url":"https://api.github.com/users/zhaomin1423","html_url":"https://github.com/zhaomin1423","followers_url":"https://api.github.com/users/zhaomin1423/followers","following_url":"https://api.github.com/users/zhaomin1423/following{/other_user}","gists_url":"https://api.github.com/users/zhaomin1423/gists{/gist_id}","starred_url":"https://api.github.com/users/zhaomin1423/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhaomin1423/subscriptions","organizations_url":"https://api.github.com/users/zhaomin1423/orgs","repos_url":"https://api.github.com/users/zhaomin1423/repos","events_url":"https://api.github.com/users/zhaomin1423/events{/privacy}","received_events_url":"https://api.github.com/users/zhaomin1423/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T01:38:10Z","updated_at":"2022-08-10T01:38:10Z","author_association":"MEMBER","body":"> @zhaomin1423 actually do you mind doing the same change for other spark versions? I feel normally we do feature for specific spark version(s), but for something like this that's purely cosmetic, would prefer to keep the code synchronized so its easier to backport changes if necessary.\r\n\r\nSorry for late reply. I'm wondering, why not use a common module or abstract class for repeated logical.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210054609/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210102921","html_url":"https://github.com/apache/iceberg/issues/5418#issuecomment-1210102921","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5418","id":1210102921,"node_id":"IC_kwDOCW7NX85IILSJ","user":{"login":"lvyanquan","id":38547014,"node_id":"MDQ6VXNlcjM4NTQ3MDE0","avatar_url":"https://avatars.githubusercontent.com/u/38547014?v=4","gravatar_id":"","url":"https://api.github.com/users/lvyanquan","html_url":"https://github.com/lvyanquan","followers_url":"https://api.github.com/users/lvyanquan/followers","following_url":"https://api.github.com/users/lvyanquan/following{/other_user}","gists_url":"https://api.github.com/users/lvyanquan/gists{/gist_id}","starred_url":"https://api.github.com/users/lvyanquan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lvyanquan/subscriptions","organizations_url":"https://api.github.com/users/lvyanquan/orgs","repos_url":"https://api.github.com/users/lvyanquan/repos","events_url":"https://api.github.com/users/lvyanquan/events{/privacy}","received_events_url":"https://api.github.com/users/lvyanquan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T03:17:17Z","updated_at":"2022-08-10T03:17:17Z","author_association":"CONTRIBUTOR","body":"Thank you for providing this opportunity, I will try it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210102921/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210121521","html_url":"https://github.com/apache/iceberg/issues/5418#issuecomment-1210121521","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5418","id":1210121521,"node_id":"IC_kwDOCW7NX85IIP0x","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T03:39:14Z","updated_at":"2022-08-10T03:39:14Z","author_association":"CONTRIBUTOR","body":"> Thank you for providing this opportunity, I will try it.\r\n\r\nGood luck.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210121521/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210127293","html_url":"https://github.com/apache/iceberg/pull/4898#issuecomment-1210127293","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4898","id":1210127293,"node_id":"IC_kwDOCW7NX85IIRO9","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T03:53:19Z","updated_at":"2022-08-10T03:54:02Z","author_association":"CONTRIBUTOR","body":"> I think the situation would be the same even in your proposal to add new schemaid field to data_file, right? After rewriteDataFiles we have to carry over the latest schema-id of each spec , in order for your initial proposed optimization to be accurate? Because there may be data in the new file that was written by a later schema.\r\n\r\nYou are correct. The data file with the new spec after rewrite. We can not benefit from the schema evaluation because we lost the original schema information.\r\n\r\n> As far as I can tell, it seems to be the right one that the manifest was written in, even after rewriteManifests. \r\n\r\nIn RewriteManifest, we use the current table partition [spec](https://github.com/apache/iceberg/blob/master/spark/v3.3/spark/src/main/java/org/apache/iceberg/spark/actions/RewriteManifestsSparkAction.java#L103) or the specified spec with spec ID. I think the schema used in the current space is not the same one as the original schema for the old manifest file. That's because we will [rewrite the partition spec](https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/TableMetadata.java#L952) when updating the table schema. Please correct me if I am wrong.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210127293/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210129537","html_url":"https://github.com/apache/iceberg/pull/5425#issuecomment-1210129537","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5425","id":1210129537,"node_id":"IC_kwDOCW7NX85IIRyB","user":{"login":"lintingbin","id":5699014,"node_id":"MDQ6VXNlcjU2OTkwMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/5699014?v=4","gravatar_id":"","url":"https://api.github.com/users/lintingbin","html_url":"https://github.com/lintingbin","followers_url":"https://api.github.com/users/lintingbin/followers","following_url":"https://api.github.com/users/lintingbin/following{/other_user}","gists_url":"https://api.github.com/users/lintingbin/gists{/gist_id}","starred_url":"https://api.github.com/users/lintingbin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lintingbin/subscriptions","organizations_url":"https://api.github.com/users/lintingbin/orgs","repos_url":"https://api.github.com/users/lintingbin/repos","events_url":"https://api.github.com/users/lintingbin/events{/privacy}","received_events_url":"https://api.github.com/users/lintingbin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T03:58:35Z","updated_at":"2022-08-10T03:58:35Z","author_association":"CONTRIBUTOR","body":"@stevenzwu Do I use broadcast operator to implement it here first, or do I have to wait until operator coordinator base is available in flink?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210129537/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210148871","html_url":"https://github.com/apache/iceberg/pull/5376#issuecomment-1210148871","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5376","id":1210148871,"node_id":"IC_kwDOCW7NX85IIWgH","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T04:33:25Z","updated_at":"2022-08-10T04:33:25Z","author_association":"CONTRIBUTOR","body":"It seems like a great idea to add readable metrics. It is hard to make sense of them otherwise.\r\n\r\n@szehon-ho, what do you think about adding a single map column, let's say called `readable_metrics`, that will hold a mapping from a column name into a struct that would represent metrics? The type will be `Map<String, StructType>` and we will have individual struct fields for each type of metric.\r\n\r\nWe can then easily access them via SQL.\r\n```\r\nSELECT readable_metrics['col1'].lower_bound FROM db.t.files\r\n```\r\n\r\nI am okay with individual columns too but it seems a bit cleaner to just have one.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210148871/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210158609","html_url":"https://github.com/apache/iceberg/pull/5431#issuecomment-1210158609","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5431","id":1210158609,"node_id":"IC_kwDOCW7NX85IIY4R","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T04:53:19Z","updated_at":"2022-08-10T04:53:19Z","author_association":"CONTRIBUTOR","body":"cc @nastra and @aokolnychyi as well as you reviewed the FunctionCatalog PR itself ðŸ™‚ ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210158609/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210162395","html_url":"https://github.com/apache/iceberg/pull/5379#issuecomment-1210162395","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5379","id":1210162395,"node_id":"IC_kwDOCW7NX85IIZzb","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T05:01:30Z","updated_at":"2022-08-10T05:01:30Z","author_association":"CONTRIBUTOR","body":"Let me take another look tomorrow. Sorry for the delay!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210162395/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210185067","html_url":"https://github.com/apache/iceberg/issues/5480#issuecomment-1210185067","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5480","id":1210185067,"node_id":"IC_kwDOCW7NX85IIfVr","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T05:38:54Z","updated_at":"2022-08-10T05:38:54Z","author_association":"CONTRIBUTOR","body":"thanks for spotting this. should be fixed by https://github.com/apache/iceberg/pull/5482","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210185067/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210312469","html_url":"https://github.com/apache/iceberg/issues/5480#issuecomment-1210312469","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5480","id":1210312469,"node_id":"IC_kwDOCW7NX85II-cV","user":{"login":"lvyanquan","id":38547014,"node_id":"MDQ6VXNlcjM4NTQ3MDE0","avatar_url":"https://avatars.githubusercontent.com/u/38547014?v=4","gravatar_id":"","url":"https://api.github.com/users/lvyanquan","html_url":"https://github.com/lvyanquan","followers_url":"https://api.github.com/users/lvyanquan/followers","following_url":"https://api.github.com/users/lvyanquan/following{/other_user}","gists_url":"https://api.github.com/users/lvyanquan/gists{/gist_id}","starred_url":"https://api.github.com/users/lvyanquan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lvyanquan/subscriptions","organizations_url":"https://api.github.com/users/lvyanquan/orgs","repos_url":"https://api.github.com/users/lvyanquan/repos","events_url":"https://api.github.com/users/lvyanquan/events{/privacy}","received_events_url":"https://api.github.com/users/lvyanquan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T08:06:41Z","updated_at":"2022-08-10T08:06:41Z","author_association":"CONTRIBUTOR","body":"update: should be fixed by https://github.com/apache/iceberg/pull/5484","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210312469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210346559","html_url":"https://github.com/apache/iceberg/issues/5418#issuecomment-1210346559","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5418","id":1210346559,"node_id":"IC_kwDOCW7NX85IJGw_","user":{"login":"lvyanquan","id":38547014,"node_id":"MDQ6VXNlcjM4NTQ3MDE0","avatar_url":"https://avatars.githubusercontent.com/u/38547014?v=4","gravatar_id":"","url":"https://api.github.com/users/lvyanquan","html_url":"https://github.com/lvyanquan","followers_url":"https://api.github.com/users/lvyanquan/followers","following_url":"https://api.github.com/users/lvyanquan/following{/other_user}","gists_url":"https://api.github.com/users/lvyanquan/gists{/gist_id}","starred_url":"https://api.github.com/users/lvyanquan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lvyanquan/subscriptions","organizations_url":"https://api.github.com/users/lvyanquan/orgs","repos_url":"https://api.github.com/users/lvyanquan/repos","events_url":"https://api.github.com/users/lvyanquan/events{/privacy}","received_events_url":"https://api.github.com/users/lvyanquan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T08:36:30Z","updated_at":"2022-08-10T08:36:30Z","author_association":"CONTRIBUTOR","body":"should be fixed by https://github.com/apache/iceberg/pull/5486","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210346559/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210429747","html_url":"https://github.com/apache/iceberg/issues/5414#issuecomment-1210429747","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5414","id":1210429747,"node_id":"IC_kwDOCW7NX85IJbEz","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T09:45:42Z","updated_at":"2022-08-10T09:45:42Z","author_association":"CONTRIBUTOR","body":"> but i do not think spark version should make a difference, correct?\r\n\r\nyup, i also don't think it should make difference. Just to be double sure, I applied this [patch](https://gist.github.com/singhpk234/5e570b04a8f8145846e1019a820eaef7) to 3.1 directory and can confirm it worked for me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210429747/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210482344","html_url":"https://github.com/apache/iceberg/pull/5486#issuecomment-1210482344","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5486","id":1210482344,"node_id":"IC_kwDOCW7NX85IJn6o","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T10:31:30Z","updated_at":"2022-08-10T10:31:30Z","author_association":"CONTRIBUTOR","body":"Thank you for your contribution. If you add `Close issuse id` to your body, it will automatically bound with the issuse.\r\nThere are also some tables that are not partitioned by date, we can consider whether to modify them together. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210482344/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210571712","html_url":"https://github.com/apache/iceberg/pull/5486#issuecomment-1210571712","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5486","id":1210571712,"node_id":"IC_kwDOCW7NX85IJ9vA","user":{"login":"lvyanquan","id":38547014,"node_id":"MDQ6VXNlcjM4NTQ3MDE0","avatar_url":"https://avatars.githubusercontent.com/u/38547014?v=4","gravatar_id":"","url":"https://api.github.com/users/lvyanquan","html_url":"https://github.com/lvyanquan","followers_url":"https://api.github.com/users/lvyanquan/followers","following_url":"https://api.github.com/users/lvyanquan/following{/other_user}","gists_url":"https://api.github.com/users/lvyanquan/gists{/gist_id}","starred_url":"https://api.github.com/users/lvyanquan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lvyanquan/subscriptions","organizations_url":"https://api.github.com/users/lvyanquan/orgs","repos_url":"https://api.github.com/users/lvyanquan/repos","events_url":"https://api.github.com/users/lvyanquan/events{/privacy}","received_events_url":"https://api.github.com/users/lvyanquan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T11:57:02Z","updated_at":"2022-08-10T11:57:02Z","author_association":"CONTRIBUTOR","body":"@hililiwei  Got it. I wrote a new version of the code and committed it, but I wonder should I rewrite the sql of testPrimaryKeyEqualToPartitionKey to unify the partition key. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210571712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210654340","html_url":"https://github.com/apache/iceberg/issues/3916#issuecomment-1210654340","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3916","id":1210654340,"node_id":"IC_kwDOCW7NX85IKR6E","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T13:11:27Z","updated_at":"2022-08-10T13:11:27Z","author_association":"MEMBER","body":"Close via https://github.com/apache/iceberg/pull/3784. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210654340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210903566","html_url":"https://github.com/apache/iceberg/pull/5417#issuecomment-1210903566","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5417","id":1210903566,"node_id":"IC_kwDOCW7NX85ILOwO","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T15:53:10Z","updated_at":"2022-08-15T21:05:16Z","author_association":"CONTRIBUTOR","body":"I think we're almost there. I marked it as a draft because it is still a bit dirty. For example, setting properties is still missing, and it had some rough edges. Would be great if we can merge in some of the other PRs that also allow us to clean this one up:\r\n\r\n- ~~[Python: Add __str__ implementation to SortOrder and SortField](https://github.com/apache/iceberg/pull/5490)~~\r\n- [Python: Add configuration](https://github.com/apache/iceberg/pull/5488)\r\n- ~~[Python: Checks on REST catalog table/namespace identifiers](https://github.com/apache/iceberg/pull/5485)~~\r\n- [Python: Add support for hierarchical namespaces](https://github.com/apache/iceberg/pull/5467)\r\n- [Python:  Implement Hive create and load table](https://github.com/apache/iceberg/pull/5447) (so we can make the `metadata` property required, and we don't have to do the assertions everywhere ðŸ‘ðŸ»\r\n\r\nAlso, have to add some tests because we're below the required test coverage. Thinking of injecting a mock catalog.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1210903566/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211027899","html_url":"https://github.com/apache/iceberg/pull/5469#issuecomment-1211027899","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5469","id":1211027899,"node_id":"IC_kwDOCW7NX85ILtG7","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T17:28:20Z","updated_at":"2022-08-10T17:28:20Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick @szehon-ho!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211027899/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211065634","html_url":"https://github.com/apache/iceberg/pull/4898#issuecomment-1211065634","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4898","id":1211065634,"node_id":"IC_kwDOCW7NX85IL2Ui","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T17:58:25Z","updated_at":"2022-08-10T17:58:25Z","author_association":"COLLABORATOR","body":"Yea you are right, it seems it will set the latest schema of each spec on the rewritten manifests, so the information is lost if you evolve schemas within a spec.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211065634/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211076671","html_url":"https://github.com/apache/iceberg/pull/5417#issuecomment-1211076671","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5417","id":1211076671,"node_id":"IC_kwDOCW7NX85IL5A_","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T18:09:24Z","updated_at":"2022-08-10T18:09:24Z","author_association":"CONTRIBUTOR","body":"Okay, I think I've reviewed all of the PRs. Lots of stuff going in!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211076671/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211078217","html_url":"https://github.com/apache/iceberg/pull/5479#issuecomment-1211078217","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5479","id":1211078217,"node_id":"IC_kwDOCW7NX85IL5ZJ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T18:11:04Z","updated_at":"2022-08-10T18:11:04Z","author_association":"CONTRIBUTOR","body":"@hililiwei, can you open separate PRs to backport those? I think this is too much for one PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211078217/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211203706","html_url":"https://github.com/apache/iceberg/pull/5438#issuecomment-1211203706","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5438","id":1211203706,"node_id":"IC_kwDOCW7NX85IMYB6","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T19:58:42Z","updated_at":"2022-08-10T19:58:42Z","author_association":"CONTRIBUTOR","body":"Thanks, @nastra!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211203706/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211295322","html_url":"https://github.com/apache/iceberg/issues/5414#issuecomment-1211295322","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5414","id":1211295322,"node_id":"IC_kwDOCW7NX85IMuZa","user":{"login":"jessiedanwang","id":25239320,"node_id":"MDQ6VXNlcjI1MjM5MzIw","avatar_url":"https://avatars.githubusercontent.com/u/25239320?v=4","gravatar_id":"","url":"https://api.github.com/users/jessiedanwang","html_url":"https://github.com/jessiedanwang","followers_url":"https://api.github.com/users/jessiedanwang/followers","following_url":"https://api.github.com/users/jessiedanwang/following{/other_user}","gists_url":"https://api.github.com/users/jessiedanwang/gists{/gist_id}","starred_url":"https://api.github.com/users/jessiedanwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jessiedanwang/subscriptions","organizations_url":"https://api.github.com/users/jessiedanwang/orgs","repos_url":"https://api.github.com/users/jessiedanwang/repos","events_url":"https://api.github.com/users/jessiedanwang/events{/privacy}","received_events_url":"https://api.github.com/users/jessiedanwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T21:28:10Z","updated_at":"2022-08-10T21:28:10Z","author_association":"NONE","body":"thanks for getting back. I have tried both spark 3.1 and spark 3.2 with SingletonImmutableBiMap as follows, still same error, i guess we will have to work with JavaSerializer for now\r\n\r\nAdd spark config\r\n.config(\"spark.kryo.registrator\", \"xxx.CustomKryoRegistrator\")\r\n\r\nimport com.esotericsoftware.kryo.Kryo;\r\nimport org.apache.iceberg.relocated.com.google.common.collect.ImmutableMap;\r\nimport org.apache.spark.serializer.KryoRegistrator;\r\n\r\npublic class CustomKryoRegistrator implements KryoRegistrator {\r\n    @Override\r\n    public void registerClasses(Kryo kryo){\r\n        final ImmutableRelocatedMapSerializer serializer = new ImmutableRelocatedMapSerializer();\r\n        //kryo.register(java.util.HashMap.class);\r\n        try {\r\n            kryo.register(Class.forName(\"org.apache.iceberg.relocated.com.google.common.collect.SingletonImmutableBiMap\"), serializer);\r\n        } catch (Exception e) {\r\n            // do nothing\r\n        }\r\n    }\r\n}","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211295322/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211297265","html_url":"https://github.com/apache/iceberg/pull/5494#issuecomment-1211297265","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5494","id":1211297265,"node_id":"IC_kwDOCW7NX85IMu3x","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T21:30:13Z","updated_at":"2022-08-10T21:30:13Z","author_association":"CONTRIBUTOR","body":"Thanks, @szehon-ho!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211297265/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211299573","html_url":"https://github.com/apache/iceberg/pull/5379#issuecomment-1211299573","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5379","id":1211299573,"node_id":"IC_kwDOCW7NX85IMvb1","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T21:32:54Z","updated_at":"2022-08-10T21:32:54Z","author_association":"CONTRIBUTOR","body":"> This change looks good to me.\r\n> \r\n> After a closer look, passing an explicit executor started to make more sense to me. I think we may add that overloaded method back once we consume these changes in other places.\r\n\r\nRight, this is my thought as well. Once we see there is a need for the API we can add that, it's harder to go the other way.\r\n\r\nThanks for the review @aokolnychyi !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211299573/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211379285","html_url":"https://github.com/apache/iceberg/pull/5493#issuecomment-1211379285","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5493","id":1211379285,"node_id":"IC_kwDOCW7NX85INC5V","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T23:02:09Z","updated_at":"2022-08-10T23:02:09Z","author_association":"CONTRIBUTOR","body":"@stevenzwu and @openinx, can you review this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211379285/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211379948","html_url":"https://github.com/apache/iceberg/pull/5379#issuecomment-1211379948","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5379","id":1211379948,"node_id":"IC_kwDOCW7NX85INDDs","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T23:03:01Z","updated_at":"2022-08-10T23:03:01Z","author_association":"CONTRIBUTOR","body":"I think we get enough approvals, thanks for the work @amogh-jahagirdar , and thanks everyone for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211379948/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211380762","html_url":"https://github.com/apache/iceberg/pull/5379#issuecomment-1211380762","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5379","id":1211380762,"node_id":"IC_kwDOCW7NX85INDQa","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T23:04:12Z","updated_at":"2022-08-10T23:04:35Z","author_association":"CONTRIBUTOR","body":"Thanks everyone for the reviews! @jackye1995 @singhpk234 @aokolnychyi @szehon-ho ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211380762/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211383664","html_url":"https://github.com/apache/iceberg/pull/5459#issuecomment-1211383664","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5459","id":1211383664,"node_id":"IC_kwDOCW7NX85IND9w","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T23:07:52Z","updated_at":"2022-08-10T23:10:12Z","author_association":"CONTRIBUTOR","body":"@szehon-ho @danielcweeks @aokolnychyi @rdblue Would be happy to get your feedback as well! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211383664/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211383878","html_url":"https://github.com/apache/iceberg/pull/5475#issuecomment-1211383878","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5475","id":1211383878,"node_id":"IC_kwDOCW7NX85INEBG","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-10T23:08:09Z","updated_at":"2022-08-10T23:08:09Z","author_association":"CONTRIBUTOR","body":"I think we've decided to go with `useRef` rather than separate tag and branch methods. I'll close this. Thanks, @namrathamyske!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211383878/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211424699","html_url":"https://github.com/apache/iceberg/pull/4695#issuecomment-1211424699","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4695","id":1211424699,"node_id":"IC_kwDOCW7NX85INN-7","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-11T00:08:13Z","updated_at":"2022-08-11T00:08:13Z","author_association":"CONTRIBUTOR","body":"The caching logic is quite complex, I would suggest separate the S3 prefetch client feature to a separated PR if possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211424699/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211432509","html_url":"https://github.com/apache/iceberg/pull/4926#issuecomment-1211432509","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4926","id":1211432509,"node_id":"IC_kwDOCW7NX85INP49","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-11T00:22:29Z","updated_at":"2022-08-11T00:22:29Z","author_association":"CONTRIBUTOR","body":"Looks like we are all in agreement, I will merge this to unblock next step implementations. thanks for the contribution @namrathamyske @amogh-jahagirdar ! and thanks for the review @rdblue !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211432509/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211561807","html_url":"https://github.com/apache/iceberg/pull/5297#issuecomment-1211561807","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5297","id":1211561807,"node_id":"IC_kwDOCW7NX85INvdP","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-11T05:19:02Z","updated_at":"2022-08-11T05:19:02Z","author_association":"MEMBER","body":"As there is no activity in this. \r\nI have opened https://github.com/apache/iceberg/pull/5492","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211561807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211653914","html_url":"https://github.com/apache/iceberg/pull/5380#issuecomment-1211653914","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5380","id":1211653914,"node_id":"IC_kwDOCW7NX85IOF8a","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-11T07:45:28Z","updated_at":"2022-08-11T07:45:28Z","author_association":"CONTRIBUTOR","body":"@stevenzwu Thank you for your review. I listed the Upsert part separately and made some changes. Please take another look. thx.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211653914/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211979113","html_url":"https://github.com/apache/iceberg/issues/5442#issuecomment-1211979113","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5442","id":1211979113,"node_id":"IC_kwDOCW7NX85IPVVp","user":{"login":"alexjo2144","id":7109804,"node_id":"MDQ6VXNlcjcxMDk4MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/7109804?v=4","gravatar_id":"","url":"https://api.github.com/users/alexjo2144","html_url":"https://github.com/alexjo2144","followers_url":"https://api.github.com/users/alexjo2144/followers","following_url":"https://api.github.com/users/alexjo2144/following{/other_user}","gists_url":"https://api.github.com/users/alexjo2144/gists{/gist_id}","starred_url":"https://api.github.com/users/alexjo2144/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexjo2144/subscriptions","organizations_url":"https://api.github.com/users/alexjo2144/orgs","repos_url":"https://api.github.com/users/alexjo2144/repos","events_url":"https://api.github.com/users/alexjo2144/events{/privacy}","received_events_url":"https://api.github.com/users/alexjo2144/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-11T13:19:02Z","updated_at":"2022-08-11T13:19:02Z","author_association":"CONTRIBUTOR","body":"@rdblue or @danielcweeks either of you have any thoughts on this one? We reverted the changes in Trino that hit this case, but it would be nice to be able to put them back at some point.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211979113/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211997121","html_url":"https://github.com/apache/iceberg/pull/5450#issuecomment-1211997121","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5450","id":1211997121,"node_id":"IC_kwDOCW7NX85IPZvB","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-11T13:34:03Z","updated_at":"2022-08-11T13:34:03Z","author_association":"MEMBER","body":"Per https://github.com/apache/iceberg/pull/5450#discussion_r942982664, i have rebased this off of https://github.com/apache/iceberg/pull/5021.\r\n\r\n@rdblue please take another look when you want ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1211997121/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212127251","html_url":"https://github.com/apache/iceberg/pull/5431#issuecomment-1212127251","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5431","id":1212127251,"node_id":"IC_kwDOCW7NX85IP5gT","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-11T15:12:26Z","updated_at":"2022-08-11T15:12:26Z","author_association":"CONTRIBUTOR","body":"I'd love to take a look as well today. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212127251/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212170643","html_url":"https://github.com/apache/iceberg/issues/3665#issuecomment-1212170643","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3665","id":1212170643,"node_id":"IC_kwDOCW7NX85IQEGT","user":{"login":"kpe","id":2535923,"node_id":"MDQ6VXNlcjI1MzU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/2535923?v=4","gravatar_id":"","url":"https://api.github.com/users/kpe","html_url":"https://github.com/kpe","followers_url":"https://api.github.com/users/kpe/followers","following_url":"https://api.github.com/users/kpe/following{/other_user}","gists_url":"https://api.github.com/users/kpe/gists{/gist_id}","starred_url":"https://api.github.com/users/kpe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpe/subscriptions","organizations_url":"https://api.github.com/users/kpe/orgs","repos_url":"https://api.github.com/users/kpe/repos","events_url":"https://api.github.com/users/kpe/events{/privacy}","received_events_url":"https://api.github.com/users/kpe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-11T15:48:07Z","updated_at":"2022-08-11T15:48:07Z","author_association":"NONE","body":"@huaxingao - wow, having a `Merge` in the `DataFrameWriterV2` would be great - is this already tracked by the Spark folks, jira or issue we can monitor?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212170643/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212232061","html_url":"https://github.com/apache/iceberg/pull/5493#issuecomment-1212232061","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5493","id":1212232061,"node_id":"IC_kwDOCW7NX85IQTF9","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-11T16:46:52Z","updated_at":"2022-08-11T16:46:52Z","author_association":"CONTRIBUTOR","body":"@hililiwei I have a couple of high-level questions\r\n\r\n* can you elaborate what is exactly blocked in readers?\r\n* can you try the new FLIP-27 source?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212232061/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212233279","html_url":"https://github.com/apache/iceberg/pull/5496#issuecomment-1212233279","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5496","id":1212233279,"node_id":"IC_kwDOCW7NX85IQTY_","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-11T16:48:06Z","updated_at":"2022-08-11T16:48:06Z","author_association":"CONTRIBUTOR","body":"Did you mean to use the new method somewhere?\r\n\r\nAlso, I don't think that we want to use \"unsafe\" in the name. This is not unsafe, it is a different method contract.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212233279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212239377","html_url":"https://github.com/apache/iceberg/pull/5496#issuecomment-1212239377","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5496","id":1212239377,"node_id":"IC_kwDOCW7NX85IQU4R","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-11T16:52:44Z","updated_at":"2022-08-11T16:52:44Z","author_association":"CONTRIBUTOR","body":"The validation seems redundant but I'd also play around with the method name.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212239377/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212251256","html_url":"https://github.com/apache/iceberg/pull/5459#issuecomment-1212251256","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5459","id":1212251256,"node_id":"IC_kwDOCW7NX85IQXx4","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-11T16:59:53Z","updated_at":"2022-08-11T16:59:53Z","author_association":"CONTRIBUTOR","body":"I'd love to take a look later today.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212251256/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212476159","html_url":"https://github.com/apache/iceberg/issues/5487#issuecomment-1212476159","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5487","id":1212476159,"node_id":"IC_kwDOCW7NX85IROr_","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-11T20:45:53Z","updated_at":"2022-08-11T20:45:53Z","author_association":"CONTRIBUTOR","body":"Can you please provide a sample `MERGE INTO` query @SusurHe?\r\n\r\nWhen I think of dynamic partition pruning, I think of the ability to filter out specific partitions from the input table during a query based on some kind of `WHERE` clause, not necessarily the results of adaptive query execution.\r\n\r\nThe dynamic partition pruning I'm thinking of is controlled by the `SupportsRuntimeFiltering` interface, which was added in Iceberg 0.13.0.\r\n\r\nIf you could provide the `MERGE INTO` query, the results of `EXPLAIN` or the full explain output from the SQL UI, as well as generally the number of partition values that were touched (or at least the create table DDL of the table being merged into), that would help a lot to debug why you're not getting fewer partition files.\r\n\r\nHowever, from what's being provided, it's hard to tell if dynamic partition pruning, i.e. if partitions are pruned from the input before the join / processing, is taking place. But I get the impression that's not what you mean and you're more interested in adaptive query execution.\r\n\r\nIn either case, you might need to set `spark.sql.adaptive.coalescePartitions.parallelismFirst` to `false`.\r\n\r\nFrom the docs for `spark.sql.adaptive.coalescePartitions.parallelismFirst` found here: https://spark.apache.org/docs/latest/sql-performance-tuning.html\r\n\r\n`When true, Spark ignores the target size specified by spark.sql.adaptive.advisoryPartitionSizeInBytes (default 64MB) when coalescing contiguous shuffle partitions, and only respect the minimum partition size specified by spark.sql.adaptive.coalescePartitions.minPartitionSize (default 1MB), to maximize the parallelism. This is to avoid performance regression when enabling adaptive query execution. It's recommended to set this config to false and respect the target size specified by spark.sql.adaptive.advisoryPartitionSizeInBytes.`\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212476159/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212481879","html_url":"https://github.com/apache/iceberg/pull/5431#issuecomment-1212481879","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5431","id":1212481879,"node_id":"IC_kwDOCW7NX85IRQFX","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-11T20:53:12Z","updated_at":"2022-08-11T20:53:12Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi @rdblue I addressed all of your feedback.\r\n\r\nPlease take a look when you get a chance. Also, on the subject of nullability for the `width` column, I was able to make it work but reverted it based on this comment thread: https://github.com/apache/iceberg/pull/5431#discussion_r943914954\r\n\r\nKnowing that Spark isn't the best at keeping track of nullability, I think this is better and adheres to the contract laid out in `ScalarFunction` as quoted by @aokolnychyi.\r\n\r\nBut take a look at the commit that added nullability-checking on the width field if you'd like: https://github.com/apache/iceberg/pull/5431/commits/ad5343facb561750f24e59e8cdba4da882b0313c","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212481879/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212484144","html_url":"https://github.com/apache/iceberg/pull/5425#issuecomment-1212484144","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5425","id":1212484144,"node_id":"IC_kwDOCW7NX85IRQow","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-11T20:56:03Z","updated_at":"2022-08-15T04:13:39Z","author_association":"CONTRIBUTOR","body":"@lintingbin2009 regardless broadcast operator or coordinator base, we can probably close this PR. I actually prefer a short design doc or an extended description in issue #4190  first that describes the problem, scenarios where this solution fits. Here are a couple points in my mind.\r\n\r\nTo me, this feature makes sense for simple pass-through jobs (e.g. read from Kafka and write to Iceberg). On the Kafka input side, schema registry is used to automatically deserialize or convert to `RowData` using latest schema. In the Iceberg output side, it will be useful to automatically pick latest table schema and write `RowData` using the latest table schema.\r\n\r\nIf the Flink job constructs the output RowData in code, this feature doesn't make sense since we need to change and deploy new code anyway.\r\n\r\nDo we need to enforce compatibility check here? Answer could be no. Let the writer fail, although the exception from write failure might be unfriendly to users.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212484144/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212494603","html_url":"https://github.com/apache/iceberg/pull/5496#issuecomment-1212494603","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5496","id":1212494603,"node_id":"IC_kwDOCW7NX85IRTML","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-11T21:09:17Z","updated_at":"2022-08-11T21:09:17Z","author_association":"CONTRIBUTOR","body":"> The validation seems redundant but I'd also play around with the method name.\r\n\r\n+1 to the name thing. I changed it to `truncateStringWithoutLengthValidation`, which is better but I don't really love that either.\r\n\r\nI'm open to suggestions if anybody has any. I would potentially change the name of the _original_ function to `truncateStringWithLengthValidation` and make this the new function definition for the shorter name, but that involves updating more calls.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212494603/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212599004","html_url":"https://github.com/apache/iceberg/pull/5505#issuecomment-1212599004","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5505","id":1212599004,"node_id":"IC_kwDOCW7NX85IRsrc","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-11T23:50:40Z","updated_at":"2022-08-11T23:50:40Z","author_association":"CONTRIBUTOR","body":"@nastra, I opened https://github.com/nastra/iceberg/pull/23 to remove the old counter implementations. Let me know what you think.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212599004/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212599724","html_url":"https://github.com/apache/iceberg/pull/5431#issuecomment-1212599724","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5431","id":1212599724,"node_id":"IC_kwDOCW7NX85IRs2s","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-11T23:52:20Z","updated_at":"2022-08-11T23:52:20Z","author_association":"CONTRIBUTOR","body":"Looks good to me. @aokolnychyi, do you want to take another look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212599724/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212608609","html_url":"https://github.com/apache/iceberg/issues/4063#issuecomment-1212608609","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4063","id":1212608609,"node_id":"IC_kwDOCW7NX85IRvBh","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T00:11:35Z","updated_at":"2022-08-12T00:11:35Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212608609/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212678542","html_url":"https://github.com/apache/iceberg/pull/5425#issuecomment-1212678542","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5425","id":1212678542,"node_id":"IC_kwDOCW7NX85ISAGO","user":{"login":"lintingbin","id":5699014,"node_id":"MDQ6VXNlcjU2OTkwMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/5699014?v=4","gravatar_id":"","url":"https://api.github.com/users/lintingbin","html_url":"https://github.com/lintingbin","followers_url":"https://api.github.com/users/lintingbin/followers","following_url":"https://api.github.com/users/lintingbin/following{/other_user}","gists_url":"https://api.github.com/users/lintingbin/gists{/gist_id}","starred_url":"https://api.github.com/users/lintingbin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lintingbin/subscriptions","organizations_url":"https://api.github.com/users/lintingbin/orgs","repos_url":"https://api.github.com/users/lintingbin/repos","events_url":"https://api.github.com/users/lintingbin/events{/privacy}","received_events_url":"https://api.github.com/users/lintingbin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T02:49:08Z","updated_at":"2022-08-12T02:49:08Z","author_association":"CONTRIBUTOR","body":"@stevenzwu You are right. This feature is mainly used for data delivery internally, and the data source is mainly kafka or mysql cdc. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212678542/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212770220","html_url":"https://github.com/apache/iceberg/pull/5478#issuecomment-1212770220","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5478","id":1212770220,"node_id":"IC_kwDOCW7NX85ISWes","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T06:23:23Z","updated_at":"2022-08-12T06:23:23Z","author_association":"MEMBER","body":"> Maybe we need a flag for delayedFileCleanup or just generally runningViaDistributedAction -- and then let Spark / engines control the logs?\r\n\r\n@kbendick : I originally had the same thought. But it is making things more complex as we are linking core logic to callers.  \r\nI think the current changes in the PR is enough to clear the confusion (It will also differentiates \"disabled\" vs \"nothing to clean up\") ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212770220/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212774963","html_url":"https://github.com/apache/iceberg/pull/5508#issuecomment-1212774963","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5508","id":1212774963,"node_id":"IC_kwDOCW7NX85ISXoz","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T06:31:17Z","updated_at":"2022-08-12T06:31:33Z","author_association":"CONTRIBUTOR","body":"should we also include the code part which actually does [s3 client initialization](https://github.com/apache/iceberg/pull/4695/files#diff-322d2e2be6cbad87106f05c0456cf953d99f396c71c99a1d8c7bc281022f8b6bR342) based on this property in this PR ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212774963/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212806558","html_url":"https://github.com/apache/iceberg/pull/5508#issuecomment-1212806558","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5508","id":1212806558,"node_id":"IC_kwDOCW7NX85ISfWe","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T07:20:22Z","updated_at":"2022-08-12T07:20:22Z","author_association":"CONTRIBUTOR","body":"> should we also include the code part which actually does [s3 client initialization](https://github.com/apache/iceberg/pull/4695/files#diff-322d2e2be6cbad87106f05c0456cf953d99f396c71c99a1d8c7bc281022f8b6bR342) based on this property in this PR ?\r\n\r\ngood point, I discussed and we want to separate that part because it requires merging the LakeFormation caching PR #4695 first. This PR is to reduce the volume of that one.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212806558/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212807565","html_url":"https://github.com/apache/iceberg/pull/5508#issuecomment-1212807565","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5508","id":1212807565,"node_id":"IC_kwDOCW7NX85ISfmN","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T07:21:40Z","updated_at":"2022-08-12T07:21:40Z","author_association":"CONTRIBUTOR","body":"Oh actually nvm, @singhpk234 I get what you mean now, yes the part in S3FileIO should be included. @xiaoxuandev let us know when you have that part added.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212807565/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212867591","html_url":"https://github.com/apache/iceberg/issues/5404#issuecomment-1212867591","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5404","id":1212867591,"node_id":"IC_kwDOCW7NX85ISuQH","user":{"login":"Shane-Yu","id":26053387,"node_id":"MDQ6VXNlcjI2MDUzMzg3","avatar_url":"https://avatars.githubusercontent.com/u/26053387?v=4","gravatar_id":"","url":"https://api.github.com/users/Shane-Yu","html_url":"https://github.com/Shane-Yu","followers_url":"https://api.github.com/users/Shane-Yu/followers","following_url":"https://api.github.com/users/Shane-Yu/following{/other_user}","gists_url":"https://api.github.com/users/Shane-Yu/gists{/gist_id}","starred_url":"https://api.github.com/users/Shane-Yu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Shane-Yu/subscriptions","organizations_url":"https://api.github.com/users/Shane-Yu/orgs","repos_url":"https://api.github.com/users/Shane-Yu/repos","events_url":"https://api.github.com/users/Shane-Yu/events{/privacy}","received_events_url":"https://api.github.com/users/Shane-Yu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T08:35:15Z","updated_at":"2022-08-12T09:11:52Z","author_association":"NONE","body":"I also met this probelm in the same case.  It's not  \"some delete files associated with the data file\" casue this problem.  Add log in the  tail of https://github.com/apache/iceberg/blob/5a15efc070ab59eeda6343998aa065c0c9892c5c/core/src/main/java/org/apache/iceberg/DeleteFileIndex.java#L151  to print the data file path, delete file path, lower and upper. And you can see the upper and lower filepath info is not complete filepath, but truncate 16 bit.  This can lead to false positives when determining whether a data file references a deleted file.   From the source code https://github.com/apache/iceberg/blob/5a15efc070ab59eeda6343998aa065c0c9892c5c/core/src/main/java/org/apache/iceberg/MetricsConfig.java#L52  you can see the DEFAULT_WRITE_METRICS_MODE_DEFAULT is truncate(16).  The upper and lower information of the filepath was intercepted when the data file was generated,  which lead to the misjudgment  when commit  in rewrite data. \r\n     To resolve this problem,  add a property  like this when create table.\r\n`  alter table iceberg_table set tblproperties (\r\n  'write.metadata.metrics.default'='full'\r\n );`\r\n ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212867591/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212893364","html_url":"https://github.com/apache/iceberg/issues/5404#issuecomment-1212893364","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5404","id":1212893364,"node_id":"IC_kwDOCW7NX85IS0i0","user":{"login":"hzluting","id":5558252,"node_id":"MDQ6VXNlcjU1NTgyNTI=","avatar_url":"https://avatars.githubusercontent.com/u/5558252?v=4","gravatar_id":"","url":"https://api.github.com/users/hzluting","html_url":"https://github.com/hzluting","followers_url":"https://api.github.com/users/hzluting/followers","following_url":"https://api.github.com/users/hzluting/following{/other_user}","gists_url":"https://api.github.com/users/hzluting/gists{/gist_id}","starred_url":"https://api.github.com/users/hzluting/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hzluting/subscriptions","organizations_url":"https://api.github.com/users/hzluting/orgs","repos_url":"https://api.github.com/users/hzluting/repos","events_url":"https://api.github.com/users/hzluting/events{/privacy}","received_events_url":"https://api.github.com/users/hzluting/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T09:05:28Z","updated_at":"2022-08-12T09:05:28Z","author_association":"CONTRIBUTOR","body":"> I also met this probelm in the same case. It's not \"some delete files associated with the data file\" casue this problem. Add log in the tail of\r\n> \r\n> https://github.com/apache/iceberg/blob/5a15efc070ab59eeda6343998aa065c0c9892c5c/core/src/main/java/org/apache/iceberg/DeleteFileIndex.java#L151\r\n> \r\n> to print the data file path, delete file path, lower and upper. And you can see the upper and lower filepath info is not complete filepath, but truncate 16 bit. This can lead to false positives when determining whether a data file references a deleted file. From the source code\r\n> https://github.com/apache/iceberg/blob/5a15efc070ab59eeda6343998aa065c0c9892c5c/core/src/main/java/org/apache/iceberg/MetricsConfig.java#L52\r\n> \r\n> you can see the DEFAULT_WRITE_METRICS_MODE_DEFAULT is truncate(16). The upper and lower information of the filepath was intercepted when the data file was generated, which lead to the misjudgment when commit in rewrite data.\r\n> To resolve this problem, add a property like this when create table.\r\n> ` alter table iceberg_table set tblproperties ( 'write.etadata.metrics.default'='full' );`\r\n\r\nYes, you are right! I'm wondering why I can't reproduce this problem.\r\nBut the property key is write.metadata.metrics.default","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1212893364/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213039273","html_url":"https://github.com/apache/iceberg/pull/5492#issuecomment-1213039273","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5492","id":1213039273,"node_id":"IC_kwDOCW7NX85ITYKp","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T12:02:53Z","updated_at":"2022-08-12T12:02:53Z","author_association":"MEMBER","body":"Hopefully later we can call this API from python CLI and make the migration more easier. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213039273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213225387","html_url":"https://github.com/apache/iceberg/pull/5431#issuecomment-1213225387","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5431","id":1213225387,"node_id":"IC_kwDOCW7NX85IUFmr","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T15:18:26Z","updated_at":"2022-08-12T15:18:26Z","author_association":"CONTRIBUTOR","body":"@rdblue, let me take a quick now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213225387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213236871","html_url":"https://github.com/apache/iceberg/pull/5431#issuecomment-1213236871","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5431","id":1213236871,"node_id":"IC_kwDOCW7NX85IUIaH","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T15:31:00Z","updated_at":"2022-08-12T15:31:00Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick! Could you cherry-pick this to 3.2?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213236871/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213237967","html_url":"https://github.com/apache/iceberg/pull/5490#issuecomment-1213237967","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5490","id":1213237967,"node_id":"IC_kwDOCW7NX85IUIrP","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T15:32:09Z","updated_at":"2022-08-12T15:32:09Z","author_association":"CONTRIBUTOR","body":"Looks great. Thanks, @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213237967/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213254331","html_url":"https://github.com/apache/iceberg/pull/5501#issuecomment-1213254331","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5501","id":1213254331,"node_id":"IC_kwDOCW7NX85IUMq7","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T15:45:19Z","updated_at":"2022-08-12T15:45:19Z","author_association":"CONTRIBUTOR","body":"Looks like there were some failures. @hililiwei, could you double-check whether they were related?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213254331/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213254914","html_url":"https://github.com/apache/iceberg/pull/5503#issuecomment-1213254914","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5503","id":1213254914,"node_id":"IC_kwDOCW7NX85IUM0C","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T15:45:47Z","updated_at":"2022-08-12T15:45:47Z","author_association":"CONTRIBUTOR","body":"Same here. Could you check, @hililiwei?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213254914/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213258898","html_url":"https://github.com/apache/iceberg/pull/5447#issuecomment-1213258898","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5447","id":1213258898,"node_id":"IC_kwDOCW7NX85IUNyS","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T15:49:10Z","updated_at":"2022-08-12T15:49:10Z","author_association":"CONTRIBUTOR","body":"@Fokko, looks like this is ready except that it conflicts with the order by PR that was just merged. I tried to fix it, but I didn't get it right.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213258898/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213260204","html_url":"https://github.com/apache/iceberg/pull/5376#issuecomment-1213260204","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5376","id":1213260204,"node_id":"IC_kwDOCW7NX85IUOGs","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T15:50:10Z","updated_at":"2022-08-12T15:50:10Z","author_association":"CONTRIBUTOR","body":"Let me check in a bit.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213260204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213339808","html_url":"https://github.com/apache/iceberg/pull/5346#issuecomment-1213339808","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5346","id":1213339808,"node_id":"IC_kwDOCW7NX85IUhig","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T17:15:18Z","updated_at":"2022-08-12T18:30:19Z","author_association":"COLLABORATOR","body":"@zhaomin1423 yea its a good question, it seems it was done this way in the initial split of the Spark modules to different versions.  I think most of the spark code is actually the same across versions :(.  I guess the other option is to have just one spark module and have a  shim layer to take care of different things, but not sure that's easy either. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213339808/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213389715","html_url":"https://github.com/apache/iceberg/pull/5431#issuecomment-1213389715","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5431","id":1213389715,"node_id":"IC_kwDOCW7NX85IUtuT","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T18:21:20Z","updated_at":"2022-08-12T18:21:20Z","author_association":"CONTRIBUTOR","body":"Here's the PR for bucket. All the feedback from this PR was more or less applied there as well - https://github.com/apache/iceberg/pull/5513","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213389715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213389791","html_url":"https://github.com/apache/iceberg/pull/5431#issuecomment-1213389791","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5431","id":1213389791,"node_id":"IC_kwDOCW7NX85IUtvf","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T18:21:27Z","updated_at":"2022-08-12T18:21:27Z","author_association":"CONTRIBUTOR","body":"> Thanks, @kbendick! Could you cherry-pick this to 3.2?\r\n\r\nSure thing!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213389791/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213402765","html_url":"https://github.com/apache/iceberg/issues/5509#issuecomment-1213402765","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5509","id":1213402765,"node_id":"IC_kwDOCW7NX85IUw6N","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T18:34:21Z","updated_at":"2022-08-12T18:34:21Z","author_association":"CONTRIBUTOR","body":"@Cqz666: The new config is added by this [commit](https://github.com/apache/iceberg/commit/41570a1877bb0f7dd4b2a91addbbca08b3721588). I think this is not part of the 0.14 Iceberg release yet. If it is possible for you, you can try out the feature using Iceberg compiled from the master branch.\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213402765/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213412388","html_url":"https://github.com/apache/iceberg/issues/5507#issuecomment-1213412388","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5507","id":1213412388,"node_id":"IC_kwDOCW7NX85IUzQk","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T18:42:57Z","updated_at":"2022-08-12T18:42:57Z","author_association":"CONTRIBUTOR","body":"Since the above refactoring has a transaction being used, it seems like we need to discard the changes and/or commit the transaction (possibly as a no-op).\r\n\r\nThis does seem like something that should be allowed to proceed though, unless there's a reason not to allow it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213412388/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213444321","html_url":"https://github.com/apache/iceberg/issues/5507#issuecomment-1213444321","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5507","id":1213444321,"node_id":"IC_kwDOCW7NX85IU7Dh","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-12T19:25:29Z","updated_at":"2022-08-12T19:26:24Z","author_association":"CONTRIBUTOR","body":"Yeah I think it makes sense to commit the SetSnapshotOperation. I remember a of related discussion around this came up in https://github.com/apache/iceberg/pull/4071#discussion_r837008625  for updating snapshot references. We commit the operation even if there are no changes for updating snapshot reference.\r\n\r\nAnother way I was thinking was in BaseTransaction we https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/BaseTransaction.java#L502 we just advance the \"lastOperationCommitted\" flag in the case there is no intermediate snapshots or metadata updates. That way we avoid having to do a commit in the first place because it seems as though the original concern is the extra call required for commit? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213444321/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213625542","html_url":"https://github.com/apache/iceberg/pull/5346#issuecomment-1213625542","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5346","id":1213625542,"node_id":"IC_kwDOCW7NX85IVnTG","user":{"login":"zhaomin1423","id":49054376,"node_id":"MDQ6VXNlcjQ5MDU0Mzc2","avatar_url":"https://avatars.githubusercontent.com/u/49054376?v=4","gravatar_id":"","url":"https://api.github.com/users/zhaomin1423","html_url":"https://github.com/zhaomin1423","followers_url":"https://api.github.com/users/zhaomin1423/followers","following_url":"https://api.github.com/users/zhaomin1423/following{/other_user}","gists_url":"https://api.github.com/users/zhaomin1423/gists{/gist_id}","starred_url":"https://api.github.com/users/zhaomin1423/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhaomin1423/subscriptions","organizations_url":"https://api.github.com/users/zhaomin1423/orgs","repos_url":"https://api.github.com/users/zhaomin1423/repos","events_url":"https://api.github.com/users/zhaomin1423/events{/privacy}","received_events_url":"https://api.github.com/users/zhaomin1423/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-13T01:18:45Z","updated_at":"2022-08-13T01:18:45Z","author_association":"MEMBER","body":"> @zhaomin1423 yea its a good question, it seems it was done this way in the initial split of the Spark modules to different versions. I think most of the spark code is actually the same across versions :(. I guess the other option is to have just one spark module and have a shim layer to take care of different things, but not sure that's easy either.\r\n\r\nKeeping a shim layer is difficult with the addition of versionsï¼Œbecause a lot of reflect will be added, it is obscure when reading, and some question can't be found in compile stage. Adding a spark common module to put same code, it might be more easier.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213625542/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213636656","html_url":"https://github.com/apache/iceberg/pull/5503#issuecomment-1213636656","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5503","id":1213636656,"node_id":"IC_kwDOCW7NX85IVqAw","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-13T02:36:51Z","updated_at":"2022-08-13T02:36:51Z","author_association":"CONTRIBUTOR","body":"reopen to try re-run ci","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213636656/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213636757","html_url":"https://github.com/apache/iceberg/pull/5501#issuecomment-1213636757","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5501","id":1213636757,"node_id":"IC_kwDOCW7NX85IVqCV","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-13T02:37:42Z","updated_at":"2022-08-13T02:37:42Z","author_association":"CONTRIBUTOR","body":"reopen to try re-run ci","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213636757/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213646911","html_url":"https://github.com/apache/iceberg/issues/5273#issuecomment-1213646911","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5273","id":1213646911,"node_id":"IC_kwDOCW7NX85IVsg_","user":{"login":"yabola","id":31469905,"node_id":"MDQ6VXNlcjMxNDY5OTA1","avatar_url":"https://avatars.githubusercontent.com/u/31469905?v=4","gravatar_id":"","url":"https://api.github.com/users/yabola","html_url":"https://github.com/yabola","followers_url":"https://api.github.com/users/yabola/followers","following_url":"https://api.github.com/users/yabola/following{/other_user}","gists_url":"https://api.github.com/users/yabola/gists{/gist_id}","starred_url":"https://api.github.com/users/yabola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yabola/subscriptions","organizations_url":"https://api.github.com/users/yabola/orgs","repos_url":"https://api.github.com/users/yabola/repos","events_url":"https://api.github.com/users/yabola/events{/privacy}","received_events_url":"https://api.github.com/users/yabola/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-13T03:58:57Z","updated_at":"2022-08-13T03:58:57Z","author_association":"CONTRIBUTOR","body":"@huaxingao Do you start doing this, can I get involved? I'm learning about this part recently~","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213646911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213746367","html_url":"https://github.com/apache/iceberg/issues/5273#issuecomment-1213746367","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5273","id":1213746367,"node_id":"IC_kwDOCW7NX85IWEy_","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-13T05:35:52Z","updated_at":"2022-08-13T05:35:52Z","author_association":"CONTRIBUTOR","body":"@yabola I have finished implementing this. I have split the implementation into two PRs so it's easier to review. The first PR is [here](https://github.com/apache/iceberg/pull/5302). Please help to review if you have time. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213746367/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213833114","html_url":"https://github.com/apache/iceberg/pull/5380#issuecomment-1213833114","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5380","id":1213833114,"node_id":"IC_kwDOCW7NX85IWZ-a","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-13T06:35:22Z","updated_at":"2022-08-13T06:35:22Z","author_association":"CONTRIBUTOR","body":"I added upsert to the sql and stream sections respectively and modified according to the comments. @stevenzwu \r\nthx.\r\n\r\n  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1213833114/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1214223712","html_url":"https://github.com/apache/iceberg/pull/5417#issuecomment-1214223712","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5417","id":1214223712,"node_id":"IC_kwDOCW7NX85IX5Vg","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-13T21:17:15Z","updated_at":"2022-08-13T21:17:15Z","author_association":"CONTRIBUTOR","body":"Added a gazillion tests, hopefully, this will bump it up to 90%+.\r\n\r\nFor the json API, we could also return only pydantic models, and we get an open-api for free from that :) Might be a bit too much for this stage, but I would like to share the idea to see what others think.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1214223712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1214250361","html_url":"https://github.com/apache/iceberg/issues/4093#issuecomment-1214250361","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4093","id":1214250361,"node_id":"IC_kwDOCW7NX85IX_15","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-08-14T00:12:43Z","updated_at":"2022-08-14T00:12:43Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1214250361/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1214282438","html_url":"https://github.com/apache/iceberg/pull/5472#issuecomment-1214282438","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5472","id":1214282438,"node_id":"IC_kwDOCW7NX85IYHrG","user":{"login":"dependabot[bot]","id":49699333,"node_id":"MDM6Qm90NDk2OTkzMzM=","avatar_url":"https://avatars.githubusercontent.com/in/29110?v=4","gravatar_id":"","url":"https://api.github.com/users/dependabot%5Bbot%5D","html_url":"https://github.com/apps/dependabot","followers_url":"https://api.github.com/users/dependabot%5Bbot%5D/followers","following_url":"https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dependabot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/dependabot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/dependabot%5Bbot%5D/repos","events_url":"https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/dependabot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-08-14T04:21:48Z","updated_at":"2022-08-14T04:21:48Z","author_association":"CONTRIBUTOR","body":"Superseded by #5521.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1214282438/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1214416602","html_url":"https://github.com/apache/iceberg/pull/5501#issuecomment-1214416602","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5501","id":1214416602,"node_id":"IC_kwDOCW7NX85IYoba","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-14T17:08:27Z","updated_at":"2022-08-14T17:08:27Z","author_association":"CONTRIBUTOR","body":"Thanks, @hililiwei!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1214416602/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1214416731","html_url":"https://github.com/apache/iceberg/pull/5503#issuecomment-1214416731","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5503","id":1214416731,"node_id":"IC_kwDOCW7NX85IYodb","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-14T17:09:16Z","updated_at":"2022-08-14T17:09:16Z","author_association":"CONTRIBUTOR","body":"@hililiwei, looks like this had conflicts. Can you fix them?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1214416731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1214416980","html_url":"https://github.com/apache/iceberg/pull/5514#issuecomment-1214416980","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5514","id":1214416980,"node_id":"IC_kwDOCW7NX85IYohU","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-14T17:11:02Z","updated_at":"2022-08-14T17:11:02Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1214416980/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1214417098","html_url":"https://github.com/apache/iceberg/pull/5521#issuecomment-1214417098","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5521","id":1214417098,"node_id":"IC_kwDOCW7NX85IYojK","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-14T17:11:56Z","updated_at":"2022-08-14T17:11:56Z","author_association":"CONTRIBUTOR","body":"Thanks, @dependabot!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1214417098/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1214417161","html_url":"https://github.com/apache/iceberg/pull/5522#issuecomment-1214417161","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5522","id":1214417161,"node_id":"IC_kwDOCW7NX85IYokJ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-14T17:12:18Z","updated_at":"2022-08-14T17:12:18Z","author_association":"CONTRIBUTOR","body":"Thanks, @dependabot!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1214417161/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1214418013","html_url":"https://github.com/apache/iceberg/pull/5516#issuecomment-1214418013","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5516","id":1214418013,"node_id":"IC_kwDOCW7NX85IYoxd","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-14T17:18:21Z","updated_at":"2022-08-14T17:18:21Z","author_association":"CONTRIBUTOR","body":"@jackye1995, @amogh-jahagirdar, is this a good idea? I'm skeptical. If the aim is to have Redshift support, then I think Redshift should implement a way to call one of the APIs that can perform job planning instead.\r\n\r\nI find it unlikely that readers that do not support Iceberg tables will be able to read the files correctly and apply the schema evolution rules. I don't like the idea of making it easy for external systems to claim to support Iceberg tables via some export mechanism like this, but then give incorrect results because they're just reading Parquet files.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1214418013/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1214419724","html_url":"https://github.com/apache/iceberg/pull/5374#issuecomment-1214419724","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5374","id":1214419724,"node_id":"IC_kwDOCW7NX85IYpMM","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-14T17:31:18Z","updated_at":"2022-08-14T17:31:18Z","author_association":"CONTRIBUTOR","body":"Thanks, @nastra!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1214419724/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]