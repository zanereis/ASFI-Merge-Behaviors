[{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/968455092","html_url":"https://github.com/apache/incubator-heron/pull/3725#issuecomment-968455092","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3725","id":968455092,"node_id":"IC_kwDOApKMps45uXO0","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-15T02:12:01Z","updated_at":"2021-11-15T02:12:01Z","author_association":"MEMBER","body":"I am going to go ahead and reintroduce the mounts and volumes for shared PVCs at which point I shall consider this PR completed. As careful as I have been, and as extensive as the test suite is, 1000+ lines of code introduce a lot of moving parts that could go wrong.\r\n\r\n> If there is a better suggestion for the CLI parameters, I'm cool with that.\r\n\r\nIndividual volumes: `heron.kubernetes.volumes.persistentVolumeClaim.volumeNameOfChoice.`\r\nShared volumes: `heron.kubernetes.volumes.persistentVolumeClaim.shared.volumeNameOfChoice.`\r\n\r\nBut that is an issue for another time.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/968455092/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/968455432","html_url":"https://github.com/apache/incubator-heron/pull/3735#issuecomment-968455432","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3735","id":968455432,"node_id":"IC_kwDOApKMps45uXUI","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-15T02:12:47Z","updated_at":"2021-11-15T02:12:47Z","author_association":"MEMBER","body":"@thinker0 thank you for your help with the PEX issue 😄 ","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/968455432/reactions","total_count":4,"+1":1,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":2,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/968457771","html_url":"https://github.com/apache/incubator-heron/issues/3724#issuecomment-968457771","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3724","id":968457771,"node_id":"IC_kwDOApKMps45uX4r","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-15T02:18:25Z","updated_at":"2021-11-15T02:19:24Z","author_association":"MEMBER","body":"That would be greatly appreciated, thank you.\r\n\r\nBefore work begins on this we need milestones to mark the completion of PRs. This will need to be multiple PRs.\r\n\r\n**_PR1: Decouple the `manager` Pod._**\r\n* Duplicate of the `executor` pods.\r\n* Configure the `executor` and `manager` Pods using the dynamic `shard_id`. \r\n* Ability to set limits on resources for the `manager` using CLI arguments.\r\n* Configure the `Service` to allow communication.\r\n\r\nThis is a big change and I will be limited in what I can programmatically test. The testing framework has limitations at its current version.\r\n\r\n**_PR2: Pod Templates._**\r\n* Individual Pod Templates for the `executor` and `manager`.\r\n","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/968457771/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/969020688","html_url":"https://github.com/apache/incubator-heron/pull/3735#issuecomment-969020688","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3735","id":969020688,"node_id":"IC_kwDOApKMps45whUQ","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-15T15:24:54Z","updated_at":"2021-11-15T15:24:54Z","author_association":"MEMBER","body":"Thank you @nicknezis! 😄 ","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/969020688/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/969374524","html_url":"https://github.com/apache/incubator-heron/pull/3725#issuecomment-969374524","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3725","id":969374524,"node_id":"IC_kwDOApKMps45x3s8","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-15T22:17:20Z","updated_at":"2021-11-15T22:22:29Z","author_association":"MEMBER","body":"I added support for shared `Volume`s via a `claimName` but have not had the chance to complete a full battery of deployment tests.\r\n\r\nA Claim name of `OnDemand` will result in PVCs being created. Any other Claim name will only add `Volume`s to the Pod Spec and `Volume Mounts` to the `Executor` Pod and will be replicated between all Pods in the topology.\r\n\r\nDocumentation is [here](https://github.com/apache/incubator-heron/blob/6a449b178f892f1bd109ba28ead228abc5a52613/website2/docs/schedulers-k8s-persistent-volume-claims.md).\r\n\r\nI think we may be able to whittle down the permissions for the PVC to:\r\n\r\n```yaml\r\nrules:\r\n- apiGroups: \r\n - \"\"\r\n resources: \r\n - persistentvolumeclaims\r\n verbs: \r\n - create\r\n - deletecollection\r\n```","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/969374524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/971215972","html_url":"https://github.com/apache/incubator-heron/pull/3738#issuecomment-971215972","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3738","id":971215972,"node_id":"IC_kwDOApKMps4545Rk","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T05:58:53Z","updated_at":"2021-11-17T05:58:53Z","author_association":"CONTRIBUTOR","body":"Closing because we merged #3739 ","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/971215972/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/971908485","html_url":"https://github.com/apache/incubator-heron/issues/3724#issuecomment-971908485","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3724","id":971908485,"node_id":"IC_kwDOApKMps457iWF","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-17T19:35:05Z","updated_at":"2021-11-18T21:17:29Z","author_association":"MEMBER","body":"I have a plan in place to begin the first PR (Phase 1) once I know the PVC PR is stable.\r\n\r\n* Executor containers will retain the name `executor`.\r\n* Manager containers will have the name set to `manager`.\r\n* Commands to set CPU limit: `heron.kubernetes.manager.limit.cpu` and RAM limit: `heron.kubernetes.manager.limit.memory`.\r\n* `StatefulSet` for both will be duplicated.\r\n* `executor` container boot argument will have `shard_id` in the range `[1 - n)`.\r\n* `manager` container boot argument will have `shard_id` set to `0`.\r\n* Create a `Service` with a single open TCP/IP port to facilitate communication. `Selector` set to match `Labels` for `topology` and `app`. Generate a re-creatable name using the `topology` name.\r\n* `Selector` `matchLabels` for all toplogies `StatefulSet`s and `Service` set to `topology` and `app`.\r\n* Remove both `StatefulSet`s using the [`deleteCollectionNamespacedStatefulSet`](https://javadoc.io/static/io.kubernetes/client-java-api/11.0.0/io/kubernetes/client/openapi/apis/AppsV1Api.html#deleteCollectionNamespacedStatefulSet-java.lang.String-java.lang.String-java.lang.String-java.lang.String-java.lang.String-java.lang.Integer-java.lang.String-java.lang.Integer-java.lang.Boolean-java.lang.String-java.lang.String-java.lang.String-java.lang.Integer-io.kubernetes.client.openapi.models.V1DeleteOptions-) with the `topology` and `apps` `Labels`.\r\n* Remove the `Service` with [`deleteNamespacedService`](https://javadoc.io/static/io.kubernetes/client-java-api/11.0.0/io/kubernetes/client/openapi/apis/CoreV1Api.html#deleteNamespacedService-java.lang.String-java.lang.String-java.lang.String-java.lang.String-java.lang.Integer-java.lang.Boolean-java.lang.String-io.kubernetes.client.openapi.models.V1DeleteOptions-).\r\n\r\nI think that should cover everything required to perform a basic decoupling of the `manager` and `executor` pods. We should also visit whether each `executor` container needs to have debugging ports to the tune of the number of Pods in the topology.\r\n\r\nOn the topic of creating a `Service`, I am wondering if we cannot just use the one which is already created for the topology:\r\nhttps://github.com/apache/incubator-heron/blob/6b883bec716df6c58b86a5e3f12970ab4e72c1c6/heron/schedulers/src/java/org/apache/heron/scheduler/kubernetes/V1Controller.java#L124-L131\r\n\r\nhttps://github.com/apache/incubator-heron/blob/6b883bec716df6c58b86a5e3f12970ab4e72c1c6/heron/schedulers/src/java/org/apache/heron/scheduler/kubernetes/V1Controller.java#L349-L369","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/971908485/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/973107376","html_url":"https://github.com/apache/incubator-heron/pull/3725#issuecomment-973107376","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3725","id":973107376,"node_id":"IC_kwDOApKMps46AHCw","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-18T17:43:18Z","updated_at":"2021-11-18T17:43:18Z","author_association":"MEMBER","body":"I ran some quick tests before I begin separating the `executor`s and the `manager` and everything looks good. `YAML` for each case is below, I can confirm that a shared volume will not add a PVC.\r\n\r\n<details><summary>Shared StatefulSet</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2021-11-18T17:23:24Z\"\r\n  generation: 1\r\n  name: acking\r\n  namespace: default\r\n  resourceVersion: \"2717\"\r\n  uid: f4e9b2a9-f880-4b80-bd15-7cd54cdd23fb\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 3\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0-160636999515090835.tar.gz\r\n          . && SHARD_ID=${POD_NAME##*-} && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=ackingcf66189f-ca7f-46a3-a0a9-cb41a5d658c4\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        - name: var_one\r\n          value: variable one\r\n        - name: var_three\r\n          value: variable three\r\n        - name: var_two\r\n          value: variable two\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: executor\r\n        ports:\r\n        - containerPort: 5555\r\n          name: tcp-port-kept\r\n          protocol: TCP\r\n        - containerPort: 5556\r\n          name: udp-port-kept\r\n          protocol: UDP\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        resources:\r\n          limits:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n          requests:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n        securityContext:\r\n          allowPrivilegeEscalation: false\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: /shared_volume\r\n          name: shared-volume\r\n        - mountPath: path/to/mount\r\n          name: volumenameofchoice\r\n          subPath: sub/path/to/mount\r\n      - image: alpine\r\n        imagePullPolicy: Always\r\n        name: sidecar-container\r\n        resources: {}\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: /shared_volume\r\n          name: shared-volume\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      volumes:\r\n      - emptyDir: {}\r\n        name: shared-volume\r\n      - name: volumenameofchoice\r\n        persistentVolumeClaim:\r\n          claimName: requested-claim-by-user\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\nstatus:\r\n  collisionCount: 0\r\n  currentReplicas: 3\r\n  currentRevision: acking-76494fb95\r\n  observedGeneration: 1\r\n  replicas: 3\r\n  updateRevision: acking-76494fb95\r\n  updatedReplicas: 3\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Shared Pod</summary>\r\n\r\n```yaml\r\napiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  annotations:\r\n    prometheus.io/port: \"8080\"\r\n    prometheus.io/scrape: \"true\"\r\n  creationTimestamp: \"2021-11-18T17:23:24Z\"\r\n  generateName: acking-\r\n  labels:\r\n    app: heron\r\n    controller-revision-hash: acking-76494fb95\r\n    statefulset.kubernetes.io/pod-name: acking-1\r\n    topology: acking\r\n  name: acking-1\r\n  namespace: default\r\n  ownerReferences:\r\n  - apiVersion: apps/v1\r\n    blockOwnerDeletion: true\r\n    controller: true\r\n    kind: StatefulSet\r\n    name: acking\r\n    uid: f4e9b2a9-f880-4b80-bd15-7cd54cdd23fb\r\n  resourceVersion: \"2718\"\r\n  uid: 0e28c20c-e3aa-4f36-a2dd-da063147f5c0\r\nspec:\r\n  containers:\r\n  - command:\r\n    - sh\r\n    - -c\r\n    - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n      distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0-160636999515090835.tar.gz\r\n      . && SHARD_ID=${POD_NAME##*-} && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n      --topology-name=acking --topology-id=ackingcf66189f-ca7f-46a3-a0a9-cb41a5d658c4\r\n      --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181 --state-manager-root=/heron\r\n      --state-manager-config-file=./heron-conf/statemgr.yaml --tmanager-binary=./heron-core/bin/heron-tmanager\r\n      --stmgr-binary=./heron-core/bin/heron-stmgr --metrics-manager-classpath=./heron-core/lib/metricsmgr/*\r\n      --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\" --classpath=heron-api-examples.jar\r\n      --heron-internals-config-file=./heron-conf/heron_internals.yaml --override-config-file=./heron-conf/override.yaml\r\n      --component-ram-map=exclaim1:1073741824,word:1073741824 --component-jvm-opts=\"\"\r\n      --pkg-type=jar --topology-binary-file=heron-api-examples.jar --heron-java-home=$JAVA_HOME\r\n      --heron-shell-binary=./heron-core/bin/heron-shell --cluster=kubernetes --role=saad\r\n      --environment=default --instance-classpath=./heron-core/lib/instance/* --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml\r\n      --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n      --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n      --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n      --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n      --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n      --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n      --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n      --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n      --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n    env:\r\n    - name: HOST\r\n      valueFrom:\r\n        fieldRef:\r\n          apiVersion: v1\r\n          fieldPath: status.podIP\r\n    - name: POD_NAME\r\n      valueFrom:\r\n        fieldRef:\r\n          apiVersion: v1\r\n          fieldPath: metadata.name\r\n    - name: var_one\r\n      value: variable one\r\n    - name: var_three\r\n      value: variable three\r\n    - name: var_two\r\n      value: variable two\r\n    image: apache/heron:testbuild\r\n    imagePullPolicy: IfNotPresent\r\n    name: executor\r\n    ports:\r\n    - containerPort: 5555\r\n      name: tcp-port-kept\r\n      protocol: TCP\r\n    - containerPort: 5556\r\n      name: udp-port-kept\r\n      protocol: UDP\r\n    - containerPort: 6001\r\n      name: server\r\n      protocol: TCP\r\n    - containerPort: 6002\r\n      name: tmanager-ctl\r\n      protocol: TCP\r\n    - containerPort: 6003\r\n      name: tmanager-stats\r\n      protocol: TCP\r\n    - containerPort: 6004\r\n      name: shell-port\r\n      protocol: TCP\r\n    - containerPort: 6005\r\n      name: metrics-mgr\r\n      protocol: TCP\r\n    - containerPort: 6006\r\n      name: scheduler\r\n      protocol: TCP\r\n    - containerPort: 6007\r\n      name: metrics-cache-m\r\n      protocol: TCP\r\n    - containerPort: 6008\r\n      name: metrics-cache-s\r\n      protocol: TCP\r\n    - containerPort: 6009\r\n      name: ckptmgr\r\n      protocol: TCP\r\n    resources:\r\n      limits:\r\n        cpu: \"3\"\r\n        memory: 4Gi\r\n      requests:\r\n        cpu: \"3\"\r\n        memory: 4Gi\r\n    securityContext:\r\n      allowPrivilegeEscalation: false\r\n    terminationMessagePath: /dev/termination-log\r\n    terminationMessagePolicy: File\r\n    volumeMounts:\r\n    - mountPath: /shared_volume\r\n      name: shared-volume\r\n    - mountPath: path/to/mount\r\n      name: volumenameofchoice\r\n      subPath: sub/path/to/mount\r\n    - mountPath: /var/run/secrets/kubernetes.io/serviceaccount\r\n      name: kube-api-access-8pmpr\r\n      readOnly: true\r\n  - image: alpine\r\n    imagePullPolicy: Always\r\n    name: sidecar-container\r\n    resources: {}\r\n    terminationMessagePath: /dev/termination-log\r\n    terminationMessagePolicy: File\r\n    volumeMounts:\r\n    - mountPath: /shared_volume\r\n      name: shared-volume\r\n    - mountPath: /var/run/secrets/kubernetes.io/serviceaccount\r\n      name: kube-api-access-8pmpr\r\n      readOnly: true\r\n  dnsPolicy: ClusterFirst\r\n  enableServiceLinks: true\r\n  hostname: acking-1\r\n  preemptionPolicy: PreemptLowerPriority\r\n  priority: 0\r\n  restartPolicy: Always\r\n  schedulerName: default-scheduler\r\n  securityContext: {}\r\n  serviceAccount: default\r\n  serviceAccountName: default\r\n  subdomain: acking\r\n  terminationGracePeriodSeconds: 0\r\n  tolerations:\r\n  - effect: NoExecute\r\n    key: node.kubernetes.io/not-ready\r\n    operator: Exists\r\n    tolerationSeconds: 10\r\n  - effect: NoExecute\r\n    key: node.kubernetes.io/unreachable\r\n    operator: Exists\r\n    tolerationSeconds: 10\r\n  volumes:\r\n  - emptyDir: {}\r\n    name: shared-volume\r\n  - name: volumenameofchoice\r\n    persistentVolumeClaim:\r\n      claimName: requested-claim-by-user\r\n  - name: kube-api-access-8pmpr\r\n    projected:\r\n      defaultMode: 420\r\n      sources:\r\n      - serviceAccountToken:\r\n          expirationSeconds: 3607\r\n          path: token\r\n      - configMap:\r\n          items:\r\n          - key: ca.crt\r\n            path: ca.crt\r\n          name: kube-root-ca.crt\r\n      - downwardAPI:\r\n          items:\r\n          - fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.namespace\r\n            path: namespace\r\nstatus:\r\n  conditions:\r\n  - lastProbeTime: null\r\n    lastTransitionTime: \"2021-11-18T17:23:24Z\"\r\n    message: '0/1 nodes are available: 1 persistentvolumeclaim \"requested-claim-by-user\"\r\n      not found.'\r\n    reason: Unschedulable\r\n    status: \"False\"\r\n    type: PodScheduled\r\n  phase: Pending\r\n  qosClass: Burstable\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Static StatefulSet</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2021-11-18T17:12:52Z\"\r\n  generation: 1\r\n  name: acking\r\n  namespace: default\r\n  resourceVersion: \"2061\"\r\n  uid: 54337851-2bc2-4cf3-bf66-d9e8a5716aa2\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 3\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0--1619810271492859618.tar.gz\r\n          . && SHARD_ID=${POD_NAME##*-} && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=acking87b0a985-49ec-4749-aa2d-d7f4aaa736a4\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        - name: var_one\r\n          value: variable one\r\n        - name: var_three\r\n          value: variable three\r\n        - name: var_two\r\n          value: variable two\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: executor\r\n        ports:\r\n        - containerPort: 5555\r\n          name: tcp-port-kept\r\n          protocol: TCP\r\n        - containerPort: 5556\r\n          name: udp-port-kept\r\n          protocol: UDP\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        resources:\r\n          limits:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n          requests:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n        securityContext:\r\n          allowPrivilegeEscalation: false\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: /shared_volume\r\n          name: shared-volume\r\n        - mountPath: path/to/mount\r\n          name: volumenameofchoice\r\n          subPath: sub/path/to/mount\r\n      - image: alpine\r\n        imagePullPolicy: Always\r\n        name: sidecar-container\r\n        resources: {}\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: /shared_volume\r\n          name: shared-volume\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      volumes:\r\n      - emptyDir: {}\r\n        name: shared-volume\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\n  volumeClaimTemplates:\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: volumenameofchoice\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 555Gi\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\nstatus:\r\n  collisionCount: 0\r\n  currentReplicas: 3\r\n  currentRevision: acking-6c4c987ddc\r\n  observedGeneration: 1\r\n  replicas: 3\r\n  updateRevision: acking-6c4c987ddc\r\n  updatedReplicas: 3\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Static Pod</summary>\r\n\r\n```yaml\r\napiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  annotations:\r\n    prometheus.io/port: \"8080\"\r\n    prometheus.io/scrape: \"true\"\r\n  creationTimestamp: \"2021-11-18T17:12:52Z\"\r\n  generateName: acking-\r\n  labels:\r\n    app: heron\r\n    controller-revision-hash: acking-6c4c987ddc\r\n    statefulset.kubernetes.io/pod-name: acking-1\r\n    topology: acking\r\n  name: acking-1\r\n  namespace: default\r\n  ownerReferences:\r\n  - apiVersion: apps/v1\r\n    blockOwnerDeletion: true\r\n    controller: true\r\n    kind: StatefulSet\r\n    name: acking\r\n    uid: 54337851-2bc2-4cf3-bf66-d9e8a5716aa2\r\n  resourceVersion: \"2051\"\r\n  uid: 027fff42-3f1e-4457-a3f8-6505b256f3af\r\nspec:\r\n  containers:\r\n  - command:\r\n    - sh\r\n    - -c\r\n    - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n      distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0--1619810271492859618.tar.gz\r\n      . && SHARD_ID=${POD_NAME##*-} && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n      --topology-name=acking --topology-id=acking87b0a985-49ec-4749-aa2d-d7f4aaa736a4\r\n      --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181 --state-manager-root=/heron\r\n      --state-manager-config-file=./heron-conf/statemgr.yaml --tmanager-binary=./heron-core/bin/heron-tmanager\r\n      --stmgr-binary=./heron-core/bin/heron-stmgr --metrics-manager-classpath=./heron-core/lib/metricsmgr/*\r\n      --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\" --classpath=heron-api-examples.jar\r\n      --heron-internals-config-file=./heron-conf/heron_internals.yaml --override-config-file=./heron-conf/override.yaml\r\n      --component-ram-map=exclaim1:1073741824,word:1073741824 --component-jvm-opts=\"\"\r\n      --pkg-type=jar --topology-binary-file=heron-api-examples.jar --heron-java-home=$JAVA_HOME\r\n      --heron-shell-binary=./heron-core/bin/heron-shell --cluster=kubernetes --role=saad\r\n      --environment=default --instance-classpath=./heron-core/lib/instance/* --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml\r\n      --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n      --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n      --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n      --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n      --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n      --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n      --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n      --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n      --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n    env:\r\n    - name: HOST\r\n      valueFrom:\r\n        fieldRef:\r\n          apiVersion: v1\r\n          fieldPath: status.podIP\r\n    - name: POD_NAME\r\n      valueFrom:\r\n        fieldRef:\r\n          apiVersion: v1\r\n          fieldPath: metadata.name\r\n    - name: var_one\r\n      value: variable one\r\n    - name: var_three\r\n      value: variable three\r\n    - name: var_two\r\n      value: variable two\r\n    image: apache/heron:testbuild\r\n    imagePullPolicy: IfNotPresent\r\n    name: executor\r\n    ports:\r\n    - containerPort: 5555\r\n      name: tcp-port-kept\r\n      protocol: TCP\r\n    - containerPort: 5556\r\n      name: udp-port-kept\r\n      protocol: UDP\r\n    - containerPort: 6001\r\n      name: server\r\n      protocol: TCP\r\n    - containerPort: 6002\r\n      name: tmanager-ctl\r\n      protocol: TCP\r\n    - containerPort: 6003\r\n      name: tmanager-stats\r\n      protocol: TCP\r\n    - containerPort: 6004\r\n      name: shell-port\r\n      protocol: TCP\r\n    - containerPort: 6005\r\n      name: metrics-mgr\r\n      protocol: TCP\r\n    - containerPort: 6006\r\n      name: scheduler\r\n      protocol: TCP\r\n    - containerPort: 6007\r\n      name: metrics-cache-m\r\n      protocol: TCP\r\n    - containerPort: 6008\r\n      name: metrics-cache-s\r\n      protocol: TCP\r\n    - containerPort: 6009\r\n      name: ckptmgr\r\n      protocol: TCP\r\n    resources:\r\n      limits:\r\n        cpu: \"3\"\r\n        memory: 4Gi\r\n      requests:\r\n        cpu: \"3\"\r\n        memory: 4Gi\r\n    securityContext:\r\n      allowPrivilegeEscalation: false\r\n    terminationMessagePath: /dev/termination-log\r\n    terminationMessagePolicy: File\r\n    volumeMounts:\r\n    - mountPath: /shared_volume\r\n      name: shared-volume\r\n    - mountPath: path/to/mount\r\n      name: volumenameofchoice\r\n      subPath: sub/path/to/mount\r\n    - mountPath: /var/run/secrets/kubernetes.io/serviceaccount\r\n      name: kube-api-access-txlbw\r\n      readOnly: true\r\n  - image: alpine\r\n    imagePullPolicy: Always\r\n    name: sidecar-container\r\n    resources: {}\r\n    terminationMessagePath: /dev/termination-log\r\n    terminationMessagePolicy: File\r\n    volumeMounts:\r\n    - mountPath: /shared_volume\r\n      name: shared-volume\r\n    - mountPath: /var/run/secrets/kubernetes.io/serviceaccount\r\n      name: kube-api-access-txlbw\r\n      readOnly: true\r\n  dnsPolicy: ClusterFirst\r\n  enableServiceLinks: true\r\n  hostname: acking-1\r\n  preemptionPolicy: PreemptLowerPriority\r\n  priority: 0\r\n  restartPolicy: Always\r\n  schedulerName: default-scheduler\r\n  securityContext: {}\r\n  serviceAccount: default\r\n  serviceAccountName: default\r\n  subdomain: acking\r\n  terminationGracePeriodSeconds: 0\r\n  tolerations:\r\n  - effect: NoExecute\r\n    key: node.kubernetes.io/not-ready\r\n    operator: Exists\r\n    tolerationSeconds: 10\r\n  - effect: NoExecute\r\n    key: node.kubernetes.io/unreachable\r\n    operator: Exists\r\n    tolerationSeconds: 10\r\n  volumes:\r\n  - name: volumenameofchoice\r\n    persistentVolumeClaim:\r\n      claimName: volumenameofchoice-acking-1\r\n  - emptyDir: {}\r\n    name: shared-volume\r\n  - name: kube-api-access-txlbw\r\n    projected:\r\n      defaultMode: 420\r\n      sources:\r\n      - serviceAccountToken:\r\n          expirationSeconds: 3607\r\n          path: token\r\n      - configMap:\r\n          items:\r\n          - key: ca.crt\r\n            path: ca.crt\r\n          name: kube-root-ca.crt\r\n      - downwardAPI:\r\n          items:\r\n          - fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.namespace\r\n            path: namespace\r\nstatus:\r\n  conditions:\r\n  - lastProbeTime: null\r\n    lastTransitionTime: \"2021-11-18T17:12:52Z\"\r\n    message: '0/1 nodes are available: 1 pod has unbound immediate PersistentVolumeClaims.'\r\n    reason: Unschedulable\r\n    status: \"False\"\r\n    type: PodScheduled\r\n  phase: Pending\r\n  qosClass: Burstable\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Static PVC</summary>\r\n\r\n```yaml\r\napiVersion: v1\r\nkind: PersistentVolumeClaim\r\nmetadata:\r\n  annotations:\r\n    volume.beta.kubernetes.io/storage-provisioner: k8s.io/minikube-hostpath\r\n  creationTimestamp: \"2021-11-18T17:12:52Z\"\r\n  finalizers:\r\n  - kubernetes.io/pvc-protection\r\n  labels:\r\n    app: heron\r\n    onDemand: \"true\"\r\n    topology: acking\r\n  name: volumenameofchoice-acking-1\r\n  namespace: default\r\n  resourceVersion: \"2047\"\r\n  uid: 50a226ac-d7cb-44b9-8d55-8ecc9bf8796d\r\nspec:\r\n  accessModes:\r\n  - ReadWriteOnce\r\n  - ReadOnlyMany\r\n  resources:\r\n    requests:\r\n      storage: 555Gi\r\n  storageClassName: standard\r\n  volumeMode: Block\r\nstatus:\r\n  phase: Pending\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Dynamic StatefulSet</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2021-11-18T17:17:59Z\"\r\n  generation: 1\r\n  name: acking\r\n  namespace: default\r\n  resourceVersion: \"2412\"\r\n  uid: 4263ad61-4d70-4803-9664-5e1cc04c174e\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 3\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0--8727299585809965289.tar.gz\r\n          . && SHARD_ID=${POD_NAME##*-} && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=ackinge77c4afd-1609-4616-8344-a3474f0cd2ba\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        - name: var_one\r\n          value: variable one\r\n        - name: var_three\r\n          value: variable three\r\n        - name: var_two\r\n          value: variable two\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: executor\r\n        ports:\r\n        - containerPort: 5555\r\n          name: tcp-port-kept\r\n          protocol: TCP\r\n        - containerPort: 5556\r\n          name: udp-port-kept\r\n          protocol: UDP\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        resources:\r\n          limits:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n          requests:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n        securityContext:\r\n          allowPrivilegeEscalation: false\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: /shared_volume\r\n          name: shared-volume\r\n        - mountPath: path/to/mount\r\n          name: volumenameofchoice\r\n          subPath: sub/path/to/mount\r\n      - image: alpine\r\n        imagePullPolicy: Always\r\n        name: sidecar-container\r\n        resources: {}\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: /shared_volume\r\n          name: shared-volume\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      volumes:\r\n      - emptyDir: {}\r\n        name: shared-volume\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\n  volumeClaimTemplates:\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: volumenameofchoice\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 555Gi\r\n      storageClassName: storage-class-name\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\nstatus:\r\n  collisionCount: 0\r\n  currentReplicas: 3\r\n  currentRevision: acking-7bfcb94659\r\n  observedGeneration: 1\r\n  replicas: 3\r\n  updateRevision: acking-7bfcb94659\r\n  updatedReplicas: 3\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Dynamic Pod</summary>\r\n\r\n```yaml\r\napiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  annotations:\r\n    prometheus.io/port: \"8080\"\r\n    prometheus.io/scrape: \"true\"\r\n  creationTimestamp: \"2021-11-18T17:17:59Z\"\r\n  generateName: acking-\r\n  labels:\r\n    app: heron\r\n    controller-revision-hash: acking-7bfcb94659\r\n    statefulset.kubernetes.io/pod-name: acking-1\r\n    topology: acking\r\n  name: acking-1\r\n  namespace: default\r\n  ownerReferences:\r\n  - apiVersion: apps/v1\r\n    blockOwnerDeletion: true\r\n    controller: true\r\n    kind: StatefulSet\r\n    name: acking\r\n    uid: 4263ad61-4d70-4803-9664-5e1cc04c174e\r\n  resourceVersion: \"2406\"\r\n  uid: 807570fd-1a38-4a5a-bb5e-cb5fe13acecc\r\nspec:\r\n  containers:\r\n  - command:\r\n    - sh\r\n    - -c\r\n    - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n      distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0--8727299585809965289.tar.gz\r\n      . && SHARD_ID=${POD_NAME##*-} && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n      --topology-name=acking --topology-id=ackinge77c4afd-1609-4616-8344-a3474f0cd2ba\r\n      --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181 --state-manager-root=/heron\r\n      --state-manager-config-file=./heron-conf/statemgr.yaml --tmanager-binary=./heron-core/bin/heron-tmanager\r\n      --stmgr-binary=./heron-core/bin/heron-stmgr --metrics-manager-classpath=./heron-core/lib/metricsmgr/*\r\n      --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\" --classpath=heron-api-examples.jar\r\n      --heron-internals-config-file=./heron-conf/heron_internals.yaml --override-config-file=./heron-conf/override.yaml\r\n      --component-ram-map=exclaim1:1073741824,word:1073741824 --component-jvm-opts=\"\"\r\n      --pkg-type=jar --topology-binary-file=heron-api-examples.jar --heron-java-home=$JAVA_HOME\r\n      --heron-shell-binary=./heron-core/bin/heron-shell --cluster=kubernetes --role=saad\r\n      --environment=default --instance-classpath=./heron-core/lib/instance/* --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml\r\n      --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n      --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n      --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n      --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n      --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n      --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n      --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n      --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n      --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n    env:\r\n    - name: HOST\r\n      valueFrom:\r\n        fieldRef:\r\n          apiVersion: v1\r\n          fieldPath: status.podIP\r\n    - name: POD_NAME\r\n      valueFrom:\r\n        fieldRef:\r\n          apiVersion: v1\r\n          fieldPath: metadata.name\r\n    - name: var_one\r\n      value: variable one\r\n    - name: var_three\r\n      value: variable three\r\n    - name: var_two\r\n      value: variable two\r\n    image: apache/heron:testbuild\r\n    imagePullPolicy: IfNotPresent\r\n    name: executor\r\n    ports:\r\n    - containerPort: 5555\r\n      name: tcp-port-kept\r\n      protocol: TCP\r\n    - containerPort: 5556\r\n      name: udp-port-kept\r\n      protocol: UDP\r\n    - containerPort: 6001\r\n      name: server\r\n      protocol: TCP\r\n    - containerPort: 6002\r\n      name: tmanager-ctl\r\n      protocol: TCP\r\n    - containerPort: 6003\r\n      name: tmanager-stats\r\n      protocol: TCP\r\n    - containerPort: 6004\r\n      name: shell-port\r\n      protocol: TCP\r\n    - containerPort: 6005\r\n      name: metrics-mgr\r\n      protocol: TCP\r\n    - containerPort: 6006\r\n      name: scheduler\r\n      protocol: TCP\r\n    - containerPort: 6007\r\n      name: metrics-cache-m\r\n      protocol: TCP\r\n    - containerPort: 6008\r\n      name: metrics-cache-s\r\n      protocol: TCP\r\n    - containerPort: 6009\r\n      name: ckptmgr\r\n      protocol: TCP\r\n    resources:\r\n      limits:\r\n        cpu: \"3\"\r\n        memory: 4Gi\r\n      requests:\r\n        cpu: \"3\"\r\n        memory: 4Gi\r\n    securityContext:\r\n      allowPrivilegeEscalation: false\r\n    terminationMessagePath: /dev/termination-log\r\n    terminationMessagePolicy: File\r\n    volumeMounts:\r\n    - mountPath: /shared_volume\r\n      name: shared-volume\r\n    - mountPath: path/to/mount\r\n      name: volumenameofchoice\r\n      subPath: sub/path/to/mount\r\n    - mountPath: /var/run/secrets/kubernetes.io/serviceaccount\r\n      name: kube-api-access-wl7h4\r\n      readOnly: true\r\n  - image: alpine\r\n    imagePullPolicy: Always\r\n    name: sidecar-container\r\n    resources: {}\r\n    terminationMessagePath: /dev/termination-log\r\n    terminationMessagePolicy: File\r\n    volumeMounts:\r\n    - mountPath: /shared_volume\r\n      name: shared-volume\r\n    - mountPath: /var/run/secrets/kubernetes.io/serviceaccount\r\n      name: kube-api-access-wl7h4\r\n      readOnly: true\r\n  dnsPolicy: ClusterFirst\r\n  enableServiceLinks: true\r\n  hostname: acking-1\r\n  preemptionPolicy: PreemptLowerPriority\r\n  priority: 0\r\n  restartPolicy: Always\r\n  schedulerName: default-scheduler\r\n  securityContext: {}\r\n  serviceAccount: default\r\n  serviceAccountName: default\r\n  subdomain: acking\r\n  terminationGracePeriodSeconds: 0\r\n  tolerations:\r\n  - effect: NoExecute\r\n    key: node.kubernetes.io/not-ready\r\n    operator: Exists\r\n    tolerationSeconds: 10\r\n  - effect: NoExecute\r\n    key: node.kubernetes.io/unreachable\r\n    operator: Exists\r\n    tolerationSeconds: 10\r\n  volumes:\r\n  - name: volumenameofchoice\r\n    persistentVolumeClaim:\r\n      claimName: volumenameofchoice-acking-1\r\n  - emptyDir: {}\r\n    name: shared-volume\r\n  - name: kube-api-access-wl7h4\r\n    projected:\r\n      defaultMode: 420\r\n      sources:\r\n      - serviceAccountToken:\r\n          expirationSeconds: 3607\r\n          path: token\r\n      - configMap:\r\n          items:\r\n          - key: ca.crt\r\n            path: ca.crt\r\n          name: kube-root-ca.crt\r\n      - downwardAPI:\r\n          items:\r\n          - fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.namespace\r\n            path: namespace\r\nstatus:\r\n  conditions:\r\n  - lastProbeTime: null\r\n    lastTransitionTime: \"2021-11-18T17:17:59Z\"\r\n    message: '0/1 nodes are available: 1 pod has unbound immediate PersistentVolumeClaims.'\r\n    reason: Unschedulable\r\n    status: \"False\"\r\n    type: PodScheduled\r\n  phase: Pending\r\n  qosClass: Burstable\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Dynamic PVC</summary>\r\n\r\n```yaml\r\napiVersion: v1\r\nkind: PersistentVolumeClaim\r\nmetadata:\r\n  creationTimestamp: \"2021-11-18T17:17:59Z\"\r\n  finalizers:\r\n  - kubernetes.io/pvc-protection\r\n  labels:\r\n    app: heron\r\n    onDemand: \"true\"\r\n    topology: acking\r\n  name: volumenameofchoice-acking-1\r\n  namespace: default\r\n  resourceVersion: \"2395\"\r\n  uid: 65a9291e-ea83-41bb-a1ce-56d76574f0f3\r\nspec:\r\n  accessModes:\r\n  - ReadWriteOnce\r\n  - ReadOnlyMany\r\n  resources:\r\n    requests:\r\n      storage: 555Gi\r\n  storageClassName: storage-class-name\r\n  volumeMode: Block\r\nstatus:\r\n  phase: Pending\r\n```\r\n\r\n</details>","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/973107376/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/974374152","html_url":"https://github.com/apache/incubator-heron/issues/3724#issuecomment-974374152","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3724","id":974374152,"node_id":"IC_kwDOApKMps46E8UI","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-19T19:48:30Z","updated_at":"2021-11-19T22:07:04Z","author_association":"MEMBER","body":"I have a draft ready and I am starting to test functionality.\r\n\r\nWe need to consider how to handle `removeContainers` and `patchStatefulSetReplicas`. For now, I have set this up so that only the `executor` StatefulSet is affected by calls to said methods.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/974374152/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/974535877","html_url":"https://github.com/apache/incubator-heron/pull/3740#issuecomment-974535877","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3740","id":974535877,"node_id":"IC_kwDOApKMps46FjzF","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-19T23:22:24Z","updated_at":"2021-11-19T23:22:24Z","author_association":"MEMBER","body":"I forgot the Helm chart permissions:\r\n\r\n```yaml\r\n- apiGroups:\r\n  - \"\"\r\n  resources:\r\n  - pods\r\n  verbs:\r\n  - deletecollection\r\n```","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/974535877/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/974547209","html_url":"https://github.com/apache/incubator-heron/issues/3724#issuecomment-974547209","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3724","id":974547209,"node_id":"IC_kwDOApKMps46FmkJ","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-19T23:57:42Z","updated_at":"2021-11-20T01:48:37Z","author_association":"MEMBER","body":"I think I have completed as much testing as I can to ensure this works. Here are the `StatefulSet`s for the Acking topology which consists of two `executor` Pods and one `manager` Pod. I can create a PR whenever but please keep in mind that this builds upon the [PVC PR](https://github.com/apache/incubator-heron/pull/3725).\r\n\r\n<details><summary>Manager</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2021-11-20T01:42:05Z\"\r\n  generation: 1\r\n  labels:\r\n    app: heron\r\n    topology: acking\r\n  name: acking-manager\r\n  namespace: default\r\n  resourceVersion: \"2025\"\r\n  uid: 5ef9c462-ff79-4158-b140-69b08b422022\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 1\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0-4160434986555391542.tar.gz\r\n          . && SHARD_ID=${POD_NAME##*-} && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=ackingf19a4c65-41f7-4062-b37a-3394ad4746eb\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        - name: var_one\r\n          value: variable one\r\n        - name: var_three\r\n          value: variable three\r\n        - name: var_two\r\n          value: variable two\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: manager\r\n        ports:\r\n        - containerPort: 5555\r\n          name: tcp-port-kept\r\n          protocol: TCP\r\n        - containerPort: 5556\r\n          name: udp-port-kept\r\n          protocol: UDP\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        resources:\r\n          limits:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n        securityContext:\r\n          allowPrivilegeEscalation: false\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: /shared_volume\r\n          name: shared-volume\r\n      - image: alpine\r\n        imagePullPolicy: Always\r\n        name: sidecar-container\r\n        resources: {}\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: /shared_volume\r\n          name: shared-volume\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      volumes:\r\n      - emptyDir: {}\r\n        name: shared-volume\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\nstatus:\r\n  collisionCount: 0\r\n  currentReplicas: 1\r\n  currentRevision: acking-manager-97d4f5696\r\n  observedGeneration: 1\r\n  replicas: 1\r\n  updateRevision: acking-manager-97d4f5696\r\n  updatedReplicas: 1\r\n```\r\n\r\n</details>\r\n<details><summary>Executors</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2021-11-20T01:42:05Z\"\r\n  generation: 1\r\n  labels:\r\n    app: heron\r\n    topology: acking\r\n  name: acking-executors\r\n  namespace: default\r\n  resourceVersion: \"2022\"\r\n  uid: 9d4aeb12-231f-4887-94ba-37d4e39f2c30\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 2\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0-4160434986555391542.tar.gz\r\n          . && SHARD_ID=$((${POD_NAME##*-} + 1)) && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=ackingf19a4c65-41f7-4062-b37a-3394ad4746eb\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        - name: var_one\r\n          value: variable one\r\n        - name: var_three\r\n          value: variable three\r\n        - name: var_two\r\n          value: variable two\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: executor\r\n        ports:\r\n        - containerPort: 5555\r\n          name: tcp-port-kept\r\n          protocol: TCP\r\n        - containerPort: 5556\r\n          name: udp-port-kept\r\n          protocol: UDP\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        resources:\r\n          limits:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n          requests:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n        securityContext:\r\n          allowPrivilegeEscalation: false\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: /shared_volume\r\n          name: shared-volume\r\n      - image: alpine\r\n        imagePullPolicy: Always\r\n        name: sidecar-container\r\n        resources: {}\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: /shared_volume\r\n          name: shared-volume\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      volumes:\r\n      - emptyDir: {}\r\n        name: shared-volume\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\nstatus:\r\n  collisionCount: 0\r\n  currentReplicas: 2\r\n  currentRevision: acking-executors-8484b87fc8\r\n  observedGeneration: 1\r\n  replicas: 2\r\n  updateRevision: acking-executors-8484b87fc8\r\n  updatedReplicas: 2\r\n```\r\n\r\n</details>","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/974547209/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/974581923","html_url":"https://github.com/apache/incubator-heron/pull/3740#issuecomment-974581923","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3740","id":974581923,"node_id":"IC_kwDOApKMps46FvCj","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-20T02:57:39Z","updated_at":"2021-11-20T02:57:39Z","author_association":"MEMBER","body":"@nicknezis thank you!","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/974581923/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/974696234","html_url":"https://github.com/apache/incubator-heron/issues/3724#issuecomment-974696234","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3724","id":974696234,"node_id":"IC_kwDOApKMps46GK8q","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-20T19:00:29Z","updated_at":"2021-11-20T19:00:29Z","author_association":"MEMBER","body":"The CLI commands to configure the `Manager` limits:\r\n\r\n```bash\r\n--config-property heron.kubernetes.manager.limits.cpu=[NATURAL NUMBER VALUE]\r\n--config-property heron.kubernetes.manager.limits.memory=[NATURAL NUMBER VALUE]\r\n```\r\n\r\nSample commands for submitting:\r\n\r\n```bash\r\n~/bin/heron submit kubernetes ~/.heron/examples/heron-api-examples.jar \\\r\n--verbose \\\r\n--config-property heron.kubernetes.manager.limits.cpu=1 \\\r\n--config-property heron.kubernetes.manager.limits.memory=2 \\\r\norg.apache.heron.examples.api.AckingTopology acking\r\n```\r\n\r\nI am not able to connect to the Heron UI when running in Minikube but that has always been the case for me. I can confirm that the topology is executing using CPU and Memory graph traces.\r\n\r\n<details><summary>Manager StatefulSet</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2021-11-20T17:58:18Z\"\r\n  generation: 1\r\n  labels:\r\n    app: heron\r\n    topology: acking\r\n  name: acking-manager\r\n  namespace: default\r\n  resourceVersion: \"1756\"\r\n  uid: 2a5d6ba3-d31f-4e36-997b-984545f7a3a7\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 1\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0--7278444175656031685.tar.gz\r\n          . && SHARD_ID=${POD_NAME##*-} && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=acking17797dee-b1f1-4afa-8018-0054ffb2f988\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: manager\r\n        ports:\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        resources:\r\n          limits:\r\n            cpu: \"1\"\r\n            memory: 2Gi\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\nstatus:\r\n  availableReplicas: 1\r\n  collisionCount: 0\r\n  currentReplicas: 1\r\n  currentRevision: acking-manager-7ff7f4fb89\r\n  observedGeneration: 1\r\n  readyReplicas: 1\r\n  replicas: 1\r\n  updateRevision: acking-manager-7ff7f4fb89\r\n  updatedReplicas: 1\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Executors StatefulSet</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2021-11-20T17:58:18Z\"\r\n  generation: 1\r\n  labels:\r\n    app: heron\r\n    topology: acking\r\n  name: acking-executors\r\n  namespace: default\r\n  resourceVersion: \"1752\"\r\n  uid: d8c9d174-5feb-49a5-9297-c84b41b750c0\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 2\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0--7278444175656031685.tar.gz\r\n          . && SHARD_ID=$((${POD_NAME##*-} + 1)) && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=acking17797dee-b1f1-4afa-8018-0054ffb2f988\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: executor\r\n        ports:\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        resources:\r\n          limits:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n          requests:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\nstatus:\r\n  availableReplicas: 2\r\n  collisionCount: 0\r\n  currentReplicas: 2\r\n  currentRevision: acking-executors-77ffc94579\r\n  observedGeneration: 1\r\n  readyReplicas: 2\r\n  replicas: 2\r\n  updateRevision: acking-executors-77ffc94579\r\n  updatedReplicas: 2\r\n```\r\n\r\n</details>\r\n","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/974696234/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/974721926","html_url":"https://github.com/apache/incubator-heron/issues/3724#issuecomment-974721926","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3724","id":974721926,"node_id":"IC_kwDOApKMps46GROG","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-20T22:44:02Z","updated_at":"2021-11-20T22:44:02Z","author_association":"CONTRIBUTOR","body":"This looks great. Did we need to make two services? Or did the single\nheadless service match on the pods from both StatefulSet instances?\n\nShould we also allow for setting both the request and limit values for\nmanager cpu and memory?\n\nFor the newly updated Helm chart, you should be able to configure the UI\nservice to expose a NodePort (ui.nodeport.enabled). With that, you should\nbe able to run the \"minikube services\" command to list and easily view.\n(Sorry I don't remember the specifics of that command, but it is a\nconvenience that minikube provides).\n\nOn Sat, Nov 20, 2021 at 2:00 PM Saad Ur Rahman ***@***.***>\nwrote:\n\n> The CLI commands to configure the Manager limits:\n>\n> --config-property heron.kubernetes.manager.limits.cpu=[NATURAL NUMBER VALUE]\n> --config-property heron.kubernetes.manager.limits.memory=[NATURAL NUMBER VALUE]\n>\n> Sample commands for submitting:\n>\n> ~/bin/heron submit kubernetes ~/.heron/examples/heron-api-examples.jar \\\n> --verbose \\\n> --config-property heron.kubernetes.manager.limits.cpu=1 \\\n> --config-property heron.kubernetes.manager.limits.memory=2 \\\n> org.apache.heron.examples.api.AckingTopology acking\n>\n> I am not able to connect to the Heron UI when running in Minikube but that\n> has always been the case for me. I can confirm that the topology is\n> executing using CPU and Memory graph traces.\n> Manager StatefulSet\n>\n> apiVersion: apps/v1kind: StatefulSetmetadata:\n>   creationTimestamp: \"2021-11-20T17:58:18Z\"\n>   generation: 1\n>   labels:\n>     app: heron\n>     topology: acking\n>   name: acking-manager\n>   namespace: default\n>   resourceVersion: \"1756\"\n>   uid: 2a5d6ba3-d31f-4e36-997b-984545f7a3a7spec:\n>   podManagementPolicy: Parallel\n>   replicas: 1\n>   revisionHistoryLimit: 10\n>   selector:\n>     matchLabels:\n>       app: heron\n>       topology: acking\n>   serviceName: acking\n>   template:\n>     metadata:\n>       annotations:\n>         prometheus.io/port: \"8080\"\n>         prometheus.io/scrape: \"true\"\n>       creationTimestamp: null\n>       labels:\n>         app: heron\n>         topology: acking\n>     spec:\n>       containers:\n>       - command:\n>         - sh\n>         - -c\n>         - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0--7278444175656031685.tar.gz          . && SHARD_ID=${POD_NAME##*-} && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor          --topology-name=acking --topology-id=acking17797dee-b1f1-4afa-8018-0054ffb2f988          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\n>         env:\n>         - name: HOST\n>           valueFrom:\n>             fieldRef:\n>               apiVersion: v1\n>               fieldPath: status.podIP\n>         - name: POD_NAME\n>           valueFrom:\n>             fieldRef:\n>               apiVersion: v1\n>               fieldPath: metadata.name\n>         image: apache/heron:testbuild\n>         imagePullPolicy: IfNotPresent\n>         name: manager\n>         ports:\n>         - containerPort: 6001\n>           name: server\n>           protocol: TCP\n>         - containerPort: 6004\n>           name: shell-port\n>           protocol: TCP\n>         - containerPort: 6002\n>           name: tmanager-ctl\n>           protocol: TCP\n>         - containerPort: 6005\n>           name: metrics-mgr\n>           protocol: TCP\n>         - containerPort: 6009\n>           name: ckptmgr\n>           protocol: TCP\n>         - containerPort: 6007\n>           name: metrics-cache-m\n>           protocol: TCP\n>         - containerPort: 6003\n>           name: tmanager-stats\n>           protocol: TCP\n>         - containerPort: 6008\n>           name: metrics-cache-s\n>           protocol: TCP\n>         - containerPort: 6006\n>           name: scheduler\n>           protocol: TCP\n>         resources:\n>           limits:\n>             cpu: \"1\"\n>             memory: 2Gi\n>         terminationMessagePath: /dev/termination-log\n>         terminationMessagePolicy: File\n>       dnsPolicy: ClusterFirst\n>       restartPolicy: Always\n>       schedulerName: default-scheduler\n>       securityContext: {}\n>       terminationGracePeriodSeconds: 0\n>       tolerations:\n>       - effect: NoExecute\n>         key: node.kubernetes.io/not-ready\n>         operator: Exists\n>         tolerationSeconds: 10\n>       - effect: NoExecute\n>         key: node.kubernetes.io/unreachable\n>         operator: Exists\n>         tolerationSeconds: 10\n>   updateStrategy:\n>     rollingUpdate:\n>       partition: 0\n>     type: RollingUpdatestatus:\n>   availableReplicas: 1\n>   collisionCount: 0\n>   currentReplicas: 1\n>   currentRevision: acking-manager-7ff7f4fb89\n>   observedGeneration: 1\n>   readyReplicas: 1\n>   replicas: 1\n>   updateRevision: acking-manager-7ff7f4fb89\n>   updatedReplicas: 1\n>\n> Executors StatefulSet\n>\n> apiVersion: apps/v1kind: StatefulSetmetadata:\n>   creationTimestamp: \"2021-11-20T17:58:18Z\"\n>   generation: 1\n>   labels:\n>     app: heron\n>     topology: acking\n>   name: acking-executors\n>   namespace: default\n>   resourceVersion: \"1752\"\n>   uid: d8c9d174-5feb-49a5-9297-c84b41b750c0spec:\n>   podManagementPolicy: Parallel\n>   replicas: 2\n>   revisionHistoryLimit: 10\n>   selector:\n>     matchLabels:\n>       app: heron\n>       topology: acking\n>   serviceName: acking\n>   template:\n>     metadata:\n>       annotations:\n>         prometheus.io/port: \"8080\"\n>         prometheus.io/scrape: \"true\"\n>       creationTimestamp: null\n>       labels:\n>         app: heron\n>         topology: acking\n>     spec:\n>       containers:\n>       - command:\n>         - sh\n>         - -c\n>         - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0--7278444175656031685.tar.gz          . && SHARD_ID=$((${POD_NAME##*-} + 1)) && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor          --topology-name=acking --topology-id=acking17797dee-b1f1-4afa-8018-0054ffb2f988          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\n>         env:\n>         - name: HOST\n>           valueFrom:\n>             fieldRef:\n>               apiVersion: v1\n>               fieldPath: status.podIP\n>         - name: POD_NAME\n>           valueFrom:\n>             fieldRef:\n>               apiVersion: v1\n>               fieldPath: metadata.name\n>         image: apache/heron:testbuild\n>         imagePullPolicy: IfNotPresent\n>         name: executor\n>         ports:\n>         - containerPort: 6001\n>           name: server\n>           protocol: TCP\n>         - containerPort: 6004\n>           name: shell-port\n>           protocol: TCP\n>         - containerPort: 6002\n>           name: tmanager-ctl\n>           protocol: TCP\n>         - containerPort: 6005\n>           name: metrics-mgr\n>           protocol: TCP\n>         - containerPort: 6009\n>           name: ckptmgr\n>           protocol: TCP\n>         - containerPort: 6007\n>           name: metrics-cache-m\n>           protocol: TCP\n>         - containerPort: 6003\n>           name: tmanager-stats\n>           protocol: TCP\n>         - containerPort: 6008\n>           name: metrics-cache-s\n>           protocol: TCP\n>         - containerPort: 6006\n>           name: scheduler\n>           protocol: TCP\n>         resources:\n>           limits:\n>             cpu: \"3\"\n>             memory: 4Gi\n>           requests:\n>             cpu: \"3\"\n>             memory: 4Gi\n>         terminationMessagePath: /dev/termination-log\n>         terminationMessagePolicy: File\n>       dnsPolicy: ClusterFirst\n>       restartPolicy: Always\n>       schedulerName: default-scheduler\n>       securityContext: {}\n>       terminationGracePeriodSeconds: 0\n>       tolerations:\n>       - effect: NoExecute\n>         key: node.kubernetes.io/not-ready\n>         operator: Exists\n>         tolerationSeconds: 10\n>       - effect: NoExecute\n>         key: node.kubernetes.io/unreachable\n>         operator: Exists\n>         tolerationSeconds: 10\n>   updateStrategy:\n>     rollingUpdate:\n>       partition: 0\n>     type: RollingUpdatestatus:\n>   availableReplicas: 2\n>   collisionCount: 0\n>   currentReplicas: 2\n>   currentRevision: acking-executors-77ffc94579\n>   observedGeneration: 1\n>   readyReplicas: 2\n>   replicas: 2\n>   updateRevision: acking-executors-77ffc94579\n>   updatedReplicas: 2\n>\n> —\n> You are receiving this because you were assigned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/incubator-heron/issues/3724#issuecomment-974696234>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AABMNKST27UOGZ4W6QDL33LUM7V5RANCNFSM5GVRYL7Q>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/974721926/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/974885085","html_url":"https://github.com/apache/incubator-heron/issues/3724#issuecomment-974885085","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3724","id":974885085,"node_id":"IC_kwDOApKMps46G5Dd","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-21T19:59:19Z","updated_at":"2021-11-21T19:59:19Z","author_association":"MEMBER","body":"> This looks great. Did we need to make two services? Or did the single headless service match on the pods from both StatefulSet instances?\r\n\r\nI used just the single `Service` to match the Pods and I am trying to check on the topology to make sure it is actually working correctly. I will try to bring up the Minikube deployments using the Helm chart to check and make sure. Thank you for the information on bringing up the UI.\r\n\r\n> Should we also allow for setting both the request and limit values for manager cpu and memory?\r\n\r\nDone. I will configure `requests` to be set to `limits` if there are `limits` provided but no `requests`.\r\n\r\n```bash\r\n~/bin/heron submit kubernetes ~/.heron/examples/heron-api-examples.jar \\\r\n--verbose \\\r\n--deploy-deactivated \\\r\n--config-property heron.kubernetes.manager.limits.cpu=2 \\\r\n--config-property heron.kubernetes.manager.limits.memory=3 \\\r\n--config-property heron.kubernetes.manager.requests.cpu=1 \\\r\n--config-property heron.kubernetes.manager.requests.memory=2 \\\r\norg.apache.heron.examples.api.AckingTopology acking\r\n```\r\n\r\n<details><summary>Manager StatefulSet</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2021-11-21T19:51:50Z\"\r\n  generation: 1\r\n  labels:\r\n    app: heron\r\n    topology: acking\r\n  name: acking-manager\r\n  namespace: default\r\n  resourceVersion: \"1192\"\r\n  uid: 4f346b90-719a-4c96-a67a-8ee933638d28\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 1\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0--5496391603497457682.tar.gz\r\n          . && SHARD_ID=${POD_NAME##*-} && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=ackingf5b54bfc-9115-4150-8862-d0c80a4aa2a8\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: manager\r\n        ports:\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        resources:\r\n          limits:\r\n            cpu: \"2\"\r\n            memory: 3Gi\r\n          requests:\r\n            cpu: \"1\"\r\n            memory: 2Gi\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\nstatus:\r\n  availableReplicas: 1\r\n  collisionCount: 0\r\n  currentReplicas: 1\r\n  currentRevision: acking-manager-6bc666844\r\n  observedGeneration: 1\r\n  readyReplicas: 1\r\n  replicas: 1\r\n  updateRevision: acking-manager-6bc666844\r\n  updatedReplicas: 1\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Executor StatefulSet</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2021-11-21T19:49:29Z\"\r\n  generation: 1\r\n  labels:\r\n    app: heron\r\n    topology: acking\r\n  name: acking-executors\r\n  namespace: default\r\n  resourceVersion: \"1025\"\r\n  uid: 207b9720-ef1a-4ff5-a4e8-c01e2b2ba64e\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 2\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0--4304060467542714147.tar.gz\r\n          . && SHARD_ID=$((${POD_NAME##*-} + 1)) && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=acking63f7d62f-cf31-4b03-82be-837041ba5f03\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: executor\r\n        ports:\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        resources:\r\n          limits:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n          requests:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\nstatus:\r\n  collisionCount: 0\r\n  currentReplicas: 2\r\n  currentRevision: acking-executors-6986669454\r\n  observedGeneration: 1\r\n  replicas: 2\r\n  updateRevision: acking-executors-6986669454\r\n  updatedReplicas: 2\r\n```\r\n\r\n</details>\r\n","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/974885085/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/975850895","html_url":"https://github.com/apache/incubator-heron/pull/3725#issuecomment-975850895","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3725","id":975850895,"node_id":"IC_kwDOApKMps46Kk2P","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-22T19:29:58Z","updated_at":"2021-11-22T19:29:58Z","author_association":"MEMBER","body":"Updated [documentation](https://github.com/apache/incubator-heron/blob/c4736cf0dd550fd3f373b397b935f3679fc62413/website2/docs/schedulers-k8s-persistent-volume-claims.md).","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/975850895/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/976946382","html_url":"https://github.com/apache/incubator-heron/pull/3725#issuecomment-976946382","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3725","id":976946382,"node_id":"IC_kwDOApKMps46OwTO","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-23T18:00:26Z","updated_at":"2021-11-23T18:00:26Z","author_association":"MEMBER","body":"I have completed my final review of this PR and it is now completed on my end (functionality, documentation, and testing). It is now awaiting review, testing, and merging.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/976946382/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/979433327","html_url":"https://github.com/apache/incubator-heron/issues/3724#issuecomment-979433327","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3724","id":979433327,"node_id":"IC_kwDOApKMps46YPdv","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-25T19:19:12Z","updated_at":"2021-11-25T21:36:37Z","author_association":"MEMBER","body":"**_PR (Phase 2): Add Individual Pod Template Support._**\r\n\r\n* Load Pod Templates via `heron.kubernetes.[executor | manager].pod.template=[ConfigMap].[Pod Template]`\r\n* Configure Persistent Volumes via `heron.kubernetes.[executor | manager].volumes.persistentVolumeClaim.[Volume Name].[Option]=[Value]`\r\n* Configure resources for the `manager` via `heron.kubernetes.manager.[limits | requests].[Option]=[Value]`\r\n\r\nI have a plan drawn out on paper. Most of the core methods within the `V1Controller` will remain mostly unchanged and will be reused between both the `manager` and `executor` Pods. This PR will mostly be rewiring the logic, writing tests, and improving the architecture.\r\n\r\nThis will make the previous Pod Template and Persistent Volume Claim PR documentations obsolete. It will combine a lot of changes and contributions from multiple PRs.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/979433327/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/981114818","html_url":"https://github.com/apache/incubator-heron/pull/3725#issuecomment-981114818","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3725","id":981114818,"node_id":"IC_kwDOApKMps46ep_C","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-28T16:37:08Z","updated_at":"2021-11-28T16:37:08Z","author_association":"MEMBER","body":"> What is the difference between \"dynamic\" and \"static\"? Is it merely the presence of the storage class name?\r\n\r\nCorrect, they only differ in their `Storage Class` name, please see [Provisioning](https://kubernetes.io/docs/concepts/storage/persistent-volumes/#provisioning) for Persistent Volumes.\r\n\r\n> Is there any difference with relating to the deletion of the PVCs when the job is killed?\r\n\r\nHeron will remove _all_ PVCs it adds for a topology using selector labels irrespective.\r\n\r\n> Perhaps they both are the same use case and should just be the \"dynamic\" (i.e. `OnDemand`) mode?\r\n\r\nCorrect, you caught a number of typos/stale command examples in the documentation. Claims for both dynamic and static Persistent Volumes is triggered using the Claim Name of `OnDemand`.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/981114818/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/981192284","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-981192284","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":981192284,"node_id":"IC_kwDOApKMps46e85c","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T00:29:26Z","updated_at":"2021-11-29T00:29:26Z","author_association":"MEMBER","body":"**_Phase 2_**\r\n\r\n- [x] Load Pod Templates via `heron.kubernetes.[executor | manager].pod.template=[ConfigMap].[Pod Template]`\r\n- [ ] Configure Persistent Volumes via `heron.kubernetes.[executor | manager].volumes.persistentVolumeClaim.[Volume Name].[Option]=[Value]`\r\n- [ ] Configure resources for the `manager` via `heron.kubernetes.manager.[limits | requests].[Option]=[Value]`\r\n\r\nIndividual Pod Template loading for the `Executor`s and `Manager` is now complete. Please note that the commands have changed to load Pod Templates and that the old Pod Template docs are now mostly obsolete. On the TODO list is individual PVC and resource CLI commands.\r\n\r\nCommands:\r\n\r\n```yaml\r\n~/bin/heron submit kubernetes ~/.heron/examples/heron-api-examples.jar \\\r\norg.apache.heron.examples.api.AckingTopology acking \\\r\n--verbose \\\r\n--deploy-deactivated \\\r\n--config-property heron.kubernetes.executor.pod.template=pod-templ-executor.pod-template-executor.yaml \\\r\n--config-property heron.kubernetes.manager.pod.template=pod-templ-manager.pod-template-manager.yaml \\\r\n--config-property heron.kubernetes.manager.limits.cpu=2 \\\r\n--config-property heron.kubernetes.manager.limits.memory=3 \\\r\n--config-property heron.kubernetes.manager.requests.cpu=1 \\\r\n--config-property heron.kubernetes.manager.requests.memory=2 \\\r\n--config-property heron.kubernetes.volumes.persistentVolumeClaim.dynamicvolume.claimName=OnDemand \\\r\n--config-property heron.kubernetes.volumes.persistentVolumeClaim.dynamicvolume.accessModes=ReadWriteOnce,ReadOnlyMany \\\r\n--config-property heron.kubernetes.volumes.persistentVolumeClaim.dynamicvolume.sizeLimit=256Gi \\\r\n--config-property heron.kubernetes.volumes.persistentVolumeClaim.dynamicvolume.volumeMode=Block \\\r\n--config-property heron.kubernetes.volumes.persistentVolumeClaim.dynamicvolume.path=path/to/mount/dynamic/volume \\\r\n--config-property heron.kubernetes.volumes.persistentVolumeClaim.dynamicvolume.subPath=sub/path/to/mount/dynamic/volume \\\r\n--config-property heron.kubernetes.volumes.persistentVolumeClaim.staticvolume.claimName=OnDemand \\\r\n--config-property heron.kubernetes.volumes.persistentVolumeClaim.staticvolume.storageClassName=storage-class-name \\\r\n--config-property heron.kubernetes.volumes.persistentVolumeClaim.staticvolume.accessModes=ReadWriteOnce,ReadOnlyMany \\\r\n--config-property heron.kubernetes.volumes.persistentVolumeClaim.staticvolume.sizeLimit=512Gi \\\r\n--config-property heron.kubernetes.volumes.persistentVolumeClaim.staticvolume.volumeMode=Block \\\r\n--config-property heron.kubernetes.volumes.persistentVolumeClaim.staticvolume.path=path/to/mount/static/volume \\\r\n--config-property heron.kubernetes.volumes.persistentVolumeClaim.staticvolume.subPath=sub/path/to/mount/static/volume \\\r\n--config-property heron.kubernetes.volumes.persistentVolumeClaim.sharedvolume.claimName=requested-claim-by-user \\\r\n--config-property heron.kubernetes.volumes.persistentVolumeClaim.sharedvolume.path=path/to/mount/shared/volume \\\r\n--config-property heron.kubernetes.volumes.persistentVolumeClaim.sharedvolume.subPath=sub/path/to/mount/shared/volume\r\n```\r\n\r\n<details><summary>Executor StatefulSet</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2021-11-29T00:14:41Z\"\r\n  generation: 1\r\n  labels:\r\n    app: heron\r\n    topology: acking\r\n  name: acking-executors\r\n  namespace: default\r\n  resourceVersion: \"2512\"\r\n  uid: f4aa0815-256d-4c73-8ce7-68ff0bb26597\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 2\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0-7629098208556017113.tar.gz\r\n          . && SHARD_ID=$((${POD_NAME##*-} + 1)) && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=acking6e4ded2b-ee0a-40ac-90ad-8780645bda9a\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        - name: var_one\r\n          value: variable one\r\n        - name: var_three\r\n          value: variable three\r\n        - name: var_two\r\n          value: variable two\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: executor\r\n        ports:\r\n        - containerPort: 5555\r\n          name: tcp-port-kept\r\n          protocol: TCP\r\n        - containerPort: 5556\r\n          name: udp-port-kept\r\n          protocol: UDP\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        resources:\r\n          limits:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n          requests:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n        securityContext:\r\n          allowPrivilegeEscalation: false\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: path/to/mount/dynamic/volume\r\n          name: dynamicvolume\r\n          subPath: sub/path/to/mount/dynamic/volume\r\n        - mountPath: /shared_volume\r\n          name: shared-volume\r\n        - mountPath: path/to/mount/shared/volume\r\n          name: sharedvolume\r\n          subPath: sub/path/to/mount/shared/volume\r\n        - mountPath: path/to/mount/static/volume\r\n          name: staticvolume\r\n          subPath: sub/path/to/mount/static/volume\r\n      - image: alpine\r\n        imagePullPolicy: Always\r\n        name: sidecar-container\r\n        resources: {}\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: /shared_volume\r\n          name: shared-volume\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      volumes:\r\n      - emptyDir: {}\r\n        name: shared-volume\r\n      - name: sharedvolume\r\n        persistentVolumeClaim:\r\n          claimName: requested-claim-by-user\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\n  volumeClaimTemplates:\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: dynamicvolume\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 256Gi\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: staticvolume\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 512Gi\r\n      storageClassName: storage-class-name\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\nstatus:\r\n  collisionCount: 0\r\n  currentReplicas: 2\r\n  currentRevision: acking-executors-bc4fd98c4\r\n  observedGeneration: 1\r\n  replicas: 2\r\n  updateRevision: acking-executors-bc4fd98c4\r\n  updatedReplicas: 2\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Manager StatefulSet</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2021-11-29T00:14:41Z\"\r\n  generation: 1\r\n  labels:\r\n    app: heron\r\n    topology: acking\r\n  name: acking-manager\r\n  namespace: default\r\n  resourceVersion: \"2513\"\r\n  uid: 4e8e0e7a-8d20-4a1f-8cac-db9319af1cec\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 1\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0-7629098208556017113.tar.gz\r\n          . && SHARD_ID=${POD_NAME##*-} && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=acking6e4ded2b-ee0a-40ac-90ad-8780645bda9a\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        - name: var_one_manager\r\n          value: variable one on manager\r\n        - name: var_three_manager\r\n          value: variable three on manager\r\n        - name: var_two_manager\r\n          value: variable two on manager\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: manager\r\n        ports:\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        - containerPort: 7775\r\n          name: tcp-port-kept\r\n          protocol: TCP\r\n        - containerPort: 7776\r\n          name: udp-port-kept\r\n          protocol: UDP\r\n        resources:\r\n          limits:\r\n            cpu: \"2\"\r\n            memory: 3Gi\r\n          requests:\r\n            cpu: \"1\"\r\n            memory: 2Gi\r\n        securityContext:\r\n          allowPrivilegeEscalation: false\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: path/to/mount/dynamic/volume\r\n          name: dynamicvolume\r\n          subPath: sub/path/to/mount/dynamic/volume\r\n        - mountPath: /shared_volume/manager\r\n          name: shared-volume-manager\r\n        - mountPath: path/to/mount/shared/volume\r\n          name: sharedvolume\r\n          subPath: sub/path/to/mount/shared/volume\r\n        - mountPath: path/to/mount/static/volume\r\n          name: staticvolume\r\n          subPath: sub/path/to/mount/static/volume\r\n      - image: alpine\r\n        imagePullPolicy: Always\r\n        name: manager-sidecar-container\r\n        resources: {}\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: /shared_volume/manager\r\n          name: shared-volume-manager\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      volumes:\r\n      - emptyDir: {}\r\n        name: shared-volume-manager\r\n      - name: sharedvolume\r\n        persistentVolumeClaim:\r\n          claimName: requested-claim-by-user\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\n  volumeClaimTemplates:\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: dynamicvolume\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 256Gi\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: staticvolume\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 512Gi\r\n      storageClassName: storage-class-name\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\nstatus:\r\n  collisionCount: 0\r\n  currentReplicas: 1\r\n  currentRevision: acking-manager-677c8b875b\r\n  observedGeneration: 1\r\n  replicas: 1\r\n  updateRevision: acking-manager-677c8b875b\r\n  updatedReplicas: 1\r\n```\r\n\r\n</details>","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/981192284/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/982156778","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-982156778","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":982156778,"node_id":"IC_kwDOApKMps46ioXq","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-30T00:21:20Z","updated_at":"2021-12-01T03:49:24Z","author_association":"MEMBER","body":"**_Phase 2_**\r\n\r\n- [x] Load Pod Templates via `heron.kubernetes.[executor | manager].pod.template=[ConfigMap].[Pod Template]`\r\n- [x] Configure Persistent Volumes via `heron.kubernetes.[executor | manager].volumes.persistentVolumeClaim.[Volume Name].[Option]=[Value]`\r\n- [x] Configure resources for the `manager` and/or `executor` via `heron.kubernetes.[executor | manager].[limits | requests].[Option]=[Value]`\r\n\r\nPlease note that the commands have changed to load Pod Templates and PVCs and as such the docs are now mostly obsolete.\r\n\r\nCommands:\r\n\r\n```yaml\r\n~/bin/heron submit kubernetes ~/.heron/examples/heron-api-examples.jar \\\r\norg.apache.heron.examples.api.AckingTopology acking \\\r\n--verbose \\\r\n--deploy-deactivated \\\r\n--config-property heron.kubernetes.executor.pod.template=pod-templ-executor.pod-template-executor.yaml \\\r\n--config-property heron.kubernetes.manager.pod.template=pod-templ-manager.pod-template-manager.yaml \\\r\n--config-property heron.kubernetes.manager.limits.cpu=2 \\\r\n--config-property heron.kubernetes.manager.limits.memory=3 \\\r\n--config-property heron.kubernetes.manager.requests.cpu=1 \\\r\n--config-property heron.kubernetes.manager.requests.memory=2 \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.claimName=OnDemand \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.accessModes=ReadWriteOnce,ReadOnlyMany \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.sizeLimit=256Gi \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.volumeMode=Block \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.path=path/to/mount/dynamic/volume \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.subPath=sub/path/to/mount/dynamic/volume \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.claimName=OnDemand \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.storageClassName=storage-class-name \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.accessModes=ReadWriteOnce,ReadOnlyMany \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.sizeLimit=512Gi \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.volumeMode=Block \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.path=path/to/mount/static/volume \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.subPath=sub/path/to/mount/static/volume \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-shared-volume.claimName=requested-claim-by-user \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-shared-volume.path=path/to/mount/shared/volume \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-shared-volume.subPath=sub/path/to/mount/shared/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.claimName=OnDemand \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.accessModes=ReadWriteOnce,ReadOnlyMany \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.sizeLimit=256Gi \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.volumeMode=Block \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.path=path/to/mount/dynamic/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.subPath=sub/path/to/mount/dynamic/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.claimName=OnDemand \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.storageClassName=storage-class-name \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.accessModes=ReadWriteOnce,ReadOnlyMany \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.sizeLimit=512Gi \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.volumeMode=Block \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.path=path/to/mount/static/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.subPath=sub/path/to/mount/static/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-shared-volume.claimName=requested-claim-by-user \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-shared-volume.path=path/to/mount/shared/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-shared-volume.subPath=sub/path/to/mount/shared/volume\r\n```\r\n\r\n<details><summary>Executor StatefulSet</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2021-11-30T00:08:01Z\"\r\n  generation: 1\r\n  labels:\r\n    app: heron\r\n    topology: acking\r\n  name: acking-executors\r\n  namespace: default\r\n  resourceVersion: \"1650\"\r\n  uid: 24e8e2fc-fc33-4189-996c-dce430bcc68f\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 2\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0--1632273069134658892.tar.gz\r\n          . && SHARD_ID=$((${POD_NAME##*-} + 1)) && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=acking60a8ecb7-e031-4afc-9bff-8a18703aef3a\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        - name: var_one\r\n          value: variable one\r\n        - name: var_three\r\n          value: variable three\r\n        - name: var_two\r\n          value: variable two\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: executor\r\n        ports:\r\n        - containerPort: 5555\r\n          name: tcp-port-kept\r\n          protocol: TCP\r\n        - containerPort: 5556\r\n          name: udp-port-kept\r\n          protocol: UDP\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        resources:\r\n          limits:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n          requests:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n        securityContext:\r\n          allowPrivilegeEscalation: false\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: path/to/mount/dynamic/volume\r\n          name: executor-dynamic-volume\r\n          subPath: sub/path/to/mount/dynamic/volume\r\n        - mountPath: path/to/mount/shared/volume\r\n          name: executor-shared-volume\r\n          subPath: sub/path/to/mount/shared/volume\r\n        - mountPath: path/to/mount/static/volume\r\n          name: executor-static-volume\r\n          subPath: sub/path/to/mount/static/volume\r\n        - mountPath: /shared_volume\r\n          name: shared-volume\r\n      - image: alpine\r\n        imagePullPolicy: Always\r\n        name: sidecar-container\r\n        resources: {}\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: /shared_volume\r\n          name: shared-volume\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      volumes:\r\n      - name: executor-shared-volume\r\n        persistentVolumeClaim:\r\n          claimName: requested-claim-by-user\r\n      - emptyDir: {}\r\n        name: shared-volume\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\n  volumeClaimTemplates:\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: executor-dynamic-volume\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 256Gi\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: executor-static-volume\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 512Gi\r\n      storageClassName: storage-class-name\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\nstatus:\r\n  collisionCount: 0\r\n  currentReplicas: 2\r\n  currentRevision: acking-executors-648bfd4494\r\n  observedGeneration: 1\r\n  replicas: 2\r\n  updateRevision: acking-executors-648bfd4494\r\n  updatedReplicas: 2\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Manager StatefulSet</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2021-11-30T00:08:01Z\"\r\n  generation: 1\r\n  labels:\r\n    app: heron\r\n    topology: acking\r\n  name: acking-manager\r\n  namespace: default\r\n  resourceVersion: \"1637\"\r\n  uid: 84f96cb2-093a-47d7-8882-98cf7833219d\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 1\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0--1632273069134658892.tar.gz\r\n          . && SHARD_ID=${POD_NAME##*-} && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=acking60a8ecb7-e031-4afc-9bff-8a18703aef3a\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        - name: var_one_manager\r\n          value: variable one on manager\r\n        - name: var_three_manager\r\n          value: variable three on manager\r\n        - name: var_two_manager\r\n          value: variable two on manager\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: manager\r\n        ports:\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        - containerPort: 7775\r\n          name: tcp-port-kept\r\n          protocol: TCP\r\n        - containerPort: 7776\r\n          name: udp-port-kept\r\n          protocol: UDP\r\n        resources:\r\n          limits:\r\n            cpu: \"2\"\r\n            memory: 3Gi\r\n          requests:\r\n            cpu: \"1\"\r\n            memory: 2Gi\r\n        securityContext:\r\n          allowPrivilegeEscalation: false\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: path/to/mount/dynamic/volume\r\n          name: manager-dynamic-volume\r\n          subPath: sub/path/to/mount/dynamic/volume\r\n        - mountPath: path/to/mount/shared/volume\r\n          name: manager-shared-volume\r\n          subPath: sub/path/to/mount/shared/volume\r\n        - mountPath: path/to/mount/static/volume\r\n          name: manager-static-volume\r\n          subPath: sub/path/to/mount/static/volume\r\n        - mountPath: /shared_volume/manager\r\n          name: shared-volume-manager\r\n      - image: alpine\r\n        imagePullPolicy: Always\r\n        name: manager-sidecar-container\r\n        resources: {}\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: /shared_volume/manager\r\n          name: shared-volume-manager\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      volumes:\r\n      - name: manager-shared-volume\r\n        persistentVolumeClaim:\r\n          claimName: requested-claim-by-user\r\n      - emptyDir: {}\r\n        name: shared-volume-manager\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\n  volumeClaimTemplates:\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: manager-static-volume\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 512Gi\r\n      storageClassName: storage-class-name\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: manager-dynamic-volume\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 256Gi\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\nstatus:\r\n  collisionCount: 0\r\n  currentReplicas: 1\r\n  currentRevision: acking-manager-56cff7454d\r\n  observedGeneration: 1\r\n  replicas: 1\r\n  updateRevision: acking-manager-56cff7454d\r\n  updatedReplicas: 1\r\n```\r\n\r\n</details>","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/982156778/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/982799860","html_url":"https://github.com/apache/incubator-heron/pull/3725#issuecomment-982799860","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3725","id":982799860,"node_id":"IC_kwDOApKMps46lFX0","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-30T16:26:22Z","updated_at":"2021-11-30T16:26:22Z","author_association":"MEMBER","body":"Thank you, Nick.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/982799860/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/984255367","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-984255367","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":984255367,"node_id":"IC_kwDOApKMps46qouH","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-02T03:17:55Z","updated_at":"2021-12-02T03:19:23Z","author_association":"MEMBER","body":"### This PR combines all the functionality to customize the Heron execution environment in Kubernetes.\r\n\r\nThe documentation at this point in the PR can be found [here](https://github.com/apache/incubator-heron/blob/ae2a6606e51e2d122d0df819fe29d3ca4077d22c/website2/docs/schedulers-k8s-execution-environment.md).\r\n\r\n- [x] Separation of the Heron Manager and Executors:\r\n  - Two `StatefulSet`s per topology.\r\n    - `Manager` named `[topology-name]-manager` with a single replica.\r\n    - `Executor` named `[topology-name]-executors` with multiple replicas.\r\n  - Both `StatefulSet`s, the headless `Service`, and all `Persistent Volume Claims` which are generated for the topology are removed on termination.\r\n  - `restart` will restart the `Manager` and all `Executor`s for a topology.\r\n  - `addContainers` will only add to the replica count for `Executor`s.\r\n  - `removeContainers` will only decrement the replica count for `Executor`s.\r\n  - `patchStatefulSetReplicas` will only patch the `StatefulSet` for `Executor`s.\r\n- [x] Loading of Pod Templates via `heron.kubernetes.[executor | manager].pod.template=[ConfigMap].[Pod Template Name]`.\r\n- [x] Configure Persistent Volumes via `heron.kubernetes.[executor | manager].volumes.persistentVolumeClaim.[Volume Name].[Option]=[Value]`\r\n- [x] Configure resources for the manager and/or executor via `heron.kubernetes.[executor | manager].[limits | requests].[Option]=[Value]`\r\n\r\nI have completed some deployment testing and this PR is now available for review and broader testing.\r\n\r\n<details><summary>Submit command</summary>\r\n\r\n```bash\r\n~/bin/heron submit kubernetes ~/.heron/examples/heron-api-examples.jar \\\r\norg.apache.heron.examples.api.AckingTopology acking \\\r\n--verbose \\\r\n--config-property heron.kubernetes.executor.pod.template=pod-templ-executor.pod-template-executor.yaml \\\r\n--config-property heron.kubernetes.manager.pod.template=pod-templ-manager.pod-template-manager.yaml \\\r\n--config-property heron.kubernetes.manager.limits.cpu=2 \\\r\n--config-property heron.kubernetes.manager.limits.memory=3 \\\r\n--config-property heron.kubernetes.manager.requests.cpu=1 \\\r\n--config-property heron.kubernetes.manager.requests.memory=2 \\\r\n--config-property heron.kubernetes.executor.limits.cpu=5 \\\r\n--config-property heron.kubernetes.executor.limits.memory=6 \\\r\n--config-property heron.kubernetes.executor.requests.cpu=2 \\\r\n--config-property heron.kubernetes.executor.requests.memory=1 \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.claimName=OnDemand \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.accessModes=ReadWriteOnce,ReadOnlyMany \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.sizeLimit=256Gi \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.volumeMode=Block \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.path=path/to/mount/dynamic/volume \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.subPath=sub/path/to/mount/dynamic/volume \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.claimName=OnDemand \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.storageClassName=storage-class-name \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.accessModes=ReadWriteOnce,ReadOnlyMany \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.sizeLimit=512Gi \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.volumeMode=Block \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.path=path/to/mount/static/volume \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.subPath=sub/path/to/mount/static/volume \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-shared-volume.claimName=requested-claim-by-user \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-shared-volume.path=path/to/mount/shared/volume \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-shared-volume.subPath=sub/path/to/mount/shared/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.claimName=OnDemand \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.accessModes=ReadWriteOnce,ReadOnlyMany \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.sizeLimit=256Gi \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.volumeMode=Block \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.path=path/to/mount/dynamic/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.subPath=sub/path/to/mount/dynamic/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.claimName=OnDemand \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.storageClassName=storage-class-name \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.accessModes=ReadWriteOnce,ReadOnlyMany \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.sizeLimit=512Gi \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.volumeMode=Block \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.path=path/to/mount/static/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.subPath=sub/path/to/mount/static/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-shared-volume.claimName=requested-claim-by-user \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-shared-volume.path=path/to/mount/shared/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-shared-volume.subPath=sub/path/to/mount/shared/volume\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Manager StatefulSet</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2021-12-02T00:12:20Z\"\r\n  generation: 1\r\n  labels:\r\n    app: heron\r\n    topology: acking\r\n  name: acking-manager\r\n  namespace: default\r\n  resourceVersion: \"1216\"\r\n  uid: c823bb62-c798-46e2-8f7c-ec7f66a663ac\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 1\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0-1634139749345622293.tar.gz\r\n          . && SHARD_ID=${POD_NAME##*-} && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=acking92ff5e65-2f7c-42c1-b8f3-aa3d9e3847d6\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        - name: var_one_manager\r\n          value: variable one on manager\r\n        - name: var_three_manager\r\n          value: variable three on manager\r\n        - name: var_two_manager\r\n          value: variable two on manager\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: manager\r\n        ports:\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        - containerPort: 7775\r\n          name: tcp-port-kept\r\n          protocol: TCP\r\n        - containerPort: 7776\r\n          name: udp-port-kept\r\n          protocol: UDP\r\n        resources:\r\n          limits:\r\n            cpu: \"2\"\r\n            memory: 3Mi\r\n          requests:\r\n            cpu: \"1\"\r\n            memory: 2Mi\r\n        securityContext:\r\n          allowPrivilegeEscalation: false\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: path/to/mount/dynamic/volume\r\n          name: manager-dynamic-volume\r\n          subPath: sub/path/to/mount/dynamic/volume\r\n        - mountPath: path/to/mount/shared/volume\r\n          name: manager-shared-volume\r\n          subPath: sub/path/to/mount/shared/volume\r\n        - mountPath: path/to/mount/static/volume\r\n          name: manager-static-volume\r\n          subPath: sub/path/to/mount/static/volume\r\n        - mountPath: /shared_volume/manager\r\n          name: shared-volume-manager\r\n      - image: alpine\r\n        imagePullPolicy: Always\r\n        name: manager-sidecar-container\r\n        resources: {}\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: /shared_volume/manager\r\n          name: shared-volume-manager\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      volumes:\r\n      - name: manager-shared-volume\r\n        persistentVolumeClaim:\r\n          claimName: requested-claim-by-user\r\n      - emptyDir: {}\r\n        name: shared-volume-manager\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\n  volumeClaimTemplates:\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: manager-static-volume\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 512Gi\r\n      storageClassName: storage-class-name\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: manager-dynamic-volume\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 256Gi\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\nstatus:\r\n  collisionCount: 0\r\n  currentReplicas: 1\r\n  currentRevision: acking-manager-7596cff587\r\n  observedGeneration: 1\r\n  replicas: 1\r\n  updateRevision: acking-manager-7596cff587\r\n  updatedReplicas: 1\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Executor StatefulSet</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2021-12-02T00:12:20Z\"\r\n  generation: 1\r\n  labels:\r\n    app: heron\r\n    topology: acking\r\n  name: acking-executors\r\n  namespace: default\r\n  resourceVersion: \"1211\"\r\n  uid: 3ec133e2-591e-4864-b054-478021b8062d\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 2\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0-1634139749345622293.tar.gz\r\n          . && SHARD_ID=$((${POD_NAME##*-} + 1)) && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=acking92ff5e65-2f7c-42c1-b8f3-aa3d9e3847d6\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        - name: var_one\r\n          value: variable one\r\n        - name: var_three\r\n          value: variable three\r\n        - name: var_two\r\n          value: variable two\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: executor\r\n        ports:\r\n        - containerPort: 5555\r\n          name: tcp-port-kept\r\n          protocol: TCP\r\n        - containerPort: 5556\r\n          name: udp-port-kept\r\n          protocol: UDP\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        resources:\r\n          limits:\r\n            cpu: \"5\"\r\n            memory: 6Mi\r\n          requests:\r\n            cpu: \"2\"\r\n            memory: 1Mi\r\n        securityContext:\r\n          allowPrivilegeEscalation: false\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: path/to/mount/dynamic/volume\r\n          name: executor-dynamic-volume\r\n          subPath: sub/path/to/mount/dynamic/volume\r\n        - mountPath: path/to/mount/shared/volume\r\n          name: executor-shared-volume\r\n          subPath: sub/path/to/mount/shared/volume\r\n        - mountPath: path/to/mount/static/volume\r\n          name: executor-static-volume\r\n          subPath: sub/path/to/mount/static/volume\r\n        - mountPath: /shared_volume\r\n          name: shared-volume\r\n      - image: alpine\r\n        imagePullPolicy: Always\r\n        name: sidecar-container\r\n        resources: {}\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: /shared_volume\r\n          name: shared-volume\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      volumes:\r\n      - name: executor-shared-volume\r\n        persistentVolumeClaim:\r\n          claimName: requested-claim-by-user\r\n      - emptyDir: {}\r\n        name: shared-volume\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\n  volumeClaimTemplates:\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: executor-dynamic-volume\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 256Gi\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: executor-static-volume\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 512Gi\r\n      storageClassName: storage-class-name\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\nstatus:\r\n  collisionCount: 0\r\n  currentReplicas: 2\r\n  currentRevision: acking-executors-68f9654bd9\r\n  observedGeneration: 1\r\n  replicas: 2\r\n  updateRevision: acking-executors-68f9654bd9\r\n  updatedReplicas: 2\r\n```\r\n\r\n</details>\r\n","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/984255367/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/984966124","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-984966124","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":984966124,"node_id":"IC_kwDOApKMps46tWPs","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-02T20:13:18Z","updated_at":"2021-12-02T22:05:30Z","author_association":"CONTRIBUTOR","body":"Tested a deployment of `acking` topology without specifying any parameters. When trying to kill the topology, I received the following stack trace in the `heron-apiserver`:\r\n```\r\n[2021-12-02 20:10:38 +0000] [INFO] org.apache.heron.statemgr.zookeeper.curator.CuratorStateManager: Closing the tunnel processes\r\n2021-12-02 20:10:38,231 ERROR org.apache.heron.apiserver.resources.TopologyResource kill qtp2045766957-13 error killing topology acking\r\njava.lang.IllegalStateException: closed\r\n\tat okio.RealBufferedSource.select(RealBufferedSource.java:93)\r\n\tat okhttp3.internal.Util.bomAwareCharset(Util.java:467)\r\n\tat okhttp3.ResponseBody.string(ResponseBody.java:181)\r\n\tat org.apache.heron.scheduler.kubernetes.KubernetesUtils.errorMessageFromResponse(KubernetesUtils.java:77)\r\n\tat org.apache.heron.scheduler.kubernetes.V1Controller.deleteStatefulSets(V1Controller.java:313)\r\n\tat org.apache.heron.scheduler.kubernetes.V1Controller.killTopology(V1Controller.java:165)\r\n\tat org.apache.heron.scheduler.kubernetes.KubernetesScheduler.onKill(KubernetesScheduler.java:113)\r\n\tat org.apache.heron.scheduler.client.LibrarySchedulerClient.killTopology(LibrarySchedulerClient.java:61)\r\n\tat org.apache.heron.scheduler.RuntimeManagerRunner.killTopologyHandler(RuntimeManagerRunner.java:173)\r\n\tat org.apache.heron.scheduler.RuntimeManagerRunner.call(RuntimeManagerRunner.java:98)\r\n\tat org.apache.heron.scheduler.RuntimeManagerMain.callRuntimeManagerRunner(RuntimeManagerMain.java:498)\r\n\tat org.apache.heron.scheduler.RuntimeManagerMain.manageTopology(RuntimeManagerMain.java:411)\r\n\tat org.apache.heron.apiserver.actions.TopologyRuntimeAction.execute(TopologyRuntimeAction.java:39)\r\n\tat org.apache.heron.apiserver.resources.TopologyResource.kill(TopologyResource.java:498)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n```\r\n\r\nEdit: Perhaps this is due to a missing `deletecollection` verb on `StatefulSet` in the `Role`? I'll test this out later tonight.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/984966124/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985076742","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-985076742","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":985076742,"node_id":"IC_kwDOApKMps46txQG","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-02T23:12:52Z","updated_at":"2021-12-02T23:12:52Z","author_association":"MEMBER","body":"> Edit: Perhaps this is due to a missing `deletecollection` verb on `StatefulSet` in the `Role`? I'll test this out later tonight.\r\n\r\nI can confirm that I am able to shut down a topology cleanly on Minikube when deploying without Helm charts. You might be using an old Helm chart or I could be missing additionally required permissions, the PR currently has the following:\r\n\r\n```yaml\r\n- apiGroups:\r\n  - apps\r\n  resources:\r\n  - statefulsets\r\n  verbs:\r\n  - create\r\n  - delete\r\n  - get\r\n  - list\r\n  - patch\r\n  - update\r\n  - watch\r\n  - deletecollection\r\n```","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985076742/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985179986","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-985179986","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":985179986,"node_id":"IC_kwDOApKMps46uKdS","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-03T03:13:07Z","updated_at":"2021-12-03T03:13:07Z","author_association":"CONTRIBUTOR","body":">  Perhaps this is due to a missing `deletecollection` verb on `StatefulSet` in the `Role`? I'll test this out later tonight.\r\n\r\nThat fixed it. I'll push up a code edit shortly.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985179986/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985191891","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-985191891","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":985191891,"node_id":"IC_kwDOApKMps46uNXT","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-03T03:47:50Z","updated_at":"2021-12-03T03:47:50Z","author_association":"CONTRIBUTOR","body":"Ok, just realized that I was using an old Helm chart. The branch already has the fix. Apologies.\r\n\r\nI think this is ready to be merged. If we want to lower the default Request/Limit values for the manager pod, we can always do that in a future PR. I'll leave the decision to @surahman. I think it would be nice to have, but having the ability to customize the values is a huge improvement.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985191891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985222565","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-985222565","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":985222565,"node_id":"IC_kwDOApKMps46uU2l","user":{"login":"windhamwong","id":677625,"node_id":"MDQ6VXNlcjY3NzYyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/677625?v=4","gravatar_id":"","url":"https://api.github.com/users/windhamwong","html_url":"https://github.com/windhamwong","followers_url":"https://api.github.com/users/windhamwong/followers","following_url":"https://api.github.com/users/windhamwong/following{/other_user}","gists_url":"https://api.github.com/users/windhamwong/gists{/gist_id}","starred_url":"https://api.github.com/users/windhamwong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/windhamwong/subscriptions","organizations_url":"https://api.github.com/users/windhamwong/orgs","repos_url":"https://api.github.com/users/windhamwong/repos","events_url":"https://api.github.com/users/windhamwong/events{/privacy}","received_events_url":"https://api.github.com/users/windhamwong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-03T05:12:33Z","updated_at":"2021-12-03T05:12:33Z","author_association":"CONTRIBUTOR","body":"--config-property heron.kubernetes.manager.limits.memory=3 \\\r\njust wondering if there is a better way to set the amount of memory? i.e. Using KiB as the unit, 3000 instead of just 3 for 3MiB?","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985222565/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985626299","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-985626299","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":985626299,"node_id":"IC_kwDOApKMps46v3a7","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-03T15:47:52Z","updated_at":"2021-12-03T16:13:38Z","author_association":"MEMBER","body":"Thank you @nicknezis and @windhamwong for taking the time to test and review that PR 😄.\r\n\r\nI have pushed some fixes to the [documentation](https://github.com/apache/incubator-heron/blob/5068c79a9801e441e5420a9c99366561788304b2/website2/docs/schedulers-k8s-execution-environment.md) but the code remains unchanged.\r\n\r\n> If we want to lower the default Request/Limit values for the manager pod, we can always do that in a future PR.\r\n\r\nYou would need a large and diverse dataset to form a baseline for the default resource values. I feel we would need to solicit statistics from users for topologies with varying configurations (bolts and spouts) as well as data velocity and volume to form a baseline.\r\n\r\n> just wondering if there is a better way to set the amount of memory?\r\n\r\nThe reason I choose Megabytes is that we typically use Gigabytes for the units when working with memory (volatile and non-volatile) and we may need to work with fractions of a Gigabyte. I do not feel we would need the granularity of Kilobytes when working with memory and that it would make the command tedious to use (eg.: `1,000,000 KB` vs `1,000 MB` for 1 Gigabyte). That said, changing the units would not be difficult, it would mean one change in production code and a handful in the test suite.\r\n\r\n**_Edit:_** I think we are good to merge.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985626299/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985771395","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-985771395","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":985771395,"node_id":"IC_kwDOApKMps46wa2D","user":{"login":"joshfischer1108","id":5785700,"node_id":"MDQ6VXNlcjU3ODU3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/5785700?v=4","gravatar_id":"","url":"https://api.github.com/users/joshfischer1108","html_url":"https://github.com/joshfischer1108","followers_url":"https://api.github.com/users/joshfischer1108/followers","following_url":"https://api.github.com/users/joshfischer1108/following{/other_user}","gists_url":"https://api.github.com/users/joshfischer1108/gists{/gist_id}","starred_url":"https://api.github.com/users/joshfischer1108/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joshfischer1108/subscriptions","organizations_url":"https://api.github.com/users/joshfischer1108/orgs","repos_url":"https://api.github.com/users/joshfischer1108/repos","events_url":"https://api.github.com/users/joshfischer1108/events{/privacy}","received_events_url":"https://api.github.com/users/joshfischer1108/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-03T19:25:43Z","updated_at":"2021-12-03T19:25:43Z","author_association":"MEMBER","body":"Nice work @surahman .  All, let's wait till 24 hours after @nicknezis approval before merging.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985771395/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985778347","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-985778347","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":985778347,"node_id":"IC_kwDOApKMps46wcir","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-03T19:37:34Z","updated_at":"2021-12-03T19:37:34Z","author_association":"CONTRIBUTOR","body":"\n> > If we want to lower the default Request/Limit values for the manager pod, we can always do that in a future PR.\n> \n> You would need a large and diverse dataset to form a baseline for the default resource values. I feel we would need to solicit statistics from users for topologies with varying configurations (bolts and spouts) as well as data velocity and volume to form a baseline.\n> \n\nSo the bolts and spouts and strmgr processes all live in the executor pods. Data velocity and stuff like that is all in the executor. Manager just has a few processes that collect metrics and manage coordination of checkpointing (if used). Also if the physical plan changes it will coordinate changes through zookeeper. (It does more, but trying to give examples of the types of operations).\n\nI still think we can default to smaller value with low risk, but agree the risk is not 0%. After this is merged, I'll do some analysis on workloads at work to see what could be a good default. @windhamwong provided numbers also give me confidence because they match what I've observed. But I'll do a more rigorous process to capture numbers.\n\nBut what I said above doesn't counter the decision to merge as is. I agree with @surahman decision.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985778347/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985788153","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-985788153","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":985788153,"node_id":"IC_kwDOApKMps46we75","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-03T19:55:01Z","updated_at":"2021-12-03T19:55:01Z","author_association":"MEMBER","body":"> I still think we can default to smaller value with low risk, but agree the risk is not 0%. After this is merged, I'll do some analysis on workloads at work to see what could be a good default. @windhamwong provided numbers also give me confidence because they match what I've observed. But I'll do a more rigorous process to capture numbers.\r\n\r\nI agree. Once we are sure of the changes which need to be made we can go ahead and figure out how to affect this change in a future PR.\r\n\r\nI have one last set of typos corrections I am making to the documentation that I will merge in later today.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985788153/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985894063","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-985894063","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":985894063,"node_id":"IC_kwDOApKMps46w4yv","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-03T22:50:06Z","updated_at":"2021-12-03T22:50:06Z","author_association":"MEMBER","body":"@nicknezis I have updated the `Resource` CLI commands to support native [units](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#resource-units-in-kubernetes) from K8s to allow the specification of unit suffixes. Sorry, but this will need your approval again :confounded:. Updated documentation is [here](https://github.com/apache/incubator-heron/blob/b53d476f68900a8b1cc83a59da5208316857e0cb/website2/docs/schedulers-k8s-execution-environment.md) and a sample command with the YAML output for the `Executors` and `Manager` `StatefulSet`s is below.\r\n\r\nThis should fill @windhamwong's request for Kilobyte support via the `k`/`Ki` suffix.\r\n\r\n<details><summary>Commands</summary>\r\n\r\n```bash\r\n~/bin/heron submit kubernetes ~/.heron/examples/heron-api-examples.jar \\\r\norg.apache.heron.examples.api.AckingTopology acking \\\r\n--verbose \\\r\n--deploy-deactivated \\\r\n--config-property heron.kubernetes.executor.pod.template=pod-templ-executor.pod-template-executor.yaml \\\r\n--config-property heron.kubernetes.manager.pod.template=pod-templ-manager.pod-template-manager.yaml \\\r\n--config-property heron.kubernetes.manager.limits.cpu=2000m \\\r\n--config-property heron.kubernetes.manager.limits.memory=300Mi \\\r\n--config-property heron.kubernetes.manager.requests.cpu=1000m \\\r\n--config-property heron.kubernetes.manager.requests.memory=200Mi \\\r\n--config-property heron.kubernetes.executor.limits.cpu=5 \\\r\n--config-property heron.kubernetes.executor.limits.memory=6Gi \\\r\n--config-property heron.kubernetes.executor.requests.cpu=2 \\\r\n--config-property heron.kubernetes.executor.requests.memory=1Gi \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.claimName=OnDemand \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.accessModes=ReadWriteOnce,ReadOnlyMany \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.sizeLimit=256Gi \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.volumeMode=Block \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.path=path/to/mount/dynamic/volume \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.subPath=sub/path/to/mount/dynamic/volume \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.claimName=OnDemand \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.storageClassName=storage-class-name \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.accessModes=ReadWriteOnce,ReadOnlyMany \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.sizeLimit=512Gi \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.volumeMode=Block \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.path=path/to/mount/static/volume \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.subPath=sub/path/to/mount/static/volume \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-shared-volume.claimName=requested-claim-by-user \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-shared-volume.path=path/to/mount/shared/volume \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-shared-volume.subPath=sub/path/to/mount/shared/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.claimName=OnDemand \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.accessModes=ReadWriteOnce,ReadOnlyMany \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.sizeLimit=256Gi \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.volumeMode=Block \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.path=path/to/mount/dynamic/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.subPath=sub/path/to/mount/dynamic/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.claimName=OnDemand \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.storageClassName=storage-class-name \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.accessModes=ReadWriteOnce,ReadOnlyMany \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.sizeLimit=512Gi \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.volumeMode=Block \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.path=path/to/mount/static/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.subPath=sub/path/to/mount/static/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-shared-volume.claimName=requested-claim-by-user \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-shared-volume.path=path/to/mount/shared/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-shared-volume.subPath=sub/path/to/mount/shared/volume\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Manager StatefulSet</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2021-12-03T22:36:48Z\"\r\n  generation: 1\r\n  labels:\r\n    app: heron\r\n    topology: acking\r\n  name: acking-manager\r\n  namespace: default\r\n  resourceVersion: \"787\"\r\n  uid: d93e7e8d-e690-4e72-96bd-2b327fff9ecc\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 1\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0-1268791470655715640.tar.gz\r\n          . && SHARD_ID=${POD_NAME##*-} && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=acking5d5d16b0-7b36-4662-9690-658afec32555\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        - name: var_one_manager\r\n          value: variable one on manager\r\n        - name: var_three_manager\r\n          value: variable three on manager\r\n        - name: var_two_manager\r\n          value: variable two on manager\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: manager\r\n        ports:\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        - containerPort: 7775\r\n          name: tcp-port-kept\r\n          protocol: TCP\r\n        - containerPort: 7776\r\n          name: udp-port-kept\r\n          protocol: UDP\r\n        resources:\r\n          limits:\r\n            cpu: \"2\"\r\n            memory: 300Mi\r\n          requests:\r\n            cpu: \"1\"\r\n            memory: 200Mi\r\n        securityContext:\r\n          allowPrivilegeEscalation: false\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: path/to/mount/dynamic/volume\r\n          name: manager-dynamic-volume\r\n          subPath: sub/path/to/mount/dynamic/volume\r\n        - mountPath: path/to/mount/shared/volume\r\n          name: manager-shared-volume\r\n          subPath: sub/path/to/mount/shared/volume\r\n        - mountPath: path/to/mount/static/volume\r\n          name: manager-static-volume\r\n          subPath: sub/path/to/mount/static/volume\r\n        - mountPath: /shared_volume/manager\r\n          name: shared-volume-manager\r\n      - image: alpine\r\n        imagePullPolicy: Always\r\n        name: manager-sidecar-container\r\n        resources: {}\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: /shared_volume/manager\r\n          name: shared-volume-manager\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      volumes:\r\n      - name: manager-shared-volume\r\n        persistentVolumeClaim:\r\n          claimName: requested-claim-by-user\r\n      - emptyDir: {}\r\n        name: shared-volume-manager\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\n  volumeClaimTemplates:\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: manager-static-volume\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 512Gi\r\n      storageClassName: storage-class-name\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: manager-dynamic-volume\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 256Gi\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\nstatus:\r\n  collisionCount: 0\r\n  currentReplicas: 1\r\n  currentRevision: acking-manager-5f576f75cc\r\n  observedGeneration: 1\r\n  replicas: 1\r\n  updateRevision: acking-manager-5f576f75cc\r\n  updatedReplicas: 1\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Executor StatefulSet</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2021-12-03T22:36:48Z\"\r\n  generation: 1\r\n  labels:\r\n    app: heron\r\n    topology: acking\r\n  name: acking-executors\r\n  namespace: default\r\n  resourceVersion: \"789\"\r\n  uid: ce141b3b-b7f6-43ba-8442-57c63b528be3\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 2\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0-1268791470655715640.tar.gz\r\n          . && SHARD_ID=$((${POD_NAME##*-} + 1)) && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=acking5d5d16b0-7b36-4662-9690-658afec32555\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        - name: var_one\r\n          value: variable one\r\n        - name: var_three\r\n          value: variable three\r\n        - name: var_two\r\n          value: variable two\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: executor\r\n        ports:\r\n        - containerPort: 5555\r\n          name: tcp-port-kept\r\n          protocol: TCP\r\n        - containerPort: 5556\r\n          name: udp-port-kept\r\n          protocol: UDP\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        resources:\r\n          limits:\r\n            cpu: \"5\"\r\n            memory: 6Gi\r\n          requests:\r\n            cpu: \"2\"\r\n            memory: 1Gi\r\n        securityContext:\r\n          allowPrivilegeEscalation: false\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: path/to/mount/dynamic/volume\r\n          name: executor-dynamic-volume\r\n          subPath: sub/path/to/mount/dynamic/volume\r\n        - mountPath: path/to/mount/shared/volume\r\n          name: executor-shared-volume\r\n          subPath: sub/path/to/mount/shared/volume\r\n        - mountPath: path/to/mount/static/volume\r\n          name: executor-static-volume\r\n          subPath: sub/path/to/mount/static/volume\r\n        - mountPath: /shared_volume\r\n          name: shared-volume\r\n      - image: alpine\r\n        imagePullPolicy: Always\r\n        name: sidecar-container\r\n        resources: {}\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: /shared_volume\r\n          name: shared-volume\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      volumes:\r\n      - name: executor-shared-volume\r\n        persistentVolumeClaim:\r\n          claimName: requested-claim-by-user\r\n      - emptyDir: {}\r\n        name: shared-volume\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\n  volumeClaimTemplates:\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: executor-dynamic-volume\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 256Gi\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: executor-static-volume\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 512Gi\r\n      storageClassName: storage-class-name\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\nstatus:\r\n  collisionCount: 0\r\n  currentReplicas: 2\r\n  currentRevision: acking-executors-675c888b5\r\n  observedGeneration: 1\r\n  replicas: 2\r\n  updateRevision: acking-executors-675c888b5\r\n  updatedReplicas: 2\r\n```\r\n\r\n</details>","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985894063/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985959573","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-985959573","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":985959573,"node_id":"IC_kwDOApKMps46xIyV","user":{"login":"windhamwong","id":677625,"node_id":"MDQ6VXNlcjY3NzYyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/677625?v=4","gravatar_id":"","url":"https://api.github.com/users/windhamwong","html_url":"https://github.com/windhamwong","followers_url":"https://api.github.com/users/windhamwong/followers","following_url":"https://api.github.com/users/windhamwong/following{/other_user}","gists_url":"https://api.github.com/users/windhamwong/gists{/gist_id}","starred_url":"https://api.github.com/users/windhamwong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/windhamwong/subscriptions","organizations_url":"https://api.github.com/users/windhamwong/orgs","repos_url":"https://api.github.com/users/windhamwong/repos","events_url":"https://api.github.com/users/windhamwong/events{/privacy}","received_events_url":"https://api.github.com/users/windhamwong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-04T03:39:03Z","updated_at":"2021-12-04T03:39:03Z","author_association":"CONTRIBUTOR","body":"Thanks. Let me test out over the weekend.\r\n","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985959573/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985966974","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-985966974","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":985966974,"node_id":"IC_kwDOApKMps46xKl-","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-04T04:45:12Z","updated_at":"2021-12-04T04:45:12Z","author_association":"CONTRIBUTOR","body":"I ran a test with `acking` topology. Was able to submit with default and also override the values. I think it's good to merge.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/985966974/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986041055","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-986041055","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":986041055,"node_id":"IC_kwDOApKMps46xcrf","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-04T14:59:25Z","updated_at":"2021-12-04T14:59:25Z","author_association":"MEMBER","body":"Thank you, Nick, let us give Windham some time to test this out before merging.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986041055/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986200442","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-986200442","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":986200442,"node_id":"IC_kwDOApKMps46yDl6","user":{"login":"windhamwong","id":677625,"node_id":"MDQ6VXNlcjY3NzYyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/677625?v=4","gravatar_id":"","url":"https://api.github.com/users/windhamwong","html_url":"https://github.com/windhamwong","followers_url":"https://api.github.com/users/windhamwong/followers","following_url":"https://api.github.com/users/windhamwong/following{/other_user}","gists_url":"https://api.github.com/users/windhamwong/gists{/gist_id}","starred_url":"https://api.github.com/users/windhamwong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/windhamwong/subscriptions","organizations_url":"https://api.github.com/users/windhamwong/orgs","repos_url":"https://api.github.com/users/windhamwong/repos","events_url":"https://api.github.com/users/windhamwong/events{/privacy}","received_events_url":"https://api.github.com/users/windhamwong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-05T10:03:27Z","updated_at":"2021-12-05T10:03:27Z","author_association":"CONTRIBUTOR","body":"Im testing on the build, and wondering the needs of \r\n`heron.kubernetes.executor.pod.template=pod-templ-executor.pod-template-executor.yaml`\r\nIs this necessary on deployment and where is this file located?","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986200442/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986203544","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-986203544","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":986203544,"node_id":"IC_kwDOApKMps46yEWY","user":{"login":"windhamwong","id":677625,"node_id":"MDQ6VXNlcjY3NzYyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/677625?v=4","gravatar_id":"","url":"https://api.github.com/users/windhamwong","html_url":"https://github.com/windhamwong","followers_url":"https://api.github.com/users/windhamwong/followers","following_url":"https://api.github.com/users/windhamwong/following{/other_user}","gists_url":"https://api.github.com/users/windhamwong/gists{/gist_id}","starred_url":"https://api.github.com/users/windhamwong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/windhamwong/subscriptions","organizations_url":"https://api.github.com/users/windhamwong/orgs","repos_url":"https://api.github.com/users/windhamwong/repos","events_url":"https://api.github.com/users/windhamwong/events{/privacy}","received_events_url":"https://api.github.com/users/windhamwong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-05T10:23:35Z","updated_at":"2021-12-05T10:25:15Z","author_association":"CONTRIBUTOR","body":"I don't have problem with the PVC but just wondering, do we need\r\n```\r\n--config-property heron.kubernetes.executor.limits.cpu=5 \\\r\n--config-property heron.kubernetes.executor.limits.memory=6Gi \\\r\n--config-property heron.kubernetes.executor.requests.cpu=2 \\\r\n--config-property heron.kubernetes.executor.requests.memory=1Gi \\\r\n```\r\nas we already got\r\n```\r\n  constants.TOPOLOGY_CONTAINER_CPU_REQUESTED\r\n  constants.TOPOLOGY_CONTAINER_RAM_REQUESTED\r\n```\r\nin each topology. \r\n\r\nWill there be a way to implement the config in topology constants so we can change the value for specific topology?","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986203544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986241599","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-986241599","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":986241599,"node_id":"IC_kwDOApKMps46yNo_","user":{"login":"windhamwong","id":677625,"node_id":"MDQ6VXNlcjY3NzYyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/677625?v=4","gravatar_id":"","url":"https://api.github.com/users/windhamwong","html_url":"https://github.com/windhamwong","followers_url":"https://api.github.com/users/windhamwong/followers","following_url":"https://api.github.com/users/windhamwong/following{/other_user}","gists_url":"https://api.github.com/users/windhamwong/gists{/gist_id}","starred_url":"https://api.github.com/users/windhamwong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/windhamwong/subscriptions","organizations_url":"https://api.github.com/users/windhamwong/orgs","repos_url":"https://api.github.com/users/windhamwong/repos","events_url":"https://api.github.com/users/windhamwong/events{/privacy}","received_events_url":"https://api.github.com/users/windhamwong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-05T14:38:42Z","updated_at":"2021-12-05T14:42:12Z","author_association":"CONTRIBUTOR","body":"I think we got another bug here. As the Python version using is 3.8 under your pr branch, it warns the Python library kazoo (used in zookeeper connection). Heron Tracker uses kazoo 2.7.0 but Python 3.8 is not compatible with it and has to upgrade kazoo to 2.8.0. \r\nWarning:\r\n```\r\n/root/.pex/installed_wheels/6e40458c80f1b6a2bb9c38603c9fe8a17f0aa169/kazoo-2.7.0-py2.py3-none-any.whl/kazoo/protocol/serialization.py:114: SyntaxWarning: \"is\"\r\n with a literal. Did you mean \"==\"?\r\n  read_only = bool_struct.unpack_from(bytes, offset)[0] is 1\r\n/root/.pex/installed_wheels/6e40458c80f1b6a2bb9c38603c9fe8a17f0aa169/kazoo-2.7.0-py2.py3-none-any.whl/kazoo/protocol/serialization.py:449: SyntaxWarning: \"is\" with a literal. Did you mean \"==\"?\r\n```\r\n\r\nShall have another PR for this :D","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986241599/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986250149","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-986250149","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":986250149,"node_id":"IC_kwDOApKMps46yPul","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-05T15:28:31Z","updated_at":"2021-12-05T15:28:31Z","author_association":"MEMBER","body":"> Im testing on the build, and wondering the needs of `heron.kubernetes.executor.pod.template=pod-templ-executor.pod-template-executor.yaml` Is this necessary on deployment and where is this file located?\r\n\r\n@windhamwong It is not required, and if not supplied a default `Executor` and `Manager` pod will be deployed. You will need to load the Pod Template into a ConfigMap. Please see the first section of the [documentation](https://github.com/apache/incubator-heron/blob/b53d476f68900a8b1cc83a59da5208316857e0cb/website2/docs/schedulers-k8s-execution-environment.md) for usage and details. This functionality was initially introduced in an earlier PR.\r\n\r\n> I don't have problem with the PVC but just wondering, do we need\r\n> \r\n> ```\r\n> --config-property heron.kubernetes.executor.limits.cpu=5 \\\r\n> --config-property heron.kubernetes.executor.limits.memory=6Gi \\\r\n> --config-property heron.kubernetes.executor.requests.cpu=2 \\\r\n> --config-property heron.kubernetes.executor.requests.memory=1Gi \\\r\n> ```\r\n> \r\n> as we already got\r\n> \r\n> ```\r\n>   constants.TOPOLOGY_CONTAINER_CPU_REQUESTED\r\n>   constants.TOPOLOGY_CONTAINER_RAM_REQUESTED\r\n> ```\r\n> \r\n> in each topology.\r\n> \r\n> Will there be a way to implement the config in topology constants so we can change the value for specific topology?\r\n\r\nThis functionality mirrors what is available in Spark and permits deployment time tweaking of resources without having to repackage a `Jar` file your topology. The ability to configure resources via configs remains unchanged but the CLI commands take precedence to facilitate the aforementioned functionality.\r\n\r\n> I think we got another bug here. As the Python version using is 3.8 under your pr branch, it warns the Python library kazoo (used in zookeeper connection). Heron Tracker uses kazoo 2.7.0 but Python 3.8 is not compatible with it and has to upgrade kazoo to 2.8.0. Warning:\r\n> \r\n> ```\r\n> /root/.pex/installed_wheels/6e40458c80f1b6a2bb9c38603c9fe8a17f0aa169/kazoo-2.7.0-py2.py3-none-any.whl/kazoo/protocol/serialization.py:114: SyntaxWarning: \"is\"\r\n>  with a literal. Did you mean \"==\"?\r\n>   read_only = bool_struct.unpack_from(bytes, offset)[0] is 1\r\n> /root/.pex/installed_wheels/6e40458c80f1b6a2bb9c38603c9fe8a17f0aa169/kazoo-2.7.0-py2.py3-none-any.whl/kazoo/protocol/serialization.py:449: SyntaxWarning: \"is\" with a literal. Did you mean \"==\"?\r\n> ```\r\n> \r\n> Shall have another PR for this :D\r\n\r\nGood catch, please open a new issue if you have not already. These are not changes that were introduced in this PR and are most likely associated with updates to facilitate building on `macOS`.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986250149/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986259908","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-986259908","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":986259908,"node_id":"IC_kwDOApKMps46ySHE","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-05T16:25:08Z","updated_at":"2021-12-05T16:25:08Z","author_association":"MEMBER","body":"Please double check your commands and script. I see a trailing `\"` in the command below.\r\n\r\n> ```\r\n>   heron submit heron /opt/src.pex - $2 --verbose \\\r\n>   --config-property heron.kubernetes.manager.limits.cpu=300m \\\r\n>   --config-property heron.kubernetes.manager.limits.memory=300Mi \\\r\n>   --config-property heron.kubernetes.manager.requests.cpu=20m \\\r\n>   --config-property heron.kubernetes.manager.requests.memory=100Mi\"\r\n> ```\r\n\r\nHere is my run on `acking` with your settings and everything is inorder:\r\n\r\n```bash\r\n~/bin/heron submit kubernetes ~/.heron/examples/heron-api-examples.jar \\\r\norg.apache.heron.examples.api.AckingTopology acking \\\r\n--verbose \\\r\n--config-property heron.kubernetes.manager.limits.cpu=300m \\\r\n--config-property heron.kubernetes.manager.limits.memory=300Mi \\\r\n--config-property heron.kubernetes.manager.requests.cpu=20m \\\r\n--config-property heron.kubernetes.manager.requests.memory=100Mi\r\n```\r\n\r\n<details><summary>Manager StatefulSet</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2021-12-05T16:12:40Z\"\r\n  generation: 1\r\n  labels:\r\n    app: heron\r\n    topology: acking\r\n  name: acking-manager\r\n  namespace: default\r\n  resourceVersion: \"858\"\r\n  uid: 6be69dad-2943-4813-9c26-7ed5e185a0e1\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 1\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0--4532610184000198972.tar.gz\r\n          . && SHARD_ID=${POD_NAME##*-} && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=acking2d4d1f63-90db-435d-9e2b-6be7f5bfc0ee\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: manager\r\n        ports:\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        resources:\r\n          limits:\r\n            cpu: 300m\r\n            memory: 300Mi\r\n          requests:\r\n            cpu: 20m\r\n            memory: 100Mi\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\nstatus:\r\n  availableReplicas: 1\r\n  collisionCount: 0\r\n  currentReplicas: 1\r\n  currentRevision: acking-manager-f5f4784\r\n  observedGeneration: 1\r\n  readyReplicas: 1\r\n  replicas: 1\r\n  updateRevision: acking-manager-f5f4784\r\n  updatedReplicas: 1\r\n```\r\n\r\n</details>\r\n\r\n<details><summary>Executor StatefulSet</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2021-12-05T16:12:40Z\"\r\n  generation: 1\r\n  labels:\r\n    app: heron\r\n    topology: acking\r\n  name: acking-executors\r\n  namespace: default\r\n  resourceVersion: \"862\"\r\n  uid: afe8b301-953d-49fa-af05-37289f9cf721\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 2\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0--4532610184000198972.tar.gz\r\n          . && SHARD_ID=$((${POD_NAME##*-} + 1)) && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=acking2d4d1f63-90db-435d-9e2b-6be7f5bfc0ee\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: executor\r\n        ports:\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        resources:\r\n          limits:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n          requests:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\nstatus:\r\n  availableReplicas: 2\r\n  collisionCount: 0\r\n  currentReplicas: 2\r\n  currentRevision: acking-executors-548c6dbd6c\r\n  observedGeneration: 1\r\n  readyReplicas: 2\r\n  replicas: 2\r\n  updateRevision: acking-executors-548c6dbd6c\r\n  updatedReplicas: 2\r\n```\r\n\r\n</details>","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986259908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986261784","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-986261784","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":986261784,"node_id":"IC_kwDOApKMps46ySkY","user":{"login":"windhamwong","id":677625,"node_id":"MDQ6VXNlcjY3NzYyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/677625?v=4","gravatar_id":"","url":"https://api.github.com/users/windhamwong","html_url":"https://github.com/windhamwong","followers_url":"https://api.github.com/users/windhamwong/followers","following_url":"https://api.github.com/users/windhamwong/following{/other_user}","gists_url":"https://api.github.com/users/windhamwong/gists{/gist_id}","starred_url":"https://api.github.com/users/windhamwong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/windhamwong/subscriptions","organizations_url":"https://api.github.com/users/windhamwong/orgs","repos_url":"https://api.github.com/users/windhamwong/repos","events_url":"https://api.github.com/users/windhamwong/events{/privacy}","received_events_url":"https://api.github.com/users/windhamwong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-05T16:37:53Z","updated_at":"2021-12-05T16:37:53Z","author_association":"CONTRIBUTOR","body":"my test shows successful with the correct manager resource requests/limits. ","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986261784/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986263155","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-986263155","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":986263155,"node_id":"IC_kwDOApKMps46yS5z","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-05T16:45:35Z","updated_at":"2021-12-05T16:45:35Z","author_association":"MEMBER","body":"@windhamwong thank you for also taking the time to review and test! 😄 ","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986263155/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986266624","html_url":"https://github.com/apache/incubator-heron/pull/3741#issuecomment-986266624","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3741","id":986266624,"node_id":"IC_kwDOApKMps46yTwA","user":{"login":"joshfischer1108","id":5785700,"node_id":"MDQ6VXNlcjU3ODU3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/5785700?v=4","gravatar_id":"","url":"https://api.github.com/users/joshfischer1108","html_url":"https://github.com/joshfischer1108","followers_url":"https://api.github.com/users/joshfischer1108/followers","following_url":"https://api.github.com/users/joshfischer1108/following{/other_user}","gists_url":"https://api.github.com/users/joshfischer1108/gists{/gist_id}","starred_url":"https://api.github.com/users/joshfischer1108/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joshfischer1108/subscriptions","organizations_url":"https://api.github.com/users/joshfischer1108/orgs","repos_url":"https://api.github.com/users/joshfischer1108/repos","events_url":"https://api.github.com/users/joshfischer1108/events{/privacy}","received_events_url":"https://api.github.com/users/joshfischer1108/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-05T17:08:49Z","updated_at":"2021-12-05T17:08:49Z","author_association":"MEMBER","body":"Alright.  Let's get this merged, @surahman .  Nice work 💯 ","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986266624/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986387209","html_url":"https://github.com/apache/incubator-heron/pull/3743#issuecomment-986387209","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3743","id":986387209,"node_id":"IC_kwDOApKMps46yxMJ","user":{"login":"windhamwong","id":677625,"node_id":"MDQ6VXNlcjY3NzYyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/677625?v=4","gravatar_id":"","url":"https://api.github.com/users/windhamwong","html_url":"https://github.com/windhamwong","followers_url":"https://api.github.com/users/windhamwong/followers","following_url":"https://api.github.com/users/windhamwong/following{/other_user}","gists_url":"https://api.github.com/users/windhamwong/gists{/gist_id}","starred_url":"https://api.github.com/users/windhamwong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/windhamwong/subscriptions","organizations_url":"https://api.github.com/users/windhamwong/orgs","repos_url":"https://api.github.com/users/windhamwong/repos","events_url":"https://api.github.com/users/windhamwong/events{/privacy}","received_events_url":"https://api.github.com/users/windhamwong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-06T02:43:11Z","updated_at":"2021-12-06T02:43:11Z","author_association":"CONTRIBUTOR","body":"Please check the issue https://github.com/apache/incubator-heron/issues/3742","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986387209/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986459015","html_url":"https://github.com/apache/incubator-heron/issues/3466#issuecomment-986459015","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3466","id":986459015,"node_id":"IC_kwDOApKMps46zCuH","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-06T05:47:47Z","updated_at":"2021-12-06T05:47:47Z","author_association":"CONTRIBUTOR","body":"Closing this issue as the PodSecurityPolicy is now deprecated in Kubernetes","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/986459015/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/988233737","html_url":"https://github.com/apache/incubator-heron/pull/3642#issuecomment-988233737","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3642","id":988233737,"node_id":"IC_kwDOApKMps4650AJ","user":{"login":"Code0x58","id":9309570,"node_id":"MDQ6VXNlcjkzMDk1NzA=","avatar_url":"https://avatars.githubusercontent.com/u/9309570?v=4","gravatar_id":"","url":"https://api.github.com/users/Code0x58","html_url":"https://github.com/Code0x58","followers_url":"https://api.github.com/users/Code0x58/followers","following_url":"https://api.github.com/users/Code0x58/following{/other_user}","gists_url":"https://api.github.com/users/Code0x58/gists{/gist_id}","starred_url":"https://api.github.com/users/Code0x58/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Code0x58/subscriptions","organizations_url":"https://api.github.com/users/Code0x58/orgs","repos_url":"https://api.github.com/users/Code0x58/repos","events_url":"https://api.github.com/users/Code0x58/events{/privacy}","received_events_url":"https://api.github.com/users/Code0x58/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-07T20:14:18Z","updated_at":"2021-12-07T20:14:18Z","author_association":"CONTRIBUTOR","body":"I rebased this after seeing a PR went in for python 3.8 support, but it looks like the properly supported version isn't that high yet.\r\n\r\nThere's still the issue of requiring python 3.7+ for this PR. I don't have the time to go through and update and test all of the Docker images which would get this in a good place for testing.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/988233737/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/990346848","html_url":"https://github.com/apache/incubator-heron/pull/3744#issuecomment-990346848","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3744","id":990346848,"node_id":"IC_kwDOApKMps47B35g","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-09T22:22:47Z","updated_at":"2021-12-09T22:22:47Z","author_association":"MEMBER","body":"Closed and opened new PR#3747 due it tracking the wrong source branch (`-dev`).","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/990346848/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/990626460","html_url":"https://github.com/apache/incubator-heron/pull/3746#issuecomment-990626460","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3746","id":990626460,"node_id":"IC_kwDOApKMps47C8Kc","user":{"login":"windhamwong","id":677625,"node_id":"MDQ6VXNlcjY3NzYyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/677625?v=4","gravatar_id":"","url":"https://api.github.com/users/windhamwong","html_url":"https://github.com/windhamwong","followers_url":"https://api.github.com/users/windhamwong/followers","following_url":"https://api.github.com/users/windhamwong/following{/other_user}","gists_url":"https://api.github.com/users/windhamwong/gists{/gist_id}","starred_url":"https://api.github.com/users/windhamwong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/windhamwong/subscriptions","organizations_url":"https://api.github.com/users/windhamwong/orgs","repos_url":"https://api.github.com/users/windhamwong/repos","events_url":"https://api.github.com/users/windhamwong/events{/privacy}","received_events_url":"https://api.github.com/users/windhamwong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-10T05:19:05Z","updated_at":"2021-12-10T05:19:05Z","author_association":"CONTRIBUTOR","body":"Tested and deployed. I can see the issue has been fixed from the issue I created https://github.com/apache/incubator-heron/issues/3745\r\n","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/990626460/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/995006303","html_url":"https://github.com/apache/incubator-heron/pull/3747#issuecomment-995006303","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3747","id":995006303,"node_id":"IC_kwDOApKMps47Tpdf","user":{"login":"joshfischer1108","id":5785700,"node_id":"MDQ6VXNlcjU3ODU3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/5785700?v=4","gravatar_id":"","url":"https://api.github.com/users/joshfischer1108","html_url":"https://github.com/joshfischer1108","followers_url":"https://api.github.com/users/joshfischer1108/followers","following_url":"https://api.github.com/users/joshfischer1108/following{/other_user}","gists_url":"https://api.github.com/users/joshfischer1108/gists{/gist_id}","starred_url":"https://api.github.com/users/joshfischer1108/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joshfischer1108/subscriptions","organizations_url":"https://api.github.com/users/joshfischer1108/orgs","repos_url":"https://api.github.com/users/joshfischer1108/repos","events_url":"https://api.github.com/users/joshfischer1108/events{/privacy}","received_events_url":"https://api.github.com/users/joshfischer1108/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-15T17:26:56Z","updated_at":"2021-12-15T17:26:56Z","author_association":"MEMBER","body":"Ping @nwangtw @nicknezis @windhamwong @nlu90 @huijunw . Please review if you can.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/995006303/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/995022662","html_url":"https://github.com/apache/incubator-heron/pull/3747#issuecomment-995022662","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3747","id":995022662,"node_id":"IC_kwDOApKMps47TtdG","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-15T17:47:44Z","updated_at":"2021-12-15T17:47:44Z","author_association":"MEMBER","body":"@nicknezis when you have some free time, please review. I think this might have been some functionality you needed.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/995022662/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/997027240","html_url":"https://github.com/apache/incubator-heron/pull/3747#issuecomment-997027240","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3747","id":997027240,"node_id":"IC_kwDOApKMps47bW2o","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-17T20:57:39Z","updated_at":"2021-12-17T20:57:39Z","author_association":"MEMBER","body":"The most recent merge does not change any functionality. It only updates logging in the constructor of the `V1Controller` to indicate warnings for Pod Template and Volume configuration enabled/disabled.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/997027240/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/997299936","html_url":"https://github.com/apache/incubator-heron/issues/3745#issuecomment-997299936","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3745","id":997299936,"node_id":"IC_kwDOApKMps47cZbg","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-18T23:36:19Z","updated_at":"2021-12-18T23:36:19Z","author_association":"CONTRIBUTOR","body":"It looks like we added anticrlf to heron-shell for security reasons in this\nPR. https://github.com/apache/incubator-heron/pull/3718\n\nBut then removed it here 10 days ago:\nhttps://github.com/apache/incubator-heron/pull/3746\n\nIs the desire to have the library used? The fix might be to add the proper\nPython dependency (as opposed to reverting the security fix). Looks like\nthis is the library. I'll try adding to the BUILD file as a dependency and\ntest. https://pypi.org/project/logging-formatter-anticrlf/#history\n\nWhat do you guys think? Just wanted to make sure we're all on the same page\nwith this.\n\nOn Fri, Dec 10, 2021 at 6:05 AM Josh Fischer ***@***.***>\nwrote:\n\n> Closed #3745 <https://github.com/apache/incubator-heron/issues/3745> via\n> #3746 <https://github.com/apache/incubator-heron/pull/3746>.\n>\n> —\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/incubator-heron/issues/3745#event-5747030181>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AABMNKXULWLU5S4E7LW4JODUQHNGVANCNFSM5JVY44KA>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/997299936/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/997303062","html_url":"https://github.com/apache/incubator-heron/issues/3745#issuecomment-997303062","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3745","id":997303062,"node_id":"IC_kwDOApKMps47caMW","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-19T00:07:40Z","updated_at":"2021-12-19T00:07:40Z","author_association":"CONTRIBUTOR","body":"I fixed the issue in this PR.\nhttps://github.com/apache/incubator-heron/pull/3749/files\n\nNick\n\nOn Sat, Dec 18, 2021 at 6:36 PM Nicholas Nezis ***@***.***>\nwrote:\n\n> It looks like we added anticrlf to heron-shell for security reasons in\n> this PR. https://github.com/apache/incubator-heron/pull/3718\n>\n> But then removed it here 10 days ago:\n> https://github.com/apache/incubator-heron/pull/3746\n>\n> Is the desire to have the library used? The fix might be to add the proper\n> Python dependency (as opposed to reverting the security fix). Looks like\n> this is the library. I'll try adding to the BUILD file as a dependency and\n> test. https://pypi.org/project/logging-formatter-anticrlf/#history\n>\n> What do you guys think? Just wanted to make sure we're all on the same\n> page with this.\n>\n> On Fri, Dec 10, 2021 at 6:05 AM Josh Fischer ***@***.***>\n> wrote:\n>\n>> Closed #3745 <https://github.com/apache/incubator-heron/issues/3745> via\n>> #3746 <https://github.com/apache/incubator-heron/pull/3746>.\n>>\n>> —\n>> You are receiving this because you are subscribed to this thread.\n>> Reply to this email directly, view it on GitHub\n>> <https://github.com/apache/incubator-heron/issues/3745#event-5747030181>,\n>> or unsubscribe\n>> <https://github.com/notifications/unsubscribe-auth/AABMNKXULWLU5S4E7LW4JODUQHNGVANCNFSM5JVY44KA>\n>> .\n>>\n>\n","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/997303062/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/997319556","html_url":"https://github.com/apache/incubator-heron/pull/3747#issuecomment-997319556","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3747","id":997319556,"node_id":"IC_kwDOApKMps47ceOE","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-19T02:44:41Z","updated_at":"2021-12-19T02:44:41Z","author_association":"CONTRIBUTOR","body":"Tested both EmptyDir and HostPath. I didn't test NFS, but the logic is all similar so I'm very confident that it will work similarly to the other two new options. Thank you for these awesome additions!","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/997319556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/997320730","html_url":"https://github.com/apache/incubator-heron/pull/3747#issuecomment-997320730","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3747","id":997320730,"node_id":"IC_kwDOApKMps47cega","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-19T02:58:38Z","updated_at":"2021-12-19T02:58:38Z","author_association":"MEMBER","body":"You are most welcome and thank you for taking the time to test and review these @nicknezis and @joshfischer1108. I shall wait till tomorrow evening to merge. I do not think there is a need for me to rebase this atop #3749, the merges should interleave the changes from the two PRs.\r\n\r\nI am going to bring in a documentation notice update into this PR with warning information on the `Host Path` - there will be no functional changes in the merge.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/997320730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/997325092","html_url":"https://github.com/apache/incubator-heron/pull/3749#issuecomment-997325092","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3749","id":997325092,"node_id":"IC_kwDOApKMps47cfkk","user":{"login":"windhamwong","id":677625,"node_id":"MDQ6VXNlcjY3NzYyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/677625?v=4","gravatar_id":"","url":"https://api.github.com/users/windhamwong","html_url":"https://github.com/windhamwong","followers_url":"https://api.github.com/users/windhamwong/followers","following_url":"https://api.github.com/users/windhamwong/following{/other_user}","gists_url":"https://api.github.com/users/windhamwong/gists{/gist_id}","starred_url":"https://api.github.com/users/windhamwong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/windhamwong/subscriptions","organizations_url":"https://api.github.com/users/windhamwong/orgs","repos_url":"https://api.github.com/users/windhamwong/repos","events_url":"https://api.github.com/users/windhamwong/events{/privacy}","received_events_url":"https://api.github.com/users/windhamwong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-19T03:53:36Z","updated_at":"2021-12-19T03:53:36Z","author_association":"CONTRIBUTOR","body":"Looks good as it fixes the issue mentioned in #3746. ","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/997325092/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1000938003","html_url":"https://github.com/apache/incubator-heron/issues/3021#issuecomment-1000938003","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3021","id":1000938003,"node_id":"IC_kwDOApKMps47qRoT","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-24T21:58:56Z","updated_at":"2021-12-24T21:58:56Z","author_association":"CONTRIBUTOR","body":"This has been resolved.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1000938003/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1003498609","html_url":"https://github.com/apache/incubator-heron/pull/3642#issuecomment-1003498609","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3642","id":1003498609,"node_id":"IC_kwDOApKMps470Cxx","user":{"login":"joshfischer1108","id":5785700,"node_id":"MDQ6VXNlcjU3ODU3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/5785700?v=4","gravatar_id":"","url":"https://api.github.com/users/joshfischer1108","html_url":"https://github.com/joshfischer1108","followers_url":"https://api.github.com/users/joshfischer1108/followers","following_url":"https://api.github.com/users/joshfischer1108/following{/other_user}","gists_url":"https://api.github.com/users/joshfischer1108/gists{/gist_id}","starred_url":"https://api.github.com/users/joshfischer1108/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joshfischer1108/subscriptions","organizations_url":"https://api.github.com/users/joshfischer1108/orgs","repos_url":"https://api.github.com/users/joshfischer1108/repos","events_url":"https://api.github.com/users/joshfischer1108/events{/privacy}","received_events_url":"https://api.github.com/users/joshfischer1108/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-01T04:01:49Z","updated_at":"2022-01-01T04:01:49Z","author_association":"MEMBER","body":"> I rebased this after seeing a PR went in for python 3.8 support, but it looks like the properly supported version isn't that high yet.\r\n> \r\n> There's still the issue of requiring python 3.7+ for this PR. I don't have the time to go through and update and test all of the Docker images which would get this in a good place for testing.\r\n\r\nDo you think the work done on this branch is worth one of us following up on to fix the Mac OS build issues related to pex?","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1003498609/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1003768672","html_url":"https://github.com/apache/incubator-heron/pull/3642#issuecomment-1003768672","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3642","id":1003768672,"node_id":"IC_kwDOApKMps471Etg","user":{"login":"Code0x58","id":9309570,"node_id":"MDQ6VXNlcjkzMDk1NzA=","avatar_url":"https://avatars.githubusercontent.com/u/9309570?v=4","gravatar_id":"","url":"https://api.github.com/users/Code0x58","html_url":"https://github.com/Code0x58","followers_url":"https://api.github.com/users/Code0x58/followers","following_url":"https://api.github.com/users/Code0x58/following{/other_user}","gists_url":"https://api.github.com/users/Code0x58/gists{/gist_id}","starred_url":"https://api.github.com/users/Code0x58/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Code0x58/subscriptions","organizations_url":"https://api.github.com/users/Code0x58/orgs","repos_url":"https://api.github.com/users/Code0x58/repos","events_url":"https://api.github.com/users/Code0x58/events{/privacy}","received_events_url":"https://api.github.com/users/Code0x58/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-02T20:11:05Z","updated_at":"2022-01-02T20:11:05Z","author_association":"CONTRIBUTOR","body":"> Do you think the work done on this branch is worth one of us following up on to fix the Mac OS build issues related to pex?\r\n\r\nIf the core bazel rules required a newer version of Python then that would be a separate line of work to this, which would unblock this PR. I haven't checked in on it so no idea if an upgrade would be needed for it, but could hope not, or that at least it would be apparently very early on from reading bazel's docs.\r\n\r\nI don't think there's anything in this PR as is which would help the migration to drop the PEX rules. The closest I can imagine is that this PR is towards removing the last of the `tornado` requirements, but that shouldn't matter.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1003768672/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1004230699","html_url":"https://github.com/apache/incubator-heron/pull/3751#issuecomment-1004230699","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3751","id":1004230699,"node_id":"IC_kwDOApKMps4721gr","user":{"login":"joshfischer1108","id":5785700,"node_id":"MDQ6VXNlcjU3ODU3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/5785700?v=4","gravatar_id":"","url":"https://api.github.com/users/joshfischer1108","html_url":"https://github.com/joshfischer1108","followers_url":"https://api.github.com/users/joshfischer1108/followers","following_url":"https://api.github.com/users/joshfischer1108/following{/other_user}","gists_url":"https://api.github.com/users/joshfischer1108/gists{/gist_id}","starred_url":"https://api.github.com/users/joshfischer1108/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joshfischer1108/subscriptions","organizations_url":"https://api.github.com/users/joshfischer1108/orgs","repos_url":"https://api.github.com/users/joshfischer1108/repos","events_url":"https://api.github.com/users/joshfischer1108/events{/privacy}","received_events_url":"https://api.github.com/users/joshfischer1108/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T17:08:14Z","updated_at":"2022-01-26T18:27:32Z","author_association":"MEMBER","body":"Steps to completion: **Not exhaustive**\r\n- [x] Add native python rules to workspace\r\n- [x] Update docker rules because of a deprecated pip_import dependency \r\n- [ ] Remove pex rules from the project\r\n- [ ] Add requirements.txt to support all of the python dependencies for the project.  This is only a first pass to loading python deps.  After the initial migration is done we can lazily load python deps for improved build times, if desired\r\n- [x] Remove tools/rules/newgenproto.bzl file as  it seems to be a duplicate.\r\n- [ ] Swap out pex_library  with native py_libray rules \r\n- [ ] and pex_binary with native py_binary rules\r\n- [ ] Investigate the use of starlark to replace python build scripts\r\n- [ ] Investigate the use for py_proto_libaries  from google https://thethoughtfulkoala.com/posts/2020/05/08/py-protobuf-bazel.html\r\n- [ ] `pex_binary` has a number of rules which do not translate over to `py_binary`: `resources`, `zip_safe`. We need to find an alternative to these.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1004230699/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1004288124","html_url":"https://github.com/apache/incubator-heron/pull/3754#issuecomment-1004288124","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3754","id":1004288124,"node_id":"IC_kwDOApKMps473Dh8","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T18:53:41Z","updated_at":"2022-01-03T18:53:41Z","author_association":"MEMBER","body":"This is good work. I believe it is vital that all of our dependencies live as close to `HEAD` of their respective repos as possible. Please ping when it is ready for review.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1004288124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1004303390","html_url":"https://github.com/apache/incubator-heron/pull/3755#issuecomment-1004303390","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3755","id":1004303390,"node_id":"IC_kwDOApKMps473HQe","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T19:21:09Z","updated_at":"2022-01-03T19:21:09Z","author_association":"CONTRIBUTOR","body":"Will merge once #3753 is merged.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1004303390/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1004338500","html_url":"https://github.com/apache/incubator-heron/pull/3755#issuecomment-1004338500","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3755","id":1004338500,"node_id":"IC_kwDOApKMps473P1E","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T20:25:51Z","updated_at":"2022-01-03T20:25:51Z","author_association":"CONTRIBUTOR","body":"Update is similar to the one found here: https://github.com/apache/bookkeeper/pull/2951","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1004338500/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1004343101","html_url":"https://github.com/apache/incubator-heron/pull/3756#issuecomment-1004343101","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3756","id":1004343101,"node_id":"IC_kwDOApKMps473Q89","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T20:34:53Z","updated_at":"2022-01-03T20:34:53Z","author_association":"CONTRIBUTOR","body":"Fixes #3698","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1004343101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1004351394","html_url":"https://github.com/apache/incubator-heron/pull/3751#issuecomment-1004351394","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3751","id":1004351394,"node_id":"IC_kwDOApKMps473S-i","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T20:52:34Z","updated_at":"2022-01-03T20:53:19Z","author_association":"CONTRIBUTOR","body":"If we are removing all use of pex, we will need to ensure we can still Launch HeronPy topologies. The Heron Executor code currently decides which binary type based on file extension. The logic in this file will need to be updated based on these changes. https://github.com/apache/incubator-heron/blob/fab089ce2c9cdbdd2d6a7ef7cda6cf22b201469c/heron/executor/src/python/heron_executor.py#L788-L795","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1004351394/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1004823779","html_url":"https://github.com/apache/incubator-heron/pull/3753#issuecomment-1004823779","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3753","id":1004823779,"node_id":"IC_kwDOApKMps475GTj","user":{"login":"joshfischer1108","id":5785700,"node_id":"MDQ6VXNlcjU3ODU3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/5785700?v=4","gravatar_id":"","url":"https://api.github.com/users/joshfischer1108","html_url":"https://github.com/joshfischer1108","followers_url":"https://api.github.com/users/joshfischer1108/followers","following_url":"https://api.github.com/users/joshfischer1108/following{/other_user}","gists_url":"https://api.github.com/users/joshfischer1108/gists{/gist_id}","starred_url":"https://api.github.com/users/joshfischer1108/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joshfischer1108/subscriptions","organizations_url":"https://api.github.com/users/joshfischer1108/orgs","repos_url":"https://api.github.com/users/joshfischer1108/repos","events_url":"https://api.github.com/users/joshfischer1108/events{/privacy}","received_events_url":"https://api.github.com/users/joshfischer1108/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T13:45:27Z","updated_at":"2022-01-04T13:45:27Z","author_association":"MEMBER","body":"Did you mean to delete the `maven_install.json`?  We don't have how this plugin works for Heron documented anywhere. Could you add something quick to the instructions on compiling Heron in the website so we don't lose track of this process/tool?","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1004823779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1004825578","html_url":"https://github.com/apache/incubator-heron/pull/3750#issuecomment-1004825578","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3750","id":1004825578,"node_id":"IC_kwDOApKMps475Gvq","user":{"login":"joshfischer1108","id":5785700,"node_id":"MDQ6VXNlcjU3ODU3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/5785700?v=4","gravatar_id":"","url":"https://api.github.com/users/joshfischer1108","html_url":"https://github.com/joshfischer1108","followers_url":"https://api.github.com/users/joshfischer1108/followers","following_url":"https://api.github.com/users/joshfischer1108/following{/other_user}","gists_url":"https://api.github.com/users/joshfischer1108/gists{/gist_id}","starred_url":"https://api.github.com/users/joshfischer1108/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joshfischer1108/subscriptions","organizations_url":"https://api.github.com/users/joshfischer1108/orgs","repos_url":"https://api.github.com/users/joshfischer1108/repos","events_url":"https://api.github.com/users/joshfischer1108/events{/privacy}","received_events_url":"https://api.github.com/users/joshfischer1108/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T13:47:51Z","updated_at":"2022-01-04T13:47:51Z","author_association":"MEMBER","body":"@nwangtw is this ready to be reviewed?","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1004825578/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1004955471","html_url":"https://github.com/apache/incubator-heron/pull/3753#issuecomment-1004955471","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3753","id":1004955471,"node_id":"IC_kwDOApKMps475mdP","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T16:28:57Z","updated_at":"2022-01-04T16:28:57Z","author_association":"CONTRIBUTOR","body":"> Did you mean to delete the `maven_install.json`? We don't have how this plugin works for Heron documented anywhere. Could you add something quick to the instructions on compiling Heron in the website so we don't lose track of this process/tool?\r\n\r\nI didn't delete it. Only refreshed it with the newer version of the `rules_jvm_external` build tool. I think the logic for how dependencies are ordered changed, so that caused lots of changes in the json file. But that should be a one time change due to the newer build tool. \r\n\r\nGeneral information about the pinning is here: https://github.com/bazelbuild/rules_jvm_external#pinning-artifacts-and-integration-with-bazels-downloader\r\n\r\nWith this updated version, if anyone ever updates the dependency list and doesn't repin, it will actually fail to compile and give the documentation in the console output for how to refresh.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1004955471/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1005002359","html_url":"https://github.com/apache/incubator-heron/pull/3753#issuecomment-1005002359","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3753","id":1005002359,"node_id":"IC_kwDOApKMps475x53","user":{"login":"joshfischer1108","id":5785700,"node_id":"MDQ6VXNlcjU3ODU3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/5785700?v=4","gravatar_id":"","url":"https://api.github.com/users/joshfischer1108","html_url":"https://github.com/joshfischer1108","followers_url":"https://api.github.com/users/joshfischer1108/followers","following_url":"https://api.github.com/users/joshfischer1108/following{/other_user}","gists_url":"https://api.github.com/users/joshfischer1108/gists{/gist_id}","starred_url":"https://api.github.com/users/joshfischer1108/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joshfischer1108/subscriptions","organizations_url":"https://api.github.com/users/joshfischer1108/orgs","repos_url":"https://api.github.com/users/joshfischer1108/repos","events_url":"https://api.github.com/users/joshfischer1108/events{/privacy}","received_events_url":"https://api.github.com/users/joshfischer1108/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T17:00:52Z","updated_at":"2022-01-04T17:00:52Z","author_association":"MEMBER","body":"> > Did you mean to delete the `maven_install.json`? We don't have how this plugin works for Heron documented anywhere. Could you add something quick to the instructions on compiling Heron in the website so we don't lose track of this process/tool?\r\n> \r\n> I didn't delete it. Only refreshed it with the newer version of the `rules_jvm_external` build tool. I think the logic for how dependencies are ordered changed, so that caused lots of changes in the json file. But that should be a one time change due to the newer build tool.\r\n> \r\n> General information about the pinning is here: https://github.com/bazelbuild/rules_jvm_external#pinning-artifacts-and-integration-with-bazels-downloader\r\n> \r\n> With this updated version, if anyone ever updates the dependency list and doesn't repin, it will actually fail to compile and give the documentation in the console output for how to refresh.\r\n\r\nSweet, sounds good.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1005002359/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1005093921","html_url":"https://github.com/apache/incubator-heron/pull/3754#issuecomment-1005093921","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3754","id":1005093921,"node_id":"IC_kwDOApKMps476IQh","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T19:07:37Z","updated_at":"2022-01-04T19:13:51Z","author_association":"CONTRIBUTOR","body":"> This is good work. I believe it is vital that all of our dependencies live as close to `HEAD` of their respective repos as possible. Please ping when it is ready for review.\r\n\r\nOk, rebased off of the new `master` branch. Updated the pinned dependencies. I think this is ready for testing. \r\n\r\nFYI, the unit tests you added already helped catch a build issue with this update. We had `org.yaml:snakeyaml` explicitly defined. The older version didn't work. I updated to the latest `1.30`. But I also tried removing the explicit dependency and it resolved to `1.29`. I'm leaning towards removing the entry and letting the Maven dependency info drive which version is selected. This might be better for maintaining going forward. If you agree, I'll remove the mention of `snakeyml` in the dependencies list. \r\n\r\nI believe there are other dependencies listed that no longer need to be listed. They were in the list before we had actual transitive dependency resolution logic helping us.\r\n\r\n_Edit: I talked myself into it. I removed the direct mention of snakeyml dependency._","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1005093921/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1005137197","html_url":"https://github.com/apache/incubator-heron/pull/3754#issuecomment-1005137197","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3754","id":1005137197,"node_id":"IC_kwDOApKMps476S0t","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T20:13:39Z","updated_at":"2022-01-04T20:13:39Z","author_association":"MEMBER","body":"> Ok, rebased off of the new `master` branch. Updated the pinned dependencies. I think this is ready for testing.\r\n\r\n👍🏼 \r\n\r\n> FYI, the unit tests you added already helped catch a build issue with this update. We had `org.yaml:snakeyaml` explicitly defined. The older version didn't work. I updated to the latest `1.30`. But I also tried removing the explicit dependency and it resolved to `1.29`. I'm leaning towards removing the entry and letting the Maven dependency info drive which version is selected. This might be better for maintaining going forward. If you agree, I'll remove the mention of `snakeyml` in the dependencies list.\r\n\r\nGlad they are catching issues before they make their way into production.\r\n\r\n> I believe there are other dependencies listed that no longer need to be listed. They were in the list before we had actual transitive dependency resolution logic helping us.\r\n> \r\n> _Edit: I talked myself into it. I removed the direct mention of snakeyml dependency._\r\n\r\nGood move, hardcoded dependencies can get forgotten over time.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1005137197/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1005170521","html_url":"https://github.com/apache/incubator-heron/pull/3754#issuecomment-1005170521","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3754","id":1005170521,"node_id":"IC_kwDOApKMps476a9Z","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T21:06:38Z","updated_at":"2022-01-04T21:06:38Z","author_association":"MEMBER","body":"A quick deployment test is looking good.\r\n\r\n<details><summary>Command</summary>\r\n\r\n```bash\r\n~/bin/heron submit kubernetes ~/.heron/examples/heron-api-examples.jar \\\r\norg.apache.heron.examples.api.AckingTopology acking \\\r\n--verbose \\\r\n--deploy-deactivated \\\r\n--config-property heron.kubernetes.executor.pod.template=pod-templ-executor.pod-template-executor.yaml \\\r\n--config-property heron.kubernetes.manager.pod.template=pod-templ-manager.pod-template-manager.yaml \\\r\n--config-property heron.kubernetes.manager.limits.cpu=2 \\\r\n--config-property heron.kubernetes.manager.limits.memory=3 \\\r\n--config-property heron.kubernetes.manager.requests.cpu=1 \\\r\n--config-property heron.kubernetes.manager.requests.memory=2 \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.claimName=OnDemand \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.storageClassName=storage-class-name-manager \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.accessModes=ReadWriteOnce,ReadOnlyMany \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.sizeLimit=256Gi \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.volumeMode=Block \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.path=path/to/mount/dynamic/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-dynamic-volume.subPath=sub/path/to/mount/dynamic/volume \\\r\n\\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.claimName=OnDemand \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.accessModes=ReadWriteOnce,ReadOnlyMany \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.sizeLimit=512Gi \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.volumeMode=Block \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.path=path/to/mount/static/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-static-volume.subPath=sub/path/to/mount/static/volume \\\r\n\\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-shared-volume.claimName=requested-claim-by-user \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-shared-volume.path=path/to/mount/shared/volume \\\r\n--config-property heron.kubernetes.manager.volumes.persistentVolumeClaim.manager-shared-volume.subPath=sub/path/to/mount/shared/volume \\\r\n\\\r\n--config-property heron.kubernetes.manager.volumes.emptyDir.manager-empty-dir.medium=\"Memory\" \\\r\n--config-property heron.kubernetes.manager.volumes.emptyDir.manager-empty-dir.sizeLimit=\"50Mi\" \\\r\n--config-property heron.kubernetes.manager.volumes.emptyDir.manager-empty-dir.path=\"empty/dir/path\" \\\r\n--config-property heron.kubernetes.manager.volumes.emptyDir.manager-empty-dir.subPath=\"empty/dir/sub/path\" \\\r\n--config-property heron.kubernetes.manager.volumes.emptyDir.manager-empty-dir.readOnly=\"true\" \\\r\n\\\r\n--config-property heron.kubernetes.manager.volumes.hostPath.manager-host-path.type=\"File\" \\\r\n--config-property heron.kubernetes.manager.volumes.hostPath.manager-host-path.pathOnHost=\"/dev/null\" \\\r\n--config-property heron.kubernetes.manager.volumes.hostPath.manager-host-path.path=\"host/path/path\" \\\r\n--config-property heron.kubernetes.manager.volumes.hostPath.manager-host-path.subPath=\"host/path/sub/path\" \\\r\n--config-property heron.kubernetes.manager.volumes.hostPath.manager-host-path.readOnly=\"true\" \\\r\n\\\r\n--config-property heron.kubernetes.manager.volumes.nfs.manager-nfs.server=\"nfs-server.address\" \\\r\n--config-property heron.kubernetes.manager.volumes.nfs.manager-nfs.readOnly=\"true\" \\\r\n--config-property heron.kubernetes.manager.volumes.nfs.manager-nfs.pathOnNFS=\"/dev/null\" \\\r\n--config-property heron.kubernetes.manager.volumes.nfs.manager-nfs.path=\"nfs/path\" \\\r\n--config-property heron.kubernetes.manager.volumes.nfs.manager-nfs.subPath=\"nfs/sub/path\" \\\r\n--config-property heron.kubernetes.manager.volumes.nfs.manager-nfs.readOnly=\"true\" \\\r\n\\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.claimName=OnDemand \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.storageClassName=storage-class-name-executor \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.accessModes=ReadWriteOnce,ReadOnlyMany \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.sizeLimit=256Gi \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.volumeMode=Block \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.path=path/to/mount/dynamic/volume \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-dynamic-volume.subPath=sub/path/to/mount/dynamic/volume \\\r\n\\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.claimName=OnDemand \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.accessModes=ReadWriteOnce,ReadOnlyMany \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.sizeLimit=512Gi \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.volumeMode=Block \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.path=path/to/mount/static/volume \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-static-volume.subPath=sub/path/to/mount/static/volume \\\r\n\\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-shared-volume.claimName=requested-claim-by-user \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-shared-volume.path=path/to/mount/shared/volume \\\r\n--config-property heron.kubernetes.executor.volumes.persistentVolumeClaim.executor-shared-volume.subPath=sub/path/to/mount/shared/volume\r\n\r\n```\r\n</details>\r\n\r\n<details><summary>Manager StatefulSet</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2022-01-04T21:01:46Z\"\r\n  generation: 1\r\n  labels:\r\n    app: heron\r\n    topology: acking\r\n  name: acking-manager\r\n  namespace: default\r\n  resourceVersion: \"1191\"\r\n  uid: 5264a3f3-31dc-4c2c-8569-7694f976bcb8\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 1\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0-3635085685723437434.tar.gz\r\n          . && SHARD_ID=${POD_NAME##*-} && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=acking41dee1a2-d44e-4fa3-a7de-a8084d5cdeb2\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        - name: var_one_manager\r\n          value: variable one on manager\r\n        - name: var_three_manager\r\n          value: variable three on manager\r\n        - name: var_two_manager\r\n          value: variable two on manager\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: manager\r\n        ports:\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        - containerPort: 7775\r\n          name: tcp-port-kept\r\n          protocol: TCP\r\n        - containerPort: 7776\r\n          name: udp-port-kept\r\n          protocol: UDP\r\n        resources:\r\n          limits:\r\n            cpu: \"2\"\r\n            memory: \"3\"\r\n          requests:\r\n            cpu: \"1\"\r\n            memory: \"2\"\r\n        securityContext:\r\n          allowPrivilegeEscalation: false\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: path/to/mount/dynamic/volume\r\n          name: manager-dynamic-volume\r\n          subPath: sub/path/to/mount/dynamic/volume\r\n        - mountPath: empty/dir/path\r\n          name: manager-empty-dir\r\n          readOnly: true\r\n          subPath: empty/dir/sub/path\r\n        - mountPath: host/path/path\r\n          name: manager-host-path\r\n          readOnly: true\r\n          subPath: host/path/sub/path\r\n        - mountPath: nfs/path\r\n          name: manager-nfs\r\n          readOnly: true\r\n          subPath: nfs/sub/path\r\n        - mountPath: path/to/mount/shared/volume\r\n          name: manager-shared-volume\r\n          subPath: sub/path/to/mount/shared/volume\r\n        - mountPath: path/to/mount/static/volume\r\n          name: manager-static-volume\r\n          subPath: sub/path/to/mount/static/volume\r\n        - mountPath: /shared_volume/manager\r\n          name: shared-volume-manager\r\n      - image: alpine\r\n        imagePullPolicy: Always\r\n        name: manager-sidecar-container\r\n        resources: {}\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: /shared_volume/manager\r\n          name: shared-volume-manager\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      volumes:\r\n      - emptyDir:\r\n          medium: Memory\r\n          sizeLimit: 50Mi\r\n        name: manager-empty-dir\r\n      - hostPath:\r\n          path: /dev/null\r\n          type: File\r\n        name: manager-host-path\r\n      - name: manager-nfs\r\n        nfs:\r\n          path: /dev/null\r\n          readOnly: true\r\n          server: nfs-server.address\r\n      - name: manager-shared-volume\r\n        persistentVolumeClaim:\r\n          claimName: requested-claim-by-user\r\n      - emptyDir: {}\r\n        name: shared-volume-manager\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\n  volumeClaimTemplates:\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: manager-static-volume\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 512Gi\r\n      storageClassName: \"\"\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: manager-dynamic-volume\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 256Gi\r\n      storageClassName: storage-class-name-manager\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\nstatus:\r\n  collisionCount: 0\r\n  currentReplicas: 1\r\n  currentRevision: acking-manager-64b467867b\r\n  observedGeneration: 1\r\n  replicas: 1\r\n  updateRevision: acking-manager-64b467867b\r\n  updatedReplicas: 1\r\n```\r\n</details>\r\n\r\n<details><summary>Executor StatefulSet</summary>\r\n\r\n```yaml\r\napiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  creationTimestamp: \"2022-01-04T21:01:46Z\"\r\n  generation: 1\r\n  labels:\r\n    app: heron\r\n    topology: acking\r\n  name: acking-executors\r\n  namespace: default\r\n  resourceVersion: \"1201\"\r\n  uid: 7df2b51e-30a3-4464-9a41-c0d9cb1a1649\r\nspec:\r\n  podManagementPolicy: Parallel\r\n  replicas: 2\r\n  revisionHistoryLimit: 10\r\n  selector:\r\n    matchLabels:\r\n      app: heron\r\n      topology: acking\r\n  serviceName: acking\r\n  template:\r\n    metadata:\r\n      annotations:\r\n        prometheus.io/port: \"8080\"\r\n        prometheus.io/scrape: \"true\"\r\n      creationTimestamp: null\r\n      labels:\r\n        app: heron\r\n        topology: acking\r\n    spec:\r\n      containers:\r\n      - command:\r\n        - sh\r\n        - -c\r\n        - './heron-core/bin/heron-downloader-config kubernetes && ./heron-core/bin/heron-downloader\r\n          distributedlog://zookeeper:2181/heronbkdl/acking-saad-tag-0-3635085685723437434.tar.gz\r\n          . && SHARD_ID=$((${POD_NAME##*-} + 1)) && echo shardId=${SHARD_ID} && ./heron-core/bin/heron-executor\r\n          --topology-name=acking --topology-id=acking41dee1a2-d44e-4fa3-a7de-a8084d5cdeb2\r\n          --topology-defn-file=acking.defn --state-manager-connection=zookeeper:2181\r\n          --state-manager-root=/heron --state-manager-config-file=./heron-conf/statemgr.yaml\r\n          --tmanager-binary=./heron-core/bin/heron-tmanager --stmgr-binary=./heron-core/bin/heron-stmgr\r\n          --metrics-manager-classpath=./heron-core/lib/metricsmgr/* --instance-jvm-opts=\"LVhYOitIZWFwRHVtcE9uT3V0T2ZNZW1vcnlFcnJvcg(61)(61)\"\r\n          --classpath=heron-api-examples.jar --heron-internals-config-file=./heron-conf/heron_internals.yaml\r\n          --override-config-file=./heron-conf/override.yaml --component-ram-map=exclaim1:1073741824,word:1073741824\r\n          --component-jvm-opts=\"\" --pkg-type=jar --topology-binary-file=heron-api-examples.jar\r\n          --heron-java-home=$JAVA_HOME --heron-shell-binary=./heron-core/bin/heron-shell\r\n          --cluster=kubernetes --role=saad --environment=default --instance-classpath=./heron-core/lib/instance/*\r\n          --metrics-sinks-config-file=./heron-conf/metrics_sinks.yaml --scheduler-classpath=./heron-core/lib/scheduler/*:./heron-core/lib/packing/*:./heron-core/lib/statemgr/*\r\n          --python-instance-binary=./heron-core/bin/heron-python-instance --cpp-instance-binary=./heron-core/bin/heron-cpp-instance\r\n          --metricscache-manager-classpath=./heron-core/lib/metricscachemgr/* --metricscache-manager-mode=disabled\r\n          --is-stateful=false --checkpoint-manager-classpath=./heron-core/lib/ckptmgr/*:./heron-core/lib/statefulstorage/*:\r\n          --stateful-config-file=./heron-conf/stateful.yaml --checkpoint-manager-ram=1073741824\r\n          --health-manager-mode=disabled --health-manager-classpath=./heron-core/lib/healthmgr/*\r\n          --shard=$SHARD_ID --server-port=6001 --tmanager-controller-port=6002 --tmanager-stats-port=6003\r\n          --shell-port=6004 --metrics-manager-port=6005 --scheduler-port=6006 --metricscache-manager-server-port=6007\r\n          --metricscache-manager-stats-port=6008 --checkpoint-manager-port=6009'\r\n        env:\r\n        - name: HOST\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: status.podIP\r\n        - name: POD_NAME\r\n          valueFrom:\r\n            fieldRef:\r\n              apiVersion: v1\r\n              fieldPath: metadata.name\r\n        - name: var_one\r\n          value: variable one\r\n        - name: var_three\r\n          value: variable three\r\n        - name: var_two\r\n          value: variable two\r\n        image: apache/heron:testbuild\r\n        imagePullPolicy: IfNotPresent\r\n        name: executor\r\n        ports:\r\n        - containerPort: 5555\r\n          name: tcp-port-kept\r\n          protocol: TCP\r\n        - containerPort: 5556\r\n          name: udp-port-kept\r\n          protocol: UDP\r\n        - containerPort: 6001\r\n          name: server\r\n          protocol: TCP\r\n        - containerPort: 6002\r\n          name: tmanager-ctl\r\n          protocol: TCP\r\n        - containerPort: 6003\r\n          name: tmanager-stats\r\n          protocol: TCP\r\n        - containerPort: 6004\r\n          name: shell-port\r\n          protocol: TCP\r\n        - containerPort: 6005\r\n          name: metrics-mgr\r\n          protocol: TCP\r\n        - containerPort: 6006\r\n          name: scheduler\r\n          protocol: TCP\r\n        - containerPort: 6007\r\n          name: metrics-cache-m\r\n          protocol: TCP\r\n        - containerPort: 6008\r\n          name: metrics-cache-s\r\n          protocol: TCP\r\n        - containerPort: 6009\r\n          name: ckptmgr\r\n          protocol: TCP\r\n        resources:\r\n          limits:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n          requests:\r\n            cpu: \"3\"\r\n            memory: 4Gi\r\n        securityContext:\r\n          allowPrivilegeEscalation: false\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: path/to/mount/dynamic/volume\r\n          name: executor-dynamic-volume\r\n          subPath: sub/path/to/mount/dynamic/volume\r\n        - mountPath: path/to/mount/shared/volume\r\n          name: executor-shared-volume\r\n          subPath: sub/path/to/mount/shared/volume\r\n        - mountPath: path/to/mount/static/volume\r\n          name: executor-static-volume\r\n          subPath: sub/path/to/mount/static/volume\r\n        - mountPath: /shared_volume\r\n          name: shared-volume\r\n      - image: alpine\r\n        imagePullPolicy: Always\r\n        name: sidecar-container\r\n        resources: {}\r\n        terminationMessagePath: /dev/termination-log\r\n        terminationMessagePolicy: File\r\n        volumeMounts:\r\n        - mountPath: /shared_volume\r\n          name: shared-volume\r\n      dnsPolicy: ClusterFirst\r\n      restartPolicy: Always\r\n      schedulerName: default-scheduler\r\n      securityContext: {}\r\n      terminationGracePeriodSeconds: 0\r\n      tolerations:\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/not-ready\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      - effect: NoExecute\r\n        key: node.kubernetes.io/unreachable\r\n        operator: Exists\r\n        tolerationSeconds: 10\r\n      volumes:\r\n      - name: executor-shared-volume\r\n        persistentVolumeClaim:\r\n          claimName: requested-claim-by-user\r\n      - emptyDir: {}\r\n        name: shared-volume\r\n  updateStrategy:\r\n    rollingUpdate:\r\n      partition: 0\r\n    type: RollingUpdate\r\n  volumeClaimTemplates:\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: executor-dynamic-volume\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 256Gi\r\n      storageClassName: storage-class-name-executor\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\n  - apiVersion: v1\r\n    kind: PersistentVolumeClaim\r\n    metadata:\r\n      creationTimestamp: null\r\n      labels:\r\n        onDemand: \"true\"\r\n        topology: acking\r\n      name: executor-static-volume\r\n    spec:\r\n      accessModes:\r\n      - ReadWriteOnce\r\n      - ReadOnlyMany\r\n      resources:\r\n        requests:\r\n          storage: 512Gi\r\n      storageClassName: \"\"\r\n      volumeMode: Block\r\n    status:\r\n      phase: Pending\r\nstatus:\r\n  collisionCount: 0\r\n  currentReplicas: 2\r\n  currentRevision: acking-executors-5fdd677cf9\r\n  observedGeneration: 1\r\n  replicas: 2\r\n  updateRevision: acking-executors-5fdd677cf9\r\n  updatedReplicas: 2\r\n```\r\n</details>","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1005170521/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1005171350","html_url":"https://github.com/apache/incubator-heron/pull/3754#issuecomment-1005171350","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3754","id":1005171350,"node_id":"IC_kwDOApKMps476bKW","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T21:07:58Z","updated_at":"2022-01-04T21:07:58Z","author_association":"CONTRIBUTOR","body":"Awesome, thanks!","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1005171350/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1005217739","html_url":"https://github.com/apache/incubator-heron/pull/3755#issuecomment-1005217739","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3755","id":1005217739,"node_id":"IC_kwDOApKMps476mfL","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T22:27:41Z","updated_at":"2022-01-04T22:27:41Z","author_association":"MEMBER","body":"I had a quick look through the issue trackers for [4.1.71](https://github.com/netty/netty/issues?q=is%3Aclosed+milestone%3A4.1.71.Final) and [4.1.72](https://github.com/netty/netty/issues?page=1&q=is%3Aclosed+milestone%3A4.1.72.Final) and there should be no issues with the upgrade.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1005217739/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1014735165","html_url":"https://github.com/apache/incubator-heron/pull/3758#issuecomment-1014735165","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3758","id":1014735165,"node_id":"IC_kwDOApKMps48e6E9","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-17T16:56:22Z","updated_at":"2022-01-17T16:56:22Z","author_association":"MEMBER","body":"_For posterity:_\r\n\r\n> I tried to find a way to instruct Helm to leave the commented LICENSE header in the Chart.yaml, but it seems the Chart.yaml is always processed to a final form with no comments.\r\n\r\nAs per the conversation Nick initiated on dev@h.a.o on this issue, it is acceptable for a file that is generated or processed to not contain the ASF header. I also have been unable to find a way to work around the pre-processing performed server/client-side.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1014735165/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1014931142","html_url":"https://github.com/apache/incubator-heron/pull/3759#issuecomment-1014931142","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3759","id":1014931142,"node_id":"IC_kwDOApKMps48fp7G","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-17T22:38:08Z","updated_at":"2022-01-17T22:38:08Z","author_association":"MEMBER","body":"The first CI runs were failing with no output, even the `branch` CI. These are metadata changes and not functional. I restarted the `branch` and `PR` CIs without any changes and so far `branch` has passed.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1014931142/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1015896766","html_url":"https://github.com/apache/incubator-heron/pull/3646#issuecomment-1015896766","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3646","id":1015896766,"node_id":"IC_kwDOApKMps48jVq-","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-18T22:37:34Z","updated_at":"2022-01-18T22:37:34Z","author_association":"MEMBER","body":"The build containers are still running older versions of Python:\r\n\r\n```bash\r\n$ which python\r\n/opt/pyenv/shims/python\r\nThe command \"which python\" exited with 0.\r\n$ python -V\r\nPython 2.7.17\r\nThe command \"python -V\" exited with 0.\r\n$ which python3\r\n/opt/pyenv/shims/python3\r\nThe command \"which python3\" exited with 0.\r\n$ python3 -V\r\nPython 3.6.9\r\nThe command \"python3 -V\" exited with 0.\r\n```\r\nWe will probably need to update the base Dockerfiles here: https://github.com/apache/incubator-heron/tree/master/docker/compile\r\n\r\nhttps://github.com/apache/incubator-heron/blob/ee369ef7745df530c765e89d2e8a2eefc8d8b742/docker/compile/Dockerfile.ubuntu18.04#L23-L40","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1015896766/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1018887773","html_url":"https://github.com/apache/incubator-heron/issues/3762#issuecomment-1018887773","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3762","id":1018887773,"node_id":"IC_kwDOApKMps48uv5d","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T21:46:15Z","updated_at":"2022-01-21T21:46:15Z","author_association":"MEMBER","body":"I believe it would be a fairly quick fix to employ the bridge adapter in **_Option 1_**.\r\n\r\nI had a look at **_Option 2_** in the list and I could not find references to most of the mentioned functions. There are similarly named logging functions for Python but the logging backend for them is different. The two areas in **_Option 2_** that will raise issues:\r\n\r\n* `String concatenation like logger.info(\"hi \" + userName)`\r\n* `Calls to org.apache.log4j.Logger.setLevel() or similar methods`\r\n\r\nBecause of the line length cap at 80 (why? this max line length is a legacy from the punched card era), we have to split line lengths. I mostly used format strings because they are more efficient but there were places in the code where there was the use of concatenation.\r\n\r\nWe do set levels for logging, but this is mostly through a parameter to the log message function. I could not find a reference to the use of `setLevel` in the Java codebase.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1018887773/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1018892295","html_url":"https://github.com/apache/incubator-heron/pull/3760#issuecomment-1018892295","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3760","id":1018892295,"node_id":"IC_kwDOApKMps48uxAH","user":{"login":"nwangtw","id":6353055,"node_id":"MDQ6VXNlcjYzNTMwNTU=","avatar_url":"https://avatars.githubusercontent.com/u/6353055?v=4","gravatar_id":"","url":"https://api.github.com/users/nwangtw","html_url":"https://github.com/nwangtw","followers_url":"https://api.github.com/users/nwangtw/followers","following_url":"https://api.github.com/users/nwangtw/following{/other_user}","gists_url":"https://api.github.com/users/nwangtw/gists{/gist_id}","starred_url":"https://api.github.com/users/nwangtw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nwangtw/subscriptions","organizations_url":"https://api.github.com/users/nwangtw/orgs","repos_url":"https://api.github.com/users/nwangtw/repos","events_url":"https://api.github.com/users/nwangtw/events{/privacy}","received_events_url":"https://api.github.com/users/nwangtw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-21T21:54:33Z","updated_at":"2022-01-21T21:54:33Z","author_association":"CONTRIBUTOR","body":"lgtm\n\nOn Fri, Jan 21, 2022 at 12:58 PM Josh Fischer ***@***.***>\nwrote:\n\n> ***@***.**** approved this pull request.\n>\n> —\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/incubator-heron/pull/3760#pullrequestreview-860020199>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/ABQPBHZK5U5Y6NCA2HLQZL3UXHCHRANCNFSM5MKYFDIA>\n> .\n> Triage notifications on the go with GitHub Mobile for iOS\n> <https://apps.apple.com/app/apple-store/id1477376905?ct=notification-email&mt=8&pt=524675>\n> or Android\n> <https://play.google.com/store/apps/details?id=com.github.android&referrer=utm_campaign%3Dnotification-email%26utm_medium%3Demail%26utm_source%3Dgithub>.\n>\n> You are receiving this because your review was requested.Message ID:\n> ***@***.***>\n>\n","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1018892295/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1019661423","html_url":"https://github.com/apache/incubator-heron/pull/3646#issuecomment-1019661423","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3646","id":1019661423,"node_id":"IC_kwDOApKMps48xsxv","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T02:42:07Z","updated_at":"2022-01-24T02:42:07Z","author_association":"CONTRIBUTOR","body":"#3642 Code was integrated into this PR.\r\n\r\nTracker Behavior changes:\r\n\r\n- replace `/` → `/topologies` redirect with (OpenAPI on ReDoc) documentation\r\n- deprecate `executiontime` and always return 0.0 for it in the response envelope - this could probably be put back in, but I don't think it's worth it\r\n- inbound requests aren't terminated if they take over 120s. At the moment, every outbound request has a 5s limit (due to httpx default) so I wouldn't expect the timeout to be needed (even in metrics queries which may transform data). A replacement timeout could be added in if necessary.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1019661423/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1020350884","html_url":"https://github.com/apache/incubator-heron/pull/3766#issuecomment-1020350884","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3766","id":1020350884,"node_id":"IC_kwDOApKMps480VGk","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T17:24:31Z","updated_at":"2022-01-24T17:24:31Z","author_association":"CONTRIBUTOR","body":"Can't be updated due to Python 3.6 dependency. Docker build rules needs updated Python build rules, but this doesn't work yet. #3646 will resolve this and include the changes found in this PR.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1020350884/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1020491386","html_url":"https://github.com/apache/incubator-heron/pull/3642#issuecomment-1020491386","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3642","id":1020491386,"node_id":"IC_kwDOApKMps4803Z6","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T20:01:29Z","updated_at":"2022-01-24T20:01:29Z","author_association":"CONTRIBUTOR","body":"Closing as #3646 now has the changes from this PR.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1020491386/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1020686236","html_url":"https://github.com/apache/incubator-heron/pull/3639#issuecomment-1020686236","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3639","id":1020686236,"node_id":"IC_kwDOApKMps481m-c","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T00:28:40Z","updated_at":"2022-01-25T00:28:40Z","author_association":"CONTRIBUTOR","body":"The Apache Code of Conduct can be found here: https://www.apache.org/foundation/policies/conduct\r\n\r\nClosing this ticket.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1020686236/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1021830291","html_url":"https://github.com/apache/incubator-heron/pull/3751#issuecomment-1021830291","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3751","id":1021830291,"node_id":"IC_kwDOApKMps485-ST","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T03:33:01Z","updated_at":"2022-01-26T03:33:01Z","author_association":"MEMBER","body":"Draft removal of most references to `pex_binary` and `pex_library`.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1021830291/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1021847947","html_url":"https://github.com/apache/incubator-heron/pull/3751#issuecomment-1021847947","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3751","id":1021847947,"node_id":"IC_kwDOApKMps486CmL","user":{"login":"nwangtw","id":6353055,"node_id":"MDQ6VXNlcjYzNTMwNTU=","avatar_url":"https://avatars.githubusercontent.com/u/6353055?v=4","gravatar_id":"","url":"https://api.github.com/users/nwangtw","html_url":"https://github.com/nwangtw","followers_url":"https://api.github.com/users/nwangtw/followers","following_url":"https://api.github.com/users/nwangtw/following{/other_user}","gists_url":"https://api.github.com/users/nwangtw/gists{/gist_id}","starred_url":"https://api.github.com/users/nwangtw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nwangtw/subscriptions","organizations_url":"https://api.github.com/users/nwangtw/orgs","repos_url":"https://api.github.com/users/nwangtw/repos","events_url":"https://api.github.com/users/nwangtw/events{/privacy}","received_events_url":"https://api.github.com/users/nwangtw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T04:20:26Z","updated_at":"2022-01-26T04:20:26Z","author_association":"CONTRIBUTOR","body":"This would be really cool~","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1021847947/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1022547789","html_url":"https://github.com/apache/incubator-heron/pull/3751#issuecomment-1022547789","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3751","id":1022547789,"node_id":"IC_kwDOApKMps488tdN","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T19:52:24Z","updated_at":"2022-01-26T20:09:13Z","author_association":"MEMBER","body":"There is no `zip_safe` and `resources` in `py_binary`. I have opted to disable `zip_safe` and placed the change in its own commit so it can be dropped if needed.\r\n\r\n`resources` in [bazel_pex_rules](https://github.com/benley/bazel_rules_pex#pex_binary.data) appears to have switched to calling this `data`:\r\n\r\n> `List of labels; Optional; Default is []`\r\n>\r\n> Files to include as resources in the final pex binary.\r\n>\r\n> Putting other rules here will cause the outputs of those rules to be embedded in this one. Files will be included as-is. Paths in the archive will be relative to the workspace root.\r\n\r\nI think this may align with [Bazel's](https://docs.bazel.build/versions/main/be/common-definitions.html#typical.data) definition of `data`, but it uses those files at rule runtime:\r\n\r\n> `List of labels; optional`\r\n>\r\n> Files needed by this rule at runtime. May list file or rule targets. Generally allows any target.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1022547789/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1023685511","html_url":"https://github.com/apache/incubator-heron/pull/3751#issuecomment-1023685511","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3751","id":1023685511,"node_id":"IC_kwDOApKMps49BDOH","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-27T22:13:06Z","updated_at":"2022-01-28T01:05:15Z","author_association":"MEMBER","body":"I just reverted the commits on `pylint` and `cpplint`.\r\n\r\n**_Edit:_** I am still learning Bazel and understanding the build scripts. I can not trigger the infinite loop that CI is experiencing on my local machines:\r\n\r\n```bash\r\n(00:13:40) ERROR: Cycle detected but could not be properly displayed due to an internal problem. \r\nPlease file an issue. Raw display: topLevelKey: ConfiguredTargetKey{label=//heron/api/src/cpp:cxx-api, config=BuildConfigurationValue.Key[a5ba794ad3f6c1fd9f8a7f4293435609fb1ef8a34f21b35e3d8a289fcb873f5e]}\r\n```\r\n\r\nThe error seems to be caused by an infinite recursion/expansion of the build rule `cpplint`. I think the culprit is `main` being set to `cpplint` because when I set it to `main.py` there is no infinite loop anymore.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1023685511/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1023824304","html_url":"https://github.com/apache/incubator-heron/pull/3751#issuecomment-1023824304","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3751","id":1023824304,"node_id":"IC_kwDOApKMps49BlGw","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-28T02:23:11Z","updated_at":"2022-01-28T02:23:11Z","author_association":"MEMBER","body":"I think the best way to approach this enormous task is to completely remove a single PEX build rule at a time and make sure everything compiles and all tests pass. Start with the simpler build rules and move to the more complex ones. That way we can verify in a concrete fashion that the changes we are making are correct. It also means the work we are completing can be incrementally merged back into `master` so that there is progress.\r\n\r\nConceivably a Kanban board that tracks the rules to remove? We can clump some together for fewer PR's.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1023824304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1023832619","html_url":"https://github.com/apache/incubator-heron/pull/3751#issuecomment-1023832619","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3751","id":1023832619,"node_id":"IC_kwDOApKMps49BnIr","user":{"login":"joshfischer1108","id":5785700,"node_id":"MDQ6VXNlcjU3ODU3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/5785700?v=4","gravatar_id":"","url":"https://api.github.com/users/joshfischer1108","html_url":"https://github.com/joshfischer1108","followers_url":"https://api.github.com/users/joshfischer1108/followers","following_url":"https://api.github.com/users/joshfischer1108/following{/other_user}","gists_url":"https://api.github.com/users/joshfischer1108/gists{/gist_id}","starred_url":"https://api.github.com/users/joshfischer1108/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joshfischer1108/subscriptions","organizations_url":"https://api.github.com/users/joshfischer1108/orgs","repos_url":"https://api.github.com/users/joshfischer1108/repos","events_url":"https://api.github.com/users/joshfischer1108/events{/privacy}","received_events_url":"https://api.github.com/users/joshfischer1108/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-28T02:41:54Z","updated_at":"2022-01-28T02:41:54Z","author_association":"MEMBER","body":"  I like the idea of removing a single build rule at a time.  After jumping into a lot this code I think we've learned a lot (a good time for growth 😄 ) Are you thinking we should abandon this branch and start fresh?","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1023832619/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1023848057","html_url":"https://github.com/apache/incubator-heron/pull/3751#issuecomment-1023848057","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3751","id":1023848057,"node_id":"IC_kwDOApKMps49Bq55","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-28T03:17:43Z","updated_at":"2022-01-28T03:17:43Z","author_association":"MEMBER","body":"> Are you thinking we should abandon this branch and start fresh?\r\n\r\nWe are thinking alike 😁 ","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1023848057/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1024138256","html_url":"https://github.com/apache/incubator-heron/pull/3751#issuecomment-1024138256","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3751","id":1024138256,"node_id":"IC_kwDOApKMps49CxwQ","user":{"login":"joshfischer1108","id":5785700,"node_id":"MDQ6VXNlcjU3ODU3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/5785700?v=4","gravatar_id":"","url":"https://api.github.com/users/joshfischer1108","html_url":"https://github.com/joshfischer1108","followers_url":"https://api.github.com/users/joshfischer1108/followers","following_url":"https://api.github.com/users/joshfischer1108/following{/other_user}","gists_url":"https://api.github.com/users/joshfischer1108/gists{/gist_id}","starred_url":"https://api.github.com/users/joshfischer1108/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joshfischer1108/subscriptions","organizations_url":"https://api.github.com/users/joshfischer1108/orgs","repos_url":"https://api.github.com/users/joshfischer1108/repos","events_url":"https://api.github.com/users/joshfischer1108/events{/privacy}","received_events_url":"https://api.github.com/users/joshfischer1108/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-28T11:45:30Z","updated_at":"2022-01-28T11:45:30Z","author_association":"MEMBER","body":"Closing to account for smaller chunks of work.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1024138256/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1028313605","html_url":"https://github.com/apache/incubator-heron/issues/3769#issuecomment-1028313605","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3769","id":1028313605,"node_id":"IC_kwDOApKMps49StIF","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T20:07:27Z","updated_at":"2022-02-02T20:07:27Z","author_association":"MEMBER","body":"Would using [RandomStringUtils#random](https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/RandomStringUtils.html) with a character count of 11 fix the issue? Or is this a string length related issue?\r\n\r\nIf my math is correct it should generate 26 `uppercase` + 26 `lowercase` + 10 `digits` permute 11 `count` = 62 p 11 = 390,164,706,723,052,800 potential strings. That is more options than `Random#long` provides.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1028313605/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1033408181","html_url":"https://github.com/apache/incubator-heron/issues/3769#issuecomment-1033408181","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3769","id":1033408181,"node_id":"IC_kwDOApKMps49mI61","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-09T06:51:15Z","updated_at":"2022-02-09T06:51:15Z","author_association":"CONTRIBUTOR","body":"So my suggestion is to remove the Random.long all together. I'm not sure why this was added, but we don't have any ability to \"roll-back\" to the previous uploads. So having an endless series of entries in Bookkeeper doesn't make sense. If I resubmit the same topology with name, role, version coordinates, I would expect it to replace the previous entry in Bookkeeper (or whatever upload mechanism is used). For example when developing and testing an analytic job.\r\n\r\nIf the desire is to run different binaries, one should distinguish the name, role and/or version to create a unique coordinate in the Upload/Download mechanism. \r\n\r\nWe will have to test the Upload functionality to ensure that removing the Random.long doesn't break anything.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1033408181/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1037493922","html_url":"https://github.com/apache/incubator-heron/pull/3768#issuecomment-1037493922","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3768","id":1037493922,"node_id":"IC_kwDOApKMps491uai","user":{"login":"nicknezis","id":181930,"node_id":"MDQ6VXNlcjE4MTkzMA==","avatar_url":"https://avatars.githubusercontent.com/u/181930?v=4","gravatar_id":"","url":"https://api.github.com/users/nicknezis","html_url":"https://github.com/nicknezis","followers_url":"https://api.github.com/users/nicknezis/followers","following_url":"https://api.github.com/users/nicknezis/following{/other_user}","gists_url":"https://api.github.com/users/nicknezis/gists{/gist_id}","starred_url":"https://api.github.com/users/nicknezis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicknezis/subscriptions","organizations_url":"https://api.github.com/users/nicknezis/orgs","repos_url":"https://api.github.com/users/nicknezis/repos","events_url":"https://api.github.com/users/nicknezis/events{/privacy}","received_events_url":"https://api.github.com/users/nicknezis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-12T21:28:11Z","updated_at":"2022-02-12T21:28:11Z","author_association":"CONTRIBUTOR","body":"I think this is still in draft and the checklist not complete, so not sure if this is approvable yet. Just wanted to make sure it wasn't merged in by accident. But I guess the Draft status should help with that.\r\n\r\nI'd like to better understand the refactoring of the protobuf files to this location: https://github.com/surahman/Heron-Protobuf\r\n\r\n@surahman Will this remove the need for the protobuf files to live in this repo? Or was this just a temporary home to figure out the build tooling?","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1037493922/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1037680370","html_url":"https://github.com/apache/incubator-heron/pull/3768#issuecomment-1037680370","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3768","id":1037680370,"node_id":"IC_kwDOApKMps492b7y","user":{"login":"surahman","id":3979925,"node_id":"MDQ6VXNlcjM5Nzk5MjU=","avatar_url":"https://avatars.githubusercontent.com/u/3979925?v=4","gravatar_id":"","url":"https://api.github.com/users/surahman","html_url":"https://github.com/surahman","followers_url":"https://api.github.com/users/surahman/followers","following_url":"https://api.github.com/users/surahman/following{/other_user}","gists_url":"https://api.github.com/users/surahman/gists{/gist_id}","starred_url":"https://api.github.com/users/surahman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surahman/subscriptions","organizations_url":"https://api.github.com/users/surahman/orgs","repos_url":"https://api.github.com/users/surahman/repos","events_url":"https://api.github.com/users/surahman/events{/privacy}","received_events_url":"https://api.github.com/users/surahman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-13T02:18:29Z","updated_at":"2022-02-13T22:58:31Z","author_association":"MEMBER","body":"> I think this is still in draft and the checklist not complete, so not sure if this is approvable yet. Just wanted to make sure it wasn't merged in by accident. But I guess the Draft status should help with that.\r\n\r\nYes, this is still a WIP. There is a long way to go to completion and the protobuf is currently blocking progress.\r\n\r\n> I'd like to better understand the refactoring of the protobuf files to this location: https://github.com/surahman/Heron-Protobuf\r\n>\r\n> @surahman Will this remove the need for the protobuf files to live in this repo? Or was this just a temporary home to figure out the build tooling?\r\n\r\nIt is to isolate the development of the protobuf build script and directory structures. It has sped up and greatly declutter the protobuf build script development. The directory structures and build scripts would need to be transplanted into the current Heron build scripts.\r\n\r\nThe issues to consider are whether the import/includes and directory structure within the protobuf libraries these scripts assemble will match what Heron requires. This could become very complicated if it does not.\r\n\r\n_**Edit:**_\r\n\r\nFor clarity, everything outside of the files in [this directory](https://github.com/surahman/Heron-Protobuf/tree/main/proto) is extraneous and can be classified as build artifacts. The only relevant files are in this tree and will need to be integrated into Heron:\r\n\r\n```bash\r\n└── proto\r\n    ├── api\r\n    │   ├── BUILD.bazel\r\n    │   └── topology.proto\r\n    ├── ckptmgr\r\n    │   ├── BUILD.bazel\r\n    │   └── ckptmgr.proto\r\n    ├── scheduler\r\n    │   ├── BUILD.bazel\r\n    │   └── scheduler.proto\r\n    ├── stmgr\r\n    │   ├── BUILD.bazel\r\n    │   └── stmgr.proto\r\n    ├── system\r\n    │   ├── BUILD.bazel\r\n    │   ├── common.proto\r\n    │   ├── execution_state.proto\r\n    │   ├── metrics.proto\r\n    │   ├── packing_plan.proto\r\n    │   ├── physical_plan.proto\r\n    │   ├── stats.proto\r\n    │   └── tuple.proto\r\n    ├── testing\r\n    │   ├── BUILD.bazel\r\n    │   └── networktests.proto\r\n    └── manager\r\n        ├── BUILD.bazel\r\n        └── tmanager.proto\r\n```\r\n\r\nThe protobuf is central to all communication between processes in Heron and if it is broken things will fail, so great care and scrutiny are required.","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1037680370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1038599159","html_url":"https://github.com/apache/incubator-heron/pull/3750#issuecomment-1038599159","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3750","id":1038599159,"node_id":"IC_kwDOApKMps4958P3","user":{"login":"thinker0","id":357785,"node_id":"MDQ6VXNlcjM1Nzc4NQ==","avatar_url":"https://avatars.githubusercontent.com/u/357785?v=4","gravatar_id":"","url":"https://api.github.com/users/thinker0","html_url":"https://github.com/thinker0","followers_url":"https://api.github.com/users/thinker0/followers","following_url":"https://api.github.com/users/thinker0/following{/other_user}","gists_url":"https://api.github.com/users/thinker0/gists{/gist_id}","starred_url":"https://api.github.com/users/thinker0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thinker0/subscriptions","organizations_url":"https://api.github.com/users/thinker0/orgs","repos_url":"https://api.github.com/users/thinker0/repos","events_url":"https://api.github.com/users/thinker0/events{/privacy}","received_events_url":"https://api.github.com/users/thinker0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-14T03:35:26Z","updated_at":"2022-02-14T03:35:26Z","author_association":"MEMBER","body":"@nwangtw , @joshfischer1108  \r\n\r\nI think it would be good to do prometheus Labels.\r\n\r\nhttps://prometheus.io/docs/practices/naming/#labels","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1038599159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1038611609","html_url":"https://github.com/apache/incubator-heron/pull/3750#issuecomment-1038611609","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3750","id":1038611609,"node_id":"IC_kwDOApKMps495_SZ","user":{"login":"nwangtw","id":6353055,"node_id":"MDQ6VXNlcjYzNTMwNTU=","avatar_url":"https://avatars.githubusercontent.com/u/6353055?v=4","gravatar_id":"","url":"https://api.github.com/users/nwangtw","html_url":"https://github.com/nwangtw","followers_url":"https://api.github.com/users/nwangtw/followers","following_url":"https://api.github.com/users/nwangtw/following{/other_user}","gists_url":"https://api.github.com/users/nwangtw/gists{/gist_id}","starred_url":"https://api.github.com/users/nwangtw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nwangtw/subscriptions","organizations_url":"https://api.github.com/users/nwangtw/orgs","repos_url":"https://api.github.com/users/nwangtw/repos","events_url":"https://api.github.com/users/nwangtw/events{/privacy}","received_events_url":"https://api.github.com/users/nwangtw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-14T04:04:23Z","updated_at":"2022-02-14T04:04:23Z","author_association":"CONTRIBUTOR","body":"Not yet. Got some feedbacks during the meetup and I need to think about it\nmore.\n\nOn Sun, Feb 13, 2022 at 7:35 PM choi se ***@***.***> wrote:\n\n> @nwangtw <https://github.com/nwangtw> , @joshfischer1108\n> <https://github.com/joshfischer1108>\n>\n> I think it would be good to do prometheus Labels.\n>\n> https://prometheus.io/docs/practices/naming/#labels\n>\n> —\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/incubator-heron/pull/3750#issuecomment-1038599159>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/ABQPBH43YSO6JPCRV7LPXNTU3B2AVANCNFSM5KLYYQXQ>\n> .\n> Triage notifications on the go with GitHub Mobile for iOS\n> <https://apps.apple.com/app/apple-store/id1477376905?ct=notification-email&mt=8&pt=524675>\n> or Android\n> <https://play.google.com/store/apps/details?id=com.github.android&referrer=utm_campaign%3Dnotification-email%26utm_medium%3Demail%26utm_source%3Dgithub>.\n>\n> You are receiving this because you were mentioned.Message ID:\n> ***@***.***>\n>\n","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1038611609/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1042498333","html_url":"https://github.com/apache/incubator-heron/issues/859#issuecomment-1042498333","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/859","id":1042498333,"node_id":"IC_kwDOApKMps4-I0Md","user":{"login":"thinker0","id":357785,"node_id":"MDQ6VXNlcjM1Nzc4NQ==","avatar_url":"https://avatars.githubusercontent.com/u/357785?v=4","gravatar_id":"","url":"https://api.github.com/users/thinker0","html_url":"https://github.com/thinker0","followers_url":"https://api.github.com/users/thinker0/followers","following_url":"https://api.github.com/users/thinker0/following{/other_user}","gists_url":"https://api.github.com/users/thinker0/gists{/gist_id}","starred_url":"https://api.github.com/users/thinker0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thinker0/subscriptions","organizations_url":"https://api.github.com/users/thinker0/orgs","repos_url":"https://api.github.com/users/thinker0/repos","events_url":"https://api.github.com/users/thinker0/events{/privacy}","received_events_url":"https://api.github.com/users/thinker0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T02:13:04Z","updated_at":"2022-02-17T02:13:04Z","author_association":"MEMBER","body":"Fixed #2692","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1042498333/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1042515662","html_url":"https://github.com/apache/incubator-heron/issues/3769#issuecomment-1042515662","issue_url":"https://api.github.com/repos/apache/incubator-heron/issues/3769","id":1042515662,"node_id":"IC_kwDOApKMps4-I4bO","user":{"login":"windhamwong","id":677625,"node_id":"MDQ6VXNlcjY3NzYyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/677625?v=4","gravatar_id":"","url":"https://api.github.com/users/windhamwong","html_url":"https://github.com/windhamwong","followers_url":"https://api.github.com/users/windhamwong/followers","following_url":"https://api.github.com/users/windhamwong/following{/other_user}","gists_url":"https://api.github.com/users/windhamwong/gists{/gist_id}","starred_url":"https://api.github.com/users/windhamwong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/windhamwong/subscriptions","organizations_url":"https://api.github.com/users/windhamwong/orgs","repos_url":"https://api.github.com/users/windhamwong/repos","events_url":"https://api.github.com/users/windhamwong/events{/privacy}","received_events_url":"https://api.github.com/users/windhamwong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T02:51:12Z","updated_at":"2022-02-17T02:51:12Z","author_association":"CONTRIBUTOR","body":"Is that possible to, either defined by user, or set it with timestamp instead?","reactions":{"url":"https://api.github.com/repos/apache/incubator-heron/issues/comments/1042515662/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]