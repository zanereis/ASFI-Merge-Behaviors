[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2424718269","html_url":"https://github.com/apache/couchdb/pull/5314#issuecomment-2424718269","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5314","id":2424718269,"node_id":"IC_kwDOAAMmUc6QhkO9","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-20T08:08:20Z","updated_at":"2024-10-20T08:08:20Z","author_association":"MEMBER","body":"> that looks really great! I think we could merge 102 and 115 together like we did in 86 & 91.\r\n\r\nyeah, that’s what I meant. My question is “should we?”.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2424718269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2424965162","html_url":"https://github.com/apache/couchdb/pull/5314#issuecomment-2424965162","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5314","id":2424965162,"node_id":"IC_kwDOAAMmUc6Qiggq","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-20T13:35:14Z","updated_at":"2024-10-20T15:25:23Z","author_association":"CONTRIBUTOR","body":"btw, we should test this in a branch starting with `jenkins-...` to test full CI runs ~~, so we could se problems with SM 78 ...~~","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2424965162/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2426548732","html_url":"https://github.com/apache/couchdb/issues/1929#issuecomment-2426548732","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1929","id":2426548732,"node_id":"IC_kwDOAAMmUc6QojH8","user":{"login":"renebaudisch","id":15980546,"node_id":"MDQ6VXNlcjE1OTgwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/15980546?v=4","gravatar_id":"","url":"https://api.github.com/users/renebaudisch","html_url":"https://github.com/renebaudisch","followers_url":"https://api.github.com/users/renebaudisch/followers","following_url":"https://api.github.com/users/renebaudisch/following{/other_user}","gists_url":"https://api.github.com/users/renebaudisch/gists{/gist_id}","starred_url":"https://api.github.com/users/renebaudisch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/renebaudisch/subscriptions","organizations_url":"https://api.github.com/users/renebaudisch/orgs","repos_url":"https://api.github.com/users/renebaudisch/repos","events_url":"https://api.github.com/users/renebaudisch/events{/privacy}","received_events_url":"https://api.github.com/users/renebaudisch/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-21T12:35:44Z","updated_at":"2024-10-21T12:35:44Z","author_association":"NONE","body":"@wohali, perfect to know that there is a permission error ANYWHERE on my system. I should just take me a FEW lightyear to see where exactly...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2426548732/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2426960395","html_url":"https://github.com/apache/couchdb/issues/5315#issuecomment-2426960395","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5315","id":2426960395,"node_id":"IC_kwDOAAMmUc6QqHoL","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-21T15:07:47Z","updated_at":"2024-10-21T15:07:47Z","author_association":"CONTRIBUTOR","body":"This is a feature added recently https://github.com/apache/couchdb/blob/main/rel/overlay/etc/default.ini#L1074. Probably the API docs need to be updated.\r\n\r\n\\cc @rnewson ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2426960395/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2426974822","html_url":"https://github.com/apache/couchdb/issues/5315#issuecomment-2426974822","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5315","id":2426974822,"node_id":"IC_kwDOAAMmUc6QqLJm","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-21T15:13:09Z","updated_at":"2024-10-21T15:13:09Z","author_association":"MEMBER","body":"agree, the docs need updating. what a chore :(","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2426974822/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2426989426","html_url":"https://github.com/apache/couchdb/issues/5315#issuecomment-2426989426","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5315","id":2426989426,"node_id":"IC_kwDOAAMmUc6QqOty","user":{"login":"H--o-l","id":10905922,"node_id":"MDQ6VXNlcjEwOTA1OTIy","avatar_url":"https://avatars.githubusercontent.com/u/10905922?v=4","gravatar_id":"","url":"https://api.github.com/users/H--o-l","html_url":"https://github.com/H--o-l","followers_url":"https://api.github.com/users/H--o-l/followers","following_url":"https://api.github.com/users/H--o-l/following{/other_user}","gists_url":"https://api.github.com/users/H--o-l/gists{/gist_id}","starred_url":"https://api.github.com/users/H--o-l/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/H--o-l/subscriptions","organizations_url":"https://api.github.com/users/H--o-l/orgs","repos_url":"https://api.github.com/users/H--o-l/repos","events_url":"https://api.github.com/users/H--o-l/events{/privacy}","received_events_url":"https://api.github.com/users/H--o-l/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-21T15:18:51Z","updated_at":"2024-10-21T15:18:51Z","author_association":"NONE","body":"OK, understood, thanks. What about the changelog, did the change appear inside it? Because I read it carefully before doing the update and I haven't noticed that change. It would have avoided inconvenience for my users if I had been able to notice it before the update.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2426989426/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2427009998","html_url":"https://github.com/apache/couchdb/issues/5315#issuecomment-2427009998","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5315","id":2427009998,"node_id":"IC_kwDOAAMmUc6QqTvO","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-21T15:26:53Z","updated_at":"2024-10-21T15:26:53Z","author_association":"MEMBER","body":"The new lockout support was documented in the changelog (https://docs.couchdb.org/en/stable/whatsnew/3.4.html), but we (_I_) didn't update the api docs to list 403 as a possibility for all endpoints, we'll sort that out.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2427009998/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2427027325","html_url":"https://github.com/apache/couchdb/issues/5315#issuecomment-2427027325","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5315","id":2427027325,"node_id":"IC_kwDOAAMmUc6QqX99","user":{"login":"H--o-l","id":10905922,"node_id":"MDQ6VXNlcjEwOTA1OTIy","avatar_url":"https://avatars.githubusercontent.com/u/10905922?v=4","gravatar_id":"","url":"https://api.github.com/users/H--o-l","html_url":"https://github.com/H--o-l","followers_url":"https://api.github.com/users/H--o-l/followers","following_url":"https://api.github.com/users/H--o-l/following{/other_user}","gists_url":"https://api.github.com/users/H--o-l/gists{/gist_id}","starred_url":"https://api.github.com/users/H--o-l/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/H--o-l/subscriptions","organizations_url":"https://api.github.com/users/H--o-l/orgs","repos_url":"https://api.github.com/users/H--o-l/repos","events_url":"https://api.github.com/users/H--o-l/events{/privacy}","received_events_url":"https://api.github.com/users/H--o-l/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-21T15:33:10Z","updated_at":"2024-10-21T15:33:10Z","author_association":"NONE","body":"OK, my bad, thanks for the answer. I let you see then, and you can close the issue when you want :+1: ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2427027325/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2427312967","html_url":"https://github.com/apache/couchdb/issues/1929#issuecomment-2427312967","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1929","id":2427312967,"node_id":"IC_kwDOAAMmUc6QrdtH","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-21T17:26:31Z","updated_at":"2024-10-21T17:26:31Z","author_association":"MEMBER","body":"As the error above comes from the log writer it should be easy to determine which file the access permission is with. oh, and light-year is a unit of length, not time.\r\n\r\nPlease open a new issue if you have an example of eacces without enough context to track it down.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2427312967/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2428473258","html_url":"https://github.com/apache/couchdb/issues/1929#issuecomment-2428473258","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1929","id":2428473258,"node_id":"IC_kwDOAAMmUc6Qv4-q","user":{"login":"renebaudisch","id":15980546,"node_id":"MDQ6VXNlcjE1OTgwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/15980546?v=4","gravatar_id":"","url":"https://api.github.com/users/renebaudisch","html_url":"https://github.com/renebaudisch","followers_url":"https://api.github.com/users/renebaudisch/followers","following_url":"https://api.github.com/users/renebaudisch/following{/other_user}","gists_url":"https://api.github.com/users/renebaudisch/gists{/gist_id}","starred_url":"https://api.github.com/users/renebaudisch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/renebaudisch/subscriptions","organizations_url":"https://api.github.com/users/renebaudisch/orgs","repos_url":"https://api.github.com/users/renebaudisch/repos","events_url":"https://api.github.com/users/renebaudisch/events{/privacy}","received_events_url":"https://api.github.com/users/renebaudisch/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-22T07:29:13Z","updated_at":"2024-10-22T07:29:13Z","author_association":"NONE","body":"Just wanted to comment, that it would be nice to see a bit clearer what exactly the problem has been.\r\nI haven't found a documentation on how to read this errors and still it is not precise and one still need to think about what to do, which permissions to check and so on. \r\n\r\nAn additional hint like e.g \"please ensure this folders/files have the needed permissions 755/644:\" would be very nice in this situation...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2428473258/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2430548459","html_url":"https://github.com/apache/couchdb/issues/5283#issuecomment-2430548459","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5283","id":2430548459,"node_id":"IC_kwDOAAMmUc6Q3znr","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-23T00:18:55Z","updated_at":"2024-10-23T00:18:55Z","author_association":"CONTRIBUTOR","body":"@mikkimichaelis good point. But I think CouchDB's simple file logger is just that - a basic logger. I think it would be good to enhance it to stop writing when the disk is full, however I don't know if it will gain proper file rotation, it's own remote logging, or other such features.\r\n\r\nIn production it might be better to use a proper logger like rsyslog or journald  [1]. CouchDB can be configured to use those easily:\r\n\r\n[1] https://docs.couchdb.org/en/stable/config/logging.html#log/syslog_host","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2430548459/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2432035756","html_url":"https://github.com/apache/couchdb/pull/5314#issuecomment-2432035756","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5314","id":2432035756,"node_id":"IC_kwDOAAMmUc6Q9eus","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-23T12:44:49Z","updated_at":"2024-10-23T12:50:02Z","author_association":"CONTRIBUTOR","body":"Hi,\r\n\r\nI tried to merge and simplify different SpiderMonkey versions together. This is the [result PR](https://github.com/apache/couchdb/pull/5319). I tested it with v91, v115 and v128.\r\n\r\nPlease try it out and take a look!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2432035756/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2432401854","html_url":"https://github.com/apache/couchdb/pull/5319#issuecomment-2432401854","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5319","id":2432401854,"node_id":"IC_kwDOAAMmUc6Q-4G-","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-23T14:26:16Z","updated_at":"2024-10-23T14:26:16Z","author_association":"CONTRIBUTOR","body":"Closing in favor of #5321 (full CI runs).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2432401854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2442093874","html_url":"https://github.com/apache/couchdb/pull/5324#issuecomment-2442093874","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5324","id":2442093874,"node_id":"IC_kwDOAAMmUc6Rj2Uy","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-28T16:39:43Z","updated_at":"2024-10-28T16:39:43Z","author_association":"MEMBER","body":"I realise this is draft but I have a concern. A lot of this test appears to be asserting the internals of the implementation, rather than testing that it works functionally. The cut-and-paste of records from the implementation, etc. Before you spend much more time on this I think it's worth reassessing the purpose of eunit tests.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2442093874/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2442097358","html_url":"https://github.com/apache/couchdb/pull/5324#issuecomment-2442097358","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5324","id":2442097358,"node_id":"IC_kwDOAAMmUc6Rj3LO","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-28T16:41:13Z","updated_at":"2024-10-28T16:41:13Z","author_association":"MEMBER","body":"the peculiar line in the makefile target that uses find to delete a beam file is a concern also. that is a very unusual way to disable a test (and won't work on Windows, though perhaps you intend a variation when you updated Makefile.win). I don't think it's the right way.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2442097358/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2442365428","html_url":"https://github.com/apache/couchdb/pull/5324#issuecomment-2442365428","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5324","id":2442365428,"node_id":"IC_kwDOAAMmUc6Rk4n0","user":{"login":"jiahuili430","id":54631519,"node_id":"MDQ6VXNlcjU0NjMxNTE5","avatar_url":"https://avatars.githubusercontent.com/u/54631519?v=4","gravatar_id":"","url":"https://api.github.com/users/jiahuili430","html_url":"https://github.com/jiahuili430","followers_url":"https://api.github.com/users/jiahuili430/followers","following_url":"https://api.github.com/users/jiahuili430/following{/other_user}","gists_url":"https://api.github.com/users/jiahuili430/gists{/gist_id}","starred_url":"https://api.github.com/users/jiahuili430/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiahuili430/subscriptions","organizations_url":"https://api.github.com/users/jiahuili430/orgs","repos_url":"https://api.github.com/users/jiahuili430/repos","events_url":"https://api.github.com/users/jiahuili430/events{/privacy}","received_events_url":"https://api.github.com/users/jiahuili430/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-28T18:46:49Z","updated_at":"2024-10-28T18:46:49Z","author_association":"CONTRIBUTOR","body":"Trying to use this test to compare the differences between different Clouseau.\r\nIf it doesn't work on Windows, I'll drop this PR.\r\nThank you for the heads up! @rnewson ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2442365428/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2444132188","html_url":"https://github.com/apache/couchdb/issues/5044#issuecomment-2444132188","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5044","id":2444132188,"node_id":"IC_kwDOAAMmUc6Rrn9c","user":{"login":"jungalwala","id":1099499,"node_id":"MDQ6VXNlcjEwOTk0OTk=","avatar_url":"https://avatars.githubusercontent.com/u/1099499?v=4","gravatar_id":"","url":"https://api.github.com/users/jungalwala","html_url":"https://github.com/jungalwala","followers_url":"https://api.github.com/users/jungalwala/followers","following_url":"https://api.github.com/users/jungalwala/following{/other_user}","gists_url":"https://api.github.com/users/jungalwala/gists{/gist_id}","starred_url":"https://api.github.com/users/jungalwala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jungalwala/subscriptions","organizations_url":"https://api.github.com/users/jungalwala/orgs","repos_url":"https://api.github.com/users/jungalwala/repos","events_url":"https://api.github.com/users/jungalwala/events{/privacy}","received_events_url":"https://api.github.com/users/jungalwala/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-29T12:53:50Z","updated_at":"2024-10-29T12:53:50Z","author_association":"NONE","body":"I am having the same issue, but I don't do anything with attachments.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2444132188/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2446324175","html_url":"https://github.com/apache/couchdb/pull/5327#issuecomment-2446324175","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5327","id":2446324175,"node_id":"IC_kwDOAAMmUc6Rz_HP","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-30T09:31:30Z","updated_at":"2024-10-30T09:31:30Z","author_association":"MEMBER","body":"I’m leaving this here by way of an official record for reviewing this.\r\n\r\nIn the old times, we loaded the Erlang MFAs from CouchDB config and then executed those. This allowed CouchDB admins to change what native code would be running as the `couchdb` operating system user. We [closed](https://github.com/apache/couchdb/pull/1602) a number of vulnerabilities[1] with refactoring this so that the native code definition comes from environment variables and not CouchDB config and thus be out of reach for just CouchDB admins. We also made it so that these env vars are only loaded on module initialisation and not dynamically. The desired security properties however come from moving the MFA definition to env vars (and also making them not strictly raw MFAs), the not-dynamic-loading was just an added bonus.\r\n\r\nThis patch makes loading those values dynamic again, but by the above analysis, that should not open us up to new (or old) attack vectors, as someone who can change the env of a running process is already further ahead than this vector would get them.\r\n\r\nCan someone double check my logic here?\r\n\r\n[1]: \r\n\r\n- https://docs.couchdb.org/en/stable/cve/2017-12636.html\r\n- https://docs.couchdb.org/en/stable/cve/2018-11769.html\r\n- https://docs.couchdb.org/en/stable/cve/2018-8007.html","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2446324175/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2447133797","html_url":"https://github.com/apache/couchdb/pull/5327#issuecomment-2447133797","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5327","id":2447133797,"node_id":"IC_kwDOAAMmUc6R3Exl","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-30T13:21:33Z","updated_at":"2024-10-30T13:22:05Z","author_association":"MEMBER","body":"I don't see the pressing need for online reconfiguration here. As Jan pointed out we had it, and removed it (for security reasons) and with very little complaint (I don't recall any tbh).\r\n\r\nThere is some protection in not allowing an attacker that can manipulate a process's environment from magically changing what (potentially compromised) native code it executes. Sure, an attacker that can do that can probably cause a couchdb restart or crash, though that is at least a tangible event, it could be logged, the pid changes, etc. So the \"from env\" protection and the \"no dynamic change after boot\" protection are both providing something.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2447133797/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2447303442","html_url":"https://github.com/apache/couchdb/pull/5327#issuecomment-2447303442","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5327","id":2447303442,"node_id":"IC_kwDOAAMmUc6R3uMS","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-30T14:13:11Z","updated_at":"2024-10-30T14:13:11Z","author_association":"MEMBER","body":"could we put just `configure_js_engine()` into the config change handler and get this feature without losing any protections?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2447303442/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2447321668","html_url":"https://github.com/apache/couchdb/pull/5327#issuecomment-2447321668","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5327","id":2447321668,"node_id":"IC_kwDOAAMmUc6R3ypE","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-30T14:19:52Z","updated_at":"2024-10-30T14:19:52Z","author_association":"MEMBER","body":"e.g 1) couchdb boots with all the env vars it needs to know how to use spidermonkey and quicks 2) a runtime toggle as to which is used for new `couchjs` processes 3) profit?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2447321668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2447343183","html_url":"https://github.com/apache/couchdb/pull/5327#issuecomment-2447343183","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5327","id":2447343183,"node_id":"IC_kwDOAAMmUc6R335P","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-30T14:28:00Z","updated_at":"2024-10-30T14:37:36Z","author_association":"CONTRIBUTOR","body":"> I don't see the pressing need for online reconfiguration here.\r\n\r\n@rnewson There is a need in deploying this change at a cloud db provider ;-) , where otherwise, it would require putting each node in maintenance mode, restarting it, putting it back in production and so on. It also makes it easy for any user to toggle the config.\r\n\r\n@janl Thanks for the background. The analysis is correct that this doesn't allow adding any new MFA based options or changing arguments. Unless they attach a debugger to the beam process and update the OTP cached env red-black tree https://github.com/erlang/otp/blob/master/erts/emulator/sys/common/erl_osenv.c","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2447343183/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2447359610","html_url":"https://github.com/apache/couchdb/pull/5327#issuecomment-2447359610","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5327","id":2447359610,"node_id":"IC_kwDOAAMmUc6R3756","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-30T14:34:08Z","updated_at":"2024-10-30T14:36:50Z","author_association":"CONTRIBUTOR","body":"> could we put just configure_js_engine() into the config change handler and get this feature without losing any protections?\r\n\r\nHmm, that's what this PR does? There is already a config change handler, it reconfigures all the native (MFA) bits but didn't do the js engine switch.\r\n\r\n> e.g 1) couchdb boots with all the env vars it needs to know how to use spidermonkey and quicks 2) a runtime toggle as to which is used for new `couchjs` processes 3) profit?\r\n\r\nThat's effectively what's happening here. Erlang/OTPs' env is cached https://github.com/erlang/otp/blob/master/erts/emulator/sys/common/erl_osenv.c and not sure how it would be possible to alter it without already having high-enough access to the process and do a lot worse damage. We could cache it in the process again I suppose, but the danger is environment variables hold security bits, passwords, tokens, etc so a proc manager crashing would spill those into to the logs. Maybe cache the filtered prefix bits only? It still seems redundant?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2447359610/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2447434804","html_url":"https://github.com/apache/couchdb/pull/5327#issuecomment-2447434804","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5327","id":2447434804,"node_id":"IC_kwDOAAMmUc6R4OQ0","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-30T14:59:37Z","updated_at":"2024-10-30T14:59:37Z","author_association":"MEMBER","body":"> Hmm, that's what this PR does? There is already a config change handler, it reconfigures all the native (MFA) bits but didn't do the js engine switch.\r\n\r\nas I read it, it moves the pull-from-env from `init()` into its own function that is passed into the config change handler. My suggestion would to _just_ move the js engine switch into the config change handler and leave the rest in init.\r\n\r\n> That's effectively what's happening here. Erlang/OTPs' env is cached\r\n\r\ngut feeling here, and no strong opinion, but the way we have it before is strictly better at expressing in our code what we mean to happen rather than relying on how OTP works today. Of course, if we did this every time, we reimplemented all of OTP and the is obviously silly.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2447434804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2447463272","html_url":"https://github.com/apache/couchdb/pull/5327#issuecomment-2447463272","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5327","id":2447463272,"node_id":"IC_kwDOAAMmUc6R4VNo","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-30T15:08:55Z","updated_at":"2024-10-30T15:16:21Z","author_association":"CONTRIBUTOR","body":"@janl `configure_js_engine/0` already does os:getenv(...) calls, but it does some of them only which leads to a different state if we initialize then just keep calling `configure_js_engine/0` a few times. The way configure engine works is it has to be called after the main config is run. On change, the main config has to run again, then calls configure_js_engine(...).\r\n\r\n> but the way we have it before is strictly better at expressing in our code what we mean to happen\r\n\r\nI can cache it I guess, even though I can't think of a way anyone would change the runtime env var settings of the process. Even a regular C process, how would changing its environment variable set work after it already started?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2447463272/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2449733271","html_url":"https://github.com/apache/couchdb/pull/5314#issuecomment-2449733271","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5314","id":2449733271,"node_id":"IC_kwDOAAMmUc6SA_aX","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-31T12:30:30Z","updated_at":"2024-10-31T12:30:30Z","author_association":"MEMBER","body":"closing in favour of https://github.com/apache/couchdb/pull/5321/","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2449733271/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2450715747","html_url":"https://github.com/apache/couchdb/pull/5330#issuecomment-2450715747","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5330","id":2450715747,"node_id":"IC_kwDOAAMmUc6SEvRj","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-10-31T20:02:18Z","updated_at":"2024-10-31T20:02:18Z","author_association":"CONTRIBUTOR","body":"With the fix:\r\n\r\n```\r\n% http put $DB/db/_design%2f\r\nHTTP/1.1 400 Bad Request\r\n\r\n{\r\n    \"error\": \"illegal_docid\",\r\n    \"reason\": \"Illegal document id `_design/`\"\r\n}\r\n\r\n\r\n % http post $DB/db/_index index:='{\"fields\":[\"_id\"]}' ddoc:='\"_design/\"'\r\nHTTP/1.1 400 Bad Request\r\n\r\n\r\n{\r\n    \"error\": \"illegal_docid\",\r\n    \"reason\": \"Illegal document id `_design/`\"\r\n}\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2450715747/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2456792060","html_url":"https://github.com/apache/couchdb/issues/1741#issuecomment-2456792060","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1741","id":2456792060,"node_id":"IC_kwDOAAMmUc6Sb6v8","user":{"login":"Ngomana","id":61317733,"node_id":"MDQ6VXNlcjYxMzE3NzMz","avatar_url":"https://avatars.githubusercontent.com/u/61317733?v=4","gravatar_id":"","url":"https://api.github.com/users/Ngomana","html_url":"https://github.com/Ngomana","followers_url":"https://api.github.com/users/Ngomana/followers","following_url":"https://api.github.com/users/Ngomana/following{/other_user}","gists_url":"https://api.github.com/users/Ngomana/gists{/gist_id}","starred_url":"https://api.github.com/users/Ngomana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ngomana/subscriptions","organizations_url":"https://api.github.com/users/Ngomana/orgs","repos_url":"https://api.github.com/users/Ngomana/repos","events_url":"https://api.github.com/users/Ngomana/events{/privacy}","received_events_url":"https://api.github.com/users/Ngomana/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-05T10:25:27Z","updated_at":"2024-11-05T10:25:27Z","author_association":"NONE","body":"On my side i had to uninstall couchdb and reinstall it then also enable delete dabase when a user doc in the `_user` database is deleted","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2456792060/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2458442243","html_url":"https://github.com/apache/couchdb/pull/5334#issuecomment-2458442243","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5334","id":2458442243,"node_id":"IC_kwDOAAMmUc6SiNoD","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-06T00:06:02Z","updated_at":"2024-11-06T00:06:02Z","author_association":"CONTRIBUTOR","body":"The view error this fixes looked like this in the logs:\r\n\r\n```\r\nview validation exception\r\n  error:function_clause:[\r\n     {lists,zip,[ \r\n         [   ], \r\n         [ [], #{<<\"headers\">> => #{<<\"Content-Type\">> => <<\"text/plain\">>}} ] \r\n     ], [{file,\"lists.erl\"},{line,419}]},\r\n     {lists,zip,2,[{file,\"lists.erl\"},{line,419}]},\r\n     {couch_quickjs_scanner_plugin,mapred_fold,2,[{file,\"src/couch_quickjs_scanner_plugin.erl\"},{line,285}]},\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2458442243/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2466663169","html_url":"https://github.com/apache/couchdb/issues/5196#issuecomment-2466663169","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5196","id":2466663169,"node_id":"IC_kwDOAAMmUc6TBksB","user":{"login":"MohammadrezaNasrabadi","id":77168970,"node_id":"MDQ6VXNlcjc3MTY4OTcw","avatar_url":"https://avatars.githubusercontent.com/u/77168970?v=4","gravatar_id":"","url":"https://api.github.com/users/MohammadrezaNasrabadi","html_url":"https://github.com/MohammadrezaNasrabadi","followers_url":"https://api.github.com/users/MohammadrezaNasrabadi/followers","following_url":"https://api.github.com/users/MohammadrezaNasrabadi/following{/other_user}","gists_url":"https://api.github.com/users/MohammadrezaNasrabadi/gists{/gist_id}","starred_url":"https://api.github.com/users/MohammadrezaNasrabadi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MohammadrezaNasrabadi/subscriptions","organizations_url":"https://api.github.com/users/MohammadrezaNasrabadi/orgs","repos_url":"https://api.github.com/users/MohammadrezaNasrabadi/repos","events_url":"https://api.github.com/users/MohammadrezaNasrabadi/events{/privacy}","received_events_url":"https://api.github.com/users/MohammadrezaNasrabadi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-10T09:43:39Z","updated_at":"2024-11-10T09:43:39Z","author_association":"NONE","body":"We performed experiments to find the main reason for this problem.\r\nThe problem (connections in CLOSE-WAIT state) happens even without\r\na CouchDB cluster and with a local loopback connection.  It seems\r\nthat CouchDB does not close some of its connections after the\r\nclient closes it; therefore, the connections remain in CLOSE-WAIT\r\nstate.\r\n\r\nWe connect to CouchDB from an Elixir application using the hackney\r\nlibrary.  After a few weeks of running, we have thousands of CouchDB\r\nconnections in CLOSE-WAIT state that disappear only by restarting\r\nCouchDB.  We have not yet found which of the connections made by\r\nhackney remain in CLOSE-WAIT state when hackney closes it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2466663169/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2483593578","html_url":"https://github.com/apache/couchdb/pull/5339#issuecomment-2483593578","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5339","id":2483593578,"node_id":"IC_kwDOAAMmUc6UCKFq","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-18T16:55:01Z","updated_at":"2024-11-18T16:55:01Z","author_association":"CONTRIBUTOR","body":"I changed my mind. The shape of the tests in this PR is too different than other files in the test suite. Especially `self.db.recreate()` part.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2483593578/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2483605181","html_url":"https://github.com/apache/couchdb/pull/5339#issuecomment-2483605181","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5339","id":2483605181,"node_id":"IC_kwDOAAMmUc6UCM69","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-18T17:00:11Z","updated_at":"2024-11-18T17:00:11Z","author_association":"CONTRIBUTOR","body":"> I changed my mind. The shape of the tests in this PR is too different than other files in the test suite. Especially `self.db.recreate()` part.\r\n\r\nWonder if https://github.com/apache/couchdb/blob/main/test/elixir/test/search_test.exs would be a better place? Not a big deal I think if we had some mango tests in there as well, I think.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2483605181/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2494921148","html_url":"https://github.com/apache/couchdb/issues/5186#issuecomment-2494921148","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5186","id":2494921148,"node_id":"IC_kwDOAAMmUc6UtXm8","user":{"login":"kusold","id":509966,"node_id":"MDQ6VXNlcjUwOTk2Ng==","avatar_url":"https://avatars.githubusercontent.com/u/509966?v=4","gravatar_id":"","url":"https://api.github.com/users/kusold","html_url":"https://github.com/kusold","followers_url":"https://api.github.com/users/kusold/followers","following_url":"https://api.github.com/users/kusold/following{/other_user}","gists_url":"https://api.github.com/users/kusold/gists{/gist_id}","starred_url":"https://api.github.com/users/kusold/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kusold/subscriptions","organizations_url":"https://api.github.com/users/kusold/orgs","repos_url":"https://api.github.com/users/kusold/repos","events_url":"https://api.github.com/users/kusold/events{/privacy}","received_events_url":"https://api.github.com/users/kusold/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-22T21:48:33Z","updated_at":"2024-11-22T21:48:33Z","author_association":"NONE","body":"Thanks for posting the resolution. It was not obvious to me that both were required.\r\n\r\nI'm adding a link to https://github.com/apache/couchdb/issues/1305 because that was the recommended solution for CouchDB 2.x, but the option no longer exists in 3.x","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2494921148/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2496011098","html_url":"https://github.com/apache/couchdb/pull/5321#issuecomment-2496011098","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5321","id":2496011098,"node_id":"IC_kwDOAAMmUc6Uxhta","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-24T13:44:11Z","updated_at":"2024-11-24T13:44:11Z","author_association":"MEMBER","body":"@big-r81 any objections to merging this to unblock development on macOS and fixing windows at a later stage?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2496011098/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2496048170","html_url":"https://github.com/apache/couchdb/pull/5321#issuecomment-2496048170","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5321","id":2496048170,"node_id":"IC_kwDOAAMmUc6Uxqwq","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-24T15:03:15Z","updated_at":"2024-11-24T15:50:09Z","author_association":"CONTRIBUTOR","body":"Theoretically yes, the question is, if my “fixes” of the above messages are correct (searching for someone with more c/c++ knowledge).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2496048170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2498535318","html_url":"https://github.com/apache/couchdb/issues/5342#issuecomment-2498535318","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5342","id":2498535318,"node_id":"IC_kwDOAAMmUc6U7J-W","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-25T16:49:30Z","updated_at":"2024-11-25T22:24:51Z","author_association":"CONTRIBUTOR","body":"Thanks for reaching out, Antoine.\r\n\r\n * Do you see any crashes or errors in the logs?\r\n\r\n * QuickJS can build indexes a bit faster but that could mean putting more pressure on the disk or other resources. Do you see increased cpu, disk(I/O quota reaching a limit?) or memory usage during that time? \r\n\r\n * If your design documents or documents are large sometimes it's possible to hit the maximum stack size in the JS engine. For QuickJS that can be adjusted with [memory_limit_bytes](https://docs.couchdb.org/en/stable/config/quickjs.html#quickjs). Though in that case I'd expect to see repeated crashes in the logs with segfault or a memory limit error.\r\n\r\n * Before killing the process try to gather some stats if you an remsh in:\r\n   - That should give us some idea what the the process is running in the remsh `erlang:process_info(Pid).`\r\n   - These three commands will show the top 3 busiest process, message queue lengths and memory users:\r\n```\r\nrecon:proc_window(reductions, 3, 5000).\r\nrecon:proc_window(message_queue_len, 3, 5000).\r\nrecon:proc_window(memory, 3, 5000).\r\n```\r\n\r\n * Another option if you see you have reached the [os_process_limit](https://docs.couchdb.org/en/stable/config/query-servers.html#query_server_config/os_process_limit) on any node with the number of couchjs processes, could consider increasing that a bit.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2498535318/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2499066248","html_url":"https://github.com/apache/couchdb/issues/5343#issuecomment-2499066248","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5343","id":2499066248,"node_id":"IC_kwDOAAMmUc6U9LmI","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-25T21:24:16Z","updated_at":"2024-11-25T21:24:16Z","author_association":"CONTRIBUTOR","body":"Hey,\r\n\r\nalways a good start is to look at your CouchDB log file and maybe the log file of your proxy server.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2499066248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2499067653","html_url":"https://github.com/apache/couchdb/issues/5343#issuecomment-2499067653","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5343","id":2499067653,"node_id":"IC_kwDOAAMmUc6U9L8F","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-25T21:25:07Z","updated_at":"2024-11-25T21:25:07Z","author_association":"CONTRIBUTOR","body":"From which version did you upgrade to 3.4.2?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2499067653/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2499141725","html_url":"https://github.com/apache/couchdb/issues/5343#issuecomment-2499141725","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5343","id":2499141725,"node_id":"IC_kwDOAAMmUc6U9eBd","user":{"login":"sensiblearts","id":805314,"node_id":"MDQ6VXNlcjgwNTMxNA==","avatar_url":"https://avatars.githubusercontent.com/u/805314?v=4","gravatar_id":"","url":"https://api.github.com/users/sensiblearts","html_url":"https://github.com/sensiblearts","followers_url":"https://api.github.com/users/sensiblearts/followers","following_url":"https://api.github.com/users/sensiblearts/following{/other_user}","gists_url":"https://api.github.com/users/sensiblearts/gists{/gist_id}","starred_url":"https://api.github.com/users/sensiblearts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sensiblearts/subscriptions","organizations_url":"https://api.github.com/users/sensiblearts/orgs","repos_url":"https://api.github.com/users/sensiblearts/repos","events_url":"https://api.github.com/users/sensiblearts/events{/privacy}","received_events_url":"https://api.github.com/users/sensiblearts/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-25T22:11:40Z","updated_at":"2024-11-25T22:11:40Z","author_association":"NONE","body":"I'm embarrassed to say I'm not sure, but I'm pretty sure it was 3.3.?.  I probably updated it to the latest version in July 2024. It was at least 3.2, I'm sure.\r\n\r\nI don't see anything in the log files that could be useful, other than possibly an `undefined`:\r\n```\r\n[notice] 2024-11-25T21:23:44.133642Z couchdb@127.0.0.1 <0.5938.0> 7a195f7abb localhost:5984 127.0.0.1 undefined OPTIONS /userdb-6e6a612d34613136386430372d323037352d343235342d613262642d396465666130366230656530/_all_docs?startkey=%22djrn:%22&endkey=%22djrn:%EF%BF%B0%22&include_docs=true 204 ok 1\r\n[error] 2024-11-25T21:23:44.136634Z couchdb@127.0.0.1 <0.10389.0> 4e967067dd rexi_server: from: couchdb@127.0.0.1(<0.5938.0>) mfa: fabric_rpc:open_shard/2 throw:{unauthorized,<<\"You are not authorized to access this db.\">>} [{couch_db,open,2,[{file,\"src/couch_db.erl\"},{line,177}]},{mem3_util,get_or_create_db,2,[{file,\"src/mem3_util.erl\"},{line,602}]},{fabric_rpc,open_shard,2,[{file,\"src/fabric_rpc.erl\"},{line,331}]},{rexi_server,init_p,3,[{file,\"src/rexi_server.erl\"},{line,141}]}]\r\n[notice] 2024-11-25T21:23:44.137230Z couchdb@127.0.0.1 <0.5938.0> 4e967067dd localhost:5984 127.0.0.1 undefined GET /userdb-6e6a612d34613136386430372d323037352d343235342d613262642d396465666130366230656530/_all_docs?startkey=%22djrn:%22&endkey=%22djrn:%EF%BF%B0%22&include_docs=true 401 ok 2\r\n```\r\nSome relevant request headers for the above:\r\n```\r\naccess-control-allow-origin:\r\n*\r\norigin:\r\nhttp://localhost:4000\r\nreferer:\r\nhttp://localhost:4000/\r\nsec-fetch-mode:\r\ncors\r\nsec-fetch-site:\r\ncross-site\r\nx-auth-couchdb-roles:\r\nx-auth-couchdb-token:\r\n817f08ab61ec96b...blah..blah..\r\nx-auth-couchdb-username:\r\nnja-4a168d07-2075-4254-a2bd-9defa06b0ee0\r\n\r\n```\r\n\r\nThe `secret` in Fauxton is the same. (I use the `secret` to generate the per-user token for the `x-auth` header, above.) The token and the username are the same, and the database has not changed, nor has the local.ini file. The only thing I know that changed is whatever the apt upgrade did, and now I get 401. \r\n\r\n(I can still log in to Fauxton as admin and view all dbs.)\r\n\r\nThanks for any advice. \r\n\r\nI'm still in dev mode, so I think I'll just start from scratch with a fresh database and see what I can figure out.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2499141725/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2501633390","html_url":"https://github.com/apache/couchdb/issues/5342#issuecomment-2501633390","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5342","id":2501633390,"node_id":"IC_kwDOAAMmUc6VG-Vu","user":{"login":"aduchate","id":2221917,"node_id":"MDQ6VXNlcjIyMjE5MTc=","avatar_url":"https://avatars.githubusercontent.com/u/2221917?v=4","gravatar_id":"","url":"https://api.github.com/users/aduchate","html_url":"https://github.com/aduchate","followers_url":"https://api.github.com/users/aduchate/followers","following_url":"https://api.github.com/users/aduchate/following{/other_user}","gists_url":"https://api.github.com/users/aduchate/gists{/gist_id}","starred_url":"https://api.github.com/users/aduchate/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aduchate/subscriptions","organizations_url":"https://api.github.com/users/aduchate/orgs","repos_url":"https://api.github.com/users/aduchate/repos","events_url":"https://api.github.com/users/aduchate/events{/privacy}","received_events_url":"https://api.github.com/users/aduchate/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-26T18:16:52Z","updated_at":"2024-11-26T18:16:52Z","author_association":"NONE","body":"Hi nicka,\r\n\r\nNo crash in the logs at all\r\nThe parallelism of ken was limited to 5 which insured that the CPU usage was staying very low on the 48 cores machine\r\nI'll try raising memory_limit_bytes though I doubt it will improve things because at a subsequent indexations of the same view succeed.\r\n\r\nBelow, the request information from remsh\r\n```\r\n(couchdb@couchdb-02-rbx-02.vrack.icure.cloud)2> (couchdb@couchdb-02-rbx-02.vrack.icure.cloud)2> erlang:process_info(<0.83257742.0>). \r\n[{current_function,{gen,do_call,4}},\r\n {initial_call,{erlang,apply,2}},\r\n {status,waiting},\r\n {message_queue_len,0},\r\n {links,[<0.83311580.0>]},\r\n {dictionary,\r\n     [{task_status_props,\r\n          [{changes_done,622766},\r\n           {database,\r\n               <<\"shards/a0000000-bfffffff/icure-ms-wgc-nieuwegent-614fc45\"...>>},\r\n           {design_document,<<\"_design/Contact-DataOwner\">>},\r\n           {indexer_pid,<<\"<0.4441283.0>\">>},\r\n           {progress,50},\r\n           {started_on,1732624104},\r\n           {total_changes,1223768},\r\n           {type,indexer},\r\n           {updated_on,1732624464}]},\r\n      {io_priority,\r\n          {view_update,\r\n              <<\"shards/a0000000-bfffffff/icure-ms-wgc-nieuwegent-614fc455-b5\"...>>,\r\n              <<\"_design/Contact-DataOwner\">>}},\r\n      {task_status_update,{{0,0,0},500000}}]},\r\n {trap_exit,false},\r\n {error_handler,error_handler},\r\n {priority,normal},\r\n {group_leader,<0.252.0>},\r\n {total_heap_size,833025},\r\n {heap_size,318187},\r\n {stack_size,16},\r\n {reductions,86130223},\r\n {garbage_collection,\r\n     [{max_heap_size,\r\n          #{error_logger => true,include_shared_binaries => false,\r\n            kill => true,size => 0}},\r\n      {min_bin_vheap_size,46422},\r\n      {min_heap_size,233},\r\n      {fullsweep_after,65535},\r\n      {minor_gcs,1217}]},\r\n {suspending,[]}]\r\n(couchdb@couchdb-02-rbx-02.vrack.icure.cloud)3> recon:proc_window(reductions, 3, 5000).\r\n[{<0.172400993.0>,64192268,\r\n  [{current_function,{gen,do_call,4}},\r\n   {initial_call,{couch_index_updater,update,3}}]},\r\n {<0.170530515.0>,61520321,\r\n  [{current_function,{gen,do_call,4}},\r\n   {initial_call,{couch_index_updater,update,3}}]},\r\n {<0.172131409.0>,60832785,\r\n  [{current_function,{gen,do_call,4}},\r\n   {initial_call,{couch_index_updater,update,3}}]}]\r\n(couchdb@couchdb-02-rbx-02.vrack.icure.cloud)4> recon:proc_window(message_queue_len, 3, 5000).\r\n[{<0.554738.0>,1,\r\n  [{current_function,{gen_server,loop,7}},\r\n   {initial_call,{proc_lib,init_p,5}}]},\r\n {<0.21585.0>,1,\r\n  [{current_function,{erts_internal,dirty_nif_finalizer,1}},\r\n   {initial_call,{proc_lib,init_p,5}}]},\r\n {<0.3.0>,1,\r\n  [{current_function,\r\n       {erts_dirty_process_signal_handler,msg_loop,0}},\r\n   {initial_call,\r\n       {erts_dirty_process_signal_handler,start,0}}]}]\r\n(couchdb@couchdb-02-rbx-02.vrack.icure.cloud)5> recon:proc_window(memory, 3, 5000).\r\n[{<0.172416530.0>,4721072,\r\n  [{current_function,{gen,do_call,4}},\r\n   {initial_call,{couch_bt_engine_compactor,start,4}}]},\r\n {<0.172600591.0>,4720504,\r\n  [{current_function,{gen_server,loop,7}},\r\n   {initial_call,{proc_lib,init_p,5}}]},\r\n {<0.4328.0>,4032976,\r\n  [{current_function,{gen_server,loop,7}},\r\n   {initial_call,{proc_lib,init_p,5}}]}]\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2501633390/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2501965116","html_url":"https://github.com/apache/couchdb/issues/5342#issuecomment-2501965116","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5342","id":2501965116,"node_id":"IC_kwDOAAMmUc6VIPU8","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-26T21:26:18Z","updated_at":"2024-11-27T16:37:19Z","author_association":"CONTRIBUTOR","body":"Thanks @aduchate.\r\n\r\nHmm, so far everything looks good. \r\n\r\n`couch_index_updater:update/3` processes seem to be the most busy on the cluster. But they seem to wait in 'do_call` so they are waiting on a response from another process.\r\n\r\n * Try to get `erlang:process_info(Pid, current_stacktrace).` along with `erlang:process_info(Pid). `  for the stuck indexer, maybe the indexer updater process as well.\r\n\r\n * What about the `{progress,50}, {total_changes,1223768}, {type,indexer}, {updated_on,1732624464}`  values on the stuck indexer, do they get updated periodically? What about disk IO and CPU usage does it seems like anything is being used significantly?\r\n\r\n * Is it always the same db/index that gets stuck or it's always a random one?\r\n \r\n  * `RUN git clone https://github.com/erlang/otp otp_src_27.1.2` we do support and test with Erlang 27. However our packages still ship with 25. Would it be possible to see if 25 would act the same?\r\n\r\n  * Does running the QuickJS scanner show any discrepancies or crashes in the logs against the cluster, specifically for the stuck indexes? https://docs.couchdb.org/en/stable/best-practices/jsdevel.html#scanning-for-quickjs-incompatibilities\r\n  \r\n  * Do indexes build with Spidermonkey engine? (ensure to restart the nodes after toggling the config settings as in 3.4.2 the engine setting doesn't update at runtime) \r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2501965116/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2504275558","html_url":"https://github.com/apache/couchdb/issues/5343#issuecomment-2504275558","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5343","id":2504275558,"node_id":"IC_kwDOAAMmUc6VRDZm","user":{"login":"sensiblearts","id":805314,"node_id":"MDQ6VXNlcjgwNTMxNA==","avatar_url":"https://avatars.githubusercontent.com/u/805314?v=4","gravatar_id":"","url":"https://api.github.com/users/sensiblearts","html_url":"https://github.com/sensiblearts","followers_url":"https://api.github.com/users/sensiblearts/followers","following_url":"https://api.github.com/users/sensiblearts/following{/other_user}","gists_url":"https://api.github.com/users/sensiblearts/gists{/gist_id}","starred_url":"https://api.github.com/users/sensiblearts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sensiblearts/subscriptions","organizations_url":"https://api.github.com/users/sensiblearts/orgs","repos_url":"https://api.github.com/users/sensiblearts/repos","events_url":"https://api.github.com/users/sensiblearts/events{/privacy}","received_events_url":"https://api.github.com/users/sensiblearts/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-27T16:14:48Z","updated_at":"2024-11-27T16:14:48Z","author_association":"NONE","body":"@big-r81 , I started with a fresh data folder and initialized the single node db with `http://127.0.0.1:5984/_utils/#setup`. Note that it is using the same local.ini file (with `chttpd_auth` settings (`secret`, `hash_algorithms` == `sha256, sha`).\r\n\r\nNext, I ran my (elixir) code that was working before, to 1) create a user, 2) create the user's db, and 3) set security settings on the db. Again, I get `Unauthorized`.\r\n\r\nThe only think that I can think of is that the couch **secret**, even though it is the same as it was, in the Fauxton settings, is not valid.\r\n\r\nCan you point me to link(s) to explain **how to reset the secret** and generate proper tokens for a per-user database? Below shows how I'm currently doing the token. (I changed the secret by adding it to [chttpd_auth] in local.ini, but I get the same result. Also, I thought couch was supposed to hash it and write it back to the ini file, but I see only what I originally typed in, no hash.)\r\n\r\nHow I'm using the token, in the code for the request headers:\r\n\r\n```elixir\r\ndefp cb_token do\r\n    couch_secret = Application.get_env(:njeco, :couch_secret)\r\n    couch_admin = Application.get_env(:njeco, :couch_admin)\r\n    :crypto.mac(:hmac, :sha256, couch_secret, couch_admin) |> Base.encode16 |> String.downcase\r\n  end\r\n\r\n  defp headers do\r\n    [\r\n      {\"Access-Control-Allow-Origin\", \"*\"},\r\n      {\"Content-Type\", \"application/json\"},\r\n      {\"X-Auth-CouchDB-UserName\", Application.get_env(:njeco, :couch_admin)},\r\n      {\"X-Auth-CouchDB-Roles\", \"_admin\"},\r\n      {\"X-Auth-CouchDB-Token\", cb_token()},\r\n      {\"Accept\", \"Application/json; Charset=utf-8\"}\r\n    ]\r\n  end\r\n```\r\n\r\nAnd a snippet of the responses:\r\n```\r\nuser create:\r\n  status: 401,\r\n  body: \"{\\\"error\\\":\\\"unauthorized\\\",\\\"reason\\\":\\\"You are not authorized to access this db.\\\"}\\n\",\r\n \r\nsec create:\r\n  status: 401,\r\n  body: \"{\\\"error\\\":\\\"unauthorized\\\",\\\"reason\\\":\\\"You are not a server admin.\\\"}\\n\",\r\n db create:\r\n  status: 404,\r\n  body: \"{\\\"error\\\":\\\"not_found\\\",\\\"reason\\\":\\\"Database does not exist.\\\"}\\n\",\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2504275558/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2504366019","html_url":"https://github.com/apache/couchdb/issues/5343#issuecomment-2504366019","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5343","id":2504366019,"node_id":"IC_kwDOAAMmUc6VRZfD","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-27T16:57:58Z","updated_at":"2024-11-27T16:57:58Z","author_association":"CONTRIBUTOR","body":"Are there maybe any other config files in `local.d/` or `default.d/` directory?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2504366019/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2504431546","html_url":"https://github.com/apache/couchdb/issues/5343#issuecomment-2504431546","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5343","id":2504431546,"node_id":"IC_kwDOAAMmUc6VRpe6","user":{"login":"sensiblearts","id":805314,"node_id":"MDQ6VXNlcjgwNTMxNA==","avatar_url":"https://avatars.githubusercontent.com/u/805314?v=4","gravatar_id":"","url":"https://api.github.com/users/sensiblearts","html_url":"https://github.com/sensiblearts","followers_url":"https://api.github.com/users/sensiblearts/followers","following_url":"https://api.github.com/users/sensiblearts/following{/other_user}","gists_url":"https://api.github.com/users/sensiblearts/gists{/gist_id}","starred_url":"https://api.github.com/users/sensiblearts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sensiblearts/subscriptions","organizations_url":"https://api.github.com/users/sensiblearts/orgs","repos_url":"https://api.github.com/users/sensiblearts/repos","events_url":"https://api.github.com/users/sensiblearts/events{/privacy}","received_events_url":"https://api.github.com/users/sensiblearts/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-27T17:32:23Z","updated_at":"2024-11-27T17:32:23Z","author_association":"NONE","body":"Yes. I think you may have found it.\r\n\r\nThere are 3 files in `default.d` that seem not relevant and one in `local.d` that seems to be the problem.  The `10-admins.ini` file seems to be overriding `local.ini`.\r\n\r\nIn `10-admins.ini`, the `[chttpd_auth]` section is **blank**, and there is a `secret` in the `[admins]` section -- which looks nothing like the secret as visible in Fauxton:\r\n\r\n```\r\n\r\n# Package-introduced administrative user\r\n[admins]\r\nadmin = -pbkdf2:sha256-a38a96de..blah..blah..,600000\r\nnja_admin = -pbkdf2-1ee14f32adb86..blah...blah...,10\r\nsecret = -pbkdf2:sha256-69537672cb...blah...blah...,600000\r\n\r\n[couchdb]\r\nuuid = 70385bcb4e0b8502e14e1577dc037af4\r\n\r\n[chttpd_auth]\r\n\r\n\r\n[couch_httpd_auth]\r\ntimeout = 6000\r\n\r\n[chttpd]\r\nenable_cors = true\r\nbind_address = 0.0.0.0\r\nport = 5984\r\n\r\n[cors]\r\norigins = *\r\ncredentials = true\r\nheaders = Accept, Content-Type, Access-Control-Allow-Origin, X-Auth-CouchDB-Token, X-Auth-CouchDB-UserName, X-Auth-CouchDB-Roles\r\nmethods = GET, PUT, POST, HEAD, DELETE\r\n\r\n[couch_peruser]\r\nenable = false\r\n\r\n[cluster]\r\nn = 1\r\n\r\n```\r\n\r\nI can probably get this fixed, and I see discussion of the `10-admins.ini` at [https://docs.couchdb.org/en/stable/config/auth.html](https://docs.couchdb.org/en/stable/config/auth.html), but I **need to understand how/why apt upgrade overwrote my previous settings** -- should I make all my settings in local.ini and delete the 10-admins.ini, or backup 10-admins.ini and restore it after apt-upgrade, or...?\r\n\r\nThanks for any advice.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2504431546/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2504596514","html_url":"https://github.com/apache/couchdb/issues/5346#issuecomment-2504596514","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5346","id":2504596514,"node_id":"IC_kwDOAAMmUc6VSRwi","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-27T18:59:34Z","updated_at":"2024-11-27T18:59:34Z","author_association":"CONTRIBUTOR","body":"```shell\r\n#!/bin/bash\r\n\r\nDB=http://adm:pass@localhost:15984/db\r\n\r\ncurl -s -XDELETE $DB  > /dev/null\r\ncurl -s -XPUT $DB'?q=1&n=1' > /dev/null\r\n\r\nread -p 'About to insert att1'\r\ncurl -s -XPUT $DB/doc/att1 -d 'xkadfasduaosidufyasidfuyasoidufyaosidufyoasidufyoasidufyaosudyfoasidufyaosiduyoasidufyaosidyasdfaosdiuyaosidufaosdufyaosudfyoasudfyoasudyfoasdyfoasuydfausydfuayusiduncjchueyoudhudhcudaoyufasdfsudhfasdfas8dfhasdofasdufhasdfuasodfhasdfas8udfhasudfhasdufahsdjfashdfalsdfjhasdlfjahsdfasdiufashdfasjdlfhasdfasdfaosdufahsdjuncjdcdhfdiuafhasdufhasdfas8d7fyasdufhasdfasd7fyas8df7yasdfujasudhfas8d7fysaduiasdhfasidfuhasdiufhasdfaosdufyasudfhasdc7d8chdihfa79dsfyasdufahsdfaosdufyasdofuahsdfhujasdhfaudsfhyuasdfyasduhdcudhcdudha9d7fya7sudfhasdujfhads8fasdyfasdiofhasdiuhicadysufashdfiasdfhaosudfhaosudfhasodifuhasoiuchdoaidhfiuasdfyuaherjjmdjdjddjhjahjdfajsdfhasldfhjasdfhasd8fuhasodfuahsdfjehljhfaljdshfalskdjhasldjhfadsjkfhalskjdhfasljkdfhaklshdfahsdfjhaskdfhaksdjfhaksldfhasdufashdfoasdufhalsdjfahsdfaosdufasodhfajsdflakshdfjasldhfjasdfhasjdhfajshdfalkshdfasdifaosudfhasljfdhadslfjashdfljashdfljashdflakjsdhfalskjdhflkajshdfklashdflkjsahdfalsjdhfalksjdhflaskjdfhalskdjhasdfasjdlfkahsdflaksjdfhasdfjklasdhalskdfhasldkfjashdflaksjdfhaslkdalskjdfhasdfao9sdfuadsfajsdfhasdjfhasdfljasdhfalsjdfhasdlkjfhasldjfhasdlfjhasdlfjkhasdjfasdlfkahsjdfahsdflkajsdhalskjdhalskdfhasldkfjhaskdjfhasldkfjhasldfjkhaslkdjhaslkdfjlakshdfjalsdkhfalksdjhasdufasdjlflahsdfkalsdfhajsdufhasdfaosdufyasudfhasdc7d8chdihfa79dsfyasdufahsdfaosdufyasdofuahsdfhujasdhfaudsfhyuasdfyasduhdcudhcdudha9d7fya7sudfhasdujfhads8fasdyfasdiofhasdiuhicadysufashdfiasdfhaosudfhaosudfhasodifuhasoiuchdoaidhfiuasdfyuaherjjmdjdjddjhjahjdfajsdfhasldfhjasdfhasd8fuhasodfuahsdfjehljhfaljdshfalskdjhasldjhfadsjkfhalskjdhfasljkdfhaklshdfahsdfjhaskdfhaksdjfhaksldfhasdufashdfoasdufhalsdjfahsdfaosdufasodhfajsdflakshdfjasldhfjasdfhasjdhfajshdfalkufhasdfaosdufyasudfhasdc7d8chdihfa79dsfyasdufahsdfaosdufyasdofuahsdfhujasdhfaudsfhyuasdfyasduhdcudhcdudha9d7fya7sudfhasdujfhads8fasdyfasdiofhasdiuhicadysufashdfiasdfhaosudfhaosudfhasodifuhasoiuchdoaidhfiuasdfyuaherjjmdjdjddjhjahjdfajsdfhasldfhjasdfhasd8fuhasodfuahsdfjehljhfaljdshfalskdjhasldjhfadsjkfhalskjdhfasljkdfhaklshdfahsdfjhaskdfhaksdjfhaksldfhasdufashdfoasdufhalsdjfahsdfaosdufasodhfajsdflakshdfjasldhfjasdfhasjdhfajshdfalkufhasdfaosdufyasudfhasdc7d8chdihfa79dsfyasdufahsdfaosdufyasdofuahsdfhujasdhfaudsfhyuasdfyasduhdcudhcdudha9d7fya7sudfhasdujfhads8fasdyfasdiofhasdiuhicadysufashdfiasdfhaosudfhaosudfhasodifuhasoiuchdoaidhfiuasdfyuaherjjmdjdjddjhjahjdfajsdfhasldfhjasdfhasd8fuhasodfuahsdfjehljhfaljdshfalskdjhasldjhfadsjkfhalskjdhfasljkdfhaklshdfahsdfjhaskdfhaksdjfhaksldfhasdufashdfoasdufhalsdjfahsdfaosdufasodhfajsdflakshdfjasldhfjasdfhasjdhfajshdfalkufhasdfaosdufyasudfhasdc7d8chdihfa79dsfyasdufahsdfaosdufyasdofuahsdfhujasdhfaudsfhyuasdfyasduhdcudhcdudha9d7fya7sudfhasdujfhads8fasdyfasdiofhasdiuhicadysufashdfiasdfhaosudfhaosudfhasodifuhasoiuchdoaidhfiuasdfyuaherjjmdjdjddjhjahjdfajsdfhasldfhjasdfhasd8fuhasodfuahsdfjehljhfaljdshfalskdjhasldjhfadsjkfhalskjdhfasljkdfhaklshdfahsdfjhaskdfhaksdjfhaksldfhasdufashdfoasdufhalsdjfahsdfaosdufasodhfajsdflakshdfjasldhfjasdfhasjdhfajshdfalkufhasdfaosdufyasudfhasdc7d8chdihfa79dsfyasdufahsdfaosdufyasdofuahsdfhujasdhfaudsfhyuasdfyasduhdcudhcdudha9d7fya7sudfhasdujfhads8fasdyfasdiofhasdiuhicadysufashdfiasdfhaosudfhaosudfhasodifuhasoiuchdoaidhfiuasdfyuaherjjmdjdjddjhjahjdfajsdfhasldfhjasdfhasd8fuhasodfuahsdfjehljhfaljdshfalskdjhasldjhfadsjkfhalskjdhfasljkdfhaklshdfahsdfjhaskdfhaksdjfhaksldfhasdufashdfoasdufhalsdjfahsdfaosdufasodhfajsdflakshdfjasldhfjasdfhasjdhfajshdfalkufhasdfaosdufyasudfhasdc7d8chdihfa79dsfyasdufahsdfaosdufyasdofuahsdfhujasdhfaudsfhyuasdfyasduhdcudhcdudha9d7fya7sudfhasdujfhads8fasdyfasdiofhasdiuhicadysufashdfiasdfhaosudfhaosudfhasodifuhasoiuchdoaidhfiuasdfyuaherjjmdjdjddjhjahjdfajsdfhasldfhjasdfhasd8fuhasodfuahsdfjehljhfaljdshfalskdjhasldjhfadsjkfhalskjdhfasljkdfhaklshdfahsdfjhaskdfhaksdjfhaksldfhasdufashdfoasdufhalsdjfahsdfaosdufasodhfajsdflakshdfjasldhfjasdfhasjdhfajshdfalkufhasdfaosdufyasudfhasdc7d8chdihfa79dsfyasdufahsdfaosdufyasdofuahsdfhujasdhfaudsfhyuasdfyasduhdcudhcdudha9d7fya7sudfhasdujfhads8fasdyfasdiofhasdiuhicadysufashdfiasdfhaosudfhaosudfhasodifuhasoiuchdoaidhfiuasdfyuaherjjmdjdjddjhjahjdfajsdfhasldfhjasdfhasd8fuhasodfuahsdfjehljhfaljdshfalskdjhasldjhfadsjkfhalskjdhfasljkdfhaklshdfahsdfjhaskdfhaksdjfhaksldfhasdufashdfoasdufhalsdjfahsdfaosdufasodhfajsdflakshdfjasldhfjasdfhasjdhfajshdfalk' -H'Content-type:application/octet-stream'\r\ncurl -s $DB | jq '.sizes'\r\n\r\nread -p 'About to insert att2'\r\ncurl -s -XPUT $DB/doc/att2'?rev=1-55504cb75fa1bae939337932ed23dd0b' -d 'xkadfasduaosidufyasidfuyasoidufyaosidufyoasidufyoasidufyaosudyfoasidufyaosiduyoasidufyaosidyasdfaosdiuyaosidufaosdufyaosudfyoasudfyoasudyfoasdyfoasuydfausydfuayusiduncjchueyoudhudhcudaoyufasdfsudhfasdfas8dfhasdofasdufhasdfuasodfhasdfas8udfhasudfhasdufahsdjfashdfalsdfjhasdlfjahsdfasdiufashdfasjdlfhasdfasdfaosdufahsdjuncjdcdhfdiuafhasdufhasdfas8d7fyasdufhasdfasd7fyas8df7yasdfujasudhfas8d7fysaduiasdhfasidfuhasdiufhasdfaosdufyasudfhasdc7d8chdihfa79dsfyasdufahsdfaosdufyasdofuahsdfhujasdhfaudsfhyuasdfyasduhdcudhcdudha9d7fya7sudfhasdujfhads8fasdyfasdiofhasdiuhicadysufashdfiasdfhaosudfhaosudfhasodifuhasoiuchdoaidhfiuasdfyuaherjjmdjdjddjhjahjdfajsdfhasldfhjasdfhasd8fuhasodfuahsdfjehljhfaljdshfalskdjhasldjhfadsjkfhalskjdhfasljkdfhaklshdfahsdfjhaskdfhaksdjfhaksldfhasdufashdfoasdufhalsdjfahsdfaosdufasodhfajsdflakshdfjasldhfjasdfhasjdhfajshdfalkshdfasdifaosudfhasljfdhadslfjashdfljashdfljashdflakjsdhfalskjdhflkajshdfklashdflkjsahdfalsjdhfalksjdhflaskjdfhalskdjhasxdfasjdlfkahsdflaksjdfhasdfjklasdhalskdfhasldkfjashdflaksjdfhaslkdalskjdfhasdfao9sdfuadsfajsdfhasdjfhasdfljasdhfalsjdfhasdlkjfhasldjfhasdlfjhasdlfjkhasdjfasdlfkahsjdfahsdflkajsdhalskjdhalskdfhasldkfjhaskdjfhasldkfjhasldfjkhaslkdjhaslkdfjlakshdfjalsdkhfalksdjhasdufasdjlflahsdfkalsdfhajsdufhasdfaosdufyasudfhasdc7d8chdihfa79dsfyasdufahsdfaosdufyasdofuahsdfhujasdhfaudsfhyuasdfyasduhdcudhcdudha9d7fya7sudfhasdujfhads8fasdyfasdiofhasdiuhicadysufashdfiasdfhaosudfhaosudfhasodifuhasoiuchdoaidhfiuasdfyuaherjjmdjdjddjhjahjdfajsdfhasldfhjasdfhasd8fuhasodfuahsdfjehljhfaljdshfalskdjhasldjhfadsjkfhalskjdhfasljkdfhaklshdfahsdfjhaskdfhaksdjfhaksldfhasdufashdfoasdufhalsdjfahsdfaosdufasodhfajsdflakshdfjasldhfjasdfhasjdhfajshdfalkufhasdfaosdufyasudfhasdc7d8chdihfa79dsfyasdufahsdfaosdufyasdofuahsdfhujasdhfaudsfhyuasdfyasduhdcudhcdudha9d7fya7sudfhasdujfhads8fasdyfasdiofhasdiuhicadysufashdfiasdfhaosudfhaosudfhasodifuhasoiuchdoaidhfiuasdfyuaherjjmdjdjddjhjahjdfajsdfhasldfhjasdfhasd8fuhasodfuahsdfjehljhfaljdshfalskdjhasldjhfadsjkfhalskjdhfasljkdfhaklshdfahsdfjhaskdfhaksdjfhaksldfhasdufashdfoasdufhalsdjfahsdfaosdufasodhfajsdflakshdfjasldhfjasdfhasjdhfajshdfalkufhasdfaosdufyasudfhasdc7d8chdihfa79dsfyasdufahsdfaosdufyasdofuahsdfhujasdhfaudsfhyuasdfyasduhdcudhcdudha9d7fya7sudfhasdujfhads8fasdyfasdiofhasdiuhicadysufashdfiasdfhaosudfhaosudfhasodifuhasoiuchdoaidhfiuasdfyuaherjjmdjdjddjhjahjdfajsdfhasldfhjasdfhasd8fuhasodfuahsdfjehljhfaljdshfalskdjhasldjhfadsjkfhalskjdhfasljkdfhaklshdfahsdfjhaskdfhaksdjfhaksldfhasdufashdfoasdufhalsdjfahsdfaosdufasodhfajsdflakshdfjasldhfjasdfhasjdhfajshdfalkufhasdfaosdufyasudfhasdc7d8chdihfa79dsfyasdufahsdfaosdufyasdofuahsdfhujasdhfaudsfhyuasdfyasduhdcudhcdudha9d7fya7sudfhasdujfhads8fasdyfasdiofhasdiuhicadysufashdfiasdfhaosudfhaosudfhasodifuhasoiuchdoaidhfiuasdfyuaherjjmdjdjddjhjahjdfajsdfhasldfhjasdfhasd8fuhasodfuahsdfjehljhfaljdshfalskdjhasldjhfadsjkfhalskjdhfasljkdfhaklshdfahsdfjhaskdfhaksdjfhaksldfhasdufashdfoasdufhalsdjfahsdfaosdufasodhfajsdflakshdfjasldhfjasdfhasjdhfajshdfalkufhasdfaosdufyasudfhasdc7d8chdihfa79dsfyasdufahsdfaosdufyasdofuahsdfhujasdhfaudsfhyuasdfyasduhdcudhcdudha9d7fya7sudfhasdujfhads8fasdyfasdiofhasdiuhicadysufashdfiasdfhaosudfhaosudfhasodifuhasoiuchdoaidhfiuasdfyuaherjjmdjdjddjhjahjdfajsdfhasldfhjasdfhasd8fuhasodfuahsdfjehljhfaljdshfalskdjhasldjhfadsjkfhalskjdhfasljkdfhaklshdfahsdfjhaskdfhaksdjfhaksldfhasdufashdfoasdufhalsdjfahsdfaosdufasodhfajsdflakshdfjasldhfjasdfhasjdhfajshdfalkufhasdfaosdufyasudfhasdc7d8chdihfa79dsfyasdufahsdfaosdufyasdofuahsdfhujasdhfaudsfhyuasdfyasduhdcudhcdudha9d7fya7sudfhasdujfhads8fasdyfasdiofhasdiuhicadysufashdfiasdfhaosudfhaosudfhasodifuhasoiuchdoaidhfiuasdfyuaherjjmdjdjddjhjahjdfajsdfhasldfhjasdfhasd8fuhasodfuahsdfjehljhfaljdshfalskdjhasldjhfadsjkfhalskjdhfasljkdfhaklshdfahsdfjhaskdfhaksdjfhaksldfhasdufashdfoasdufhalsdjfahsdfaosdufasodhfajsdflakshdfjasldhfjasdfhasjdhfajshdfalkufhasdfaosdufyasudfhasdc7d8chdihfa79dsfyasdufahsdfaosdufyasdofuahsdfhujasdhfaudsfhyuasdfyasduhdcudhcdudha9d7fya7sudfhasdujfhads8fasdyfasdiofhasdiuhicadysufashdfiasdfhaosudfhaosudfhasodifuhasoiuchdoaidhfiuasdfyuaherjjmdjdjddjhjahjdfajsdfhasldfhjasdfhasd8fuhasodfuahsdfjehljhfaljdshfalskdjhasldjhfadsjkfhalskjdhfasljkdfhaklshdfahsdfjhaskdfhaksdjfhaksldfhasdufashdfoasdufhalsdjfahsdfaosdufasodhfajsdflakshdfjasldhfjasdfhasjdhfajshdfalk' -H'Content-type:application/octet-stream'\r\ncurl -s $DB | jq '.sizes'\r\n\r\nread -p 'About to delete att1'\r\ncurl -s -XPUT -H'Content-type:application/json' $DB/doc -d '{\r\n  \"_rev\":\"2-f7d4ecdd7c33669864310d35e0faa0ec\",\r\n  \"_attachments\":{\r\n       \"att2\":{\"content_type\":\"application/octet-stream\",\"revpos\":2,\"digest\":\"md5-bPnol8CWtSSZwYw/k80JUA==\",\"length\":4273,\"stub\":true}\r\n  }\r\n}'\r\ncurl -s $DB | jq '.sizes'\r\n\r\nread -p 'About to delete att2'\r\ncurl -s -XPUT -H'Content-type:application/json' $DB/doc -d '{\r\n  \"_rev\":\"3-56c76fcbdfc724864044242095700f2f\",\r\n  \"_attachments\":{}\r\n}'\r\ncurl -s $DB | jq '.sizes'\r\n\r\nread -p 'About to delete doc'\r\ncurl -s -XDELETE $DB/doc'?rev=4-d3bc1f0e83f11e7aba4a9fe7ade69b1f'\r\ncurl -s $DB | jq '.sizes'\r\n```\r\n\r\n```shell\r\n./add_and_delete_att.sh\r\nAbout to insert att1\r\n{\"ok\":true,\"id\":\"doc\",\"rev\":\"1-55504cb75fa1bae939337932ed23dd0b\"}\r\n{\r\n  \"file\": 16578,\r\n  \"external\": 4275,\r\n  \"active\": 4662\r\n}\r\nAbout to insert att2\r\n{\"ok\":true,\"id\":\"doc\",\"rev\":\"2-f7d4ecdd7c33669864310d35e0faa0ec\"}\r\n{\r\n  \"file\": 24770,\r\n  \"external\": 8549,\r\n  \"active\": 9106\r\n}\r\nAbout to delete att1\r\n{\"ok\":true,\"id\":\"doc\",\"rev\":\"3-56c76fcbdfc724864044242095700f2f\"}\r\n{\r\n  \"file\": 28866,\r\n  \"external\": 4276,\r\n  \"active\": 4857\r\n}\r\nAbout to delete att2\r\n{\"ok\":true,\"id\":\"doc\",\"rev\":\"4-d3bc1f0e83f11e7aba4a9fe7ade69b1f\"}\r\n{\r\n  \"file\": 32956,\r\n  \"external\": 2,\r\n  \"active\": 533\r\n}\r\nAbout to delete doc\r\n{\"ok\":true,\"id\":\"doc\",\"rev\":\"5-aee6ee5a58ff4e4d69c4f10098e1078e\"}\r\n{\r\n  \"file\": 37058,\r\n  \"external\": 2,\r\n  \"active\": 598\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2504596514/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2504638349","html_url":"https://github.com/apache/couchdb/issues/5342#issuecomment-2504638349","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5342","id":2504638349,"node_id":"IC_kwDOAAMmUc6VSb-N","user":{"login":"aduchate","id":2221917,"node_id":"MDQ6VXNlcjIyMjE5MTc=","avatar_url":"https://avatars.githubusercontent.com/u/2221917?v=4","gravatar_id":"","url":"https://api.github.com/users/aduchate","html_url":"https://github.com/aduchate","followers_url":"https://api.github.com/users/aduchate/followers","following_url":"https://api.github.com/users/aduchate/following{/other_user}","gists_url":"https://api.github.com/users/aduchate/gists{/gist_id}","starred_url":"https://api.github.com/users/aduchate/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aduchate/subscriptions","organizations_url":"https://api.github.com/users/aduchate/orgs","repos_url":"https://api.github.com/users/aduchate/repos","events_url":"https://api.github.com/users/aduchate/events{/privacy}","received_events_url":"https://api.github.com/users/aduchate/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-27T19:28:37Z","updated_at":"2024-11-27T19:28:37Z","author_association":"NONE","body":"pid:\r\n\r\n`erlang:process_info(Pid, current_stacktrace).`\r\n\r\n```\r\n(couchdb@couchdb-02-lim-04.vrack.icure.cloud)1> erlang:process_info(<0.18820539.1>, current_stacktrace).\r\n{current_stacktrace,[{gen,do_call,4,\r\n                          [{file,\"gen.erl\"},{line,241}]},\r\n                     {gen_server,call,3,[{file,\"gen_server.erl\"},{line,1218}]},\r\n                     {couch_work_queue,dequeue,2,\r\n                                       [{file,\"src/couch_work_queue.erl\"},{line,50}]},\r\n                     {couch_mrview_updater,map_docs,2,\r\n                                           [{file,\"src/couch_mrview_updater.erl\"},{line,154}]}]}\r\n```\r\n\r\n`erlang:process_info(<0.18820539.1>).`\r\n\r\n```\r\n[{current_function,{gen,do_call,4}},\r\n {initial_call,{erlang,apply,2}},\r\n {status,waiting},\r\n {message_queue_len,0},\r\n {links,[<0.1754697.1>]},\r\n {dictionary,[{task_status_update,{{0,0,0},500000}},\r\n              {io_priority,{view_update,<<\"shards/80000000-9fffffff/icure-ms-elsa-vancaster-cf8a1abf-ed\"...>>,\r\n                                        <<\"_design/Message-DataOwner\">>}},\r\n              {task_status_props,[{changes_done,42824},\r\n                                  {database,<<\"shards/80000000-9fffffff/icure-ms-elsa-vancaster\"...>>},\r\n                                  {design_document,<<\"_design/Message-DataOwner\">>},\r\n                                  {indexer_pid,<<\"<0.180092364.0>\">>},\r\n                                  {progress,13},\r\n                                  {started_on,1732686977},\r\n                                  {total_changes,324883},\r\n                                  {type,indexer},\r\n                                  {updated_on,1732687030}]}]},\r\n {trap_exit,false},\r\n {error_handler,error_handler},\r\n {priority,normal},\r\n {group_leader,<0.249.0>},\r\n {total_heap_size,1196281},\r\n {heap_size,196650},\r\n {stack_size,16},\r\n {reductions,12771499},\r\n {garbage_collection,[{max_heap_size,#{error_logger => true,include_shared_binaries => false,\r\n                                       kill => true,size => 0}},\r\n                      {min_bin_vheap_size,46422},\r\n                      {min_heap_size,233},\r\n                      {fullsweep_after,65535},\r\n                      {minor_gcs,220}]},\r\n {suspending,[]}]\r\n```\r\n\r\nindexer_pid:\r\n\r\n`erlang:process_info(<0.180092364.0>, current_stacktrace).`\r\n\r\n```\r\n{current_stacktrace,[{gen_server,loop,7,\r\n                                 [{file,\"gen_server.erl\"},{line,2250}]},\r\n                     {proc_lib,init_p_do_apply,3,\r\n                               [{file,\"proc_lib.erl\"},{line,329}]}]}\r\n```\r\n`erlang:process_info(<0.180092364.0>).`\r\n\r\n```\r\n[{current_function,{gen_server,loop,7}},\r\n {initial_call,{proc_lib,init_p,5}},\r\n {status,waiting},\r\n {message_queue_len,0},\r\n {links,[<0.175818994.0>,<0.179769987.0>,<0.178322255.0>,\r\n         <0.580.0>]},\r\n {dictionary,[{'$initial_call',{couch_index,init,1}},\r\n              {io_priority,{view_update,<<\"shards/80000000-9fffffff/icure-ms-elsa-vancaster-cf8a1abf-ed\"...>>}},\r\n              {'$ancestors',[<0.180269918.0>]}]},\r\n {trap_exit,false},\r\n {error_handler,error_handler},\r\n {priority,normal},\r\n {group_leader,<0.249.0>},\r\n {total_heap_size,17730},\r\n {heap_size,6772},\r\n {stack_size,11},\r\n {reductions,156876},\r\n {garbage_collection,[{max_heap_size,#{error_logger => true,include_shared_binaries => false,\r\n                                       kill => true,size => 0}},\r\n                      {min_bin_vheap_size,46422},\r\n                      {min_heap_size,233},\r\n                      {fullsweep_after,65535},\r\n                      {minor_gcs,144}]},\r\n {suspending,[]}]\r\n```\r\n\r\nA stuck indexer never moves anymore nothing changes in the values once it is stuck\r\n\r\nThe stuck indexers are completely random. After killing the stuck indexer, the index ends up building correctly.\r\n\r\nQuickJS scanner show no problem. The indexes used to build correctly with spidermonkey but in this current build, spidermonkey is broken so, I cannot check if the problem also arises with spidermonkey.\r\n\r\nI'll try building with otp 25 and let you know.\r\n\r\nThanks for the support\r\nA.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2504638349/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2504851214","html_url":"https://github.com/apache/couchdb/issues/5343#issuecomment-2504851214","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5343","id":2504851214,"node_id":"IC_kwDOAAMmUc6VTP8O","user":{"login":"sensiblearts","id":805314,"node_id":"MDQ6VXNlcjgwNTMxNA==","avatar_url":"https://avatars.githubusercontent.com/u/805314?v=4","gravatar_id":"","url":"https://api.github.com/users/sensiblearts","html_url":"https://github.com/sensiblearts","followers_url":"https://api.github.com/users/sensiblearts/followers","following_url":"https://api.github.com/users/sensiblearts/following{/other_user}","gists_url":"https://api.github.com/users/sensiblearts/gists{/gist_id}","starred_url":"https://api.github.com/users/sensiblearts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sensiblearts/subscriptions","organizations_url":"https://api.github.com/users/sensiblearts/orgs","repos_url":"https://api.github.com/users/sensiblearts/repos","events_url":"https://api.github.com/users/sensiblearts/events{/privacy}","received_events_url":"https://api.github.com/users/sensiblearts/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-27T21:53:43Z","updated_at":"2024-11-27T21:53:43Z","author_association":"NONE","body":"For anyone interested, this is a good explanation of 10-admins.ini, [https://lindevs.com/reset-couchdb-admin-password-in-linux/](https://lindevs.com/reset-couchdb-admin-password-in-linux/).\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2504851214/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2506493715","html_url":"https://github.com/apache/couchdb/pull/5321#issuecomment-2506493715","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5321","id":2506493715,"node_id":"IC_kwDOAAMmUc6VZg8T","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-28T16:42:15Z","updated_at":"2024-11-28T16:42:15Z","author_association":"CONTRIBUTOR","body":"@janl fyi: \r\nI discussed with Nick (@nickva), that we want to update our CI (additional images) and then test this branch against it, with different SpiderMonkey versions, before merging this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2506493715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2506654193","html_url":"https://github.com/apache/couchdb/issues/5343#issuecomment-2506654193","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5343","id":2506654193,"node_id":"IC_kwDOAAMmUc6VaIHx","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-28T18:57:17Z","updated_at":"2024-11-29T16:18:59Z","author_association":"CONTRIBUTOR","body":"Yeah, there is an order, how config files are used. It's written [here](https://docs.couchdb.org/en/stable/config/intro.html) in the documentation. As you already figured out, the `10-admins.ini` file is the last one in the config file chain, so all new and edited values are written to it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2506654193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2508083911","html_url":"https://github.com/apache/couchdb/issues/5343#issuecomment-2508083911","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5343","id":2508083911,"node_id":"IC_kwDOAAMmUc6VflLH","user":{"login":"sensiblearts","id":805314,"node_id":"MDQ6VXNlcjgwNTMxNA==","avatar_url":"https://avatars.githubusercontent.com/u/805314?v=4","gravatar_id":"","url":"https://api.github.com/users/sensiblearts","html_url":"https://github.com/sensiblearts","followers_url":"https://api.github.com/users/sensiblearts/followers","following_url":"https://api.github.com/users/sensiblearts/following{/other_user}","gists_url":"https://api.github.com/users/sensiblearts/gists{/gist_id}","starred_url":"https://api.github.com/users/sensiblearts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sensiblearts/subscriptions","organizations_url":"https://api.github.com/users/sensiblearts/orgs","repos_url":"https://api.github.com/users/sensiblearts/repos","events_url":"https://api.github.com/users/sensiblearts/events{/privacy}","received_events_url":"https://api.github.com/users/sensiblearts/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-29T16:03:33Z","updated_at":"2024-11-29T16:03:33Z","author_association":"NONE","body":"@big-r81 Thank you again for your help.\r\n\r\nIt took a lot of attempts, moving and changing config settings. It seems the thing that finally worked was:\r\n- moving all the `chttpd` and `chttpd_auth` stuff out of local.ini and into 10-admins.ini\r\n- deleting the `secret` from the `ini` file and letting couch regenerate its own secret, then using that one in my application to generate the token.\r\n\r\nI tried a number of times changing the secret, but I was doing it by editing the ini file. I think the key is: **when you want to change the secret, delete it in the ini file and let couch create it.**\r\n\r\n(Also, I could be wrong because I'm basing this on my memory, but I think that just after the apt upgrade, the 10-admins.ini file -- modified by  the upgrade -- had the secret under the [admins] block, whereas it should be under the [chttpd_auth] block.)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2508083911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2508110521","html_url":"https://github.com/apache/couchdb/issues/5343#issuecomment-2508110521","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5343","id":2508110521,"node_id":"IC_kwDOAAMmUc6Vfrq5","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-29T16:23:49Z","updated_at":"2024-11-29T16:23:49Z","author_association":"CONTRIBUTOR","body":"> (Also, I could be wrong because I'm basing this on my memory, but I think that just after the apt upgrade, the 10-admins.ini file -- modified by the upgrade -- had the secret under the [admins] block, whereas it should be under the [chttpd_auth] block.)\r\n\r\nOkay, if you have a reproducer, please open a new ticket. The `secret` needs to be under `[chttpd_auth]`. If you have a line under `[admins]`, then you have a database admin user called `secret`.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2508110521/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2510288443","html_url":"https://github.com/apache/couchdb/issues/5312#issuecomment-2510288443","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5312","id":2510288443,"node_id":"IC_kwDOAAMmUc6Vn_Y7","user":{"login":"dasmido","id":29209873,"node_id":"MDQ6VXNlcjI5MjA5ODcz","avatar_url":"https://avatars.githubusercontent.com/u/29209873?v=4","gravatar_id":"","url":"https://api.github.com/users/dasmido","html_url":"https://github.com/dasmido","followers_url":"https://api.github.com/users/dasmido/followers","following_url":"https://api.github.com/users/dasmido/following{/other_user}","gists_url":"https://api.github.com/users/dasmido/gists{/gist_id}","starred_url":"https://api.github.com/users/dasmido/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dasmido/subscriptions","organizations_url":"https://api.github.com/users/dasmido/orgs","repos_url":"https://api.github.com/users/dasmido/repos","events_url":"https://api.github.com/users/dasmido/events{/privacy}","received_events_url":"https://api.github.com/users/dasmido/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-01T22:52:12Z","updated_at":"2024-12-01T22:52:12Z","author_association":"NONE","body":"@mikkimichaelis I face similar issue, Try snap \r\nhttps://docs.couchdb.org/en/stable/install/snap.html\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2510288443/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2516173728","html_url":"https://github.com/apache/couchdb/issues/1428#issuecomment-2516173728","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1428","id":2516173728,"node_id":"IC_kwDOAAMmUc6V-cOg","user":{"login":"bendian64","id":160976248,"node_id":"U_kgDOCZhNeA","avatar_url":"https://avatars.githubusercontent.com/u/160976248?v=4","gravatar_id":"","url":"https://api.github.com/users/bendian64","html_url":"https://github.com/bendian64","followers_url":"https://api.github.com/users/bendian64/followers","following_url":"https://api.github.com/users/bendian64/following{/other_user}","gists_url":"https://api.github.com/users/bendian64/gists{/gist_id}","starred_url":"https://api.github.com/users/bendian64/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bendian64/subscriptions","organizations_url":"https://api.github.com/users/bendian64/orgs","repos_url":"https://api.github.com/users/bendian64/repos","events_url":"https://api.github.com/users/bendian64/events{/privacy}","received_events_url":"https://api.github.com/users/bendian64/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-04T04:39:07Z","updated_at":"2024-12-04T04:39:07Z","author_association":"NONE","body":"Is this already done?  There's `mis.exs` in the repo and the configure script references rebar3.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2516173728/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2518043197","html_url":"https://github.com/apache/couchdb/issues/1428#issuecomment-2518043197","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1428","id":2518043197,"node_id":"IC_kwDOAAMmUc6WFko9","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-04T17:05:34Z","updated_at":"2024-12-04T17:05:34Z","author_association":"CONTRIBUTOR","body":"The migration to `rebar3` turned out to be not possible. The `mix.exs` is used by Elixir test suite and `rebar3` is needed to compile one of the dependencies.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2518043197/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2522921248","html_url":"https://github.com/apache/couchdb/issues/5349#issuecomment-2522921248","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5349","id":2522921248,"node_id":"IC_kwDOAAMmUc6WYLkg","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-06T11:13:10Z","updated_at":"2024-12-06T11:13:10Z","author_association":"MEMBER","body":"are there any other errors?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2522921248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2524711560","html_url":"https://github.com/apache/couchdb/issues/5349#issuecomment-2524711560","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5349","id":2524711560,"node_id":"IC_kwDOAAMmUc6WfAqI","user":{"login":"Frenkenstein6","id":50482109,"node_id":"MDQ6VXNlcjUwNDgyMTA5","avatar_url":"https://avatars.githubusercontent.com/u/50482109?v=4","gravatar_id":"","url":"https://api.github.com/users/Frenkenstein6","html_url":"https://github.com/Frenkenstein6","followers_url":"https://api.github.com/users/Frenkenstein6/followers","following_url":"https://api.github.com/users/Frenkenstein6/following{/other_user}","gists_url":"https://api.github.com/users/Frenkenstein6/gists{/gist_id}","starred_url":"https://api.github.com/users/Frenkenstein6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Frenkenstein6/subscriptions","organizations_url":"https://api.github.com/users/Frenkenstein6/orgs","repos_url":"https://api.github.com/users/Frenkenstein6/repos","events_url":"https://api.github.com/users/Frenkenstein6/events{/privacy}","received_events_url":"https://api.github.com/users/Frenkenstein6/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-07T00:45:33Z","updated_at":"2024-12-07T00:45:33Z","author_association":"NONE","body":"<img width=\"1163\" alt=\"screenshot\" src=\"https://github.com/user-attachments/assets/5abfd15c-41ad-4f63-b6da-948664b787a[](url)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2524711560/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2525275602","html_url":"https://github.com/apache/couchdb/issues/5004#issuecomment-2525275602","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5004","id":2525275602,"node_id":"IC_kwDOAAMmUc6WhKXS","user":{"login":"Clashsoft","id":4145923,"node_id":"MDQ6VXNlcjQxNDU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/4145923?v=4","gravatar_id":"","url":"https://api.github.com/users/Clashsoft","html_url":"https://github.com/Clashsoft","followers_url":"https://api.github.com/users/Clashsoft/followers","following_url":"https://api.github.com/users/Clashsoft/following{/other_user}","gists_url":"https://api.github.com/users/Clashsoft/gists{/gist_id}","starred_url":"https://api.github.com/users/Clashsoft/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Clashsoft/subscriptions","organizations_url":"https://api.github.com/users/Clashsoft/orgs","repos_url":"https://api.github.com/users/Clashsoft/repos","events_url":"https://api.github.com/users/Clashsoft/events{/privacy}","received_events_url":"https://api.github.com/users/Clashsoft/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-07T18:47:35Z","updated_at":"2024-12-07T18:48:47Z","author_association":"NONE","body":"I still get this error all the time. I previously replicated the npm registry onto a server, and now I am trying to move that data over to a new installation. Everything is on 3.4.2. The same happens when replicating npm registry anew. I suppose it is due to invalid documents, but the error message is so unhelpful that I cannot tell. Batch size has no effect (tried 10, 50, 100)\r\n\r\n```\r\ncouchdb-1  | [error] 2024-12-07T18:44:52.152975Z nonode@nohost <0.27785.97> -------- gen_server <0.27785.97> terminated with reason: {worker_died,<0.27902.97>,{bad_return_value,{invalid_json,{1,invalid_json}}}}\r\ncouchdb-1  |   last msg: redacted\r\ncouchdb-1  |      state: [{main_pid,<0.27572.97>},{loop,<0.27558.97>},{source,\"http://localhost:5984/registry/\"},{target,\"https://<target>/registry/\"},{num_readers,0},{pending_fetch,nil},{batch_size,8839}]\r\ncouchdb-1  |     extra: []\r\ncouchdb-1  | [error] 2024-12-07T18:44:52.153094Z nonode@nohost <0.27441.97> -------- CRASH REPORT Process  (<0.27441.97>) with 2 neighbors exited with reason: {worker_died,<0.27902.97>,{bad_return_value,{invalid_json,{1,invalid_json}}}} at gen_server:decode_msg/9(line:909) <= proc_lib:init_p_do_apply/3(line:240); initial_call: {couch_replicator_worker,init,['Argument__1']}, ancestors: [<0.27572.97>,couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 0, links: [<0.27977.97>,<0.28348.97>], dictionary: [], trap_exit: true, status: running, heap_size: 2586, stack_size: 28, reductions: 4170\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2525275602/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2525305402","html_url":"https://github.com/apache/couchdb/issues/5004#issuecomment-2525305402","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5004","id":2525305402,"node_id":"IC_kwDOAAMmUc6WhRo6","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-07T20:44:02Z","updated_at":"2024-12-07T20:44:02Z","author_association":"CONTRIBUTOR","body":"@Clashsoft sorry you're having troubles. Yeah it could be some invalid documents, and I was trying to think what rules we had tightened that we'd fail to validate nowadays...\r\n\r\nAnother reason for `invalid_json` could be anything in the middle (a proxy, for example), that might fail a request due to a timeout, auth, request size, etc. They often return a plain html error page or just cut the json result part-way through, so we get an invalid json error. CouchDB could also do that if document size is too large, perhaps on a timeout as well.\r\n\r\nWonder, if it's always the same document it hits or it's random? We could narrow it down perhaps. If you already have a low batch size, let's also make your replication use less workers and checkpoint more frequently. Say, set https://docs.couchdb.org/en/stable/config/replicator.html#replicator/worker_processes to `1` and https://docs.couchdb.org/en/stable/config/replicator.html#replicator/checkpoint_interval to `5000`, then use force to avoid using `_bulk_get` for fetching so https://docs.couchdb.org/en/stable/config/replicator.html#replicator/use_bulk_get set to `false`. \r\n\r\nAfter those changes re-create the replication to let it continue. It will continue from the last checkpoint. Then watch the request logs on the source and target and see which requests fail (return a 500 error or terminate unexpectedly) those might be the ones the invalid_json is about.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2525305402/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2525309535","html_url":"https://github.com/apache/couchdb/issues/5004#issuecomment-2525309535","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5004","id":2525309535,"node_id":"IC_kwDOAAMmUc6WhSpf","user":{"login":"Clashsoft","id":4145923,"node_id":"MDQ6VXNlcjQxNDU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/4145923?v=4","gravatar_id":"","url":"https://api.github.com/users/Clashsoft","html_url":"https://github.com/Clashsoft","followers_url":"https://api.github.com/users/Clashsoft/followers","following_url":"https://api.github.com/users/Clashsoft/following{/other_user}","gists_url":"https://api.github.com/users/Clashsoft/gists{/gist_id}","starred_url":"https://api.github.com/users/Clashsoft/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Clashsoft/subscriptions","organizations_url":"https://api.github.com/users/Clashsoft/orgs","repos_url":"https://api.github.com/users/Clashsoft/repos","events_url":"https://api.github.com/users/Clashsoft/events{/privacy}","received_events_url":"https://api.github.com/users/Clashsoft/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-07T21:02:09Z","updated_at":"2024-12-07T21:02:09Z","author_association":"NONE","body":"Thanks for the quick response :)\r\nI think it could be the same document. During the many tries I had today, it was always stuck somewhere around this 86-87k mark.\r\n![image](https://github.com/user-attachments/assets/b99cd0db-0c15-470d-b49e-1e6773192f47)\r\n\r\nI will try the suggested settings and report back.\r\nRegarding the proxy issue, there is a (default) nginx ingress controller in front of the target registry.\r\nBut I had the same problems when I defined the replication in the target registry so I believe this is not the issue.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2525309535/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2525314504","html_url":"https://github.com/apache/couchdb/issues/5004#issuecomment-2525314504","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5004","id":2525314504,"node_id":"IC_kwDOAAMmUc6WhT3I","user":{"login":"Clashsoft","id":4145923,"node_id":"MDQ6VXNlcjQxNDU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/4145923?v=4","gravatar_id":"","url":"https://api.github.com/users/Clashsoft","html_url":"https://github.com/Clashsoft","followers_url":"https://api.github.com/users/Clashsoft/followers","following_url":"https://api.github.com/users/Clashsoft/following{/other_user}","gists_url":"https://api.github.com/users/Clashsoft/gists{/gist_id}","starred_url":"https://api.github.com/users/Clashsoft/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Clashsoft/subscriptions","organizations_url":"https://api.github.com/users/Clashsoft/orgs","repos_url":"https://api.github.com/users/Clashsoft/repos","events_url":"https://api.github.com/users/Clashsoft/events{/privacy}","received_events_url":"https://api.github.com/users/Clashsoft/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-07T21:22:44Z","updated_at":"2024-12-07T21:22:44Z","author_association":"NONE","body":"This is the most recent output:\r\n\r\n```\r\ncouchdb-1  | [notice] 2024-12-07T21:11:53.569684Z nonode@nohost <0.6680.100> 23f15faa0c localhost:5984 127.0.0.1 admin GET /registry/%40udia%2Fudia-client?revs=true&open_revs=%5B%2253-874406163708ecfd68ad0eaa744b5134%22%5D&latest=true 200 ok 58\r\ncouchdb-1  | [error] 2024-12-07T21:11:53.623891Z nonode@nohost <0.6854.100> -------- Worker <0.6809.100> died with reason: {bad_return_value,{invalid_json,{1,invalid_json}}}\r\ncouchdb-1  | [error] 2024-12-07T21:11:53.623967Z nonode@nohost <0.6854.100> -------- Replication `289765c2d23d4ca12b9476840579a02b+continuous` (`http://localhost:5984/registry/` -> `https://couchdb.web-kraken.uni-kassel.dev/registry/`) failed: {worker_died,<0.6809.100>,{bad_return_value,{invalid_json,{1,invalid_json}}}}\r\ncouchdb-1  | [error] 2024-12-07T21:11:53.624199Z nonode@nohost <0.6809.100> -------- gen_server <0.6809.100> terminated with reason: bad return value {invalid_json,{1,invalid_json}}\r\ncouchdb-1  |   last msg: redacted\r\ncouchdb-1  |      state: [{main_pid,<0.6854.100>},{loop,<0.7122.100>},{source,\"http://localhost:5984/registry/\"},{target,\"https://couchdb.web-kraken.uni-kassel.dev/registry/\"},{num_readers,1},{pending_fetch,nil},{batch_size,216}]\r\ncouchdb-1  |     extra: [<0.7295.100>]\r\ncouchdb-1  | [error] 2024-12-07T21:11:53.624307Z nonode@nohost <0.6809.100> -------- gen_server <0.6809.100> terminated with reason: bad return value {invalid_json,{1,invalid_json}}\r\ncouchdb-1  |   last msg: redacted\r\ncouchdb-1  |      state: [{main_pid,<0.6854.100>},{loop,<0.7122.100>},{source,\"http://localhost:5984/registry/\"},{target,\"https://couchdb.web-kraken.uni-kassel.dev/registry/\"},{num_readers,1},{pending_fetch,nil},{batch_size,216}]\r\ncouchdb-1  |     extra: [<0.7295.100>]\r\ncouchdb-1  | [error] 2024-12-07T21:11:53.624585Z nonode@nohost <0.6809.100> -------- CRASH REPORT Process  (<0.6809.100>) with 1 neighbors exited with reason: bad return value {invalid_json,{1,invalid_json}} at gen_server:handle_common_reply/8(line:1245) <= proc_lib:init_p_do_apply/3(line:240); initial_call: {couch_replicator_worker,init,['Argument__1']}, ancestors: [<0.6854.100>,couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 1, links: [<0.7122.100>,<0.6854.100>], dictionary: [{ibrowse_stream_status,init}], trap_exit: true, status: running, heap_size: 121536, stack_size: 28, reductions: 133712\r\ncouchdb-1  | [error] 2024-12-07T21:11:53.625350Z nonode@nohost <0.6809.100> -------- CRASH REPORT Process  (<0.6809.100>) with 1 neighbors exited with reason: bad return value {invalid_json,{1,invalid_json}} at gen_server:handle_common_reply/8(line:1245) <= proc_lib:init_p_do_apply/3(line:240); initial_call: {couch_replicator_worker,init,['Argument__1']}, ancestors: [<0.6854.100>,couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 1, links: [<0.7122.100>,<0.6854.100>], dictionary: [{ibrowse_stream_status,init}], trap_exit: true, status: running, heap_size: 121536, stack_size: 28, reductions: 133712\r\ncouchdb-1  | [error] 2024-12-07T21:11:53.625543Z nonode@nohost <0.6854.100> -------- gen_server <0.6854.100> terminated with reason: {worker_died,<0.6809.100>,{bad_return_value,{invalid_json,{1,invalid_json}}}}\r\ncouchdb-1  |   last msg: redacted\r\ncouchdb-1  |      state: [{rep_id,{\"289765c2d23d4ca12b9476840579a02b\",\"+continuous\"}},{source,\"http://localhost:5984/registry/\"},{target,\"https://couchdb.web-kraken.uni-kassel.dev/registry/\"},{db_name,<<\"shards/00000000-7fffffff/_replicator.1701442784\">>},{doc_id,<<\"8458cd97aa9b48b97cf5d3e18cf5ec1b\">>},{options,[{checkpoint_interval,5000},{connection_timeout,60000},{continuous,true},{create_target,false},{http_connections,20},{ibrowse_options,[]},{retries,5},{socket_options,[{keepalive,true},{nodelay,false}]},{use_bulk_get,false},{use_checkpoints,true},{worker_batch_size,10},{worker_processes,1}]},{session_id,<<\"d572097f10895b39abacfd5bccb7bab1\">>},{start_seq,{0,<<\"86866-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCScyJNX___8_K4M5iYFhrXEuUIw9xdzE2MIiCV09DhPyWIAkQwOQ-g83aJk82CBzg-S0VHMzdG1ZAEU4LDc\">>}},{source_seq,<<\"7221564-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCeexAEmGBiD1HwiyMpiTGMyVjHOBYuzmBslpqeZm6NpwGJTIkFQPN4GfE2xCirmJsYVFErr6LADaWitt\">>},{committed_seq,{0,<<\"86866-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCScyJNX___8_K4M5iYFhrXEuUIw9xdzE2MIiCV09DhPyWIAkQwOQ-g83aJk82CBzg-S0VHMzdG1ZAEU4LDc\">>}},{current_through_seq,{37,<<\"87227-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCScyJNX___8_K4M5iYFh7YtcoBh7irmJsYVFErp6HCbksQBJhgYg9R9u0LLLYIPMDZLTUs3N0LVlAQCjIy2g\">>}},{highest_seq_done,{37,<<\"87227-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCScyJNX___8_K4M5iYFh7YtcoBh7irmJsYVFErp6HCbksQBJhgYg9R9u0LLLYIPMDZLTUs3N0LVlAQCjIy2g\">>}}]\r\ncouchdb-1  |     extra: []\r\ncouchdb-1  | [error] 2024-12-07T21:11:53.625711Z nonode@nohost <0.6854.100> -------- gen_server <0.6854.100> terminated with reason: {worker_died,<0.6809.100>,{bad_return_value,{invalid_json,{1,invalid_json}}}}\r\ncouchdb-1  |   last msg: redacted\r\ncouchdb-1  |      state: [{rep_id,{\"289765c2d23d4ca12b9476840579a02b\",\"+continuous\"}},{source,\"http://localhost:5984/registry/\"},{target,\"https://couchdb.web-kraken.uni-kassel.dev/registry/\"},{db_name,<<\"shards/00000000-7fffffff/_replicator.1701442784\">>},{doc_id,<<\"8458cd97aa9b48b97cf5d3e18cf5ec1b\">>},{options,[{checkpoint_interval,5000},{connection_timeout,60000},{continuous,true},{create_target,false},{http_connections,20},{ibrowse_options,[]},{retries,5},{socket_options,[{keepalive,true},{nodelay,false}]},{use_bulk_get,false},{use_checkpoints,true},{worker_batch_size,10},{worker_processes,1}]},{session_id,<<\"d572097f10895b39abacfd5bccb7bab1\">>},{start_seq,{0,<<\"86866-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCScyJNX___8_K4M5iYFhrXEuUIw9xdzE2MIiCV09DhPyWIAkQwOQ-g83aJk82CBzg-S0VHMzdG1ZAEU4LDc\">>}},{source_seq,<<\"7221564-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCeexAEmGBiD1HwiyMpiTGMyVjHOBYuzmBslpqeZm6NpwGJTIkFQPN4GfE2xCirmJsYVFErr6LADaWitt\">>},{committed_seq,{0,<<\"86866-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCScyJNX___8_K4M5iYFhrXEuUIw9xdzE2MIiCV09DhPyWIAkQwOQ-g83aJk82CBzg-S0VHMzdG1ZAEU4LDc\">>}},{current_through_seq,{37,<<\"87227-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCScyJNX___8_K4M5iYFh7YtcoBh7irmJsYVFErp6HCbksQBJhgYg9R9u0LLLYIPMDZLTUs3N0LVlAQCjIy2g\">>}},{highest_seq_done,{37,<<\"87227-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCScyJNX___8_K4M5iYFh7YtcoBh7irmJsYVFErp6HCbksQBJhgYg9R9u0LLLYIPMDZLTUs3N0LVlAQCjIy2g\">>}}]\r\ncouchdb-1  |     extra: []\r\ncouchdb-1  | [error] 2024-12-07T21:11:53.625794Z nonode@nohost <0.6854.100> -------- CRASH REPORT Process  (<0.6854.100>) with 3 neighbors exited with reason: {worker_died,<0.6809.100>,{bad_return_value,{invalid_json,{1,invalid_json}}}} at gen_server:handle_common_reply/8(line:1241) <= proc_lib:init_p_do_apply/3(line:240); initial_call: {couch_replicator_scheduler_job,init,['Argument__1']}, ancestors: [couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 2, links: [<0.7012.100>,<0.7113.100>,<0.7145.100>,<0.747.0>], dictionary: [{ibrowse_stream_status,init},{pending_count_state,{{1733,605911,...},...}},...], trap_exit: true, status: running, heap_size: 2586, stack_size: 28, reductions: 35413\r\ncouchdb-1  | [error] 2024-12-07T21:11:53.625870Z nonode@nohost <0.6854.100> -------- CRASH REPORT Process  (<0.6854.100>) with 3 neighbors exited with reason: {worker_died,<0.6809.100>,{bad_return_value,{invalid_json,{1,invalid_json}}}} at gen_server:handle_common_reply/8(line:1241) <= proc_lib:init_p_do_apply/3(line:240); initial_call: {couch_replicator_scheduler_job,init,['Argument__1']}, ancestors: [couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 2, links: [<0.7012.100>,<0.7113.100>,<0.7145.100>,<0.747.0>], dictionary: [{ibrowse_stream_status,init},{pending_count_state,{{1733,605911,...},...}},...], trap_exit: true, status: running, heap_size: 2586, stack_size: 28, reductions: 35413\r\n```\r\n\r\nThat request `/registry/%40udia%2Fudia-client?revs=true&open_revs=%5B%2253-874406163708ecfd68ad0eaa744b5134%22%5D&latest=true` returns a ca. 2 MB multipart/form-data wrapped json that seems valid otherwise. The only weird thing are >25KB licenseText fields.\r\n\r\n[response.txt](https://github.com/user-attachments/files/18049905/response.txt)\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2525314504/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2525406589","html_url":"https://github.com/apache/couchdb/issues/5004#issuecomment-2525406589","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5004","id":2525406589,"node_id":"IC_kwDOAAMmUc6WhqV9","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-08T04:00:29Z","updated_at":"2024-12-08T04:00:29Z","author_association":"CONTRIBUTOR","body":"Thanks for trying the settings, @Clashsoft.\r\n\r\nI'll try to open the binary in the json library used in CouchDB. It might be the large field or a utf8/escaping issue perhaps.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2525406589/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2525460471","html_url":"https://github.com/apache/couchdb/issues/5004#issuecomment-2525460471","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5004","id":2525460471,"node_id":"IC_kwDOAAMmUc6Wh3f3","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-08T07:17:44Z","updated_at":"2024-12-08T07:17:44Z","author_association":"CONTRIBUTOR","body":"Thinking more about the issue, it looks like the json parser throws the error on the very first character.\r\n\r\nSomething like:\r\n\r\n```\r\n(node1@127.0.0.1)31> jiffy:decode(<<\"x\">>).\r\n** exception error: {1,invalid_json}\r\n```\r\n\r\nOr it could be any non-json text, say a plain html page:\r\n\r\n```\r\n> jiffy:decode(<<\"Some text\">>).\r\n** exception error: {1,invalid_json}\r\n     in function  jiffy:decode/2 (src/jiffy.erl, line 63)\r\n```\r\n\r\nIn the past html error pages from proxies, could cause that https://github.com/apache/couchdb/issues/1080\r\n\r\nMaybe there is a way to inspect or capture the request stream (with wireshark or similar) to see what data it's getting?\r\n\r\nAnother idea, check if you have any size limits set. We had changed the limit a few times in the past https://docs.couchdb.org/en/stable/config/couchdb.html#couchdb/max_document_size. That would return a 413 response though?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2525460471/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2526333734","html_url":"https://github.com/apache/couchdb/pull/5321#issuecomment-2526333734","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5321","id":2526333734,"node_id":"IC_kwDOAAMmUc6WlMsm","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-08T19:08:01Z","updated_at":"2024-12-08T19:08:01Z","author_association":"CONTRIBUTOR","body":"We now have noble with SM 102 and SM 115 https://hub.docker.com/r/apache/couchdbci-ubuntu/tags","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2526333734/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2526342363","html_url":"https://github.com/apache/couchdb/pull/5321#issuecomment-2526342363","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5321","id":2526342363,"node_id":"IC_kwDOAAMmUc6WlOzb","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-08T19:25:21Z","updated_at":"2024-12-08T19:25:46Z","author_association":"CONTRIBUTOR","body":"Noticed a few failures in CI as well:\r\n\r\n```\r\n19:23:14  /usr/include/mozjs-102/js/CallArgs.h:137:8: note: by argument 1 of type\r\n 'const JS::detail::CallArgsBase<JS::detail::IncludeUsedRval>*' to 'void JS::detail::CallArgsBase<WantUsedRval>::clearUsedRval() const \r\n[with WantUsedRval = JS::detail::IncludeUsedRval]' declared here\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2526342363/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2526373413","html_url":"https://github.com/apache/couchdb/issues/5004#issuecomment-2526373413","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5004","id":2526373413,"node_id":"IC_kwDOAAMmUc6WlWYl","user":{"login":"Clashsoft","id":4145923,"node_id":"MDQ6VXNlcjQxNDU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/4145923?v=4","gravatar_id":"","url":"https://api.github.com/users/Clashsoft","html_url":"https://github.com/Clashsoft","followers_url":"https://api.github.com/users/Clashsoft/followers","following_url":"https://api.github.com/users/Clashsoft/following{/other_user}","gists_url":"https://api.github.com/users/Clashsoft/gists{/gist_id}","starred_url":"https://api.github.com/users/Clashsoft/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Clashsoft/subscriptions","organizations_url":"https://api.github.com/users/Clashsoft/orgs","repos_url":"https://api.github.com/users/Clashsoft/repos","events_url":"https://api.github.com/users/Clashsoft/events{/privacy}","received_events_url":"https://api.github.com/users/Clashsoft/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-08T20:45:45Z","updated_at":"2024-12-08T20:45:45Z","author_association":"NONE","body":"Actually I think it was the nginx ingress in the middle, because the default is 1 MiB and I did not have the problem when I switched from the FQDN to the internal service name (`couchdb.svc.cluster.local`). Thank you for the help though!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2526373413/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2526376267","html_url":"https://github.com/apache/couchdb/issues/5004#issuecomment-2526376267","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5004","id":2526376267,"node_id":"IC_kwDOAAMmUc6WlXFL","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-08T20:54:05Z","updated_at":"2024-12-08T20:54:16Z","author_association":"CONTRIBUTOR","body":"@Clashsoft that explains it, and is consistent with the failures we've seen in the past.\r\n\r\nI think it would still be nice for us (CouchDB) to have an option to debug this kind of stuff. We have a debug log line for the local http port https://github.com/apache/couchdb/blob/37951bfb92f5f9e2d4983a6dc34166ea78c7fb22/src/couch/src/couch_httpd.erl#L424-L431 to log any json decoding error, something like that in the replicator might be nice to have. We would have been able to figure out the issue a bit sooner.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2526376267/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2526385508","html_url":"https://github.com/apache/couchdb/issues/5004#issuecomment-2526385508","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5004","id":2526385508,"node_id":"IC_kwDOAAMmUc6WlZVk","user":{"login":"Clashsoft","id":4145923,"node_id":"MDQ6VXNlcjQxNDU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/4145923?v=4","gravatar_id":"","url":"https://api.github.com/users/Clashsoft","html_url":"https://github.com/Clashsoft","followers_url":"https://api.github.com/users/Clashsoft/followers","following_url":"https://api.github.com/users/Clashsoft/following{/other_user}","gists_url":"https://api.github.com/users/Clashsoft/gists{/gist_id}","starred_url":"https://api.github.com/users/Clashsoft/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Clashsoft/subscriptions","organizations_url":"https://api.github.com/users/Clashsoft/orgs","repos_url":"https://api.github.com/users/Clashsoft/repos","events_url":"https://api.github.com/users/Clashsoft/events{/privacy}","received_events_url":"https://api.github.com/users/Clashsoft/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-08T21:15:25Z","updated_at":"2024-12-08T21:16:42Z","author_association":"NONE","body":"Thanks, this is a good idea.\r\n\r\nActually now I get a new error:\r\n\r\nTarget, where the replicator runs\r\n```\r\n-------- recording a checkpoint for `http://pollux.vs.uni-kassel.de:5984/registry/` -> `http://couchdb-svc-couchdb:5984/registry/` at source update_seq <<\"5024062-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCScyJNX___8_K4M5iUEtvSoXKMaeYm5ibGGRhK4ehwl5LECSoQFI_Ycb5HgEbJC5QXJaqrkZurYsAGDKLMQ\">>\r\n-------- Replicator, request PUT to \"http://pollux.vs.uni-kassel.de:5984/registry/_local/feeafdc2574e1244f85cfe9c724cfa11\" failed due to error {code,500}\r\n-------- Replication `feeafdc2574e1244f85cfe9c724cfa11+continuous` (`http://pollux.vs.uni-kassel.de:5984/registry/` -> `http://couchdb-svc-couchdb:5984/registry/`) failed: {http_request_failed,\"PUT\",\r\n                 \"http://pollux.vs.uni-kassel.de:5984/registry/_local/feeafdc2574e1244f85cfe9c724cfa11\",\r\n                 {error,{code,500}}}\r\n-------- gen_server <0.20584.0> terminated with reason: {http_request_failed,\"PUT\",\"http://pollux.vs.uni-kassel.de:5984/registry/_local/feeafdc2574e1244f85cfe9c724cfa11\",{error,{code,500}}} at couch_replicator_httpc:report_error/4(line:384) <= couch_replicator_httpc:send_req/3(line:81) <= couch_replicator_scheduler_job:update_checkpoint/2(line:929) <= couch_replicator_scheduler_job:update_checkpoint/3(line:917) <= couch_replicator_scheduler_job:do_checkpoint/1(line:883) <= couch_replicator_scheduler_job:handle_cast/2(line:265) <= gen_server:try_dispatch/4(line:1123) <= gen_server:handle_msg/6(line:1200)\r\nredacted\r\n state: [{rep_id,{\"feeafdc2574e1244f85cfe9c724cfa11\",\"+continuous\"}},{source,\"http://pollux.vs.uni-kassel.de:5984/registry/\"},{target,\"http://couchdb-svc-couchdb:5984/registry/\"},{db_name,<<\"shards/00000000-7fffffff/_replicator.1733607930\">>},{doc_id,<<\"19ef646100bd206f786f04138c000751\">>},{options,[{checkpoint_interval,30000},{connection_timeout,60000},{continuous,true},{create_target,false},{http_connections,20},{ibrowse_options,[]},{retries,5},{socket_options,[{keepalive,true},{nodelay,false}]},{use_bulk_get,true},{use_checkpoints,true},{worker_batch_size,500},{worker_processes,4}]},{session_id,<<\"1f049e5bc3d4a78ddd4479e1a512ae00\">>},{start_seq,{0,<<\"4857701-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCScyJNX___8_K4M5iUFVoyYXKMaeYm5ibGGRhK4ehwl5LECSoQFI_YcZpPLtJdggc4PktFRzM3RtWQBhmC1e\">>}},{source_seq,<<\"7221564-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCeexAEmGBiD1HwiyMpiTGMyVjHOBYuzmBslpqeZm6NpwGJTIkFQPN4GfE2xCirmJsYVFErr6LADaWitt\">>},{committed_seq,{0,<<\"4857701-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCScyJNX___8_K4M5iUFVoyYXKMaeYm5ibGGRhK4ehwl5LECSoQFI_YcZpPLtJdggc4PktFRzM3RtWQBhmC1e\">>}},{current_through_seq,{86,<<\"5024062-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCScyJNX___8_K4M5iUEtvSoXKMaeYm5ibGGRhK4ehwl5LECSoQFI_Ycb5HgEbJC5QXJaqrkZurYsAGDKLMQ\">>}},{highest_seq_done,{86,<<\"5024062-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCScyJNX___8_K4M5iUEtvSoXKMaeYm5ibGGRhK4ehwl5LECSoQFI_Ycb5HgEbJC5QXJaqrkZurYsAGDKLMQ\">>}}]\r\nextra: []\r\n-------- gen_server <0.20584.0> terminated with reason: {http_request_failed,\"PUT\",\"http://pollux.vs.uni-kassel.de:5984/registry/_local/feeafdc2574e1244f85cfe9c724cfa11\",{error,{code,500}}} at couch_replicator_httpc:report_error/4(line:384) <= couch_replicator_httpc:send_req/3(line:81) <= couch_replicator_scheduler_job:update_checkpoint/2(line:929) <= couch_replicator_scheduler_job:update_checkpoint/3(line:917) <= couch_replicator_scheduler_job:do_checkpoint/1(line:883) <= couch_replicator_scheduler_job:handle_cast/2(line:265) <= gen_server:try_dispatch/4(line:1123) <= gen_server:handle_msg/6(line:1200)\r\nredacted\r\n state: [{rep_id,{\"feeafdc2574e1244f85cfe9c724cfa11\",\"+continuous\"}},{source,\"http://pollux.vs.uni-kassel.de:5984/registry/\"},{target,\"http://couchdb-svc-couchdb:5984/registry/\"},{db_name,<<\"shards/00000000-7fffffff/_replicator.1733607930\">>},{doc_id,<<\"19ef646100bd206f786f04138c000751\">>},{options,[{checkpoint_interval,30000},{connection_timeout,60000},{continuous,true},{create_target,false},{http_connections,20},{ibrowse_options,[]},{retries,5},{socket_options,[{keepalive,true},{nodelay,false}]},{use_bulk_get,true},{use_checkpoints,true},{worker_batch_size,500},{worker_processes,4}]},{session_id,<<\"1f049e5bc3d4a78ddd4479e1a512ae00\">>},{start_seq,{0,<<\"4857701-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCScyJNX___8_K4M5iUFVoyYXKMaeYm5ibGGRhK4ehwl5LECSoQFI_YcZpPLtJdggc4PktFRzM3RtWQBhmC1e\">>}},{source_seq,<<\"7221564-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCeexAEmGBiD1HwiyMpiTGMyVjHOBYuzmBslpqeZm6NpwGJTIkFQPN4GfE2xCirmJsYVFErr6LADaWitt\">>},{committed_seq,{0,<<\"4857701-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCScyJNX___8_K4M5iUFVoyYXKMaeYm5ibGGRhK4ehwl5LECSoQFI_YcZpPLtJdggc4PktFRzM3RtWQBhmC1e\">>}},{current_through_seq,{86,<<\"5024062-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCScyJNX___8_K4M5iUEtvSoXKMaeYm5ibGGRhK4ehwl5LECSoQFI_Ycb5HgEbJC5QXJaqrkZurYsAGDKLMQ\">>}},{highest_seq_done,{86,<<\"5024062-g1AAAACReJzLYWBgYMpgTmHgzcvPy09JdcjLz8gvLskBCScyJNX___8_K4M5iUEtvSoXKMaeYm5ibGGRhK4ehwl5LECSoQFI_Ycb5HgEbJC5QXJaqrkZurYsAGDKLMQ\">>}}]\r\nextra: []\r\n-------- CRASH REPORT Process  (<0.20584.0>) with 3 neighbors exited with reason: {http_request_failed,\"PUT\",\"http://pollux.vs.uni-kassel.de:5984/registry/_local/feeafdc2574e1244f85cfe9c724cfa11\",{error,{code,500}}} at couch_replicator_httpc:report_error/4(line:384) <= couch_replicator_httpc:send_req/3(line:81) <= couch_replicator_scheduler_job:update_checkpoint/2(line:929) <= couch_replicator_scheduler_job:update_checkpoint/3(line:917) <= couch_replicator_scheduler_job:do_checkpoint/1(line:883) <= couch_replicator_scheduler_job:handle_cast/2(line:265) <= gen_server:try_dispatch/4(line:1123) <= gen_server:handle_msg/6(line:1200); initial_call: {couch_replicator_scheduler_job,init,['Argument__1']}, ancestors: [couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 2, links: [<0.20639.0>,<0.20642.0>,<0.20646.0>,<0.20644.0>,<0.20640.0>,...], dictionary: [{ibrowse_stream_status,init},{rand_seed,{#{bits => 58,jump => #Fun<..>,...},...}},...], trap_exit: true, status: running, heap_size: 6772, stack_size: 28, reductions: 59196\r\n54bdee9f0a couchdb-svc-couchdb:5984 10.42.126.44 admin POST /registry/_bulk_docs 201 ok 406\r\n-------- CRASH REPORT Process  (<0.20584.0>) with 3 neighbors exited with reason: {http_request_failed,\"PUT\",\"http://pollux.vs.uni-kassel.de:5984/registry/_local/feeafdc2574e1244f85cfe9c724cfa11\",{error,{code,500}}} at couch_replicator_httpc:report_error/4(line:384) <= couch_replicator_httpc:send_req/3(line:81) <= couch_replicator_scheduler_job:update_checkpoint/2(line:929) <= couch_replicator_scheduler_job:update_checkpoint/3(line:917) <= couch_replicator_scheduler_job:do_checkpoint/1(line:883) <= couch_replicator_scheduler_job:handle_cast/2(line:265) <= gen_server:try_dispatch/4(line:1123) <= gen_server:handle_msg/6(line:1200); initial_call: {couch_replicator_scheduler_job,init,['Argument__1']}, ancestors: [couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 2, links: [<0.20639.0>,<0.20642.0>,<0.20646.0>,<0.20644.0>,<0.20640.0>,...], dictionary: [{ibrowse_stream_status,init},{rand_seed,{#{bits => 58,jump => #Fun<..>,...},...}},...], trap_exit: true, status: running, heap_size: 6772, stack_size: 28, reductions: 59196\r\n7e451f7121 couchdb-svc-couchdb:5984 192.168.200.109 admin POST /registry/_bulk_docs 201 ok 736\r\n-------- Retrying POST request to http://couchdb-svc-couchdb:5984/registry/_bulk_docs in 0.25 seconds due to error closing_on_request\r\n-------- Retrying POST request to http://couchdb-svc-couchdb:5984/registry/_bulk_docs in 0.25 seconds due to error closing_on_request\r\n-------- Retrying POST request to http://couchdb-svc-couchdb:5984/registry/_bulk_docs in 0.25 seconds due to error closing_on_request\r\n-------- Retrying POST request to http://couchdb-svc-couchdb:5984/registry/_bulk_docs in 0.25 seconds due to error closing_on_request\r\n67c40cab75 couchdb-svc-couchdb:5984 10.42.126.44 admin POST /registry/_bulk_docs 201 ok 340\r\n-------- gen_server <0.20646.0> terminated with reason: no such process or port in call to gen_server:call(<0.20628.0>, {update_headers,[{\"Accept\",\"application/json\"},{\"Content-Length\",\"526073\"},{\"Content-Type\",\"appl...\"},...],...}, 600000) at gen_server:call/3(line:385) <= couch_replicator_auth_session:update_headers/2(line:113) <= couch_replicator_auth:update_headers/2(line:60) <= couch_replicator_httpc:send_ibrowse_req/2(line:113) <= couch_replicator_httpc:send_req/3(line:78) <= couch_replicator_worker:flush_docs/2(line:526) <= couch_replicator_worker:maybe_flush_docs/3(line:516) <= couch_replicator_worker:maybe_flush_docs/2(line:505)\r\nredacted\r\n state: [{main_pid,<0.20584.0>},{loop,<0.20647.0>},{source,\"http://pollux.vs.uni-kassel.de:5984/registry/\"},{target,\"http://couchdb-svc-couchdb:5984/registry/\"},{num_readers,0},{pending_fetch,nil},{batch_size,522127}]\r\nextra: [<0.20647.0>,[{gen,do_call,4,[{file,\"gen.erl\"},{line,237}]},{gen_server,call,3,[{file,\"gen_server.erl\"},{line,381}]},{couch_replicator_worker,'-queue_fetch_loop/1-fun-2-',2,[{file,\"src/couch_replicator_worker.erl\"},{line,309}]},{lists,foreach_1,2,[{file,\"lists.erl\"},{line,1442}]},{couch_replicator_worker,queue_fetch_loop,1,[{file,\"src/couch_replicator_worker.erl\"},{line,311}]}]]\r\n-------- gen_server <0.20646.0> terminated with reason: no such process or port in call to gen_server:call(<0.20628.0>, {update_headers,[{\"Accept\",\"application/json\"},{\"Content-Length\",\"526073\"},{\"Content-Type\",\"appl...\"},...],...}, 600000) at gen_server:call/3(line:385) <= couch_replicator_auth_session:update_headers/2(line:113) <= couch_replicator_auth:update_headers/2(line:60) <= couch_replicator_httpc:send_ibrowse_req/2(line:113) <= couch_replicator_httpc:send_req/3(line:78) <= couch_replicator_worker:flush_docs/2(line:526) <= couch_replicator_worker:maybe_flush_docs/3(line:516) <= couch_replicator_worker:maybe_flush_docs/2(line:505)\r\nredacted\r\n state: [{main_pid,<0.20584.0>},{loop,<0.20647.0>},{source,\"http://pollux.vs.uni-kassel.de:5984/registry/\"},{target,\"http://couchdb-svc-couchdb:5984/registry/\"},{num_readers,0},{pending_fetch,nil},{batch_size,522127}]\r\nextra: [<0.20647.0>,[{gen,do_call,4,[{file,\"gen.erl\"},{line,237}]},{gen_server,call,3,[{file,\"gen_server.erl\"},{line,381}]},{couch_replicator_worker,'-queue_fetch_loop/1-fun-2-',2,[{file,\"src/couch_replicator_worker.erl\"},{line,309}]},{lists,foreach_1,2,[{file,\"lists.erl\"},{line,1442}]},{couch_replicator_worker,queue_fetch_loop,1,[{file,\"src/couch_replicator_worker.erl\"},{line,311}]}]]\r\n-------- gen_server <0.20640.0> terminated with reason: no such process or port in call to gen_server:call(<0.20628.0>, {update_headers,[{\"Accept\",\"application/json\"},{\"Content-Length\",\"826666\"},{\"Content-Type\",\"appl...\"},...],...}, 600000) at gen_server:call/3(line:385) <= couch_replicator_auth_session:update_headers/2(line:113) <= couch_replicator_auth:update_headers/2(line:60) <= couch_replicator_httpc:send_ibrowse_req/2(line:113) <= couch_replicator_httpc:send_req/3(line:78) <= couch_replicator_worker:flush_docs/2(line:526) <= couch_replicator_worker:maybe_flush_docs/3(line:516) <= couch_replicator_worker:maybe_flush_docs/2(line:505)\r\nredacted\r\n state: [{main_pid,<0.20584.0>},{loop,<0.20641.0>},{source,\"http://pollux.vs.uni-kassel.de:5984/registry/\"},{target,\"http://couchdb-svc-couchdb:5984/registry/\"},{num_readers,0},{pending_fetch,nil},{batch_size,243519}]\r\nextra: [<0.20641.0>,[{gen,do_call,4,[{file,\"gen.erl\"},{line,237}]},{gen_server,call,3,[{file,\"gen_server.erl\"},{line,381}]},{couch_replicator_worker,'-queue_fetch_loop/1-fun-2-',2,[{file,\"src/couch_replicator_worker.erl\"},{line,309}]},{lists,foreach_1,2,[{file,\"lists.erl\"},{line,1442}]},{couch_replicator_worker,queue_fetch_loop,1,[{file,\"src/couch_replicator_worker.erl\"},{line,311}]}]]\r\n-------- gen_server <0.20640.0> terminated with reason: no such process or port in call to gen_server:call(<0.20628.0>, {update_headers,[{\"Accept\",\"application/json\"},{\"Content-Length\",\"826666\"},{\"Content-Type\",\"appl...\"},...],...}, 600000) at gen_server:call/3(line:385) <= couch_replicator_auth_session:update_headers/2(line:113) <= couch_replicator_auth:update_headers/2(line:60) <= couch_replicator_httpc:send_ibrowse_req/2(line:113) <= couch_replicator_httpc:send_req/3(line:78) <= couch_replicator_worker:flush_docs/2(line:526) <= couch_replicator_worker:maybe_flush_docs/3(line:516) <= couch_replicator_worker:maybe_flush_docs/2(line:505)\r\nredacted\r\n state: [{main_pid,<0.20584.0>},{loop,<0.20641.0>},{source,\"http://pollux.vs.uni-kassel.de:5984/registry/\"},{target,\"http://couchdb-svc-couchdb:5984/registry/\"},{num_readers,0},{pending_fetch,nil},{batch_size,243519}]\r\nextra: [<0.20641.0>,[{gen,do_call,4,[{file,\"gen.erl\"},{line,237}]},{gen_server,call,3,[{file,\"gen_server.erl\"},{line,381}]},{couch_replicator_worker,'-queue_fetch_loop/1-fun-2-',2,[{file,\"src/couch_replicator_worker.erl\"},{line,309}]},{lists,foreach_1,2,[{file,\"lists.erl\"},{line,1442}]},{couch_replicator_worker,queue_fetch_loop,1,[{file,\"src/couch_replicator_worker.erl\"},{line,311}]}]]\r\n-------- CRASH REPORT Process  (<0.20640.0>) with 1 neighbors exited with reason: no such process or port in call to gen_server:call(<0.20628.0>, {update_headers,[{\"Accept\",\"application/json\"},{\"Content-Length\",\"826666\"},{\"Content-Type\",\"appl...\"},...],...}, 600000) at gen_server:call/3(line:385) <= couch_replicator_auth_session:update_headers/2(line:113) <= couch_replicator_auth:update_headers/2(line:60) <= couch_replicator_httpc:send_ibrowse_req/2(line:113) <= couch_replicator_httpc:send_req/3(line:78) <= couch_replicator_worker:flush_docs/2(line:526) <= couch_replicator_worker:maybe_flush_docs/3(line:516) <= couch_replicator_worker:maybe_flush_docs/2(line:505); initial_call: {couch_replicator_worker,init,['Argument__1']}, ancestors: [<0.20584.0>,couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 2, links: [<0.20641.0>], dictionary: [{ibrowse_stream_status,init}], trap_exit: true, status: running, heap_size: 514838, stack_size: 28, reductions: 6592750\r\n-------- CRASH REPORT Process  (<0.20640.0>) with 1 neighbors exited with reason: no such process or port in call to gen_server:call(<0.20628.0>, {update_headers,[{\"Accept\",\"application/json\"},{\"Content-Length\",\"826666\"},{\"Content-Type\",\"appl...\"},...],...}, 600000) at gen_server:call/3(line:385) <= couch_replicator_auth_session:update_headers/2(line:113) <= couch_replicator_auth:update_headers/2(line:60) <= couch_replicator_httpc:send_ibrowse_req/2(line:113) <= couch_replicator_httpc:send_req/3(line:78) <= couch_replicator_worker:flush_docs/2(line:526) <= couch_replicator_worker:maybe_flush_docs/3(line:516) <= couch_replicator_worker:maybe_flush_docs/2(line:505); initial_call: {couch_replicator_worker,init,['Argument__1']}, ancestors: [<0.20584.0>,couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 2, links: [<0.20641.0>], dictionary: [{ibrowse_stream_status,init}], trap_exit: true, status: running, heap_size: 514838, stack_size: 28, reductions: 6592750\r\n-------- CRASH REPORT Process  (<0.20646.0>) with 1 neighbors exited with reason: no such process or port in call to gen_server:call(<0.20628.0>, {update_headers,[{\"Accept\",\"application/json\"},{\"Content-Length\",\"526073\"},{\"Content-Type\",\"appl...\"},...],...}, 600000) at gen_server:call/3(line:385) <= couch_replicator_auth_session:update_headers/2(line:113) <= couch_replicator_auth:update_headers/2(line:60) <= couch_replicator_httpc:send_ibrowse_req/2(line:113) <= couch_replicator_httpc:send_req/3(line:78) <= couch_replicator_worker:flush_docs/2(line:526) <= couch_replicator_worker:maybe_flush_docs/3(line:516) <= couch_replicator_worker:maybe_flush_docs/2(line:505); initial_call: {couch_replicator_worker,init,['Argument__1']}, ancestors: [<0.20584.0>,couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 2, links: [<0.20647.0>], dictionary: [{ibrowse_stream_status,init}], trap_exit: true, status: running, heap_size: 318187, stack_size: 28, reductions: 6912108\r\n-------- CRASH REPORT Process  (<0.20646.0>) with 1 neighbors exited with reason: no such process or port in call to gen_server:call(<0.20628.0>, {update_headers,[{\"Accept\",\"application/json\"},{\"Content-Length\",\"526073\"},{\"Content-Type\",\"appl...\"},...],...}, 600000) at gen_server:call/3(line:385) <= couch_replicator_auth_session:update_headers/2(line:113) <= couch_replicator_auth:update_headers/2(line:60) <= couch_replicator_httpc:send_ibrowse_req/2(line:113) <= couch_replicator_httpc:send_req/3(line:78) <= couch_replicator_worker:flush_docs/2(line:526) <= couch_replicator_worker:maybe_flush_docs/3(line:516) <= couch_replicator_worker:maybe_flush_docs/2(line:505); initial_call: {couch_replicator_worker,init,['Argument__1']}, ancestors: [<0.20584.0>,couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 2, links: [<0.20647.0>], dictionary: [{ibrowse_stream_status,init}], trap_exit: true, status: running, heap_size: 318187, stack_size: 28, reductions: 6912108\r\n-------- gen_server <0.20644.0> terminated with reason: no such process or port in call to gen_server:call(<0.20628.0>, {update_headers,[{\"Accept\",\"application/json\"},{\"Content-Length\",\"2290135\"},{\"Content-Type\",\"app...\"},...],...}, 600000) at gen_server:call/3(line:385) <= couch_replicator_auth_session:update_headers/2(line:113) <= couch_replicator_auth:update_headers/2(line:60) <= couch_replicator_httpc:send_ibrowse_req/2(line:113) <= couch_replicator_httpc:send_req/3(line:78) <= couch_replicator_worker:flush_docs/2(line:526) <= couch_replicator_worker:maybe_flush_docs/3(line:516) <= couch_replicator_worker:maybe_flush_docs/2(line:505)\r\nredacted\r\n state: [{main_pid,<0.20584.0>},{loop,<0.20645.0>},{source,\"http://pollux.vs.uni-kassel.de:5984/registry/\"},{target,\"http://couchdb-svc-couchdb:5984/registry/\"},{num_readers,0},{pending_fetch,nil},{batch_size,146415}]\r\nextra: [<0.20645.0>,[{gen,do_call,4,[{file,\"gen.erl\"},{line,237}]},{gen_server,call,3,[{file,\"gen_server.erl\"},{line,381}]},{couch_replicator_worker,'-queue_fetch_loop/1-fun-2-',2,[{file,\"src/couch_replicator_worker.erl\"},{line,309}]},{lists,foreach_1,2,[{file,\"lists.erl\"},{line,1442}]},{couch_replicator_worker,queue_fetch_loop,1,[{file,\"src/couch_replicator_worker.erl\"},{line,311}]}]]\r\n-------- gen_server <0.20644.0> terminated with reason: no such process or port in call to gen_server:call(<0.20628.0>, {update_headers,[{\"Accept\",\"application/json\"},{\"Content-Length\",\"2290135\"},{\"Content-Type\",\"app...\"},...],...}, 600000) at gen_server:call/3(line:385) <= couch_replicator_auth_session:update_headers/2(line:113) <= couch_replicator_auth:update_headers/2(line:60) <= couch_replicator_httpc:send_ibrowse_req/2(line:113) <= couch_replicator_httpc:send_req/3(line:78) <= couch_replicator_worker:flush_docs/2(line:526) <= couch_replicator_worker:maybe_flush_docs/3(line:516) <= couch_replicator_worker:maybe_flush_docs/2(line:505)\r\nredacted\r\n state: [{main_pid,<0.20584.0>},{loop,<0.20645.0>},{source,\"http://pollux.vs.uni-kassel.de:5984/registry/\"},{target,\"http://couchdb-svc-couchdb:5984/registry/\"},{num_readers,0},{pending_fetch,nil},{batch_size,146415}]\r\nextra: [<0.20645.0>,[{gen,do_call,4,[{file,\"gen.erl\"},{line,237}]},{gen_server,call,3,[{file,\"gen_server.erl\"},{line,381}]},{couch_replicator_worker,'-queue_fetch_loop/1-fun-2-',2,[{file,\"src/couch_replicator_worker.erl\"},{line,309}]},{lists,foreach_1,2,[{file,\"lists.erl\"},{line,1442}]},{couch_replicator_worker,queue_fetch_loop,1,[{file,\"src/couch_replicator_worker.erl\"},{line,311}]}]]\r\n-------- CRASH REPORT Process  (<0.20644.0>) with 1 neighbors exited with reason: no such process or port in call to gen_server:call(<0.20628.0>, {update_headers,[{\"Accept\",\"application/json\"},{\"Content-Length\",\"2290135\"},{\"Content-Type\",\"app...\"},...],...}, 600000) at gen_server:call/3(line:385) <= couch_replicator_auth_session:update_headers/2(line:113) <= couch_replicator_auth:update_headers/2(line:60) <= couch_replicator_httpc:send_ibrowse_req/2(line:113) <= couch_replicator_httpc:send_req/3(line:78) <= couch_replicator_worker:flush_docs/2(line:526) <= couch_replicator_worker:maybe_flush_docs/3(line:516) <= couch_replicator_worker:maybe_flush_docs/2(line:505); initial_call: {couch_replicator_worker,init,['Argument__1']}, ancestors: [<0.20584.0>,couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 2, links: [<0.20645.0>], dictionary: [{ibrowse_stream_status,init}], trap_exit: true, status: running, heap_size: 196650, stack_size: 28, reductions: 5280252\r\n-------- CRASH REPORT Process  (<0.20644.0>) with 1 neighbors exited with reason: no such process or port in call to gen_server:call(<0.20628.0>, {update_headers,[{\"Accept\",\"application/json\"},{\"Content-Length\",\"2290135\"},{\"Content-Type\",\"app...\"},...],...}, 600000) at gen_server:call/3(line:385) <= couch_replicator_auth_session:update_headers/2(line:113) <= couch_replicator_auth:update_headers/2(line:60) <= couch_replicator_httpc:send_ibrowse_req/2(line:113) <= couch_replicator_httpc:send_req/3(line:78) <= couch_replicator_worker:flush_docs/2(line:526) <= couch_replicator_worker:maybe_flush_docs/3(line:516) <= couch_replicator_worker:maybe_flush_docs/2(line:505); initial_call: {couch_replicator_worker,init,['Argument__1']}, ancestors: [<0.20584.0>,couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 2, links: [<0.20645.0>], dictionary: [{ibrowse_stream_status,init}], trap_exit: true, status: running, heap_size: 196650, stack_size: 28, reductions: 5280252\r\n-------- gen_server <0.20642.0> terminated with reason: no such process or port in call to gen_server:call(<0.20628.0>, {update_headers,[{\"Accept\",\"application/json\"},{\"Content-Length\",\"4263664\"},{\"Content-Type\",\"app...\"},...],...}, 600000) at gen_server:call/3(line:385) <= couch_replicator_auth_session:update_headers/2(line:113) <= couch_replicator_auth:update_headers/2(line:60) <= couch_replicator_httpc:send_ibrowse_req/2(line:113) <= couch_replicator_httpc:send_req/3(line:78) <= couch_replicator_worker:flush_docs/2(line:526) <= couch_replicator_worker:maybe_flush_docs/3(line:516) <= couch_replicator_worker:maybe_flush_docs/2(line:505)\r\nredacted\r\n state: [{main_pid,<0.20584.0>},{loop,<0.20643.0>},{source,\"http://pollux.vs.uni-kassel.de:5984/registry/\"},{target,\"http://couchdb-svc-couchdb:5984/registry/\"},{num_readers,0},{pending_fetch,nil},{batch_size,56559}]\r\nextra: [<0.20643.0>,[{gen,do_call,4,[{file,\"gen.erl\"},{line,237}]},{gen_server,call,3,[{file,\"gen_server.erl\"},{line,381}]},{couch_replicator_worker,'-queue_fetch_loop/1-fun-2-',2,[{file,\"src/couch_replicator_worker.erl\"},{line,309}]},{lists,foreach_1,2,[{file,\"lists.erl\"},{line,1442}]},{couch_replicator_worker,queue_fetch_loop,1,[{file,\"src/couch_replicator_worker.erl\"},{line,311}]}]]\r\n-------- gen_server <0.20642.0> terminated with reason: no such process or port in call to gen_server:call(<0.20628.0>, {update_headers,[{\"Accept\",\"application/json\"},{\"Content-Length\",\"4263664\"},{\"Content-Type\",\"app...\"},...],...}, 600000) at gen_server:call/3(line:385) <= couch_replicator_auth_session:update_headers/2(line:113) <= couch_replicator_auth:update_headers/2(line:60) <= couch_replicator_httpc:send_ibrowse_req/2(line:113) <= couch_replicator_httpc:send_req/3(line:78) <= couch_replicator_worker:flush_docs/2(line:526) <= couch_replicator_worker:maybe_flush_docs/3(line:516) <= couch_replicator_worker:maybe_flush_docs/2(line:505)\r\nredacted\r\n state: [{main_pid,<0.20584.0>},{loop,<0.20643.0>},{source,\"http://pollux.vs.uni-kassel.de:5984/registry/\"},{target,\"http://couchdb-svc-couchdb:5984/registry/\"},{num_readers,0},{pending_fetch,nil},{batch_size,56559}]\r\nextra: [<0.20643.0>,[{gen,do_call,4,[{file,\"gen.erl\"},{line,237}]},{gen_server,call,3,[{file,\"gen_server.erl\"},{line,381}]},{couch_replicator_worker,'-queue_fetch_loop/1-fun-2-',2,[{file,\"src/couch_replicator_worker.erl\"},{line,309}]},{lists,foreach_1,2,[{file,\"lists.erl\"},{line,1442}]},{couch_replicator_worker,queue_fetch_loop,1,[{file,\"src/couch_replicator_worker.erl\"},{line,311}]}]]\r\n-------- CRASH REPORT Process  (<0.20642.0>) with 1 neighbors exited with reason: no such process or port in call to gen_server:call(<0.20628.0>, {update_headers,[{\"Accept\",\"application/json\"},{\"Content-Length\",\"4263664\"},{\"Content-Type\",\"app...\"},...],...}, 600000) at gen_server:call/3(line:385) <= couch_replicator_auth_session:update_headers/2(line:113) <= couch_replicator_auth:update_headers/2(line:60) <= couch_replicator_httpc:send_ibrowse_req/2(line:113) <= couch_replicator_httpc:send_req/3(line:78) <= couch_replicator_worker:flush_docs/2(line:526) <= couch_replicator_worker:maybe_flush_docs/3(line:516) <= couch_replicator_worker:maybe_flush_docs/2(line:505); initial_call: {couch_replicator_worker,init,['Argument__1']}, ancestors: [<0.20584.0>,couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 2, links: [<0.20643.0>], dictionary: [{ibrowse_stream_status,init}], trap_exit: true, status: running, heap_size: 4298223, stack_size: 28, reductions: 6706641\r\n-------- CRASH REPORT Process  (<0.20642.0>) with 1 neighbors exited with reason: no such process or port in call to gen_server:call(<0.20628.0>, {update_headers,[{\"Accept\",\"application/json\"},{\"Content-Length\",\"4263664\"},{\"Content-Type\",\"app...\"},...],...}, 600000) at gen_server:call/3(line:385) <= couch_replicator_auth_session:update_headers/2(line:113) <= couch_replicator_auth:update_headers/2(line:60) <= couch_replicator_httpc:send_ibrowse_req/2(line:113) <= couch_replicator_httpc:send_req/3(line:78) <= couch_replicator_worker:flush_docs/2(line:526) <= couch_replicator_worker:maybe_flush_docs/3(line:516) <= couch_replicator_worker:maybe_flush_docs/2(line:505); initial_call: {couch_replicator_worker,init,['Argument__1']}, ancestors: [<0.20584.0>,couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 2, links: [<0.20643.0>], dictionary: [{ibrowse_stream_status,init}], trap_exit: true, status: running, heap_size: 4298223, stack_size: 28, reductions: 6706641\r\n```\r\n\r\nSource:\r\n```\r\ncouchdb-1  |   last msg: redacted\r\ncouchdb-1  |      state: {db,1,<<\"shards/80000000-ffffffff/registry.1701443011\">>,\"./data/shards/80000000-ffffffff/registry.1701443011.couch\",{couch_bt_engine,{st,\"./data/shards/80000000-ffffffff/registry.1701443011.couch\",<0.11598.134>,#Ref<0.3044753910.1255669761.76233>,undefined,{db_header,8,3613235,0,{26121481491,{1577414,873520,{size_info,24714622329,69234658312}},703579673},{25413913483,2450934,695597362},{26145142458,[],14096},nil,nil,25413913828,1000,<<\"70cfe76df29d4fbc3afde7122f7556e8\">>,[{nonode@nohost,0}],3613235,1000,25413913892},false,{btree,<0.11598.134>,{26121481491,{1577414,873520,{size_info,24714622329,69234658312}},703579673},fun couch_bt_engine:id_tree_split/1,fun couch_bt_engine:id_tree_join/2,undefined,fun couch_bt_engine:id_tree_reduce/2,snappy},{btree,<0.11598.134>,{25413913483,2450934,695597362},fun couch_bt_engine:seq_tree_split/1,fun couch_bt_engine:seq_tree_join/2,undefined,fun couch_bt_engine:seq_tree_reduce/2,snappy},{btree,<0.11598.134>,{26145142458,[],14096},fun couch_bt_engine:local_tree_split/1,fun couch_bt_engine:local_tree_join/2,undefined,nil,snappy},snappy,{btree,<0.11598.134>,nil,fun couch_bt_engine:purge_tree_split/1,fun couch_bt_engine:purge_tree_join/2,undefined,fun couch_bt_engine:purge_tree_reduce/2,snappy},{btree,<0.11598.134>,nil,fun couch_bt_engine:purge_seq_tree_split/1,fun couch_bt_engine:purge_seq_tree_join/2,undefined,fun couch_bt_engine:purge_tree_reduce/2,snappy}}},<0.11859.134>,nil,3613235,<<\"1733692258691242\">>,{user_ctx,null,[],undefined},[{<<\"members\">>,{[{<<\"roles\">>,[]},{<<\"names\">>,[]}]}},{<<\"admins\">>,{[{<<\"roles\">>,[]},{<<\"names\">>,[]}]}}],undefined,nil,nil,undefined,[{default_security_object,[{<<\"members\">>,{[{<<\"roles\">>,[<<\"_admin\">>]}]}},{<<\"admins\">>,{[{<<\"roles\">>,[<<\"_admin\">>]}]}}]},{props,[]}],undefined}\r\ncouchdb-1  |     extra: []\r\ncouchdb-1  | [notice] 2024-12-08T21:11:28.740645Z nonode@nohost <0.11889.134> b1bf5d5d4f pollux.vs.uni-kassel.de:5984 141.51.110.126 admin PUT /registry/_local/feeafdc2574e1244f85cfe9c724cfa11 500 ok 6\r\ncouchdb-1  | [error] 2024-12-08T21:11:28.740686Z nonode@nohost <0.11859.134> -------- gen_server <0.11859.134> terminated with reason: no match of right hand value {error,enospc} at couch_btree:write_node/3(line:483) <= couch_btree:modify_node/4(line:449) <= couch_btree:modify_kpnode/6(line:596) <= couch_btree:modify_node/4(line:430) <= couch_btree:query_modify/4(line:288) <= couch_btree:add_remove/3(line:265) <= couch_bt_engine:write_doc_infos/3(line:484) <= couch_db_engine:write_doc_infos/3(line:913)\r\ncouchdb-1  |   last msg: redacted\r\ncouchdb-1  |      state: {db,1,<<\"shards/80000000-ffffffff/registry.1701443011\">>,\"./data/shards/80000000-ffffffff/registry.1701443011.couch\",{couch_bt_engine,{st,\"./data/shards/80000000-ffffffff/registry.1701443011.couch\",<0.11598.134>,#Ref<0.3044753910.1255669761.76233>,undefined,{db_header,8,3613235,0,{26121481491,{1577414,873520,{size_info,24714622329,69234658312}},703579673},{25413913483,2450934,695597362},{26145142458,[],14096},nil,nil,25413913828,1000,<<\"70cfe76df29d4fbc3afde7122f7556e8\">>,[{nonode@nohost,0}],3613235,1000,25413913892},false,{btree,<0.11598.134>,{26121481491,{1577414,873520,{size_info,24714622329,69234658312}},703579673},fun couch_bt_engine:id_tree_split/1,fun couch_bt_engine:id_tree_join/2,undefined,fun couch_bt_engine:id_tree_reduce/2,snappy},{btree,<0.11598.134>,{25413913483,2450934,695597362},fun couch_bt_engine:seq_tree_split/1,fun couch_bt_engine:seq_tree_join/2,undefined,fun couch_bt_engine:seq_tree_reduce/2,snappy},{btree,<0.11598.134>,{26145142458,[],14096},fun couch_bt_engine:local_tree_split/1,fun couch_bt_engine:local_tree_join/2,undefined,nil,snappy},snappy,{btree,<0.11598.134>,nil,fun couch_bt_engine:purge_tree_split/1,fun couch_bt_engine:purge_tree_join/2,undefined,fun couch_bt_engine:purge_tree_reduce/2,snappy},{btree,<0.11598.134>,nil,fun couch_bt_engine:purge_seq_tree_split/1,fun couch_bt_engine:purge_seq_tree_join/2,undefined,fun couch_bt_engine:purge_tree_reduce/2,snappy}}},<0.11859.134>,nil,3613235,<<\"1733692258691242\">>,{user_ctx,null,[],undefined},[{<<\"members\">>,{[{<<\"roles\">>,[]},{<<\"names\">>,[]}]}},{<<\"admins\">>,{[{<<\"roles\">>,[]},{<<\"names\">>,[]}]}}],undefined,nil,nil,undefined,[{default_security_object,[{<<\"members\">>,{[{<<\"roles\">>,[<<\"_admin\">>]}]}},{<<\"admins\">>,{[{<<\"roles\">>,[<<\"_admin\">>]}]}}]},{props,[]}],undefined}\r\ncouchdb-1  |     extra: []\r\ncouchdb-1  | [error] 2024-12-08T21:11:28.741005Z nonode@nohost <0.11859.134> -------- CRASH REPORT Process  (<0.11859.134>) with 0 neighbors crashed with reason: no match of right hand value {error,enospc} at couch_btree:write_node/3(line:483) <= couch_btree:modify_node/4(line:449) <= couch_btree:modify_kpnode/6(line:596) <= couch_btree:modify_node/4(line:430) <= couch_btree:query_modify/4(line:288) <= couch_btree:add_remove/3(line:265) <= couch_bt_engine:write_doc_infos/3(line:484) <= couch_db_engine:write_doc_infos/3(line:913); initial_call: {couch_db_updater,init,['Argument__1']}, ancestors: [<0.11617.134>], message_queue_len: 0, links: [<0.423.0>], dictionary: [{idle_limit,61000},{io_priority,{db_update,<<\"shards/80000000-ffffffff/r...\">>}}], trap_exit: false, status: running, heap_size: 2586, stack_size: 28, reductions: 3007\r\ncouchdb-1  | [error] 2024-12-08T21:11:28.741264Z nonode@nohost <0.11859.134> -------- CRASH REPORT Process  (<0.11859.134>) with 0 neighbors crashed with reason: no match of right hand value {error,enospc} at couch_btree:write_node/3(line:483) <= couch_btree:modify_node/4(line:449) <= couch_btree:modify_kpnode/6(line:596) <= couch_btree:modify_node/4(line:430) <= couch_btree:query_modify/4(line:288) <= couch_btree:add_remove/3(line:265) <= couch_bt_engine:write_doc_infos/3(line:484) <= couch_db_engine:write_doc_infos/3(line:913); initial_call: {couch_db_updater,init,['Argument__1']}, ancestors: [<0.11617.134>], message_queue_len: 0, links: [<0.423.0>], dictionary: [{idle_limit,61000},{io_priority,{db_update,<<\"shards/80000000-ffffffff/r...\">>}}], trap_exit: false, status: running, heap_size: 2586, stack_size: 28, reductions: 3007\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2526385508/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2526607185","html_url":"https://github.com/apache/couchdb/issues/5004#issuecomment-2526607185","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5004","id":2526607185,"node_id":"IC_kwDOAAMmUc6WmPdR","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-09T01:41:54Z","updated_at":"2024-12-09T01:42:37Z","author_association":"CONTRIBUTOR","body":"```\r\nReplication `feeafdc2574e1244f85cfe9c724cfa11+continuous` \r\n (`http://pollux.vs.uni-kassel.de:5984/registry/` -> `http://couchdb-svc-couchdb:5984/registry/`) \r\nfailed: {http_request_failed,\"PUT\",\r\n                 \"http://pollux.vs.uni-kassel.de:5984/registry/_local/feeafdc2574e1244f85cfe9c724cfa11\",\r\n                 {error,{code,500}}}\r\n```\r\n\r\nThat looks like checkpointing on the source failed. And you're right to show the logs on the source:\r\n\r\n\r\n```\r\ncouchdb-1  | [notice] 2024-12-08T21:11:28.740645Z nonode@nohost <0.11889.134> \r\nb1bf5d5d4f pollux.vs.uni-kassel.de:5984 141.51.110.126 admin \r\nPUT /registry/_local/feeafdc2574e1244f85cfe9c724cfa11 500 ok 6\r\n\r\ncouchdb-1  | [error] 2024-12-08T21:11:28.740686Z nonode@nohost <0.11859.134> -------- \r\ngen_server <0.11859.134> terminated with reason: no match of right hand value \r\n{error,enospc} at couch_btree:write_node/3(line:483)\r\n```\r\n\r\nThe `{error,enospc}` indicates that the disk on that host doesn't have any more space. That happens the replication is trying to checkpoint on the source. You can find a way to make more space there (not that much even as local doc checkpoints are not that large) or bypass checkpointing altogether with [use-checkpoints](https://docs.couchdb.org/en/stable/config/replicator.html#replicator/use_checkpoints ) = `false`. Without checkpointing if it crashes it will restart form 0.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2526607185/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2527267203","html_url":"https://github.com/apache/couchdb/issues/5004#issuecomment-2527267203","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5004","id":2527267203,"node_id":"IC_kwDOAAMmUc6WowmD","user":{"login":"Clashsoft","id":4145923,"node_id":"MDQ6VXNlcjQxNDU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/4145923?v=4","gravatar_id":"","url":"https://api.github.com/users/Clashsoft","html_url":"https://github.com/Clashsoft","followers_url":"https://api.github.com/users/Clashsoft/followers","following_url":"https://api.github.com/users/Clashsoft/following{/other_user}","gists_url":"https://api.github.com/users/Clashsoft/gists{/gist_id}","starred_url":"https://api.github.com/users/Clashsoft/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Clashsoft/subscriptions","organizations_url":"https://api.github.com/users/Clashsoft/orgs","repos_url":"https://api.github.com/users/Clashsoft/repos","events_url":"https://api.github.com/users/Clashsoft/events{/privacy}","received_events_url":"https://api.github.com/users/Clashsoft/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-09T08:36:21Z","updated_at":"2024-12-09T09:25:58Z","author_association":"NONE","body":"How can I make more space if the entire disk is only occupied by couchdb? I tried to delete design docs/indexes I don't need, but I won't let me due to the same error.\r\nEdit: I just deleted the `.shards` directories.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2527267203/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2527380608","html_url":"https://github.com/apache/couchdb/pull/5351#issuecomment-2527380608","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5351","id":2527380608,"node_id":"IC_kwDOAAMmUc6WpMSA","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-09T09:26:19Z","updated_at":"2024-12-09T09:26:19Z","author_association":"CONTRIBUTOR","body":"Should this be mentioned somewhere in the documentation?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2527380608/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2527573085","html_url":"https://github.com/apache/couchdb/issues/1388#issuecomment-2527573085","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1388","id":2527573085,"node_id":"IC_kwDOAAMmUc6Wp7Rd","user":{"login":"sxumoyun","id":158552920,"node_id":"U_kgDOCXNTWA","avatar_url":"https://avatars.githubusercontent.com/u/158552920?v=4","gravatar_id":"","url":"https://api.github.com/users/sxumoyun","html_url":"https://github.com/sxumoyun","followers_url":"https://api.github.com/users/sxumoyun/followers","following_url":"https://api.github.com/users/sxumoyun/following{/other_user}","gists_url":"https://api.github.com/users/sxumoyun/gists{/gist_id}","starred_url":"https://api.github.com/users/sxumoyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sxumoyun/subscriptions","organizations_url":"https://api.github.com/users/sxumoyun/orgs","repos_url":"https://api.github.com/users/sxumoyun/repos","events_url":"https://api.github.com/users/sxumoyun/events{/privacy}","received_events_url":"https://api.github.com/users/sxumoyun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-09T10:49:15Z","updated_at":"2024-12-10T00:50:22Z","author_association":"NONE","body":"hello\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2527573085/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2528741344","html_url":"https://github.com/apache/couchdb/issues/5004#issuecomment-2528741344","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5004","id":2528741344,"node_id":"IC_kwDOAAMmUc6WuYfg","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-09T16:57:56Z","updated_at":"2024-12-09T16:57:56Z","author_association":"CONTRIBUTOR","body":"Yeah, deleting indexes would work, good idea.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2528741344/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2528941781","html_url":"https://github.com/apache/couchdb/pull/5351#issuecomment-2528941781","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5351","id":2528941781,"node_id":"IC_kwDOAAMmUc6WvJbV","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-09T18:02:04Z","updated_at":"2024-12-09T18:02:04Z","author_association":"CONTRIBUTOR","body":"> Should this be mentioned somewhere in the documentation?\r\n\r\nYes, thanks for the reminder! Opened https://github.com/apache/couchdb/pull/5355 for that purpose.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2528941781/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2529105373","html_url":"https://github.com/apache/couchdb/pull/5356#issuecomment-2529105373","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5356","id":2529105373,"node_id":"IC_kwDOAAMmUc6WvxXd","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-09T18:56:54Z","updated_at":"2024-12-09T18:56:54Z","author_association":"CONTRIBUTOR","body":"Since the branch name has `jenkins` in it  and currently macos won't pass will have to move the pr to a regular branch to avoid running the full CI as part of the PR.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2529105373/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2529112702","html_url":"https://github.com/apache/couchdb/pull/5356#issuecomment-2529112702","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5356","id":2529112702,"node_id":"IC_kwDOAAMmUc6WvzJ-","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-09T18:59:03Z","updated_at":"2024-12-09T18:59:03Z","author_association":"CONTRIBUTOR","body":"New PR https://github.com/apache/couchdb/pull/5357","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2529112702/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2529266542","html_url":"https://github.com/apache/couchdb/issues/5353#issuecomment-2529266542","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5353","id":2529266542,"node_id":"IC_kwDOAAMmUc6WwYtu","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-09T19:47:26Z","updated_at":"2024-12-10T05:28:01Z","author_association":"CONTRIBUTOR","body":"@remcovanvugt thanks for reaching out, the caveat is that you need EPEL with RHEL9.\r\n\r\nThe long story is RedHat, understandably, stopped including spidermonkey in the default system packages. The library deprecates its old versions too quickly for a decade long maintenance cycle. However mozjs78 is in EPEL though. That means your system would be dependent on EPEL. Your environment may not allow extra repos, and I don't know if mozjs78 will be in EPEL 5 years from now and if it will be maintained.\r\n\r\nIf you think the documentation is confusing we welcome PRs. Can add the `with caveats, needs EPEL` or bring up the discussion to remove it if you think it too confusing,  I am fine with that as well.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2529266542/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2530509419","html_url":"https://github.com/apache/couchdb/pull/5321#issuecomment-2530509419","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5321","id":2530509419,"node_id":"IC_kwDOAAMmUc6W1IJr","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-10T05:56:36Z","updated_at":"2024-12-10T05:56:36Z","author_association":"CONTRIBUTOR","body":"<img width=\"346\" alt=\"Screenshot 2024-12-10 at 12 55 05 AM\" src=\"https://github.com/user-attachments/assets/96066b0e-c8ad-4761-99b6-25b717001e4f\">\r\n\r\nPackages are now also working with SM 115 on Ubuntu Noble","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2530509419/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":2,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2533181099","html_url":"https://github.com/apache/couchdb/pull/5348#issuecomment-2533181099","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5348","id":2533181099,"node_id":"IC_kwDOAAMmUc6W_Uar","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-10T23:11:14Z","updated_at":"2024-12-10T23:13:39Z","author_association":"CONTRIBUTOR","body":"If `-F` works as described in https://docs.nose2.io/en/stable/plugins/failfast.html it does seem nicer for CI. \r\n\r\nWhen the first failure happens, it's nicer if it stops the test suite right there and makes the failure obvious so we don't have to hunt in the console logs for the first of failure. EUnit is a bit annoying in that respect as sometimes keeps going and we have to search for first `*failed*` or `*timeout*`. \r\n\r\nAnother positive of `-F` is it should release the CI worker earlier so other PR or Full CI runs can executed. We have a limited set of runners so sometimes jobs start piling up. Now locally, I would prefer without `-F` to catch all the failures and fix them all at once preferably. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2533181099/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2533196431","html_url":"https://github.com/apache/couchdb/pull/5352#issuecomment-2533196431","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5352","id":2533196431,"node_id":"IC_kwDOAAMmUc6W_YKP","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-10T23:17:08Z","updated_at":"2024-12-10T23:17:08Z","author_association":"CONTRIBUTOR","body":"Both the PR and the Full CI passed. Merging before we have to rebase and re-run everything again.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2533196431/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2536201028","html_url":"https://github.com/apache/couchdb/pull/5348#issuecomment-2536201028","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5348","id":2536201028,"node_id":"IC_kwDOAAMmUc6XK1tE","user":{"login":"jiahuili430","id":54631519,"node_id":"MDQ6VXNlcjU0NjMxNTE5","avatar_url":"https://avatars.githubusercontent.com/u/54631519?v=4","gravatar_id":"","url":"https://api.github.com/users/jiahuili430","html_url":"https://github.com/jiahuili430","followers_url":"https://api.github.com/users/jiahuili430/followers","following_url":"https://api.github.com/users/jiahuili430/following{/other_user}","gists_url":"https://api.github.com/users/jiahuili430/gists{/gist_id}","starred_url":"https://api.github.com/users/jiahuili430/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiahuili430/subscriptions","organizations_url":"https://api.github.com/users/jiahuili430/orgs","repos_url":"https://api.github.com/users/jiahuili430/repos","events_url":"https://api.github.com/users/jiahuili430/events{/privacy}","received_events_url":"https://api.github.com/users/jiahuili430/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-11T14:46:29Z","updated_at":"2024-12-11T14:46:29Z","author_association":"CONTRIBUTOR","body":"Thanks for the explanation Nick.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2536201028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2536250640","html_url":"https://github.com/apache/couchdb/pull/5348#issuecomment-2536250640","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5348","id":2536250640,"node_id":"IC_kwDOAAMmUc6XLB0Q","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-11T15:03:26Z","updated_at":"2024-12-11T15:03:26Z","author_association":"CONTRIBUTOR","body":"> When the first failure happens, it's nicer if it stops the test suite right there and makes the failure obvious so we don't have to hunt in the console logs for the first of failure. EUnit is a bit annoying in that respect\r\n\r\nI do not think that the Mango test suite logs are that elaborate as the ones for EUnit.  When there are no failures, `nose2` does not show much other that the dots for the progress (a handful of log lines).  Only failures are listed which are all relevant for the CI logs in my humble opinion.\r\n\r\n> Another positive of `-F` is it should release the CI worker earlier so other PR or Full CI runs can executed.\r\n\r\nI am surprised: 50-60 seconds mean so much?\r\n\r\n> Now locally, I would prefer without `-F` to catch all the failures and fix them all at once preferably.\r\n\r\nYeah, it would be nice to make the inclusion of the flag optional.  For example, let us remove it by default, and add it for the `MANGO_TEST_OPTS` `make` parameter for the CI run?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2536250640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2536393468","html_url":"https://github.com/apache/couchdb/pull/5348#issuecomment-2536393468","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5348","id":2536393468,"node_id":"IC_kwDOAAMmUc6XLkr8","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-11T15:57:04Z","updated_at":"2024-12-11T15:57:04Z","author_association":"CONTRIBUTOR","body":"> Only failures are listed which are all relevant for the CI logs in my humble opinion.\r\n\r\nAgree that's a pretty nice feature: if it works just show the dots. Wonder if EUnit has that feature...\r\n\r\n> I am surprised: 50-60 seconds mean so much?\r\n\r\nJust yesterday we had 4 queued up full CI jobs waiting to run, and always try eliminate timer:sleeps as much as we can from test to avoid wasting time,  so a whole minute seems like a lot of time in that respect. It's essentially wasted work, especially for a pull request job, because that PR is not getting merged any longer. Locally each developer can run tests longer with debug logs possibly and so on. But ideally for CI we'd want the jobs to run and pass or fail as quickly as possible.\r\n\r\n> For example, let us remove it by default, and add it for the MANGO_TEST_OPTS make parameter for the CI run?\r\n\r\nI am not familiar with MANGO_TEST_OPTS, but yeah, if it makes it easier to configure and in the CI mode it runs with \"fail fast\" that seems like it could work?\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2536393468/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2538204016","html_url":"https://github.com/apache/couchdb/issues/5077#issuecomment-2538204016","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5077","id":2538204016,"node_id":"IC_kwDOAAMmUc6XSetw","user":{"login":"DarrenCook","id":880436,"node_id":"MDQ6VXNlcjg4MDQzNg==","avatar_url":"https://avatars.githubusercontent.com/u/880436?v=4","gravatar_id":"","url":"https://api.github.com/users/DarrenCook","html_url":"https://github.com/DarrenCook","followers_url":"https://api.github.com/users/DarrenCook/followers","following_url":"https://api.github.com/users/DarrenCook/following{/other_user}","gists_url":"https://api.github.com/users/DarrenCook/gists{/gist_id}","starred_url":"https://api.github.com/users/DarrenCook/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DarrenCook/subscriptions","organizations_url":"https://api.github.com/users/DarrenCook/orgs","repos_url":"https://api.github.com/users/DarrenCook/repos","events_url":"https://api.github.com/users/DarrenCook/events{/privacy}","received_events_url":"https://api.github.com/users/DarrenCook/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-12T08:40:16Z","updated_at":"2024-12-12T08:40:16Z","author_association":"NONE","body":"Is the \"not-a-bug\" tag what is stopping this getting sorted?\r\n\r\nWe want to use the official package on Ubuntu24.04 LTS, but can't.\r\n\r\nWe tried using the \"jammy\" version with:\r\n `echo \"deb [signed-by=/usr/share/keyrings/couchdb-archive-keyring.gpg] https://apache.jfrog.io/artifactory/couchdb-deb/ jammy main\" | sudo tee /etc/apt/sources.list.d/couchdb.list >/dev/null`\r\n\r\nBut that gives:\r\n\r\n```\r\nThe following packages have unmet dependencies:\r\n couchdb : Depends: libmozjs-78-0 (>= 78.15.0) but it is not installable\r\n      Depends: libicu70 (>= 70.1-1~) but it is not installable\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2538204016/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2538986772","html_url":"https://github.com/apache/couchdb/issues/5004#issuecomment-2538986772","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5004","id":2538986772,"node_id":"IC_kwDOAAMmUc6XVd0U","user":{"login":"Clashsoft","id":4145923,"node_id":"MDQ6VXNlcjQxNDU5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/4145923?v=4","gravatar_id":"","url":"https://api.github.com/users/Clashsoft","html_url":"https://github.com/Clashsoft","followers_url":"https://api.github.com/users/Clashsoft/followers","following_url":"https://api.github.com/users/Clashsoft/following{/other_user}","gists_url":"https://api.github.com/users/Clashsoft/gists{/gist_id}","starred_url":"https://api.github.com/users/Clashsoft/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Clashsoft/subscriptions","organizations_url":"https://api.github.com/users/Clashsoft/orgs","repos_url":"https://api.github.com/users/Clashsoft/repos","events_url":"https://api.github.com/users/Clashsoft/events{/privacy}","received_events_url":"https://api.github.com/users/Clashsoft/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-12T13:43:08Z","updated_at":"2024-12-12T13:43:08Z","author_association":"NONE","body":"Now I'm stuck again with the original replication source, the npm registry:\r\n\r\n```\r\n[pod/couchdb-couchdb-2/couchdb] [notice] 2024-12-12T13:30:32.754275Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.21036.0> -------- recording a checkpoint for `https://replicate.npmjs.com/registry/` -> `http://couchdb-svc-couchdb:5984/registry/` at source update_seq 2099\r\n[pod/couchdb-couchdb-2/couchdb] [error] 2024-12-12T13:30:33.026452Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.21036.0> -------- Replication `bc6b9cb696ae379a2a05de39631f5d0f+continuous` (`https://replicate.npmjs.com/registry/` -> `http://couchdb-svc-couchdb:5984/registry/`) failed: {bad_return_value,{invalid_json,{1,invalid_literal}}}\r\n[pod/couchdb-couchdb-2/couchdb] [error] 2024-12-12T13:30:33.027290Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.21036.0> -------- gen_server <0.21036.0> terminated with reason: bad return value {invalid_json,{1,invalid_literal}}\r\n[pod/couchdb-couchdb-2/couchdb]   last msg: redacted\r\n[pod/couchdb-couchdb-2/couchdb]      state: [{rep_id,{\"bc6b9cb696ae379a2a05de39631f5d0f\",\"+continuous\"}},{source,\"https://replicate.npmjs.com/registry/\"},{target,\"http://couchdb-svc-couchdb:5984/registry/\"},{db_name,<<\"shards/80000000-ffffffff/_replicator.1733607930\">>},{doc_id,<<\"3ddcb9c5f47447f9cae76d91e00022a1\">>},{options,[{checkpoint_interval,5000},{connection_timeout,60000},{continuous,true},{create_target,false},{http_connections,20},{ibrowse_options,[]},{retries,5},{socket_options,[{keepalive,true},{nodelay,false}]},{use_bulk_get,false},{use_checkpoints,true},{worker_batch_size,500},{worker_processes,1}]},{session_id,<<\"dcd35a41280acb3dc66680605355d250\">>},{start_seq,{0,0}},{source_seq,37198643},{committed_seq,{0,0}},{current_through_seq,{72,2099}},{highest_seq_done,{72,2099}}]\r\n[pod/couchdb-couchdb-2/couchdb]     extra: []\r\n[pod/couchdb-couchdb-2/couchdb] [error] 2024-12-12T13:30:33.027403Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.21036.0> -------- gen_server <0.21036.0> terminated with reason: bad return value {invalid_json,{1,invalid_literal}}\r\n[pod/couchdb-couchdb-2/couchdb]   last msg: redacted\r\n[pod/couchdb-couchdb-2/couchdb]      state: [{rep_id,{\"bc6b9cb696ae379a2a05de39631f5d0f\",\"+continuous\"}},{source,\"https://replicate.npmjs.com/registry/\"},{target,\"http://couchdb-svc-couchdb:5984/registry/\"},{db_name,<<\"shards/80000000-ffffffff/_replicator.1733607930\">>},{doc_id,<<\"3ddcb9c5f47447f9cae76d91e00022a1\">>},{options,[{checkpoint_interval,5000},{connection_timeout,60000},{continuous,true},{create_target,false},{http_connections,20},{ibrowse_options,[]},{retries,5},{socket_options,[{keepalive,true},{nodelay,false}]},{use_bulk_get,false},{use_checkpoints,true},{worker_batch_size,500},{worker_processes,1}]},{session_id,<<\"dcd35a41280acb3dc66680605355d250\">>},{start_seq,{0,0}},{source_seq,37198643},{committed_seq,{0,0}},{current_through_seq,{72,2099}},{highest_seq_done,{72,2099}}]\r\n[pod/couchdb-couchdb-2/couchdb]     extra: []\r\n[pod/couchdb-couchdb-2/couchdb] [error] 2024-12-12T13:30:33.027579Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.21036.0> -------- CRASH REPORT Process  (<0.21036.0>) with 3 neighbors exited with reason: bad return value {invalid_json,{1,invalid_literal}} at gen_server:handle_common_reply/8(line:1245) <= proc_lib:init_p_do_apply/3(line:240); initial_call: {couch_replicator_scheduler_job,init,['Argument__1']}, ancestors: [couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 3, links: [<0.21162.0>,<0.21164.0>,<0.21165.0>,<0.21163.0>,<0.592.0>], dictionary: [{rand_seed,{#{bits => 58,jump => #Fun<rand.3.34006561>,next => ...,...},...}},...], trap_exit: true, status: running, heap_size: 6772, stack_size: 28, reductions: 49346\r\n[pod/couchdb-couchdb-2/couchdb] [error] 2024-12-12T13:30:33.027674Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.21036.0> -------- CRASH REPORT Process  (<0.21036.0>) with 3 neighbors exited with reason: bad return value {invalid_json,{1,invalid_literal}} at gen_server:handle_common_reply/8(line:1245) <= proc_lib:init_p_do_apply/3(line:240); initial_call: {couch_replicator_scheduler_job,init,['Argument__1']}, ancestors: [couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 3, links: [<0.21162.0>,<0.21164.0>,<0.21165.0>,<0.21163.0>,<0.592.0>], dictionary: [{rand_seed,{#{bits => 58,jump => #Fun<rand.3.34006561>,next => ...,...},...}},...], trap_exit: true, status: running, heap_size: 6772, stack_size: 28, reductions: 49346\r\n[pod/couchdb-couchdb-2/couchdb] [error] 2024-12-12T13:30:33.027736Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.21165.0> -------- gen_server <0.21165.0> terminated with reason: bad return value {invalid_json,{1,invalid_literal}}\r\n[pod/couchdb-couchdb-2/couchdb]   last msg: redacted\r\n[pod/couchdb-couchdb-2/couchdb]      state: [{main_pid,<0.21036.0>},{loop,<0.21166.0>},{source,\"https://replicate.npmjs.com/registry/\"},{target,\"http://couchdb-svc-couchdb:5984/registry/\"},{num_readers,0},{pending_fetch,nil},{batch_size,0}]\r\n[pod/couchdb-couchdb-2/couchdb]     extra: []\r\n[pod/couchdb-couchdb-2/couchdb] [error] 2024-12-12T13:30:33.027777Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.21165.0> -------- gen_server <0.21165.0> terminated with reason: bad return value {invalid_json,{1,invalid_literal}}\r\n[pod/couchdb-couchdb-2/couchdb]   last msg: redacted\r\n[pod/couchdb-couchdb-2/couchdb]      state: [{main_pid,<0.21036.0>},{loop,<0.21166.0>},{source,\"https://replicate.npmjs.com/registry/\"},{target,\"http://couchdb-svc-couchdb:5984/registry/\"},{num_readers,0},{pending_fetch,nil},{batch_size,0}]\r\n[pod/couchdb-couchdb-2/couchdb]     extra: []\r\n[pod/couchdb-couchdb-2/couchdb] [error] 2024-12-12T13:30:33.027840Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.21165.0> -------- CRASH REPORT Process  (<0.21165.0>) with 0 neighbors exited with reason: bad return value {invalid_json,{1,invalid_literal}} at gen_server:decode_msg/9(line:909) <= proc_lib:init_p_do_apply/3(line:240); initial_call: {couch_replicator_worker,init,['Argument__1']}, ancestors: [<0.21036.0>,couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 0, links: [<0.21166.0>], dictionary: [], trap_exit: true, status: running, heap_size: 1598, stack_size: 28, reductions: 6467\r\n[pod/couchdb-couchdb-2/couchdb] [error] 2024-12-12T13:30:33.027924Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.21165.0> -------- CRASH REPORT Process  (<0.21165.0>) with 0 neighbors exited with reason: bad return value {invalid_json,{1,invalid_literal}} at gen_server:decode_msg/9(line:909) <= proc_lib:init_p_do_apply/3(line:240); initial_call: {couch_replicator_worker,init,['Argument__1']}, ancestors: [<0.21036.0>,couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 0, links: [<0.21166.0>], dictionary: [], trap_exit: true, status: running, heap_size: 1598, stack_size: 28, reductions: 6467\r\n```\r\n\r\nAnd:\r\n\r\n```\r\n[pod/couchdb-couchdb-2/couchdb] [error] 2024-12-12T13:36:37.673186Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.25933.0> -------- Replicator, request POST to \"https://replicate.npmjs.com/registry/_ensure_full_commit\" failed due to error {code,504}\r\n[pod/couchdb-couchdb-2/couchdb] [error] 2024-12-12T13:36:37.673548Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.25168.0> -------- Replication `bc6b9cb696ae379a2a05de39631f5d0f+continuous` (`https://replicate.npmjs.com/registry/` -> `http://couchdb-svc-couchdb:5984/registry/`) failed: {checkpoint_commit_failure,<<\"Failure on source commit: {'EXIT',{http_request_failed,\\\"POST\\\",\\n                             \\\"https://replicate.npmjs.com/registry/_ensure_full_commit\\\",\\n                             {error,{code,504}}}}\">>}\r\n[pod/couchdb-couchdb-0/couchdb] [notice] 2024-12-12T13:36:38.424668Z couchdb@couchdb-couchdb-0.couchdb-couchdb.web-kraken.svc.cluster.local <0.18057.0> acfb8e39f5 couchdb.web-kraken.uni-kassel.dev 10.42.75.128 admin GET /_active_tasks 200 ok 3\r\n[pod/couchdb-couchdb-2/couchdb] [error] 2024-12-12T13:36:44.048501Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.25168.0> -------- gen_server <0.25168.0> terminated with reason: {checkpoint_commit_failure,<<\"Failure on source commit: {'EXIT',{http_request_failed,\\\"POST\\\",\\n                             \\\"https://replicate.npmjs.com/registry/_ensure_full_commit\\\",\\n                             {error,{code,504}}}}\">>}\r\n[pod/couchdb-couchdb-2/couchdb]   last msg: redacted\r\n[pod/couchdb-couchdb-2/couchdb]      state: [{rep_id,{\"bc6b9cb696ae379a2a05de39631f5d0f\",\"+continuous\"}},{source,\"https://replicate.npmjs.com/registry/\"},{target,\"http://couchdb-svc-couchdb:5984/registry/\"},{db_name,<<\"shards/80000000-ffffffff/_replicator.1733607930\">>},{doc_id,<<\"3ddcb9c5f47447f9cae76d91e00022a1\">>},{options,[{checkpoint_interval,5000},{connection_timeout,60000},{continuous,true},{create_target,false},{http_connections,20},{ibrowse_options,[]},{retries,5},{socket_options,[{keepalive,true},{nodelay,false}]},{use_bulk_get,false},{use_checkpoints,true},{worker_batch_size,500},{worker_processes,1}]},{session_id,<<\"5bf633e8a5688c8804f002e40e2c48cc\">>},{start_seq,{0,0}},{source_seq,37198716},{committed_seq,{0,0}},{current_through_seq,{2,13}},{highest_seq_done,{2,13}}]\r\n[pod/couchdb-couchdb-2/couchdb]     extra: []\r\n[pod/couchdb-couchdb-2/couchdb] [error] 2024-12-12T13:36:44.048636Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.25168.0> -------- gen_server <0.25168.0> terminated with reason: {checkpoint_commit_failure,<<\"Failure on source commit: {'EXIT',{http_request_failed,\\\"POST\\\",\\n                             \\\"https://replicate.npmjs.com/registry/_ensure_full_commit\\\",\\n                             {error,{code,504}}}}\">>}\r\n[pod/couchdb-couchdb-2/couchdb]   last msg: redacted\r\n[pod/couchdb-couchdb-2/couchdb]      state: [{rep_id,{\"bc6b9cb696ae379a2a05de39631f5d0f\",\"+continuous\"}},{source,\"https://replicate.npmjs.com/registry/\"},{target,\"http://couchdb-svc-couchdb:5984/registry/\"},{db_name,<<\"shards/80000000-ffffffff/_replicator.1733607930\">>},{doc_id,<<\"3ddcb9c5f47447f9cae76d91e00022a1\">>},{options,[{checkpoint_interval,5000},{connection_timeout,60000},{continuous,true},{create_target,false},{http_connections,20},{ibrowse_options,[]},{retries,5},{socket_options,[{keepalive,true},{nodelay,false}]},{use_bulk_get,false},{use_checkpoints,true},{worker_batch_size,500},{worker_processes,1}]},{session_id,<<\"5bf633e8a5688c8804f002e40e2c48cc\">>},{start_seq,{0,0}},{source_seq,37198716},{committed_seq,{0,0}},{current_through_seq,{2,13}},{highest_seq_done,{2,13}}]\r\n[pod/couchdb-couchdb-2/couchdb]     extra: []\r\n[pod/couchdb-couchdb-2/couchdb] [error] 2024-12-12T13:36:44.050178Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.25168.0> -------- CRASH REPORT Process  (<0.25168.0>) with 3 neighbors exited with reason: {checkpoint_commit_failure,<<\"Failure on source commit: {'EXIT',{http_request_failed,\\\"POST\\\",\\n                             \\\"https://replicate.npmjs.com/registry/_ensure_full_commit\\\",\\n                             {error,{code,504}}}}\">>} at gen_server:handle_common_reply/8(line:1241) <= proc_lib:init_p_do_apply/3(line:240); initial_call: {couch_replicator_scheduler_job,init,['Argument__1']}, ancestors: [couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 3, links: [<0.25742.0>,<0.25744.0>,<0.25745.0>,<0.25743.0>,<0.592.0>], dictionary: [{rand_seed,{#{bits => 58,jump => #Fun<rand.3.34006561>,next => ...,...},...}},...], trap_exit: true, status: running, heap_size: 6772, stack_size: 28, reductions: 29599\r\n[pod/couchdb-couchdb-2/couchdb] [notice] 2024-12-12T13:36:44.050222Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.592.0> -------- couch_replicator_scheduler: Job {\"bc6b9cb696ae379a2a05de39631f5d0f\",\"+continuous\"} started as <0.28499.0>\r\n[pod/couchdb-couchdb-2/couchdb] [error] 2024-12-12T13:36:44.050353Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.25168.0> -------- CRASH REPORT Process  (<0.25168.0>) with 3 neighbors exited with reason: {checkpoint_commit_failure,<<\"Failure on source commit: {'EXIT',{http_request_failed,\\\"POST\\\",\\n                             \\\"https://replicate.npmjs.com/registry/_ensure_full_commit\\\",\\n                             {error,{code,504}}}}\">>} at gen_server:handle_common_reply/8(line:1241) <= proc_lib:init_p_do_apply/3(line:240); initial_call: {couch_replicator_scheduler_job,init,['Argument__1']}, ancestors: [couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 3, links: [<0.25742.0>,<0.25744.0>,<0.25745.0>,<0.25743.0>,<0.592.0>], dictionary: [{rand_seed,{#{bits => 58,jump => #Fun<rand.3.34006561>,next => ...,...},...}},...], trap_exit: true, status: running, heap_size: 6772, stack_size: 28, reductions: 29599\r\n[pod/couchdb-couchdb-2/couchdb] [error] 2024-12-12T13:36:44.050457Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.25745.0> -------- gen_server <0.25745.0> terminated with reason: {checkpoint_commit_failure,<<\"Failure on source commit: {'EXIT',{http_request_failed,\\\"POST\\\",\\n                             \\\"https://replicate.npmjs.com/registry/_ensure_full_commit\\\",\\n                             {error,{code,504}}}}\">>}\r\n[pod/couchdb-couchdb-2/couchdb]   last msg: redacted\r\n[pod/couchdb-couchdb-2/couchdb]      state: [{main_pid,<0.25168.0>},{loop,<0.25746.0>},{source,\"https://replicate.npmjs.com/registry/\"},{target,\"http://couchdb-svc-couchdb:5984/registry/\"},{num_readers,0},{pending_fetch,nil},{batch_size,0}]\r\n[pod/couchdb-couchdb-2/couchdb]     extra: []\r\n[pod/couchdb-couchdb-2/couchdb] [error] 2024-12-12T13:36:44.050565Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.25745.0> -------- gen_server <0.25745.0> terminated with reason: {checkpoint_commit_failure,<<\"Failure on source commit: {'EXIT',{http_request_failed,\\\"POST\\\",\\n                             \\\"https://replicate.npmjs.com/registry/_ensure_full_commit\\\",\\n                             {error,{code,504}}}}\">>}\r\n[pod/couchdb-couchdb-2/couchdb]   last msg: redacted\r\n[pod/couchdb-couchdb-2/couchdb]      state: [{main_pid,<0.25168.0>},{loop,<0.25746.0>},{source,\"https://replicate.npmjs.com/registry/\"},{target,\"http://couchdb-svc-couchdb:5984/registry/\"},{num_readers,0},{pending_fetch,nil},{batch_size,0}]\r\n[pod/couchdb-couchdb-2/couchdb]     extra: []\r\n[pod/couchdb-couchdb-2/couchdb] [error] 2024-12-12T13:36:44.050673Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.25745.0> -------- CRASH REPORT Process  (<0.25745.0>) with 0 neighbors exited with reason: {checkpoint_commit_failure,<<\"Failure on source commit: {'EXIT',{http_request_failed,\\\"POST\\\",\\n                             \\\"https://replicate.npmjs.com/registry/_ensure_full_commit\\\",\\n                             {error,{code,504}}}}\">>} at gen_server:decode_msg/9(line:909) <= proc_lib:init_p_do_apply/3(line:240); initial_call: {couch_replicator_worker,init,['Argument__1']}, ancestors: [<0.25168.0>,couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 1, links: [], dictionary: [], trap_exit: true, status: running, heap_size: 1598, stack_size: 28, reductions: 915\r\n[pod/couchdb-couchdb-2/couchdb] [error] 2024-12-12T13:36:44.050791Z couchdb@couchdb-couchdb-2.couchdb-couchdb.web-kraken.svc.cluster.local <0.25745.0> -------- CRASH REPORT Process  (<0.25745.0>) with 0 neighbors exited with reason: {checkpoint_commit_failure,<<\"Failure on source commit: {'EXIT',{http_request_failed,\\\"POST\\\",\\n                             \\\"https://replicate.npmjs.com/registry/_ensure_full_commit\\\",\\n                             {error,{code,504}}}}\">>} at gen_server:decode_msg/9(line:909) <= proc_lib:init_p_do_apply/3(line:240); initial_call: {couch_replicator_worker,init,['Argument__1']}, ancestors: [<0.25168.0>,couch_replicator_scheduler,couch_replicator_sup,...], message_queue_len: 1, links: [], dictionary: [], trap_exit: true, status: running, heap_size: 1598, stack_size: 28, reductions: 915\r\n```\r\n\r\nI went with the config you suggested [here](https://github.com/apache/couchdb/issues/5004#issuecomment-2525305402) to track down the issue. But from the context of the log and the fact that not a single document was added, I suppose this time the problem might be the checkpoint?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2538986772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2539278265","html_url":"https://github.com/apache/couchdb/pull/5361#issuecomment-2539278265","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5361","id":2539278265,"node_id":"IC_kwDOAAMmUc6XWk-5","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-12T15:24:31Z","updated_at":"2024-12-12T15:24:31Z","author_association":"MEMBER","body":"Holding in draft until SM>91 support was added to 3.4.x","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2539278265/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2539354108","html_url":"https://github.com/apache/couchdb/pull/5362#issuecomment-2539354108","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5362","id":2539354108,"node_id":"IC_kwDOAAMmUc6XW3f8","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-12T15:54:56Z","updated_at":"2024-12-12T15:54:56Z","author_association":"MEMBER","body":"closing in favour of https://github.com/apache/couchdb/pull/5363","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2539354108/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2539356998","html_url":"https://github.com/apache/couchdb/pull/5363#issuecomment-2539356998","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5363","id":2539356998,"node_id":"IC_kwDOAAMmUc6XW4NG","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-12T15:56:09Z","updated_at":"2024-12-12T15:56:09Z","author_association":"CONTRIBUTOR","body":"From #5362:\r\n> To give it a try, make a separate branch with a `jenkins-` prefix with a new commit sha (`git commit amend --no-edit`).\r\n\r\nMaybe if #5360 is merged, so we can se if it works on the macOS Ci too?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2539356998/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2541931826","html_url":"https://github.com/apache/couchdb/pull/5321#issuecomment-2541931826","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5321","id":2541931826,"node_id":"IC_kwDOAAMmUc6Xgs0y","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-13T17:35:08Z","updated_at":"2024-12-13T17:35:08Z","author_association":"CONTRIBUTOR","body":"Do you want to keep around the branch after the merge?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2541931826/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2542341532","html_url":"https://github.com/apache/couchdb/pull/5321#issuecomment-2542341532","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5321","id":2542341532,"node_id":"IC_kwDOAAMmUc6XiQ2c","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-13T20:53:29Z","updated_at":"2024-12-13T20:53:29Z","author_association":"CONTRIBUTOR","body":"No, thx for the reminder 🙏","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2542341532/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2542666467","html_url":"https://github.com/apache/couchdb/pull/5364#issuecomment-2542666467","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5364","id":2542666467,"node_id":"IC_kwDOAAMmUc6XjgLj","user":{"login":"jiahuili430","id":54631519,"node_id":"MDQ6VXNlcjU0NjMxNTE5","avatar_url":"https://avatars.githubusercontent.com/u/54631519?v=4","gravatar_id":"","url":"https://api.github.com/users/jiahuili430","html_url":"https://github.com/jiahuili430","followers_url":"https://api.github.com/users/jiahuili430/followers","following_url":"https://api.github.com/users/jiahuili430/following{/other_user}","gists_url":"https://api.github.com/users/jiahuili430/gists{/gist_id}","starred_url":"https://api.github.com/users/jiahuili430/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiahuili430/subscriptions","organizations_url":"https://api.github.com/users/jiahuili430/orgs","repos_url":"https://api.github.com/users/jiahuili430/repos","events_url":"https://api.github.com/users/jiahuili430/events{/privacy}","received_events_url":"https://api.github.com/users/jiahuili430/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-14T02:13:03Z","updated_at":"2024-12-14T02:13:57Z","author_association":"CONTRIBUTOR","body":"Testing branch: [`jenkins-sm-backward-compatibility`](https://github.com/apache/couchdb/compare/main...jenkins-sm-backward-compatibility)\r\n![image](https://github.com/user-attachments/assets/c037e0d8-5921-4c5d-b341-845958cd219d)\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2542666467/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2543154468","html_url":"https://github.com/apache/couchdb/issues/5359#issuecomment-2543154468","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5359","id":2543154468,"node_id":"IC_kwDOAAMmUc6XlXUk","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-14T15:27:52Z","updated_at":"2024-12-14T15:27:52Z","author_association":"CONTRIBUTOR","body":"Closing this as duplicate of #5077.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2543154468/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2543157138","html_url":"https://github.com/apache/couchdb/issues/5077#issuecomment-2543157138","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5077","id":2543157138,"node_id":"IC_kwDOAAMmUc6XlX-S","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-14T15:34:44Z","updated_at":"2024-12-14T15:34:44Z","author_association":"CONTRIBUTOR","body":"> Is the \"not-a-bug\" tag what is stopping this getting sorted?\r\n\r\nThe show-stopper here was the missing support for SpiderMonkey versions >91. With commit 2cfb0c3764ee811b70213df4dcea1de5618187fe we added support for those versions and with commit [a79a290](https://github.com/apache/couchdb-pkg/commit/a79a2900978c06ab115f812010885b499551e671) we added package support for Noble.\r\n\r\nIn the meantime, you could test pre-build binaries from the main branch, e.g. https://ci-couchdb.apache.org/job/jenkins-cm1/job/FullPlatformMatrix/job/main/lastSuccessfulBuild/artifact/pkgs/ until we make an official release for Noble.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2543157138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2545900930","html_url":"https://github.com/apache/couchdb/issues/1497#issuecomment-2545900930","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1497","id":2545900930,"node_id":"IC_kwDOAAMmUc6Xv12C","user":{"login":"jonasplaum","id":9090041,"node_id":"MDQ6VXNlcjkwOTAwNDE=","avatar_url":"https://avatars.githubusercontent.com/u/9090041?v=4","gravatar_id":"","url":"https://api.github.com/users/jonasplaum","html_url":"https://github.com/jonasplaum","followers_url":"https://api.github.com/users/jonasplaum/followers","following_url":"https://api.github.com/users/jonasplaum/following{/other_user}","gists_url":"https://api.github.com/users/jonasplaum/gists{/gist_id}","starred_url":"https://api.github.com/users/jonasplaum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jonasplaum/subscriptions","organizations_url":"https://api.github.com/users/jonasplaum/orgs","repos_url":"https://api.github.com/users/jonasplaum/repos","events_url":"https://api.github.com/users/jonasplaum/events{/privacy}","received_events_url":"https://api.github.com/users/jonasplaum/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-16T15:16:44Z","updated_at":"2024-12-16T15:16:44Z","author_association":"CONTRIBUTOR","body":"Is this still on the roadmap? In my opinion it has the potential to improve performance for clients and replication by quite a bit. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2545900930/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2546178864","html_url":"https://github.com/apache/couchdb/pull/5364#issuecomment-2546178864","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5364","id":2546178864,"node_id":"IC_kwDOAAMmUc6Xw5sw","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-16T17:07:55Z","updated_at":"2024-12-16T17:07:55Z","author_association":"CONTRIBUTOR","body":"Oops, it does look like we broke SM 1.8.5 support. It's still one of the fastest SM engine versions out of the box, especially when using custom reduces.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2546178864/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2546186303","html_url":"https://github.com/apache/couchdb/pull/5321#issuecomment-2546186303","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5321","id":2546186303,"node_id":"IC_kwDOAAMmUc6Xw7g_","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-16T17:11:20Z","updated_at":"2024-12-16T17:11:20Z","author_association":"CONTRIBUTOR","body":"It looks like we broke SM 1.8.5 support here. Thanks to @jiahuili430 for noticing and fixing it in https://github.com/apache/couchdb/pull/5364!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2546186303/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2546242622","html_url":"https://github.com/apache/couchdb/issues/1497#issuecomment-2546242622","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1497","id":2546242622,"node_id":"IC_kwDOAAMmUc6XxJQ-","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-16T17:35:36Z","updated_at":"2024-12-16T17:37:00Z","author_association":"CONTRIBUTOR","body":"@Sliosh it's still a good idea, yeah. For replication, it's hard to tell if it will improve the performance much. The client there already manages a pool of http(s) connections, and re-uses them aggressively, even across multiple replication jobs (if they point to the same endpoint clusters). That could perhaps have some advantage over http/2,  as it could avoid head-of line blocking for each individual TCP connection.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2546242622/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2551494147","html_url":"https://github.com/apache/couchdb/issues/5322#issuecomment-2551494147","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5322","id":2551494147,"node_id":"IC_kwDOAAMmUc6YFLYD","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-18T14:41:15Z","updated_at":"2024-12-18T14:41:15Z","author_association":"CONTRIBUTOR","body":"@nickva \r\n> \"It's never the compiler, until it's the compiler!\r\n\r\nWorkaround and infos: https://bugzilla.mozilla.org/show_bug.cgi?id=1768634","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2551494147/reactions","total_count":1,"+1":0,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2552361551","html_url":"https://github.com/apache/couchdb/issues/5358#issuecomment-2552361551","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5358","id":2552361551,"node_id":"IC_kwDOAAMmUc6YIfJP","user":{"login":"retrodaredevil","id":13205600,"node_id":"MDQ6VXNlcjEzMjA1NjAw","avatar_url":"https://avatars.githubusercontent.com/u/13205600?v=4","gravatar_id":"","url":"https://api.github.com/users/retrodaredevil","html_url":"https://github.com/retrodaredevil","followers_url":"https://api.github.com/users/retrodaredevil/followers","following_url":"https://api.github.com/users/retrodaredevil/following{/other_user}","gists_url":"https://api.github.com/users/retrodaredevil/gists{/gist_id}","starred_url":"https://api.github.com/users/retrodaredevil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/retrodaredevil/subscriptions","organizations_url":"https://api.github.com/users/retrodaredevil/orgs","repos_url":"https://api.github.com/users/retrodaredevil/repos","events_url":"https://api.github.com/users/retrodaredevil/events{/privacy}","received_events_url":"https://api.github.com/users/retrodaredevil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-18T22:08:31Z","updated_at":"2024-12-18T22:08:31Z","author_association":"NONE","body":"I'm going to close this as I don't really see this as an issue, just a slight change in behavior that was probably never intended to be relied upon.\r\n\r\nIf others think useful discussion could come of keeping this issue open, feel free to reopen it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2552361551/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2552625758","html_url":"https://github.com/apache/couchdb/issues/5358#issuecomment-2552625758","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5358","id":2552625758,"node_id":"IC_kwDOAAMmUc6YJfpe","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-19T02:09:32Z","updated_at":"2024-12-19T02:09:32Z","author_association":"CONTRIBUTOR","body":"Thanks for reaching out @retrodaredevil.\r\n\r\nYeah, that's expected behavior  as we changed the default password hashing function https://docs.couchdb.org/en/stable/whatsnew/3.4.html.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2552625758/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2555507280","html_url":"https://github.com/apache/couchdb/pull/5368#issuecomment-2555507280","issue_url":"https://api.github.com/repos/apache/couchdb/issues/5368","id":2555507280,"node_id":"IC_kwDOAAMmUc6YUfJQ","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-19T18:25:51Z","updated_at":"2024-12-19T18:25:51Z","author_association":"CONTRIBUTOR","body":"<img width=\"745\" alt=\"Screenshot 2024-12-19 at 1 25 27 PM\" src=\"https://github.com/user-attachments/assets/339d3241-9b69-4dd4-8067-90744e7cea87\" />\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/2555507280/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]