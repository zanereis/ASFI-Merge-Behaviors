[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/751895301","html_url":"https://github.com/apache/iceberg/pull/1895#issuecomment-751895301","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1895","id":751895301,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MTg5NTMwMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-28T23:29:45Z","updated_at":"2020-12-28T23:29:45Z","author_association":"CONTRIBUTOR","body":"@rymurr or @jacques-n, any update on this? I would like to aim to get it into the next release.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/751895301/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/751897739","html_url":"https://github.com/apache/iceberg/pull/1895#issuecomment-751897739","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1895","id":751897739,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MTg5NzczOQ==","user":{"login":"jacques-n","id":183350,"node_id":"MDQ6VXNlcjE4MzM1MA==","avatar_url":"https://avatars.githubusercontent.com/u/183350?v=4","gravatar_id":"","url":"https://api.github.com/users/jacques-n","html_url":"https://github.com/jacques-n","followers_url":"https://api.github.com/users/jacques-n/followers","following_url":"https://api.github.com/users/jacques-n/following{/other_user}","gists_url":"https://api.github.com/users/jacques-n/gists{/gist_id}","starred_url":"https://api.github.com/users/jacques-n/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jacques-n/subscriptions","organizations_url":"https://api.github.com/users/jacques-n/orgs","repos_url":"https://api.github.com/users/jacques-n/repos","events_url":"https://api.github.com/users/jacques-n/events{/privacy}","received_events_url":"https://api.github.com/users/jacques-n/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-28T23:43:46Z","updated_at":"2020-12-28T23:43:46Z","author_association":"NONE","body":"We just merged [Nessie#575](https://github.com/projectnessie/nessie/pull/575) which removes the Jaxrs/jersey requirement entirely. We'll push a release shortly that updates the dependency to avoid this extra set of licenses.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/751897739/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/751919793","html_url":"https://github.com/apache/iceberg/issues/1980#issuecomment-751919793","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1980","id":751919793,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MTkxOTc5Mw==","user":{"login":"dmgcodevil","id":1413873,"node_id":"MDQ6VXNlcjE0MTM4NzM=","avatar_url":"https://avatars.githubusercontent.com/u/1413873?v=4","gravatar_id":"","url":"https://api.github.com/users/dmgcodevil","html_url":"https://github.com/dmgcodevil","followers_url":"https://api.github.com/users/dmgcodevil/followers","following_url":"https://api.github.com/users/dmgcodevil/following{/other_user}","gists_url":"https://api.github.com/users/dmgcodevil/gists{/gist_id}","starred_url":"https://api.github.com/users/dmgcodevil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmgcodevil/subscriptions","organizations_url":"https://api.github.com/users/dmgcodevil/orgs","repos_url":"https://api.github.com/users/dmgcodevil/repos","events_url":"https://api.github.com/users/dmgcodevil/events{/privacy}","received_events_url":"https://api.github.com/users/dmgcodevil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-29T02:03:31Z","updated_at":"2020-12-29T02:03:31Z","author_association":"CONTRIBUTOR","body":"@rdblue [PR](https://github.com/apache/iceberg/pull/2001) The fix fork, but I believe that there is a better way to fix it","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/751919793/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752015048","html_url":"https://github.com/apache/iceberg/pull/1704#issuecomment-752015048","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1704","id":752015048,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjAxNTA0OA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-29T09:46:34Z","updated_at":"2020-12-29T09:46:34Z","author_association":"MEMBER","body":"Patch looks good to me,  left few minor comments.  Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752015048/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752019508","html_url":"https://github.com/apache/iceberg/pull/1993#issuecomment-752019508","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1993","id":752019508,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjAxOTUwOA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-29T10:02:26Z","updated_at":"2020-12-29T10:02:26Z","author_association":"CONTRIBUTOR","body":"Thanks for adding these, @jun-he!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752019508/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752048650","html_url":"https://github.com/apache/iceberg/issues/1904#issuecomment-752048650","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1904","id":752048650,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjA0ODY1MA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-29T11:50:38Z","updated_at":"2020-12-29T11:50:38Z","author_association":"CONTRIBUTOR","body":"I think this one was resolved in PR #1998. Thanks, @jackye1995!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752048650/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752181783","html_url":"https://github.com/apache/iceberg/pull/2001#issuecomment-752181783","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2001","id":752181783,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjE4MTc4Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-29T17:51:08Z","updated_at":"2020-12-29T17:51:08Z","author_association":"CONTRIBUTOR","body":"Thanks for fixing this, @dmgcodevil! Looks close, just a few things to update.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752181783/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752223855","html_url":"https://github.com/apache/iceberg/issues/1680#issuecomment-752223855","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1680","id":752223855,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjIyMzg1NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-29T20:02:55Z","updated_at":"2020-12-29T20:02:55Z","author_association":"CONTRIBUTOR","body":"I started working on this and realized that it is simpler to account for the bad values produced by version 0.10.0 and older.\r\n\r\nTesting showed that the date transform didn't have the bug, so documenting the behavior would be more complicated in the spec. In addition, adding new transforms to the spec would be a much larger addition than adding example test cases and noting old versions that were affected because it would require twice as many supported date/time transforms.\r\n\r\nInstead, I chose to adjust when projecting data predicates to partition predicates. The advantage is that the update to the spec only needs to be a few test values and a note about the behavior of old versions. Getting this in by v2 also means that the adjustment isn't needed for tables that are created as v2 tables because v1 writers with the problem cannot read or write v2 tables.\r\n\r\n#1981 has more extensive tests for date/time transforms and adjusts predicates while projecting to account for the transform bug. Once that is in, I'll update the spec with test values, a description of the problem, and affected versions.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752223855/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752287400","html_url":"https://github.com/apache/iceberg/pull/2003#issuecomment-752287400","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2003","id":752287400,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjI4NzQwMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T00:39:16Z","updated_at":"2020-12-30T00:39:29Z","author_association":"CONTRIBUTOR","body":"Thanks for the update, @martint! I'll also add a redirect from the old presto/ location.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752287400/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752287963","html_url":"https://github.com/apache/iceberg/pull/2004#issuecomment-752287963","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2004","id":752287963,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjI4Nzk2Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T00:42:52Z","updated_at":"2020-12-30T00:42:52Z","author_association":"CONTRIBUTOR","body":"@martint FYI.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752287963/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752298764","html_url":"https://github.com/apache/iceberg/pull/1823#issuecomment-752298764","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1823","id":752298764,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjI5ODc2NA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T01:48:02Z","updated_at":"2020-12-30T01:48:02Z","author_association":"CONTRIBUTOR","body":"@rdblue sorry for the delay, I went back and forth with myself for this and took more time than expected to solidify different parts.\r\n\r\nMajor changes:\r\n\r\n1. `LockManager` interface now has all config values removed out of the method signatures. In both the current use case and the future use case for multi-table transaction, the config values are always fixed and passed from catalog properties, so it can be stored as the lock manager's internal property instead of being a dynamic parameter in a method. A `LockManagerBase` abstract class is used to initialize those common fields.\r\n2. all lock properties are put in `CatalogProperties` instead of `AwsProperties` to be shared across different implementations in the future, and avoid the need to deprecate duplicated config keys in the future.\r\n3. now lock acquisition throws an exception for failure instead of returning false, so it is easier to be used in `Tasks`.\r\n4. `LockId` object is added with an additional `ownerId` field to avoid releasing a lock from a wrong owner. The new metadata location is used as the owner ID. IllegalArgumentException is thrown if owner ID is wrong.\r\n5. `DynamoLockManager` clock skew issue is fixed, now when a lock is acquired, it starts to heartbeat in the background to extend the heartbeat timeout. Lock acquisition will wait for the heartbeat timeout and then try to overwrite an expired lock. With this feature, there is no need to set a very large time for the total commit completion time. The default values can be viewed in `CatalogProperties`, please let me know if the default values look reasonable.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752298764/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752300870","html_url":"https://github.com/apache/iceberg/pull/1704#issuecomment-752300870","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1704","id":752300870,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjMwMDg3MA==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T02:02:45Z","updated_at":"2020-12-30T02:02:45Z","author_association":"CONTRIBUTOR","body":"> Patch looks good to me, left few minor comments. Thanks.\r\n\r\nthanks for your review.I update the pr","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752300870/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752301897","html_url":"https://github.com/apache/iceberg/pull/1901#issuecomment-752301897","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1901","id":752301897,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjMwMTg5Nw==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T02:08:36Z","updated_at":"2020-12-30T02:08:36Z","author_association":"CONTRIBUTOR","body":"> Thanks, @zhangjun0x01! I updated the docs a little and merged this.\r\n\r\nthanks for your update @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752301897/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752303808","html_url":"https://github.com/apache/iceberg/issues/1995#issuecomment-752303808","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1995","id":752303808,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjMwMzgwOA==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T02:20:51Z","updated_at":"2020-12-30T02:20:51Z","author_association":"CONTRIBUTOR","body":"@kbendick I tested it use iceberg master branch , the comment is still missing,I will look up the reason later ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752303808/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752306169","html_url":"https://github.com/apache/iceberg/issues/1983#issuecomment-752306169","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1983","id":752306169,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjMwNjE2OQ==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T02:36:54Z","updated_at":"2020-12-30T02:36:54Z","author_association":"CONTRIBUTOR","body":"I look up the flink source code ,I found the comment. [here](https://github.com/apache/flink/blob/master/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/rules/logical/PushLimitIntoTableSourceScanRule.java#L64)\r\n\r\n```\r\n      // a limit can be pushed down only if it satisfies the two conditions: 1) do not have order\r\n        // by keys, 2) have limit.\r\n```\r\n\r\nI think it may be a flink bug ,I create a [flink issue](https://issues.apache.org/jira/browse/FLINK-20809) to trace this \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752306169/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752309028","html_url":"https://github.com/apache/iceberg/pull/1893#issuecomment-752309028","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1893","id":752309028,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjMwOTAyOA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T02:53:05Z","updated_at":"2020-12-30T02:53:05Z","author_association":"MEMBER","body":"@zhangjun0x01  Would you mind to resolve the conflicts ?    I will take another look at this PR if you resolve it. Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752309028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752311714","html_url":"https://github.com/apache/iceberg/pull/1893#issuecomment-752311714","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1893","id":752311714,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjMxMTcxNA==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T03:10:08Z","updated_at":"2020-12-30T03:10:08Z","author_association":"CONTRIBUTOR","body":"> @zhangjun0x01 Would you mind to resolve the conflicts ? I will take another look at this PR if you resolve it. Thanks.\r\n\r\n@openinx  I fixed the conflicts","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752311714/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752314571","html_url":"https://github.com/apache/iceberg/pull/1704#issuecomment-752314571","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1704","id":752314571,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjMxNDU3MQ==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T03:26:26Z","updated_at":"2020-12-30T03:26:26Z","author_association":"CONTRIBUTOR","body":"the ci test failed ,I check it ,  `org.apache.iceberg.spark.extensions.TestCopyOnWriteDelete` throw an exception, the PR is unrelated with spark ,is it a bug for CI ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752314571/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752322779","html_url":"https://github.com/apache/iceberg/issues/2006#issuecomment-752322779","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2006","id":752322779,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjMyMjc3OQ==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T04:23:49Z","updated_at":"2020-12-30T04:23:49Z","author_association":"CONTRIBUTOR","body":"I look up the source code , I found that flink  use the `metadata_location`  to gerarate the table schema， maybe spark do not update the schema when add a new column","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752322779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752352584","html_url":"https://github.com/apache/iceberg/pull/1704#issuecomment-752352584","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1704","id":752352584,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjM1MjU4NA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T07:02:06Z","updated_at":"2020-12-30T07:02:06Z","author_association":"MEMBER","body":"Let's trigger the CI again. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752352584/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752385628","html_url":"https://github.com/apache/iceberg/issues/2008#issuecomment-752385628","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2008","id":752385628,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjM4NTYyOA==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T09:15:24Z","updated_at":"2020-12-30T09:15:24Z","author_association":"CONTRIBUTOR","body":"check  it whether other flink programs are started on your computer, such as  started by executing the main method or `start-cluster.sh`, close them, and try to execute the Actions again. I guess it maybe some conflicts  .","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752385628/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752387006","html_url":"https://github.com/apache/iceberg/issues/2008#issuecomment-752387006","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2008","id":752387006,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjM4NzAwNg==","user":{"login":"liudi1184","id":30306636,"node_id":"MDQ6VXNlcjMwMzA2NjM2","avatar_url":"https://avatars.githubusercontent.com/u/30306636?v=4","gravatar_id":"","url":"https://api.github.com/users/liudi1184","html_url":"https://github.com/liudi1184","followers_url":"https://api.github.com/users/liudi1184/followers","following_url":"https://api.github.com/users/liudi1184/following{/other_user}","gists_url":"https://api.github.com/users/liudi1184/gists{/gist_id}","starred_url":"https://api.github.com/users/liudi1184/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liudi1184/subscriptions","organizations_url":"https://api.github.com/users/liudi1184/orgs","repos_url":"https://api.github.com/users/liudi1184/repos","events_url":"https://api.github.com/users/liudi1184/events{/privacy}","received_events_url":"https://api.github.com/users/liudi1184/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T09:19:55Z","updated_at":"2020-12-30T09:19:55Z","author_association":"NONE","body":"> check it whether other flink programs are started on your computer, such as started by executing the main method or `start-cluster.sh`, close them, and try to execute the Actions again. I guess it maybe some conflicts .\r\n\r\nMy Flink task runs in the yarn cluster","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752387006/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752388194","html_url":"https://github.com/apache/iceberg/issues/2008#issuecomment-752388194","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2008","id":752388194,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjM4ODE5NA==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T09:23:52Z","updated_at":"2020-12-30T09:23:52Z","author_association":"CONTRIBUTOR","body":"use the Actions like this;\r\n```\r\nStreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();\r\nActions.forTable(env,table)\r\n              .rewriteDataFiles()\r\n              .execute();\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752388194/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752524823","html_url":"https://github.com/apache/iceberg/pull/1704#issuecomment-752524823","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1704","id":752524823,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjUyNDgyMw==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T12:31:54Z","updated_at":"2020-12-30T12:31:54Z","author_association":"MEMBER","body":"Seems the unit test is still broken ?  @zhangjun0x01 would you mind to take a look ? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752524823/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752565531","html_url":"https://github.com/apache/iceberg/pull/1704#issuecomment-752565531","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1704","id":752565531,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjU2NTUzMQ==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T13:01:42Z","updated_at":"2020-12-30T13:01:42Z","author_association":"CONTRIBUTOR","body":"in my github acount, the ci passed  ([link](https://github.com/zhangjun0x01/iceberg/actions/runs/451845876/workflow)), and I tested  it in my IDE , it is also passed,I have encountered a similar problem before，I guess it may be related to the CI environment","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752565531/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752637602","html_url":"https://github.com/apache/iceberg/pull/1986#issuecomment-752637602","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1986","id":752637602,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjYzNzYwMg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T14:18:55Z","updated_at":"2020-12-30T14:18:55Z","author_association":"CONTRIBUTOR","body":"This PR is ready for another review round while I am working on more tests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752637602/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752679918","html_url":"https://github.com/apache/iceberg/pull/2007#issuecomment-752679918","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2007","id":752679918,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjY3OTkxOA==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T16:23:33Z","updated_at":"2020-12-30T16:23:33Z","author_association":"COLLABORATOR","body":"@rdblue @aokolnychyi can you take a look? Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752679918/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752699397","html_url":"https://github.com/apache/iceberg/pull/1972#issuecomment-752699397","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1972","id":752699397,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjY5OTM5Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T17:31:06Z","updated_at":"2020-12-30T17:31:06Z","author_association":"CONTRIBUTOR","body":"For the file issue, what is the full location that you're passing into Iceberg? Are you sure it isn't missing `file:/` to signal that it is the local FS? I think maybe that's the problem.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752699397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752742829","html_url":"https://github.com/apache/iceberg/pull/1972#issuecomment-752742829","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1972","id":752742829,"node_id":"MDEyOklzc3VlQ29tbWVudDc1Mjc0MjgyOQ==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T20:07:33Z","updated_at":"2020-12-30T20:07:33Z","author_association":"CONTRIBUTOR","body":"@rdblue That was my first thought as well. Unfortunally that's not the case:\r\n```\r\nMacBook-Pro-van-Fokko:dbt-data-ai-summit fokkodriesprong$ avro-tools tojson file:/tmp/fokko/1970-01-01T00-00-00.000+00:00-1970-01-01T00-01-00.000+00:00-00000-of-00001.avro\r\n20/12/30 21:05:11 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\r\nException in thread \"main\" java.lang.IllegalArgumentException: java.net.URISyntaxException: Relative path in absolute URI: .1970-01-01T00-00-00.000+00:00-1970-01-01T00-01-00.000+00:00-00000-of-00001.avro.crc\r\n\tat org.apache.hadoop.fs.Path.initialize(Path.java:263)\r\n\tat org.apache.hadoop.fs.Path.<init>(Path.java:221)\r\n\tat org.apache.hadoop.fs.Path.<init>(Path.java:129)\r\n\tat org.apache.hadoop.fs.ChecksumFileSystem.getChecksumFile(ChecksumFileSystem.java:94)\r\n\tat org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSInputChecker.<init>(ChecksumFileSystem.java:149)\r\n\tat org.apache.hadoop.fs.ChecksumFileSystem.open(ChecksumFileSystem.java:347)\r\n\tat org.apache.hadoop.fs.FileSystem.open(FileSystem.java:899)\r\n\tat org.apache.avro.tool.Util.openFromFS(Util.java:88)\r\n\tat org.apache.avro.tool.Util.fileOrStdin(Util.java:64)\r\n\tat org.apache.avro.tool.DataFileReadTool.run(DataFileReadTool.java:87)\r\n\tat org.apache.avro.tool.Main.run(Main.java:67)\r\n\tat org.apache.avro.tool.Main.main(Main.java:56)\r\nCaused by: java.net.URISyntaxException: Relative path in absolute URI: .1970-01-01T00-00-00.000+00:00-1970-01-01T00-01-00.000+00:00-00000-of-00001.avro.crc\r\n\tat java.net.URI.checkPath(URI.java:1823)\r\n\tat java.net.URI.<init>(URI.java:745)\r\n\tat org.apache.hadoop.fs.Path.initialize(Path.java:260)\r\n\t... 11 more\r\n```\r\nI've added a new Naming Policy to the PR that resolves the issue. Besides that, I've added an assert that catches the semicolon, to make sure that you don't write data, that you can't read using Spark/Hive/etc.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752742829/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752752371","html_url":"https://github.com/apache/iceberg/pull/1972#issuecomment-752752371","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1972","id":752752371,"node_id":"MDEyOklzc3VlQ29tbWVudDc1Mjc1MjM3MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T20:43:24Z","updated_at":"2020-12-30T20:43:24Z","author_association":"CONTRIBUTOR","body":"Here's the relevant check in URI that is failing:\r\n\r\n```java\r\n            if ((path != null)\r\n                && ((path.length() > 0) && (path.charAt(0) != '/')))\r\n                throw new URISyntaxException(s,\r\n                                             \"Relative path in absolute URI\");\r\n```\r\n\r\nLooks like the location is parsed in `Path`:\r\n```java\r\n    // parse uri scheme, if any\r\n    int colon = pathString.indexOf(':');\r\n    int slash = pathString.indexOf('/');\r\n    if ((colon != -1) &&\r\n        ((slash == -1) || (colon < slash))) {     // has a scheme\r\n      scheme = pathString.substring(0, colon);\r\n      start = colon+1;\r\n    }\r\n```\r\n\r\nString's `indexOf` returns on the first occurrence of `:`, so it looks like it must be that the `file:` is getting stripped out somehow. Can you debug and see what's actually passed?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752752371/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752850067","html_url":"https://github.com/apache/iceberg/issues/1952#issuecomment-752850067","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1952","id":752850067,"node_id":"MDEyOklzc3VlQ29tbWVudDc1Mjg1MDA2Nw==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-31T05:31:35Z","updated_at":"2020-12-31T05:31:35Z","author_association":"CONTRIBUTOR","body":"Is anybody working on this? If not, I've started working on this a bit and would be happy to take this issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752850067/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752908351","html_url":"https://github.com/apache/iceberg/pull/1704#issuecomment-752908351","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1704","id":752908351,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjkwODM1MQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-31T09:54:30Z","updated_at":"2020-12-31T09:54:30Z","author_association":"MEMBER","body":"CI is OK now,  just got this merged. Thanks @zhangjun0x01  for contributing. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752908351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752929358","html_url":"https://github.com/apache/iceberg/pull/1895#issuecomment-752929358","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1895","id":752929358,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjkyOTM1OA==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-31T11:19:39Z","updated_at":"2020-12-31T11:19:39Z","author_association":"CONTRIBUTOR","body":"I have updated to remove jax-rs and correct the license and notice. This should be ready to merge once #2016 is merged","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752929358/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752939422","html_url":"https://github.com/apache/iceberg/pull/1762#issuecomment-752939422","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1762","id":752939422,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjkzOTQyMg==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-31T12:05:19Z","updated_at":"2020-12-31T12:05:19Z","author_association":"CONTRIBUTOR","body":"@openinx I think this is  also an optimization for RewriteDataFilesAction ，do you think it is necessary to add to 0.11.0 Release milestone ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752939422/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752966363","html_url":"https://github.com/apache/iceberg/pull/2005#issuecomment-752966363","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2005","id":752966363,"node_id":"MDEyOklzc3VlQ29tbWVudDc1Mjk2NjM2Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-31T14:03:33Z","updated_at":"2020-12-31T14:03:33Z","author_association":"CONTRIBUTOR","body":"Thanks, @rdblue and @jun-he!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/752966363/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753077917","html_url":"https://github.com/apache/iceberg/pull/2016#issuecomment-753077917","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2016","id":753077917,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzA3NzkxNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-31T20:08:52Z","updated_at":"2020-12-31T20:08:52Z","author_association":"CONTRIBUTOR","body":"Thanks, @rymurr! Always good to see the build get smaller!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753077917/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753079469","html_url":"https://github.com/apache/iceberg/pull/2007#issuecomment-753079469","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2007","id":753079469,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzA3OTQ2OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-31T20:10:00Z","updated_at":"2020-12-31T20:10:00Z","author_association":"CONTRIBUTOR","body":"Thanks, @jun-he! I merged this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753079469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753187437","html_url":"https://github.com/apache/iceberg/pull/1895#issuecomment-753187437","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1895","id":753187437,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzE4NzQzNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-31T21:28:39Z","updated_at":"2020-12-31T21:28:39Z","author_association":"CONTRIBUTOR","body":"Thanks @rymurr! I merged this. Do you also want to create PRs for the Flink and Hive runtime Jars?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753187437/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753197126","html_url":"https://github.com/apache/iceberg/pull/1895#issuecomment-753197126","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1895","id":753197126,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzE5NzEyNg==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-31T21:35:38Z","updated_at":"2020-12-31T21:35:38Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue!\n\nI am running through some flink Tests and wkll raise the relevant PR soon.\n\nHive is a bit more work as the discussion around properties is relevant to how we specify custom catalogs. Hope to have something for this soon too.\n\nHappy new year!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753197126/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753210813","html_url":"https://github.com/apache/iceberg/issues/1952#issuecomment-753210813","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1952","id":753210813,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzIxMDgxMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-31T21:45:32Z","updated_at":"2020-12-31T21:45:32Z","author_association":"CONTRIBUTOR","body":"I'm not. Go for it!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753210813/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753219119","html_url":"https://github.com/apache/iceberg/pull/2017#issuecomment-753219119","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2017","id":753219119,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzIxOTExOQ==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-31T22:35:47Z","updated_at":"2020-12-31T22:40:41Z","author_association":"CONTRIBUTOR","body":"@rdblue Hmmn..in my understanding Analyzer mostly concerns itself with resolving the attributes and optimizer does the work of optimizing the logical plan which includes rewrites ? There were many rewrites that were happening in analyzer before like subquery rewrites that have been moved to optimizer because of this principle. There are other examples like rewrites that happen today for set operations like `exept/intersect`, `except all/intersect all` that happen during optimization phase.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753219119/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753285775","html_url":"https://github.com/apache/iceberg/issues/2014#issuecomment-753285775","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2014","id":753285775,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzI4NTc3NQ==","user":{"login":"masonone","id":76683334,"node_id":"MDQ6VXNlcjc2NjgzMzM0","avatar_url":"https://avatars.githubusercontent.com/u/76683334?v=4","gravatar_id":"","url":"https://api.github.com/users/masonone","html_url":"https://github.com/masonone","followers_url":"https://api.github.com/users/masonone/followers","following_url":"https://api.github.com/users/masonone/following{/other_user}","gists_url":"https://api.github.com/users/masonone/gists{/gist_id}","starred_url":"https://api.github.com/users/masonone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/masonone/subscriptions","organizations_url":"https://api.github.com/users/masonone/orgs","repos_url":"https://api.github.com/users/masonone/repos","events_url":"https://api.github.com/users/masonone/events{/privacy}","received_events_url":"https://api.github.com/users/masonone/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-01T08:29:50Z","updated_at":"2021-01-01T08:29:50Z","author_association":"NONE","body":"I have solved this problem","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753285775/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753388953","html_url":"https://github.com/apache/iceberg/pull/2018#issuecomment-753388953","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2018","id":753388953,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzM4ODk1Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-01T21:48:20Z","updated_at":"2021-01-01T21:48:20Z","author_association":"CONTRIBUTOR","body":"Fixes the Javadoc failure hit in #2011.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753388953/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753391385","html_url":"https://github.com/apache/iceberg/pull/2017#issuecomment-753391385","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2017","id":753391385,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzM5MTM4NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-01T22:02:30Z","updated_at":"2021-01-01T22:02:30Z","author_association":"CONTRIBUTOR","body":"@dilipbiswal, I agree with you and that's why I think that it makes the most sense for this to be in the analyzer. We want all of those rewrite rules to be applied by the optimizer, rather than trying to do everything in this rule.\r\n\r\nThe rewrite needs to run before subquery rewrites and optimizations are applied, but it currently runs in the operator optimization batch that is after OptimizeSubqueries, PullupCorrelatedPredicates, and others. By doing the initial rewrite in the analyzer, I think we can delegate more work to the optimizer so we can make this rewrite simple and have it optimized later.\r\n\r\nI think that the analyzer is a good place to run rewrites that produce a concrete logical plan for some action, like delete from. Another example is materialized view refresh. Ideally, we would produce a logical plan that then gets analyzed and optimized like a query that was written by hand.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753391385/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753403947","html_url":"https://github.com/apache/iceberg/pull/2018#issuecomment-753403947","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2018","id":753403947,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzQwMzk0Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-01T23:31:59Z","updated_at":"2021-01-01T23:31:59Z","author_association":"CONTRIBUTOR","body":"I'm going to merge this to fix PR testing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753403947/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753404024","html_url":"https://github.com/apache/iceberg/pull/2011#issuecomment-753404024","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2011","id":753404024,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzQwNDAyNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-01T23:32:46Z","updated_at":"2021-01-01T23:32:46Z","author_association":"CONTRIBUTOR","body":"The Javadoc failure was fixed in #2018 so I'm going to merge this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753404024/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753422447","html_url":"https://github.com/apache/iceberg/pull/2017#issuecomment-753422447","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2017","id":753422447,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzQyMjQ0Nw==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-02T03:01:48Z","updated_at":"2021-01-02T03:01:48Z","author_association":"CONTRIBUTOR","body":"@rdblue I see. I feel that we should have ability to inject the rules with a little fine grained control (we seem to lack at this point). There was a pr https://github.com/apache/spark/pull/23206 that was proposed by Sunitha a while back which unfortunately didn't take off. If we had this ability then we could run the delete rewrite by specifying the order. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753422447/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753438929","html_url":"https://github.com/apache/iceberg/issues/2019#issuecomment-753438929","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2019","id":753438929,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzQzODkyOQ==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-02T06:29:06Z","updated_at":"2021-01-02T06:29:06Z","author_association":"CONTRIBUTOR","body":"I can try to handle this while I'm working on adding the NOT_STARTS_WITH operator, though if anybody else has interest in it, please let me know and I'll let you know where I'm at and if you can take it over 👍 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753438929/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753461057","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-753461057","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":753461057,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzQ2MTA1Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-02T11:13:34Z","updated_at":"2021-01-02T11:13:34Z","author_association":"CONTRIBUTOR","body":"I’ve been thinking about grouping of data on write during copy-on-write operations (merge-on-read is a different story).\r\n\r\nRight now, we only have a sort order in the table metadata. However, we will probably add a way to represent distribution since Spark will have such a concept. I think global and local sorts don’t address all use cases. We will want to request hash distribution on write in some cases (it is cheaper than the global sort and works well if the data size per partition is small and does not have to be split into multiple tasks). This applies to inserts as well as to other operations like updates.\r\n\r\nSince there will be a concept of distribution controlled by the user, the idea of leveraging both the distribution and sort order during row-level operations seems promising to me.\r\n\r\n**DELETE**\r\n\r\nDelete is an operation that does not change the order of data so we should be fine with just file and pos metadata columns.\r\n\r\nIn master, we do a global sort by file and pos that is the most expensive option. I think we can switch to hash-partitioning by file and local sort by file and pos. Yes, a global sort would co-locate files from same partitions next to each other but I don’t think it is worth the price of the range-based shuffle. I’d be in favor of faster deletes and doing a compaction later instead of doing a global sort during deletes. The global sort won’t eliminate the need for compacting and will make deletes more expensive which would increase the chances of concurrent conflicts.\r\n\r\nIn addition, I’d offer a table property specific to copy-on-write deletes to disable the shuffle step. If people want to have even faster deletes by skipping the shuffle, we should let them do that. They will have to compact more aggressively.\r\n\r\n**UPDATE**\r\n\r\nUpdate is the first operation that potentially changes the order of data. That’s why we should take the distribution and order into account. Our intention here is to group/sort rows that did not change by file and pos to preserve their original ordering and apply the distribution and order to updated records. If the user asks for hash-based distribution during inserts, most likely he/she wants to apply it during updates too.\r\n\r\nI’d consider the following options:\r\n- If the user asks for a global sort during inserts, do a range-based shuffle by `file`, `pos`, `if (file is null) sort_col_1 else null`, `if (file is null) sort_col_2 else null` and a local sort by the same attributes.\r\n- If the user asks for hash partitioning and local sort during inserts, do a hash-based shuffle by `file`, `if (file is null) dist_col_1 else null`, `if (file is null) dist_col_2 else null`, etc and a local sort by `file`, `pos`, `if (file is null) sort_col_1 else null`, `if (file is null) sort_col_2 else null` where `file` and `pos` columns would be `null` for updated records.\r\n- If the user asks for a local sort during inserts, do a local sort.\r\n- Add a table property specific to copy-on-write updates to ignore the configured distribution.\r\n\r\n**MERGE**\r\n\r\nMerge is similar to update. We should consider new and updated records together.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753461057/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753461205","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-753461205","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":753461205,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzQ2MTIwNQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-02T11:15:15Z","updated_at":"2021-01-02T11:15:36Z","author_association":"CONTRIBUTOR","body":"I know we spend a lot of time on grouping of data on write but it has been a pain point for a number of use cases so I think it is important to get it correctly.\r\n\r\ncc @dilipbiswal @rdblue @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753461205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753555082","html_url":"https://github.com/apache/iceberg/pull/1956#issuecomment-753555082","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1956","id":753555082,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzU1NTA4Mg==","user":{"login":"tweise","id":263695,"node_id":"MDQ6VXNlcjI2MzY5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/263695?v=4","gravatar_id":"","url":"https://api.github.com/users/tweise","html_url":"https://github.com/tweise","followers_url":"https://api.github.com/users/tweise/followers","following_url":"https://api.github.com/users/tweise/following{/other_user}","gists_url":"https://api.github.com/users/tweise/gists{/gist_id}","starred_url":"https://api.github.com/users/tweise/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tweise/subscriptions","organizations_url":"https://api.github.com/users/tweise/orgs","repos_url":"https://api.github.com/users/tweise/repos","events_url":"https://api.github.com/users/tweise/events{/privacy}","received_events_url":"https://api.github.com/users/tweise/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-03T01:51:50Z","updated_at":"2021-01-03T01:51:50Z","author_association":"NONE","body":"As the Flink Iceberg connector is evolving, it would probably be better to support multiple versions of Flink. Otherwise users will lack the Iceberg connector improvements if they are not able to follow a forced Flink upgrade. Apache Beam can serve as example how this can be accomplished with a relatively small shim layer: https://github.com/apache/beam/tree/master/runners/flink\r\n ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753555082/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753566086","html_url":"https://github.com/apache/iceberg/pull/1956#issuecomment-753566086","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1956","id":753566086,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzU2NjA4Ng==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-03T04:26:11Z","updated_at":"2021-01-04T04:20:51Z","author_association":"CONTRIBUTOR","body":"@tweise yeah. a few other people also asked for the same thing in [issue-1951](https://github.com/apache/iceberg/issues/1951). \r\n\r\nI looked at the shim layer approach in `flink-connector-hive` module. It will work with the existing code (this PR). But we will need to add an Iceberg source impl based on FLIP-27 source interface in 1.12. It is unclear how it works with the shim layer. New FLIP-27 Iceberg source code will extend from interfaces/classes available only in 1.12. I am not sure how it works unless we add a flink112 module in Iceberg.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753566086/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753580792","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-753580792","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":753580792,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzU4MDc5Mg==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-03T07:42:26Z","updated_at":"2021-01-03T07:54:23Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi Regarding grouping the writes, I have made changes that groups the records based on partitioning and sort specification of the target table. I think it would be a reasonable initial implementation and we can iterate to improve ? Here are the changes. I have not tested it fully. \r\n`https://github.com/dilipbiswal/iceberg/pull/new/merge_into_copyonwrite_group_sort` \r\nPlease see the last commit.\r\n@aokolnychyi @rdblue \r\n\r\n\r\n ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753580792/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753598331","html_url":"https://github.com/apache/iceberg/pull/1972#issuecomment-753598331","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1972","id":753598331,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzU5ODMzMQ==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-03T10:45:31Z","updated_at":"2021-01-03T10:45:31Z","author_association":"CONTRIBUTOR","body":"@rdblue Happy new year! :) Looked into this, it was much more interesting (and time consuming :-) than I've anticipated. You were close. Allow me to summarize:\r\n\r\nAlso good to know, is that Beam does not output the crc files for the Avro data files, and therefore it silently ignores them when it comes to the names without the semicolons:\r\n![image](https://user-images.githubusercontent.com/1134248/103466380-f0eb4f00-4d44-11eb-86d0-eb956bb83e93.png)\r\n\r\nHowever, with the semicolons, it fails at line 145. So it is unable to open the file. It indeed takes the part before as the scheme:\r\n![image](https://user-images.githubusercontent.com/1134248/103467042-209d5580-4d4b-11eb-9b91-fe38d1851b85.png)\r\n\r\nAt `Path(Path parent, String child)` in `Path.java` the parent is `/tmp/test_streaming_crc`, and the child `.output-1970-01-01T00:00:00.000Z-1970-01-01T00:01:00.000Z-00000-of-00001.avro.crc`. Which is being split by the Path constructor. It detects the first semicolon, and will proceed if there is no slash. So this will make `.output-1970-01-01T00` the schema, and `00:00.000Z-1970-01-01T00:01:00.000Z-00000-of-00001.avro.crc` the file:\r\n\r\n![image](https://user-images.githubusercontent.com/1134248/103467581-ac65b080-4d50-11eb-8b57-ed6e74e375e0.png)\r\n\r\nHowever, Java doesn't not accept the semicolons. It boils down to this:\r\n```java\r\nimport java.net.URI;\r\n\r\n// This works:\r\nnew URI(null, null, normalizePath(null, \".00004-e82668ab-25ec-4190-864e-e4d140eb83b5.metadata.json.crc\"), null, null);\r\n\r\n// This breaks:\r\nnew URI(null, null, normalizePath(null, \".output-1970-01-01T00:00:00.000Z-1970-01-01T00:01:00.000Z-00000-of-00001.avro.crc\"), null, null);\r\n```\r\nThrowing the Relative path in absolute URI error. This is still an open issue:\r\n\r\n- https://issues.apache.org/jira/browse/HADOOP-3257\r\n- https://issues.apache.org/jira/browse/HADOOP-7945\r\n- https://issues.apache.org/jira/browse/HADOOP-12455\r\n- https://issues.apache.org/jira/browse/HADOOP-14217\r\n\r\nI'll add a note to the new naming policy, referring to this issue, and leave this as is for now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753598331/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753777804","html_url":"https://github.com/apache/iceberg/issues/2008#issuecomment-753777804","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2008","id":753777804,"node_id":"MDEyOklzc3VlQ29tbWVudDc1Mzc3NzgwNA==","user":{"login":"liudi1184","id":30306636,"node_id":"MDQ6VXNlcjMwMzA2NjM2","avatar_url":"https://avatars.githubusercontent.com/u/30306636?v=4","gravatar_id":"","url":"https://api.github.com/users/liudi1184","html_url":"https://github.com/liudi1184","followers_url":"https://api.github.com/users/liudi1184/followers","following_url":"https://api.github.com/users/liudi1184/following{/other_user}","gists_url":"https://api.github.com/users/liudi1184/gists{/gist_id}","starred_url":"https://api.github.com/users/liudi1184/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liudi1184/subscriptions","organizations_url":"https://api.github.com/users/liudi1184/orgs","repos_url":"https://api.github.com/users/liudi1184/repos","events_url":"https://api.github.com/users/liudi1184/events{/privacy}","received_events_url":"https://api.github.com/users/liudi1184/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T06:09:11Z","updated_at":"2021-01-04T06:09:11Z","author_association":"NONE","body":"> \r\n> \r\n> use the Actions like this;\r\n> \r\n> ```\r\n> StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();\r\n> Actions.forTable(env,table)\r\n>               .rewriteDataFiles()\r\n>               .execute();\r\n> ```\r\n\r\nI tried to use it like this, but the following exception occurred\r\n\r\n\r\n`Caused by: java.io.IOException: Failed to deserialize an element from the source. If you are using user-defined serialization (Value and Writable types), check the serialization functions.\r\nSerializer is org.apache.flink.api.java.typeutils.runtime.kryo.KryoSerializer@1af6329f\r\n        at org.apache.flink.streaming.api.functions.source.FromElementsFunction.run(FromElementsFunction.java:158) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at org.apache.flink.streaming.api.operators.StreamSource.run(StreamSource.java:100) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at org.apache.flink.streaming.api.operators.StreamSource.run(StreamSource.java:63) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at org.apache.flink.streaming.runtime.tasks.SourceStreamTask$LegacySourceFunctionThread.run(SourceStreamTask.java:201) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\nCaused by: com.esotericsoftware.kryo.KryoException: java.lang.UnsupportedOperationException\r\nSerialization trace:\r\ncolumnSizes (org.apache.iceberg.GenericDeleteFile)\r\ndeletes (org.apache.iceberg.BaseFileScanTask)\r\nfileScanTask (org.apache.iceberg.BaseFileScanTask$SplitScanTask)\r\ntasks (org.apache.iceberg.BaseCombinedScanTask)\r\n        at com.esotericsoftware.kryo.serializers.ObjectField.read(ObjectField.java:125) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at com.esotericsoftware.kryo.serializers.FieldSerializer.read(FieldSerializer.java:528) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at com.esotericsoftware.kryo.Kryo.readObject(Kryo.java:679) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at com.esotericsoftware.kryo.serializers.DefaultArraySerializers$ObjectArraySerializer.read(DefaultArraySerializers.java:378) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at com.esotericsoftware.kryo.serializers.DefaultArraySerializers$ObjectArraySerializer.read(DefaultArraySerializers.java:289) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at com.esotericsoftware.kryo.Kryo.readObject(Kryo.java:679) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at com.esotericsoftware.kryo.serializers.ObjectField.read(ObjectField.java:106) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at com.esotericsoftware.kryo.serializers.FieldSerializer.read(FieldSerializer.java:528) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at com.esotericsoftware.kryo.Kryo.readObject(Kryo.java:679) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at com.esotericsoftware.kryo.serializers.ObjectField.read(ObjectField.java:106) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at com.esotericsoftware.kryo.serializers.FieldSerializer.read(FieldSerializer.java:528) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at com.esotericsoftware.kryo.Kryo.readObject(Kryo.java:679) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at com.esotericsoftware.kryo.serializers.DefaultArraySerializers$ObjectArraySerializer.read(DefaultArraySerializers.java:378) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at com.esotericsoftware.kryo.serializers.DefaultArraySerializers$ObjectArraySerializer.read(DefaultArraySerializers.java:289) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at com.esotericsoftware.kryo.Kryo.readObject(Kryo.java:679) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at com.esotericsoftware.kryo.serializers.ObjectField.read(ObjectField.java:106) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at com.esotericsoftware.kryo.serializers.FieldSerializer.read(FieldSerializer.java:528) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at com.esotericsoftware.kryo.Kryo.readClassAndObject(Kryo.java:761) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at org.apache.flink.api.java.typeutils.runtime.kryo.KryoSerializer.deserialize(KryoSerializer.java:346) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at org.apache.flink.streaming.api.functions.source.FromElementsFunction.run(FromElementsFunction.java:155) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at org.apache.flink.streaming.api.operators.StreamSource.run(StreamSource.java:100) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at org.apache.flink.streaming.api.operators.StreamSource.run(StreamSource.java:63) ~[flink-dist_2.11-1.11.1.jar:1.11.1]\r\n        at org.apache.flink.streaming.runtime.tasks.SourceStreamTask$LegacySourceFunctionThread.run(SourceStreamTask.java:201) ~[flink-dist_2.11-1.11.1.jar:1.11.1]`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753777804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753826282","html_url":"https://github.com/apache/iceberg/issues/2008#issuecomment-753826282","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2008","id":753826282,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzgyNjI4Mg==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T08:12:12Z","updated_at":"2021-01-04T08:12:12Z","author_association":"CONTRIBUTOR","body":"there are some data cannot be serialized, please check  whether it meets the requirements of flink serialization\r\n\r\nhttps://ci.apache.org/projects/flink/flink-docs-stable/dev/types_serialization.html","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753826282/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753836501","html_url":"https://github.com/apache/iceberg/pull/2021#issuecomment-753836501","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2021","id":753836501,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzgzNjUwMQ==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T08:32:14Z","updated_at":"2021-01-04T08:32:14Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi @rdblue \r\nKindly review the top commit which has the cardinality check implementation.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753836501/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753839534","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-753839534","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":753839534,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzgzOTUzNA==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T08:38:35Z","updated_at":"2021-01-04T16:24:12Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi @rdblue \r\nI have cleaned up the PR to address the comments. This is the base PR that has core logic for MERGE INTO processing. I have opened two separate PRs 1) Cardinality check 2) Grouping and sorting rows before write. We can discuss any issues with the implementation of (1) or (2) separately in those PRs. Hope it is okay ?\r\n\r\nHere are the two PRs.\r\nhttps://github.com/apache/iceberg/pull/2021\r\nhttps://github.com/apache/iceberg/pull/2022\r\n\r\nThanks\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753839534/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753842869","html_url":"https://github.com/apache/iceberg/pull/2022#issuecomment-753842869","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2022","id":753842869,"node_id":"MDEyOklzc3VlQ29tbWVudDc1Mzg0Mjg2OQ==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T08:45:39Z","updated_at":"2021-01-04T08:45:39Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi @rdblue\r\nKindly review the top commit which has the group + sort implementation.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753842869/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753886908","html_url":"https://github.com/apache/iceberg/issues/2023#issuecomment-753886908","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2023","id":753886908,"node_id":"MDEyOklzc3VlQ29tbWVudDc1Mzg4NjkwOA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T10:14:44Z","updated_at":"2021-01-04T10:14:44Z","author_association":"MEMBER","body":"What do you mean about `iceberg's metadata is not updated`  ?  You mean the iceberg did not commit the txn successfully then you can read the latest data files ? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753886908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753906176","html_url":"https://github.com/apache/iceberg/pull/2017#issuecomment-753906176","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2017","id":753906176,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzkwNjE3Ng==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T10:55:12Z","updated_at":"2021-01-04T10:55:12Z","author_association":"CONTRIBUTOR","body":"I have mixed feelings about this direction.\r\n\r\nOn one hand, it is great to rewrite this early in the analyzer and leave the optimizer untouched. On the other hand, it prohibits optimizations on delete/update/merge nodes and makes certain rewrites more complicated.\r\n\r\nTo give an example where having merge nodes in the optimizer may be helpful.\r\n\r\nIf we rewrite the following operation in the analyzer, we will have to use a full outer join.\r\n\r\n```\r\nMERGE target t USING source s\r\nON t.id = s.id\r\nWHEN MATCHED AND exp_equivalent_to_false\r\n  UPDATE SET …\r\nWHEN NOT MATCHED\r\n  THEN INSERT\r\n```\r\n\r\nHowever, the optimizer can detect that our UPDATE condition always evaluates to false, so it can simplify the plan:\r\n\r\n```\r\nMERGE target t USING source s\r\nON t.id = s.id\r\nWHEN NOT MATCHED\r\n  THEN INSERT\r\n```\r\n\r\nThe optimized merge operation can be executed using a left anti join instead of a full outer join. Similarly, if we can get rid of the NOT MATCHED clause, we can use a right outer join instead of a full outer join. There may be more cases like this that we don't know yet.\r\n\r\nAlso, there are a lot of rewrites that happen in the optimizer like @dilipbiswal mentioned so the current approach isn't that bad in my view. In addition, row-level ops are a bit different compared to the refresh of materialized views which is replaced with INSERTs. There is a clear translation for refresh statements and it does not require any optimization. Update/delete/merge commands are more complicated to me and I'll be fine addressing them differently.\r\n\r\nIf we rewrite the plans after operator optimizations as we planned earlier, we miss these rules:\r\n- `PullupCorrelatedPredicates` (fixed in Spark 3.1 to cover delete/update/merge)\r\n- `OptimizeSubqueries` (works fine now as it runs on `SubqueryExpression` which is a child of the row-level plans)\r\n- Replacement of certain expressions with equivalent ones\r\n- Operator optimization rules (we match the behavior for subqueries)\r\n\r\nI think it is fine to run the rewrite after those rules.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753906176/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753918211","html_url":"https://github.com/apache/iceberg/issues/2023#issuecomment-753918211","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2023","id":753918211,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzkxODIxMQ==","user":{"login":"sunzheng1002","id":20663567,"node_id":"MDQ6VXNlcjIwNjYzNTY3","avatar_url":"https://avatars.githubusercontent.com/u/20663567?v=4","gravatar_id":"","url":"https://api.github.com/users/sunzheng1002","html_url":"https://github.com/sunzheng1002","followers_url":"https://api.github.com/users/sunzheng1002/followers","following_url":"https://api.github.com/users/sunzheng1002/following{/other_user}","gists_url":"https://api.github.com/users/sunzheng1002/gists{/gist_id}","starred_url":"https://api.github.com/users/sunzheng1002/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunzheng1002/subscriptions","organizations_url":"https://api.github.com/users/sunzheng1002/orgs","repos_url":"https://api.github.com/users/sunzheng1002/repos","events_url":"https://api.github.com/users/sunzheng1002/events{/privacy}","received_events_url":"https://api.github.com/users/sunzheng1002/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T11:20:12Z","updated_at":"2021-01-04T11:20:12Z","author_association":"NONE","body":"> What do you mean about `iceberg's metadata is not updated` ? You mean the iceberg did not commit the txn successfully then you can read the latest data files ?\r\n\r\nYes, the Iceberg txn is not submitted properly and I can't read the new data.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753918211/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753921549","html_url":"https://github.com/apache/iceberg/pull/2017#issuecomment-753921549","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2017","id":753921549,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzkyMTU0OQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T11:27:34Z","updated_at":"2021-01-04T11:34:19Z","author_association":"CONTRIBUTOR","body":"That being said, my opinion isn't final and I do support the intention of reducing the scope of the rewrite rule (e.g. moving the pushdown logic).\r\n\r\nI also like the concept of `MergeTable`. Should we also consider using it in the optimizer?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753921549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753966153","html_url":"https://github.com/apache/iceberg/issues/1992#issuecomment-753966153","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1992","id":753966153,"node_id":"MDEyOklzc3VlQ29tbWVudDc1Mzk2NjE1Mw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T13:10:48Z","updated_at":"2021-01-04T13:10:48Z","author_association":"CONTRIBUTOR","body":"Hi @bowenli86,\r\n\r\nWas iceberg-hive-runtime.jar what you were looking for?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753966153/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753970623","html_url":"https://github.com/apache/iceberg/issues/1994#issuecomment-753970623","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1994","id":753970623,"node_id":"MDEyOklzc3VlQ29tbWVudDc1Mzk3MDYyMw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T13:20:04Z","updated_at":"2021-01-04T13:20:18Z","author_association":"CONTRIBUTOR","body":"Writing checks on exception message strings seems like bad practice to me.\r\n\r\nMaybe liveliness check for the connections would be a better solution, where we could check whether the HMS is active or not, by calling a specific low cost method which is not plagued with the exception wrapping you have found above?\r\n\r\nWhat do you think @Jecarm?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/753970623/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754028925","html_url":"https://github.com/apache/iceberg/pull/1920#issuecomment-754028925","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1920","id":754028925,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDAyODkyNQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T15:06:10Z","updated_at":"2021-01-04T15:06:10Z","author_association":"CONTRIBUTOR","body":"> This looks good to me. One last thing to consider is whether we should do this in Hive or whether we should do this through serialization. If we do it in Hive, then we have code that touches `BaseTable` and does substitution. That's okay, but not great.\r\n\r\nThanks for the review @rdblue!\r\nHappy new year!\r\n\r\nWent for the Serialization solution - seems like the most generic way to solve this. Thanks for the suggestion!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754028925/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754085469","html_url":"https://github.com/apache/iceberg/issues/280#issuecomment-754085469","issue_url":"https://api.github.com/repos/apache/iceberg/issues/280","id":754085469,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDA4NTQ2OQ==","user":{"login":"massdosage","id":29457,"node_id":"MDQ6VXNlcjI5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/29457?v=4","gravatar_id":"","url":"https://api.github.com/users/massdosage","html_url":"https://github.com/massdosage","followers_url":"https://api.github.com/users/massdosage/followers","following_url":"https://api.github.com/users/massdosage/following{/other_user}","gists_url":"https://api.github.com/users/massdosage/gists{/gist_id}","starred_url":"https://api.github.com/users/massdosage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massdosage/subscriptions","organizations_url":"https://api.github.com/users/massdosage/orgs","repos_url":"https://api.github.com/users/massdosage/repos","events_url":"https://api.github.com/users/massdosage/events{/privacy}","received_events_url":"https://api.github.com/users/massdosage/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T16:46:32Z","updated_at":"2021-01-04T16:46:32Z","author_association":"CONTRIBUTOR","body":"Is this done now? Just curious as it mentions closed and merged PRs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754085469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754085532","html_url":"https://github.com/apache/iceberg/issues/281#issuecomment-754085532","issue_url":"https://api.github.com/repos/apache/iceberg/issues/281","id":754085532,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDA4NTUzMg==","user":{"login":"massdosage","id":29457,"node_id":"MDQ6VXNlcjI5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/29457?v=4","gravatar_id":"","url":"https://api.github.com/users/massdosage","html_url":"https://github.com/massdosage","followers_url":"https://api.github.com/users/massdosage/followers","following_url":"https://api.github.com/users/massdosage/following{/other_user}","gists_url":"https://api.github.com/users/massdosage/gists{/gist_id}","starred_url":"https://api.github.com/users/massdosage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massdosage/subscriptions","organizations_url":"https://api.github.com/users/massdosage/orgs","repos_url":"https://api.github.com/users/massdosage/repos","events_url":"https://api.github.com/users/massdosage/events{/privacy}","received_events_url":"https://api.github.com/users/massdosage/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T16:46:39Z","updated_at":"2021-01-04T16:46:39Z","author_association":"CONTRIBUTOR","body":"Is this done now? Just curious as it mentions closed and merged PRs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754085532/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754101600","html_url":"https://github.com/apache/iceberg/issues/280#issuecomment-754101600","issue_url":"https://api.github.com/repos/apache/iceberg/issues/280","id":754101600,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDEwMTYwMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T17:15:53Z","updated_at":"2021-01-04T17:15:53Z","author_association":"CONTRIBUTOR","body":"Yes, it is done. I'll close this. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754101600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754101875","html_url":"https://github.com/apache/iceberg/issues/281#issuecomment-754101875","issue_url":"https://api.github.com/repos/apache/iceberg/issues/281","id":754101875,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDEwMTg3NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T17:16:23Z","updated_at":"2021-01-08T00:48:48Z","author_association":"CONTRIBUTOR","body":"Yes. I'll close it. Thanks!\r\n\r\nThe partition evolution API was added in #1919 and #1942. Spark DDL commands were added in #1948:\r\n\r\n```sql\r\nALTER TABLE db.table ADD PARTITION FIELD category;\r\nALTER TABLE db.table ADD PARTITION FIELD hours(event_ts) AS event_hour;\r\nALTER TABLE db.table DROP PARTITION FIELD bucket(16, id);\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754101875/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754112570","html_url":"https://github.com/apache/iceberg/pull/2017#issuecomment-754112570","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2017","id":754112570,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDExMjU3MA==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T17:37:15Z","updated_at":"2021-01-04T17:37:15Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi \r\nNice explanation about `early rewrite` in Analyzer. One other thing i worry about is, sometimes introduction of newer plan nodes may come in the way of existing optimization rules like pushing down filters or collapsing projects. Having said this, we may be okay in this case of `delete` in the present form. But we may have to worry about the future as the rule evolves. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754112570/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754148565","html_url":"https://github.com/apache/iceberg/pull/2021#issuecomment-754148565","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2021","id":754148565,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDE0ODU2NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T18:48:13Z","updated_at":"2021-01-04T19:54:53Z","author_association":"CONTRIBUTOR","body":"Sorry I didn't look into this more thoroughly before now, but I think that there is a better way to implement the cardinality check that doesn't require an inner join.\r\n\r\nThe (2003) SQL spec in Part 2, section 14.9 says:\r\n\r\n> Let Q be the result of evaluating [the USING clause]\r\n> If <merge when matched clause> is specified, then:\r\n> For each row R1 of T:\r\n> ...\r\n> Let M be the number of matching rows in Q for R1.\r\n> If M is greater than 1 (one), then an exception condition is raised: cardinality violation.\r\n\r\nI think that means the cardinality check is done for each row of the target table. If two rows from the target table have the same \"key\" from the `ON` condition, that's okay and they are processed separately. The cardinality violation applies when there are two rows from the result of the `USING` clause for any row.\r\n\r\nThat aligns with [a comment from Eugene Koifman](https://community.cloudera.com/t5/Support-Questions/Hive-Merge-command-throwing-error-message/td-p/228500) (from the Hive implementation):\r\n\r\n> Logically what this means is that the query is asking the system to update 1 existing row in target in 2 (or more) different ways.\r\n\r\nAs a result, I think that there is an easier way to implement this check. Instead of running an additional inner join, the check should run as the first thing in [`processRow`](https://github.com/apache/iceberg/pull/2022/files#diff-deb1276df77b1ac20d203d4607231c593cfeac1a3c3771d174bd04fc1afd773aR92):\r\n1. Track each target table row using an ID. We can use `_file` and `_pos` for this.\r\n2. In `processRow`, keep track of the last row's ID\r\n3. If the last row's ID matches the current row's ID, throw an exception for the cardinality check\r\n4. If the current row's ID is different, then replace the last row ID with it\r\n\r\nThat works because the join will always produce the matching rows together as a group.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754148565/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754184376","html_url":"https://github.com/apache/iceberg/pull/2020#issuecomment-754184376","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2020","id":754184376,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDE4NDM3Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T19:58:04Z","updated_at":"2021-01-04T19:58:04Z","author_association":"CONTRIBUTOR","body":"Thanks, @JitseDriesprong!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754184376/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754187134","html_url":"https://github.com/apache/iceberg/pull/2021#issuecomment-754187134","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2021","id":754187134,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDE4NzEzNA==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T20:03:25Z","updated_at":"2021-01-04T20:04:02Z","author_association":"CONTRIBUTOR","body":"@rdblue Thanks a lot. I am just thinking if \r\n```\r\nThat works because the join will always produce the matching rows together as a group.\r\n```\r\nis true in all cases. @aokolnychyi What do you think ?\r\n\r\nRyan, one other thing is , we are not introducing an additional join for the cardinality check in this implementation. We are doing the same join as we were doing before but just accumulating the files using an accumulator.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754187134/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754203003","html_url":"https://github.com/apache/iceberg/issues/2026#issuecomment-754203003","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2026","id":754203003,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDIwMzAwMw==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T20:34:14Z","updated_at":"2021-01-04T20:34:14Z","author_association":"CONTRIBUTOR","body":"I'll look more closely at the spec / website docs and update accordingly once I've made more progress on that task. If anybody feels like documenting them before that, please feel free to take this issue. Otherwise, I will handle it after the above issue is complete at my earliest possible time.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754203003/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754204049","html_url":"https://github.com/apache/iceberg/issues/2019#issuecomment-754204049","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2019","id":754204049,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDIwNDA0OQ==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T20:36:18Z","updated_at":"2021-01-04T20:36:29Z","author_association":"CONTRIBUTOR","body":"This issue was found while I was working on a PR for this issue, supporting not starts_with, and it should be linked. https://github.com/apache/iceberg/issues/1952","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754204049/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754229413","html_url":"https://github.com/apache/iceberg/pull/2021#issuecomment-754229413","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2021","id":754229413,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDIyOTQxMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T21:27:05Z","updated_at":"2021-01-04T21:27:05Z","author_association":"CONTRIBUTOR","body":"I think it is true in all cases because all of the matches for a target row must be produced when that target row is considered.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754229413/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754277810","html_url":"https://github.com/apache/iceberg/pull/2017#issuecomment-754277810","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2017","id":754277810,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDI3NzgxMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T23:11:21Z","updated_at":"2021-01-04T23:11:21Z","author_association":"CONTRIBUTOR","body":"> It prohibits optimizations on delete/update/merge nodes and makes certain rewrites more complicated.\r\n\r\nI don't agree that those optimizations are prohibited. I think they are still possible, it would just make the implementation different. Your example would initially be converted to a full join producing rows for a merge node. But we could write a separate optimizer rule that matches a merge with a full join and checks whether the join type can be changed. Instead of doing the entire task in a single rewrite rule, we would have a rule to rewrite to the full join in the analyzer, then one to prune cases with `false` conditions, and then one to rewrite the join.\r\n\r\nI think that decomposing this into smaller independent rules is a good thing.\r\n\r\n> If we rewrite the plans after operator optimizations as we planned earlier, we miss ...\r\n\r\nWe would also miss analyzer rules. In our Spark build, we have support for metadata columns and that's how we project `_file` and `_pos`. The problem is that the analyzer rule to add metadata columns to the logical plan runs in the analyzer, so we have to add them to the projection in the optimizer rewrite rule. I think that there are quite a few tasks and optimizations that have to be done in this rule because it needs to run late.\r\n\r\nWe're accumulating quite a list of rules that won't run on these plans by doing the rewrite in the optimizer. And, we lose more depending on what batch we use in the optimizer. If the rewrite is done in operator optimization, then there's no guarantee that expressions are fully optimized before this rule -- that could be a problem for the expr-equivalent-to-false example. On the other hand, expressions produced by the rule would get optimized, unless we move it after operator optimization. If we do that, then the `Not(cond)` that we introduce might be `Not(Not(...))` or other cases that would be simplified by the optimizer, and columns in the dynamic filter plan are not pruned.\r\n\r\nI think overall I'm leaning toward rewriting in the analyzer. I think we can still build the same optimizations, just in different ways. That said, we probably don't need to really consider this until after the next release. Getting something working is the first step. Then we can talk about refactoring into separate rules.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754277810/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754280709","html_url":"https://github.com/apache/iceberg/pull/2012#issuecomment-754280709","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2012","id":754280709,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDI4MDcwOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T23:19:58Z","updated_at":"2021-01-04T23:19:58Z","author_association":"CONTRIBUTOR","body":"Thanks, @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754280709/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754305700","html_url":"https://github.com/apache/iceberg/pull/2024#issuecomment-754305700","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2024","id":754305700,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDMwNTcwMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T00:21:37Z","updated_at":"2021-01-05T00:21:37Z","author_association":"CONTRIBUTOR","body":"I don't think that these changes are correct. The method that waits until after the last commit is intended to ensure that the timestamps work with the test assumptions.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754305700/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754306421","html_url":"https://github.com/apache/iceberg/pull/1757#issuecomment-754306421","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1757","id":754306421,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDMwNjQyMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T00:23:29Z","updated_at":"2021-01-05T00:23:29Z","author_association":"CONTRIBUTOR","body":"I ran into this issue over the break and found that on my local machine, the storage handler tests were taking 11 minutes to run and running for both Hive 2 and Hive 3. It would be great to get this refactor done and not run so many expensive cases!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754306421/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754332257","html_url":"https://github.com/apache/iceberg/pull/2024#issuecomment-754332257","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2024","id":754332257,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDMzMjI1Nw==","user":{"login":"zhangdove","id":25578853,"node_id":"MDQ6VXNlcjI1NTc4ODUz","avatar_url":"https://avatars.githubusercontent.com/u/25578853?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangdove","html_url":"https://github.com/zhangdove","followers_url":"https://api.github.com/users/zhangdove/followers","following_url":"https://api.github.com/users/zhangdove/following{/other_user}","gists_url":"https://api.github.com/users/zhangdove/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangdove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangdove/subscriptions","organizations_url":"https://api.github.com/users/zhangdove/orgs","repos_url":"https://api.github.com/users/zhangdove/repos","events_url":"https://api.github.com/users/zhangdove/events{/privacy}","received_events_url":"https://api.github.com/users/zhangdove/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T01:47:22Z","updated_at":"2021-01-05T01:47:22Z","author_association":"CONTRIBUTOR","body":"Thank you for your advice. I also noticed that the #1380  is to solve the problem of jet lag.\r\nClose it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754332257/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754340073","html_url":"https://github.com/apache/iceberg/pull/2021#issuecomment-754340073","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2021","id":754340073,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDM0MDA3Mw==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T02:13:36Z","updated_at":"2021-01-05T02:13:36Z","author_association":"CONTRIBUTOR","body":"Had a offline discussion with Ryan. Since we can not guarantee rids to be emitted in sequence without some additional work (yet to be determined), we will take a conservative approach in the first pass.\r\n\r\ncc @aokolnychyi @rdblue \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754340073/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754438273","html_url":"https://github.com/apache/iceberg/issues/2026#issuecomment-754438273","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2026","id":754438273,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDQzODI3Mw==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T06:47:43Z","updated_at":"2021-01-05T06:47:43Z","author_association":"CONTRIBUTOR","body":"I actually found plenty of documentation for this. I don't think it needs any more and will close this issue, we can reopen if we think there's a need for further documentation. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754438273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754439031","html_url":"https://github.com/apache/iceberg/issues/2026#issuecomment-754439031","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2026","id":754439031,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDQzOTAzMQ==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T06:49:23Z","updated_at":"2021-01-05T06:49:23Z","author_association":"CONTRIBUTOR","body":"I found the values documented here, https://iceberg.apache.org/configuration/#write-properties, but it might be a good idea to include more of a discussion in the format section about what these various metric configurations accomplish, given that metrics are discussed there a good amount. I'll close this issue for now though 👍 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754439031/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754483164","html_url":"https://github.com/apache/iceberg/pull/1141#issuecomment-754483164","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1141","id":754483164,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDQ4MzE2NA==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T08:21:11Z","updated_at":"2021-01-05T08:21:11Z","author_association":"COLLABORATOR","body":"@rdblue  thanks for the comments. I updated the document accordingly. Can you take another look? Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754483164/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754533819","html_url":"https://github.com/apache/iceberg/pull/2017#issuecomment-754533819","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2017","id":754533819,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDUzMzgxOQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T09:58:31Z","updated_at":"2021-01-05T09:58:31Z","author_association":"CONTRIBUTOR","body":"> I don't agree that those optimizations are prohibited. I think they are still possible, it would just make the implementation different.\r\n\r\nBy prohibited I mean that we won't have separate delete/update/merge nodes after the rewrite (as far as I understand). Therefore, equivalent optimizations will be harder. For example, a rule to drop a branch on `MergeIntoTable` would be trivial if we run it before the rewrite. Doing the same optimization after the rewrite is possible but would be harder.\r\n\r\n> The problem is that the analyzer rule to add metadata columns to the logical plan runs in the analyzer\r\n\r\nThis adds another perspective. We could make it work with row-level nodes too if we had a concept of `_row_id` that a data source would return.\r\n\r\n> And, we lose more depending on what batch we use in the optimizer.\r\n\r\nI think the initial plan was to do this after operator optimization to make sure conditions are optimal. However, I agree that we won't run operator optimization batch (and potentially some other optimizer rules) after the rewrite, which is probably the biggest concern to me in rewriting in the optimizer.\r\n\r\nOverall, I believe we should think through how the rewrite in the analyzer will work, how to avoid job planning twice, do extra optimization later, etc. If we can come up with solutions to those problems, I think it will be safer. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754533819/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754542454","html_url":"https://github.com/apache/iceberg/pull/1793#issuecomment-754542454","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1793","id":754542454,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDU0MjQ1NA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T10:13:29Z","updated_at":"2021-01-05T10:13:29Z","author_association":"MEMBER","body":"@rdblue @stevenzwu Would you mind to take another look ? I've updated this patch, Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754542454/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754568284","html_url":"https://github.com/apache/iceberg/pull/1986#issuecomment-754568284","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1986","id":754568284,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDU2ODI4NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T11:05:28Z","updated_at":"2021-01-05T11:05:28Z","author_association":"CONTRIBUTOR","body":"I've pushed more changes and I feel like this PR is converging. We still a few open questions but I feel like we can address them in one more review round.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754568284/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754619595","html_url":"https://github.com/apache/iceberg/issues/1258#issuecomment-754619595","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1258","id":754619595,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDYxOTU5NQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T12:57:20Z","updated_at":"2021-01-05T12:57:20Z","author_association":"CONTRIBUTOR","body":"Done in PR #1525","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754619595/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754620092","html_url":"https://github.com/apache/iceberg/issues/1590#issuecomment-754620092","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1590","id":754620092,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDYyMDA5Mg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T12:58:12Z","updated_at":"2021-01-05T12:58:12Z","author_association":"CONTRIBUTOR","body":"This was done in PR #1906.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754620092/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754620422","html_url":"https://github.com/apache/iceberg/issues/1591#issuecomment-754620422","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1591","id":754620422,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDYyMDQyMg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T12:58:52Z","updated_at":"2021-01-05T12:58:52Z","author_association":"CONTRIBUTOR","body":"This was done in PR #1906.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754620422/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754639938","html_url":"https://github.com/apache/iceberg/pull/2029#issuecomment-754639938","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2029","id":754639938,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDYzOTkzOA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T13:35:20Z","updated_at":"2021-01-05T13:35:20Z","author_association":"CONTRIBUTOR","body":"@rdblue: If you have some time could you please take a look? I have fixed the minor issues you have mentioned befor merging #1917.\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754639938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754654645","html_url":"https://github.com/apache/iceberg/issues/1889#issuecomment-754654645","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1889","id":754654645,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDY1NDY0NQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T14:03:07Z","updated_at":"2021-01-05T14:03:07Z","author_association":"CONTRIBUTOR","body":"Yep, exactly, @holdenk. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754654645/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754671794","html_url":"https://github.com/apache/iceberg/issues/1992#issuecomment-754671794","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1992","id":754671794,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDY3MTc5NA==","user":{"login":"yutaoChina","id":9714395,"node_id":"MDQ6VXNlcjk3MTQzOTU=","avatar_url":"https://avatars.githubusercontent.com/u/9714395?v=4","gravatar_id":"","url":"https://api.github.com/users/yutaoChina","html_url":"https://github.com/yutaoChina","followers_url":"https://api.github.com/users/yutaoChina/followers","following_url":"https://api.github.com/users/yutaoChina/following{/other_user}","gists_url":"https://api.github.com/users/yutaoChina/gists{/gist_id}","starred_url":"https://api.github.com/users/yutaoChina/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yutaoChina/subscriptions","organizations_url":"https://api.github.com/users/yutaoChina/orgs","repos_url":"https://api.github.com/users/yutaoChina/repos","events_url":"https://api.github.com/users/yutaoChina/events{/privacy}","received_events_url":"https://api.github.com/users/yutaoChina/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T14:33:38Z","updated_at":"2021-01-05T14:33:38Z","author_association":"NONE","body":"iceberg will support hive1.x","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754671794/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754693079","html_url":"https://github.com/apache/iceberg/pull/2021#issuecomment-754693079","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2021","id":754693079,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDY5MzA3OQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T15:06:41Z","updated_at":"2021-01-05T15:06:41Z","author_association":"CONTRIBUTOR","body":"Thanks for the PR, @dilipbiswal.\r\n\r\nSorry, I got distracted by other things. I'll review this first thing in the morning tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754693079/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754777699","html_url":"https://github.com/apache/iceberg/pull/2029#issuecomment-754777699","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2029","id":754777699,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDc3NzY5OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T17:22:52Z","updated_at":"2021-01-05T17:22:52Z","author_association":"CONTRIBUTOR","body":"Thanks, @pvary!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754777699/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754798065","html_url":"https://github.com/apache/iceberg/pull/1956#issuecomment-754798065","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1956","id":754798065,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDc5ODA2NQ==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T17:57:41Z","updated_at":"2021-01-05T18:04:09Z","author_association":"CONTRIBUTOR","body":"Right now, CI test failed with `:iceberg-spark3-extensions:test` for java 8. \r\n```\r\norg.apache.iceberg.spark.extensions.TestCopyOnWriteDelete > testDeleteWithNotExistsSubquery[catalogName = spark_catalog, implementation = org.apache.iceberg.spark.SparkSessionCatalog, config = {type=hive, default-namespace=default, clients=1, parquet-enabled=false, cache-enabled=false}, format = avro, vectorized = false] FAILED\r\n    java.lang.RuntimeException: Failed to get table info from metastore default.table\r\n\r\n        Caused by:\r\n        org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n\r\n            Caused by:\r\n            java.net.SocketException: Broken pipe (Write failed)\r\n```\r\n\r\nI tried the same branch against the master branch in my own fork: https://github.com/stevenzwu/iceberg/pull/11. It also failed with connection in `:iceberg-hive3:compileJava`. I suspect maybe the build is taking a little longer and CI system aborted the build?\r\n```\r\nExecution failed for task ':iceberg-hive3:compileJava'.\r\n> Could not resolve all files for configuration ':iceberg-hive3:compileClasspath'.\r\n   > Could not resolve com.fasterxml.jackson.jaxrs:jackson-jaxrs-json-provider:2.7.8.\r\n     Required by:\r\n         project :iceberg-hive3 > org.apache.hive:hive-exec:3.1.2 > org.apache.hadoop:hadoop-yarn-registry:3.1.0 > org.apache.hadoop:hadoop-yarn-common:3.1.0\r\n      > Could not resolve com.fasterxml.jackson.jaxrs:jackson-jaxrs-json-provider:2.7.8.\r\n         > Could not parse POM https://repo.maven.apache.org/maven2/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.7.8/jackson-jaxrs-json-provider-2.7.8.pom\r\n            > Could not resolve com.fasterxml.jackson.jaxrs:jackson-jaxrs-providers:2.7.8.\r\n               > Could not resolve com.fasterxml.jackson.jaxrs:jackson-jaxrs-providers:2.7.8.\r\n                  > Could not get resource 'https://repo.maven.apache.org/maven2/com/fasterxml/jackson/jaxrs/jackson-jaxrs-providers/2.7.8/jackson-jaxrs-providers-2.7.8.pom'.\r\n                     > Could not GET 'https://repo.maven.apache.org/maven2/com/fasterxml/jackson/jaxrs/jackson-jaxrs-providers/2.7.8/jackson-jaxrs-providers-2.7.8.pom'.\r\n                        > Connection reset\r\n```\r\n\r\nI have the same code in a diff branch. that PR is fine with CI build: https://github.com/stevenzwu/iceberg/pull/8.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754798065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754814225","html_url":"https://github.com/apache/iceberg/pull/1979#issuecomment-754814225","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1979","id":754814225,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDgxNDIyNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T18:24:04Z","updated_at":"2021-01-05T18:24:04Z","author_association":"CONTRIBUTOR","body":"I'm still concerned about adding this without a better check. Adding a flag to turn all `IOException` instances into a `false` response seems really brittle. Can we inspect the exception message? Is there a cause that is available? Maybe we can at least check the package of the exception instance?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754814225/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754823123","html_url":"https://github.com/apache/iceberg/pull/2025#issuecomment-754823123","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2025","id":754823123,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDgyMzEyMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T18:40:03Z","updated_at":"2021-01-05T18:40:03Z","author_association":"CONTRIBUTOR","body":"Thanks for solving this, @marton-bod and @pvary!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/754823123/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]