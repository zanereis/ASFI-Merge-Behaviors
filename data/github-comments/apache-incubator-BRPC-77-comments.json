[{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2304242802","html_url":"https://github.com/apache/brpc/issues/2740#issuecomment-2304242802","issue_url":"https://api.github.com/repos/apache/brpc/issues/2740","id":2304242802,"node_id":"IC_kwDOBhmkcs6JV_Ry","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-22T09:48:38Z","updated_at":"2024-08-22T09:48:38Z","author_association":"CONTRIBUTOR","body":"相关issue：#1693","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2304242802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2304598248","html_url":"https://github.com/apache/brpc/issues/936#issuecomment-2304598248","issue_url":"https://api.github.com/repos/apache/brpc/issues/936","id":2304598248,"node_id":"IC_kwDOBhmkcs6JXWDo","user":{"login":"johndb2016","id":17661631,"node_id":"MDQ6VXNlcjE3NjYxNjMx","avatar_url":"https://avatars.githubusercontent.com/u/17661631?v=4","gravatar_id":"","url":"https://api.github.com/users/johndb2016","html_url":"https://github.com/johndb2016","followers_url":"https://api.github.com/users/johndb2016/followers","following_url":"https://api.github.com/users/johndb2016/following{/other_user}","gists_url":"https://api.github.com/users/johndb2016/gists{/gist_id}","starred_url":"https://api.github.com/users/johndb2016/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johndb2016/subscriptions","organizations_url":"https://api.github.com/users/johndb2016/orgs","repos_url":"https://api.github.com/users/johndb2016/repos","events_url":"https://api.github.com/users/johndb2016/events{/privacy}","received_events_url":"https://api.github.com/users/johndb2016/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-22T12:52:58Z","updated_at":"2024-08-22T12:52:58Z","author_association":"NONE","body":"@ilixiaocui 后面咋解决的，不用brpc了么？\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2304598248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2304837688","html_url":"https://github.com/apache/brpc/issues/2743#issuecomment-2304837688","issue_url":"https://api.github.com/repos/apache/brpc/issues/2743","id":2304837688,"node_id":"IC_kwDOBhmkcs6JYQg4","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-22T14:36:41Z","updated_at":"2024-08-22T14:36:41Z","author_association":"CONTRIBUTOR","body":"#2431 已经支持带状态或者上下文了。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2304837688/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2309176909","html_url":"https://github.com/apache/brpc/pull/2734#issuecomment-2309176909","issue_url":"https://api.github.com/repos/apache/brpc/issues/2734","id":2309176909,"node_id":"IC_kwDOBhmkcs6Joz5N","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-26T02:24:30Z","updated_at":"2024-08-26T02:24:30Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2309176909/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2309180938","html_url":"https://github.com/apache/brpc/pull/2737#issuecomment-2309180938","issue_url":"https://api.github.com/repos/apache/brpc/issues/2737","id":2309180938,"node_id":"IC_kwDOBhmkcs6Jo04K","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-26T02:29:14Z","updated_at":"2024-08-26T02:29:14Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2309180938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2309198077","html_url":"https://github.com/apache/brpc/issues/2738#issuecomment-2309198077","issue_url":"https://api.github.com/repos/apache/brpc/issues/2738","id":2309198077,"node_id":"IC_kwDOBhmkcs6Jo5D9","user":{"login":"hpsdy","id":10432981,"node_id":"MDQ6VXNlcjEwNDMyOTgx","avatar_url":"https://avatars.githubusercontent.com/u/10432981?v=4","gravatar_id":"","url":"https://api.github.com/users/hpsdy","html_url":"https://github.com/hpsdy","followers_url":"https://api.github.com/users/hpsdy/followers","following_url":"https://api.github.com/users/hpsdy/following{/other_user}","gists_url":"https://api.github.com/users/hpsdy/gists{/gist_id}","starred_url":"https://api.github.com/users/hpsdy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hpsdy/subscriptions","organizations_url":"https://api.github.com/users/hpsdy/orgs","repos_url":"https://api.github.com/users/hpsdy/repos","events_url":"https://api.github.com/users/hpsdy/events{/privacy}","received_events_url":"https://api.github.com/users/hpsdy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-26T02:50:49Z","updated_at":"2024-08-26T02:50:49Z","author_association":"NONE","body":"有人么？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2309198077/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2309836669","html_url":"https://github.com/apache/brpc/issues/2743#issuecomment-2309836669","issue_url":"https://api.github.com/repos/apache/brpc/issues/2743","id":2309836669,"node_id":"IC_kwDOBhmkcs6JrU99","user":{"login":"yukkit","id":28214641,"node_id":"MDQ6VXNlcjI4MjE0NjQx","avatar_url":"https://avatars.githubusercontent.com/u/28214641?v=4","gravatar_id":"","url":"https://api.github.com/users/yukkit","html_url":"https://github.com/yukkit","followers_url":"https://api.github.com/users/yukkit/followers","following_url":"https://api.github.com/users/yukkit/following{/other_user}","gists_url":"https://api.github.com/users/yukkit/gists{/gist_id}","starred_url":"https://api.github.com/users/yukkit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yukkit/subscriptions","organizations_url":"https://api.github.com/users/yukkit/orgs","repos_url":"https://api.github.com/users/yukkit/repos","events_url":"https://api.github.com/users/yukkit/events{/privacy}","received_events_url":"https://api.github.com/users/yukkit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-26T10:04:45Z","updated_at":"2024-08-26T10:04:45Z","author_association":"NONE","body":"> #2431 已经支持带状态或者上下文了。\r\n\r\n牛逼了 哥们","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2309836669/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2309854383","html_url":"https://github.com/apache/brpc/issues/2746#issuecomment-2309854383","issue_url":"https://api.github.com/repos/apache/brpc/issues/2746","id":2309854383,"node_id":"IC_kwDOBhmkcs6JrZSv","user":{"login":"GreateCode","id":9795716,"node_id":"MDQ6VXNlcjk3OTU3MTY=","avatar_url":"https://avatars.githubusercontent.com/u/9795716?v=4","gravatar_id":"","url":"https://api.github.com/users/GreateCode","html_url":"https://github.com/GreateCode","followers_url":"https://api.github.com/users/GreateCode/followers","following_url":"https://api.github.com/users/GreateCode/following{/other_user}","gists_url":"https://api.github.com/users/GreateCode/gists{/gist_id}","starred_url":"https://api.github.com/users/GreateCode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GreateCode/subscriptions","organizations_url":"https://api.github.com/users/GreateCode/orgs","repos_url":"https://api.github.com/users/GreateCode/repos","events_url":"https://api.github.com/users/GreateCode/events{/privacy}","received_events_url":"https://api.github.com/users/GreateCode/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-26T10:13:55Z","updated_at":"2024-08-26T10:13:55Z","author_association":"CONTRIBUTOR","body":"参数：-fno-access-control","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2309854383/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2309880690","html_url":"https://github.com/apache/brpc/issues/2746#issuecomment-2309880690","issue_url":"https://api.github.com/repos/apache/brpc/issues/2746","id":2309880690,"node_id":"IC_kwDOBhmkcs6Jrfty","user":{"login":"a87159909","id":17246975,"node_id":"MDQ6VXNlcjE3MjQ2OTc1","avatar_url":"https://avatars.githubusercontent.com/u/17246975?v=4","gravatar_id":"","url":"https://api.github.com/users/a87159909","html_url":"https://github.com/a87159909","followers_url":"https://api.github.com/users/a87159909/followers","following_url":"https://api.github.com/users/a87159909/following{/other_user}","gists_url":"https://api.github.com/users/a87159909/gists{/gist_id}","starred_url":"https://api.github.com/users/a87159909/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/a87159909/subscriptions","organizations_url":"https://api.github.com/users/a87159909/orgs","repos_url":"https://api.github.com/users/a87159909/repos","events_url":"https://api.github.com/users/a87159909/events{/privacy}","received_events_url":"https://api.github.com/users/a87159909/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-26T10:28:39Z","updated_at":"2024-08-26T10:28:39Z","author_association":"NONE","body":"> 参数：-fno-access-control\r\n\r\n具体在哪里使用了呢？我搜索代码貌似没有用到这个参数","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2309880690/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2309985146","html_url":"https://github.com/apache/brpc/issues/2746#issuecomment-2309985146","issue_url":"https://api.github.com/repos/apache/brpc/issues/2746","id":2309985146,"node_id":"IC_kwDOBhmkcs6Jr5N6","user":{"login":"GreateCode","id":9795716,"node_id":"MDQ6VXNlcjk3OTU3MTY=","avatar_url":"https://avatars.githubusercontent.com/u/9795716?v=4","gravatar_id":"","url":"https://api.github.com/users/GreateCode","html_url":"https://github.com/GreateCode","followers_url":"https://api.github.com/users/GreateCode/followers","following_url":"https://api.github.com/users/GreateCode/following{/other_user}","gists_url":"https://api.github.com/users/GreateCode/gists{/gist_id}","starred_url":"https://api.github.com/users/GreateCode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GreateCode/subscriptions","organizations_url":"https://api.github.com/users/GreateCode/orgs","repos_url":"https://api.github.com/users/GreateCode/repos","events_url":"https://api.github.com/users/GreateCode/events{/privacy}","received_events_url":"https://api.github.com/users/GreateCode/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-26T11:31:38Z","updated_at":"2024-08-26T11:31:38Z","author_association":"CONTRIBUTOR","body":"https://github.com/apache/brpc/blob/master/test/BUILD.bazel#L33","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2309985146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2311409511","html_url":"https://github.com/apache/brpc/issues/2745#issuecomment-2311409511","issue_url":"https://api.github.com/repos/apache/brpc/issues/2745","id":2311409511,"node_id":"IC_kwDOBhmkcs6JxU9n","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-27T01:45:45Z","updated_at":"2024-08-27T01:45:45Z","author_association":"CONTRIBUTOR","body":"看你想怎么用了，\r\n1、将brpc的worker线程池和spdk的线程独立开。\r\n2、使用一个队列，形成生产者消费者，把spdk作为一个单线程的消费者。\r\n3、worker线程和spdk是同一个线程，这种情况下需要对brpc做一些改造了。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2311409511/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2311451292","html_url":"https://github.com/apache/brpc/pull/2398#issuecomment-2311451292","issue_url":"https://api.github.com/repos/apache/brpc/issues/2398","id":2311451292,"node_id":"IC_kwDOBhmkcs6JxfKc","user":{"login":"zhengJade","id":30115816,"node_id":"MDQ6VXNlcjMwMTE1ODE2","avatar_url":"https://avatars.githubusercontent.com/u/30115816?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengJade","html_url":"https://github.com/zhengJade","followers_url":"https://api.github.com/users/zhengJade/followers","following_url":"https://api.github.com/users/zhengJade/following{/other_user}","gists_url":"https://api.github.com/users/zhengJade/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengJade/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengJade/subscriptions","organizations_url":"https://api.github.com/users/zhengJade/orgs","repos_url":"https://api.github.com/users/zhengJade/repos","events_url":"https://api.github.com/users/zhengJade/events{/privacy}","received_events_url":"https://api.github.com/users/zhengJade/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-27T02:32:35Z","updated_at":"2024-08-27T02:32:35Z","author_association":"CONTRIBUTOR","body":"这个有计划合并进来嘛，暂时没有的话，我就自己写了","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2311451292/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2311767165","html_url":"https://github.com/apache/brpc/pull/2737#issuecomment-2311767165","issue_url":"https://api.github.com/repos/apache/brpc/issues/2737","id":2311767165,"node_id":"IC_kwDOBhmkcs6JysR9","user":{"login":"GreateCode","id":9795716,"node_id":"MDQ6VXNlcjk3OTU3MTY=","avatar_url":"https://avatars.githubusercontent.com/u/9795716?v=4","gravatar_id":"","url":"https://api.github.com/users/GreateCode","html_url":"https://github.com/GreateCode","followers_url":"https://api.github.com/users/GreateCode/followers","following_url":"https://api.github.com/users/GreateCode/following{/other_user}","gists_url":"https://api.github.com/users/GreateCode/gists{/gist_id}","starred_url":"https://api.github.com/users/GreateCode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GreateCode/subscriptions","organizations_url":"https://api.github.com/users/GreateCode/orgs","repos_url":"https://api.github.com/users/GreateCode/repos","events_url":"https://api.github.com/users/GreateCode/events{/privacy}","received_events_url":"https://api.github.com/users/GreateCode/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-27T07:27:52Z","updated_at":"2024-08-27T07:27:52Z","author_association":"CONTRIBUTOR","body":"> 可以集成到内置服务heap页面吗？\r\n\r\n尝试了，放弃了。。\r\n你帮忙改下？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2311767165/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2312488671","html_url":"https://github.com/apache/brpc/issues/2738#issuecomment-2312488671","issue_url":"https://api.github.com/repos/apache/brpc/issues/2738","id":2312488671,"node_id":"IC_kwDOBhmkcs6J1cbf","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-27T12:55:56Z","updated_at":"2024-08-27T12:55:56Z","author_association":"CONTRIBUTOR","body":"https://github.com/apache/brpc/blob/d3c68546ec3973e03656c6129d8f17e0198a5824/src/brpc/policy/http2_rpc_protocol.cpp#L1687-L1691\r\nhttps://github.com/apache/brpc/blob/d3c68546ec3973e03656c6129d8f17e0198a5824/src/brpc/policy/http2_rpc_protocol.cpp#L1672-L1678\r\n\r\n在Socket里会调`AppendAndDestroySelf`回收的。\r\n\r\n压测场景下，出现内存泄漏，应该不止泄漏几百bytes吧。是不是进程退出的时候，server还在处理请求呢？\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2312488671/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2316903587","html_url":"https://github.com/apache/brpc/issues/2745#issuecomment-2316903587","issue_url":"https://api.github.com/repos/apache/brpc/issues/2745","id":2316903587,"node_id":"IC_kwDOBhmkcs6KGSSj","user":{"login":"gamezhoulei","id":24911864,"node_id":"MDQ6VXNlcjI0OTExODY0","avatar_url":"https://avatars.githubusercontent.com/u/24911864?v=4","gravatar_id":"","url":"https://api.github.com/users/gamezhoulei","html_url":"https://github.com/gamezhoulei","followers_url":"https://api.github.com/users/gamezhoulei/followers","following_url":"https://api.github.com/users/gamezhoulei/following{/other_user}","gists_url":"https://api.github.com/users/gamezhoulei/gists{/gist_id}","starred_url":"https://api.github.com/users/gamezhoulei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gamezhoulei/subscriptions","organizations_url":"https://api.github.com/users/gamezhoulei/orgs","repos_url":"https://api.github.com/users/gamezhoulei/repos","events_url":"https://api.github.com/users/gamezhoulei/events{/privacy}","received_events_url":"https://api.github.com/users/gamezhoulei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-29T07:29:51Z","updated_at":"2024-08-29T07:29:51Z","author_association":"NONE","body":"> 看你想怎么用了， 1、将brpc的worker线程池和spdk的线程独立开。 2、使用一个队列，形成生产者消费者，把spdk作为一个单线程的消费者。 3、worker线程和spdk是同一个线程，这种情况下需要对brpc做一些改造了。\r\n\r\n独立开来, brpc可以绑定到对应的core么","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2316903587/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2316928685","html_url":"https://github.com/apache/brpc/issues/2745#issuecomment-2316928685","issue_url":"https://api.github.com/repos/apache/brpc/issues/2745","id":2316928685,"node_id":"IC_kwDOBhmkcs6KGYat","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-29T07:44:18Z","updated_at":"2024-08-29T07:44:18Z","author_association":"CONTRIBUTOR","body":"可以的，brpc有个函数:\r\n// Add a startup function that each pthread worker will run at the beginning\r\n// To run code at the end, use butil::thread_atexit()\r\n// Returns 0 on success, error code otherwise.\r\nextern int bthread_set_worker_startfn(void (*start_fn)());\r\n\r\n// Add a startup function with tag\r\nextern int bthread_set_tagged_worker_startfn(void (*start_fn)(bthread_tag_t));\r\n\r\n可以在这个函数里面完成绑核的工作。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2316928685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2317196958","html_url":"https://github.com/apache/brpc/issues/2745#issuecomment-2317196958","issue_url":"https://api.github.com/repos/apache/brpc/issues/2745","id":2317196958,"node_id":"IC_kwDOBhmkcs6KHZ6e","user":{"login":"gamezhoulei","id":24911864,"node_id":"MDQ6VXNlcjI0OTExODY0","avatar_url":"https://avatars.githubusercontent.com/u/24911864?v=4","gravatar_id":"","url":"https://api.github.com/users/gamezhoulei","html_url":"https://github.com/gamezhoulei","followers_url":"https://api.github.com/users/gamezhoulei/followers","following_url":"https://api.github.com/users/gamezhoulei/following{/other_user}","gists_url":"https://api.github.com/users/gamezhoulei/gists{/gist_id}","starred_url":"https://api.github.com/users/gamezhoulei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gamezhoulei/subscriptions","organizations_url":"https://api.github.com/users/gamezhoulei/orgs","repos_url":"https://api.github.com/users/gamezhoulei/repos","events_url":"https://api.github.com/users/gamezhoulei/events{/privacy}","received_events_url":"https://api.github.com/users/gamezhoulei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-29T09:53:03Z","updated_at":"2024-08-29T09:53:03Z","author_association":"NONE","body":"> 可以的，brpc有个函数: // Add a startup function that each pthread worker will run at the beginning // To run code at the end, use butil::thread_atexit() // Returns 0 on success, error code otherwise. extern int bthread_set_worker_startfn(void (*start_fn)());\r\n> \r\n> // Add a startup function with tag extern int bthread_set_tagged_worker_startfn(void (*start_fn)(bthread_tag_t));\r\n> \r\n> 可以在这个函数里面完成绑核的工作。\r\n\r\n好的, 感谢. 只要我spdk和brpc设置不同的core, 就好了.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2317196958/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2319838542","html_url":"https://github.com/apache/brpc/issues/2750#issuecomment-2319838542","issue_url":"https://api.github.com/repos/apache/brpc/issues/2750","id":2319838542,"node_id":"IC_kwDOBhmkcs6KRe1O","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-30T03:14:29Z","updated_at":"2024-08-30T03:14:29Z","author_association":"CONTRIBUTOR","body":"cuda代码的host部分就是常规c++程序，应该是可以用的，不过cuda编译器是nvcc，可能会有一些warning或error要处理。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2319838542/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2319890043","html_url":"https://github.com/apache/brpc/issues/2750#issuecomment-2319890043","issue_url":"https://api.github.com/repos/apache/brpc/issues/2750","id":2319890043,"node_id":"IC_kwDOBhmkcs6KRrZ7","user":{"login":"knightXun","id":8334944,"node_id":"MDQ6VXNlcjgzMzQ5NDQ=","avatar_url":"https://avatars.githubusercontent.com/u/8334944?v=4","gravatar_id":"","url":"https://api.github.com/users/knightXun","html_url":"https://github.com/knightXun","followers_url":"https://api.github.com/users/knightXun/followers","following_url":"https://api.github.com/users/knightXun/following{/other_user}","gists_url":"https://api.github.com/users/knightXun/gists{/gist_id}","starred_url":"https://api.github.com/users/knightXun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/knightXun/subscriptions","organizations_url":"https://api.github.com/users/knightXun/orgs","repos_url":"https://api.github.com/users/knightXun/repos","events_url":"https://api.github.com/users/knightXun/events{/privacy}","received_events_url":"https://api.github.com/users/knightXun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-30T03:22:44Z","updated_at":"2024-08-30T04:19:57Z","author_association":"NONE","body":"> cuda代码的host部分就是常规c++程序，应该是可以用的，不过cuda编译器是nvcc，可能会有一些warning或error要处理。\r\n\r\n能提供一些demo么? \r\n抱歉我补充一下：gpu侧使用 brpc ，brpc 接收端能不能直接把接受的内容放到 cuda 显存中？\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2319890043/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2320020615","html_url":"https://github.com/apache/brpc/issues/2564#issuecomment-2320020615","issue_url":"https://api.github.com/repos/apache/brpc/issues/2564","id":2320020615,"node_id":"IC_kwDOBhmkcs6KSLSH","user":{"login":"mystoryfantacy","id":5829623,"node_id":"MDQ6VXNlcjU4Mjk2MjM=","avatar_url":"https://avatars.githubusercontent.com/u/5829623?v=4","gravatar_id":"","url":"https://api.github.com/users/mystoryfantacy","html_url":"https://github.com/mystoryfantacy","followers_url":"https://api.github.com/users/mystoryfantacy/followers","following_url":"https://api.github.com/users/mystoryfantacy/following{/other_user}","gists_url":"https://api.github.com/users/mystoryfantacy/gists{/gist_id}","starred_url":"https://api.github.com/users/mystoryfantacy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mystoryfantacy/subscriptions","organizations_url":"https://api.github.com/users/mystoryfantacy/orgs","repos_url":"https://api.github.com/users/mystoryfantacy/repos","events_url":"https://api.github.com/users/mystoryfantacy/events{/privacy}","received_events_url":"https://api.github.com/users/mystoryfantacy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-30T04:37:40Z","updated_at":"2024-08-30T04:37:40Z","author_association":"NONE","body":"@Superskyyy  is there any update on these example and doc?","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2320020615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2320305282","html_url":"https://github.com/apache/brpc/pull/1175#issuecomment-2320305282","issue_url":"https://api.github.com/repos/apache/brpc/issues/1175","id":2320305282,"node_id":"IC_kwDOBhmkcs6KTQyC","user":{"login":"limindlmu","id":24813528,"node_id":"MDQ6VXNlcjI0ODEzNTI4","avatar_url":"https://avatars.githubusercontent.com/u/24813528?v=4","gravatar_id":"","url":"https://api.github.com/users/limindlmu","html_url":"https://github.com/limindlmu","followers_url":"https://api.github.com/users/limindlmu/followers","following_url":"https://api.github.com/users/limindlmu/following{/other_user}","gists_url":"https://api.github.com/users/limindlmu/gists{/gist_id}","starred_url":"https://api.github.com/users/limindlmu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/limindlmu/subscriptions","organizations_url":"https://api.github.com/users/limindlmu/orgs","repos_url":"https://api.github.com/users/limindlmu/repos","events_url":"https://api.github.com/users/limindlmu/events{/privacy}","received_events_url":"https://api.github.com/users/limindlmu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-30T07:15:45Z","updated_at":"2024-08-30T07:15:45Z","author_association":"NONE","body":"请问这个pr没合入是还存在什么问题么？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2320305282/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2322387249","html_url":"https://github.com/apache/brpc/issues/1281#issuecomment-2322387249","issue_url":"https://api.github.com/repos/apache/brpc/issues/1281","id":2322387249,"node_id":"IC_kwDOBhmkcs6KbNEx","user":{"login":"idilkara","id":112080775,"node_id":"U_kgDOBq43hw","avatar_url":"https://avatars.githubusercontent.com/u/112080775?v=4","gravatar_id":"","url":"https://api.github.com/users/idilkara","html_url":"https://github.com/idilkara","followers_url":"https://api.github.com/users/idilkara/followers","following_url":"https://api.github.com/users/idilkara/following{/other_user}","gists_url":"https://api.github.com/users/idilkara/gists{/gist_id}","starred_url":"https://api.github.com/users/idilkara/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/idilkara/subscriptions","organizations_url":"https://api.github.com/users/idilkara/orgs","repos_url":"https://api.github.com/users/idilkara/repos","events_url":"https://api.github.com/users/idilkara/events{/privacy}","received_events_url":"https://api.github.com/users/idilkara/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-30T21:50:53Z","updated_at":"2024-08-30T21:50:53Z","author_association":"NONE","body":"Hi, I am having the same issue when I am running the counter example of braft with brpc protocol set to PROTOCOL_H2. ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2322387249/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2322865921","html_url":"https://github.com/apache/brpc/pull/2737#issuecomment-2322865921","issue_url":"https://api.github.com/repos/apache/brpc/issues/2737","id":2322865921,"node_id":"IC_kwDOBhmkcs6KdB8B","user":{"login":"GreateCode","id":9795716,"node_id":"MDQ6VXNlcjk3OTU3MTY=","avatar_url":"https://avatars.githubusercontent.com/u/9795716?v=4","gravatar_id":"","url":"https://api.github.com/users/GreateCode","html_url":"https://github.com/GreateCode","followers_url":"https://api.github.com/users/GreateCode/followers","following_url":"https://api.github.com/users/GreateCode/following{/other_user}","gists_url":"https://api.github.com/users/GreateCode/gists{/gist_id}","starred_url":"https://api.github.com/users/GreateCode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GreateCode/subscriptions","organizations_url":"https://api.github.com/users/GreateCode/orgs","repos_url":"https://api.github.com/users/GreateCode/repos","events_url":"https://api.github.com/users/GreateCode/events{/privacy}","received_events_url":"https://api.github.com/users/GreateCode/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-31T11:17:51Z","updated_at":"2024-08-31T11:17:51Z","author_association":"CONTRIBUTOR","body":"@wwbmmm @yanglimingcn @chenBright 接口新增了jemalloc stats信息，帮助查看memory细节如 各arena，metadata等，麻烦看下还有问题吗？谢谢~\r\n<img width=\"823\" alt=\"image\" src=\"https://github.com/user-attachments/assets/f1d76f97-5820-48d9-ac2f-45f04886e7d4\">\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2322865921/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2323662220","html_url":"https://github.com/apache/brpc/pull/2737#issuecomment-2323662220","issue_url":"https://api.github.com/repos/apache/brpc/issues/2737","id":2323662220,"node_id":"IC_kwDOBhmkcs6KgEWM","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-02T02:34:50Z","updated_at":"2024-09-02T02:34:50Z","author_association":"CONTRIBUTOR","body":"在[MemoryService](https://github.com/apache/brpc/blob/master/src/brpc/builtin/memory_service.cpp#L61-L78)也支持一下jemalloc stats？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2323662220/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2323803247","html_url":"https://github.com/apache/brpc/pull/2737#issuecomment-2323803247","issue_url":"https://api.github.com/repos/apache/brpc/issues/2737","id":2323803247,"node_id":"IC_kwDOBhmkcs6Kgmxv","user":{"login":"GreateCode","id":9795716,"node_id":"MDQ6VXNlcjk3OTU3MTY=","avatar_url":"https://avatars.githubusercontent.com/u/9795716?v=4","gravatar_id":"","url":"https://api.github.com/users/GreateCode","html_url":"https://github.com/GreateCode","followers_url":"https://api.github.com/users/GreateCode/followers","following_url":"https://api.github.com/users/GreateCode/following{/other_user}","gists_url":"https://api.github.com/users/GreateCode/gists{/gist_id}","starred_url":"https://api.github.com/users/GreateCode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GreateCode/subscriptions","organizations_url":"https://api.github.com/users/GreateCode/orgs","repos_url":"https://api.github.com/users/GreateCode/repos","events_url":"https://api.github.com/users/GreateCode/events{/privacy}","received_events_url":"https://api.github.com/users/GreateCode/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-02T04:43:42Z","updated_at":"2024-09-02T04:43:42Z","author_association":"CONTRIBUTOR","body":"> 在[MemoryService](https://github.com/apache/brpc/blob/master/src/brpc/builtin/memory_service.cpp#L61-L78)也支持一下jemalloc stats？\r\n\r\ndone","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2323803247/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2324242956","html_url":"https://github.com/apache/brpc/pull/2744#issuecomment-2324242956","issue_url":"https://api.github.com/repos/apache/brpc/issues/2744","id":2324242956,"node_id":"IC_kwDOBhmkcs6KiSIM","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-02T09:20:15Z","updated_at":"2024-09-02T09:20:15Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2324242956/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2324264763","html_url":"https://github.com/apache/brpc/pull/2749#issuecomment-2324264763","issue_url":"https://api.github.com/repos/apache/brpc/issues/2749","id":2324264763,"node_id":"IC_kwDOBhmkcs6KiXc7","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-02T09:29:04Z","updated_at":"2024-09-02T09:29:04Z","author_association":"CONTRIBUTOR","body":"有测试这个性能提升的效果吗？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2324264763/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2324279922","html_url":"https://github.com/apache/brpc/pull/1175#issuecomment-2324279922","issue_url":"https://api.github.com/repos/apache/brpc/issues/1175","id":2324279922,"node_id":"IC_kwDOBhmkcs6KibJy","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-02T09:36:22Z","updated_at":"2024-09-02T09:36:22Z","author_association":"CONTRIBUTOR","body":"> 请问这个pr没合入是还存在什么问题么？\r\n\r\n现在可以使用 https://github.com/apache/brpc/pull/2718 中提供的功能，通过自定义RpcPBMessageFactory来支持arena","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2324279922/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2324347094","html_url":"https://github.com/apache/brpc/pull/1175#issuecomment-2324347094","issue_url":"https://api.github.com/repos/apache/brpc/issues/1175","id":2324347094,"node_id":"IC_kwDOBhmkcs6KirjW","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-02T10:09:22Z","updated_at":"2024-09-03T02:22:03Z","author_association":"CONTRIBUTOR","body":"> 请问这个pr没合入是还存在什么问题么？\r\n\r\n@limindlmu 可以看看#2751 。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2324347094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2325555121","html_url":"https://github.com/apache/brpc/pull/2751#issuecomment-2325555121","issue_url":"https://api.github.com/repos/apache/brpc/issues/2751","id":2325555121,"node_id":"IC_kwDOBhmkcs6KnSex","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-03T03:51:26Z","updated_at":"2024-09-03T03:51:26Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2325555121/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2326111025","html_url":"https://github.com/apache/brpc/issues/2755#issuecomment-2326111025","issue_url":"https://api.github.com/repos/apache/brpc/issues/2755","id":2326111025,"node_id":"IC_kwDOBhmkcs6KpaMx","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-03T10:00:58Z","updated_at":"2024-09-03T10:01:41Z","author_association":"CONTRIBUTOR","body":"The bRPC server is asynchronous at its core, a \"sync service\" is just a service calling \"done->Run()\" before the service callback ends. You should look at interfaces of the DB client first: \r\n- If the db client has async interfaces (allowing you to pass a callback to be called when db access is done), you could call server's done->Run() in the callback. It's also possible to wrap the async DB client into a bthread-synchronous interfaces.\r\n- If the db client blocks (underlying pthread) until the db access is done, and the DB access is expected to last long(e.g. several seconds), you may run the DB client in separate pthreads. Creating extra bthreads in bRPC server does not help, because all bthreads are mapped to the same pool of pthread workers used by bRPC.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2326111025/reactions","total_count":1,"+1":0,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2326121929","html_url":"https://github.com/apache/brpc/issues/2755#issuecomment-2326121929","issue_url":"https://api.github.com/repos/apache/brpc/issues/2755","id":2326121929,"node_id":"IC_kwDOBhmkcs6Kpc3J","user":{"login":"qiaobaochen","id":22009264,"node_id":"MDQ6VXNlcjIyMDA5MjY0","avatar_url":"https://avatars.githubusercontent.com/u/22009264?v=4","gravatar_id":"","url":"https://api.github.com/users/qiaobaochen","html_url":"https://github.com/qiaobaochen","followers_url":"https://api.github.com/users/qiaobaochen/followers","following_url":"https://api.github.com/users/qiaobaochen/following{/other_user}","gists_url":"https://api.github.com/users/qiaobaochen/gists{/gist_id}","starred_url":"https://api.github.com/users/qiaobaochen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qiaobaochen/subscriptions","organizations_url":"https://api.github.com/users/qiaobaochen/orgs","repos_url":"https://api.github.com/users/qiaobaochen/repos","events_url":"https://api.github.com/users/qiaobaochen/events{/privacy}","received_events_url":"https://api.github.com/users/qiaobaochen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-03T10:05:50Z","updated_at":"2024-09-03T10:05:50Z","author_association":"NONE","body":"> The bRPC server is asynchronous at its core, a \"sync service\" is just a service calling \"done->Run()\" before the service callback ends. You should look at interfaces of the DB client first:\r\n> \r\n> * If the db client has async interfaces (allowing you to pass a callback to be called when db access is done), you could call server's done->Run() in the callback. It's also possible to wrap the async DB client into a bthread-synchronous interfaces.\r\n> * If the db client blocks (underlying pthread) until the db access is done, and the DB access is expected to last long(e.g. several seconds), you may run the DB client in separate pthreads. Creating extra bthreads in bRPC server does not help, because all bthreads are mapped to the same pool of pthread workers used by bRPC.\r\n\r\n---\r\n\r\nthat's very clear, thanks a lot!","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2326121929/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2326397806","html_url":"https://github.com/apache/brpc/pull/2754#issuecomment-2326397806","issue_url":"https://api.github.com/repos/apache/brpc/issues/2754","id":2326397806,"node_id":"IC_kwDOBhmkcs6KqgNu","user":{"login":"jenrryyou","id":4698734,"node_id":"MDQ6VXNlcjQ2OTg3MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/4698734?v=4","gravatar_id":"","url":"https://api.github.com/users/jenrryyou","html_url":"https://github.com/jenrryyou","followers_url":"https://api.github.com/users/jenrryyou/followers","following_url":"https://api.github.com/users/jenrryyou/following{/other_user}","gists_url":"https://api.github.com/users/jenrryyou/gists{/gist_id}","starred_url":"https://api.github.com/users/jenrryyou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jenrryyou/subscriptions","organizations_url":"https://api.github.com/users/jenrryyou/orgs","repos_url":"https://api.github.com/users/jenrryyou/repos","events_url":"https://api.github.com/users/jenrryyou/events{/privacy}","received_events_url":"https://api.github.com/users/jenrryyou/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-03T12:28:00Z","updated_at":"2024-09-03T12:59:02Z","author_association":"CONTRIBUTOR","body":"看了下macos protobuf22 CI 编译的报错\r\n![image](https://github.com/user-attachments/assets/bb2708b7-0bde-4803-846a-6a8fd0739360)\r\n，是因为链接的库libprotobuf.dylib没有\r\ngoogle::protobuf::internal::ThreadSafeArena::thread_cache_定义，但是include 的thread_safe_arena.h文件有这个符号。说明brew编译的libprotobuf.dylib macos版本是开启了PROTOBUF_NO_THREADLOCAL宏（所以有google::protobuf::internal::ThreadSafeArena::thread_cache()定义，但是没有google::protobuf::internal::ThreadSafeArena::thread_cache_定义），brpc编译时候是没有PROTOBUF_NO_THREADLOCAL宏，所以链接时候报错。 附图：![image](https://github.com/user-attachments/assets/87635c2f-ba6e-4aef-9e0e-5ad797052c8b)\r\n![image](https://github.com/user-attachments/assets/e310edcb-06ce-4615-9671-047624d0f712)\r\n\r\n\r\n但是也没有在编译时办法传入PROTOBUF_NO_THREADLOCAL宏，protobuf一个头文件做了检查，外部配置PROTOBUF_NO_THREADLOCAL宏就会报错\r\n![image](https://github.com/user-attachments/assets/6617e4db-5d08-4116-b003-8f8d1ab72a4e)\r\n\r\n继续分析了下应该是protobuf的BUG，已经在MR https://github.com/protocolbuffers/protobuf/pull/12983 修复,  但是protobuf@22.5版本没有包含该fix，导致在mac上只要在proto文件里使用repeated 类型的Field就会编译出错\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2326397806/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2326458507","html_url":"https://github.com/apache/brpc/pull/2749#issuecomment-2326458507","issue_url":"https://api.github.com/repos/apache/brpc/issues/2749","id":2326458507,"node_id":"IC_kwDOBhmkcs6KqvCL","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-03T12:57:04Z","updated_at":"2024-09-04T06:08:38Z","author_association":"CONTRIBUTOR","body":"> 有测试这个性能提升的效果吗？\r\n\r\n1. 自旋没啥效果，应该是因为触发条件比较苛刻，不好模拟。如果本地调度队列已经空了，进程负载应该不高，不自旋、多一次唤醒，问题也不大。不过mutex进入slow path之前自旋一小会，是经过业界验证过的优化手段，应该在条件满足的情况下，会有一点提升吧。\r\n2. 测试第二点优化，性能没变化。性能最好的应该是修改之前的，公平性一般会牺牲一些性能。性能和公平性是需要权衡的，golang为了公平性还引入了饥饿模式，让等待队列中饥饿（排队时间超过1ms）的协程直接获得锁，新来的协程直接入队。目前第二点优化了一个公平性的小问题，且不会降低性能，应该是可以接受的。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2326458507/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2327832879","html_url":"https://github.com/apache/brpc/issues/1241#issuecomment-2327832879","issue_url":"https://api.github.com/repos/apache/brpc/issues/1241","id":2327832879,"node_id":"IC_kwDOBhmkcs6Kv-kv","user":{"login":"zhangdongqiu","id":73276942,"node_id":"MDQ6VXNlcjczMjc2OTQy","avatar_url":"https://avatars.githubusercontent.com/u/73276942?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangdongqiu","html_url":"https://github.com/zhangdongqiu","followers_url":"https://api.github.com/users/zhangdongqiu/followers","following_url":"https://api.github.com/users/zhangdongqiu/following{/other_user}","gists_url":"https://api.github.com/users/zhangdongqiu/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangdongqiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangdongqiu/subscriptions","organizations_url":"https://api.github.com/users/zhangdongqiu/orgs","repos_url":"https://api.github.com/users/zhangdongqiu/repos","events_url":"https://api.github.com/users/zhangdongqiu/events{/privacy}","received_events_url":"https://api.github.com/users/zhangdongqiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-04T03:17:12Z","updated_at":"2024-09-04T03:17:12Z","author_association":"NONE","body":"vx:xishanzhidian帮我拉到群里","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2327832879/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2327834789","html_url":"https://github.com/apache/brpc/issues/1241#issuecomment-2327834789","issue_url":"https://api.github.com/repos/apache/brpc/issues/1241","id":2327834789,"node_id":"IC_kwDOBhmkcs6Kv_Cl","user":{"login":"GreateCode","id":9795716,"node_id":"MDQ6VXNlcjk3OTU3MTY=","avatar_url":"https://avatars.githubusercontent.com/u/9795716?v=4","gravatar_id":"","url":"https://api.github.com/users/GreateCode","html_url":"https://github.com/GreateCode","followers_url":"https://api.github.com/users/GreateCode/followers","following_url":"https://api.github.com/users/GreateCode/following{/other_user}","gists_url":"https://api.github.com/users/GreateCode/gists{/gist_id}","starred_url":"https://api.github.com/users/GreateCode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GreateCode/subscriptions","organizations_url":"https://api.github.com/users/GreateCode/orgs","repos_url":"https://api.github.com/users/GreateCode/repos","events_url":"https://api.github.com/users/GreateCode/events{/privacy}","received_events_url":"https://api.github.com/users/GreateCode/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-04T03:19:36Z","updated_at":"2024-09-04T03:19:36Z","author_association":"CONTRIBUTOR","body":"> vx：chao10001，求拉谢谢\r\n\r\n@gydong 求","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2327834789/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2327864891","html_url":"https://github.com/apache/brpc/issues/2756#issuecomment-2327864891","issue_url":"https://api.github.com/repos/apache/brpc/issues/2756","id":2327864891,"node_id":"IC_kwDOBhmkcs6KwGY7","user":{"login":"lsdh-fei","id":179830914,"node_id":"U_kgDOCrgAgg","avatar_url":"https://avatars.githubusercontent.com/u/179830914?v=4","gravatar_id":"","url":"https://api.github.com/users/lsdh-fei","html_url":"https://github.com/lsdh-fei","followers_url":"https://api.github.com/users/lsdh-fei/followers","following_url":"https://api.github.com/users/lsdh-fei/following{/other_user}","gists_url":"https://api.github.com/users/lsdh-fei/gists{/gist_id}","starred_url":"https://api.github.com/users/lsdh-fei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lsdh-fei/subscriptions","organizations_url":"https://api.github.com/users/lsdh-fei/orgs","repos_url":"https://api.github.com/users/lsdh-fei/repos","events_url":"https://api.github.com/users/lsdh-fei/events{/privacy}","received_events_url":"https://api.github.com/users/lsdh-fei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-04T03:59:11Z","updated_at":"2024-09-04T03:59:11Z","author_association":"NONE","body":"@wwbmmm @MJY-HUST 看了下提交记录，不知道是不是 #2645 引入的，辛苦看下哈","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2327864891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2327897465","html_url":"https://github.com/apache/brpc/pull/2749#issuecomment-2327897465","issue_url":"https://api.github.com/repos/apache/brpc/issues/2749","id":2327897465,"node_id":"IC_kwDOBhmkcs6KwOV5","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-04T04:37:26Z","updated_at":"2024-09-04T04:37:26Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2327897465/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2327918899","html_url":"https://github.com/apache/brpc/issues/2756#issuecomment-2327918899","issue_url":"https://api.github.com/repos/apache/brpc/issues/2756","id":2327918899,"node_id":"IC_kwDOBhmkcs6KwTkz","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-04T04:54:45Z","updated_at":"2024-09-04T04:54:45Z","author_association":"CONTRIBUTOR","body":"> thread销毁后也会跟着销毁，不应该无限增长\r\n\r\n自己起的线程中使用bthread_keytable吗？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2327918899/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2327936652","html_url":"https://github.com/apache/brpc/issues/661#issuecomment-2327936652","issue_url":"https://api.github.com/repos/apache/brpc/issues/661","id":2327936652,"node_id":"IC_kwDOBhmkcs6KwX6M","user":{"login":"drgnchan","id":40224023,"node_id":"MDQ6VXNlcjQwMjI0MDIz","avatar_url":"https://avatars.githubusercontent.com/u/40224023?v=4","gravatar_id":"","url":"https://api.github.com/users/drgnchan","html_url":"https://github.com/drgnchan","followers_url":"https://api.github.com/users/drgnchan/followers","following_url":"https://api.github.com/users/drgnchan/following{/other_user}","gists_url":"https://api.github.com/users/drgnchan/gists{/gist_id}","starred_url":"https://api.github.com/users/drgnchan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drgnchan/subscriptions","organizations_url":"https://api.github.com/users/drgnchan/orgs","repos_url":"https://api.github.com/users/drgnchan/repos","events_url":"https://api.github.com/users/drgnchan/events{/privacy}","received_events_url":"https://api.github.com/users/drgnchan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-04T05:13:43Z","updated_at":"2024-09-04T05:13:43Z","author_association":"NONE","body":"我是删掉了${DORIS_HOME}/thirdparty/src/brpc-1.4.0/doris_build文件夹后，再重新构建（bash build_thirdparty.sh）就通过了","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2327936652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2327998937","html_url":"https://github.com/apache/brpc/issues/2756#issuecomment-2327998937","issue_url":"https://api.github.com/repos/apache/brpc/issues/2756","id":2327998937,"node_id":"IC_kwDOBhmkcs6KwnHZ","user":{"login":"lsdh-fei","id":179830914,"node_id":"U_kgDOCrgAgg","avatar_url":"https://avatars.githubusercontent.com/u/179830914?v=4","gravatar_id":"","url":"https://api.github.com/users/lsdh-fei","html_url":"https://github.com/lsdh-fei","followers_url":"https://api.github.com/users/lsdh-fei/followers","following_url":"https://api.github.com/users/lsdh-fei/following{/other_user}","gists_url":"https://api.github.com/users/lsdh-fei/gists{/gist_id}","starred_url":"https://api.github.com/users/lsdh-fei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lsdh-fei/subscriptions","organizations_url":"https://api.github.com/users/lsdh-fei/orgs","repos_url":"https://api.github.com/users/lsdh-fei/repos","events_url":"https://api.github.com/users/lsdh-fei/events{/privacy}","received_events_url":"https://api.github.com/users/lsdh-fei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-04T06:11:01Z","updated_at":"2024-09-04T06:11:01Z","author_association":"NONE","body":"@chenBright 不是，就是rpc处理的bthread中使用的","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2327998937/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2328002615","html_url":"https://github.com/apache/brpc/issues/2756#issuecomment-2328002615","issue_url":"https://api.github.com/repos/apache/brpc/issues/2756","id":2328002615,"node_id":"IC_kwDOBhmkcs6KwoA3","user":{"login":"MJY-HUST","id":52315061,"node_id":"MDQ6VXNlcjUyMzE1MDYx","avatar_url":"https://avatars.githubusercontent.com/u/52315061?v=4","gravatar_id":"","url":"https://api.github.com/users/MJY-HUST","html_url":"https://github.com/MJY-HUST","followers_url":"https://api.github.com/users/MJY-HUST/followers","following_url":"https://api.github.com/users/MJY-HUST/following{/other_user}","gists_url":"https://api.github.com/users/MJY-HUST/gists{/gist_id}","starred_url":"https://api.github.com/users/MJY-HUST/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MJY-HUST/subscriptions","organizations_url":"https://api.github.com/users/MJY-HUST/orgs","repos_url":"https://api.github.com/users/MJY-HUST/repos","events_url":"https://api.github.com/users/MJY-HUST/events{/privacy}","received_events_url":"https://api.github.com/users/MJY-HUST/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-04T06:14:07Z","updated_at":"2024-09-04T06:17:09Z","author_association":"CONTRIBUTOR","body":"使用bthread-local的场景是什么样的呢@lsdh-fei\r\n在使用bthread-local变量时，如果create的bthread的addr中没有初始化bthread_keytable_pool_t的话，那么每次return_keytable都会直接析构keytable；另外如果初始化了bthread_keytable_pool_t的话，使用bthread-local变量时需要先调用bthread_getspecific尝试borrow_keytable进行复用，如果每次都是直接bthread_setspecific赋值的话，如果当前bthread不存在keytable的话，就会new一个新的keytable，内存就会不断增长，这个是之前就有的问题","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2328002615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2328029067","html_url":"https://github.com/apache/brpc/issues/2756#issuecomment-2328029067","issue_url":"https://api.github.com/repos/apache/brpc/issues/2756","id":2328029067,"node_id":"IC_kwDOBhmkcs6KwueL","user":{"login":"lsdh-fei","id":179830914,"node_id":"U_kgDOCrgAgg","avatar_url":"https://avatars.githubusercontent.com/u/179830914?v=4","gravatar_id":"","url":"https://api.github.com/users/lsdh-fei","html_url":"https://github.com/lsdh-fei","followers_url":"https://api.github.com/users/lsdh-fei/followers","following_url":"https://api.github.com/users/lsdh-fei/following{/other_user}","gists_url":"https://api.github.com/users/lsdh-fei/gists{/gist_id}","starred_url":"https://api.github.com/users/lsdh-fei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lsdh-fei/subscriptions","organizations_url":"https://api.github.com/users/lsdh-fei/orgs","repos_url":"https://api.github.com/users/lsdh-fei/repos","events_url":"https://api.github.com/users/lsdh-fei/events{/privacy}","received_events_url":"https://api.github.com/users/lsdh-fei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-04T06:33:50Z","updated_at":"2024-09-04T06:34:32Z","author_association":"NONE","body":"@MJY-HUST 没有单独使用bthread-local，就是task_runner中的，我门最近把brpc从1.8升级到了1.10，然后就发现新版有内存泄漏，LogStream占用了大量内存，看了下brpc源代码，发现log stream的buf是存在keytable中，然后就怀疑是keytable的问题，然后看vars监控，发现keytable的数量一直在不断增长，所以才怀疑是新版的改动导致的","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2328029067/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2328159885","html_url":"https://github.com/apache/brpc/pull/2645#issuecomment-2328159885","issue_url":"https://api.github.com/repos/apache/brpc/issues/2645","id":2328159885,"node_id":"IC_kwDOBhmkcs6KxOaN","user":{"login":"lsdh-fei","id":179830914,"node_id":"U_kgDOCrgAgg","avatar_url":"https://avatars.githubusercontent.com/u/179830914?v=4","gravatar_id":"","url":"https://api.github.com/users/lsdh-fei","html_url":"https://github.com/lsdh-fei","followers_url":"https://api.github.com/users/lsdh-fei/followers","following_url":"https://api.github.com/users/lsdh-fei/following{/other_user}","gists_url":"https://api.github.com/users/lsdh-fei/gists{/gist_id}","starred_url":"https://api.github.com/users/lsdh-fei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lsdh-fei/subscriptions","organizations_url":"https://api.github.com/users/lsdh-fei/orgs","repos_url":"https://api.github.com/users/lsdh-fei/repos","events_url":"https://api.github.com/users/lsdh-fei/events{/privacy}","received_events_url":"https://api.github.com/users/lsdh-fei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-04T07:50:29Z","updated_at":"2024-09-04T07:50:29Z","author_association":"NONE","body":"这里有个疑问，为什么不直接把bthread_keytable_pool_t改成thread-local的呢？@MJY-HUST","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2328159885/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2328497078","html_url":"https://github.com/apache/brpc/issues/2693#issuecomment-2328497078","issue_url":"https://api.github.com/repos/apache/brpc/issues/2693","id":2328497078,"node_id":"IC_kwDOBhmkcs6Kygu2","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-04T10:26:41Z","updated_at":"2024-09-04T10:26:41Z","author_association":"CONTRIBUTOR","body":"CC @stdpain","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2328497078/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2328568548","html_url":"https://github.com/apache/brpc/issues/2756#issuecomment-2328568548","issue_url":"https://api.github.com/repos/apache/brpc/issues/2756","id":2328568548,"node_id":"IC_kwDOBhmkcs6KyyLk","user":{"login":"lsdh-fei","id":179830914,"node_id":"U_kgDOCrgAgg","avatar_url":"https://avatars.githubusercontent.com/u/179830914?v=4","gravatar_id":"","url":"https://api.github.com/users/lsdh-fei","html_url":"https://github.com/lsdh-fei","followers_url":"https://api.github.com/users/lsdh-fei/followers","following_url":"https://api.github.com/users/lsdh-fei/following{/other_user}","gists_url":"https://api.github.com/users/lsdh-fei/gists{/gist_id}","starred_url":"https://api.github.com/users/lsdh-fei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lsdh-fei/subscriptions","organizations_url":"https://api.github.com/users/lsdh-fei/orgs","repos_url":"https://api.github.com/users/lsdh-fei/repos","events_url":"https://api.github.com/users/lsdh-fei/events{/privacy}","received_events_url":"https://api.github.com/users/lsdh-fei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-04T10:53:13Z","updated_at":"2024-09-04T11:58:41Z","author_association":"NONE","body":"现在观察到的现象是经常会出现 LogStream** get_or_new_tls_stream_array() => bthread_getspecific 无法获取LogStream，然后new了LogStream之后通过 bthread_setspecific 设置到tls_bls.keytable，但是同时在这里new一个KeyTable。所以新增的LogStream和KeyTable的数量是相同的。\r\n![image](https://github.com/user-attachments/assets/995833d5-c734-435e-8588-1e38f5e4dac4)\r\n![image](https://github.com/user-attachments/assets/88d5960b-bec6-4d10-9ead-2b2f8c321ce0)\r\n应该就是new log stream时创建的keytable泄漏了","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2328568548/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2329413363","html_url":"https://github.com/apache/brpc/issues/2145#issuecomment-2329413363","issue_url":"https://api.github.com/repos/apache/brpc/issues/2145","id":2329413363,"node_id":"IC_kwDOBhmkcs6K2Abz","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-04T15:44:07Z","updated_at":"2024-09-05T02:24:12Z","author_association":"CONTRIBUTOR","body":"> 我们是否可以采用将done传入progressive reader的方式来实现异步接口，然用户在合适的时候适时调用done->Run()？如果可行那么目前的设计可以cover这种方式。\r\n\r\n@TangSiyang2001 异步接口在小包场景下，有use after free的问题。开了asan测试HttpTest.server_end_read_failed有heap-use-after-free报错。以下是asan报告的调用栈：\r\n\r\n```\r\n#0 0x7f63659a2b83 in brpc::HttpMessage::SetBodyReader(brpc::ProgressiveReader*) /home/runner/work/brpc/brpc/src/brpc/details/http_message.cpp:384:13\r\n    #1 0x6aa3e5 in brpc::policy::HttpContext::ReadProgressiveAttachmentBy(brpc::ProgressiveReader*) /home/runner/work/brpc/brpc/test/../src/brpc/policy/http_rpc_protocol.h:118:16\r\n    #2 0x7f636586f505 in brpc::Controller::ReadProgressiveAttachmentBy(brpc::ProgressiveReader*) /home/runner/work/brpc/brpc/src/brpc/controller.cpp:1490:18\r\n    #3 0x66a23c in (anonymous namespace)::UploadServiceImpl::UploadFailed(google::protobuf::RpcController*, test::HttpRequest const*, test::HttpResponse*, google::protobuf::Closure*) /home/runner/work/brpc/brpc/test/brpc_http_rpc_protocol_unittest.cpp:1100:15\r\n    #4 0x622242 in test::UploadService::CallMethod(google::protobuf::MethodDescriptor const*, google::protobuf::RpcController*, google::protobuf::Message const*, google::protobuf::Message*, google::protobuf::Closure*) /home/runner/work/brpc/brpc/test/echo.pb.cc:3291:7\r\n    #5 0x7f6365a7575f in brpc::policy::ProcessHttpRequest(brpc::InputMessageBase*) /home/runner/work/brpc/brpc/src/brpc/policy/http_rpc_protocol.cpp:1610:21\r\n    #6 0x7f63657cbfca in brpc::ProcessInputMessage(void*) /home/runner/work/brpc/brpc/src/brpc/input_messenger.cpp:177:5\r\n    #7 0x7f636557b5ad in bthread::TaskGroup::task_runner(long) /home/runner/work/brpc/brpc/src/bthread/task_group.cpp:345:29\r\n    #8 0x7f6365588040 in bthread_make_fcontext (libbrpc.dbg.so+0x567040)\r\n0x6170000622d8 is located 600 bytes inside of 736-byte region [0x617000062080,0x617000062360)\r\n\r\nfreed by thread T8 (brpc_wkr:0-5) here:\r\n    #0 0x4eb30d in operator delete(void*) (/home/runner/work/brpc/brpc/test/brpc_http_rpc_protocol_unittest+0x4eb30d)\r\n    #1 0x6aa3b7 in brpc::policy::HttpContext::~HttpContext() /home/runner/work/brpc/brpc/test/../src/brpc/policy/http_rpc_protocol.h:86:7\r\n    #2 0x7f63658615bb in brpc::SharedObject::RemoveRefManually() /home/runner/work/brpc/brpc/./src/brpc/shared_object.h:52:13\r\n    #3 0x7f63658615bb in brpc::intrusive_ptr_release(brpc::SharedObject*) /home/runner/work/brpc/brpc/./src/brpc/shared_object.h:67:10\r\n    #4 0x7f63658615bb in butil::intrusive_ptr<brpc::ReadableProgressiveAttachment>::~intrusive_ptr() /home/runner/work/brpc/brpc/./src/butil/intrusive_ptr.hpp:89:21\r\n    #5 0x7f63658615bb in butil::intrusive_ptr<brpc::ReadableProgressiveAttachment>::reset(brpc::ReadableProgressiveAttachment*) /home/runner/work/brpc/brpc/./src/butil/intrusive_ptr.hpp:124:9\r\n    #6 0x7f63658615bb in brpc::Controller::ResetNonPods() /home/runner/work/brpc/brpc/src/brpc/controller.cpp:231:14\r\n    #7 0x7f636586035c in brpc::Controller::~Controller() /home/runner/work/brpc/brpc/src/brpc/controller.cpp:165:5\r\n    #8 0x7f6365861c3d in brpc::Controller::~Controller() /home/runner/work/brpc/brpc/src/brpc/controller.cpp:160:27\r\n    #9 0x7f63657a3131 in brpc::LogErrorTextAndDelete::operator()(brpc::Controller*) const /home/runner/work/brpc/brpc/src/brpc/protocol.cpp:271:9\r\n    #10 0x7f6365a6df89 in std::unique_ptr<brpc::Controller, brpc::LogErrorTextAndDelete>::~unique_ptr() /usr/bin/../lib/gcc/x86_64-linux-gnu/10/../../../../include/c++/10/bits/unique_ptr.h:361:4\r\n    #11 0x7f6365a6df89 in brpc::policy::HttpResponseSender::~HttpResponseSender() /home/runner/work/brpc/brpc/src/brpc/policy/http_rpc_protocol.cpp:977:1\r\n    #12 0x7f6365a79dcf in brpc::policy::HttpResponseSenderAsDone::~HttpResponseSenderAsDone() /home/runner/work/brpc/brpc/src/brpc/policy/http_rpc_protocol.cpp:742:7\r\n    #13 0x7f6365a79dcf in brpc::policy::HttpResponseSenderAsDone::~HttpResponseSenderAsDone() /home/runner/work/brpc/brpc/src/brpc/policy/http_rpc_protocol.cpp:742:7\r\n    #14 0x69c1a7 in brpc::ClosureGuard::~ClosureGuard() /home/runner/work/brpc/brpc/test/../src/brpc/closure_guard.h:39:20\r\n    #15 0x66bc3e in (anonymous namespace)::ServerAlwaysFailReader::OnEndOfMessage(butil::Status const&) /home/runner/work/brpc/brpc/test/brpc_http_rpc_protocol_unittest.cpp:1075:5\r\n    #16 0x7f63659a28d3 in brpc::HttpMessage::SetBodyReader(brpc::ProgressiveReader*) /home/runner/work/brpc/brpc/src/brpc/details/http_message.cpp:411:20\r\n    #17 0x6aa3e5 in brpc::policy::HttpContext::ReadProgressiveAttachmentBy(brpc::ProgressiveReader*) /home/runner/work/brpc/brpc/test/../src/brpc/policy/http_rpc_protocol.h:118:16\r\n    #18 0x7f636586f505 in brpc::Controller::ReadProgressiveAttachmentBy(brpc::ProgressiveReader*) /home/runner/work/brpc/brpc/src/brpc/controller.cpp:1490:18\r\n    #19 0x66a23c in (anonymous namespace)::UploadServiceImpl::UploadFailed(google::protobuf::RpcController*, test::HttpRequest const*, test::HttpResponse*, google::protobuf::Closure*) /home/runner/work/brpc/brpc/test/brpc_http_rpc_protocol_unittest.cpp:1100:15\r\n    #20 0x622242 in test::UploadService::CallMethod(google::protobuf::MethodDescriptor const*, google::protobuf::RpcController*, google::protobuf::Message const*, google::protobuf::Message*, google::protobuf::Closure*) /home/runner/work/brpc/brpc/test/echo.pb.cc:3291:7\r\n    #21 0x7f6365a7575f in brpc::policy::ProcessHttpRequest(brpc::InputMessageBase*) /home/runner/work/brpc/brpc/src/brpc/policy/http_rpc_protocol.cpp:1610:21\r\n    #22 0x7f63657cbfca in brpc::ProcessInputMessage(void*) /home/runner/work/brpc/brpc/src/brpc/input_messenger.cpp:177:5\r\n    #23 0x7f636557b5ad in bthread::TaskGroup::task_runner(long) /home/runner/work/brpc/brpc/src/bthread/task_group.cpp:345:29\r\n    #24 0x7f6365588040 in bthread_make_fcontext (libbrpc.dbg.so+0x567040)\r\npreviously allocated by thread T8 (brpc_wkr:0-5) here:\r\n    #0 0x4eaccd in operator new(unsigned long, std::nothrow_t const&) (/home/runner/work/brpc/brpc/test/brpc_http_rpc_protocol_unittest+0x4eaccd)\r\n    #1 0x7f6365a6ff3a in brpc::policy::ParseHttpMessage(butil::IOBuf*, brpc::Socket*, bool, void const*) /home/runner/work/brpc/brpc/src/brpc/policy/http_rpc_protocol.cpp:1115:21\r\n    #2 0x7f63657cb2bc in brpc::InputMessenger::CutInputMessage(brpc::Socket*, unsigned long*, bool) /home/runner/work/brpc/brpc/src/brpc/input_messenger.cpp:149:30\r\n    #3 0x7f63657cc579 in brpc::InputMessenger::ProcessNewMessage(brpc::Socket*, long, bool, unsigned long, unsigned long, brpc::InputMessenger::InputMessageClosure&) /home/runner/work/brpc/brpc/src/brpc/input_messenger.cpp:237:26\r\n    #4 0x7f63657cdeea in brpc::InputMessenger::OnNewMessages(brpc::Socket*) /home/runner/work/brpc/brpc/src/brpc/input_messenger.cpp:392:62\r\n    #5 0x7f63658fbb79 in brpc::Socket::ProcessEvent(void*) /home/runner/work/brpc/brpc/src/brpc/socket.cpp:1[186](https://github.com/chenBright/brpc/actions/runs/10552403816/job/29231164862?pr=11#step:7:187):5\r\n    #6 0x7f636557b5ad in bthread::TaskGroup::task_runner(long) /home/runner/work/brpc/brpc/src/bthread/task_group.cpp:345:29\r\n    #7 0x7f6365588040 in bthread_make_fcontext (libbrpc.dbg.so+0x567040)\r\n```\r\n服务端收到请求后的调用链路：cntl->ReadProgressiveAttachmentBy -> (HttpContext)_rpa->ReadProgressiveAttachmentBy -> HttpMessage::SetBodyReader -> r->OnReadOnePart 、 r->OnEndOfMessage -> brpc::~ClosureGuard，其中r->OnReadOnePart和r->OnEndOfMessage调用位置是：\r\n\r\nhttps://github.com/apache/brpc/blob/2c6644be83d7b016693ab360832424f0069842cf/src/brpc/details/http_message.cpp#L407-L419\r\n\r\n因为接收到的http包比较小，服务端一次性就收完并解析完了，所以最后只有cntl持有_rpa即HttpMessage。r->OnEndOfMessage即ServerAlwaysFailReader::OnEndOfMessage结束前，done_guard析构会回包给客户端，并回收cntl，_rpa（HttpMessage）也就被回收了，那后续在HttpMessage::SetBodyReader使用了成员变量_body_reader就会crash了。\r\n\r\nhttps://github.com/apache/brpc/blob/2c6644be83d7b016693ab360832424f0069842cf/src/brpc/details/http_message.cpp#L384-L388","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2329413363/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2330682188","html_url":"https://github.com/apache/brpc/issues/2145#issuecomment-2330682188","issue_url":"https://api.github.com/repos/apache/brpc/issues/2145","id":2330682188,"node_id":"IC_kwDOBhmkcs6K62NM","user":{"login":"TangSiyang2001","id":82279870,"node_id":"MDQ6VXNlcjgyMjc5ODcw","avatar_url":"https://avatars.githubusercontent.com/u/82279870?v=4","gravatar_id":"","url":"https://api.github.com/users/TangSiyang2001","html_url":"https://github.com/TangSiyang2001","followers_url":"https://api.github.com/users/TangSiyang2001/followers","following_url":"https://api.github.com/users/TangSiyang2001/following{/other_user}","gists_url":"https://api.github.com/users/TangSiyang2001/gists{/gist_id}","starred_url":"https://api.github.com/users/TangSiyang2001/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TangSiyang2001/subscriptions","organizations_url":"https://api.github.com/users/TangSiyang2001/orgs","repos_url":"https://api.github.com/users/TangSiyang2001/repos","events_url":"https://api.github.com/users/TangSiyang2001/events{/privacy}","received_events_url":"https://api.github.com/users/TangSiyang2001/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-05T06:11:46Z","updated_at":"2024-09-05T06:11:46Z","author_association":"CONTRIBUTOR","body":"@chenBright 收到，如果不紧急，我空闲时修复一下","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2330682188/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2330938072","html_url":"https://github.com/apache/brpc/issues/2676#issuecomment-2330938072","issue_url":"https://api.github.com/repos/apache/brpc/issues/2676","id":2330938072,"node_id":"IC_kwDOBhmkcs6K70rY","user":{"login":"wlleiiwang","id":6872942,"node_id":"MDQ6VXNlcjY4NzI5NDI=","avatar_url":"https://avatars.githubusercontent.com/u/6872942?v=4","gravatar_id":"","url":"https://api.github.com/users/wlleiiwang","html_url":"https://github.com/wlleiiwang","followers_url":"https://api.github.com/users/wlleiiwang/followers","following_url":"https://api.github.com/users/wlleiiwang/following{/other_user}","gists_url":"https://api.github.com/users/wlleiiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/wlleiiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wlleiiwang/subscriptions","organizations_url":"https://api.github.com/users/wlleiiwang/orgs","repos_url":"https://api.github.com/users/wlleiiwang/repos","events_url":"https://api.github.com/users/wlleiiwang/events{/privacy}","received_events_url":"https://api.github.com/users/wlleiiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-05T08:37:29Z","updated_at":"2024-09-05T08:37:29Z","author_association":"NONE","body":"We encountered the same problem, how was it solved?","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2330938072/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2330969022","html_url":"https://github.com/apache/brpc/issues/2756#issuecomment-2330969022","issue_url":"https://api.github.com/repos/apache/brpc/issues/2756","id":2330969022,"node_id":"IC_kwDOBhmkcs6K78O-","user":{"login":"fausturs","id":25004087,"node_id":"MDQ6VXNlcjI1MDA0MDg3","avatar_url":"https://avatars.githubusercontent.com/u/25004087?v=4","gravatar_id":"","url":"https://api.github.com/users/fausturs","html_url":"https://github.com/fausturs","followers_url":"https://api.github.com/users/fausturs/followers","following_url":"https://api.github.com/users/fausturs/following{/other_user}","gists_url":"https://api.github.com/users/fausturs/gists{/gist_id}","starred_url":"https://api.github.com/users/fausturs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fausturs/subscriptions","organizations_url":"https://api.github.com/users/fausturs/orgs","repos_url":"https://api.github.com/users/fausturs/repos","events_url":"https://api.github.com/users/fausturs/events{/privacy}","received_events_url":"https://api.github.com/users/fausturs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-05T08:52:53Z","updated_at":"2024-09-05T08:52:53Z","author_association":"NONE","body":"我提供一个个人的角度，可以讨论一下。\r\n\r\n因为新的keytable的策略，是return到一个pthread 的thread local的list中。但没办法保证的是，同一个keytable被borrow后，会被return到同一个pthread里。\r\n\r\n本来其实也没什么问题，只要等待足够时间，每个pthread中，就会create足够的keytable。但是可能，目前的一些task的调度策略，会使得pthread中的keytable数量像波浪一样震荡，使得keytable稳定的总数大大增加。\r\n\r\n可以看这么一个例子\r\n```c++\r\nvoid* print_log(void *) {\r\n    std::random_device rd;\r\n    std::mt19937 mt{rd()};\r\n    std::uniform_int_distribution<uint64_t> uid(0, 100000);\r\n\r\n    bthread_usleep(50000 + uid(mt));\r\n    LOG(INFO) << \"some log here xxx\";\r\n    return NULL;\r\n}\r\n\r\nclass GreeterImpl final : public Greeter {\r\n    void SayHello(google::protobuf::RpcController* controller, const HelloRequest* request, HelloReply* response, google::protobuf::Closure* done) override {\r\n        brpc::ClosureGuard done_guard(done);\r\n        brpc::Controller* cntl = static_cast<brpc::Controller*>(controller);\r\n\r\n        (void)print_log(NULL);\r\n\r\n        std::string message = \"Hello \" + request->name() + \"!\\n\";\r\n        response->set_message(message);\r\n    }\r\n};\r\n```\r\n![image](https://github.com/user-attachments/assets/1587951d-3a11-474a-ac96-f19f57b768e6)\r\n\r\n先做sleep，再进行LOG（相当于使用keytable），可以看到keytable的数量非常稳定。因为这里，每个pthread里，有一个keytable就可以了。\r\n\r\n\r\n但我们换一下位置\r\n```c++\r\nvoid* print_log(void *) {\r\n    std::random_device rd;\r\n    std::mt19937 mt{rd()};\r\n    std::uniform_int_distribution<uint64_t> uid(0, 100000);\r\n\r\n    LOG(INFO) << \"some log here xxx\";\r\n    bthread_usleep(50000 + uid(mt));\r\n    return NULL;\r\n}\r\n\r\nclass GreeterImpl final : public Greeter {\r\n    void SayHello(google::protobuf::RpcController* controller, const HelloRequest* request, HelloReply* response, google::protobuf::Closure* done) override {\r\n        brpc::ClosureGuard done_guard(done);\r\n        brpc::Controller* cntl = static_cast<brpc::Controller*>(controller);\r\n\r\n        (void)print_log(NULL);\r\n\r\n        std::string message = \"Hello \" + request->name() + \"!\\n\";\r\n        response->set_message(message);\r\n    }\r\n};\r\n```\r\n\r\n![image](https://github.com/user-attachments/assets/cae366b7-23d6-4bff-9701-9ac0fb99fe75)\r\n可以看到keytable有一个持续的增长。\r\n\r\n\r\n这里从统计意义上来说，增长可能会一直存在，因为当前worker的task sleep了（或者是等待某个锁），之后它好像会尝试从其他队列steal一个pendding的任务。随着这些任务都sleep（或者都block在某个锁上），这个work所在的pthread的存量keyTable会被持续消耗。而且这些keytable大概率不会被return到这个pthread了。\r\n\r\n所以，pthread中的keytables，不是维持在一个较为稳定的状态，而是有着潮水一样的涨落。随着borrow的失败，只能不停的new新的keytable\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2330969022/reactions","total_count":7,"+1":7,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2331079875","html_url":"https://github.com/apache/brpc/issues/2756#issuecomment-2331079875","issue_url":"https://api.github.com/repos/apache/brpc/issues/2756","id":2331079875,"node_id":"IC_kwDOBhmkcs6K8XTD","user":{"login":"MJY-HUST","id":52315061,"node_id":"MDQ6VXNlcjUyMzE1MDYx","avatar_url":"https://avatars.githubusercontent.com/u/52315061?v=4","gravatar_id":"","url":"https://api.github.com/users/MJY-HUST","html_url":"https://github.com/MJY-HUST","followers_url":"https://api.github.com/users/MJY-HUST/followers","following_url":"https://api.github.com/users/MJY-HUST/following{/other_user}","gists_url":"https://api.github.com/users/MJY-HUST/gists{/gist_id}","starred_url":"https://api.github.com/users/MJY-HUST/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MJY-HUST/subscriptions","organizations_url":"https://api.github.com/users/MJY-HUST/orgs","repos_url":"https://api.github.com/users/MJY-HUST/repos","events_url":"https://api.github.com/users/MJY-HUST/events{/privacy}","received_events_url":"https://api.github.com/users/MJY-HUST/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-05T09:46:17Z","updated_at":"2024-09-05T09:47:49Z","author_association":"CONTRIBUTOR","body":"是的，假设每个bthread都持有keytable的前提下，如果pendding的bthread数量过多(持续增长)，那么内存消耗是无法避免的。\r\n如果是因为task调度的不均衡(极端情况下一个task group只执行需要创建/获取keytable的任务，然后yield，这些任务最终在其他的task group中执行完成)，那么也会出现内存持续增长的情况。这种情况下的一种解决方法是为每个task group的 tls keytable list的长度设置一个阈值，一旦超过之后加锁批量返回给一个全局链表；而当borrow_keytable失败需要new keytable时，先查看全局链表中是否有keytable，再加锁批量取一批，不直接new keytable。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2331079875/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2331171396","html_url":"https://github.com/apache/brpc/issues/2756#issuecomment-2331171396","issue_url":"https://api.github.com/repos/apache/brpc/issues/2756","id":2331171396,"node_id":"IC_kwDOBhmkcs6K8tpE","user":{"login":"fausturs","id":25004087,"node_id":"MDQ6VXNlcjI1MDA0MDg3","avatar_url":"https://avatars.githubusercontent.com/u/25004087?v=4","gravatar_id":"","url":"https://api.github.com/users/fausturs","html_url":"https://github.com/fausturs","followers_url":"https://api.github.com/users/fausturs/followers","following_url":"https://api.github.com/users/fausturs/following{/other_user}","gists_url":"https://api.github.com/users/fausturs/gists{/gist_id}","starred_url":"https://api.github.com/users/fausturs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fausturs/subscriptions","organizations_url":"https://api.github.com/users/fausturs/orgs","repos_url":"https://api.github.com/users/fausturs/repos","events_url":"https://api.github.com/users/fausturs/events{/privacy}","received_events_url":"https://api.github.com/users/fausturs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-05T10:28:39Z","updated_at":"2024-09-05T10:28:39Z","author_association":"NONE","body":"这个解决方案看上去很棒。\r\n因为现有的borrow_keytable中，已经包含了对thread local 的keytable为空时，落到另一个全局的list（pool->free_keytables）中的逻辑。\r\n\r\n看上去，只需要对return_keytable逻辑进行一些调整。\r\n\r\n期待大佬们给出修复。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2331171396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2331669328","html_url":"https://github.com/apache/brpc/issues/2568#issuecomment-2331669328","issue_url":"https://api.github.com/repos/apache/brpc/issues/2568","id":2331669328,"node_id":"IC_kwDOBhmkcs6K-nNQ","user":{"login":"dengyingxu","id":46201669,"node_id":"MDQ6VXNlcjQ2MjAxNjY5","avatar_url":"https://avatars.githubusercontent.com/u/46201669?v=4","gravatar_id":"","url":"https://api.github.com/users/dengyingxu","html_url":"https://github.com/dengyingxu","followers_url":"https://api.github.com/users/dengyingxu/followers","following_url":"https://api.github.com/users/dengyingxu/following{/other_user}","gists_url":"https://api.github.com/users/dengyingxu/gists{/gist_id}","starred_url":"https://api.github.com/users/dengyingxu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dengyingxu/subscriptions","organizations_url":"https://api.github.com/users/dengyingxu/orgs","repos_url":"https://api.github.com/users/dengyingxu/repos","events_url":"https://api.github.com/users/dengyingxu/events{/privacy}","received_events_url":"https://api.github.com/users/dengyingxu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-05T13:20:48Z","updated_at":"2024-09-05T13:20:48Z","author_association":"NONE","body":"请问，哪个版本可以用protobuf 2.5？ 我只用bvar做监控上报，不需要新功能呢\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2331669328/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2332000192","html_url":"https://github.com/apache/brpc/issues/2568#issuecomment-2332000192","issue_url":"https://api.github.com/repos/apache/brpc/issues/2568","id":2332000192,"node_id":"IC_kwDOBhmkcs6K_3_A","user":{"login":"wasphin","id":1237906,"node_id":"MDQ6VXNlcjEyMzc5MDY=","avatar_url":"https://avatars.githubusercontent.com/u/1237906?v=4","gravatar_id":"","url":"https://api.github.com/users/wasphin","html_url":"https://github.com/wasphin","followers_url":"https://api.github.com/users/wasphin/followers","following_url":"https://api.github.com/users/wasphin/following{/other_user}","gists_url":"https://api.github.com/users/wasphin/gists{/gist_id}","starred_url":"https://api.github.com/users/wasphin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wasphin/subscriptions","organizations_url":"https://api.github.com/users/wasphin/orgs","repos_url":"https://api.github.com/users/wasphin/repos","events_url":"https://api.github.com/users/wasphin/events{/privacy}","received_events_url":"https://api.github.com/users/wasphin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-05T15:22:25Z","updated_at":"2024-09-05T15:22:25Z","author_association":"MEMBER","body":"> 请问，哪个版本可以用protobuf 2.5？ 我只用bvar做监控上报，不需要新功能呢\r\n\r\n可以试下 1.5 ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2332000192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2333053486","html_url":"https://github.com/apache/brpc/pull/2748#issuecomment-2333053486","issue_url":"https://api.github.com/repos/apache/brpc/issues/2748","id":2333053486,"node_id":"IC_kwDOBhmkcs6LD5Iu","user":{"login":"ketor","id":3497139,"node_id":"MDQ6VXNlcjM0OTcxMzk=","avatar_url":"https://avatars.githubusercontent.com/u/3497139?v=4","gravatar_id":"","url":"https://api.github.com/users/ketor","html_url":"https://github.com/ketor","followers_url":"https://api.github.com/users/ketor/followers","following_url":"https://api.github.com/users/ketor/following{/other_user}","gists_url":"https://api.github.com/users/ketor/gists{/gist_id}","starred_url":"https://api.github.com/users/ketor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ketor/subscriptions","organizations_url":"https://api.github.com/users/ketor/orgs","repos_url":"https://api.github.com/users/ketor/repos","events_url":"https://api.github.com/users/ketor/events{/privacy}","received_events_url":"https://api.github.com/users/ketor/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-06T02:12:09Z","updated_at":"2024-09-06T02:12:09Z","author_association":"CONTRIBUTOR","body":"> 跟#1031 的实现一样？\r\n> \r\n> > 这个实现性能有很大优化吧。这个无脑 butex 唤醒有问题吧？理想状态下应该有个 flag 标识有没有真的有 bthread 在等待。\r\n> \r\n> [这个问题](https://github.com/apache/brpc/pull/1031#issuecomment-831419766)解决了吗？\r\n\r\n好像是差不多的。看起来你已经在实现了，这个PR可以关掉了。现在在开发的项目是编译时给brpc打patch实现rwlock的，所以希望brpc能内置rwlock的实现。\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2333053486/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2334187168","html_url":"https://github.com/apache/brpc/pull/2754#issuecomment-2334187168","issue_url":"https://api.github.com/repos/apache/brpc/issues/2754","id":2334187168,"node_id":"IC_kwDOBhmkcs6LIN6g","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-06T14:28:57Z","updated_at":"2024-09-06T14:28:57Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2334187168/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2335107933","html_url":"https://github.com/apache/brpc/issues/2686#issuecomment-2335107933","issue_url":"https://api.github.com/repos/apache/brpc/issues/2686","id":2335107933,"node_id":"IC_kwDOBhmkcs6LLutd","user":{"login":"cfycyf","id":13246476,"node_id":"MDQ6VXNlcjEzMjQ2NDc2","avatar_url":"https://avatars.githubusercontent.com/u/13246476?v=4","gravatar_id":"","url":"https://api.github.com/users/cfycyf","html_url":"https://github.com/cfycyf","followers_url":"https://api.github.com/users/cfycyf/followers","following_url":"https://api.github.com/users/cfycyf/following{/other_user}","gists_url":"https://api.github.com/users/cfycyf/gists{/gist_id}","starred_url":"https://api.github.com/users/cfycyf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cfycyf/subscriptions","organizations_url":"https://api.github.com/users/cfycyf/orgs","repos_url":"https://api.github.com/users/cfycyf/repos","events_url":"https://api.github.com/users/cfycyf/events{/privacy}","received_events_url":"https://api.github.com/users/cfycyf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-07T07:50:03Z","updated_at":"2024-09-07T07:50:03Z","author_association":"NONE","body":"问题有解决吗？我这也出现了这个报错。\r\n场景是：\r\n1. brpc server在节点A\r\n2. brpc client 在节点B，定时向节点A发送请求，接收回复\r\n操作：\r\n1. 节点B ifconfig ethX down（ethX是brpc连接的网络的网卡）\r\n2. 等待30s左右，ifconfig ethX up，\r\n\r\n期望结果：\r\n网卡up后，1s左右能够正常brpc通信\r\n实际结果：\r\n有一半的概率 网卡up后的8-15s会出现“[E1008]Reached timeout=”，\r\n实际brpc server是正常的\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2335107933/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2337017539","html_url":"https://github.com/apache/brpc/pull/2754#issuecomment-2337017539","issue_url":"https://api.github.com/repos/apache/brpc/issues/2754","id":2337017539,"node_id":"IC_kwDOBhmkcs6LTA7D","user":{"login":"jenrryyou","id":4698734,"node_id":"MDQ6VXNlcjQ2OTg3MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/4698734?v=4","gravatar_id":"","url":"https://api.github.com/users/jenrryyou","html_url":"https://github.com/jenrryyou","followers_url":"https://api.github.com/users/jenrryyou/followers","following_url":"https://api.github.com/users/jenrryyou/following{/other_user}","gists_url":"https://api.github.com/users/jenrryyou/gists{/gist_id}","starred_url":"https://api.github.com/users/jenrryyou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jenrryyou/subscriptions","organizations_url":"https://api.github.com/users/jenrryyou/orgs","repos_url":"https://api.github.com/users/jenrryyou/repos","events_url":"https://api.github.com/users/jenrryyou/events{/privacy}","received_events_url":"https://api.github.com/users/jenrryyou/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-09T03:00:34Z","updated_at":"2024-09-09T03:00:34Z","author_association":"CONTRIBUTOR","body":"\r\n\r\n\r\n> LGTM\r\n\r\n有空帮忙点下merge，多谢","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2337017539/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2337056803","html_url":"https://github.com/apache/brpc/pull/2752#issuecomment-2337056803","issue_url":"https://api.github.com/repos/apache/brpc/issues/2752","id":2337056803,"node_id":"IC_kwDOBhmkcs6LTKgj","user":{"login":"ketor","id":3497139,"node_id":"MDQ6VXNlcjM0OTcxMzk=","avatar_url":"https://avatars.githubusercontent.com/u/3497139?v=4","gravatar_id":"","url":"https://api.github.com/users/ketor","html_url":"https://github.com/ketor","followers_url":"https://api.github.com/users/ketor/followers","following_url":"https://api.github.com/users/ketor/following{/other_user}","gists_url":"https://api.github.com/users/ketor/gists{/gist_id}","starred_url":"https://api.github.com/users/ketor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ketor/subscriptions","organizations_url":"https://api.github.com/users/ketor/orgs","repos_url":"https://api.github.com/users/ketor/repos","events_url":"https://api.github.com/users/ketor/events{/privacy}","received_events_url":"https://api.github.com/users/ketor/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-09T03:50:26Z","updated_at":"2024-09-09T03:50:26Z","author_association":"CONTRIBUTOR","body":"请问这个PR什么时候可以合入呢？ 对rwlock有需求，之前提个PR被反馈性能不好，希望尽快用上官方的实现","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2337056803/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2338266140","html_url":"https://github.com/apache/brpc/pull/2752#issuecomment-2338266140","issue_url":"https://api.github.com/repos/apache/brpc/issues/2752","id":2338266140,"node_id":"IC_kwDOBhmkcs6LXxwc","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-09T14:22:42Z","updated_at":"2024-09-09T14:22:42Z","author_association":"CONTRIBUTOR","body":"> 请问这个PR什么时候可以合入呢？ 对rwlock有需求，之前提个PR被反馈性能不好，希望尽快用上官方的实现\r\n\r\n没那么快。读写锁的核心功能已经实现了，还有一些需要优化的地方。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2338266140/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2342629105","html_url":"https://github.com/apache/brpc/issues/2761#issuecomment-2342629105","issue_url":"https://api.github.com/repos/apache/brpc/issues/2761","id":2342629105,"node_id":"IC_kwDOBhmkcs6Loa7x","user":{"login":"deadlinefen","id":117912096,"node_id":"U_kgDOBwcyIA","avatar_url":"https://avatars.githubusercontent.com/u/117912096?v=4","gravatar_id":"","url":"https://api.github.com/users/deadlinefen","html_url":"https://github.com/deadlinefen","followers_url":"https://api.github.com/users/deadlinefen/followers","following_url":"https://api.github.com/users/deadlinefen/following{/other_user}","gists_url":"https://api.github.com/users/deadlinefen/gists{/gist_id}","starred_url":"https://api.github.com/users/deadlinefen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deadlinefen/subscriptions","organizations_url":"https://api.github.com/users/deadlinefen/orgs","repos_url":"https://api.github.com/users/deadlinefen/repos","events_url":"https://api.github.com/users/deadlinefen/events{/privacy}","received_events_url":"https://api.github.com/users/deadlinefen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-11T05:02:45Z","updated_at":"2024-09-11T05:02:45Z","author_association":"NONE","body":"centos7上遇到了相同情况","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2342629105/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2346609519","html_url":"https://github.com/apache/brpc/issues/2039#issuecomment-2346609519","issue_url":"https://api.github.com/repos/apache/brpc/issues/2039","id":2346609519,"node_id":"IC_kwDOBhmkcs6L3mtv","user":{"login":"tiandikurong","id":48670105,"node_id":"MDQ6VXNlcjQ4NjcwMTA1","avatar_url":"https://avatars.githubusercontent.com/u/48670105?v=4","gravatar_id":"","url":"https://api.github.com/users/tiandikurong","html_url":"https://github.com/tiandikurong","followers_url":"https://api.github.com/users/tiandikurong/followers","following_url":"https://api.github.com/users/tiandikurong/following{/other_user}","gists_url":"https://api.github.com/users/tiandikurong/gists{/gist_id}","starred_url":"https://api.github.com/users/tiandikurong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tiandikurong/subscriptions","organizations_url":"https://api.github.com/users/tiandikurong/orgs","repos_url":"https://api.github.com/users/tiandikurong/repos","events_url":"https://api.github.com/users/tiandikurong/events{/privacy}","received_events_url":"https://api.github.com/users/tiandikurong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T15:27:22Z","updated_at":"2024-09-12T15:27:22Z","author_association":"NONE","body":"@zhaocc1106 我也遇到了此问题，请问怎么解决的？我的hive-2.3.9，hadoop-2.7.7","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2346609519/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2347330952","html_url":"https://github.com/apache/brpc/issues/2039#issuecomment-2347330952","issue_url":"https://api.github.com/repos/apache/brpc/issues/2039","id":2347330952,"node_id":"IC_kwDOBhmkcs6L6W2I","user":{"login":"zhaocc1106","id":26559935,"node_id":"MDQ6VXNlcjI2NTU5OTM1","avatar_url":"https://avatars.githubusercontent.com/u/26559935?v=4","gravatar_id":"","url":"https://api.github.com/users/zhaocc1106","html_url":"https://github.com/zhaocc1106","followers_url":"https://api.github.com/users/zhaocc1106/followers","following_url":"https://api.github.com/users/zhaocc1106/following{/other_user}","gists_url":"https://api.github.com/users/zhaocc1106/gists{/gist_id}","starred_url":"https://api.github.com/users/zhaocc1106/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhaocc1106/subscriptions","organizations_url":"https://api.github.com/users/zhaocc1106/orgs","repos_url":"https://api.github.com/users/zhaocc1106/repos","events_url":"https://api.github.com/users/zhaocc1106/events{/privacy}","received_events_url":"https://api.github.com/users/zhaocc1106/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-12T22:10:11Z","updated_at":"2024-09-12T22:10:11Z","author_association":"NONE","body":"> @zhaocc1106 我也遇到了此问题，请问怎么解决的？我的hive-2.3.9，hadoop-2.7.7\r\n\r\n试一下调大服务端参数idle_timeout_sec","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2347330952/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2347441588","html_url":"https://github.com/apache/brpc/issues/2039#issuecomment-2347441588","issue_url":"https://api.github.com/repos/apache/brpc/issues/2039","id":2347441588,"node_id":"IC_kwDOBhmkcs6L6x20","user":{"login":"tiandikurong","id":48670105,"node_id":"MDQ6VXNlcjQ4NjcwMTA1","avatar_url":"https://avatars.githubusercontent.com/u/48670105?v=4","gravatar_id":"","url":"https://api.github.com/users/tiandikurong","html_url":"https://github.com/tiandikurong","followers_url":"https://api.github.com/users/tiandikurong/followers","following_url":"https://api.github.com/users/tiandikurong/following{/other_user}","gists_url":"https://api.github.com/users/tiandikurong/gists{/gist_id}","starred_url":"https://api.github.com/users/tiandikurong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tiandikurong/subscriptions","organizations_url":"https://api.github.com/users/tiandikurong/orgs","repos_url":"https://api.github.com/users/tiandikurong/repos","events_url":"https://api.github.com/users/tiandikurong/events{/privacy}","received_events_url":"https://api.github.com/users/tiandikurong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-13T00:12:07Z","updated_at":"2024-09-13T00:12:07Z","author_association":"NONE","body":"> > @zhaocc1106 我也遇到了此问题，请问怎么解决的？我的hive-2.3.9，hadoop-2.7.7\r\n> \r\n> 试一下调大服务端参数idle_timeout_sec\r\n\r\n可不可以参考一下你的代码？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2347441588/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2347848547","html_url":"https://github.com/apache/brpc/issues/2039#issuecomment-2347848547","issue_url":"https://api.github.com/repos/apache/brpc/issues/2039","id":2347848547,"node_id":"IC_kwDOBhmkcs6L8VNj","user":{"login":"zhaocc1106","id":26559935,"node_id":"MDQ6VXNlcjI2NTU5OTM1","avatar_url":"https://avatars.githubusercontent.com/u/26559935?v=4","gravatar_id":"","url":"https://api.github.com/users/zhaocc1106","html_url":"https://github.com/zhaocc1106","followers_url":"https://api.github.com/users/zhaocc1106/followers","following_url":"https://api.github.com/users/zhaocc1106/following{/other_user}","gists_url":"https://api.github.com/users/zhaocc1106/gists{/gist_id}","starred_url":"https://api.github.com/users/zhaocc1106/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhaocc1106/subscriptions","organizations_url":"https://api.github.com/users/zhaocc1106/orgs","repos_url":"https://api.github.com/users/zhaocc1106/repos","events_url":"https://api.github.com/users/zhaocc1106/events{/privacy}","received_events_url":"https://api.github.com/users/zhaocc1106/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-13T01:29:20Z","updated_at":"2024-09-13T01:29:20Z","author_association":"NONE","body":"> > > @zhaocc1106 我也遇到了此问题，请问怎么解决的？我的hive-2.3.9，hadoop-2.7.7\r\n> > \r\n> > \r\n> > 试一下调大服务端参数idle_timeout_sec\r\n> \r\n> 可不可以参考一下你的代码？\r\n\r\nbrpc::Server        server;\r\n  brpc::ServerOptions options;\r\n  server.set_version(PREDICTOR_VERSION);\r\n\r\n  // Add predictor thrift service.\r\n  options.thrift_service = new PredictServiceImpl();\r\n  options.idle_timeout_sec = FLAGS_idle_timeout_sec;  // 调大","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2347848547/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2347912018","html_url":"https://github.com/apache/brpc/issues/2686#issuecomment-2347912018","issue_url":"https://api.github.com/repos/apache/brpc/issues/2686","id":2347912018,"node_id":"IC_kwDOBhmkcs6L8ktS","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-13T02:19:12Z","updated_at":"2024-09-13T02:20:13Z","author_association":"CONTRIBUTOR","body":"> 问题有解决吗？我这也出现了这个报错。 场景是：\r\n> \r\n> 1. brpc server在节点A\r\n> 2. brpc client 在节点B，定时向节点A发送请求，接收回复\r\n>    操作：\r\n> 3. 节点B ifconfig ethX down（ethX是brpc连接的网络的网卡）\r\n> 4. 等待30s左右，ifconfig ethX up，\r\n> \r\n> 期望结果： 网卡up后，1s左右能够正常brpc通信 实际结果： 有一半的概率 网卡up后的8-15s会出现“[E1008]Reached timeout=”， 实际brpc server是正常的\r\n\r\n可以试试[熔断策略](https://github.com/apache/brpc/blob/master/docs/cn/circuit_breaker.md#%E5%8F%AF%E9%80%89%E7%9A%84%E7%86%94%E6%96%AD%E7%AD%96%E7%95%A5)。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2347912018/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2348119216","html_url":"https://github.com/apache/brpc/issues/2761#issuecomment-2348119216","issue_url":"https://api.github.com/repos/apache/brpc/issues/2761","id":2348119216,"node_id":"IC_kwDOBhmkcs6L9XSw","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-13T06:16:49Z","updated_at":"2024-09-13T06:16:49Z","author_association":"CONTRIBUTOR","body":"protobuf版本的问题吧，换成protobuf 3试试","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2348119216/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2350926047","html_url":"https://github.com/apache/brpc/issues/2764#issuecomment-2350926047","issue_url":"https://api.github.com/repos/apache/brpc/issues/2764","id":2350926047,"node_id":"IC_kwDOBhmkcs6MIEjf","user":{"login":"wanghenshui","id":8872493,"node_id":"MDQ6VXNlcjg4NzI0OTM=","avatar_url":"https://avatars.githubusercontent.com/u/8872493?v=4","gravatar_id":"","url":"https://api.github.com/users/wanghenshui","html_url":"https://github.com/wanghenshui","followers_url":"https://api.github.com/users/wanghenshui/followers","following_url":"https://api.github.com/users/wanghenshui/following{/other_user}","gists_url":"https://api.github.com/users/wanghenshui/gists{/gist_id}","starred_url":"https://api.github.com/users/wanghenshui/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wanghenshui/subscriptions","organizations_url":"https://api.github.com/users/wanghenshui/orgs","repos_url":"https://api.github.com/users/wanghenshui/repos","events_url":"https://api.github.com/users/wanghenshui/events{/privacy}","received_events_url":"https://api.github.com/users/wanghenshui/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-14T09:16:57Z","updated_at":"2024-09-14T09:16:57Z","author_association":"NONE","body":"cmake/bazel创建项目引入\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nted&nbsp;mostly\r\n---\r\n***@***.***\r\nwww.github.com/wanghenshui\r\n\r\n---原始邮件---\r\n发件人: ***@***.***&gt;\r\n发送时间: 2024年9月14日(周六) 凌晨0:10\r\n收件人: ***@***.***&gt;;\r\n抄送: ***@***.***&gt;;\r\n主题: [apache/brpc] Question:How to use the brpc to build my own apps(如何使用brpc构建自己的程序) (Issue #2764)\r\n\r\n\r\n\r\n\r\n \r\n各位大佬我知道这个问题很trival，但是能力有限还是无法解决所以提了一个issue。\r\n \r\n请问如何利用brpc这个库构建一个自己的cpp，具体而言有什么方法可以做到像引入一个第三方头文件#include<xxx&gt;这样来调用brpc的方法。\r\n \r\n文档里给的都是编译使用给定的example，而似乎没有提及怎么使用brpc写自己的app，还请各位大佬指教。\r\n \r\n—\r\nReply to this email directly, view it on GitHub, or unsubscribe.\r\nYou are receiving this because you are subscribed to this thread.Message ID: ***@***.***&gt;","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2350926047/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2350928520","html_url":"https://github.com/apache/brpc/issues/2763#issuecomment-2350928520","issue_url":"https://api.github.com/repos/apache/brpc/issues/2763","id":2350928520,"node_id":"IC_kwDOBhmkcs6MIFKI","user":{"login":"wanghenshui","id":8872493,"node_id":"MDQ6VXNlcjg4NzI0OTM=","avatar_url":"https://avatars.githubusercontent.com/u/8872493?v=4","gravatar_id":"","url":"https://api.github.com/users/wanghenshui","html_url":"https://github.com/wanghenshui","followers_url":"https://api.github.com/users/wanghenshui/followers","following_url":"https://api.github.com/users/wanghenshui/following{/other_user}","gists_url":"https://api.github.com/users/wanghenshui/gists{/gist_id}","starred_url":"https://api.github.com/users/wanghenshui/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wanghenshui/subscriptions","organizations_url":"https://api.github.com/users/wanghenshui/orgs","repos_url":"https://api.github.com/users/wanghenshui/repos","events_url":"https://api.github.com/users/wanghenshui/events{/privacy}","received_events_url":"https://api.github.com/users/wanghenshui/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-14T09:26:15Z","updated_at":"2024-09-14T09:26:15Z","author_association":"NONE","body":"你说的是对的，提一个PR更好","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2350928520/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2353387300","html_url":"https://github.com/apache/brpc/issues/2762#issuecomment-2353387300","issue_url":"https://api.github.com/repos/apache/brpc/issues/2762","id":2353387300,"node_id":"IC_kwDOBhmkcs6MRdck","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-16T16:29:18Z","updated_at":"2024-09-16T16:29:18Z","author_association":"CONTRIBUTOR","body":"WriteRequest链表是个单向链表，反转就是为了从tail消费吧","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2353387300/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2354387920","html_url":"https://github.com/apache/brpc/issues/2762#issuecomment-2354387920","issue_url":"https://api.github.com/repos/apache/brpc/issues/2762","id":2354387920,"node_id":"IC_kwDOBhmkcs6MVRvQ","user":{"login":"kof02guy","id":19186563,"node_id":"MDQ6VXNlcjE5MTg2NTYz","avatar_url":"https://avatars.githubusercontent.com/u/19186563?v=4","gravatar_id":"","url":"https://api.github.com/users/kof02guy","html_url":"https://github.com/kof02guy","followers_url":"https://api.github.com/users/kof02guy/followers","following_url":"https://api.github.com/users/kof02guy/following{/other_user}","gists_url":"https://api.github.com/users/kof02guy/gists{/gist_id}","starred_url":"https://api.github.com/users/kof02guy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kof02guy/subscriptions","organizations_url":"https://api.github.com/users/kof02guy/orgs","repos_url":"https://api.github.com/users/kof02guy/repos","events_url":"https://api.github.com/users/kof02guy/events{/privacy}","received_events_url":"https://api.github.com/users/kof02guy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-17T02:35:12Z","updated_at":"2024-09-17T02:35:12Z","author_association":"NONE","body":"> WriteRequest链表是个单向链表，反转就是为了从tail消费吧\r\n\r\n谢谢。但我不太理解的是为什么一定要反转。如果producer在tail增加新的WriteRequest，consumer在head处消费，不需要反转链表。\r\n没能理解反转链表的好处在哪里呢？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2354387920/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2355389575","html_url":"https://github.com/apache/brpc/issues/2676#issuecomment-2355389575","issue_url":"https://api.github.com/repos/apache/brpc/issues/2676","id":2355389575,"node_id":"IC_kwDOBhmkcs6MZGSH","user":{"login":"dashjay","id":45532257,"node_id":"MDQ6VXNlcjQ1NTMyMjU3","avatar_url":"https://avatars.githubusercontent.com/u/45532257?v=4","gravatar_id":"","url":"https://api.github.com/users/dashjay","html_url":"https://github.com/dashjay","followers_url":"https://api.github.com/users/dashjay/followers","following_url":"https://api.github.com/users/dashjay/following{/other_user}","gists_url":"https://api.github.com/users/dashjay/gists{/gist_id}","starred_url":"https://api.github.com/users/dashjay/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dashjay/subscriptions","organizations_url":"https://api.github.com/users/dashjay/orgs","repos_url":"https://api.github.com/users/dashjay/repos","events_url":"https://api.github.com/users/dashjay/events{/privacy}","received_events_url":"https://api.github.com/users/dashjay/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-17T11:17:15Z","updated_at":"2024-09-17T11:17:15Z","author_association":"NONE","body":"> We encountered the same problem, how was it solved?\r\n\r\n@wlleiiwang Hi, finally we solve this problem by invoking the HTTP interface directly, brpc server implement http interface automaticly.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2355389575/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2356316256","html_url":"https://github.com/apache/brpc/issues/2733#issuecomment-2356316256","issue_url":"https://api.github.com/repos/apache/brpc/issues/2733","id":2356316256,"node_id":"IC_kwDOBhmkcs6Mcohg","user":{"login":"jiushun","id":57560588,"node_id":"MDQ6VXNlcjU3NTYwNTg4","avatar_url":"https://avatars.githubusercontent.com/u/57560588?v=4","gravatar_id":"","url":"https://api.github.com/users/jiushun","html_url":"https://github.com/jiushun","followers_url":"https://api.github.com/users/jiushun/followers","following_url":"https://api.github.com/users/jiushun/following{/other_user}","gists_url":"https://api.github.com/users/jiushun/gists{/gist_id}","starred_url":"https://api.github.com/users/jiushun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiushun/subscriptions","organizations_url":"https://api.github.com/users/jiushun/orgs","repos_url":"https://api.github.com/users/jiushun/repos","events_url":"https://api.github.com/users/jiushun/events{/privacy}","received_events_url":"https://api.github.com/users/jiushun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-17T15:50:29Z","updated_at":"2024-09-17T15:50:29Z","author_association":"NONE","body":"如何在rpc的实现方法里，等待 stream 关闭后再返回response呢","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2356316256/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2357889851","html_url":"https://github.com/apache/brpc/pull/2752#issuecomment-2357889851","issue_url":"https://api.github.com/repos/apache/brpc/issues/2752","id":2357889851,"node_id":"IC_kwDOBhmkcs6Mios7","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-18T08:57:10Z","updated_at":"2024-09-18T08:57:10Z","author_association":"CONTRIBUTOR","body":"@wwbmmm 再看看。整理了一下commit，分成三部分，review起来清晰一点。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2357889851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2358683588","html_url":"https://github.com/apache/brpc/issues/2761#issuecomment-2358683588","issue_url":"https://api.github.com/repos/apache/brpc/issues/2761","id":2358683588,"node_id":"IC_kwDOBhmkcs6MlqfE","user":{"login":"Lin807188583","id":34474632,"node_id":"MDQ6VXNlcjM0NDc0NjMy","avatar_url":"https://avatars.githubusercontent.com/u/34474632?v=4","gravatar_id":"","url":"https://api.github.com/users/Lin807188583","html_url":"https://github.com/Lin807188583","followers_url":"https://api.github.com/users/Lin807188583/followers","following_url":"https://api.github.com/users/Lin807188583/following{/other_user}","gists_url":"https://api.github.com/users/Lin807188583/gists{/gist_id}","starred_url":"https://api.github.com/users/Lin807188583/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Lin807188583/subscriptions","organizations_url":"https://api.github.com/users/Lin807188583/orgs","repos_url":"https://api.github.com/users/Lin807188583/repos","events_url":"https://api.github.com/users/Lin807188583/events{/privacy}","received_events_url":"https://api.github.com/users/Lin807188583/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-18T14:48:03Z","updated_at":"2024-09-18T14:48:03Z","author_association":"NONE","body":"应该是protobuf版本问题。\r\n这类问题我遇到过几次，最近一次是在arch上编译，系统默认安装的pb是v28，出现类似问题，后面源码更新到29还是类似报错，换到3.20.x才顺利编译","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2358683588/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2358717781","html_url":"https://github.com/apache/brpc/issues/2764#issuecomment-2358717781","issue_url":"https://api.github.com/repos/apache/brpc/issues/2764","id":2358717781,"node_id":"IC_kwDOBhmkcs6Mly1V","user":{"login":"Lin807188583","id":34474632,"node_id":"MDQ6VXNlcjM0NDc0NjMy","avatar_url":"https://avatars.githubusercontent.com/u/34474632?v=4","gravatar_id":"","url":"https://api.github.com/users/Lin807188583","html_url":"https://github.com/Lin807188583","followers_url":"https://api.github.com/users/Lin807188583/followers","following_url":"https://api.github.com/users/Lin807188583/following{/other_user}","gists_url":"https://api.github.com/users/Lin807188583/gists{/gist_id}","starred_url":"https://api.github.com/users/Lin807188583/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Lin807188583/subscriptions","organizations_url":"https://api.github.com/users/Lin807188583/orgs","repos_url":"https://api.github.com/users/Lin807188583/repos","events_url":"https://api.github.com/users/Lin807188583/events{/privacy}","received_events_url":"https://api.github.com/users/Lin807188583/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-18T15:00:17Z","updated_at":"2024-09-18T15:00:17Z","author_association":"NONE","body":"编译时加上target(cmake --build build --target install)会把对应库加到/usr/local。\r\n然后cmake里面要配置相关链接库 保证能找到\r\n然后自己的项目引入头文件(类似#include <brpc/server.h> ）这样就可以正常使用了。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2358717781/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2359943673","html_url":"https://github.com/apache/brpc/pull/2766#issuecomment-2359943673","issue_url":"https://api.github.com/repos/apache/brpc/issues/2766","id":2359943673,"node_id":"IC_kwDOBhmkcs6MqeH5","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-19T04:18:49Z","updated_at":"2024-09-19T04:18:49Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2359943673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2359945938","html_url":"https://github.com/apache/brpc/pull/2752#issuecomment-2359945938","issue_url":"https://api.github.com/repos/apache/brpc/issues/2752","id":2359945938,"node_id":"IC_kwDOBhmkcs6MqerS","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-19T04:21:22Z","updated_at":"2024-09-19T04:21:22Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2359945938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2359949873","html_url":"https://github.com/apache/brpc/pull/2765#issuecomment-2359949873","issue_url":"https://api.github.com/repos/apache/brpc/issues/2765","id":2359949873,"node_id":"IC_kwDOBhmkcs6Mqfox","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-19T04:26:01Z","updated_at":"2024-09-19T04:26:01Z","author_association":"CONTRIBUTOR","body":"这个是否会影响性能？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2359949873/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2360088284","html_url":"https://github.com/apache/brpc/issues/2756#issuecomment-2360088284","issue_url":"https://api.github.com/repos/apache/brpc/issues/2756","id":2360088284,"node_id":"IC_kwDOBhmkcs6MrBbc","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-19T06:20:46Z","updated_at":"2024-09-19T06:20:46Z","author_association":"CONTRIBUTOR","body":"@MJY-HUST 10月节后会发新版本，能赶上新版本修复这个问题吗？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2360088284/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2360732846","html_url":"https://github.com/apache/brpc/issues/2756#issuecomment-2360732846","issue_url":"https://api.github.com/repos/apache/brpc/issues/2756","id":2360732846,"node_id":"IC_kwDOBhmkcs6Mteyu","user":{"login":"MJY-HUST","id":52315061,"node_id":"MDQ6VXNlcjUyMzE1MDYx","avatar_url":"https://avatars.githubusercontent.com/u/52315061?v=4","gravatar_id":"","url":"https://api.github.com/users/MJY-HUST","html_url":"https://github.com/MJY-HUST","followers_url":"https://api.github.com/users/MJY-HUST/followers","following_url":"https://api.github.com/users/MJY-HUST/following{/other_user}","gists_url":"https://api.github.com/users/MJY-HUST/gists{/gist_id}","starred_url":"https://api.github.com/users/MJY-HUST/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MJY-HUST/subscriptions","organizations_url":"https://api.github.com/users/MJY-HUST/orgs","repos_url":"https://api.github.com/users/MJY-HUST/repos","events_url":"https://api.github.com/users/MJY-HUST/events{/privacy}","received_events_url":"https://api.github.com/users/MJY-HUST/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-19T11:31:08Z","updated_at":"2024-09-19T11:31:08Z","author_association":"CONTRIBUTOR","body":"> @MJY-HUST 10月节后会发新版本，能赶上新版本修复这个问题吗？\r\n周末修复一下，提个pr","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2360732846/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2362855628","html_url":"https://github.com/apache/brpc/pull/2760#issuecomment-2362855628","issue_url":"https://api.github.com/repos/apache/brpc/issues/2760","id":2362855628,"node_id":"IC_kwDOBhmkcs6M1lDM","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-20T05:29:15Z","updated_at":"2024-09-20T05:29:15Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2362855628/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2363096512","html_url":"https://github.com/apache/brpc/issues/2767#issuecomment-2363096512","issue_url":"https://api.github.com/repos/apache/brpc/issues/2767","id":2363096512,"node_id":"IC_kwDOBhmkcs6M2f3A","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-20T08:05:06Z","updated_at":"2024-09-20T08:05:06Z","author_association":"CONTRIBUTOR","body":"可以参考 #2307 ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2363096512/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2363842394","html_url":"https://github.com/apache/brpc/issues/2762#issuecomment-2363842394","issue_url":"https://api.github.com/repos/apache/brpc/issues/2762","id":2363842394,"node_id":"IC_kwDOBhmkcs6M5V9a","user":{"login":"oathdruid","id":17508029,"node_id":"MDQ6VXNlcjE3NTA4MDI5","avatar_url":"https://avatars.githubusercontent.com/u/17508029?v=4","gravatar_id":"","url":"https://api.github.com/users/oathdruid","html_url":"https://github.com/oathdruid","followers_url":"https://api.github.com/users/oathdruid/followers","following_url":"https://api.github.com/users/oathdruid/following{/other_user}","gists_url":"https://api.github.com/users/oathdruid/gists{/gist_id}","starred_url":"https://api.github.com/users/oathdruid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oathdruid/subscriptions","organizations_url":"https://api.github.com/users/oathdruid/orgs","repos_url":"https://api.github.com/users/oathdruid/repos","events_url":"https://api.github.com/users/oathdruid/events{/privacy}","received_events_url":"https://api.github.com/users/oathdruid/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-20T14:14:43Z","updated_at":"2024-09-20T14:14:43Z","author_association":"CONTRIBUTOR","body":"https://github.com/apache/brpc/blob/master/docs/cn/io.md\r\nhttps://github.com/apache/brpc/blob/master/docs/cn/execution_queue.md\r\nbrpc里的MPSC一般都是这个套路实现的，比如上面这俩都是，braft应该也是广泛用了这个模式；\r\n\r\n经典的双端链表队列实现是Michael&Scott的[non-blocking queue](https://www.cs.rochester.edu/~scott/papers/1996_PODC_queues.pdf)，boost里有一个对应的实现boost::lock_free:queue，不过入队动作依赖CAS，CAS本身在竞争比较大的时候有自旋问题其实并发能力一般；\r\n\r\nbrpc这个单端链表核心就是通过不会失败不会自旋的exchange替换CAS提升了并发能力；也因为是通过和当前队尾进行exchage动作来成为新的队尾，整体的单链指向就只能是队尾指向前序节点的逆序链表了；\r\n\r\n不过单纯看性能，基于数组的队列一般比链表类队列整体吞吐要高一些；所以这种链表类队列主要的优势点还是在于大量队列（例如作为接入层server承接大链接数）时不用预留数组长度，内存有节省；但是大链接数一般单链接上竞争就不强了，其实哪怕mutex保护的单链其实问题都不大；而有大并发的场景，因为链接数规模可控，可能进一步上数组队列的并发能力会更好（比如直接iouring之类的）；甚至大链接数场景，按链接组做聚簇之后上数组队列可能均衡意义上有时也强过链表队列；\r\n\r\n只看MPSC并发能力的话，比较久之前做过一个简易评测\r\n\r\nproducer=12 consumer=1 | qps | cpu | latency | qps | cpu | latency | qps | cpu | latency\r\n-- | -- | -- | -- | -- | -- | -- | -- | -- | --\r\nboost::lockfree::queue | 1W | 1.008 | 0.92 | 100W | 2.608 | 87.06 | 170W | 5.34 | 314\r\nbthread::ExecutionQueue | 1W | 0.015 | 6.03 | 100W | 0.566 | 405 | 347W | 1.53 | 1600\r\ntbb::concurrent_bounded_queue | 1W | 0.012 | 4.57 | 100W | 0.561 | 369 | 597W | 3.37 | 2400\r\nfolly::MPMCQueue | 1W | 0.012 | 3.88 | 100W | 0.314 | 144 | 895W | 3.21 | 534\r\nbabylon::ConcurrentExecutionQueue | 1W | 0.011 | 4.86 | 100W | 0.166 | 5.65 | 1511W | 8.8 | 3.1\r\nbabylon::ConcurrentBoundedQueue | 1W | 0.010 | 3.68 | 100W | 0.258 | 5.37 | 1690W | 7.4 | 2.9","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2363842394/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2364025313","html_url":"https://github.com/apache/brpc/issues/2762#issuecomment-2364025313","issue_url":"https://api.github.com/repos/apache/brpc/issues/2762","id":2364025313,"node_id":"IC_kwDOBhmkcs6M6Cnh","user":{"login":"kof02guy","id":19186563,"node_id":"MDQ6VXNlcjE5MTg2NTYz","avatar_url":"https://avatars.githubusercontent.com/u/19186563?v=4","gravatar_id":"","url":"https://api.github.com/users/kof02guy","html_url":"https://github.com/kof02guy","followers_url":"https://api.github.com/users/kof02guy/followers","following_url":"https://api.github.com/users/kof02guy/following{/other_user}","gists_url":"https://api.github.com/users/kof02guy/gists{/gist_id}","starred_url":"https://api.github.com/users/kof02guy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kof02guy/subscriptions","organizations_url":"https://api.github.com/users/kof02guy/orgs","repos_url":"https://api.github.com/users/kof02guy/repos","events_url":"https://api.github.com/users/kof02guy/events{/privacy}","received_events_url":"https://api.github.com/users/kof02guy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-20T15:45:56Z","updated_at":"2024-09-20T15:48:12Z","author_association":"NONE","body":"> https://github.com/apache/brpc/blob/master/docs/cn/io.md https://github.com/apache/brpc/blob/master/docs/cn/execution_queue.md brpc里的MPSC一般都是这个套路实现的，比如上面这俩都是，braft应该也是广泛用了这个模式；\r\n> \r\n> 经典的双端链表队列实现是Michael&Scott的[non-blocking queue](https://www.cs.rochester.edu/~scott/papers/1996_PODC_queues.pdf)，boost里有一个对应的实现boost::lock_free:queue，不过入队动作依赖CAS，CAS本身在竞争比较大的时候有自旋问题其实并发能力一般；\r\n> \r\n> brpc这个单端链表核心就是通过不会失败不会自旋的exchange替换CAS提升了并发能力；也因为是通过和当前队尾进行exchage动作来成为新的队尾，整体的单链指向就只能是队尾指向前序节点的逆序链表了；\r\n> \r\n> 不过单纯看性能，基于数组的队列一般比链表类队列整体吞吐要高一些；所以这种链表类队列主要的优势点还是在于大量队列（例如作为接入层server承接大链接数）时不用预留数组长度，内存有节省；但是大链接数一般单链接上竞争就不强了，其实哪怕mutex保护的单链其实问题都不大；而有大并发的场景，因为链接数规模可控，可能进一步上数组队列的并发能力会更好（比如直接iouring之类的）；甚至大链接数场景，按链接组做聚簇之后上数组队列可能均衡意义上有时也强过链表队列；\r\n> \r\n> 只看MPSC并发能力的话，比较久之前做过一个简易评测\r\n> \r\n> producer=12 consumer=1\tqps\tcpu\tlatency\tqps\tcpu\tlatency\tqps\tcpu\tlatency\r\n> boost::lockfree::queue\t1W\t1.008\t0.92\t100W\t2.608\t87.06\t170W\t5.34\t314\r\n> bthread::ExecutionQueue\t1W\t0.015\t6.03\t100W\t0.566\t405\t347W\t1.53\t1600\r\n> tbb::concurrent_bounded_queue\t1W\t0.012\t4.57\t100W\t0.561\t369\t597W\t3.37\t2400\r\n> folly::MPMCQueue\t1W\t0.012\t3.88\t100W\t0.314\t144\t895W\t3.21\t534\r\n> babylon::ConcurrentExecutionQueue\t1W\t0.011\t4.86\t100W\t0.166\t5.65\t1511W\t8.8\t3.1\r\n> babylon::ConcurrentBoundedQueue\t1W\t0.010\t3.68\t100W\t0.258\t5.37\t1690W\t7.4\t2.9\r\n\r\n@oathdruid 谢谢大佬详尽的解释，这个测试涵盖的实现真全！固定qps下 boost和babylon的实现延迟表现都不错啊看起来，极限吞吐的话也是babylon的更优。\r\n\r\n另外现在的实现看起来应该是去往_write_head进行插入：\r\n`    WriteRequest* const prev_head =\r\n        _write_head.exchange(req, butil::memory_order_release);\r\n    if (prev_head != NULL) {\r\n        req->next = prev_head;\r\n        return 0;\r\n    }`\r\n就我在想的是如果改为在tail插入例如：\r\n`WriteRequest* const prev_tail =\r\n        _write_tail.exchange(req, butil::memory_order_release);\r\n    if (prev_tail != NULL) {\r\n        prev_tail->next = req;\r\n        return 0;\r\n    }`\r\n是不是也能够利用exchange更优的并发能力？消费的话改为从head消费，也不用反转链表。不知道这样会有什么问题。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2364025313/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2364986602","html_url":"https://github.com/apache/brpc/issues/2762#issuecomment-2364986602","issue_url":"https://api.github.com/repos/apache/brpc/issues/2762","id":2364986602,"node_id":"IC_kwDOBhmkcs6M9tTq","user":{"login":"oathdruid","id":17508029,"node_id":"MDQ6VXNlcjE3NTA4MDI5","avatar_url":"https://avatars.githubusercontent.com/u/17508029?v=4","gravatar_id":"","url":"https://api.github.com/users/oathdruid","html_url":"https://github.com/oathdruid","followers_url":"https://api.github.com/users/oathdruid/followers","following_url":"https://api.github.com/users/oathdruid/following{/other_user}","gists_url":"https://api.github.com/users/oathdruid/gists{/gist_id}","starred_url":"https://api.github.com/users/oathdruid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oathdruid/subscriptions","organizations_url":"https://api.github.com/users/oathdruid/orgs","repos_url":"https://api.github.com/users/oathdruid/repos","events_url":"https://api.github.com/users/oathdruid/events{/privacy}","received_events_url":"https://api.github.com/users/oathdruid/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-21T04:03:53Z","updated_at":"2024-09-21T04:03:53Z","author_association":"CONTRIBUTOR","body":"目前消费动作应该也是用这个exchage摘除队尾的方式来做的。正向链消费感觉会有一些比较困难的点\r\n1、需要再留一个虚拟头，消费从虚拟头发起，也给队尾侧提供一个起点\r\n2、从虚拟头消费时候，不好确定终止点，遇到nullptr有可能是真的尾，也可能是正在准备链接的中间，需要读取当前尾部进行校验\r\n3、要做按需启动消费的话，不能单纯像现在依赖交换结果来判断，需要加一些额外的计数机制联合使用\r\n4、不过最麻烦的还是，正向接链表会导致，最后一个节点消费后，很难直接找到安全delete/recycle掉的时机（因为随时有可能有新的入队需要操作它的next, 逆向是不会有这种问题的）；那么就需要用虚拟头来交换尾节点，然后这个交换又可能交换到更新的插入者，还要再一次尝试跟随nullptr直到这个自己交换得到的尾部；\r\n\r\n初步这么理了下，感觉好像不是不能做，不过实现复杂度提升不少","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2364986602/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2365153573","html_url":"https://github.com/apache/brpc/pull/2768#issuecomment-2365153573","issue_url":"https://api.github.com/repos/apache/brpc/issues/2768","id":2365153573,"node_id":"IC_kwDOBhmkcs6M-WEl","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-21T11:29:27Z","updated_at":"2024-09-21T11:29:27Z","author_association":"CONTRIBUTOR","body":"补充一些单测吧，感觉现有的单测没有覆盖到新增的代码","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2365153573/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2365484149","html_url":"https://github.com/apache/brpc/pull/2765#issuecomment-2365484149","issue_url":"https://api.github.com/repos/apache/brpc/issues/2765","id":2365484149,"node_id":"IC_kwDOBhmkcs6M_mx1","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-22T06:01:12Z","updated_at":"2024-09-22T06:01:12Z","author_association":"CONTRIBUTOR","body":"> 这个是否会影响性能？\r\n\r\n之前的实现不会影响性能，但是没用原子变量没法保证正确性。现在用原子变量实现后会导致性能退化，MutexTest.performance测试发现锁的平均运行时间慢了50%左右，所以该功能只作为debug手段，默认关闭，只有编译bRPC库时定义了DEBUG_MUTEX宏才会开启该功能。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2365484149/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2365507617","html_url":"https://github.com/apache/brpc/pull/2765#issuecomment-2365507617","issue_url":"https://api.github.com/repos/apache/brpc/issues/2765","id":2365507617,"node_id":"IC_kwDOBhmkcs6M_sgh","user":{"login":"wwbmmm","id":3894631,"node_id":"MDQ6VXNlcjM4OTQ2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/3894631?v=4","gravatar_id":"","url":"https://api.github.com/users/wwbmmm","html_url":"https://github.com/wwbmmm","followers_url":"https://api.github.com/users/wwbmmm/followers","following_url":"https://api.github.com/users/wwbmmm/following{/other_user}","gists_url":"https://api.github.com/users/wwbmmm/gists{/gist_id}","starred_url":"https://api.github.com/users/wwbmmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wwbmmm/subscriptions","organizations_url":"https://api.github.com/users/wwbmmm/orgs","repos_url":"https://api.github.com/users/wwbmmm/repos","events_url":"https://api.github.com/users/wwbmmm/events{/privacy}","received_events_url":"https://api.github.com/users/wwbmmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-22T06:30:07Z","updated_at":"2024-09-22T06:30:07Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2365507617/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2367094731","html_url":"https://github.com/apache/brpc/pull/2734#issuecomment-2367094731","issue_url":"https://api.github.com/repos/apache/brpc/issues/2734","id":2367094731,"node_id":"IC_kwDOBhmkcs6NFv_L","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-23T01:33:06Z","updated_at":"2024-09-23T01:33:06Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2367094731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2367097259","html_url":"https://github.com/apache/brpc/pull/2737#issuecomment-2367097259","issue_url":"https://api.github.com/repos/apache/brpc/issues/2737","id":2367097259,"node_id":"IC_kwDOBhmkcs6NFwmr","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-23T01:37:12Z","updated_at":"2024-09-23T01:37:12Z","author_association":"CONTRIBUTOR","body":"这个PR还有别的问题吗 @chenBright ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2367097259/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2367183200","html_url":"https://github.com/apache/brpc/issues/2353#issuecomment-2367183200","issue_url":"https://api.github.com/repos/apache/brpc/issues/2353","id":2367183200,"node_id":"IC_kwDOBhmkcs6NGFlg","user":{"login":"feng-y","id":1547384,"node_id":"MDQ6VXNlcjE1NDczODQ=","avatar_url":"https://avatars.githubusercontent.com/u/1547384?v=4","gravatar_id":"","url":"https://api.github.com/users/feng-y","html_url":"https://github.com/feng-y","followers_url":"https://api.github.com/users/feng-y/followers","following_url":"https://api.github.com/users/feng-y/following{/other_user}","gists_url":"https://api.github.com/users/feng-y/gists{/gist_id}","starred_url":"https://api.github.com/users/feng-y/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/feng-y/subscriptions","organizations_url":"https://api.github.com/users/feng-y/orgs","repos_url":"https://api.github.com/users/feng-y/repos","events_url":"https://api.github.com/users/feng-y/events{/privacy}","received_events_url":"https://api.github.com/users/feng-y/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-23T03:48:35Z","updated_at":"2024-09-23T03:48:35Z","author_association":"NONE","body":"@dandyhuang 这个问题后面解决了么？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2367183200/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2367183505","html_url":"https://github.com/apache/brpc/issues/2738#issuecomment-2367183505","issue_url":"https://api.github.com/repos/apache/brpc/issues/2738","id":2367183505,"node_id":"IC_kwDOBhmkcs6NGFqR","user":{"login":"hpsdy","id":10432981,"node_id":"MDQ6VXNlcjEwNDMyOTgx","avatar_url":"https://avatars.githubusercontent.com/u/10432981?v=4","gravatar_id":"","url":"https://api.github.com/users/hpsdy","html_url":"https://github.com/hpsdy","followers_url":"https://api.github.com/users/hpsdy/followers","following_url":"https://api.github.com/users/hpsdy/following{/other_user}","gists_url":"https://api.github.com/users/hpsdy/gists{/gist_id}","starred_url":"https://api.github.com/users/hpsdy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hpsdy/subscriptions","organizations_url":"https://api.github.com/users/hpsdy/orgs","repos_url":"https://api.github.com/users/hpsdy/repos","events_url":"https://api.github.com/users/hpsdy/events{/privacy}","received_events_url":"https://api.github.com/users/hpsdy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-23T03:49:01Z","updated_at":"2024-09-23T03:53:54Z","author_association":"NONE","body":"进程没有退出，mem leak check是开了一个线程定时调用__lsan_do_recoverable_leak_check函数实现检查的。开启后，压测服务，一直会报这个case。不确定是asan检查机制识别不了这种内存释放，还是确实有泄漏。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2367183505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2367185228","html_url":"https://github.com/apache/brpc/issues/2353#issuecomment-2367185228","issue_url":"https://api.github.com/repos/apache/brpc/issues/2353","id":2367185228,"node_id":"IC_kwDOBhmkcs6NGGFM","user":{"login":"dandyhuang","id":12603054,"node_id":"MDQ6VXNlcjEyNjAzMDU0","avatar_url":"https://avatars.githubusercontent.com/u/12603054?v=4","gravatar_id":"","url":"https://api.github.com/users/dandyhuang","html_url":"https://github.com/dandyhuang","followers_url":"https://api.github.com/users/dandyhuang/followers","following_url":"https://api.github.com/users/dandyhuang/following{/other_user}","gists_url":"https://api.github.com/users/dandyhuang/gists{/gist_id}","starred_url":"https://api.github.com/users/dandyhuang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dandyhuang/subscriptions","organizations_url":"https://api.github.com/users/dandyhuang/orgs","repos_url":"https://api.github.com/users/dandyhuang/repos","events_url":"https://api.github.com/users/dandyhuang/events{/privacy}","received_events_url":"https://api.github.com/users/dandyhuang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-23T03:51:37Z","updated_at":"2024-09-23T03:51:37Z","author_association":"NONE","body":"> @dandyhuang 这个问题后面解决了么？\r\n\r\n没有，brpc的老问题了，说新版本修复了，但是好像还是很多人反馈有这个问题","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2367185228/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2372684184","html_url":"https://github.com/apache/brpc/issues/2769#issuecomment-2372684184","issue_url":"https://api.github.com/repos/apache/brpc/issues/2769","id":2372684184,"node_id":"IC_kwDOBhmkcs6NbEmY","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-25T01:26:29Z","updated_at":"2024-09-25T01:26:29Z","author_association":"CONTRIBUTOR","body":"那只能自己收到请求做一个排序，再一个一个处理了。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2372684184/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2372753814","html_url":"https://github.com/apache/brpc/issues/2769#issuecomment-2372753814","issue_url":"https://api.github.com/repos/apache/brpc/issues/2769","id":2372753814,"node_id":"IC_kwDOBhmkcs6NbVmW","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-25T02:20:12Z","updated_at":"2024-09-25T02:20:12Z","author_association":"CONTRIBUTOR","body":"[Streaming RPC](https://github.com/apache/brpc/blob/master/docs/cn/streaming_rpc.md)可以保证顺序。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2372753814/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2372764411","html_url":"https://github.com/apache/brpc/issues/2769#issuecomment-2372764411","issue_url":"https://api.github.com/repos/apache/brpc/issues/2769","id":2372764411,"node_id":"IC_kwDOBhmkcs6NbYL7","user":{"login":"cheungsuifai","id":10709061,"node_id":"MDQ6VXNlcjEwNzA5MDYx","avatar_url":"https://avatars.githubusercontent.com/u/10709061?v=4","gravatar_id":"","url":"https://api.github.com/users/cheungsuifai","html_url":"https://github.com/cheungsuifai","followers_url":"https://api.github.com/users/cheungsuifai/followers","following_url":"https://api.github.com/users/cheungsuifai/following{/other_user}","gists_url":"https://api.github.com/users/cheungsuifai/gists{/gist_id}","starred_url":"https://api.github.com/users/cheungsuifai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cheungsuifai/subscriptions","organizations_url":"https://api.github.com/users/cheungsuifai/orgs","repos_url":"https://api.github.com/users/cheungsuifai/repos","events_url":"https://api.github.com/users/cheungsuifai/events{/privacy}","received_events_url":"https://api.github.com/users/cheungsuifai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-25T02:30:42Z","updated_at":"2024-09-25T02:43:01Z","author_association":"NONE","body":"> [Streaming RPC](https://github.com/apache/brpc/blob/master/docs/cn/streaming_rpc.md)可以保证顺序。\r\n\r\n谢谢你的回复。\r\n\r\n但streaming的机制似乎是发起一个RPC调用，RPC后续数据使用stream传输，它能保证stream中传输的数据是有序的。但它并不适用于多个RPC（如果有多个RPC，会有多个相互独立的stream）\r\n\r\n我现在的场景是client会发起多个不同的rpc的请求，希望server能发送顺序来处理。这样似乎stream并不合适？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2372764411/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2372815810","html_url":"https://github.com/apache/brpc/issues/2769#issuecomment-2372815810","issue_url":"https://api.github.com/repos/apache/brpc/issues/2769","id":2372815810,"node_id":"IC_kwDOBhmkcs6NbkvC","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-25T03:10:27Z","updated_at":"2024-09-25T03:10:27Z","author_association":"CONTRIBUTOR","body":"顺序要求是针对不同client、不同server接口还是两者都有？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2372815810/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2372826534","html_url":"https://github.com/apache/brpc/issues/2769#issuecomment-2372826534","issue_url":"https://api.github.com/repos/apache/brpc/issues/2769","id":2372826534,"node_id":"IC_kwDOBhmkcs6NbnWm","user":{"login":"cheungsuifai","id":10709061,"node_id":"MDQ6VXNlcjEwNzA5MDYx","avatar_url":"https://avatars.githubusercontent.com/u/10709061?v=4","gravatar_id":"","url":"https://api.github.com/users/cheungsuifai","html_url":"https://github.com/cheungsuifai","followers_url":"https://api.github.com/users/cheungsuifai/followers","following_url":"https://api.github.com/users/cheungsuifai/following{/other_user}","gists_url":"https://api.github.com/users/cheungsuifai/gists{/gist_id}","starred_url":"https://api.github.com/users/cheungsuifai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cheungsuifai/subscriptions","organizations_url":"https://api.github.com/users/cheungsuifai/orgs","repos_url":"https://api.github.com/users/cheungsuifai/repos","events_url":"https://api.github.com/users/cheungsuifai/events{/privacy}","received_events_url":"https://api.github.com/users/cheungsuifai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-25T03:20:43Z","updated_at":"2024-09-25T03:20:43Z","author_association":"NONE","body":"> 顺序要求是针对不同client、不同server接口还是两者都有？\r\n\r\n针对同一个client的不同的server接口\r\n\r\n例如现在有两个client（Client A，Client B）发送一系列的RPC请求。\r\nClient A发送顺序是 A1，A2，A3\r\nClient B发送顺序是 B1，B2，B3\r\n\r\nServer多个线程收到的请求的时间顺序是A1，B1，B2，A3，B3，A2。\r\n\r\n其中Client B的请求顺序是OK，按序执行即可；\r\n而Client A的请求是乱序的（A1，A3，A2），我希望可以Server在执行的时候能按（A1，A2，A3）的顺序执行。\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2372826534/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2372840263","html_url":"https://github.com/apache/brpc/issues/2769#issuecomment-2372840263","issue_url":"https://api.github.com/repos/apache/brpc/issues/2769","id":2372840263,"node_id":"IC_kwDOBhmkcs6NbqtH","user":{"login":"chenBright","id":12249635,"node_id":"MDQ6VXNlcjEyMjQ5NjM1","avatar_url":"https://avatars.githubusercontent.com/u/12249635?v=4","gravatar_id":"","url":"https://api.github.com/users/chenBright","html_url":"https://github.com/chenBright","followers_url":"https://api.github.com/users/chenBright/followers","following_url":"https://api.github.com/users/chenBright/following{/other_user}","gists_url":"https://api.github.com/users/chenBright/gists{/gist_id}","starred_url":"https://api.github.com/users/chenBright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenBright/subscriptions","organizations_url":"https://api.github.com/users/chenBright/orgs","repos_url":"https://api.github.com/users/chenBright/repos","events_url":"https://api.github.com/users/chenBright/events{/privacy}","received_events_url":"https://api.github.com/users/chenBright/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-25T03:34:21Z","updated_at":"2024-09-25T03:34:21Z","author_association":"CONTRIBUTOR","body":"同一个client用一个stream发 A1，A2，A3，server顺序处理，根据请求的特点分发到不同接口，就可以满足需求了吧？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/2372840263/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]