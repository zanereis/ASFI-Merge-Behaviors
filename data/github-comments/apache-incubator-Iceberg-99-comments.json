[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872533382","html_url":"https://github.com/apache/iceberg/pull/2694#issuecomment-872533382","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2694","id":872533382,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MjUzMzM4Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-01T20:34:23Z","updated_at":"2021-07-01T20:34:23Z","author_association":"CONTRIBUTOR","body":"Closing this. It was fixed in #2759.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872533382/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872537194","html_url":"https://github.com/apache/iceberg/pull/2766#issuecomment-872537194","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2766","id":872537194,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MjUzNzE5NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-01T20:42:03Z","updated_at":"2021-07-01T20:42:03Z","author_association":"CONTRIBUTOR","body":"Thanks, @nastra!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872537194/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872542309","html_url":"https://github.com/apache/iceberg/pull/2752#issuecomment-872542309","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2752","id":872542309,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MjU0MjMwOQ==","user":{"login":"daksha121","id":3859303,"node_id":"MDQ6VXNlcjM4NTkzMDM=","avatar_url":"https://avatars.githubusercontent.com/u/3859303?v=4","gravatar_id":"","url":"https://api.github.com/users/daksha121","html_url":"https://github.com/daksha121","followers_url":"https://api.github.com/users/daksha121/followers","following_url":"https://api.github.com/users/daksha121/following{/other_user}","gists_url":"https://api.github.com/users/daksha121/gists{/gist_id}","starred_url":"https://api.github.com/users/daksha121/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/daksha121/subscriptions","organizations_url":"https://api.github.com/users/daksha121/orgs","repos_url":"https://api.github.com/users/daksha121/repos","events_url":"https://api.github.com/users/daksha121/events{/privacy}","received_events_url":"https://api.github.com/users/daksha121/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-01T20:51:59Z","updated_at":"2021-07-01T20:51:59Z","author_association":"CONTRIBUTOR","body":"Addressed your comments, @rdblue this is ready for another pass. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872542309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872544833","html_url":"https://github.com/apache/iceberg/pull/2756#issuecomment-872544833","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2756","id":872544833,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MjU0NDgzMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-01T20:57:04Z","updated_at":"2021-07-01T20:57:04Z","author_association":"CONTRIBUTOR","body":"@nastra, I think that's fine. I'm debating whether I think it's worth the change, but if you think it is valuable then let's go ahead and do it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872544833/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872629093","html_url":"https://github.com/apache/iceberg/pull/2763#issuecomment-872629093","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2763","id":872629093,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MjYyOTA5Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T00:26:05Z","updated_at":"2021-07-02T00:26:05Z","author_association":"CONTRIBUTOR","body":"Thanks @karuppayya!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872629093/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872632160","html_url":"https://github.com/apache/iceberg/pull/2754#issuecomment-872632160","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2754","id":872632160,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MjYzMjE2MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T00:34:59Z","updated_at":"2021-07-02T00:34:59Z","author_association":"CONTRIBUTOR","body":"@jshmchenxi, it sounds like the problem might be that the UGI in your environment changes based on the incoming request, but the thread pool that handles planning keeps its initial user information?\r\n\r\nI'm suspicious that the solution is to add Hadoop-specific UGI code everywhere that Iceberg uses a thread pool. This solution doesn't seem sustainable to me. One easy solution is to disable the thread pool in your environment by setting `iceberg.scan.plan-in-worker-pool=false` in Java's system properties. If you want to use a thread pool, we could update the `TableScan` interface and Spark to manage thread pools at a session level.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872632160/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872663785","html_url":"https://github.com/apache/iceberg/issues/2744#issuecomment-872663785","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2744","id":872663785,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MjY2Mzc4NQ==","user":{"login":"haormj","id":18750674,"node_id":"MDQ6VXNlcjE4NzUwNjc0","avatar_url":"https://avatars.githubusercontent.com/u/18750674?v=4","gravatar_id":"","url":"https://api.github.com/users/haormj","html_url":"https://github.com/haormj","followers_url":"https://api.github.com/users/haormj/followers","following_url":"https://api.github.com/users/haormj/following{/other_user}","gists_url":"https://api.github.com/users/haormj/gists{/gist_id}","starred_url":"https://api.github.com/users/haormj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haormj/subscriptions","organizations_url":"https://api.github.com/users/haormj/orgs","repos_url":"https://api.github.com/users/haormj/repos","events_url":"https://api.github.com/users/haormj/events{/privacy}","received_events_url":"https://api.github.com/users/haormj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T02:18:04Z","updated_at":"2021-07-02T02:18:04Z","author_association":"CONTRIBUTOR","body":"@ismailsimsek thanks for you reply :-)\r\n\r\n1. about MySQL: I will create table by myself with your suggestion, and choose a reasonable length in our scene\r\n2. about table name: I have corrected it and pr [here](https://github.com/apache/iceberg/pull/2778)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872663785/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872669254","html_url":"https://github.com/apache/iceberg/pull/2778#issuecomment-872669254","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2778","id":872669254,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MjY2OTI1NA==","user":{"login":"haormj","id":18750674,"node_id":"MDQ6VXNlcjE4NzUwNjc0","avatar_url":"https://avatars.githubusercontent.com/u/18750674?v=4","gravatar_id":"","url":"https://api.github.com/users/haormj","html_url":"https://github.com/haormj","followers_url":"https://api.github.com/users/haormj/followers","following_url":"https://api.github.com/users/haormj/following{/other_user}","gists_url":"https://api.github.com/users/haormj/gists{/gist_id}","starred_url":"https://api.github.com/users/haormj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haormj/subscriptions","organizations_url":"https://api.github.com/users/haormj/orgs","repos_url":"https://api.github.com/users/haormj/repos","events_url":"https://api.github.com/users/haormj/events{/privacy}","received_events_url":"https://api.github.com/users/haormj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T02:35:17Z","updated_at":"2021-07-02T02:35:17Z","author_association":"CONTRIBUTOR","body":"@ismailsimsek please review :-)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872669254/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872675546","html_url":"https://github.com/apache/iceberg/pull/1996#issuecomment-872675546","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1996","id":872675546,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MjY3NTU0Ng==","user":{"login":"wg1026688210","id":14267759,"node_id":"MDQ6VXNlcjE0MjY3NzU5","avatar_url":"https://avatars.githubusercontent.com/u/14267759?v=4","gravatar_id":"","url":"https://api.github.com/users/wg1026688210","html_url":"https://github.com/wg1026688210","followers_url":"https://api.github.com/users/wg1026688210/followers","following_url":"https://api.github.com/users/wg1026688210/following{/other_user}","gists_url":"https://api.github.com/users/wg1026688210/gists{/gist_id}","starred_url":"https://api.github.com/users/wg1026688210/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wg1026688210/subscriptions","organizations_url":"https://api.github.com/users/wg1026688210/orgs","repos_url":"https://api.github.com/users/wg1026688210/repos","events_url":"https://api.github.com/users/wg1026688210/events{/privacy}","received_events_url":"https://api.github.com/users/wg1026688210/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T02:57:26Z","updated_at":"2021-07-02T02:58:48Z","author_association":"CONTRIBUTOR","body":"Whether the pr can be merge .   In one of our scenarios, the binlog of tidb has no before_update data before after_update. We hope flink can help us to do it  @rdblue @openinx ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872675546/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872746858","html_url":"https://github.com/apache/iceberg/pull/2778#issuecomment-872746858","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2778","id":872746858,"node_id":"MDEyOklzc3VlQ29tbWVudDg3Mjc0Njg1OA==","user":{"login":"ismailsimsek","id":6005685,"node_id":"MDQ6VXNlcjYwMDU2ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6005685?v=4","gravatar_id":"","url":"https://api.github.com/users/ismailsimsek","html_url":"https://github.com/ismailsimsek","followers_url":"https://api.github.com/users/ismailsimsek/followers","following_url":"https://api.github.com/users/ismailsimsek/following{/other_user}","gists_url":"https://api.github.com/users/ismailsimsek/gists{/gist_id}","starred_url":"https://api.github.com/users/ismailsimsek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ismailsimsek/subscriptions","organizations_url":"https://api.github.com/users/ismailsimsek/orgs","repos_url":"https://api.github.com/users/ismailsimsek/repos","events_url":"https://api.github.com/users/ismailsimsek/events{/privacy}","received_events_url":"https://api.github.com/users/ismailsimsek/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T06:16:58Z","updated_at":"2021-07-02T06:16:58Z","author_association":"CONTRIBUTOR","body":"looks good, do you want o add second fix too ? \r\nchanging varchar size like below? \r\n\r\n```\r\n      \"CREATE TABLE \" + CATALOG_TABLE_NAME +\r\n          \"(\" +\r\n          CATALOG_NAME + \" VARCHAR(255) NOT NULL,\" +\r\n          TABLE_NAMESPACE + \" VARCHAR(255) NOT NULL,\" +\r\n          TABLE_NAME + \" VARCHAR(255) NOT NULL,\" +\r\n          METADATA_LOCATION + \" VARCHAR(5500),\" +\r\n          PREVIOUS_METADATA_LOCATION + \" VARCHAR(5500),\" +\r\n          \"PRIMARY KEY (\" + CATALOG_NAME + \", \" + TABLE_NAMESPACE + \", \" + TABLE_NAME + \")\" +\r\n          \")\";\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872746858/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872748206","html_url":"https://github.com/apache/iceberg/pull/2756#issuecomment-872748206","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2756","id":872748206,"node_id":"MDEyOklzc3VlQ29tbWVudDg3Mjc0ODIwNg==","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T06:19:51Z","updated_at":"2021-07-02T07:13:50Z","author_association":"CONTRIBUTOR","body":"I believe it's an improvement making those changes. I'll go ahead and push the changes to this branch as a separate commit","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872748206/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872796858","html_url":"https://github.com/apache/iceberg/pull/2240#issuecomment-872796858","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2240","id":872796858,"node_id":"MDEyOklzc3VlQ29tbWVudDg3Mjc5Njg1OA==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T07:53:01Z","updated_at":"2021-07-02T07:53:01Z","author_association":"COLLABORATOR","body":"Thanks @aokolnychyi! rebased","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872796858/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872946925","html_url":"https://github.com/apache/iceberg/pull/2767#issuecomment-872946925","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2767","id":872946925,"node_id":"MDEyOklzc3VlQ29tbWVudDg3Mjk0NjkyNQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T12:04:59Z","updated_at":"2021-07-02T12:04:59Z","author_association":"MEMBER","body":"Thanks @nastra for writing and @kbendick for reviewing!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872946925/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872952218","html_url":"https://github.com/apache/iceberg/pull/2778#issuecomment-872952218","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2778","id":872952218,"node_id":"MDEyOklzc3VlQ29tbWVudDg3Mjk1MjIxOA==","user":{"login":"haormj","id":18750674,"node_id":"MDQ6VXNlcjE4NzUwNjc0","avatar_url":"https://avatars.githubusercontent.com/u/18750674?v=4","gravatar_id":"","url":"https://api.github.com/users/haormj","html_url":"https://github.com/haormj","followers_url":"https://api.github.com/users/haormj/followers","following_url":"https://api.github.com/users/haormj/following{/other_user}","gists_url":"https://api.github.com/users/haormj/gists{/gist_id}","starred_url":"https://api.github.com/users/haormj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haormj/subscriptions","organizations_url":"https://api.github.com/users/haormj/orgs","repos_url":"https://api.github.com/users/haormj/repos","events_url":"https://api.github.com/users/haormj/events{/privacy}","received_events_url":"https://api.github.com/users/haormj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T12:13:41Z","updated_at":"2021-07-02T12:13:41Z","author_association":"CONTRIBUTOR","body":"@ismailsimsek of course :-)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/872952218/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873086910","html_url":"https://github.com/apache/iceberg/issues/2517#issuecomment-873086910","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2517","id":873086910,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MzA4NjkxMA==","user":{"login":"nvitucci","id":1252064,"node_id":"MDQ6VXNlcjEyNTIwNjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1252064?v=4","gravatar_id":"","url":"https://api.github.com/users/nvitucci","html_url":"https://github.com/nvitucci","followers_url":"https://api.github.com/users/nvitucci/followers","following_url":"https://api.github.com/users/nvitucci/following{/other_user}","gists_url":"https://api.github.com/users/nvitucci/gists{/gist_id}","starred_url":"https://api.github.com/users/nvitucci/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nvitucci/subscriptions","organizations_url":"https://api.github.com/users/nvitucci/orgs","repos_url":"https://api.github.com/users/nvitucci/repos","events_url":"https://api.github.com/users/nvitucci/events{/privacy}","received_events_url":"https://api.github.com/users/nvitucci/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T15:36:21Z","updated_at":"2021-07-02T15:36:21Z","author_association":"NONE","body":"> Have you made any progress with this @nvitucci? We are also interested to see if the filter is actually being used for partition pruning.\r\n\r\nI have created [a draft PR](https://github.com/apache/iceberg/pull/2780) to start discussing a potential solution. Please can you take a look too?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873086910/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873091125","html_url":"https://github.com/apache/iceberg/pull/2780#issuecomment-873091125","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2780","id":873091125,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MzA5MTEyNQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T15:43:31Z","updated_at":"2021-07-02T15:52:52Z","author_association":"MEMBER","body":"This is adding every file touched to the description which is probably too much (since this could be in the thousands of files). One of the big issues here is this description will sit on the Spark Driver for a while so it's a pretty large chunk of memory. Maybe just a summary would be sufficient? Reading Z Manifests - X files from Y partitions?\r\n\r\nI think it's a little dangerous to run planning in description since that may be called even when the plan isn't executed and since it becomes caching in this implementation it may have issues if a user runs \"Explain\" then adds more clauses or something. For a long planned query that also means calling \"explain\" ends up being a rather expensive operation.\r\n\r\nThat said I would really like to have more information visible so let's keep thinking on this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873091125/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873240917","html_url":"https://github.com/apache/iceberg/pull/2781#issuecomment-873240917","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2781","id":873240917,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MzI0MDkxNw==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T20:26:57Z","updated_at":"2021-07-08T00:53:53Z","author_association":"CONTRIBUTOR","body":"I tested this here in my fork: https://github.com/kbendick/iceberg/pull/41/files","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873240917/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873251120","html_url":"https://github.com/apache/iceberg/pull/2780#issuecomment-873251120","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2780","id":873251120,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MzI1MTEyMA==","user":{"login":"nvitucci","id":1252064,"node_id":"MDQ6VXNlcjEyNTIwNjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1252064?v=4","gravatar_id":"","url":"https://api.github.com/users/nvitucci","html_url":"https://github.com/nvitucci","followers_url":"https://api.github.com/users/nvitucci/followers","following_url":"https://api.github.com/users/nvitucci/following{/other_user}","gists_url":"https://api.github.com/users/nvitucci/gists{/gist_id}","starred_url":"https://api.github.com/users/nvitucci/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nvitucci/subscriptions","organizations_url":"https://api.github.com/users/nvitucci/orgs","repos_url":"https://api.github.com/users/nvitucci/repos","events_url":"https://api.github.com/users/nvitucci/events{/privacy}","received_events_url":"https://api.github.com/users/nvitucci/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T20:52:57Z","updated_at":"2021-07-02T20:52:57Z","author_association":"NONE","body":"> This is adding every file touched to the description which is probably too much (since this could be in the thousands of files). One of the big issues here is this description will sit on the Spark Driver for a while so it's a pretty large chunk of memory. Maybe just a summary would be sufficient? Reading Z Manifests - X files from Y partitions?\r\n\r\nI agree. With this change, my aim is to have means to show that the partition filters are actually being used. I'll try to figure out the minimal amount of information that can still be useful with this respect.\r\n\r\n> I think it's a little dangerous to run planning in description since that may be called even when the plan isn't executed and since it becomes caching in this implementation it may have issues if a user runs \"Explain\" then adds more clauses or something. For a long planned query that also means calling \"explain\" ends up being a rather expensive operation.\r\n\r\nYes, this is my main doubt. I've changed the implementation to use the lazy `tasks` variable in the extending classes. I'm not quite sure this will make a lot of difference, but could this be going in the right direction?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873251120/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873303009","html_url":"https://github.com/apache/iceberg/issues/2765#issuecomment-873303009","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2765","id":873303009,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MzMwMzAwOQ==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-02T23:31:26Z","updated_at":"2021-07-02T23:32:50Z","author_association":"CONTRIBUTOR","body":"Can you please provide the Spark and Iceberg versions you're using, as well as the table settings (such as file format)?\r\n\r\nI think this might be due to a way that Spark pushes down filters (and not always correctly handling typed conversions), but without version info it's hard to say much.\r\n\r\nIf you could also please provide the full query plan / explain, that would be great.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873303009/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873335361","html_url":"https://github.com/apache/iceberg/pull/2754#issuecomment-873335361","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2754","id":873335361,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MzMzNTM2MQ==","user":{"login":"jshmchenxi","id":11854435,"node_id":"MDQ6VXNlcjExODU0NDM1","avatar_url":"https://avatars.githubusercontent.com/u/11854435?v=4","gravatar_id":"","url":"https://api.github.com/users/jshmchenxi","html_url":"https://github.com/jshmchenxi","followers_url":"https://api.github.com/users/jshmchenxi/followers","following_url":"https://api.github.com/users/jshmchenxi/following{/other_user}","gists_url":"https://api.github.com/users/jshmchenxi/gists{/gist_id}","starred_url":"https://api.github.com/users/jshmchenxi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jshmchenxi/subscriptions","organizations_url":"https://api.github.com/users/jshmchenxi/orgs","repos_url":"https://api.github.com/users/jshmchenxi/repos","events_url":"https://api.github.com/users/jshmchenxi/events{/privacy}","received_events_url":"https://api.github.com/users/jshmchenxi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-03T03:12:46Z","updated_at":"2021-07-03T03:12:46Z","author_association":"CONTRIBUTOR","body":"> the UGI in your environment changes based on the incoming request, but the thread pool that handles planning keeps its initial user information?\r\n\r\n@rdblue Yes, that's the problem.\r\nI found it not elegant to add UGI related code to Iceberg, too. However, we need to use thread pool otherwise it will slow down the processing.\r\n\r\n> we could update the TableScan interface and Spark to manage thread pools at a session level.\r\n\r\nDoes it mean that we should create a thread pool with a session lifetime (I'm not sure how to implement), or just replace the WORKER_POOL with a newly created one when it's necessary?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873335361/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873350843","html_url":"https://github.com/apache/iceberg/pull/2779#issuecomment-873350843","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2779","id":873350843,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MzM1MDg0Mw==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-03T05:43:30Z","updated_at":"2021-07-03T05:43:30Z","author_association":"COLLABORATOR","body":"Tests are failing due to new pruning issues on metadata tables, trying to track it down.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873350843/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873587233","html_url":"https://github.com/apache/iceberg/issues/2765#issuecomment-873587233","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2765","id":873587233,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MzU4NzIzMw==","user":{"login":"cduongvn","id":4472857,"node_id":"MDQ6VXNlcjQ0NzI4NTc=","avatar_url":"https://avatars.githubusercontent.com/u/4472857?v=4","gravatar_id":"","url":"https://api.github.com/users/cduongvn","html_url":"https://github.com/cduongvn","followers_url":"https://api.github.com/users/cduongvn/followers","following_url":"https://api.github.com/users/cduongvn/following{/other_user}","gists_url":"https://api.github.com/users/cduongvn/gists{/gist_id}","starred_url":"https://api.github.com/users/cduongvn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cduongvn/subscriptions","organizations_url":"https://api.github.com/users/cduongvn/orgs","repos_url":"https://api.github.com/users/cduongvn/repos","events_url":"https://api.github.com/users/cduongvn/events{/privacy}","received_events_url":"https://api.github.com/users/cduongvn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-04T13:09:20Z","updated_at":"2021-07-04T13:09:20Z","author_association":"NONE","body":"@kbendick \r\n\r\nWe are using Spark 3.0.1 and Iceberg 0.11.1 and Parquet files.\r\n\r\nFull query plain\r\n\r\n```\r\n== Physical Plan ==\r\nReplaceData IcebergBatchWrite(table=iceberg.perks.affiliate_network_transactions_v3, format=PARQUET), org.apache.spark.sql.execution.datasources.v2.ExtendedDataSourceV2Strategy$$Lambda$3778/0x000000084186dc40@31c9d4a7\r\n+- AdaptiveSparkPlan isFinalPlan=true\r\n   +- Sort [icebergdaytransform(created_date#299) ASC NULLS FIRST], false, 0\r\n      +- MergeInto MergeIntoParams(isnull(_row_from_source_#314),isnull(_row_from_target_#339),ArrayBuffer(true),ArrayBuffer(Some(List(record_id#8, an_transaction_datetime#87, created_date#63, is_payable#81, affiliate_network#65, cashback_amount#73, reason_for_status#85, etl_job_id#83, base_currency#61, updated_date#71, an_correlator#67, paid_to_revolut#89, sale_amount#75, an_status#59, country#69, an_merchant_name#77, status#79))),ArrayBuffer(true),ArrayBuffer(Some(List(record_id#8, an_transaction_datetime#87, created_date#63, is_payable#81, affiliate_network#65, cashback_amount#73, reason_for_status#85, etl_job_id#83, base_currency#61, updated_date#71, an_correlator#67, paid_to_revolut#89, sale_amount#75, an_status#59, country#69, an_merchant_name#77, status#79))),List(record_id#297, an_transaction_datetime#298, created_date#299, is_payable#300, affiliate_network#301, cashback_amount#302, reason_for_status#303, etl_job_id#304, base_currency#305, updated_date#306, an_correlator#307, paid_to_revolut#308, sale_amount#309, an_status#310, country#311, an_merchant_name#312, status#313),List(record_id#8, sale_amount#75, an_status#59, created_date#63, updated_date#71, affiliate_network#65, status#79, base_currency#61, cashback_amount#73, reason_for_status#85, is_payable#81, etl_job_id#83, country#69, an_transaction_datetime#87, an_correlator#67, an_merchant_name#77, paid_to_revolut#89, _row_from_source_#314, record_id#297, an_transaction_datetime#298, created_date#299, is_payable#300, affiliate_network#301, cashback_amount#302, reason_for_status#303, etl_job_id#304, base_currency#305, updated_date#306, an_correlator#307, paid_to_revolut#308, sale_amount#309, an_status#310, country#311, an_merchant_name#312, status#313, _file#334, _pos#335L, _row_from_target_#339)), [record_id#297, an_transaction_datetime#298, created_date#299, is_payable#300, affiliate_network#301, cashback_amount#302, reason_for_status#303, etl_job_id#304, base_currency#305, updated_date#306, an_correlator#307, paid_to_revolut#308, sale_amount#309, an_status#310, country#311, an_merchant_name#312, status#313]\r\n         +- SortMergeJoin [record_id#8], [record_id#297], FullOuter, ((cast(created_date#299 as date) >= 18801) AND (cast(created_date#299 as date) <= 18802))\r\n            :- *(10) Project [record_id#8, sale_amount#75, an_status#59, created_date#63, updated_date#71, affiliate_network#65, status#79, base_currency#61, cashback_amount#73, reason_for_status#85, is_payable#81, etl_job_id#83, country#69, an_transaction_datetime#87, an_correlator#67, an_merchant_name#77, paid_to_revolut#89, true AS _row_from_source_#314]\r\n            :  +- SortAggregate(key=[record_id#8], functions=[last(sale_amount#14, false), last(an_status#15, false), last(created_date#22, false), last(updated_date#23, false), last(affiliate_network#11, false), last(status#16, false), last(base_currency#12, false), last(cashback_amount#13, false), last(reason_for_status#17, false), last(is_payable#20, false), last(etl_job_id#7, false), last(country#18, false), last(an_transaction_datetime#21, false), last(an_correlator#9, false), last(an_merchant_name#10, false), last(paid_to_revolut#19, false)])\r\n            :     +- *(9) Sort [record_id#8 ASC NULLS FIRST], false, 0\r\n            :        +- CustomShuffleReader coalesced\r\n            :           +- ShuffleQueryStage 0\r\n            :              +- Exchange hashpartitioning(record_id#8, 200), true, [id=#303]\r\n            :                 +- SortAggregate(key=[record_id#8], functions=[partial_last(sale_amount#14, false), partial_last(an_status#15, false), partial_last(created_date#22, false), partial_last(updated_date#23, false), partial_last(affiliate_network#11, false), partial_last(status#16, false), partial_last(base_currency#12, false), partial_last(cashback_amount#13, false), partial_last(reason_for_status#17, false), partial_last(is_payable#20, false), partial_last(etl_job_id#7, false), partial_last(country#18, false), partial_last(an_transaction_datetime#21, false), partial_last(an_correlator#9, false), partial_last(an_merchant_name#10, false), partial_last(paid_to_revolut#19, false)])\r\n            :                    +- *(1) Sort [record_id#8 ASC NULLS FIRST], false, 0\r\n            :                       +- FileScan csv [etl_job_id#7,record_id#8,an_correlator#9,an_merchant_name#10,affiliate_network#11,base_currency#12,cashback_amount#13,sale_amount#14,an_status#15,status#16,reason_for_status#17,country#18,paid_to_revolut#19,is_payable#20,an_transaction_datetime#21,created_date#22,updated_date#23] Batched: false, DataFilters: [], Format: CSV, Location: InMemoryFileIndex[gs://iceberg/affiliate_network_transactions_v3/2021/06..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<etl_job_id:timestamp,record_id:string,an_correlator:string,an_merchant_name:string,affilia...\r\n            +- *(11) Sort [record_id#297 ASC NULLS FIRST], false, 0\r\n               +- CustomShuffleReader coalesced\r\n                  +- ShuffleQueryStage 4\r\n                     +- Exchange hashpartitioning(record_id#297, 200), true, [id=#683]\r\n                        +- *(8) Project [record_id#297, an_transaction_datetime#298, created_date#299, is_payable#300, affiliate_network#301, cashback_amount#302, reason_for_status#303, etl_job_id#304, base_currency#305, updated_date#306, an_correlator#307, paid_to_revolut#308, sale_amount#309, an_status#310, country#311, an_merchant_name#312, status#313, _file#334, _pos#335L, true AS _row_from_target_#339]\r\n                           +- DynamicFileFilterExec[record_id#297, an_transaction_datetime#298, created_date#299, is_payable#300, affiliate_network#301, cashback_amount#302, reason_for_status#303, etl_job_id#304, base_currency#305, updated_date#306, an_correlator#307, paid_to_revolut#308, sale_amount#309, an_status#310, country#311, an_merchant_name#312, status#313, _file#334, _pos#335L]\r\n                              :- *(6) Project [record_id#297, an_transaction_datetime#298, created_date#299, is_payable#300, affiliate_network#301, cashback_amount#302, reason_for_status#303, etl_job_id#304, base_currency#305, updated_date#306, an_correlator#307, paid_to_revolut#308, sale_amount#309, an_status#310, country#311, an_merchant_name#312, status#313, _file#334, _pos#335L]\r\n                              :  +- ExtendedBatchScan[record_id#297, an_transaction_datetime#298, created_date#299, is_payable#300, affiliate_network#301, cashback_amount#302, reason_for_status#303, etl_job_id#304, base_currency#305, updated_date#306, an_correlator#307, paid_to_revolut#308, sale_amount#309, an_status#310, country#311, an_merchant_name#312, status#313, _file#334, _pos#335L] iceberg.perks.affiliate_network_transactions_v3 [filters=]\r\n                              +- *(7) Filter (isnotnull(_sum_#338L) AND (_sum_#338L > 1))\r\n                                 +- *(7) HashAggregate(keys=[_file#334, _pos#335L], functions=[sum(_affectedFiles_#336)])\r\n                                    +- ShuffleQueryStage 3\r\n                                       +- Exchange hashpartitioning(_file#334, _pos#335L, 200), true, [id=#568]\r\n                                          +- *(5) HashAggregate(keys=[_file#334, _pos#335L], functions=[partial_sum(_affectedFiles_#336)])\r\n                                             +- Project [_file#334, _pos#335L, AccumulateFiles(SetAccumulator(id: 571, name: Some(internal.metrics.merge.affectedFiles), value: [gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00022-298-8beea94b-2b6f-4256-8269-35a9dc5d9024-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00031-323-8bebe5ce-afa7-4864-83e5-3d2c96535903-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00010-302-c3aa1128-dfc4-457e-bb81-0672d64bf730-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00011-313-ab9551e7-3ce5-420b-b0f2-4028ad2a444c-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00019-295-700431cb-c7c2-4cbe-8506-d9c5edfd6f19-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00028-320-2a2f7876-e7aa-45f7-bc78-d27101d067db-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00038-334-c9b508de-110a-4951-bac1-6ad71dfb08ad-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00005-281-50e70176-eb21-4bbe-9942-da6d23ed04d7-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00010-286-6c5fbed6-7f12-49c1-b24c-ff6a807a9fe4-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00014-290-12d33502-3ef5-4694-8bc5-0f8b5b742d1c-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00026-318-5ccdc550-171c-46be-91f1-dc6f1d7e9c06-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00008-284-c887f4d4-80bf-4d1d-89b2-66f6b8a94757-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00017-293-8a6bb2b8-542e-4e0c-b3f4-bd51f80da087-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00019-319-4481ebef-cc5e-4f75-bb58-1036fe45af3f-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00040-335-0d6c8444-810e-485a-96e7-d4586436aa2e-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00012-299-a836204a-042a-48de-bd48-2c07aeaf9c93-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00009-285-1a527a5f-6313-4c77-b5cc-1df15ce8b78b-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00015-307-344dfb30-35c0-45a5-86b1-202d1717f52b-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00013-289-5e8c7dc9-4e6c-402d-a9a7-5404bcef0b3b-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00000-276-32e02e0d-671a-42df-93aa-21e4d3c3fee5-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00017-309-6e13f650-a92e-4d8b-b592-538a6bff242b-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00012-304-f1aa8572-e5af-4cc5-984e-e366c787ba63-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00009-311-98f4a5b4-91e7-4779-a65c-69dff24e58c8-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00032-329-bb70ce71-c176-4416-9a7f-d18b99582024-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00027-319-4c8403b8-84ca-4762-a153-6e86bca52ef4-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00016-317-39256fae-6dfc-4049-8fcf-cae14bd1bc85-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00020-296-e328e835-3848-439f-b753-d6848d58f9c2-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00008-300-99162aec-9e2d-4af4-bdc2-22dede713a5c-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00021-297-3c4e8614-2351-4bf2-8b0e-590c80cb19f0-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00020-312-65c68bce-83fd-41fd-bd49-8efcab10ec8e-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00006-298-36dbe91d-61d8-46d4-8536-e0b8719b4368-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00001-277-ba89d8ce-f3fd-4a98-b442-6908160b2506-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00023-305-951c9552-99a3-4a07-a1a2-60758b298735-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00002-301-7627007c-79a5-4e1c-934f-18b591d0a45b-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00026-323-5adf7f29-7ab3-4628-9a13-02f63df35718-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00015-316-6f3c2735-0f5e-4bbc-b05c-739815ab55d0-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00034-331-4471c635-9280-40db-88fa-de2a4f645715-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00033-330-d6e3bb29-2eb3-4409-9508-4519b5d97234-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00028-304-08fe25c0-1a76-4428-b898-b7b3e8fe3241-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00024-300-773682b0-5595-4ace-85e3-93744b2e82e6-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00001-293-c87efacc-ca87-446e-a9cb-45da8fc17f1f-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00028-325-c1e082ad-b106-4cbe-8bc7-8f2b60e523d9-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00002-278-2763a538-084c-4052-87f1-7332517be728-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00017-318-73f2d8d8-5f82-4a8c-9679-3ea9f5768de3-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00003-279-a9d7a583-ac33-4755-9532-610805ae998e-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00021-297-3c4e8614-2351-4bf2-8b0e-590c80cb19f0-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00025-301-96b9943e-db5e-473b-b628-771800716ffe-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00001-277-ba89d8ce-f3fd-4a98-b442-6908160b2506-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00005-297-cf720f22-38e6-4d5d-982e-a737b6bc494f-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00030-322-a5873853-a6bd-4845-a880-f6f285ccb5f9-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00003-295-79599b3e-9073-4654-8bca-f7d5f68eb9b9-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00029-326-90fdcb7b-94db-4f96-b6d2-f92fb6833b15-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00006-309-9451babb-27c5-4e90-9cb2-b3ff545c7acc-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00039-307-a57a4cdd-5ae6-4102-a102-27cbb4bc1467-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00027-303-718e14fc-0a8c-4561-a172-92d6c936c834-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00003-295-53f71419-c334-4140-aa80-a9e95af8dde0-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00001-298-999d0420-d411-4ad3-8c41-3962bd9e1dcc-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00030-327-670e354b-9d15-40a5-bcf0-662a35851011-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00007-310-ef1c7000-b615-4f4a-bc20-9d7012281f37-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00011-287-ae55c24f-2892-4e8d-a74b-c06df5cb1f03-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00021-313-b79fbc8b-0d62-4bb9-8d3d-8533c1549541-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00025-317-c27ae109-7cb7-4dd5-b99e-eaab07942260-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00023-299-a727dac8-1ebb-424a-b39b-806844ff4426-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00016-292-90a46de0-213f-4fb8-8db9-3e33b6eb79da-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00035-306-1edd8918-d46b-48be-88f8-2e3178e9578e-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00000-297-34121ef6-ac84-4eb9-9467-aba72e4af0ae-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00021-303-77fd9635-5937-464d-9d10-e2aff181eaaa-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00018-300-f6c69f58-d785-4c83-9ffd-22069a7716f7-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00004-302-ccae989f-7c4f-4836-b1d9-d9717eabb775-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00010-312-e99d93a6-ec64-4057-a066-669cbe2e72c3-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00011-287-ae55c24f-2892-4e8d-a74b-c06df5cb1f03-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00008-296-cd001e53-20d9-4658-af4a-eb06e22e4b0f-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00036-332-ed3c2123-601d-48c2-bd30-e368670397e3-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00020-320-212b7926-edc4-4063-9453-94f1cd8a3eb1-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00004-296-f2f2236c-7230-4ec3-a0ed-546b8eea1a6b-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00014-306-bb0741ed-92cb-42b9-b644-43ee2e4aa71c-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00018-294-0b0a1177-b997-4c25-9bb8-484a2c87b397-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00029-321-567e24e6-cbba-43dc-9df6-8c40d4ccc586-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00007-283-64ccb9a5-9c14-4db7-8d0e-e02b70815fd5-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00016-292-90a46de0-213f-4fb8-8db9-3e33b6eb79da-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00006-282-af65d2fe-49be-49f1-b322-c13e6cdd9d05-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00013-314-5618ce45-38fe-4e28-8d85-921b08a0aa71-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00026-302-731561c7-abdb-4cba-bae2-ba5ca86288d2-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00015-291-99735a58-3243-4777-819f-1112f3f51d85-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00029-305-80b36bd3-ace8-41c1-8dee-32b7385c3566-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00000-292-cb077c19-cce1-4ea6-912e-239bf4bd10eb-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00024-321-adf8f153-77e4-4df9-8a5a-765c8738bf64-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00004-280-9351fd11-44f3-44ce-a2b5-68a822d0c1d7-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00002-294-6278ebd0-b136-4398-8f3d-981cb6092583-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00037-333-e3e8204f-2049-4ebf-a492-fe2319d850a7-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00007-299-1f1669ee-2dd6-4c38-b025-cc18f0200c4e-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00022-314-f6873031-6f93-4ef6-a1e7-57516b9349e0-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00025-322-0e55f71d-8f55-4d99-89d5-8e0d8d40cc27-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00014-315-27acba9c-3b1d-40b7-9ffd-54c36eeb7862-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-24/00012-288-41351ab1-2e94-4b72-ad90-573b761ca5ad-00002.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00018-310-ff3aca87-8f60-4829-bb65-d1d08ccf94ab-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00011-303-ea8bb29f-9d55-4f1a-bddf-d6a0bfcdc70a-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00022-304-fc70387d-e440-4096-bd6d-86c8d777f26d-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00016-308-e3285d30-e0a2-4f63-adc3-e59861c8f5e3-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00005-308-07b08dff-41cb-4b8b-aef2-952d6d838102-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00027-324-05e59b10-123a-4594-9bab-e6dfffb44ed3-00001.parquet, gs://iceberg/affiliate_network_transactions_v3/data/created_date_day=2021-06-23/00031-328-f0aa2d5d-85ad-4e52-90b0-a83961be9e56-00001.parquet]), _file#334) AS _affectedFiles_#336]\r\n                                                +- *(4) BroadcastHashJoin [record_id#8], [record_id#297], Inner, BuildLeft\r\n                                                   :- BroadcastQueryStage 2\r\n                                                   :  +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true])), [id=#464]\r\n                                                   :     +- *(3) HashAggregate(keys=[record_id#8], functions=[])\r\n                                                   :        +- CustomShuffleReader coalesced\r\n                                                   :           +- ShuffleQueryStage 1\r\n                                                   :              +- Exchange hashpartitioning(record_id#8, 200), true, [id=#348]\r\n                                                   :                 +- *(2) HashAggregate(keys=[record_id#8], functions=[])\r\n                                                   :                    +- *(2) Project [record_id#8]\r\n                                                   :                       +- *(2) Filter isnotnull(record_id#8)\r\n                                                   :                          +- FileScan csv [record_id#8] Batched: false, DataFilters: [isnotnull(record_id#8)], Format: CSV, Location: InMemoryFileIndex[gs://iceberg/affiliate_network_transactions_v3/2021/06..., PartitionFilters: [], PushedFilters: [IsNotNull(record_id)], ReadSchema: struct<record_id:string>\r\n                                                   +- *(4) Project [record_id#297, _file#334, _pos#335L]\r\n                                                      +- *(4) Filter (((isnotnull(created_date#299) AND (cast(created_date#299 as date) >= 18801)) AND (cast(created_date#299 as date) <= 18802)) AND isnotnull(record_id#297))\r\n                                                         +- ExtendedBatchScan[record_id#297, an_transaction_datetime#298, created_date#299, is_payable#300, affiliate_network#301, cashback_amount#302, reason_for_status#303, etl_job_id#304, base_currency#305, updated_date#306, an_correlator#307, paid_to_revolut#308, sale_amount#309, an_status#310, country#311, an_merchant_name#312, status#313, _file#334, _pos#335L] iceberg.perks.affiliate_network_transactions_v3 [filters=]","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873587233/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873639393","html_url":"https://github.com/apache/iceberg/pull/2754#issuecomment-873639393","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2754","id":873639393,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MzYzOTM5Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-04T18:38:26Z","updated_at":"2021-07-04T18:38:26Z","author_association":"CONTRIBUTOR","body":"> Does it mean that we should create a thread pool with a session lifetime (I'm not sure how to implement), or just replace the WORKER_POOL with a newly created one when it's necessary?\r\n\r\nThe worker pool is shared and is not something we want to change. In your case, you'd want to add the ability to pass a pool when planning a scan and then update the Spark code to keep track of a pool per session.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873639393/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873671215","html_url":"https://github.com/apache/iceberg/pull/2780#issuecomment-873671215","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2780","id":873671215,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MzY3MTIxNQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-04T22:04:47Z","updated_at":"2021-07-04T22:08:03Z","author_association":"MEMBER","body":"I think we probably could do better by just saying how Iceberg will handle the predicates it gets, like for example it will use X & Y predicates in a partition evaluation expression and Z as a Data file evaluation expression\r\n\r\nThen we keep the \"which partitions were touched\" info as maybe an optional \"DEBUG\" line in the logs? \r\n\r\nSo Job Description looks like\r\n\r\n[Iceberg Scan - Pushed Partition Predicates [] - Pushed Data Predicates []]\r\n\r\nThen in the logs you get\r\n\"Planned scan of table {} - {} X files to be read from {} Y partitions\" - INFO\r\n\"Planned scan of table {} - {} X files to be read from {partition list}\" - Debug\r\n\"Planned scan of table {} - {file list} \" -- Trace\r\n\r\nThat way we only display this information at runtime in the logs, but we are sure we don't prematurely calculate scans and read manifests or what not.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873671215/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873822252","html_url":"https://github.com/apache/iceberg/issues/2348#issuecomment-873822252","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2348","id":873822252,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MzgyMjI1Mg==","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-05T05:52:36Z","updated_at":"2021-07-05T05:52:36Z","author_association":"MEMBER","body":"> ... currently only support a very limited set of Spark expressions as call arguments.\r\n\r\nHi, @RussellSpitzer, before finding the final solution to support generic expressions as call args, could you please list the supported expressions now? \r\n\r\nThe examples in documents still not work now (iceberg master branch with spark 3.1).\r\n\r\n```\r\nE, statement: CALL iceberg.system.expire_snapshots(table => 'cdc_wenjuan.member', older_than => now(), retain_last => 1), time taken: 0.004 seconds\r\nError: Error operating EXECUTE_STATEMENT: org.apache.spark.sql.catalyst.parser.extensions.IcebergParseException:\r\nmismatched input '(' expecting STRING(line 1, pos 85)\r\n\r\n== SQL ==\r\nCALL iceberg.system.expire_snapshots(table => 'cdc_wenjuan.member', older_than => now(), retain_last => 1)\r\n-------------------------------------------------------------------------------------^^^\r\n\r\n\tat org.apache.spark.sql.catalyst.parser.extensions.IcebergParseException.withCommand(IcebergSparkSqlExtensionsParser.scala:294)\r\n\tat org.apache.spark.sql.catalyst.parser.extensions.IcebergSparkSqlExtensionsParser.parse(IcebergSparkSqlExtensionsParser.scala:158)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873822252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873869272","html_url":"https://github.com/apache/iceberg/issues/2783#issuecomment-873869272","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2783","id":873869272,"node_id":"MDEyOklzc3VlQ29tbWVudDg3Mzg2OTI3Mg==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-05T07:20:02Z","updated_at":"2021-07-06T16:52:48Z","author_association":"COLLABORATOR","body":"Adding a reproduction test (can run in spark3-extensions test case, for example):\r\n```\r\npackage org.apache.iceberg.spark.extensions;\r\n\r\nimport com.google.common.collect.Lists;\r\nimport org.apache.iceberg.spark.SparkCatalog;\r\nimport org.apache.iceberg.spark.source.SimpleRecord;\r\nimport org.apache.iceberg.spark.source.SparkTable;\r\nimport org.apache.spark.sql.Column;\r\nimport org.apache.spark.sql.Dataset;\r\nimport org.apache.spark.sql.Encoders;\r\nimport org.apache.spark.sql.Row;\r\nimport org.apache.spark.sql.connector.catalog.Identifier;\r\nimport org.apache.spark.sql.execution.datasources.v2.DataSourceV2Relation;\r\nimport org.junit.After;\r\nimport org.junit.Assert;\r\nimport org.junit.Test;\r\nimport scala.Some;\r\n\r\nimport java.util.Arrays;\r\nimport java.util.List;\r\nimport java.util.Map;\r\n\r\npublic class TestSparkMetadataTable extends SparkExtensionsTestBase {\r\n\r\n  public TestSparkMetadataTable(String catalogName, String implementation, Map<String, String> config) {\r\n    super(catalogName, implementation, config);\r\n  }\r\n\r\n  @Test\r\n  public void testDataFileProjectionError1() throws Exception {\r\n    // init load\r\n    List<SimpleRecord> records = Lists.newArrayList(new SimpleRecord(1, \"1\"));\r\n    Dataset<Row> inputDf = spark.createDataFrame(records, SimpleRecord.class);\r\n    inputDf.writeTo(tableName).create();\r\n\r\n\r\n    SparkCatalog catalog = (SparkCatalog) spark.sessionState().catalogManager().catalog(catalogName);\r\n    String[] tableIdentifiers = tableName.split(\"\\\\.\");\r\n    Identifier metaId = Identifier.of(\r\n        new String[]{tableIdentifiers[1], tableIdentifiers[2]}, \"entries\");\r\n    SparkTable metaTable = catalog.loadTable(metaId);\r\n    Dataset<Row> entriesDs = Dataset.ofRows(spark, DataSourceV2Relation.create(metaTable, Some.apply(catalog), Some.apply(\r\n        metaId)));\r\n    Column aggCol = entriesDs.col(\"data_file.record_count\");\r\n    Dataset<Row> agg = entriesDs.agg(max(aggCol));\r\n    Assert.assertFalse(agg.collectAsList().isEmpty());\r\n  }\r\n\r\n  @Test\r\n  public void testDataFileProjectionError2() throws Exception {\r\n    // init load\r\n    List<SimpleRecord> records = Lists.newArrayList(new SimpleRecord(1, \"1\"));\r\n    Dataset<Row> inputDf = spark.createDataFrame(records, SimpleRecord.class);\r\n    inputDf.writeTo(tableName).create();\r\n\r\n\r\n    Dataset<Row> stringDs = spark.createDataset(Arrays.asList(\"my_path\"), Encoders.STRING())\r\n        .toDF(\"file_path\");\r\n\r\n    SparkCatalog catalog = (SparkCatalog) spark.sessionState().catalogManager().catalog(catalogName);\r\n    String[] tableIdentifiers = tableName.split(\"\\\\.\");\r\n    Identifier metaId = Identifier.of(\r\n        new String[]{tableIdentifiers[1], tableIdentifiers[2]}, \"entries\");\r\n    SparkTable metaTable = catalog.loadTable(metaId);\r\n    Dataset<Row> entriesDs = Dataset.ofRows(spark, DataSourceV2Relation.create(metaTable, Some.apply(catalog), Some.apply(\r\n        metaId)));\r\n\r\n    Column joinCond = entriesDs.col(\"data_file.file_path\").equalTo(stringDs.col(\"file_path\"));\r\n    Dataset<Row> res = entriesDs.join(stringDs, joinCond);\r\n    boolean empty = res.isEmpty();\r\n    Assert.assertEquals(true, empty);\r\n  }\r\n\r\n  @After\r\n  public void dropTables() {\r\n    sql(\"DROP TABLE IF EXISTS %s\", tableName);\r\n  }\r\n}\r\n```\r\n\r\nSide note: I use \"data_file\" field to reproduce it, if I do not then I hit other error: https://github.com/apache/iceberg/issues/1378 and https://github.com/apache/iceberg/issues/1735 (same underlying error)\r\n\r\nThere are two tests, it shows that even a simple aggregation now fails even with the workaround of using \"data_file\".","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873869272/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873875087","html_url":"https://github.com/apache/iceberg/issues/2783#issuecomment-873875087","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2783","id":873875087,"node_id":"MDEyOklzc3VlQ29tbWVudDg3Mzg3NTA4Nw==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-05T07:30:08Z","updated_at":"2021-07-05T07:41:40Z","author_association":"COLLABORATOR","body":"Preliminary analysis:  The BaseFile class uses some pruning logic, keeping a mapping called 'fromProjectionPos' that maps indexes in a projection (a subset of its columns) to real indexes in its column list.\r\n\r\nIe, if the projected array has three elements which are fields 1,2, and 10 of the original schema respectively, fromProjectionPos becomes {1, 2, 10}.\r\n\r\nThis is usually fine but the Spark generated code in Spark 3 uses the original index to get all the fields (It's entry point is StructInternalRow: https://github.com/apache/iceberg/blob/master/spark/src/main/java/org/apache/iceberg/spark/source/StructInternalRow.java#L124. (here 'struct' is the BaseDataFile with the pruning mapping, BUT spark initializes 'type' as the original (unpruned) list of fields).\r\n\r\nThe calll getInt(0) expects an int as per the original schema at index 0, but due to the mapping we return value at index 1 which is actually a string and hence the error.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873875087/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873885380","html_url":"https://github.com/apache/iceberg/issues/2783#issuecomment-873885380","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2783","id":873885380,"node_id":"MDEyOklzc3VlQ29tbWVudDg3Mzg4NTM4MA==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-05T07:47:46Z","updated_at":"2021-07-05T07:47:46Z","author_association":"COLLABORATOR","body":"@rdblue @RussellSpitzer  fyi, if you have any ideas about this.\r\n\r\nMy first thought is in this method:  https://github.com/apache/iceberg/blob/master/spark/src/main/java/org/apache/iceberg/spark/source/StructInternalRow.java#L78. , if the struct's schema does not match the type, then set a flag on this struct to skip projection.\r\n\r\nWe would need to add the method (StructLike.useProjection(boolean)) to the interface, and have BaseFile implement it, so maybe not the best approach.  I don't have the most context on this area, so maybe the idea is not good.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/873885380/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874218987","html_url":"https://github.com/apache/iceberg/pull/2780#issuecomment-874218987","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2780","id":874218987,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NDIxODk4Nw==","user":{"login":"nvitucci","id":1252064,"node_id":"MDQ6VXNlcjEyNTIwNjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1252064?v=4","gravatar_id":"","url":"https://api.github.com/users/nvitucci","html_url":"https://github.com/nvitucci","followers_url":"https://api.github.com/users/nvitucci/followers","following_url":"https://api.github.com/users/nvitucci/following{/other_user}","gists_url":"https://api.github.com/users/nvitucci/gists{/gist_id}","starred_url":"https://api.github.com/users/nvitucci/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nvitucci/subscriptions","organizations_url":"https://api.github.com/users/nvitucci/orgs","repos_url":"https://api.github.com/users/nvitucci/repos","events_url":"https://api.github.com/users/nvitucci/events{/privacy}","received_events_url":"https://api.github.com/users/nvitucci/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-05T16:13:12Z","updated_at":"2021-07-05T16:13:12Z","author_association":"NONE","body":" > That way we only display this information at runtime in the logs, but we are sure we don't prematurely calculate scans and read manifests or what not.\r\n\r\nI like this use of the logs and especially the varying level of detail, yet I'd like to have a more \"on demand\" tool available as well to get such information. Is there a way to use an `EXPLAIN EXTENDED`, or `EXPLAIN PLAN` or something similar, where it can be made clear that running it could potentially be expensive?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874218987/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874261536","html_url":"https://github.com/apache/iceberg/pull/2733#issuecomment-874261536","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2733","id":874261536,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NDI2MTUzNg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-05T17:59:08Z","updated_at":"2021-07-05T17:59:08Z","author_association":"CONTRIBUTOR","body":"Thanks, @nastra. I'll merge this for the Nessie code since that's what you prefer and you're working on it, but we should have a larger discussion about fixing auto-formatting more broadly and see what we can do to get configs updated.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874261536/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874279114","html_url":"https://github.com/apache/iceberg/pull/2780#issuecomment-874279114","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2780","id":874279114,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NDI3OTExNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-05T18:46:43Z","updated_at":"2021-07-05T18:46:43Z","author_association":"CONTRIBUTOR","body":"@nvitucci, I'm not aware of a way for Spark to request extended information from a source. You could implement that in Spark so that it shows a summary of the planning results?\r\n\r\nAlso, @puneetzaroo is looking into extended our event notifications to include more information about a scan, like the number of manifest files read, number of file splits, number of data files, number of delete files, etc. Maybe that would help you here because you could register a listener, get more detailed information, and do something with it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874279114/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874337094","html_url":"https://github.com/apache/iceberg/issues/2764#issuecomment-874337094","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2764","id":874337094,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NDMzNzA5NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-05T21:26:39Z","updated_at":"2021-07-05T21:26:39Z","author_association":"CONTRIBUTOR","body":"I think that we would need to be careful about this. Deduplication makes sense, but it is an overwrite and not a replace operation because it modifies the data in the table. Compaction is a pure replace that does not modify the table data. We should keep the two separate because replace operations can be safely ignored when looking for change to the table data.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874337094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874444400","html_url":"https://github.com/apache/iceberg/issues/2277#issuecomment-874444400","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2277","id":874444400,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NDQ0NDQwMA==","user":{"login":"liudi1184","id":30306636,"node_id":"MDQ6VXNlcjMwMzA2NjM2","avatar_url":"https://avatars.githubusercontent.com/u/30306636?v=4","gravatar_id":"","url":"https://api.github.com/users/liudi1184","html_url":"https://github.com/liudi1184","followers_url":"https://api.github.com/users/liudi1184/followers","following_url":"https://api.github.com/users/liudi1184/following{/other_user}","gists_url":"https://api.github.com/users/liudi1184/gists{/gist_id}","starred_url":"https://api.github.com/users/liudi1184/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liudi1184/subscriptions","organizations_url":"https://api.github.com/users/liudi1184/orgs","repos_url":"https://api.github.com/users/liudi1184/repos","events_url":"https://api.github.com/users/liudi1184/events{/privacy}","received_events_url":"https://api.github.com/users/liudi1184/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-06T04:11:27Z","updated_at":"2021-07-06T04:11:27Z","author_association":"NONE","body":"I also encountered this problem. Have you solved it?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874444400/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874478384","html_url":"https://github.com/apache/iceberg/pull/2779#issuecomment-874478384","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2779","id":874478384,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NDQ3ODM4NA==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-06T05:47:29Z","updated_at":"2021-07-06T05:52:21Z","author_association":"COLLABORATOR","body":"Looked a bit into pruning issue found by original implementation, reported here: https://github.com/apache/iceberg/issues/2783\r\n\r\nEliminate projection in latest changes to get this to work.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874478384/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874790164","html_url":"https://github.com/apache/iceberg/pull/2649#issuecomment-874790164","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2649","id":874790164,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NDc5MDE2NA==","user":{"login":"southernriver","id":20614350,"node_id":"MDQ6VXNlcjIwNjE0MzUw","avatar_url":"https://avatars.githubusercontent.com/u/20614350?v=4","gravatar_id":"","url":"https://api.github.com/users/southernriver","html_url":"https://github.com/southernriver","followers_url":"https://api.github.com/users/southernriver/followers","following_url":"https://api.github.com/users/southernriver/following{/other_user}","gists_url":"https://api.github.com/users/southernriver/gists{/gist_id}","starred_url":"https://api.github.com/users/southernriver/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/southernriver/subscriptions","organizations_url":"https://api.github.com/users/southernriver/orgs","repos_url":"https://api.github.com/users/southernriver/repos","events_url":"https://api.github.com/users/southernriver/events{/privacy}","received_events_url":"https://api.github.com/users/southernriver/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-06T14:05:02Z","updated_at":"2021-07-06T14:05:02Z","author_association":"CONTRIBUTOR","body":"@StefanXiepj   I  reopened this and do some fix in another pr [#2785](https://github.com/apache/iceberg/pull/2785)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874790164/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874836371","html_url":"https://github.com/apache/iceberg/pull/2787#issuecomment-874836371","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2787","id":874836371,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NDgzNjM3MQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-06T14:59:32Z","updated_at":"2021-07-06T14:59:32Z","author_association":"MEMBER","body":"Thanks for the clean up!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874836371/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874840131","html_url":"https://github.com/apache/iceberg/pull/2782#issuecomment-874840131","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2782","id":874840131,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NDg0MDEzMQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-06T15:03:50Z","updated_at":"2021-07-06T15:03:50Z","author_association":"MEMBER","body":"I'm a little confused of the intention here, won't this cause issues for Rewrite/Merge operations which delete and the add back data that was already in the table?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874840131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874899341","html_url":"https://github.com/apache/iceberg/issues/2783#issuecomment-874899341","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2783","id":874899341,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NDg5OTM0MQ==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-06T16:17:40Z","updated_at":"2021-07-06T16:17:40Z","author_association":"COLLABORATOR","body":"One more note: this issue happens only after upgrade to Spark 3.1.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874899341/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874938974","html_url":"https://github.com/apache/iceberg/pull/2782#issuecomment-874938974","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2782","id":874938974,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NDkzODk3NA==","user":{"login":"ayushchauhan0811","id":10010065,"node_id":"MDQ6VXNlcjEwMDEwMDY1","avatar_url":"https://avatars.githubusercontent.com/u/10010065?v=4","gravatar_id":"","url":"https://api.github.com/users/ayushchauhan0811","html_url":"https://github.com/ayushchauhan0811","followers_url":"https://api.github.com/users/ayushchauhan0811/followers","following_url":"https://api.github.com/users/ayushchauhan0811/following{/other_user}","gists_url":"https://api.github.com/users/ayushchauhan0811/gists{/gist_id}","starred_url":"https://api.github.com/users/ayushchauhan0811/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayushchauhan0811/subscriptions","organizations_url":"https://api.github.com/users/ayushchauhan0811/orgs","repos_url":"https://api.github.com/users/ayushchauhan0811/repos","events_url":"https://api.github.com/users/ayushchauhan0811/events{/privacy}","received_events_url":"https://api.github.com/users/ayushchauhan0811/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-06T17:14:26Z","updated_at":"2021-07-06T17:14:26Z","author_association":"NONE","body":"@RussellSpitzer Currently incremental scan only supports the append operations but there can be cases where we can want to include other operations too. We use a CDC job to write to an iceberg table and then use this feature to do some computation on the incremental data b/w two snapshots.\r\n\r\nI didn't understand, why will it cause issues with rewrite operations? Isn't rewrite operations like overwrite operation where there are a bunch of delete files and newly added data files. I have tested it on overwrite operations on the cdc data","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874938974/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874948842","html_url":"https://github.com/apache/iceberg/pull/2782#issuecomment-874948842","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2782","id":874948842,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NDk0ODg0Mg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-06T17:29:23Z","updated_at":"2021-07-06T17:29:23Z","author_association":"MEMBER","body":"@ayushchauhan0811 \r\nRewrite and Merge operations will have data that was previously already in the data set. Consider a compaction operation which changes no actual rows but combines files, all old files are no longer valid and are deleted and a set of new files are added. So if you check which files were \"added\" by this compaction operation you would see the entire table as having been \"added\" in this snapshot.\r\n\r\nMerge operations (copy-on-write) have a similar issue. Imagine a merge operation updates a single row in a data file. The old file will be deleted  and a new file will be created. The new file will have all the data in the old file and one additional row. If you scan this new file you will get all the data which was appended in a previous action as well as the new data.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874948842/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874963528","html_url":"https://github.com/apache/iceberg/pull/2782#issuecomment-874963528","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2782","id":874963528,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NDk2MzUyOA==","user":{"login":"ayushchauhan0811","id":10010065,"node_id":"MDQ6VXNlcjEwMDEwMDY1","avatar_url":"https://avatars.githubusercontent.com/u/10010065?v=4","gravatar_id":"","url":"https://api.github.com/users/ayushchauhan0811","html_url":"https://github.com/ayushchauhan0811","followers_url":"https://api.github.com/users/ayushchauhan0811/followers","following_url":"https://api.github.com/users/ayushchauhan0811/following{/other_user}","gists_url":"https://api.github.com/users/ayushchauhan0811/gists{/gist_id}","starred_url":"https://api.github.com/users/ayushchauhan0811/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayushchauhan0811/subscriptions","organizations_url":"https://api.github.com/users/ayushchauhan0811/orgs","repos_url":"https://api.github.com/users/ayushchauhan0811/repos","events_url":"https://api.github.com/users/ayushchauhan0811/events{/privacy}","received_events_url":"https://api.github.com/users/ayushchauhan0811/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-06T17:52:12Z","updated_at":"2021-07-06T17:52:12Z","author_association":"NONE","body":"I will test both scenarios out and post the findings here.\r\n\r\nBut I think there should be a feature for incrementally scanning data b/w two snapshots. The current one only allow append operations","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/874963528/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875008260","html_url":"https://github.com/apache/iceberg/pull/2782#issuecomment-875008260","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2782","id":875008260,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NTAwODI2MA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-06T19:01:14Z","updated_at":"2021-07-06T19:01:14Z","author_association":"MEMBER","body":"I agree there should be a way to figure out the difference between two snapshots, unfortunately It's a bit more complicated for everything that isn't an append. :/ ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875008260/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875009308","html_url":"https://github.com/apache/iceberg/issues/2774#issuecomment-875009308","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2774","id":875009308,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NTAwOTMwOA==","user":{"login":"jzhuge","id":1883812,"node_id":"MDQ6VXNlcjE4ODM4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1883812?v=4","gravatar_id":"","url":"https://api.github.com/users/jzhuge","html_url":"https://github.com/jzhuge","followers_url":"https://api.github.com/users/jzhuge/followers","following_url":"https://api.github.com/users/jzhuge/following{/other_user}","gists_url":"https://api.github.com/users/jzhuge/gists{/gist_id}","starred_url":"https://api.github.com/users/jzhuge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzhuge/subscriptions","organizations_url":"https://api.github.com/users/jzhuge/orgs","repos_url":"https://api.github.com/users/jzhuge/repos","events_url":"https://api.github.com/users/jzhuge/events{/privacy}","received_events_url":"https://api.github.com/users/jzhuge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-06T19:02:44Z","updated_at":"2021-07-06T19:02:44Z","author_association":"MEMBER","body":"@rdblue @rdsr Could you take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875009308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875041234","html_url":"https://github.com/apache/iceberg/pull/2762#issuecomment-875041234","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2762","id":875041234,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NTA0MTIzNA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-06T19:57:26Z","updated_at":"2021-07-06T19:57:26Z","author_association":"CONTRIBUTOR","body":"Thanks, @rdblue @yyanyy!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875041234/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875047725","html_url":"https://github.com/apache/iceberg/pull/2680#issuecomment-875047725","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2680","id":875047725,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NTA0NzcyNQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-06T20:08:21Z","updated_at":"2021-07-06T20:08:21Z","author_association":"CONTRIBUTOR","body":"I've been looking at our task writers to implement merge-on-read in Spark so I should be able to help reviewing this.\r\nI'll try to do a pass tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875047725/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875080769","html_url":"https://github.com/apache/iceberg/issues/2786#issuecomment-875080769","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2786","id":875080769,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NTA4MDc2OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-06T21:05:06Z","updated_at":"2021-07-06T21:05:06Z","author_association":"CONTRIBUTOR","body":"Where was this linked from?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875080769/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875123252","html_url":"https://github.com/apache/iceberg/issues/1617#issuecomment-875123252","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1617","id":875123252,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NTEyMzI1Mg==","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-06T22:25:54Z","updated_at":"2021-07-06T22:25:54Z","author_association":"CONTRIBUTOR","body":"> For table metadata files, there is only an external location for Hadoop tables. Otherwise, the table location must come from the table's metadata.json file. That makes it difficult to make metadata_location and previous_metadata_location relative paths. I would probably not attempt to make these paths relative, but I'm open to ideas.\r\n\r\nHi @rdblue, we might leave metadata_location and previous_metadata_location as is, they are table properties in Metastore like HMS, are not affected when we just move files from the source table to the target. They are absolute path, but they still point to the right place without any change.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875123252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875167472","html_url":"https://github.com/apache/iceberg/pull/1648#issuecomment-875167472","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1648","id":875167472,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NTE2NzQ3Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-07T00:14:53Z","updated_at":"2021-07-07T00:14:53Z","author_association":"CONTRIBUTOR","body":"@davseitsev, we don't typically change dependency versions in patch releases. I think that's a surprise to people that depend on very few changes in patches. This would be a good one to get into 0.12.0 (release in the next couple weeks) if we can get tests passing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875167472/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875239774","html_url":"https://github.com/apache/iceberg/pull/2680#issuecomment-875239774","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2680","id":875239774,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NTIzOTc3NA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-07T03:15:35Z","updated_at":"2021-07-07T03:15:35Z","author_association":"MEMBER","body":"Thanks for your review bandwidth, @aokolnychyi  ! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875239774/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875312309","html_url":"https://github.com/apache/iceberg/pull/2782#issuecomment-875312309","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2782","id":875312309,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NTMxMjMwOQ==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-07T06:07:57Z","updated_at":"2021-07-07T06:07:57Z","author_association":"COLLABORATOR","body":"I also wonder how it should look?  If there have only been deletes for example, what will the incremental read return?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875312309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875328230","html_url":"https://github.com/apache/iceberg/issues/1804#issuecomment-875328230","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1804","id":875328230,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NTMyODIzMA==","user":{"login":"jshmchenxi","id":11854435,"node_id":"MDQ6VXNlcjExODU0NDM1","avatar_url":"https://avatars.githubusercontent.com/u/11854435?v=4","gravatar_id":"","url":"https://api.github.com/users/jshmchenxi","html_url":"https://github.com/jshmchenxi","followers_url":"https://api.github.com/users/jshmchenxi/followers","following_url":"https://api.github.com/users/jshmchenxi/following{/other_user}","gists_url":"https://api.github.com/users/jshmchenxi/gists{/gist_id}","starred_url":"https://api.github.com/users/jshmchenxi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jshmchenxi/subscriptions","organizations_url":"https://api.github.com/users/jshmchenxi/orgs","repos_url":"https://api.github.com/users/jshmchenxi/repos","events_url":"https://api.github.com/users/jshmchenxi/events{/privacy}","received_events_url":"https://api.github.com/users/jshmchenxi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-07T06:36:40Z","updated_at":"2021-07-07T06:36:40Z","author_association":"CONTRIBUTOR","body":"> Here is a link to get added so I don't have to add everyone manually :) Please let me know if it doesn't work\r\n> \r\n> https://s.apache.org/slack-invite\r\n\r\n@RussellSpitzer Hi, I tried the link but it didn't work. I encountered the same problem as jackye1995 described above, not able to join without an apache email.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875328230/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875435777","html_url":"https://github.com/apache/iceberg/issues/2789#issuecomment-875435777","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2789","id":875435777,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NTQzNTc3Nw==","user":{"login":"himanshpal","id":1980022,"node_id":"MDQ6VXNlcjE5ODAwMjI=","avatar_url":"https://avatars.githubusercontent.com/u/1980022?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshpal","html_url":"https://github.com/himanshpal","followers_url":"https://api.github.com/users/himanshpal/followers","following_url":"https://api.github.com/users/himanshpal/following{/other_user}","gists_url":"https://api.github.com/users/himanshpal/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshpal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshpal/subscriptions","organizations_url":"https://api.github.com/users/himanshpal/orgs","repos_url":"https://api.github.com/users/himanshpal/repos","events_url":"https://api.github.com/users/himanshpal/events{/privacy}","received_events_url":"https://api.github.com/users/himanshpal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-07T09:13:41Z","updated_at":"2021-07-07T09:13:41Z","author_association":"NONE","body":"@SreeramGarlapati - Can the rate-limiting be also be extended to be used in batch usecases ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875435777/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875868546","html_url":"https://github.com/apache/iceberg/issues/1804#issuecomment-875868546","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1804","id":875868546,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NTg2ODU0Ng==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-07T19:22:08Z","updated_at":"2021-07-07T19:22:08Z","author_association":"MEMBER","body":"https://communityinviter.com/apps/apache-iceberg/apache-iceberg-website -- The new slack community is not part of Apache so it should be much easier to access","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875868546/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875946616","html_url":"https://github.com/apache/iceberg/pull/2779#issuecomment-875946616","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2779","id":875946616,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NTk0NjYxNg==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-07T21:28:06Z","updated_at":"2021-07-07T21:28:06Z","author_association":"COLLABORATOR","body":"@RussellSpitzer  could you take a look if you have some time?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875946616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875946902","html_url":"https://github.com/apache/iceberg/pull/2777#issuecomment-875946902","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2777","id":875946902,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NTk0NjkwMg==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-07T21:28:37Z","updated_at":"2021-07-07T21:28:37Z","author_association":"COLLABORATOR","body":"@RussellSpitzer  could you take a look if you have some time?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875946902/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875957720","html_url":"https://github.com/apache/iceberg/pull/2792#issuecomment-875957720","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2792","id":875957720,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NTk1NzcyMA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-07T21:49:11Z","updated_at":"2021-07-07T21:49:11Z","author_association":"CONTRIBUTOR","body":"cc @RussellSpitzer @aokolnychyi @flyrain @raptond @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/875957720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876033226","html_url":"https://github.com/apache/iceberg/pull/2781#issuecomment-876033226","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2781","id":876033226,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjAzMzIyNg==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-08T00:53:41Z","updated_at":"2021-07-08T00:54:14Z","author_association":"CONTRIBUTOR","body":"cc @dongjoon-hyun @omalley who have been involved in previous ORC version upgrades 🙂 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876033226/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876035742","html_url":"https://github.com/apache/iceberg/issues/2741#issuecomment-876035742","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2741","id":876035742,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjAzNTc0Mg==","user":{"login":"thomaschow","id":2002564,"node_id":"MDQ6VXNlcjIwMDI1NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/2002564?v=4","gravatar_id":"","url":"https://api.github.com/users/thomaschow","html_url":"https://github.com/thomaschow","followers_url":"https://api.github.com/users/thomaschow/followers","following_url":"https://api.github.com/users/thomaschow/following{/other_user}","gists_url":"https://api.github.com/users/thomaschow/gists{/gist_id}","starred_url":"https://api.github.com/users/thomaschow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomaschow/subscriptions","organizations_url":"https://api.github.com/users/thomaschow/orgs","repos_url":"https://api.github.com/users/thomaschow/repos","events_url":"https://api.github.com/users/thomaschow/events{/privacy}","received_events_url":"https://api.github.com/users/thomaschow/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-08T01:01:03Z","updated_at":"2021-07-08T01:01:03Z","author_association":"CONTRIBUTOR","body":"@jhsenjaliya  do you have a PR available? I also have cycles to author if needed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876035742/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876039804","html_url":"https://github.com/apache/iceberg/pull/2792#issuecomment-876039804","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2792","id":876039804,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjAzOTgwNA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-08T01:10:46Z","updated_at":"2021-07-08T01:10:46Z","author_association":"CONTRIBUTOR","body":"@rdblue Could we possibly add this to the 0.12 release track? It's a relatively small change but it would be beneficial to us to have this released with 0.12 for users who might maintain their own environments.\r\n\r\nIf not possible, no worries.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876039804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876045720","html_url":"https://github.com/apache/iceberg/pull/2062#issuecomment-876045720","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2062","id":876045720,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjA0NTcyMA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-08T01:25:43Z","updated_at":"2021-07-08T01:25:43Z","author_association":"CONTRIBUTOR","body":"Rebased this onto master so that we can come back to it if desired (as @holdenk has some on going python work for `starts_with`).\r\n\r\nIf we move forward with this, I'm happy to rebase / squash. 🙂 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876045720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876060678","html_url":"https://github.com/apache/iceberg/issues/2793#issuecomment-876060678","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2793","id":876060678,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjA2MDY3OA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-08T02:03:42Z","updated_at":"2021-07-08T02:04:35Z","author_association":"MEMBER","body":"The ExpireSnapshots action removes all data files and manifests which are no longer reachable once the expired snapshots have been removed￼.\n\nRemoveOrphanFiles compares the current reachable set of files with all the files in the table's location and removes any that are not referenced by the Iceberg table.\n\nSo expire snapshots should never remove any files unless they were once part of an Iceberg table and have become unreachable. This will never delete other files.\n\nRemoveOrphans will remove any files in the table location, regardless of whether they were once part of the table or just happen to be in that location.\n\nIn both cases these actions will physically delete the files they believe are no longer needed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876060678/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876064807","html_url":"https://github.com/apache/iceberg/issues/2793#issuecomment-876064807","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2793","id":876064807,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjA2NDgwNw==","user":{"login":"dmgcodevil","id":1413873,"node_id":"MDQ6VXNlcjE0MTM4NzM=","avatar_url":"https://avatars.githubusercontent.com/u/1413873?v=4","gravatar_id":"","url":"https://api.github.com/users/dmgcodevil","html_url":"https://github.com/dmgcodevil","followers_url":"https://api.github.com/users/dmgcodevil/followers","following_url":"https://api.github.com/users/dmgcodevil/following{/other_user}","gists_url":"https://api.github.com/users/dmgcodevil/gists{/gist_id}","starred_url":"https://api.github.com/users/dmgcodevil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmgcodevil/subscriptions","organizations_url":"https://api.github.com/users/dmgcodevil/orgs","repos_url":"https://api.github.com/users/dmgcodevil/repos","events_url":"https://api.github.com/users/dmgcodevil/events{/privacy}","received_events_url":"https://api.github.com/users/dmgcodevil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-08T02:12:44Z","updated_at":"2021-07-08T02:18:27Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer what should I run after combining small files:\r\n\r\n```\r\n    Actions.forTable(table).rewriteDataFiles()\r\n      .filter(....)\r\n      .targetSizeInBytes(targetSizeMB * 1024 * 1024)\r\n      .execute()\r\n```\r\n\r\nRemoveOrphans  ?\r\n\r\n\r\n@RussellSpitzer  I'd like to delete small files that are no longer needed","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876064807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876096048","html_url":"https://github.com/apache/iceberg/issues/2793#issuecomment-876096048","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2793","id":876096048,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjA5NjA0OA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-08T03:33:09Z","updated_at":"2021-07-08T03:33:09Z","author_association":"MEMBER","body":"ExpireSnapshots is what you want to run. If you want to combine small files and then remove the old small files physically you would perform a Rewrite followed by an ExpireSnapshots expiring all snapshots except for the most recent one you created.\r\n\r\nRemove orphan files is more for when you have failed commits that have left files in the directory. It is much more expensive because it requires doing directory listings and more dangerous since it can delete files that were not previously part of the table. It will delete a superset of the files deleted by expire snapshot.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876096048/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876100246","html_url":"https://github.com/apache/iceberg/issues/2793#issuecomment-876100246","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2793","id":876100246,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjEwMDI0Ng==","user":{"login":"dmgcodevil","id":1413873,"node_id":"MDQ6VXNlcjE0MTM4NzM=","avatar_url":"https://avatars.githubusercontent.com/u/1413873?v=4","gravatar_id":"","url":"https://api.github.com/users/dmgcodevil","html_url":"https://github.com/dmgcodevil","followers_url":"https://api.github.com/users/dmgcodevil/followers","following_url":"https://api.github.com/users/dmgcodevil/following{/other_user}","gists_url":"https://api.github.com/users/dmgcodevil/gists{/gist_id}","starred_url":"https://api.github.com/users/dmgcodevil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmgcodevil/subscriptions","organizations_url":"https://api.github.com/users/dmgcodevil/orgs","repos_url":"https://api.github.com/users/dmgcodevil/repos","events_url":"https://api.github.com/users/dmgcodevil/events{/privacy}","received_events_url":"https://api.github.com/users/dmgcodevil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-08T03:45:44Z","updated_at":"2021-07-08T03:46:11Z","author_association":"CONTRIBUTOR","body":"that's exactly what I did. first I combined small files using `RewriteDataFilesAction`\r\nthen I executed `ExpireSnapshotsAction`  using a timestamp of a snapshot before the one created by `RewriteDataFilesAction` (i.e. latest)\r\nI noticed that only a small number of files got removed. \r\n\r\nThen I've found the following statement in docs:\r\n\r\n```\r\nin some cases normal snapshot expiration may not be able to determine a file is no longer needed and delete it.\r\n```\r\n\r\nAnd decided to run `RemoveOrphanFilesAction`. Unfortunately, it deleted a lot of files that weren't combined.\r\n\r\nAlso:\r\n`It will delete a superset of the files deleted by expire snapshot.` could you please explain ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876100246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876111064","html_url":"https://github.com/apache/iceberg/issues/2793#issuecomment-876111064","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2793","id":876111064,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjExMTA2NA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-08T04:16:37Z","updated_at":"2021-07-08T04:16:37Z","author_association":"MEMBER","body":"ExpireSnapshotActions will always only remove files that were previously part of the Iceberg Table.\r\nRemoveOrphanFiles will remove those files and any other files that are not explicitly part of the table.\r\n\r\nLet's take an example\r\n\r\nI have a Directory /myTable/\r\n\r\nI have preformed several commits\r\n\r\n```\r\n1. Add File A, B. - Table is A, B\r\n2. Remove File A, Add File C. - Table is B, C\r\n3. Remove File C, Add File D - Table is B, D\r\n```\r\n\r\nBut lets say we had a bit of an error and we also wrote BrokenFile in a run that got canceled, it was never added to the table but the file was created.\r\n\r\nThe directory now has five files from Iceberg (and metadata files)\r\n\r\n```\r\nA, B , C, D and BrokenFile\r\n```\r\n\r\nIf I run expire snapshots and remove snapshot 1 then it checks for all files that were referred to by \r\nsnapshot 1 (A, B)  that were not referred to by Snapshot 2 (B, C) or Snapshot 3 (B, D). \r\nThis is a single file, \r\n\r\n```\r\n(A, B) but not (B, C, D) = (A). \r\n```\r\n\r\nSo only File A should be deleted (along with metadata for Snapshot 2 and Snapshot 3).\r\n\r\nIf I run expire snapshots and remove snapshot 2 and 1 we do a similar thing.\r\n\r\n```\r\n(A, B, C) but not (B, D) = (A, C)\r\n```\r\n\r\nSo in this case expire snapshots removes two data files, A and C.\r\n\r\nNeither of these operations were able to remove \"BrokenFile\" it was never listed, so it can never be picked up by this operation. Let's say that we expired Snapshots 2 and 1, but the delete operation failed so the files were never removed.\r\n\r\nNow the table just looks like\r\n\r\n```\r\n3. Remove C, Add D - Table is B, D\r\n```\r\n\r\nBut our directory still has A, B, C, D and Broken File\r\n\r\nRemove Orphan Files can clean this up for us because it does not use the snapshots which are removed to determine which files to remove. Instead it lists all the files in the table location (A, B, C, D, BrokenFile) and\r\nthen deletes all files which are not referenced by the table. Currently the table only has 1 snapshot, snapshot 3 (B,D).\r\n```\r\n(A, B, C, D, Broken File) but not (B, D) = (A, C, BrokenFile)\r\n```\r\nSo RemoveOrphanFiles will remove 3 files. A, C and BrokenFile\r\n\r\n\r\nSo this is why I consider Remove Orphan Files to be a superset of what ExpireSnapshot removes. I guess it is more correct to say RemoveOrphanFiles will remove all files that should have been removed after ExpireSnapshots even if ExpireSnpashots fails to delete those files for some reason. \r\n\r\nExpire snapshots removes the history and then all the files which were only reachable by that history. Remove OrphanFiles looks at all of the current history and compares it to a raw directory listing. Remove orphan files can clean up a failed ExpireSnapshots, but not the reverse. Remove orphan files is more dangerous because there is a possibility that your table location has files from other projects or the paths have changed in some subtle way that matches on resolution but does not string match. For example if you store paths without authority and change authorities you may have files which are the same, but do not string match correctly.\r\n\r\n-----\r\n\r\nTLDR; \r\n\r\nExpire Snapshots will *never* remove a file that Iceberg will need to read the table with a small caveat for tables which are created as Snapshots of other tables. See GC_ENABLED in table properties.\r\n\r\nRemoveOrphanFiles *should never* remove a file that Iceberg will need to read the table, but since it uses string matching to determine which files to remove there is a chance it can remove necessary files which is why a dry-run flag was introduced. It also will remove any other files in the table location even if they were never part of the Iceberg table.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876111064/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876127259","html_url":"https://github.com/apache/iceberg/issues/2793#issuecomment-876127259","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2793","id":876127259,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjEyNzI1OQ==","user":{"login":"dmgcodevil","id":1413873,"node_id":"MDQ6VXNlcjE0MTM4NzM=","avatar_url":"https://avatars.githubusercontent.com/u/1413873?v=4","gravatar_id":"","url":"https://api.github.com/users/dmgcodevil","html_url":"https://github.com/dmgcodevil","followers_url":"https://api.github.com/users/dmgcodevil/followers","following_url":"https://api.github.com/users/dmgcodevil/following{/other_user}","gists_url":"https://api.github.com/users/dmgcodevil/gists{/gist_id}","starred_url":"https://api.github.com/users/dmgcodevil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmgcodevil/subscriptions","organizations_url":"https://api.github.com/users/dmgcodevil/orgs","repos_url":"https://api.github.com/users/dmgcodevil/repos","events_url":"https://api.github.com/users/dmgcodevil/events{/privacy}","received_events_url":"https://api.github.com/users/dmgcodevil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-08T05:01:44Z","updated_at":"2021-07-08T05:05:26Z","author_association":"CONTRIBUTOR","body":"Understood, let's say we have the following snapshots:\r\n\r\nsnapshot_1 (ts=1) contains files A,B\r\nsnapshot_2 (ts=2) contains files C,D\r\n\r\nts - timestamp\r\n\r\nIf I expire snapshot_1, would I be able to query data from files A and B? Based on your explanation, I should because snapshot_2's  manifest list includes A and B. thus only snapshot_1 metadata can be removed (.metadata.json, snap-*.avro) but not data files: A, B\r\n\r\nwhat will happen if I expire snapshots by timestamp less than 3. will Expire Snapshots delete A, B, C, D ?\r\n\r\ni.e. if I've made a mistake and somehow specified a very large timestamp, it will expire all my snapshots and potentially kill all data files ? I think that `RemoveOrphanFiles ` will definitely delete files. \r\n\r\nLet me explain my case and the outcome. \r\n\r\nI hade a table like the one below \r\n\r\n\r\nsnapshot_1 A, B (2021-07-05)\r\nsnapshot_2 C, D (2021-07-06)\r\n\r\ntable: A,B,C,D\r\n\r\nmy data is partitioned by day\r\n\r\n2021-07-05 contains: A,B,\r\n2021-07-06 contains: C,D\r\nI wanted to combine files from 2021-07-05\r\n\r\n```scala\r\nActions.forTable(table).rewriteDataFiles()\r\n      .filter(Expressions.greaterThanOrEqual(field, startDate * 1000))\r\n      .filter(Expressions.lessThan(field, endDate * 1000))\r\n      .targetSizeInBytes(targetSizeMB * 1024 * 1024)\r\n      .execute()\r\n```\r\n\r\nsnapshot_1 (ts=1) A, B \r\nsnapshot_2 (ts=2) C, D  \r\nsnapshot_3 (ts=3) F - added , A-deleted, B-deleted\r\n\r\nts - timestamp\r\n\r\ntable: C,D,F\r\n\r\n2021-07-05 contains: A,B,F\r\n2021-07-06 contains: C,D\r\n\r\nI executed Expire Snapshots where ts < 3\r\n\r\nAfter this operation, I've noticed that  some files got deleted from `metadata` folder, but A, B were still in data folder: 2021-07-05\r\n\r\nThen I executed `RemoveOrphanFiles `. And noticed that a lot of files 90% removed from metadata folder, some files got deleted from `2021-07-06` and other days (that I didn't expect). I have about 4 months of data, and I noticed some files get deleted from different days, months, etc. \r\n\r\nthe list looks like this:\r\n\r\n```\r\n2020-11-17\r\n2020-11-18\r\n2020-11-19\r\n2020-11-20\r\n2020-11-21\r\n2020-11-22\r\n2020-11-23\r\n2020-11-24\r\n2020-11-25\r\n2020-11-26\r\n2020-11-27\r\n2020-11-28\r\n2020-11-29\r\n2020-11-30\r\n2020-12-01\r\n2020-12-02\r\n2020-12-03\r\n2020-12-04\r\n2020-12-05\r\n2020-12-06\r\n2020-12-07\r\n2020-12-08\r\n2020-12-09\r\n2020-12-10\r\n2020-12-11\r\n2020-12-12\r\n2020-12-13\r\n2020-12-14\r\n2020-12-15\r\n2020-12-16\r\n2020-12-17\r\n2020-12-18\r\n2020-12-19\r\n2020-12-20\r\n2020-12-21\r\n2020-12-22\r\n2020-12-23\r\n2020-12-24\r\n2020-12-25\r\n2020-12-26\r\n2020-12-27\r\n2020-12-28\r\n2020-12-29\r\n2020-12-30\r\n2020-12-31\r\n2021-01-15\r\n2021-01-16\r\n2021-01-17\r\n2021-01-18\r\n2021-01-19\r\n2021-01-20\r\n2021-01-21\r\n2021-01-22\r\n2021-01-23\r\n2021-01-24\r\n2021-01-25\r\n2021-01-26\r\n2021-01-27\r\n2021-01-28\r\n2021-01-29\r\n2021-01-30\r\n2021-01-31\r\n2021-02-01\r\n2021-03-23\r\n2021-03-24\r\n2021-03-25\r\n2021-03-31\r\n2021-04-24\r\n2021-04-28\r\n2021-04-29\r\n2021-05-05\r\n2021-05-07\r\n2021-06-02\r\n```\r\n\r\n\r\nSo, if I accidentally expired all snapshots, then I don't understand why `RemoveOrphanFiles` did not delete all the files. \r\nMaybe those files were never in the table. B/c I know that the spark job was failing periodically.\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876127259/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876202773","html_url":"https://github.com/apache/iceberg/pull/2778#issuecomment-876202773","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2778","id":876202773,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjIwMjc3Mw==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-08T07:30:49Z","updated_at":"2021-07-08T07:30:49Z","author_association":"MEMBER","body":"Got this merged, thanks @haormj for contributing, and thanks @ismailsimsek @XuQianJin-Stars for reviewing !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876202773/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876203735","html_url":"https://github.com/apache/iceberg/issues/2744#issuecomment-876203735","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2744","id":876203735,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjIwMzczNQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-08T07:32:26Z","updated_at":"2021-07-08T07:32:26Z","author_association":"MEMBER","body":"Closed via https://github.com/apache/iceberg/pull/2778","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876203735/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876238560","html_url":"https://github.com/apache/iceberg/pull/2782#issuecomment-876238560","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2782","id":876238560,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjIzODU2MA==","user":{"login":"JustinLeesin","id":15733120,"node_id":"MDQ6VXNlcjE1NzMzMTIw","avatar_url":"https://avatars.githubusercontent.com/u/15733120?v=4","gravatar_id":"","url":"https://api.github.com/users/JustinLeesin","html_url":"https://github.com/JustinLeesin","followers_url":"https://api.github.com/users/JustinLeesin/followers","following_url":"https://api.github.com/users/JustinLeesin/following{/other_user}","gists_url":"https://api.github.com/users/JustinLeesin/gists{/gist_id}","starred_url":"https://api.github.com/users/JustinLeesin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JustinLeesin/subscriptions","organizations_url":"https://api.github.com/users/JustinLeesin/orgs","repos_url":"https://api.github.com/users/JustinLeesin/repos","events_url":"https://api.github.com/users/JustinLeesin/events{/privacy}","received_events_url":"https://api.github.com/users/JustinLeesin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-08T08:23:38Z","updated_at":"2021-07-08T08:23:38Z","author_association":"CONTRIBUTOR","body":"> I also wonder how it should look? If there have only been deletes for example, what will the incremental read return?\r\n\r\nif there have been deletes, then the incremental read should return the deleted dataset with tag D( indicate DELETE events), just like mysql binlog.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876238560/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876284282","html_url":"https://github.com/apache/iceberg/pull/2790#issuecomment-876284282","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2790","id":876284282,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjI4NDI4Mg==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-08T09:27:33Z","updated_at":"2021-07-08T09:27:33Z","author_association":"COLLABORATOR","body":"@pvary Can you please review this? Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876284282/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876381171","html_url":"https://github.com/apache/iceberg/issues/2793#issuecomment-876381171","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2793","id":876381171,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjM4MTE3MQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-08T12:03:50Z","updated_at":"2021-07-08T12:11:03Z","author_association":"MEMBER","body":"You can never expire the current snapshot, so there is never a way that expire snapshots can remove files that are needed to read the current state of the table. It can only remove your ability to query previous versions of the tables.\n\nIf a file was left behind either expire snapshots had an error during deletes or that file was never part of the table. Your example could not happen as described.\n\nRemoveOrphanFiles works similarly but doesn't change snapshots at all so it would not be able to remove the current snapshot either. If it detected that the table owned no files it would delete everything. If you are now receiving query errors it is due to the string matching error I discussed previously where the metadata stored paths do not string match the actual fs.list paths. If when querying the table now you don't see any errors then those files were never part of the table.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876381171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876528796","html_url":"https://github.com/apache/iceberg/pull/2782#issuecomment-876528796","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2782","id":876528796,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjUyODc5Ng==","user":{"login":"ayushchauhan0811","id":10010065,"node_id":"MDQ6VXNlcjEwMDEwMDY1","avatar_url":"https://avatars.githubusercontent.com/u/10010065?v=4","gravatar_id":"","url":"https://api.github.com/users/ayushchauhan0811","html_url":"https://github.com/ayushchauhan0811","followers_url":"https://api.github.com/users/ayushchauhan0811/followers","following_url":"https://api.github.com/users/ayushchauhan0811/following{/other_user}","gists_url":"https://api.github.com/users/ayushchauhan0811/gists{/gist_id}","starred_url":"https://api.github.com/users/ayushchauhan0811/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayushchauhan0811/subscriptions","organizations_url":"https://api.github.com/users/ayushchauhan0811/orgs","repos_url":"https://api.github.com/users/ayushchauhan0811/repos","events_url":"https://api.github.com/users/ayushchauhan0811/events{/privacy}","received_events_url":"https://api.github.com/users/ayushchauhan0811/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-08T15:20:42Z","updated_at":"2021-07-08T15:20:42Z","author_association":"NONE","body":"> if there have been deletes, then the incremental read should return the deleted dataset with tag D( indicate DELETE events), just like mysql binlog.\r\n\r\nI don't agree with this. An incremental scan presents a temp view of the table from one snapshot id to another snapshot id. The logic for handling deletes/presenting data should be the same for an incremental scan as what it would be for the whole table. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876528796/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876533561","html_url":"https://github.com/apache/iceberg/pull/2795#issuecomment-876533561","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2795","id":876533561,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjUzMzU2MQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-08T15:26:47Z","updated_at":"2021-07-08T15:29:15Z","author_association":"MEMBER","body":"Anyone with an M1 could you please try this out :) I don't actually have one @karuppayya or @kbendick I think you have the M1 right?\r\n\r\nWe just need someone with an m1 to run through the test suite locally, specifically the Spark related tests. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876533561/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876782285","html_url":"https://github.com/apache/iceberg/pull/2795#issuecomment-876782285","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2795","id":876782285,"node_id":"MDEyOklzc3VlQ29tbWVudDg3Njc4MjI4NQ==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-08T22:20:33Z","updated_at":"2021-07-08T22:20:33Z","author_association":"CONTRIBUTOR","body":"> Anyone with an M1 could you please try this out :) I don't actually have one @karuppayya or @kbendick I think you have the M1 right?\r\n> \r\n> We just need someone with an m1 to run through the test suite locally, specifically the Spark related tests.\r\n\r\nNo unfortunately I don't have an M1 @RussellSpitzer. I'll let you know if somebody comes to mind.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876782285/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876808101","html_url":"https://github.com/apache/iceberg/pull/2752#issuecomment-876808101","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2752","id":876808101,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjgwODEwMQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-08T23:30:45Z","updated_at":"2021-07-08T23:30:45Z","author_association":"MEMBER","body":"@daksha121 I think we are still waiting on a change to the parameter name. I'm not good on names so I generally am fine with almost anything but I believe we are still hoping for a better name for the parameter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876808101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876815245","html_url":"https://github.com/apache/iceberg/pull/2792#issuecomment-876815245","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2792","id":876815245,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjgxNTI0NQ==","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-08T23:55:01Z","updated_at":"2021-07-09T00:01:11Z","author_association":"CONTRIBUTOR","body":"I believe this is per catalog, not per table, right? Does it also support table level setting?\r\n\r\n> E.g. for a table foo, to override a hadoop config property fs.s3a.max.connections, a config would be added to the spark session config via --conf spark.sql.catalog.foo.hadoop.fs.s3a.max.connections=4.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876815245/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876823379","html_url":"https://github.com/apache/iceberg/pull/2752#issuecomment-876823379","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2752","id":876823379,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjgyMzM3OQ==","user":{"login":"daksha121","id":3859303,"node_id":"MDQ6VXNlcjM4NTkzMDM=","avatar_url":"https://avatars.githubusercontent.com/u/3859303?v=4","gravatar_id":"","url":"https://api.github.com/users/daksha121","html_url":"https://github.com/daksha121","followers_url":"https://api.github.com/users/daksha121/followers","following_url":"https://api.github.com/users/daksha121/following{/other_user}","gists_url":"https://api.github.com/users/daksha121/gists{/gist_id}","starred_url":"https://api.github.com/users/daksha121/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/daksha121/subscriptions","organizations_url":"https://api.github.com/users/daksha121/orgs","repos_url":"https://api.github.com/users/daksha121/repos","events_url":"https://api.github.com/users/daksha121/events{/privacy}","received_events_url":"https://api.github.com/users/daksha121/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T00:17:29Z","updated_at":"2021-07-09T00:17:29Z","author_association":"CONTRIBUTOR","body":"> @daksha121 I think we are still waiting on a change to the parameter name. I'm not good on names so I generally am fine with almost anything but I believe we are still hoping for a better name for the parameter\r\n\r\nI'm not clear on which parameter needs to be renamed.. Are you referring to the new spark option (skip-deletes-on-stream-read) that this PR introduces?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876823379/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876831212","html_url":"https://github.com/apache/iceberg/issues/2793#issuecomment-876831212","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2793","id":876831212,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjgzMTIxMg==","user":{"login":"dmgcodevil","id":1413873,"node_id":"MDQ6VXNlcjE0MTM4NzM=","avatar_url":"https://avatars.githubusercontent.com/u/1413873?v=4","gravatar_id":"","url":"https://api.github.com/users/dmgcodevil","html_url":"https://github.com/dmgcodevil","followers_url":"https://api.github.com/users/dmgcodevil/followers","following_url":"https://api.github.com/users/dmgcodevil/following{/other_user}","gists_url":"https://api.github.com/users/dmgcodevil/gists{/gist_id}","starred_url":"https://api.github.com/users/dmgcodevil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmgcodevil/subscriptions","organizations_url":"https://api.github.com/users/dmgcodevil/orgs","repos_url":"https://api.github.com/users/dmgcodevil/repos","events_url":"https://api.github.com/users/dmgcodevil/events{/privacy}","received_events_url":"https://api.github.com/users/dmgcodevil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T00:40:46Z","updated_at":"2021-07-09T00:40:46Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer thanks for the help and detailed explanation.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876831212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876838920","html_url":"https://github.com/apache/iceberg/pull/2795#issuecomment-876838920","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2795","id":876838920,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjgzODkyMA==","user":{"login":"karuppayya","id":5082742,"node_id":"MDQ6VXNlcjUwODI3NDI=","avatar_url":"https://avatars.githubusercontent.com/u/5082742?v=4","gravatar_id":"","url":"https://api.github.com/users/karuppayya","html_url":"https://github.com/karuppayya","followers_url":"https://api.github.com/users/karuppayya/followers","following_url":"https://api.github.com/users/karuppayya/following{/other_user}","gists_url":"https://api.github.com/users/karuppayya/gists{/gist_id}","starred_url":"https://api.github.com/users/karuppayya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karuppayya/subscriptions","organizations_url":"https://api.github.com/users/karuppayya/orgs","repos_url":"https://api.github.com/users/karuppayya/repos","events_url":"https://api.github.com/users/karuppayya/events{/privacy}","received_events_url":"https://api.github.com/users/karuppayya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T01:05:15Z","updated_at":"2021-07-09T01:05:15Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer I also dont have M1. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876838920/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876848846","html_url":"https://github.com/apache/iceberg/pull/2795#issuecomment-876848846","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2795","id":876848846,"node_id":"MDEyOklzc3VlQ29tbWVudDg3Njg0ODg0Ng==","user":{"login":"KarlManong","id":2627662,"node_id":"MDQ6VXNlcjI2Mjc2NjI=","avatar_url":"https://avatars.githubusercontent.com/u/2627662?v=4","gravatar_id":"","url":"https://api.github.com/users/KarlManong","html_url":"https://github.com/KarlManong","followers_url":"https://api.github.com/users/KarlManong/followers","following_url":"https://api.github.com/users/KarlManong/following{/other_user}","gists_url":"https://api.github.com/users/KarlManong/gists{/gist_id}","starred_url":"https://api.github.com/users/KarlManong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KarlManong/subscriptions","organizations_url":"https://api.github.com/users/KarlManong/orgs","repos_url":"https://api.github.com/users/KarlManong/repos","events_url":"https://api.github.com/users/KarlManong/events{/privacy}","received_events_url":"https://api.github.com/users/KarlManong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T01:36:05Z","updated_at":"2021-07-09T02:23:59Z","author_association":"CONTRIBUTOR","body":"\r\n[build.log](https://github.com/apache/iceberg/files/6788272/build.log)\r\n@RussellSpitzer \r\nOps! Test failed.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876848846/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876890765","html_url":"https://github.com/apache/iceberg/pull/2795#issuecomment-876890765","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2795","id":876890765,"node_id":"MDEyOklzc3VlQ29tbWVudDg3Njg5MDc2NQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T03:46:23Z","updated_at":"2021-07-09T03:46:23Z","author_association":"MEMBER","body":"> [build.log](https://github.com/apache/iceberg/files/6788272/build.log)\r\n> @RussellSpitzer\r\n> Ops! Test failed.\r\n\r\nCan you see whether snappy-java-1.1.8.2.jar was successfully included? I checked the contents\r\n```\r\ntar -tvf snappy-java-1.1.8.2.jar | grep -Hsi Mac\r\n(standard input):drwxrwxr-x  0 0      0           0 Nov 28  2020 org/xerial/snappy/native/Mac/\r\n(standard input):drwxrwxr-x  0 0      0           0 Nov 28  2020 org/xerial/snappy/native/Mac/aarch64/\r\n(standard input):-rw-rw-r--  0 0      0       71184 Nov 28  2020 org/xerial/snappy/native/Mac/aarch64/libsnappyjava.dylib\r\n```\r\nIt has the right native lib in the snappy jar\r\n\r\nand when I run the suite it uses this jar\r\n\r\n![image](https://user-images.githubusercontent.com/413025/125020348-4e3ac280-e03e-11eb-8990-273b3c3ab976.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876890765/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876953384","html_url":"https://github.com/apache/iceberg/pull/2795#issuecomment-876953384","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2795","id":876953384,"node_id":"MDEyOklzc3VlQ29tbWVudDg3Njk1MzM4NA==","user":{"login":"KarlManong","id":2627662,"node_id":"MDQ6VXNlcjI2Mjc2NjI=","avatar_url":"https://avatars.githubusercontent.com/u/2627662?v=4","gravatar_id":"","url":"https://api.github.com/users/KarlManong","html_url":"https://github.com/KarlManong","followers_url":"https://api.github.com/users/KarlManong/followers","following_url":"https://api.github.com/users/KarlManong/following{/other_user}","gists_url":"https://api.github.com/users/KarlManong/gists{/gist_id}","starred_url":"https://api.github.com/users/KarlManong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KarlManong/subscriptions","organizations_url":"https://api.github.com/users/KarlManong/orgs","repos_url":"https://api.github.com/users/KarlManong/repos","events_url":"https://api.github.com/users/KarlManong/events{/privacy}","received_events_url":"https://api.github.com/users/KarlManong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T06:39:10Z","updated_at":"2021-07-09T06:39:10Z","author_association":"CONTRIBUTOR","body":"> > [build.log](https://github.com/apache/iceberg/files/6788272/build.log)\r\n> > @RussellSpitzer\r\n> > Ops! Test failed.\r\n> \r\n> Can you see whether snappy-java-1.1.8.2.jar was successfully included? I checked the contents\r\n> \r\n> ```\r\n> tar -tvf snappy-java-1.1.8.2.jar | grep -Hsi Mac\r\n> (standard input):drwxrwxr-x  0 0      0           0 Nov 28  2020 org/xerial/snappy/native/Mac/\r\n> (standard input):drwxrwxr-x  0 0      0           0 Nov 28  2020 org/xerial/snappy/native/Mac/aarch64/\r\n> (standard input):-rw-rw-r--  0 0      0       71184 Nov 28  2020 org/xerial/snappy/native/Mac/aarch64/libsnappyjava.dylib\r\n> ```\r\n> \r\n> It has the right native lib in the snappy jar\r\n> \r\n> and when I run the suite it uses this jar\r\n> \r\n> ![image](https://user-images.githubusercontent.com/413025/125020348-4e3ac280-e03e-11eb-8990-273b3c3ab976.png)\r\n\r\nSorry, I ran on the wrong branch.\r\n\r\nThe fix works.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/876953384/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877021027","html_url":"https://github.com/apache/iceberg/pull/2746#issuecomment-877021027","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2746","id":877021027,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NzAyMTAyNw==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T08:41:10Z","updated_at":"2021-07-09T08:41:10Z","author_association":"CONTRIBUTOR","body":"@rdblue: @nastra suggested merging this w/o squashing as each commit atomically refactors a single class. WDYT?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877021027/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877027983","html_url":"https://github.com/apache/iceberg/pull/2797#issuecomment-877027983","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2797","id":877027983,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NzAyNzk4Mw==","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T08:52:13Z","updated_at":"2021-07-09T08:52:13Z","author_association":"CONTRIBUTOR","body":"@rdblue can you review this one please?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877027983/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877138901","html_url":"https://github.com/apache/iceberg/pull/2797#issuecomment-877138901","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2797","id":877138901,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NzEzODkwMQ==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T12:07:28Z","updated_at":"2021-07-09T12:07:28Z","author_association":"CONTRIBUTOR","body":"@nastra just to double check, this doesn't change anything in terms of test order, log messages, etc it only enables us to use the new junit. Correct?\r\n\r\nWhat does mixed junit4 and junit5 look like? Can we have a module or class w/ annotations from both versions? Is there any danger in that? Would the recommendation be to use junit5 on new tests?\r\n\r\ncc @rdblue @aokolnychyi @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877138901/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877161154","html_url":"https://github.com/apache/iceberg/issues/2786#issuecomment-877161154","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2786","id":877161154,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NzE2MTE1NA==","user":{"login":"be-rock","id":15165956,"node_id":"MDQ6VXNlcjE1MTY1OTU2","avatar_url":"https://avatars.githubusercontent.com/u/15165956?v=4","gravatar_id":"","url":"https://api.github.com/users/be-rock","html_url":"https://github.com/be-rock","followers_url":"https://api.github.com/users/be-rock/followers","following_url":"https://api.github.com/users/be-rock/following{/other_user}","gists_url":"https://api.github.com/users/be-rock/gists{/gist_id}","starred_url":"https://api.github.com/users/be-rock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/be-rock/subscriptions","organizations_url":"https://api.github.com/users/be-rock/orgs","repos_url":"https://api.github.com/users/be-rock/repos","events_url":"https://api.github.com/users/be-rock/events{/privacy}","received_events_url":"https://api.github.com/users/be-rock/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T12:46:47Z","updated_at":"2021-07-09T12:46:47Z","author_association":"NONE","body":"The home page, labeled \"Time travel\".","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877161154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877161994","html_url":"https://github.com/apache/iceberg/issues/2786#issuecomment-877161994","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2786","id":877161994,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NzE2MTk5NA==","user":{"login":"be-rock","id":15165956,"node_id":"MDQ6VXNlcjE1MTY1OTU2","avatar_url":"https://avatars.githubusercontent.com/u/15165956?v=4","gravatar_id":"","url":"https://api.github.com/users/be-rock","html_url":"https://github.com/be-rock","followers_url":"https://api.github.com/users/be-rock/followers","following_url":"https://api.github.com/users/be-rock/following{/other_user}","gists_url":"https://api.github.com/users/be-rock/gists{/gist_id}","starred_url":"https://api.github.com/users/be-rock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/be-rock/subscriptions","organizations_url":"https://api.github.com/users/be-rock/orgs","repos_url":"https://api.github.com/users/be-rock/repos","events_url":"https://api.github.com/users/be-rock/events{/privacy}","received_events_url":"https://api.github.com/users/be-rock/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T12:48:18Z","updated_at":"2021-07-09T12:48:18Z","author_association":"NONE","body":"And multiple here labeled \"Spark SQL\": https://iceberg.apache.org/evolution/#partition-evolution","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877161994/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877219901","html_url":"https://github.com/apache/iceberg/pull/2797#issuecomment-877219901","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2797","id":877219901,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NzIxOTkwMQ==","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T14:13:29Z","updated_at":"2021-07-09T14:13:29Z","author_association":"CONTRIBUTOR","body":"> @nastra just to double check, this doesn't change anything in terms of test order, log messages, etc it only enables us to use the new junit. Correct?\r\n\r\nThere shouldn't be any real differences in terms of test execution or the like. As stated in the PR description, `junit-vintage-engine` is what's responsible for running JUnit 4 compatible tests, which uses **4.13**. One limitation that's worth mentioning is probably the limited support for JUnit4 native rules as stated [here](https://junit.org/junit5/docs/current/user-guide/#migrating-from-junit4-rule-support) but I don't think that this affects the Iceberg project as I haven't seen any custom Rules in the project.\r\n\r\n> What does mixed junit4 and junit5 look like? Can we have a module or class w/ annotations from both versions? Is there any danger in that? Would the recommendation be to use junit5 on new tests?\r\n\r\nI haven't really tried a mixed scenario of JUnit4 & JUnit5 within the same class and I would assume that one would rather fully write either JUnit4 or JUnit5 code within the same class. I would probably recommend writing JUnit5 style tests for new code, but it doesn't really matter, as people can still just write JUnit4 code as they were used to.\r\n\r\nHaving people write JUnit5 tests for new stuff would probably only matter if the project at some point would like to migrate all existing JUnit4 tests to JUnit5, but I don't think that will happen in the near future.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877219901/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877241002","html_url":"https://github.com/apache/iceberg/pull/2795#issuecomment-877241002","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2795","id":877241002,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NzI0MTAwMg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T14:44:46Z","updated_at":"2021-07-09T14:44:46Z","author_association":"MEMBER","body":"Thats good enough for me! Thanks for testing @KarlManong!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877241002/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877272752","html_url":"https://github.com/apache/iceberg/pull/2752#issuecomment-877272752","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2752","id":877272752,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NzI3Mjc1Mg==","user":{"login":"daksha121","id":3859303,"node_id":"MDQ6VXNlcjM4NTkzMDM=","avatar_url":"https://avatars.githubusercontent.com/u/3859303?v=4","gravatar_id":"","url":"https://api.github.com/users/daksha121","html_url":"https://github.com/daksha121","followers_url":"https://api.github.com/users/daksha121/followers","following_url":"https://api.github.com/users/daksha121/following{/other_user}","gists_url":"https://api.github.com/users/daksha121/gists{/gist_id}","starred_url":"https://api.github.com/users/daksha121/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/daksha121/subscriptions","organizations_url":"https://api.github.com/users/daksha121/orgs","repos_url":"https://api.github.com/users/daksha121/repos","events_url":"https://api.github.com/users/daksha121/events{/privacy}","received_events_url":"https://api.github.com/users/daksha121/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T15:33:43Z","updated_at":"2021-07-09T15:33:43Z","author_association":"CONTRIBUTOR","body":"> > @daksha121 I think we are still waiting on a change to the parameter name. I'm not good on names so I generally am fine with almost anything but I believe we are still hoping for a better name for the parameter\r\n> \r\n> I'm not clear on which parameter needs to be renamed.. Are you referring to the new spark option (skip-deletes-on-stream-read) that this PR introduces?\r\n\r\n@RussellSpitzer how about just:\r\n- skip-deletes OR\r\n- ignore-deletes","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877272752/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877274098","html_url":"https://github.com/apache/iceberg/pull/2752#issuecomment-877274098","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2752","id":877274098,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NzI3NDA5OA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T15:35:53Z","updated_at":"2021-07-09T15:35:53Z","author_association":"MEMBER","body":"@rdblue what do you think? I'm fine with `streaming.ignore-deletes` or anything like that. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877274098/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877285891","html_url":"https://github.com/apache/iceberg/issues/2786#issuecomment-877285891","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2786","id":877285891,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NzI4NTg5MQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T15:55:06Z","updated_at":"2021-07-09T15:55:46Z","author_association":"MEMBER","body":"Found 5 occurrences\r\n\r\naws.md\r\nevolution.md (2)\r\nspark-streaming.md (2)\r\n\r\nWill post a fix asap","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877285891/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877316189","html_url":"https://github.com/apache/iceberg/pull/2754#issuecomment-877316189","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2754","id":877316189,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NzMxNjE4OQ==","user":{"login":"zuston","id":8609142,"node_id":"MDQ6VXNlcjg2MDkxNDI=","avatar_url":"https://avatars.githubusercontent.com/u/8609142?v=4","gravatar_id":"","url":"https://api.github.com/users/zuston","html_url":"https://github.com/zuston","followers_url":"https://api.github.com/users/zuston/followers","following_url":"https://api.github.com/users/zuston/following{/other_user}","gists_url":"https://api.github.com/users/zuston/gists{/gist_id}","starred_url":"https://api.github.com/users/zuston/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zuston/subscriptions","organizations_url":"https://api.github.com/users/zuston/orgs","repos_url":"https://api.github.com/users/zuston/repos","events_url":"https://api.github.com/users/zuston/events{/privacy}","received_events_url":"https://api.github.com/users/zuston/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T16:42:58Z","updated_at":"2021-07-09T16:42:58Z","author_association":"MEMBER","body":"You means that expired ugi is remained in single thread? @jshmchenxi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877316189/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877340196","html_url":"https://github.com/apache/iceberg/pull/2801#issuecomment-877340196","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2801","id":877340196,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NzM0MDE5Ng==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T17:23:57Z","updated_at":"2021-07-09T17:23:57Z","author_association":"MEMBER","body":"@be-rock + @rdblue Fix here to doc links. Manually verified links work now","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877340196/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877393876","html_url":"https://github.com/apache/iceberg/pull/2797#issuecomment-877393876","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2797","id":877393876,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NzM5Mzg3Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T18:58:00Z","updated_at":"2021-07-09T18:58:00Z","author_association":"CONTRIBUTOR","body":"@nastra, what are you planning to do with extensions?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877393876/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877394870","html_url":"https://github.com/apache/iceberg/pull/2801#issuecomment-877394870","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2801","id":877394870,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NzM5NDg3MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T19:00:07Z","updated_at":"2021-07-09T19:00:07Z","author_association":"CONTRIBUTOR","body":"Thanks, @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877394870/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877396902","html_url":"https://github.com/apache/iceberg/pull/2792#issuecomment-877396902","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2792","id":877396902,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NzM5NjkwMg==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T19:03:40Z","updated_at":"2021-07-09T19:23:32Z","author_association":"CONTRIBUTOR","body":"> I believe this is per catalog, not per table, right? Does it also support table level setting?\r\n> \r\n> > E.g. for a table foo, to override a hadoop config property fs.s3a.max.connections, a config would be added to the spark session config via --conf spark.sql.catalog.foo.hadoop.fs.s3a.max.connections=4.\r\n\r\nThat's correct. I have updated the description to mention catalog instead (as there's no way to change the hadoop config for multiple Iceberg tables in the same catalog).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877396902/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877413993","html_url":"https://github.com/apache/iceberg/pull/2752#issuecomment-877413993","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2752","id":877413993,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NzQxMzk5Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T19:37:45Z","updated_at":"2021-07-09T19:37:45Z","author_association":"CONTRIBUTOR","body":"We try not to use namespaces in the read options to keep them simple. This one is a bit odd because `ignore-deletes` could be misinterpreted easily -- we don't want anyone to think they can read a table without applying delete files, for example. So I want to make it clear that this is streaming and that this not delete files. The best I'm coming up with is `skip-delete-snapshots`, which is clear that it is referring to snapshot operations. I don't think it would be misinterpreted if it were used in a batch context since it wouldn't make sense to run a select that doesn't do anything if the latest snapshot is a delete.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877413993/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877438116","html_url":"https://github.com/apache/iceberg/pull/2797#issuecomment-877438116","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2797","id":877438116,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NzQzODExNg==","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T20:26:10Z","updated_at":"2021-07-09T20:26:10Z","author_association":"CONTRIBUTOR","body":"We're planning to use extensions so that we can start/stop a nessie server\nin tests without adding Quarkus dependencies to the project. Right now this\nis solved via Gradle Plugins in Nessie itself but it's a bit of a pain to\nmaintain it this way.\n\nOn Fri, Jul 9, 2021, 20:58 Ryan Blue ***@***.***> wrote:\n\n> @nastra <https://github.com/nastra>, what are you planning to do with\n> extensions?\n>\n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/iceberg/pull/2797#issuecomment-877393876>, or\n> unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AACCFNIUJRUCJKBTAPCLK6LTW5BEHANCNFSM5ACF264A>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877438116/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877455455","html_url":"https://github.com/apache/iceberg/pull/2797#issuecomment-877455455","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2797","id":877455455,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NzQ1NTQ1NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-07-09T21:04:50Z","updated_at":"2021-07-09T21:04:50Z","author_association":"CONTRIBUTOR","body":"It all looks good to me and tests are passing. I just have one minor comment.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/877455455/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]