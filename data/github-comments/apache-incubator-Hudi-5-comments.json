[{"url":"https://api.github.com/repos/apache/hudi/issues/comments/319740227","html_url":"https://github.com/apache/hudi/pull/230#issuecomment-319740227","issue_url":"https://api.github.com/repos/apache/hudi/issues/230","id":319740227,"node_id":"MDEyOklzc3VlQ29tbWVudDMxOTc0MDIyNw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-02T17:22:22Z","updated_at":"2017-08-02T17:22:22Z","author_association":"MEMBER","body":"is there a simple tweak to jenkins build configs or do we need to go down the route of supressing logs? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/319740227/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/319763705","html_url":"https://github.com/apache/hudi/pull/191#issuecomment-319763705","issue_url":"https://api.github.com/repos/apache/hudi/issues/191","id":319763705,"node_id":"MDEyOklzc3VlQ29tbWVudDMxOTc2MzcwNQ==","user":{"login":"prazanna","id":1994157,"node_id":"MDQ6VXNlcjE5OTQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/1994157?v=4","gravatar_id":"","url":"https://api.github.com/users/prazanna","html_url":"https://github.com/prazanna","followers_url":"https://api.github.com/users/prazanna/followers","following_url":"https://api.github.com/users/prazanna/following{/other_user}","gists_url":"https://api.github.com/users/prazanna/gists{/gist_id}","starred_url":"https://api.github.com/users/prazanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prazanna/subscriptions","organizations_url":"https://api.github.com/users/prazanna/orgs","repos_url":"https://api.github.com/users/prazanna/repos","events_url":"https://api.github.com/users/prazanna/events{/privacy}","received_events_url":"https://api.github.com/users/prazanna/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-02T18:50:05Z","updated_at":"2017-08-02T18:50:05Z","author_association":"CONTRIBUTOR","body":"@gekath - Do you have any updates on this PR? Thanks.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/319763705/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/319764354","html_url":"https://github.com/apache/hudi/pull/217#issuecomment-319764354","issue_url":"https://api.github.com/repos/apache/hudi/issues/217","id":319764354,"node_id":"MDEyOklzc3VlQ29tbWVudDMxOTc2NDM1NA==","user":{"login":"prazanna","id":1994157,"node_id":"MDQ6VXNlcjE5OTQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/1994157?v=4","gravatar_id":"","url":"https://api.github.com/users/prazanna","html_url":"https://github.com/prazanna","followers_url":"https://api.github.com/users/prazanna/followers","following_url":"https://api.github.com/users/prazanna/following{/other_user}","gists_url":"https://api.github.com/users/prazanna/gists{/gist_id}","starred_url":"https://api.github.com/users/prazanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prazanna/subscriptions","organizations_url":"https://api.github.com/users/prazanna/orgs","repos_url":"https://api.github.com/users/prazanna/repos","events_url":"https://api.github.com/users/prazanna/events{/privacy}","received_events_url":"https://api.github.com/users/prazanna/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-02T18:52:41Z","updated_at":"2017-08-02T18:52:41Z","author_association":"CONTRIBUTOR","body":"@n3nash - Can you address @vinothchandar 's comments for this one? Also if this PR is supposed to be for the uber/mor_mvp branch - please change the PR with the correct target branch. Thanks.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/319764354/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/319765962","html_url":"https://github.com/apache/hudi/pull/230#issuecomment-319765962","issue_url":"https://api.github.com/repos/apache/hudi/issues/230","id":319765962,"node_id":"MDEyOklzc3VlQ29tbWVudDMxOTc2NTk2Mg==","user":{"login":"prazanna","id":1994157,"node_id":"MDQ6VXNlcjE5OTQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/1994157?v=4","gravatar_id":"","url":"https://api.github.com/users/prazanna","html_url":"https://github.com/prazanna","followers_url":"https://api.github.com/users/prazanna/followers","following_url":"https://api.github.com/users/prazanna/following{/other_user}","gists_url":"https://api.github.com/users/prazanna/gists{/gist_id}","starred_url":"https://api.github.com/users/prazanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prazanna/subscriptions","organizations_url":"https://api.github.com/users/prazanna/orgs","repos_url":"https://api.github.com/users/prazanna/repos","events_url":"https://api.github.com/users/prazanna/events{/privacy}","received_events_url":"https://api.github.com/users/prazanna/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-02T18:58:27Z","updated_at":"2017-08-02T18:58:27Z","author_association":"CONTRIBUTOR","body":"We need to supress log. I did this before with the log4j-surefire.properties. See e.g. hoodie-common/test/resources. Play with it and increase specific log levels to higher (WARN or ERROR) to avoid them being printed on the console. @n3nash ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/319765962/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/319842329","html_url":"https://github.com/apache/hudi/pull/191#issuecomment-319842329","issue_url":"https://api.github.com/repos/apache/hudi/issues/191","id":319842329,"node_id":"MDEyOklzc3VlQ29tbWVudDMxOTg0MjMyOQ==","user":{"login":"zqureshi","id":233658,"node_id":"MDQ6VXNlcjIzMzY1OA==","avatar_url":"https://avatars.githubusercontent.com/u/233658?v=4","gravatar_id":"","url":"https://api.github.com/users/zqureshi","html_url":"https://github.com/zqureshi","followers_url":"https://api.github.com/users/zqureshi/followers","following_url":"https://api.github.com/users/zqureshi/following{/other_user}","gists_url":"https://api.github.com/users/zqureshi/gists{/gist_id}","starred_url":"https://api.github.com/users/zqureshi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zqureshi/subscriptions","organizations_url":"https://api.github.com/users/zqureshi/orgs","repos_url":"https://api.github.com/users/zqureshi/repos","events_url":"https://api.github.com/users/zqureshi/events{/privacy}","received_events_url":"https://api.github.com/users/zqureshi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-03T01:26:47Z","updated_at":"2017-08-03T01:26:47Z","author_association":"CONTRIBUTOR","body":"@prazanna not much progress on this front yet.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/319842329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320088044","html_url":"https://github.com/apache/hudi/issues/233#issuecomment-320088044","issue_url":"https://api.github.com/repos/apache/hudi/issues/233","id":320088044,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMDA4ODA0NA==","user":{"login":"gekath","id":9555999,"node_id":"MDQ6VXNlcjk1NTU5OTk=","avatar_url":"https://avatars.githubusercontent.com/u/9555999?v=4","gravatar_id":"","url":"https://api.github.com/users/gekath","html_url":"https://github.com/gekath","followers_url":"https://api.github.com/users/gekath/followers","following_url":"https://api.github.com/users/gekath/following{/other_user}","gists_url":"https://api.github.com/users/gekath/gists{/gist_id}","starred_url":"https://api.github.com/users/gekath/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gekath/subscriptions","organizations_url":"https://api.github.com/users/gekath/orgs","repos_url":"https://api.github.com/users/gekath/repos","events_url":"https://api.github.com/users/gekath/events{/privacy}","received_events_url":"https://api.github.com/users/gekath/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-03T20:57:22Z","updated_at":"2017-08-03T20:57:22Z","author_association":"CONTRIBUTOR","body":"@zqureshi ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320088044/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320097284","html_url":"https://github.com/apache/hudi/issues/233#issuecomment-320097284","issue_url":"https://api.github.com/repos/apache/hudi/issues/233","id":320097284,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMDA5NzI4NA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-03T21:38:19Z","updated_at":"2017-08-03T21:38:19Z","author_association":"MEMBER","body":"Okay problem is `basePath.getName()` (since I did not want to do a basePath.getString() which may contain the scheme e.g: hdfs://tmp/blogs/blogs).  \r\n\r\nCould you workaround this for now, by naming them different? I ll think of something and fix it in sometime. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320097284/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320118863","html_url":"https://github.com/apache/hudi/pull/234#issuecomment-320118863","issue_url":"https://api.github.com/repos/apache/hudi/issues/234","id":320118863,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMDExODg2Mw==","user":{"login":"jianxu","id":10394074,"node_id":"MDQ6VXNlcjEwMzk0MDc0","avatar_url":"https://avatars.githubusercontent.com/u/10394074?v=4","gravatar_id":"","url":"https://api.github.com/users/jianxu","html_url":"https://github.com/jianxu","followers_url":"https://api.github.com/users/jianxu/followers","following_url":"https://api.github.com/users/jianxu/following{/other_user}","gists_url":"https://api.github.com/users/jianxu/gists{/gist_id}","starred_url":"https://api.github.com/users/jianxu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jianxu/subscriptions","organizations_url":"https://api.github.com/users/jianxu/orgs","repos_url":"https://api.github.com/users/jianxu/repos","events_url":"https://api.github.com/users/jianxu/events{/privacy}","received_events_url":"https://api.github.com/users/jianxu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-03T23:44:56Z","updated_at":"2017-08-03T23:44:56Z","author_association":"CONTRIBUTOR","body":"yes, nested fields work and tested in a local HDFS setup.  Hive will read the entire column for ```a``` if ```a.b``` or ```a.b.c``` is queries.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320118863/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320339722","html_url":"https://github.com/apache/hudi/pull/232#issuecomment-320339722","issue_url":"https://api.github.com/repos/apache/hudi/issues/232","id":320339722,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMDMzOTcyMg==","user":{"login":"ovj","id":899843,"node_id":"MDQ6VXNlcjg5OTg0Mw==","avatar_url":"https://avatars.githubusercontent.com/u/899843?v=4","gravatar_id":"","url":"https://api.github.com/users/ovj","html_url":"https://github.com/ovj","followers_url":"https://api.github.com/users/ovj/followers","following_url":"https://api.github.com/users/ovj/following{/other_user}","gists_url":"https://api.github.com/users/ovj/gists{/gist_id}","starred_url":"https://api.github.com/users/ovj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ovj/subscriptions","organizations_url":"https://api.github.com/users/ovj/orgs","repos_url":"https://api.github.com/users/ovj/repos","events_url":"https://api.github.com/users/ovj/events{/privacy}","received_events_url":"https://api.github.com/users/ovj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-04T19:57:46Z","updated_at":"2017-08-04T19:57:46Z","author_association":"CONTRIBUTOR","body":"Thanks @vinothchandar for the change.\r\n\r\nRan below test with and without range pruning. Saw large improvement for \"filterExists\" query. Rough idea about the dataset which was purposefully created to test it.\r\n- 1000 files with approximately 500M each.\r\n- Each file is having ~2M records. (200M records were inserted with 100 parallelism for bulkInsert to create dataset.)\r\n- Now ran 2 workloads one with range pruning and another one without it. With the change it took ~15-30min to do filter exists vs 2.5hrs+ for without it (existing change). Didn't notice any stage taking too much time or is having very high parallelism.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320339722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320340070","html_url":"https://github.com/apache/hudi/pull/232#issuecomment-320340070","issue_url":"https://api.github.com/repos/apache/hudi/issues/232","id":320340070,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMDM0MDA3MA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-04T19:59:47Z","updated_at":"2017-08-04T19:59:47Z","author_association":"MEMBER","body":"@ovj thanks for testing it out, looks like a win . \r\n\r\n@alunarbeach can you please your exp as well? it would be helpful \r\n\r\n@prazanna any other concerns before I merge this? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320340070/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320346016","html_url":"https://github.com/apache/hudi/pull/232#issuecomment-320346016","issue_url":"https://api.github.com/repos/apache/hudi/issues/232","id":320346016,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMDM0NjAxNg==","user":{"login":"alunarbeach","id":494035,"node_id":"MDQ6VXNlcjQ5NDAzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/494035?v=4","gravatar_id":"","url":"https://api.github.com/users/alunarbeach","html_url":"https://github.com/alunarbeach","followers_url":"https://api.github.com/users/alunarbeach/followers","following_url":"https://api.github.com/users/alunarbeach/following{/other_user}","gists_url":"https://api.github.com/users/alunarbeach/gists{/gist_id}","starred_url":"https://api.github.com/users/alunarbeach/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alunarbeach/subscriptions","organizations_url":"https://api.github.com/users/alunarbeach/orgs","repos_url":"https://api.github.com/users/alunarbeach/repos","events_url":"https://api.github.com/users/alunarbeach/events{/privacy}","received_events_url":"https://api.github.com/users/alunarbeach/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-04T20:28:58Z","updated_at":"2017-08-04T20:28:58Z","author_association":"CONTRIBUTOR","body":"Ran the below test with and without range pruning. \r\nDid a Bulk Insert of the dataset is ~474M records (~110 GB Snappy Parquet). Key is a combination of date + uuid. Then did a upsert of 57M records over the 474M records.\r\n\r\nPartition Fields - DayId, HourId\r\nWithout Range pruning:\r\nBULK_INSERT Time - 1 Hr 33 Min\r\nUpsert Time - 1 Hr 29 Min\r\n\r\nWith Range Pruning:\r\nBULK_INSERT Time - 1 Hr 32 Min\r\nUpsert Time - 1 hr.\r\n\r\nThis is a huge win for the overall run time.\r\nThanks @vinothchandar \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320346016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320346106","html_url":"https://github.com/apache/hudi/pull/234#issuecomment-320346106","issue_url":"https://api.github.com/repos/apache/hudi/issues/234","id":320346106,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMDM0NjEwNg==","user":{"login":"prazanna","id":1994157,"node_id":"MDQ6VXNlcjE5OTQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/1994157?v=4","gravatar_id":"","url":"https://api.github.com/users/prazanna","html_url":"https://github.com/prazanna","followers_url":"https://api.github.com/users/prazanna/followers","following_url":"https://api.github.com/users/prazanna/following{/other_user}","gists_url":"https://api.github.com/users/prazanna/gists{/gist_id}","starred_url":"https://api.github.com/users/prazanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prazanna/subscriptions","organizations_url":"https://api.github.com/users/prazanna/orgs","repos_url":"https://api.github.com/users/prazanna/repos","events_url":"https://api.github.com/users/prazanna/events{/privacy}","received_events_url":"https://api.github.com/users/prazanna/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-04T20:29:26Z","updated_at":"2017-08-04T20:29:26Z","author_association":"CONTRIBUTOR","body":"Looks good to me! Congrats @jianxu on your first contribution","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320346106/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320350170","html_url":"https://github.com/apache/hudi/pull/232#issuecomment-320350170","issue_url":"https://api.github.com/repos/apache/hudi/issues/232","id":320350170,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMDM1MDE3MA==","user":{"login":"prazanna","id":1994157,"node_id":"MDQ6VXNlcjE5OTQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/1994157?v=4","gravatar_id":"","url":"https://api.github.com/users/prazanna","html_url":"https://github.com/prazanna","followers_url":"https://api.github.com/users/prazanna/followers","following_url":"https://api.github.com/users/prazanna/following{/other_user}","gists_url":"https://api.github.com/users/prazanna/gists{/gist_id}","starred_url":"https://api.github.com/users/prazanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prazanna/subscriptions","organizations_url":"https://api.github.com/users/prazanna/orgs","repos_url":"https://api.github.com/users/prazanna/repos","events_url":"https://api.github.com/users/prazanna/events{/privacy}","received_events_url":"https://api.github.com/users/prazanna/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-04T20:50:40Z","updated_at":"2017-08-04T20:50:40Z","author_association":"CONTRIBUTOR","body":"@alunarbeach this is awesome to know","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320350170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320380030","html_url":"https://github.com/apache/hudi/pull/235#issuecomment-320380030","issue_url":"https://api.github.com/repos/apache/hudi/issues/235","id":320380030,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMDM4MDAzMA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-05T00:36:18Z","updated_at":"2017-08-05T00:36:18Z","author_association":"MEMBER","body":"fyi @n3nash @prazanna .. I think the rebase did have a test break, based on auto merge\r\n\r\nNishith, do you have idea what might be going on here? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320380030/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320559119","html_url":"https://github.com/apache/hudi/issues/231#issuecomment-320559119","issue_url":"https://api.github.com/repos/apache/hudi/issues/231","id":320559119,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMDU1OTExOQ==","user":{"login":"littleRa1n","id":25076027,"node_id":"MDQ6VXNlcjI1MDc2MDI3","avatar_url":"https://avatars.githubusercontent.com/u/25076027?v=4","gravatar_id":"","url":"https://api.github.com/users/littleRa1n","html_url":"https://github.com/littleRa1n","followers_url":"https://api.github.com/users/littleRa1n/followers","following_url":"https://api.github.com/users/littleRa1n/following{/other_user}","gists_url":"https://api.github.com/users/littleRa1n/gists{/gist_id}","starred_url":"https://api.github.com/users/littleRa1n/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/littleRa1n/subscriptions","organizations_url":"https://api.github.com/users/littleRa1n/orgs","repos_url":"https://api.github.com/users/littleRa1n/repos","events_url":"https://api.github.com/users/littleRa1n/events{/privacy}","received_events_url":"https://api.github.com/users/littleRa1n/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-07T03:17:01Z","updated_at":"2017-08-07T03:17:01Z","author_association":"NONE","body":"can you give a example? Is there any date formmat in hoodie?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320559119/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320754910","html_url":"https://github.com/apache/hudi/pull/234#issuecomment-320754910","issue_url":"https://api.github.com/repos/apache/hudi/issues/234","id":320754910,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMDc1NDkxMA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-07T19:16:33Z","updated_at":"2017-08-07T19:17:05Z","author_association":"MEMBER","body":" Ideally, we need the following matrix tested well, before we can call this support done.  \r\n\r\n|  Engine | Map datatype   |  Array/List data type  | Nested projection  |\r\n|---|---|---|---|\r\n|  Spark |   |   |   |  \r\n|  Hive |   |   |   |\r\n|  Presto |   |   |   |\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320754910/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320862206","html_url":"https://github.com/apache/hudi/pull/217#issuecomment-320862206","issue_url":"https://api.github.com/repos/apache/hudi/issues/217","id":320862206,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMDg2MjIwNg==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-08T06:23:53Z","updated_at":"2017-08-08T06:24:31Z","author_association":"CONTRIBUTOR","body":"This issue is fixed in master here : https://github.com/uber/hoodie/pull/228. This needs to be either backported to hoodie-mor-mvp branch or merge hoodie-mor-mvp branch with master.\r\n\r\n@vinothchandar @jianxu FYI.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320862206/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320884338","html_url":"https://github.com/apache/hudi/issues/40#issuecomment-320884338","issue_url":"https://api.github.com/repos/apache/hudi/issues/40","id":320884338,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMDg4NDMzOA==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-08T08:12:01Z","updated_at":"2017-08-08T08:12:01Z","author_association":"CONTRIBUTOR","body":"@vinothchandar @prasanna @jianxu please share thoughts/comments.\r\n\r\n**Requirements** \r\nAbility to rollback any inflight or proper commit. Essentially, `rollback(commit)` should make sure that no data corresponding to that commit is used either from generated parquet files (`commit, deltacommit or compaction commit`) or from appended log files (`deltacommit`).\r\n\r\n**Scenarios**\r\n\r\n1) Rollback of an inflight commit\r\nAn inflight commit file does not contain any details about the current ingestion batch. If an ingestion batch fails during inflight, the inflight commit file has no information on what happened during that batch. All information about the batch is written at the end, after all records have been ingested. \r\n\r\n2) Rollback of a non-inflight commit\r\nAny non-inflight commit (commit, deltacommit or compaction commit) contains complete information of the ingestion batch, namely, which HoodieDataFiles and HoodieLogFiles were affected.\r\n\r\n**Solution 1** \r\n\r\n_Part 1_\r\n\r\n| CommitType |  Solution |\r\n| --- | --- |\r\n| COMMIT/COMPACTION |  1) Read commit metadata 2) Find parquet files corresponding to commit and delete them 3) update rollback stats 4) delete commit file 5) write a .rollback file |\r\n| DELTACOMMIT | 1) Read commit metadata 2) Find log files corresponding to base commit and write rollback blocks 3) update rollback stats 4) delete commit file 5) write a .rollback file  |\r\n| INFLIGHT | 1) Delete inflight commit file 2) write a .rollback file |\r\n\r\n_Part 2_\r\n\r\n`HoodieCompactedLogRecordScanner` implements a logic to discard all data not belonging to a safe commit. A safe commit = commit present in commitTimeline or commit < earliestCommit in timeline. To achieve this, we need to add a commitTime to each HoodieLogBlock and then during compaction (RecordReader or actual compaction) ignore the LogBlocks whose commit time is not safe.\r\n\r\n**Solution 2** \r\n\r\n_Part 1_\r\n\r\nChange the way commit metadata is written. Instead of writing metadata about the commit after ingestion, write it twice, before ingestion starts and after ingestion ends (for correctness). The metadata can be gathered from WorkLoadProfiler before the actual writing to file starts. \r\n\r\n_Part 2_\r\n\r\n| CommitType |  Solution |\r\n| --- | --- |\r\n| COMMIT/COMPACTION |  1) Read commit metadata 2) Find parquet files corresponding to commit and delete them 3) update rollback stats 4) delete commit file 5) write a .rollback file |\r\n| DELTACOMMIT | 1) Read commit metadata 2) Find log files corresponding to base commit and write rollback blocks 3) update rollback stats 4) delete commit file 5) write a .rollback file  |\r\n| INFLIGHT | 1) Read commit metadata 2) Perform necessary actions 3) write a .rollback file 4) delete inflight file |","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/320884338/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/321046480","html_url":"https://github.com/apache/hudi/pull/235#issuecomment-321046480","issue_url":"https://api.github.com/repos/apache/hudi/issues/235","id":321046480,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMTA0NjQ4MA==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-08T18:45:21Z","updated_at":"2017-08-09T22:34:08Z","author_association":"CONTRIBUTOR","body":"Looked into this issue, it seems like this issue is intermittently reproducible in job executions (with old build). Essentially, once we set `spark.executor.cores=2` (greater than 1), this issue is seen intermittently. I'm trying to find the route cause why fs.close() is called and if fs is shared.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/321046480/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/321048592","html_url":"https://github.com/apache/hudi/issues/236#issuecomment-321048592","issue_url":"https://api.github.com/repos/apache/hudi/issues/236","id":321048592,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMTA0ODU5Mg==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-08T18:53:22Z","updated_at":"2017-08-08T18:53:22Z","author_association":"CONTRIBUTOR","body":"@vinothchandar @jianxu FYI","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/321048592/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/321380633","html_url":"https://github.com/apache/hudi/pull/237#issuecomment-321380633","issue_url":"https://api.github.com/repos/apache/hudi/issues/237","id":321380633,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMTM4MDYzMw==","user":{"login":"jianxu","id":10394074,"node_id":"MDQ6VXNlcjEwMzk0MDc0","avatar_url":"https://avatars.githubusercontent.com/u/10394074?v=4","gravatar_id":"","url":"https://api.github.com/users/jianxu","html_url":"https://github.com/jianxu","followers_url":"https://api.github.com/users/jianxu/followers","following_url":"https://api.github.com/users/jianxu/following{/other_user}","gists_url":"https://api.github.com/users/jianxu/gists{/gist_id}","starred_url":"https://api.github.com/users/jianxu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jianxu/subscriptions","organizations_url":"https://api.github.com/users/jianxu/orgs","repos_url":"https://api.github.com/users/jianxu/repos","events_url":"https://api.github.com/users/jianxu/events{/privacy}","received_events_url":"https://api.github.com/users/jianxu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-09T21:02:57Z","updated_at":"2017-08-09T21:02:57Z","author_association":"CONTRIBUTOR","body":"cherry-pick fix https://github.com/uber/hoodie/pull/207","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/321380633/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/321622848","html_url":"https://github.com/apache/hudi/issues/236#issuecomment-321622848","issue_url":"https://api.github.com/repos/apache/hudi/issues/236","id":321622848,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMTYyMjg0OA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-10T17:41:38Z","updated_at":"2017-08-10T17:41:38Z","author_association":"MEMBER","body":"why do we need to backport this? \r\n\r\n@prazanna is there any significant changes on the hoodie-mor-mvp brnach that needs merging to master.. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/321622848/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/321626099","html_url":"https://github.com/apache/hudi/issues/231#issuecomment-321626099","issue_url":"https://api.github.com/repos/apache/hudi/issues/231","id":321626099,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMTYyNjA5OQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-10T17:53:40Z","updated_at":"2017-08-10T17:53:40Z","author_association":"MEMBER","body":"@littleRa1n partitionPath is just a string, passed into the `HoodieKey` constructor.  Hoodie does not enforce date formats.. Hope that helps ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/321626099/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/321626838","html_url":"https://github.com/apache/hudi/pull/237#issuecomment-321626838","issue_url":"https://api.github.com/repos/apache/hudi/issues/237","id":321626838,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMTYyNjgzOA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-10T17:56:16Z","updated_at":"2017-08-10T17:56:16Z","author_association":"MEMBER","body":"merging this for now.. Lets work out a plan to bring hoodie-mor-mvp and master on parity. I lack visibility into how `hoodie-mor-mvp` is being used. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/321626838/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/321690196","html_url":"https://github.com/apache/hudi/issues/40#issuecomment-321690196","issue_url":"https://api.github.com/repos/apache/hudi/issues/40","id":321690196,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMTY5MDE5Ng==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-10T22:26:01Z","updated_at":"2017-08-10T22:26:01Z","author_association":"MEMBER","body":"In solution 1, part 1 => .inflight is not easy to handle without the same input records, that were part of the attempted delta commit, right..  So, this is going to be tricky. \r\n\r\n>To achieve this, we need to add a commitTime to each HoodieLogBlock \r\nMay not be needed. every records has the commitTime already.. We could just reuse it right.. (Although don't object to having the commitTime in the logBlock header or sth) \r\n\r\nA problem with solution 1, is that when the original deltacommit gets archived, then the records might be considered valid again.. \r\n\r\nI think solution 2, is the only approach here.. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/321690196/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/321691608","html_url":"https://github.com/apache/hudi/issues/238#issuecomment-321691608","issue_url":"https://api.github.com/repos/apache/hudi/issues/238","id":321691608,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMTY5MTYwOA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-10T22:34:06Z","updated_at":"2017-08-10T22:34:06Z","author_association":"MEMBER","body":"yes and most importantly, this nicely handles skews, when bootstrapping datasets into hoodie.. Typically, if you import a multi-year dataset and earlier years have way less data than current years, sorting just ensures small partitionPaths just get 1 file, while larger ones split gracefully across multiple spark partitions and get written into multiple files. \r\n\r\nof course, this comes at a cost, since sortBy needs to make a pass on the records to determine the splits.. \r\n\r\nDoes `insert()` work for you?  It already uses the custom `UpsertPartitioner` and is intended to be used for regular inserts..  `bulkInsert()` is meant for large datasets, which you can't potentially cache totally in memory to build a custom partitioner. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/321691608/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322317516","html_url":"https://github.com/apache/hudi/issues/40#issuecomment-322317516","issue_url":"https://api.github.com/repos/apache/hudi/issues/40","id":322317516,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjMxNzUxNg==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-14T21:40:33Z","updated_at":"2017-08-14T21:40:33Z","author_association":"CONTRIBUTOR","body":"So for Solution 1 part 1, `every record has a commitTime` is not true because only AVRO_DATA_BLOCK has records, a DELETE_BLOCK or a CORUPT_BLOCK does not. So a rollback of a DELETE_BLOCK is not possible to determine. LogBlock does not have any headers apart from 1) MAGIC_NUMBER 2) BLOCKTYPE 3) LENGTH. \r\n\r\nDid not understand your above comment `In solution 1, part 1 => .inflight is not easy to handle without the same input records, that were part of the attempted delta commit, right.. So, this is going to be tricky.`\r\n\r\nYes, if original deltacommit gets archived, we have an issue but I think we only have inline unbounded compaction support right now and a compaction for such a deltacommit should happen before archival kicks in. A problem I see is if compaction fails over multiple runs.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322317516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322345333","html_url":"https://github.com/apache/hudi/pull/242#issuecomment-322345333","issue_url":"https://api.github.com/repos/apache/hudi/issues/242","id":322345333,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjM0NTMzMw==","user":{"login":"CLAassistant","id":11571300,"node_id":"MDQ6VXNlcjExNTcxMzAw","avatar_url":"https://avatars.githubusercontent.com/u/11571300?v=4","gravatar_id":"","url":"https://api.github.com/users/CLAassistant","html_url":"https://github.com/CLAassistant","followers_url":"https://api.github.com/users/CLAassistant/followers","following_url":"https://api.github.com/users/CLAassistant/following{/other_user}","gists_url":"https://api.github.com/users/CLAassistant/gists{/gist_id}","starred_url":"https://api.github.com/users/CLAassistant/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CLAassistant/subscriptions","organizations_url":"https://api.github.com/users/CLAassistant/orgs","repos_url":"https://api.github.com/users/CLAassistant/repos","events_url":"https://api.github.com/users/CLAassistant/events{/privacy}","received_events_url":"https://api.github.com/users/CLAassistant/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-15T00:27:18Z","updated_at":"2017-08-15T00:27:18Z","author_association":"NONE","body":"[![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/uber/hoodie?pullRequest=242) <br/>Thank you for your submission, we really appreciate it. Like many open source projects, we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/uber/hoodie?pullRequest=242) before we can accept your contribution.<br/>**2** out of **3** committers have signed the CLA.<br/><br/>:white_check_mark: n3nash<br/>:white_check_mark: jianxu<br/>:x: Prasanna Rajaperumal<br/><hr/>**Prasanna Rajaperumal** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account, please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/uber/hoodie?pullRequest=242) it.</sub>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322345333/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322345390","html_url":"https://github.com/apache/hudi/pull/242#issuecomment-322345390","issue_url":"https://api.github.com/repos/apache/hudi/issues/242","id":322345390,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjM0NTM5MA==","user":{"login":"jianxu","id":10394074,"node_id":"MDQ6VXNlcjEwMzk0MDc0","avatar_url":"https://avatars.githubusercontent.com/u/10394074?v=4","gravatar_id":"","url":"https://api.github.com/users/jianxu","html_url":"https://github.com/jianxu","followers_url":"https://api.github.com/users/jianxu/followers","following_url":"https://api.github.com/users/jianxu/following{/other_user}","gists_url":"https://api.github.com/users/jianxu/gists{/gist_id}","starred_url":"https://api.github.com/users/jianxu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jianxu/subscriptions","organizations_url":"https://api.github.com/users/jianxu/orgs","repos_url":"https://api.github.com/users/jianxu/repos","events_url":"https://api.github.com/users/jianxu/events{/privacy}","received_events_url":"https://api.github.com/users/jianxu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-15T00:27:41Z","updated_at":"2017-08-15T00:27:41Z","author_association":"CONTRIBUTOR","body":"@n3nash @vinothchandar @prazanna ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322345390/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322347422","html_url":"https://github.com/apache/hudi/pull/242#issuecomment-322347422","issue_url":"https://api.github.com/repos/apache/hudi/issues/242","id":322347422,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjM0NzQyMg==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-15T00:44:20Z","updated_at":"2017-08-15T00:44:20Z","author_association":"MEMBER","body":"why is this PR against master.. should n't it against 0.3.9 branch ? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322347422/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322535461","html_url":"https://github.com/apache/hudi/pull/242#issuecomment-322535461","issue_url":"https://api.github.com/repos/apache/hudi/issues/242","id":322535461,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjUzNTQ2MQ==","user":{"login":"jianxu","id":10394074,"node_id":"MDQ6VXNlcjEwMzk0MDc0","avatar_url":"https://avatars.githubusercontent.com/u/10394074?v=4","gravatar_id":"","url":"https://api.github.com/users/jianxu","html_url":"https://github.com/jianxu","followers_url":"https://api.github.com/users/jianxu/followers","following_url":"https://api.github.com/users/jianxu/following{/other_user}","gists_url":"https://api.github.com/users/jianxu/gists{/gist_id}","starred_url":"https://api.github.com/users/jianxu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jianxu/subscriptions","organizations_url":"https://api.github.com/users/jianxu/orgs","repos_url":"https://api.github.com/users/jianxu/repos","events_url":"https://api.github.com/users/jianxu/events{/privacy}","received_events_url":"https://api.github.com/users/jianxu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-15T17:37:10Z","updated_at":"2017-08-15T17:37:10Z","author_association":"CONTRIBUTOR","body":"will create a new one.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322535461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322536884","html_url":"https://github.com/apache/hudi/pull/243#issuecomment-322536884","issue_url":"https://api.github.com/repos/apache/hudi/issues/243","id":322536884,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjUzNjg4NA==","user":{"login":"CLAassistant","id":11571300,"node_id":"MDQ6VXNlcjExNTcxMzAw","avatar_url":"https://avatars.githubusercontent.com/u/11571300?v=4","gravatar_id":"","url":"https://api.github.com/users/CLAassistant","html_url":"https://github.com/CLAassistant","followers_url":"https://api.github.com/users/CLAassistant/followers","following_url":"https://api.github.com/users/CLAassistant/following{/other_user}","gists_url":"https://api.github.com/users/CLAassistant/gists{/gist_id}","starred_url":"https://api.github.com/users/CLAassistant/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CLAassistant/subscriptions","organizations_url":"https://api.github.com/users/CLAassistant/orgs","repos_url":"https://api.github.com/users/CLAassistant/repos","events_url":"https://api.github.com/users/CLAassistant/events{/privacy}","received_events_url":"https://api.github.com/users/CLAassistant/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-15T17:42:36Z","updated_at":"2017-08-15T17:42:38Z","author_association":"NONE","body":"[![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/uber/hoodie?pullRequest=243) <br/>Thank you for your submission, we really appreciate it. Like many open source projects, we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/uber/hoodie?pullRequest=243) before we can accept your contribution.<br/>**2** out of **3** committers have signed the CLA.<br/><br/>:white_check_mark: jianxu<br/>:white_check_mark: n3nash<br/>:x: Prasanna Rajaperumal<br/><hr/>**Prasanna Rajaperumal** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account, please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/uber/hoodie?pullRequest=243) it.</sub>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322536884/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322597573","html_url":"https://github.com/apache/hudi/pull/244#issuecomment-322597573","issue_url":"https://api.github.com/repos/apache/hudi/issues/244","id":322597573,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjU5NzU3Mw==","user":{"login":"CLAassistant","id":11571300,"node_id":"MDQ6VXNlcjExNTcxMzAw","avatar_url":"https://avatars.githubusercontent.com/u/11571300?v=4","gravatar_id":"","url":"https://api.github.com/users/CLAassistant","html_url":"https://github.com/CLAassistant","followers_url":"https://api.github.com/users/CLAassistant/followers","following_url":"https://api.github.com/users/CLAassistant/following{/other_user}","gists_url":"https://api.github.com/users/CLAassistant/gists{/gist_id}","starred_url":"https://api.github.com/users/CLAassistant/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CLAassistant/subscriptions","organizations_url":"https://api.github.com/users/CLAassistant/orgs","repos_url":"https://api.github.com/users/CLAassistant/repos","events_url":"https://api.github.com/users/CLAassistant/events{/privacy}","received_events_url":"https://api.github.com/users/CLAassistant/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-15T21:40:00Z","updated_at":"2017-08-15T21:40:00Z","author_association":"NONE","body":"[![CLA assistant check](https://cla-assistant.io/pull/badge/not_signed)](https://cla-assistant.io/uber/hoodie?pullRequest=244) <br/>Thank you for your submission, we really appreciate it. Like many open source projects, we ask that you all sign our [Contributor License Agreement](https://cla-assistant.io/uber/hoodie?pullRequest=244) before we can accept your contribution.<br/>**1** out of **2** committers have signed the CLA.<br/><br/>:white_check_mark: jianxu<br/>:x: Prasanna Rajaperumal<br/><hr/>**Prasanna Rajaperumal** seems not to be a GitHub user. You need a GitHub account to be able to sign the CLA. If you have already a GitHub account, please [add the email address used for this commit to your account](https://help.github.com/articles/why-are-my-commits-linked-to-the-wrong-user/#commits-are-not-linked-to-any-user).<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla-assistant.io/check/uber/hoodie?pullRequest=244) it.</sub>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322597573/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322843854","html_url":"https://github.com/apache/hudi/issues/238#issuecomment-322843854","issue_url":"https://api.github.com/repos/apache/hudi/issues/238","id":322843854,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjg0Mzg1NA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-16T17:32:07Z","updated_at":"2017-08-16T17:32:07Z","author_association":"MEMBER","body":"@ovj bump ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322843854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322843969","html_url":"https://github.com/apache/hudi/issues/236#issuecomment-322843969","issue_url":"https://api.github.com/repos/apache/hudi/issues/236","id":322843969,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjg0Mzk2OQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-16T17:32:32Z","updated_at":"2017-08-16T17:32:32Z","author_association":"MEMBER","body":"@n3nash please close this when done.. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322843969/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322844122","html_url":"https://github.com/apache/hudi/pull/220#issuecomment-322844122","issue_url":"https://api.github.com/repos/apache/hudi/issues/220","id":322844122,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjg0NDEyMg==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-16T17:33:14Z","updated_at":"2017-08-16T17:33:14Z","author_association":"MEMBER","body":"@prazanna we are blocked on your input here.. Please take a look whenever you can.. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322844122/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322844317","html_url":"https://github.com/apache/hudi/pull/191#issuecomment-322844317","issue_url":"https://api.github.com/repos/apache/hudi/issues/191","id":322844317,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjg0NDMxNw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-16T17:33:54Z","updated_at":"2017-08-16T17:33:54Z","author_association":"MEMBER","body":"from what @gekath and I discusssed offline.. Seems this is being actively tested :) ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322844317/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322844711","html_url":"https://github.com/apache/hudi/pull/234#issuecomment-322844711","issue_url":"https://api.github.com/repos/apache/hudi/issues/234","id":322844711,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjg0NDcxMQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-16T17:35:22Z","updated_at":"2017-08-16T17:35:22Z","author_association":"MEMBER","body":"I am pulling this in for now.. @jianxu please follow up on testing above, if you intend to continue working on this. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322844711/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322845219","html_url":"https://github.com/apache/hudi/pull/241#issuecomment-322845219","issue_url":"https://api.github.com/repos/apache/hudi/issues/241","id":322845219,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjg0NTIxOQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-16T17:37:17Z","updated_at":"2017-08-16T17:37:17Z","author_association":"MEMBER","body":"@n3nash could we may be explore how regular spark users handle this ? Would calling sc.stop() before closing filesystem should help? \r\n\r\nI would like to spend a little time on this, given either way its a bandaid solution we have right now.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322845219/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322845339","html_url":"https://github.com/apache/hudi/pull/230#issuecomment-322845339","issue_url":"https://api.github.com/repos/apache/hudi/issues/230","id":322845339,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjg0NTMzOQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-16T17:37:46Z","updated_at":"2017-08-16T17:37:46Z","author_association":"MEMBER","body":"@n3nash rebasing with master and getting the tests to pass here is the next step? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322845339/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322845543","html_url":"https://github.com/apache/hudi/issues/225#issuecomment-322845543","issue_url":"https://api.github.com/repos/apache/hudi/issues/225","id":322845543,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjg0NTU0Mw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-16T17:38:31Z","updated_at":"2017-08-16T17:38:31Z","author_association":"MEMBER","body":"@n3nash could you take this up, while we wait on @prazanna 's comments on rollback ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322845543/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322846995","html_url":"https://github.com/apache/hudi/issues/40#issuecomment-322846995","issue_url":"https://api.github.com/repos/apache/hudi/issues/40","id":322846995,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjg0Njk5NQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-16T17:44:15Z","updated_at":"2017-08-16T17:44:15Z","author_association":"MEMBER","body":"Adding the instantTime or commitTime to block is fine by me.  \r\n\r\n> but I think we only have inline unbounded compaction support right now and a compaction for such a deltacommit should happen before archival kicks in\r\n\r\nwe can't assume things around compaction not failing (or cleaning for that matter) in the design. IMO, it will just make things flaky and hard to debug.. Each write operation sort of needs to work on guarantees on the timeline, independent of other operations. \r\n\r\nLets f2f this sometime. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322846995/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322848651","html_url":"https://github.com/apache/hudi/issues/238#issuecomment-322848651","issue_url":"https://api.github.com/repos/apache/hudi/issues/238","id":322848651,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjg0ODY1MQ==","user":{"login":"ovj","id":899843,"node_id":"MDQ6VXNlcjg5OTg0Mw==","avatar_url":"https://avatars.githubusercontent.com/u/899843?v=4","gravatar_id":"","url":"https://api.github.com/users/ovj","html_url":"https://github.com/ovj","followers_url":"https://api.github.com/users/ovj/followers","following_url":"https://api.github.com/users/ovj/following{/other_user}","gists_url":"https://api.github.com/users/ovj/gists{/gist_id}","starred_url":"https://api.github.com/users/ovj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ovj/subscriptions","organizations_url":"https://api.github.com/users/ovj/orgs","repos_url":"https://api.github.com/users/ovj/repos","events_url":"https://api.github.com/users/ovj/events{/privacy}","received_events_url":"https://api.github.com/users/ovj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-16T17:50:39Z","updated_at":"2017-08-16T17:50:39Z","author_association":"CONTRIBUTOR","body":"@vinothchandar sorry; Didn't reply earlier. Was testing the patch. Actually I went through UpsertPartitioner. bulkInsert will be better for us as we have very large datasets per run. There is some bucket level counting I am doing which I am not sure if we can do it in UpsertPartitioner. I will update patch by today EOD.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322848651/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322851628","html_url":"https://github.com/apache/hudi/issues/238#issuecomment-322851628","issue_url":"https://api.github.com/repos/apache/hudi/issues/238","id":322851628,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjg1MTYyOA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-16T18:01:14Z","updated_at":"2017-08-16T18:01:14Z","author_association":"MEMBER","body":"okay.. Like to mention couple things. \r\n\r\n- We can make the partitioner class configurable inside Hoodie, to let clients plugin their own partitioners as needed\r\n- Spark sort partitioning is a really battletested piece of code, that wins terasort benchmarks every year. So, be sure that your custom partitioning is truly going to be faster :) ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322851628/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322864878","html_url":"https://github.com/apache/hudi/pull/241#issuecomment-322864878","issue_url":"https://api.github.com/repos/apache/hudi/issues/241","id":322864878,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjg2NDg3OA==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-16T18:49:49Z","updated_at":"2017-08-16T20:29:55Z","author_association":"CONTRIBUTOR","body":"@vinothchandar The build actually fails intermittently right now, if you run the build multiple times you will notice it fails, we need this fix to make it stable and then find the right fix for this. Let me take a look, but in general, cores > 1 result in this exception. I tested this on our ingestion jobs and we haven't seen this yet since all our ingestion jobs use cores=1. We should talk F2F about this, if we want to support cores > 1 (which I think we want) we will have to re-write the way we use FS objects.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322864878/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322865218","html_url":"https://github.com/apache/hudi/issues/236#issuecomment-322865218","issue_url":"https://api.github.com/repos/apache/hudi/issues/236","id":322865218,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjg2NTIxOA==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-16T18:51:01Z","updated_at":"2017-08-16T18:51:01Z","author_association":"CONTRIBUTOR","body":"This feature has been backported to the branch as well as a new release 0.3.10. Closing this now.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322865218/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322865767","html_url":"https://github.com/apache/hudi/issues/40#issuecomment-322865767","issue_url":"https://api.github.com/repos/apache/hudi/issues/40","id":322865767,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjg2NTc2Nw==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-16T18:53:00Z","updated_at":"2017-08-16T18:53:00Z","author_association":"CONTRIBUTOR","body":"That makes sense, I just felt that Solution 2 is a little more disruptive but I think that's the way to go.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322865767/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322902060","html_url":"https://github.com/apache/hudi/pull/230#issuecomment-322902060","issue_url":"https://api.github.com/repos/apache/hudi/issues/230","id":322902060,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjkwMjA2MA==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-16T21:17:06Z","updated_at":"2017-08-16T21:17:06Z","author_association":"CONTRIBUTOR","body":"@vinothchandar done.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322902060/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322919431","html_url":"https://github.com/apache/hudi/issues/238#issuecomment-322919431","issue_url":"https://api.github.com/repos/apache/hudi/issues/238","id":322919431,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjkxOTQzMQ==","user":{"login":"ovj","id":899843,"node_id":"MDQ6VXNlcjg5OTg0Mw==","avatar_url":"https://avatars.githubusercontent.com/u/899843?v=4","gravatar_id":"","url":"https://api.github.com/users/ovj","html_url":"https://github.com/ovj","followers_url":"https://api.github.com/users/ovj/followers","following_url":"https://api.github.com/users/ovj/following{/other_user}","gists_url":"https://api.github.com/users/ovj/gists{/gist_id}","starred_url":"https://api.github.com/users/ovj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ovj/subscriptions","organizations_url":"https://api.github.com/users/ovj/orgs","repos_url":"https://api.github.com/users/ovj/repos","events_url":"https://api.github.com/users/ovj/events{/privacy}","received_events_url":"https://api.github.com/users/ovj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-16T22:40:57Z","updated_at":"2017-08-16T22:40:57Z","author_association":"CONTRIBUTOR","body":"Yeah making it configurable will be an added benefit. Currently I am not doing that. I will add it to future patch. The advantages with that;\r\n- We would want our partitioner to support record weights (today they are still considered as of same size/weight) as not all records are of same size. (This is important because if hoodie writer hits max file size limit then hoodie will write rest of the records into separate file [potential candidate for parallelization]).\r\n\r\nUsing SortBy has 2 drawbacks in it; which I am trying to fix.\r\n- We truly don't need sorting as long as we can ensure that output spark partition only gets records from single hoodie partition.\r\n- due to sorting it is possible today that single output spark partition can get records from more than 1 hoodie partition and they are serialized while writing. Which can be parallelized.\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322919431/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322931364","html_url":"https://github.com/apache/hudi/issues/238#issuecomment-322931364","issue_url":"https://api.github.com/repos/apache/hudi/issues/238","id":322931364,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjkzMTM2NA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-16T23:57:40Z","updated_at":"2017-08-16T23:57:40Z","author_association":"MEMBER","body":"> will write rest of the records into separate file [potential candidate for parallelization]).\r\nThis already happens in parallel.. There is a config set to 200K records for each such residual records. its called `insert.split.size` I think.  \r\n\r\n>We truly don't need sorting as long as we can ensure that output spark partition only gets records from single hoodie partition.\r\nNot sure how this can be done without sampling the records once => which is okay for small input/normal case. But not for large dataset bulk inserts. This sampling (reservoir sampling) is what sort already does. \r\n\r\n>due to sorting it is possible today that single output spark partition can get records from more than 1 hoodie partition and they are serialized while writing. Which can be parallelized.\r\nAgain the determination of sort splits, should ensure teh partitions are sized more evenly. Any alternate solution also need to keep this property. If these spark partitions that have data for multiple partitions are indeed the stragglers, then this hypothesis is true. I'd recommend verifying that if not done already, before going far.. \r\n\r\n>Currently I am not doing that. I will add it to future patch. \r\nI will wait for the PR. But I think we need it to be pluggable right off the bat. It does not add much effort IMO relative to the partitioner itself. \r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322931364/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322938888","html_url":"https://github.com/apache/hudi/issues/238#issuecomment-322938888","issue_url":"https://api.github.com/repos/apache/hudi/issues/238","id":322938888,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjkzODg4OA==","user":{"login":"ovj","id":899843,"node_id":"MDQ6VXNlcjg5OTg0Mw==","avatar_url":"https://avatars.githubusercontent.com/u/899843?v=4","gravatar_id":"","url":"https://api.github.com/users/ovj","html_url":"https://github.com/ovj","followers_url":"https://api.github.com/users/ovj/followers","following_url":"https://api.github.com/users/ovj/following{/other_user}","gists_url":"https://api.github.com/users/ovj/gists{/gist_id}","starred_url":"https://api.github.com/users/ovj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ovj/subscriptions","organizations_url":"https://api.github.com/users/ovj/orgs","repos_url":"https://api.github.com/users/ovj/repos","events_url":"https://api.github.com/users/ovj/events{/privacy}","received_events_url":"https://api.github.com/users/ovj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-17T00:52:51Z","updated_at":"2017-08-17T00:52:51Z","author_association":"CONTRIBUTOR","body":"yeah it is not possible to avoid assigning records from different hoodie partitions into single spark partition without sampling the records once. In the custom partitioner we are sampling the records once.\r\n\r\nHere is the link to PR. https://github.com/uber/hoodie/pull/245/files","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/322938888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/323201061","html_url":"https://github.com/apache/hudi/issues/246#issuecomment-323201061","issue_url":"https://api.github.com/repos/apache/hudi/issues/246","id":323201061,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMzIwMTA2MQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-17T21:36:27Z","updated_at":"2017-08-17T21:36:27Z","author_association":"MEMBER","body":"Awesome.. thanks for sharing.. Will adjust defaults upstream and make sure next release has bunch of these things working out of box","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/323201061/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/323403397","html_url":"https://github.com/apache/hudi/pull/245#issuecomment-323403397","issue_url":"https://api.github.com/repos/apache/hudi/issues/245","id":323403397,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMzQwMzM5Nw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-18T16:43:58Z","updated_at":"2017-08-18T16:43:58Z","author_association":"MEMBER","body":"Can you make the partitioner pluggable?  Also could you share the performance analysis you did, since thats core aspect of this PR ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/323403397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/323403505","html_url":"https://github.com/apache/hudi/pull/245#issuecomment-323403505","issue_url":"https://api.github.com/repos/apache/hudi/issues/245","id":323403505,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMzQwMzUwNQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-18T16:44:26Z","updated_at":"2017-08-18T16:44:26Z","author_association":"MEMBER","body":"and please merge both the commits together.. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/323403505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/323438671","html_url":"https://github.com/apache/hudi/pull/230#issuecomment-323438671","issue_url":"https://api.github.com/repos/apache/hudi/issues/230","id":323438671,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMzQzODY3MQ==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-18T19:16:34Z","updated_at":"2017-08-18T19:16:34Z","author_association":"CONTRIBUTOR","body":"Addressed.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/323438671/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/323479140","html_url":"https://github.com/apache/hudi/pull/241#issuecomment-323479140","issue_url":"https://api.github.com/repos/apache/hudi/issues/241","id":323479140,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMzQ3OTE0MA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-18T23:02:43Z","updated_at":"2017-08-18T23:02:43Z","author_association":"MEMBER","body":"whats the conclusion on sc.stop?  I would like to understand how Spark users deal with this, outside of the hoodie context .. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/323479140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/323484896","html_url":"https://github.com/apache/hudi/pull/245#issuecomment-323484896","issue_url":"https://api.github.com/repos/apache/hudi/issues/245","id":323484896,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMzQ4NDg5Ng==","user":{"login":"ovj","id":899843,"node_id":"MDQ6VXNlcjg5OTg0Mw==","avatar_url":"https://avatars.githubusercontent.com/u/899843?v=4","gravatar_id":"","url":"https://api.github.com/users/ovj","html_url":"https://github.com/ovj","followers_url":"https://api.github.com/users/ovj/followers","following_url":"https://api.github.com/users/ovj/following{/other_user}","gists_url":"https://api.github.com/users/ovj/gists{/gist_id}","starred_url":"https://api.github.com/users/ovj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ovj/subscriptions","organizations_url":"https://api.github.com/users/ovj/orgs","repos_url":"https://api.github.com/users/ovj/repos","events_url":"https://api.github.com/users/ovj/events{/privacy}","received_events_url":"https://api.github.com/users/ovj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-18T23:55:19Z","updated_at":"2017-08-18T23:55:19Z","author_association":"CONTRIBUTOR","body":"whats special about 4, that makes it work for all workloads ? >> Nothing special I just wanted to ensure that number of buckets are some multiple of output partitions.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/323484896/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/323861313","html_url":"https://github.com/apache/hudi/issues/249#issuecomment-323861313","issue_url":"https://api.github.com/repos/apache/hudi/issues/249","id":323861313,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMzg2MTMxMw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-21T21:45:10Z","updated_at":"2017-08-21T21:45:10Z","author_association":"MEMBER","body":"Have not seen this. @alunarbeach could you paste the log lines from hive? \r\n\r\n```\r\n LOG.info(\"Total paths to process after hoodie filter \" + filteredFiles.size());\r\n                for (HoodieDataFile filteredFile : filteredFiles) {\r\n                    if (LOG.isDebugEnabled()) {\r\n                        LOG.debug(\"Processing latest hoodie file - \" + filteredFile.getPath());\r\n                    }\r\n                    filteredFile = checkFileStatus(filteredFile);\r\n                    returns.add(filteredFile.getFileStatus());\r\n                }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/323861313/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/324171668","html_url":"https://github.com/apache/hudi/issues/153#issuecomment-324171668","issue_url":"https://api.github.com/repos/apache/hudi/issues/153","id":324171668,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNDE3MTY2OA==","user":{"login":"kaushikd49","id":1446360,"node_id":"MDQ6VXNlcjE0NDYzNjA=","avatar_url":"https://avatars.githubusercontent.com/u/1446360?v=4","gravatar_id":"","url":"https://api.github.com/users/kaushikd49","html_url":"https://github.com/kaushikd49","followers_url":"https://api.github.com/users/kaushikd49/followers","following_url":"https://api.github.com/users/kaushikd49/following{/other_user}","gists_url":"https://api.github.com/users/kaushikd49/gists{/gist_id}","starred_url":"https://api.github.com/users/kaushikd49/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaushikd49/subscriptions","organizations_url":"https://api.github.com/users/kaushikd49/orgs","repos_url":"https://api.github.com/users/kaushikd49/repos","events_url":"https://api.github.com/users/kaushikd49/events{/privacy}","received_events_url":"https://api.github.com/users/kaushikd49/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-22T22:40:42Z","updated_at":"2017-08-22T22:40:42Z","author_association":"CONTRIBUTOR","body":"Hi @prazanna, I have a PR ready for this. Could you please assign this to me? Thanks.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/324171668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/324181498","html_url":"https://github.com/apache/hudi/pull/251#issuecomment-324181498","issue_url":"https://api.github.com/repos/apache/hudi/issues/251","id":324181498,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNDE4MTQ5OA==","user":{"login":"kaushikd49","id":1446360,"node_id":"MDQ6VXNlcjE0NDYzNjA=","avatar_url":"https://avatars.githubusercontent.com/u/1446360?v=4","gravatar_id":"","url":"https://api.github.com/users/kaushikd49","html_url":"https://github.com/kaushikd49","followers_url":"https://api.github.com/users/kaushikd49/followers","following_url":"https://api.github.com/users/kaushikd49/following{/other_user}","gists_url":"https://api.github.com/users/kaushikd49/gists{/gist_id}","starred_url":"https://api.github.com/users/kaushikd49/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaushikd49/subscriptions","organizations_url":"https://api.github.com/users/kaushikd49/orgs","repos_url":"https://api.github.com/users/kaushikd49/repos","events_url":"https://api.github.com/users/kaushikd49/events{/privacy}","received_events_url":"https://api.github.com/users/kaushikd49/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-22T23:43:53Z","updated_at":"2017-08-22T23:43:53Z","author_association":"CONTRIBUTOR","body":"CI failure is due to the race condition bug on master. This PR has been successfully tested on master with the patch given by @n3nash to avoid race temporarily. PR has has also been tested with an ingestion job.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/324181498/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/324221420","html_url":"https://github.com/apache/hudi/pull/220#issuecomment-324221420","issue_url":"https://api.github.com/repos/apache/hudi/issues/220","id":324221420,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNDIyMTQyMA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-23T05:00:04Z","updated_at":"2017-08-23T05:00:04Z","author_association":"MEMBER","body":"@alunarbeach I did some digging and here is what I found .. \r\n\r\n- CDH Hive still uses com.twitter:parquet \r\n- Spark uses a mix of com.twitter:parquet for Hive facing stuff, org.apache.parquet for sparkSQL.\r\n- Hive trunk (which might be Hive 2+) uses org.apache.parquet \r\n\r\nSo overall everyone seems to be riding both horses and pulling in both deps.. \r\n\r\nMay be a better approach could be \r\n\r\n- To create a new `HoodieHive2InputFormat`  within the same `hoodie-hadoop-mr` that has different imports, but shares as much code as possible via helpers or otherwise. (we can worry about MOR eventually) . But Copy-on-write alone is not much code\r\n\r\n```\r\n [hoodie-hadoop-mr]$ grep -R \"import parquet\" . | awk -F':' ' { print $1 } ' | uniq -c \r\n   6 ./src/main/java/com/uber/hoodie/hadoop/HoodieInputFormat.java\r\n   3 ./src/main/java/com/uber/hoodie/hadoop/realtime/HoodieRealtimeRecordReader.java\r\n```\r\n\r\n\r\n- For `hoodie-hive` module, we can add a new `--hive2` flag, that chooses inputformat based on this. \r\n\r\n```\r\n[hoodie-hive]$ gr \"import parquet\" . | awk -F':' ' { print $1 } ' | uniq -c \r\n   1 ./src/main/java/com/uber/hoodie/hive/HiveSyncTool.java\r\n   4 ./src/main/java/com/uber/hoodie/hive/HoodieHiveClient.java\r\n   1 ./src/main/java/com/uber/hoodie/hive/SchemaDifference.java\r\n   6 ./src/main/java/com/uber/hoodie/hive/util/SchemaUtil.java\r\n   3 ./src/test/java/com/uber/hoodie/hive/HiveSyncToolTest.java\r\n```\r\n\r\nRemaining changes are bit more tricky, but generally lends to subclassing and interfaces.. for e.g, HoodieHiveClient can be extended by a HoodieHive2Client... \r\n\r\nDo you want to take a stab at this? Let me know.. We can chat over a call. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/324221420/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/324335949","html_url":"https://github.com/apache/hudi/pull/220#issuecomment-324335949","issue_url":"https://api.github.com/repos/apache/hudi/issues/220","id":324335949,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNDMzNTk0OQ==","user":{"login":"alunarbeach","id":494035,"node_id":"MDQ6VXNlcjQ5NDAzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/494035?v=4","gravatar_id":"","url":"https://api.github.com/users/alunarbeach","html_url":"https://github.com/alunarbeach","followers_url":"https://api.github.com/users/alunarbeach/followers","following_url":"https://api.github.com/users/alunarbeach/following{/other_user}","gists_url":"https://api.github.com/users/alunarbeach/gists{/gist_id}","starred_url":"https://api.github.com/users/alunarbeach/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alunarbeach/subscriptions","organizations_url":"https://api.github.com/users/alunarbeach/orgs","repos_url":"https://api.github.com/users/alunarbeach/repos","events_url":"https://api.github.com/users/alunarbeach/events{/privacy}","received_events_url":"https://api.github.com/users/alunarbeach/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-23T13:43:33Z","updated_at":"2017-08-23T13:43:33Z","author_association":"CONTRIBUTOR","body":"@vinothchandar will work on this. will sync with you later today.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/324335949/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/325048448","html_url":"https://github.com/apache/hudi/pull/245#issuecomment-325048448","issue_url":"https://api.github.com/repos/apache/hudi/issues/245","id":325048448,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTA0ODQ0OA==","user":{"login":"ovj","id":899843,"node_id":"MDQ6VXNlcjg5OTg0Mw==","avatar_url":"https://avatars.githubusercontent.com/u/899843?v=4","gravatar_id":"","url":"https://api.github.com/users/ovj","html_url":"https://github.com/ovj","followers_url":"https://api.github.com/users/ovj/followers","following_url":"https://api.github.com/users/ovj/following{/other_user}","gists_url":"https://api.github.com/users/ovj/gists{/gist_id}","starred_url":"https://api.github.com/users/ovj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ovj/subscriptions","organizations_url":"https://api.github.com/users/ovj/orgs","repos_url":"https://api.github.com/users/ovj/repos","events_url":"https://api.github.com/users/ovj/events{/privacy}","received_events_url":"https://api.github.com/users/ovj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-25T22:31:52Z","updated_at":"2017-08-25T22:31:52Z","author_association":"CONTRIBUTOR","body":"Attaching the results\r\n\r\nWith SortBy\r\n\r\n<img width=\"1426\" alt=\"sortby\" src=\"https://user-images.githubusercontent.com/899843/29734993-72b7cf48-89aa-11e7-8ae3-f08427612710.png\">\r\n\r\nWith UpsertPartitioner\r\n\r\n<img width=\"1428\" alt=\"upsertpartitioner\" src=\"https://user-images.githubusercontent.com/899843/29735000-7d92c44a-89aa-11e7-9f78-ca4cba662fcb.png\">\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/325048448/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/325065443","html_url":"https://github.com/apache/hudi/pull/245#issuecomment-325065443","issue_url":"https://api.github.com/repos/apache/hudi/issues/245","id":325065443,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTA2NTQ0Mw==","user":{"login":"ovj","id":899843,"node_id":"MDQ6VXNlcjg5OTg0Mw==","avatar_url":"https://avatars.githubusercontent.com/u/899843?v=4","gravatar_id":"","url":"https://api.github.com/users/ovj","html_url":"https://github.com/ovj","followers_url":"https://api.github.com/users/ovj/followers","following_url":"https://api.github.com/users/ovj/following{/other_user}","gists_url":"https://api.github.com/users/ovj/gists{/gist_id}","starred_url":"https://api.github.com/users/ovj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ovj/subscriptions","organizations_url":"https://api.github.com/users/ovj/orgs","repos_url":"https://api.github.com/users/ovj/repos","events_url":"https://api.github.com/users/ovj/events{/privacy}","received_events_url":"https://api.github.com/users/ovj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-26T00:45:39Z","updated_at":"2017-08-26T00:45:39Z","author_association":"CONTRIBUTOR","body":"@vinothchandar is it ok to limit the scope of this PR to just enable user to define their own partitioner for bulkInsert api? And keeping sortBy as the default way for bulkInsert? That way it is zero impact for existing users. Let me know what you think. I will open another issue to fix UpsertPartitioner random issue.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/325065443/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/325264438","html_url":"https://github.com/apache/hudi/pull/245#issuecomment-325264438","issue_url":"https://api.github.com/repos/apache/hudi/issues/245","id":325264438,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTI2NDQzOA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-28T05:40:01Z","updated_at":"2017-08-28T05:40:01Z","author_association":"MEMBER","body":"yeah that plan sounds good, Will review both PRs sometime this week ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/325264438/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/325293950","html_url":"https://github.com/apache/hudi/issues/7#issuecomment-325293950","issue_url":"https://api.github.com/repos/apache/hudi/issues/7","id":325293950,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTI5Mzk1MA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-28T08:32:19Z","updated_at":"2017-08-28T08:32:29Z","author_association":"MEMBER","body":"@zqureshi Started something here.. Plan to push a minimal working version soon. We can iterate on that.. \r\n\r\nhttps://github.com/vinothchandar/hoodie/commit/286f38c36a83ab4e87446085d836cba97a3c1ec6\r\n\r\nthanks to @alunarbeach for some row -> avro conversion code :) ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/325293950/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/325744129","html_url":"https://github.com/apache/hudi/pull/241#issuecomment-325744129","issue_url":"https://api.github.com/repos/apache/hudi/issues/241","id":325744129,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTc0NDEyOQ==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-29T17:56:58Z","updated_at":"2017-08-29T17:56:58Z","author_association":"CONTRIBUTOR","body":"@vinothchandar Did some more investigations around this, following is the summary : \r\n\r\nMultiple threads in the same JVM accessing a shared FS object cause this issue. Places where Filesystem.close() is invoked : \r\n \r\n\r\n- Shutdown Hook\r\n\r\n- While creating new parquet writer\r\n```\r\njava.lang.Thread.getStackTrace(Thread.java:1556)\r\ncom.uber.hoodie.io.storage.HoodieWrapperFileSystem.close(HoodieWrapperFileSystem.java:454)\r\norg.apache.hadoop.fs.FileSystem$Cache.getInternal(FileSystem.java:2737)\r\norg.apache.hadoop.fs.FileSystem$Cache.get(FileSystem.java:2715)\r\norg.apache.hadoop.fs.FileSystem.get(FileSystem.java:382)\r\norg.apache.hadoop.fs.Path.getFileSystem(Path.java:296)\r\norg.apache.parquet.hadoop.ParquetFileWriter.<init>(ParquetFileWriter.java:209)\r\norg.apache.parquet.hadoop.ParquetWriter.<init>(ParquetWriter.java:266)\r\norg.apache.parquet.hadoop.ParquetWriter.<init>(ParquetWriter.java:217)\r\ncom.uber.hoodie.io.storage.HoodieParquetWriter.<init>(HoodieParquetWriter.java:66)\r\ncom.uber.hoodie.io.storage.HoodieStorageWriterFactory.newParquetStorageWriter(HoodieStorageWriterFactory.java:55)\r\ncom.uber.hoodie.io.storage.HoodieStorageWriterFactory.getStorageWriter(HoodieStorageWriterFactory.java:40)\r\ncom.uber.hoodie.io.HoodieCreateHandle.<init>(HoodieCreateHandle.java:65)\r\ncom.uber.hoodie.func.LazyInsertIterable.computeNext(LazyInsertIterable.java:82)\r\ncom.uber.hoodie.func.LazyInsertIterable.computeNext(LazyInsertIterable.java:39)\r\ncom.uber.hoodie.func.LazyIterableIterator.next(LazyIterableIterator.java:118)\r\nscala.collection.convert.Wrappers$JIteratorWrapper.next(Wrappers.scala:42)\r\nscala.collection.Iterator$$anon$13.hasNext(Iterator.scala:371)\r\norg.apache.spark.storage.memory.MemoryStore.putIteratorAsBytes(MemoryStore.scala:363)\r\norg.apache.spark.storage.BlockManager$$anonfun$doPutIterator$1.apply(BlockManager.scala:973)\r\norg.apache.spark.storage.BlockManager$$anonfun$doPutIterator$1.apply(BlockManager.scala:948)\r\norg.apache.spark.storage.BlockManager.doPut(BlockManager.scala:888)\r\norg.apache.spark.storage.BlockManager.doPutIterator(BlockManager.scala:948)\r\norg.apache.spark.storage.BlockManager.getOrElseUpdate(BlockManager.scala:694)\r\norg.apache.spark.rdd.RDD.getOrCompute(RDD.scala:334)\r\norg.apache.spark.rdd.RDD.iterator(RDD.scala:285)\r\norg.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\r\norg.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\r\norg.apache.spark.rdd.RDD.iterator(RDD.scala:287)\r\norg.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\r\norg.apache.spark.scheduler.Task.run(Task.scala:99)\r\norg.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:282)\r\njava.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\r\njava.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\r\njava.lang.Thread.run(Thread.java:745)\r\n```\r\nCorresponding code : https://github.com/apache/hadoop/blob/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileSystem.java#L3311\r\n\r\nEssentially, the workaround is as follows : \r\n\r\nhttps://stackoverflow.com/questions/20057881/hadoop-filesystem-closed-exception-when-doing-bufferedreader-close/20061797#20061797\r\n\r\nSince the FileSystem close is not explicitly invoked, sc.stop() or something of that sort is not deterministic. I'm looking into Spark code to see how they handle creation of FileSystem objects.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/325744129/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/326628409","html_url":"https://github.com/apache/hudi/pull/241#issuecomment-326628409","issue_url":"https://api.github.com/repos/apache/hudi/issues/241","id":326628409,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjYyODQwOQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-01T16:41:59Z","updated_at":"2017-09-01T16:41:59Z","author_association":"MEMBER","body":"Thanks for the investigation. sparkContext.close() may not do anything with the filesystem objects, but my thought was : is if we do a `sc.stop` and thus waiting for all inflight tasks to be done and then call fs.close(), that should be okay. the parquet writer closing the filesystem seems unfortunate and kind of assumes just one parquet writer per jvm? \r\n\r\nultimately, you are saying the tests will be flaky if we have more than a core? (which will slow down the tests a lot and have no parallelism at all.. I am struggling to come to terms with this) ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/326628409/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327243794","html_url":"https://github.com/apache/hudi/pull/253#issuecomment-327243794","issue_url":"https://api.github.com/repos/apache/hudi/issues/253","id":327243794,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzI0Mzc5NA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-05T17:14:41Z","updated_at":"2017-09-05T17:14:41Z","author_association":"MEMBER","body":"@ovj Could you take a look at failing tests? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327243794/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327248837","html_url":"https://github.com/apache/hudi/pull/253#issuecomment-327248837","issue_url":"https://api.github.com/repos/apache/hudi/issues/253","id":327248837,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzI0ODgzNw==","user":{"login":"ovj","id":899843,"node_id":"MDQ6VXNlcjg5OTg0Mw==","avatar_url":"https://avatars.githubusercontent.com/u/899843?v=4","gravatar_id":"","url":"https://api.github.com/users/ovj","html_url":"https://github.com/ovj","followers_url":"https://api.github.com/users/ovj/followers","following_url":"https://api.github.com/users/ovj/following{/other_user}","gists_url":"https://api.github.com/users/ovj/gists{/gist_id}","starred_url":"https://api.github.com/users/ovj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ovj/subscriptions","organizations_url":"https://api.github.com/users/ovj/orgs","repos_url":"https://api.github.com/users/ovj/repos","events_url":"https://api.github.com/users/ovj/events{/privacy}","received_events_url":"https://api.github.com/users/ovj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-05T17:33:23Z","updated_at":"2017-09-05T17:33:23Z","author_association":"CONTRIBUTOR","body":"Hi @vinothchandar Those tests are flaky. If I try them locally they pass. \"com.uber.hoodie.TestMergeOnReadTable\".\r\n`\r\nCaused by: com.uber.hoodie.exception.HoodieInsertException: Failed to initialize HoodieStorageWriter for path /tmp/junit6603311014218813808/2016/03/15/933ada6f-cef9-48bc-be61-8eddccc48658_0_001.parquet\r\n\tat com.uber.hoodie.io.HoodieCreateHandle.<init>(HoodieCreateHandle.java:67)\r\n\tat com.uber.hoodie.func.LazyInsertIterable.computeNext(LazyInsertIterable.java:82)\r\n\tat com.uber.hoodie.func.LazyInsertIterable.computeNext(LazyInsertIterable.java:39)\r\n\tat com.uber.hoodie.func.LazyIterableIterator.next(LazyIterableIterator.java:118)\r\n\t... 19 more\r\nCaused by: java.io.IOException: Filesystem closed\r\n\tat org.apache.hadoop.hdfs.DFSClient.checkOpen(DFSClient.java:857)\r\n\tat org.apache.hadoop.hdfs.DFSClient.create(DFSClient.java:1740)\r\n\tat org.apache.hadoop.hdfs.DFSClient.create(DFSClient.java:1682)\r\n\tat org.apache.hadoop.hdfs.DistributedFileSystem$6.doCall(DistributedFileSystem.java:405)\r\n\tat org.apache.hadoop.hdfs.DistributedFileSystem$6.doCall(DistributedFileSystem.java:401)\r\n\tat org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)\r\n\tat org.apache.hadoop.hdfs.DistributedFileSystem.create(DistributedFileSystem.java:401)\r\n\tat org.apache.hadoop.hdfs.DistributedFileSystem.create(DistributedFileSystem.java:344)\r\n\tat org.apache.hadoop.fs.FileSystem.create(FileSystem.java:920)\r\n\tat org.apache.hadoop.fs.FileSystem.create(FileSystem.java:901)\r\n\tat org.apache.hadoop.fs.FileSystem.create(FileSystem.java:798)\r\n\tat com.uber.hoodie.io.storage.HoodieWrapperFileSystem.create(HoodieWrapperFileSystem.java:111)\r\n\tat org.apache.parquet.hadoop.ParquetFileWriter.<init>(ParquetFileWriter.java:223)\r\n\tat org.apache.parquet.hadoop.ParquetWriter.<init>(ParquetWriter.java:266)\r\n\tat org.apache.parquet.hadoop.ParquetWriter.<init>(ParquetWriter.java:217)\r\n\tat com.uber.hoodie.io.storage.HoodieParquetWriter.<init>(HoodieParquetWriter.java:66)\r\n\tat com.uber.hoodie.io.storage.HoodieStorageWriterFactory.newParquetStorageWriter(HoodieStorageWriterFactory.java:55)\r\n\tat com.uber.hoodie.io.storage.HoodieStorageWriterFactory.getStorageWriter(HoodieStorageWriterFactory.java:40)\r\n\tat com.uber.hoodie.io.HoodieCreateHandle.<init>(HoodieCreateHandle.java:65)\r\n\t... 22 more\r\n`","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327248837/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327249311","html_url":"https://github.com/apache/hudi/pull/253#issuecomment-327249311","issue_url":"https://api.github.com/repos/apache/hudi/issues/253","id":327249311,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzI0OTMxMQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-05T17:35:14Z","updated_at":"2017-09-05T17:35:14Z","author_association":"MEMBER","body":"seems related to #243 .. restarted the build ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327249311/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327263399","html_url":"https://github.com/apache/hudi/pull/220#issuecomment-327263399","issue_url":"https://api.github.com/repos/apache/hudi/issues/220","id":327263399,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzI2MzM5OQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-05T18:31:30Z","updated_at":"2017-09-05T18:31:30Z","author_association":"MEMBER","body":"@alunarbeach anything to share? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327263399/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327477851","html_url":"https://github.com/apache/hudi/pull/220#issuecomment-327477851","issue_url":"https://api.github.com/repos/apache/hudi/issues/220","id":327477851,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzQ3Nzg1MQ==","user":{"login":"alunarbeach","id":494035,"node_id":"MDQ6VXNlcjQ5NDAzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/494035?v=4","gravatar_id":"","url":"https://api.github.com/users/alunarbeach","html_url":"https://github.com/alunarbeach","followers_url":"https://api.github.com/users/alunarbeach/followers","following_url":"https://api.github.com/users/alunarbeach/following{/other_user}","gists_url":"https://api.github.com/users/alunarbeach/gists{/gist_id}","starred_url":"https://api.github.com/users/alunarbeach/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alunarbeach/subscriptions","organizations_url":"https://api.github.com/users/alunarbeach/orgs","repos_url":"https://api.github.com/users/alunarbeach/repos","events_url":"https://api.github.com/users/alunarbeach/events{/privacy}","received_events_url":"https://api.github.com/users/alunarbeach/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-06T13:09:19Z","updated_at":"2017-09-06T13:09:19Z","author_association":"CONTRIBUTOR","body":"Not yet.\nWas on a long vacation\n\n- Anbu\n\n> On Sep 5, 2017, at 2:33 PM, vinoth chandar <notifications@github.com> wrote:\n> \n> @alunarbeach anything to share?\n> \n> \n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub, or mute the thread.\n> \n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327477851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327871439","html_url":"https://github.com/apache/hudi/pull/247#issuecomment-327871439","issue_url":"https://api.github.com/repos/apache/hudi/issues/247","id":327871439,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzg3MTQzOQ==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-07T17:38:57Z","updated_at":"2017-09-07T17:38:57Z","author_association":"CONTRIBUTOR","body":"Addressed some comments, some follow up questions/comments.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327871439/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327872966","html_url":"https://github.com/apache/hudi/pull/220#issuecomment-327872966","issue_url":"https://api.github.com/repos/apache/hudi/issues/220","id":327872966,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzg3Mjk2Ng==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-07T17:45:05Z","updated_at":"2017-09-07T17:45:05Z","author_association":"MEMBER","body":"No worries.. @prazanna is also around to help out with scoping this, when you are ready","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327872966/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327874616","html_url":"https://github.com/apache/hudi/pull/253#issuecomment-327874616","issue_url":"https://api.github.com/repos/apache/hudi/issues/253","id":327874616,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzg3NDYxNg==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-07T17:51:03Z","updated_at":"2017-09-07T17:51:03Z","author_association":"MEMBER","body":"@ovj like to merge this in + the other PR on plugging in partitioner, to cut a new release.. Can you update the PRs with the follow ups we discussed offline.. thnx!","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327874616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327874931","html_url":"https://github.com/apache/hudi/pull/220#issuecomment-327874931","issue_url":"https://api.github.com/repos/apache/hudi/issues/220","id":327874931,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzg3NDkzMQ==","user":{"login":"prazanna","id":1994157,"node_id":"MDQ6VXNlcjE5OTQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/1994157?v=4","gravatar_id":"","url":"https://api.github.com/users/prazanna","html_url":"https://github.com/prazanna","followers_url":"https://api.github.com/users/prazanna/followers","following_url":"https://api.github.com/users/prazanna/following{/other_user}","gists_url":"https://api.github.com/users/prazanna/gists{/gist_id}","starred_url":"https://api.github.com/users/prazanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prazanna/subscriptions","organizations_url":"https://api.github.com/users/prazanna/orgs","repos_url":"https://api.github.com/users/prazanna/repos","events_url":"https://api.github.com/users/prazanna/events{/privacy}","received_events_url":"https://api.github.com/users/prazanna/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-07T17:52:14Z","updated_at":"2017-09-07T17:52:14Z","author_association":"CONTRIBUTOR","body":"@alunarbeach - will take a look at the PR this friday and lets come up with the best way to do this and see how much duplication we can avoid (if any)","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327874931/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327875528","html_url":"https://github.com/apache/hudi/pull/241#issuecomment-327875528","issue_url":"https://api.github.com/repos/apache/hudi/issues/241","id":327875528,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzg3NTUyOA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-07T17:54:25Z","updated_at":"2017-09-07T17:54:25Z","author_association":"MEMBER","body":"Filed another issue to continue on this.. Merging for now.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327875528/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327922820","html_url":"https://github.com/apache/hudi/pull/253#issuecomment-327922820","issue_url":"https://api.github.com/repos/apache/hudi/issues/253","id":327922820,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzkyMjgyMA==","user":{"login":"ovj","id":899843,"node_id":"MDQ6VXNlcjg5OTg0Mw==","avatar_url":"https://avatars.githubusercontent.com/u/899843?v=4","gravatar_id":"","url":"https://api.github.com/users/ovj","html_url":"https://github.com/ovj","followers_url":"https://api.github.com/users/ovj/followers","following_url":"https://api.github.com/users/ovj/following{/other_user}","gists_url":"https://api.github.com/users/ovj/gists{/gist_id}","starred_url":"https://api.github.com/users/ovj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ovj/subscriptions","organizations_url":"https://api.github.com/users/ovj/orgs","repos_url":"https://api.github.com/users/ovj/repos","events_url":"https://api.github.com/users/ovj/events{/privacy}","received_events_url":"https://api.github.com/users/ovj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-07T20:46:08Z","updated_at":"2017-09-07T20:46:08Z","author_association":"CONTRIBUTOR","body":"@vinothchandar Everything looks good with testing results. I tested this fix to make sure it handles small files growth correctly and there is no noticeable difference than existing one. Also for new inserts data is getting distributed fairly evenly.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327922820/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327962779","html_url":"https://github.com/apache/hudi/pull/253#issuecomment-327962779","issue_url":"https://api.github.com/repos/apache/hudi/issues/253","id":327962779,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzk2Mjc3OQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-08T00:05:09Z","updated_at":"2017-09-08T00:05:09Z","author_association":"MEMBER","body":"@ovj thanks for the valuable contribution and testing through this.. \r\n\r\nMerged.. (I am hoping the master CI passes now, given I pulled in @n3nash 's PR also, lets see. Might ping you to fix it right away, if there are indeed regressions by any chance)","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327962779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327964354","html_url":"https://github.com/apache/hudi/pull/253#issuecomment-327964354","issue_url":"https://api.github.com/repos/apache/hudi/issues/253","id":327964354,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzk2NDM1NA==","user":{"login":"ovj","id":899843,"node_id":"MDQ6VXNlcjg5OTg0Mw==","avatar_url":"https://avatars.githubusercontent.com/u/899843?v=4","gravatar_id":"","url":"https://api.github.com/users/ovj","html_url":"https://github.com/ovj","followers_url":"https://api.github.com/users/ovj/followers","following_url":"https://api.github.com/users/ovj/following{/other_user}","gists_url":"https://api.github.com/users/ovj/gists{/gist_id}","starred_url":"https://api.github.com/users/ovj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ovj/subscriptions","organizations_url":"https://api.github.com/users/ovj/orgs","repos_url":"https://api.github.com/users/ovj/repos","events_url":"https://api.github.com/users/ovj/events{/privacy}","received_events_url":"https://api.github.com/users/ovj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-08T00:12:55Z","updated_at":"2017-09-08T00:12:55Z","author_association":"CONTRIBUTOR","body":"Thanks @vinothchandar . Sure let me know.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/327964354/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/328085324","html_url":"https://github.com/apache/hudi/pull/220#issuecomment-328085324","issue_url":"https://api.github.com/repos/apache/hudi/issues/220","id":328085324,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODA4NTMyNA==","user":{"login":"alunarbeach","id":494035,"node_id":"MDQ6VXNlcjQ5NDAzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/494035?v=4","gravatar_id":"","url":"https://api.github.com/users/alunarbeach","html_url":"https://github.com/alunarbeach","followers_url":"https://api.github.com/users/alunarbeach/followers","following_url":"https://api.github.com/users/alunarbeach/following{/other_user}","gists_url":"https://api.github.com/users/alunarbeach/gists{/gist_id}","starred_url":"https://api.github.com/users/alunarbeach/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alunarbeach/subscriptions","organizations_url":"https://api.github.com/users/alunarbeach/orgs","repos_url":"https://api.github.com/users/alunarbeach/repos","events_url":"https://api.github.com/users/alunarbeach/events{/privacy}","received_events_url":"https://api.github.com/users/alunarbeach/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-08T12:04:02Z","updated_at":"2017-09-08T12:04:02Z","author_association":"CONTRIBUTOR","body":"Awesome\n\n- Anbu\n\n> On Sep 7, 2017, at 1:57 PM, prazanna <notifications@github.com> wrote:\n> \n> @alunarbeach - will take a look at the PR this friday and lets come up with the best way to do this and see how much duplication we can avoid (if any)\n> \n> \n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub, or mute the thread.\n> \n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/328085324/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/328171350","html_url":"https://github.com/apache/hudi/pull/241#issuecomment-328171350","issue_url":"https://api.github.com/repos/apache/hudi/issues/241","id":328171350,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODE3MTM1MA==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-08T17:52:17Z","updated_at":"2017-09-08T17:52:17Z","author_association":"CONTRIBUTOR","body":"Will take up the other issue this week/next week.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/328171350/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/328216168","html_url":"https://github.com/apache/hudi/pull/220#issuecomment-328216168","issue_url":"https://api.github.com/repos/apache/hudi/issues/220","id":328216168,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODIxNjE2OA==","user":{"login":"prazanna","id":1994157,"node_id":"MDQ6VXNlcjE5OTQxNTc=","avatar_url":"https://avatars.githubusercontent.com/u/1994157?v=4","gravatar_id":"","url":"https://api.github.com/users/prazanna","html_url":"https://github.com/prazanna","followers_url":"https://api.github.com/users/prazanna/followers","following_url":"https://api.github.com/users/prazanna/following{/other_user}","gists_url":"https://api.github.com/users/prazanna/gists{/gist_id}","starred_url":"https://api.github.com/users/prazanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prazanna/subscriptions","organizations_url":"https://api.github.com/users/prazanna/orgs","repos_url":"https://api.github.com/users/prazanna/repos","events_url":"https://api.github.com/users/prazanna/events{/privacy}","received_events_url":"https://api.github.com/users/prazanna/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-08T21:17:55Z","updated_at":"2017-09-08T21:25:44Z","author_association":"CONTRIBUTOR","body":"So upgrading the parquet from using twitter to apache in 1.0 branch of hive was done almost 2 years ago. Looks like there is no 1.X release from branch master ever since. \r\n (https://github.com/apache/hive/commit/efd059c503473d85f6ff2c961d912c2877fc5354). \r\n\r\nGiven this, I think the right thing to do for hoodie is not to depend on something that was released more than 2 years ago - we should move the parquet version to apache 1.7.0 in hoodie-hive module. \r\n\r\nThis should unblock @alunarbeach. \r\n\r\nTo make this work inside of Uber.\r\n1. Either make a copy of the current code to the internal repo and maintain hoodie-hive1 - till we move to hive 2 or there is a release of hive 1 from the branch trunk\r\n2. We can see if we can just cherry-pick the commit referenced above on our internal hive (which will just move our internal hive 1.1.0 to start using apache parquet). This may just work - but may need some serious vetting.\r\n\r\nWhat do you think? @vinothchandar \r\n \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/328216168/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/328241699","html_url":"https://github.com/apache/hudi/pull/245#issuecomment-328241699","issue_url":"https://api.github.com/repos/apache/hudi/issues/245","id":328241699,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODI0MTY5OQ==","user":{"login":"ovj","id":899843,"node_id":"MDQ6VXNlcjg5OTg0Mw==","avatar_url":"https://avatars.githubusercontent.com/u/899843?v=4","gravatar_id":"","url":"https://api.github.com/users/ovj","html_url":"https://github.com/ovj","followers_url":"https://api.github.com/users/ovj/followers","following_url":"https://api.github.com/users/ovj/following{/other_user}","gists_url":"https://api.github.com/users/ovj/gists{/gist_id}","starred_url":"https://api.github.com/users/ovj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ovj/subscriptions","organizations_url":"https://api.github.com/users/ovj/orgs","repos_url":"https://api.github.com/users/ovj/repos","events_url":"https://api.github.com/users/ovj/events{/privacy}","received_events_url":"https://api.github.com/users/ovj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-09T00:24:16Z","updated_at":"2017-09-09T00:24:16Z","author_association":"CONTRIBUTOR","body":"Spoke with @vinothchandar offline. Updated the PR. Now we are going to let users define their own partitioner logic.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/328241699/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/328566245","html_url":"https://github.com/apache/hudi/pull/255#issuecomment-328566245","issue_url":"https://api.github.com/repos/apache/hudi/issues/255","id":328566245,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODU2NjI0NQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-11T15:29:46Z","updated_at":"2017-09-11T15:29:46Z","author_association":"MEMBER","body":"Not following.. what makes the current call count inaccurate? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/328566245/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/328567793","html_url":"https://github.com/apache/hudi/pull/220#issuecomment-328567793","issue_url":"https://api.github.com/repos/apache/hudi/issues/220","id":328567793,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODU2Nzc5Mw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-11T15:34:43Z","updated_at":"2017-09-11T15:34:43Z","author_association":"MEMBER","body":"@prazanna That seems reasonable and makes things simpler overall.. \r\n\r\nLet me try to understand better, the steps to make it still work at Uber.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/328567793/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/328576818","html_url":"https://github.com/apache/hudi/issues/192#issuecomment-328576818","issue_url":"https://api.github.com/repos/apache/hudi/issues/192","id":328576818,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODU3NjgxOA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-11T16:04:07Z","updated_at":"2017-09-11T16:04:07Z","author_association":"MEMBER","body":"\r\n@n3nash I think this is fixed on 0.3.10 and on master.. could you confirm, so I can close this ? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/328576818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/328614276","html_url":"https://github.com/apache/hudi/pull/255#issuecomment-328614276","issue_url":"https://api.github.com/repos/apache/hudi/issues/255","id":328614276,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODYxNDI3Ng==","user":{"login":"jianxu","id":10394074,"node_id":"MDQ6VXNlcjEwMzk0MDc0","avatar_url":"https://avatars.githubusercontent.com/u/10394074?v=4","gravatar_id":"","url":"https://api.github.com/users/jianxu","html_url":"https://github.com/jianxu","followers_url":"https://api.github.com/users/jianxu/followers","following_url":"https://api.github.com/users/jianxu/following{/other_user}","gists_url":"https://api.github.com/users/jianxu/gists{/gist_id}","starred_url":"https://api.github.com/users/jianxu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jianxu/subscriptions","organizations_url":"https://api.github.com/users/jianxu/orgs","repos_url":"https://api.github.com/users/jianxu/repos","events_url":"https://api.github.com/users/jianxu/events{/privacy}","received_events_url":"https://api.github.com/users/jianxu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-11T18:19:48Z","updated_at":"2017-09-11T18:19:48Z","author_association":"CONTRIBUTOR","body":"@vinothchandar thanks for taking a look.  This change is mainly to remove ListStatus call on a single file.   Then ListStatus call count will mostly reflect ListStatus call on directories.\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/328614276/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/328615676","html_url":"https://github.com/apache/hudi/pull/255#issuecomment-328615676","issue_url":"https://api.github.com/repos/apache/hudi/issues/255","id":328615676,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODYxNTY3Ng==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-11T18:24:34Z","updated_at":"2017-09-11T18:24:34Z","author_association":"MEMBER","body":"Okay. so it seems like you are looking at certain types of `listStatus` and excluding this one as an exemption to that list. Anyways, seems benign. merging. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/328615676/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/328943001","html_url":"https://github.com/apache/hudi/issues/223#issuecomment-328943001","issue_url":"https://api.github.com/repos/apache/hudi/issues/223","id":328943001,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODk0MzAwMQ==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-12T18:35:04Z","updated_at":"2017-09-12T18:35:04Z","author_association":"CONTRIBUTOR","body":"This has been handled in https://github.com/uber/hoodie/pull/230","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/328943001/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/329178916","html_url":"https://github.com/apache/hudi/issues/110#issuecomment-329178916","issue_url":"https://api.github.com/repos/apache/hudi/issues/110","id":329178916,"node_id":"MDEyOklzc3VlQ29tbWVudDMyOTE3ODkxNg==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-13T14:07:00Z","updated_at":"2017-09-13T14:07:00Z","author_association":"MEMBER","body":"Here is the summary from discussion with @yssharma  \r\n\r\n- My concern that commit semantics might be compromised, if .inflight -> .commit rename fails midstream, seems to be not a problem, since s3 will guarantee the underlying copy is atomic. \r\n- Only pending issue is , dealing with S3's eventual consistency itself in cases where files that are part of a commit, have `not yet` become available for listing\r\n- EMRFS Route seems to have higher cost/operational overhead due to use of a coupled DynamoDB instance. \r\n\r\nOnward: \r\n- @yssharma is testing Copy-on-write datasets with S3, to unearth anyother issues\r\n- A simple (albeit adding more listing cost) fix here is to have HoodieInputFormat, optionally open up the commit file and ensure the files there are listable, before using that as the commit watermark for that query. (i,e a simple check to ensure queries wait enough time for files to show up)\r\n- A longer term fix here, could be building out the Hoodie Timeline server tier, that mostly @prazanna and I have discussed amongst ourselves. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/329178916/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/329180530","html_url":"https://github.com/apache/hudi/issues/257#issuecomment-329180530","issue_url":"https://api.github.com/repos/apache/hudi/issues/257","id":329180530,"node_id":"MDEyOklzc3VlQ29tbWVudDMyOTE4MDUzMA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-13T14:12:13Z","updated_at":"2017-09-13T14:12:13Z","author_association":"MEMBER","body":"cc @prazanna @yssharma ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/329180530/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/329269239","html_url":"https://github.com/apache/hudi/issues/175#issuecomment-329269239","issue_url":"https://api.github.com/repos/apache/hudi/issues/175","id":329269239,"node_id":"MDEyOklzc3VlQ29tbWVudDMyOTI2OTIzOQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-13T19:18:11Z","updated_at":"2017-09-13T19:18:11Z","author_association":"MEMBER","body":"Just leaving a note, that this is related to async compaction..","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/329269239/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/329847102","html_url":"https://github.com/apache/hudi/issues/40#issuecomment-329847102","issue_url":"https://api.github.com/repos/apache/hudi/issues/40","id":329847102,"node_id":"MDEyOklzc3VlQ29tbWVudDMyOTg0NzEwMg==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-15T17:29:40Z","updated_at":"2017-09-15T17:34:10Z","author_association":"CONTRIBUTOR","body":"There are some corner cases which need to be addressed : \r\n\r\n**Case 1  : Series of events** \r\n1. upsert(records)\r\n2. save workload profile to inflight commit file\r\n3. actuallyStartUpserting(..)\r\n4. upsert fails in the middle. \r\n\r\nAt this point, the job fails with updates to some log files and no updates to others. The workload profile metadata in the inflight however, has information about all log files that should've been updated.\r\n\r\n5. rollback(inflight) -> Reads metadata from workload profile about ALL log files and writes rollback blocks to them. Now we have a scenario with a log file with an extra rollback block (since the upsert never succeeded for that log file).\r\n\r\n**Solution**\r\n\r\nAdd metadata to log-blocks, more specifically an `instantTime` to every logBlock and a `targetInstantTime` to the RollBack block. Now, when the `HoodieCompactedLogRecordScanner` performs rollback, check if the `targetInstantTime` of the Rollback block is the same as `instantTime` of previous block being rolled back. \r\n\r\n**Thoughts**\r\n\r\nWe need to be able to evolve metadata for logBlocks (say we want to add something more), should we have a evolving schema for metadata ? Any other suggestions ?\r\n\r\n**Case 2 : Series of events**\r\n\r\n1. upsert(..) -> Add block to logFile, the log file needs to be rolled over, so a new version is written out.\r\n2. upsert(..) fails\r\n3. rollback(..) -> write rollback block to the new version of the log file.\r\n4. HoodieCompactedLogRecordScanner merges blocks only for a specific log file version and not across log files version (for the same log file ofcourse), so the rollback block written in the next log version will miss to rollback the block written in the previous log version.\r\n\r\n**Solution**\r\n\r\nMerge log blocks across versions, this requires some changes in `HoodieCompactedLogRecordScanner` and `HoodieRealtimeTableCompactor`\r\n\r\n@vinothchandar \r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/329847102/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/329850144","html_url":"https://github.com/apache/hudi/issues/40#issuecomment-329850144","issue_url":"https://api.github.com/repos/apache/hudi/issues/40","id":329850144,"node_id":"MDEyOklzc3VlQ29tbWVudDMyOTg1MDE0NA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-15T17:41:50Z","updated_at":"2017-09-15T17:41:50Z","author_association":"MEMBER","body":"I actually thought these checks were already there.\r\n\r\nAnyways, I agree with high level approach above, but want to concisely summarize the correctness criteria there. \r\n\r\n> Reader will continue to read and merge the records in all log versions, starting with first log version till it either (a) hits EOF on last log version or  (b) encountered a data block with instant time > latest instant time on timeline. Additionally, it is always prepared to rollback the effects of the last data/delete block on the merged values in memory, upon encountering a rollback block. \r\n\r\nAbove should ensure correctness (if you agree, please add this as a doc on the scanner/compactor).  As for evolving the logBlock metadata, it would be good, to just structure it as a opaque string, string map.. and we can extend later as needed. \r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/329850144/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/329863571","html_url":"https://github.com/apache/hudi/issues/143#issuecomment-329863571","issue_url":"https://api.github.com/repos/apache/hudi/issues/143","id":329863571,"node_id":"MDEyOklzc3VlQ29tbWVudDMyOTg2MzU3MQ==","user":{"login":"kaushikd49","id":1446360,"node_id":"MDQ6VXNlcjE0NDYzNjA=","avatar_url":"https://avatars.githubusercontent.com/u/1446360?v=4","gravatar_id":"","url":"https://api.github.com/users/kaushikd49","html_url":"https://github.com/kaushikd49","followers_url":"https://api.github.com/users/kaushikd49/followers","following_url":"https://api.github.com/users/kaushikd49/following{/other_user}","gists_url":"https://api.github.com/users/kaushikd49/gists{/gist_id}","starred_url":"https://api.github.com/users/kaushikd49/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaushikd49/subscriptions","organizations_url":"https://api.github.com/users/kaushikd49/orgs","repos_url":"https://api.github.com/users/kaushikd49/repos","events_url":"https://api.github.com/users/kaushikd49/events{/privacy}","received_events_url":"https://api.github.com/users/kaushikd49/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-15T18:26:41Z","updated_at":"2017-09-15T18:26:41Z","author_association":"CONTRIBUTOR","body":"Hi Vinoth, could you please add me to Slack? email: kaushikd49@gmail.com","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/329863571/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/329889649","html_url":"https://github.com/apache/hudi/issues/40#issuecomment-329889649","issue_url":"https://api.github.com/repos/apache/hudi/issues/40","id":329889649,"node_id":"MDEyOklzc3VlQ29tbWVudDMyOTg4OTY0OQ==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-15T20:10:24Z","updated_at":"2017-09-15T20:10:24Z","author_association":"CONTRIBUTOR","body":"Agreed, I'll update the PR and add as a doc. I was also tending towards a string map..","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/329889649/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/330320098","html_url":"https://github.com/apache/hudi/pull/251#issuecomment-330320098","issue_url":"https://api.github.com/repos/apache/hudi/issues/251","id":330320098,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMDMyMDA5OA==","user":{"login":"kaushikd49","id":1446360,"node_id":"MDQ6VXNlcjE0NDYzNjA=","avatar_url":"https://avatars.githubusercontent.com/u/1446360?v=4","gravatar_id":"","url":"https://api.github.com/users/kaushikd49","html_url":"https://github.com/kaushikd49","followers_url":"https://api.github.com/users/kaushikd49/followers","following_url":"https://api.github.com/users/kaushikd49/following{/other_user}","gists_url":"https://api.github.com/users/kaushikd49/gists{/gist_id}","starred_url":"https://api.github.com/users/kaushikd49/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaushikd49/subscriptions","organizations_url":"https://api.github.com/users/kaushikd49/orgs","repos_url":"https://api.github.com/users/kaushikd49/repos","events_url":"https://api.github.com/users/kaushikd49/events{/privacy}","received_events_url":"https://api.github.com/users/kaushikd49/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-18T18:48:55Z","updated_at":"2017-09-18T18:48:55Z","author_association":"CONTRIBUTOR","body":"@prazanna Thanks a lot for your comments. Had few questions on the comments. Could you please help answer them? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/330320098/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/330384271","html_url":"https://github.com/apache/hudi/pull/259#issuecomment-330384271","issue_url":"https://api.github.com/repos/apache/hudi/issues/259","id":330384271,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMDM4NDI3MQ==","user":{"login":"CLAassistant","id":11571300,"node_id":"MDQ6VXNlcjExNTcxMzAw","avatar_url":"https://avatars.githubusercontent.com/u/11571300?v=4","gravatar_id":"","url":"https://api.github.com/users/CLAassistant","html_url":"https://github.com/CLAassistant","followers_url":"https://api.github.com/users/CLAassistant/followers","following_url":"https://api.github.com/users/CLAassistant/following{/other_user}","gists_url":"https://api.github.com/users/CLAassistant/gists{/gist_id}","starred_url":"https://api.github.com/users/CLAassistant/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CLAassistant/subscriptions","organizations_url":"https://api.github.com/users/CLAassistant/orgs","repos_url":"https://api.github.com/users/CLAassistant/repos","events_url":"https://api.github.com/users/CLAassistant/events{/privacy}","received_events_url":"https://api.github.com/users/CLAassistant/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-18T23:26:11Z","updated_at":"2017-09-18T23:38:17Z","author_association":"NONE","body":"[![CLA assistant check](https://cla-assistant.io/pull/badge/signed)](https://cla-assistant.io/uber/hoodie?pullRequest=259) <br/>All committers have signed the CLA.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/330384271/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]