[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1444741508","html_url":"https://github.com/apache/iceberg/pull/6923#issuecomment-1444741508","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6923","id":1444741508,"node_id":"IC_kwDOCW7NX85WHQGE","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-24T23:50:39Z","updated_at":"2023-02-24T23:50:39Z","author_association":"CONTRIBUTOR","body":"Thanks, @huaxingao!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1444741508/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445144640","html_url":"https://github.com/apache/iceberg/pull/6935#issuecomment-1445144640","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6935","id":1445144640,"node_id":"IC_kwDOCW7NX85WIyhA","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-25T15:40:20Z","updated_at":"2023-02-25T15:53:09Z","author_association":"CONTRIBUTOR","body":"Thanks for your sharing!\r\n>  The filter is applied at the row group level, but it looks like that's not how RowRanges works in Parquet, so this probably needs to be refactored to run the filter, produce RowRanges, and set them on the ParquetFileReader just once.\r\n\r\nI think `RowRanges` is also at the row [group level](https://github.com/apache/parquet-mr/blob/c9cfe821448a2f99797fda7f46c70a16cc1250a9/parquet-column/src/main/java/org/apache/parquet/internal/filter2/columnindex/RowRanges.java#L33), Parquet-mr will [generate](https://github.com/apache/parquet-mr/blob/c9cfe821448a2f99797fda7f46c70a16cc1250a9/parquet-hadoop/src/main/java/org/apache/parquet/hadoop/ParquetFileReader.java#L1142）) a `RowRanges` for each row-group when running the column index filter. So I think the `allRows` is correct because the row index stored in the page index is also its position in the row-group.\r\n\r\nI have a convern is that  currently we can't read filtered row-group even after we set `RowRanges` in ParquetFileReader.  The `readFilteredRowGroup` method provided by Parquet will [detect](https://github.com/apache/parquet-mr/blob/c9cfe821448a2f99797fda7f46c70a16cc1250a9/parquet-hadoop/src/main/java/org/apache/parquet/hadoop/ParquetFileReader.java#L1004) whether there is a filter pushed down,\r\nand only return the filtered row-group when there is a push-down filter.\r\nSo I think we maybe can add a method in ParquetFileReader that allows users to specify RowRanges by themselves, after all Iceberg will calculate these RowRanges by itself:\r\n\r\n```\r\npublic ColumnChunkPageReadStore readFilteredRowGroup(int blockIndex, RowRanges rowRanges) throws IOException {\r\n```\r\n@rdblue WDYT? In addition, I think we can also let Parquet expose some methods to make it easier for Iceberg to implement column index filter. We will have to wait for the next version to use, but Parquet-mr may have a release in a month, see this [comment](https://github.com/apache/parquet-mr/pull/982#issuecomment-1376750703) , we should be able to catch up with this release. If you agree, I can open a PR in the Parquet-mr repo. I think we could use these [changes](https://github.com/zhongyujiang/parquet-mr/commit/25ad270f733ea8797c2bb7af24b58cd13d76a748) in Parquet. Here is my [implementation](https://github.com/zhongyujiang/iceberg/commit/b8c13c500d4437cd3f718f29df489f9fe6119e2d#diff-1c6b5e906f6299257c0d58fef74ee99569bfa24a9f3a6a257a39744d07e2a63b) based on these Parquet APIs if you‘d like to review it :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445144640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445194802","html_url":"https://github.com/apache/iceberg/pull/6937#issuecomment-1445194802","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6937","id":1445194802,"node_id":"IC_kwDOCW7NX85WI-wy","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-25T20:12:03Z","updated_at":"2023-02-25T20:12:03Z","author_association":"CONTRIBUTOR","body":"backport for PR #5029 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445194802/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445232477","html_url":"https://github.com/apache/iceberg/issues/5663#issuecomment-1445232477","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5663","id":1445232477,"node_id":"IC_kwDOCW7NX85WJH9d","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-26T00:13:18Z","updated_at":"2023-02-26T00:13:18Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445232477/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445232482","html_url":"https://github.com/apache/iceberg/issues/5649#issuecomment-1445232482","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5649","id":1445232482,"node_id":"IC_kwDOCW7NX85WJH9i","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-26T00:13:20Z","updated_at":"2023-02-26T00:13:20Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445232482/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445232501","html_url":"https://github.com/apache/iceberg/issues/5540#issuecomment-1445232501","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5540","id":1445232501,"node_id":"IC_kwDOCW7NX85WJH91","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-26T00:13:26Z","updated_at":"2023-02-26T00:13:26Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445232501/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445436703","html_url":"https://github.com/apache/iceberg/pull/6935#issuecomment-1445436703","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6935","id":1445436703,"node_id":"IC_kwDOCW7NX85WJ50f","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-26T18:59:24Z","updated_at":"2023-02-26T18:59:24Z","author_association":"CONTRIBUTOR","body":"> The readFilteredRowGroup method provided by Parquet will detect whether there is a filter pushed down,\r\nand only return the filtered row-group when there is a push-down filter.\r\n\r\nI commented where we set the row ranges for the row group. I think that should work with Parquet, but it's been a while since I looked at it. Getting a public API call in would make it easier.\r\n\r\n> I think RowRanges is also at the row [group level](https://github.com/apache/parquet-mr/blob/c9cfe821448a2f99797fda7f46c70a16cc1250a9/parquet-column/src/main/java/org/apache/parquet/internal/filter2/columnindex/RowRanges.java#L33), Parquet-mr will [generate](https://github.com/apache/parquet-mr/blob/c9cfe821448a2f99797fda7f46c70a16cc1250a9/parquet-hadoop/src/main/java/org/apache/parquet/hadoop/ParquetFileReader.java#L1142%EF%BC%89) a RowRanges for each row-group when running the column index filter.\r\n\r\nGreat! I put this together by trying to reverse engineer what was going on in Parquet, so I must have gotten it right.\r\n\r\n> We will have to wait for the next version to use, but Parquet-mr may have a release in a month, see this comment , we should be able to catch up with this release. If you agree, I can open a PR in the Parquet-mr repo.\r\n\r\nI'm all for adding what we need to Parquet. We can continue to use reflection until it is available.\r\n\r\nI think the main thing is that we don't currently handle the row ranges after we've skipped reading the pages. So the next steps are to verify what's in this PR and then to update the read paths so that values are skipped for the skipped rows.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445436703/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445450290","html_url":"https://github.com/apache/iceberg/pull/6923#issuecomment-1445450290","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6923","id":1445450290,"node_id":"IC_kwDOCW7NX85WJ9Iy","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-26T19:49:48Z","updated_at":"2023-02-26T19:49:48Z","author_association":"CONTRIBUTOR","body":"Thanks, @huaxingao!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445450290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445451695","html_url":"https://github.com/apache/iceberg/pull/6923#issuecomment-1445451695","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6923","id":1445451695,"node_id":"IC_kwDOCW7NX85WJ9ev","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-26T19:55:48Z","updated_at":"2023-02-26T19:55:48Z","author_association":"CONTRIBUTOR","body":"Thank you all!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445451695/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445512475","html_url":"https://github.com/apache/iceberg/issues/5673#issuecomment-1445512475","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5673","id":1445512475,"node_id":"IC_kwDOCW7NX85WKMUb","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-27T00:12:36Z","updated_at":"2023-02-27T00:12:36Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445512475/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445512488","html_url":"https://github.com/apache/iceberg/issues/5630#issuecomment-1445512488","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5630","id":1445512488,"node_id":"IC_kwDOCW7NX85WKMUo","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-27T00:12:39Z","updated_at":"2023-02-27T00:12:39Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445512488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445512515","html_url":"https://github.com/apache/iceberg/issues/5553#issuecomment-1445512515","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5553","id":1445512515,"node_id":"IC_kwDOCW7NX85WKMVD","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-27T00:12:43Z","updated_at":"2023-02-27T00:12:43Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445512515/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445779483","html_url":"https://github.com/apache/iceberg/issues/6918#issuecomment-1445779483","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6918","id":1445779483,"node_id":"IC_kwDOCW7NX85WLNgb","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-27T06:25:55Z","updated_at":"2023-02-27T06:25:55Z","author_association":"CONTRIBUTOR","body":"I  would suggest to use Hive 4.\r\nAlternatively you can try Tez as an execution engine","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445779483/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445924812","html_url":"https://github.com/apache/iceberg/issues/6945#issuecomment-1445924812","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6945","id":1445924812,"node_id":"IC_kwDOCW7NX85WLw_M","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-27T08:46:36Z","updated_at":"2023-02-27T08:47:26Z","author_association":"CONTRIBUTOR","body":"Maybe we should also change the default timezone to UTC, since I think it is more common to have `UTC` as default, instead of `+00:00`:\r\n![image](https://user-images.githubusercontent.com/1134248/221516071-a7562861-0e69-4c0e-8cc3-457711ddcea9.png)\r\nThis is from the docker-spark-iceberg quickstart setup, and it uses UTC. That's stored in the Parquet file, and then read by PyIceberg.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1445924812/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1446036220","html_url":"https://github.com/apache/iceberg/pull/6895#issuecomment-1446036220","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6895","id":1446036220,"node_id":"IC_kwDOCW7NX85WMML8","user":{"login":"youngxinler","id":36697727,"node_id":"MDQ6VXNlcjM2Njk3NzI3","avatar_url":"https://avatars.githubusercontent.com/u/36697727?v=4","gravatar_id":"","url":"https://api.github.com/users/youngxinler","html_url":"https://github.com/youngxinler","followers_url":"https://api.github.com/users/youngxinler/followers","following_url":"https://api.github.com/users/youngxinler/following{/other_user}","gists_url":"https://api.github.com/users/youngxinler/gists{/gist_id}","starred_url":"https://api.github.com/users/youngxinler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/youngxinler/subscriptions","organizations_url":"https://api.github.com/users/youngxinler/orgs","repos_url":"https://api.github.com/users/youngxinler/repos","events_url":"https://api.github.com/users/youngxinler/events{/privacy}","received_events_url":"https://api.github.com/users/youngxinler/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-27T10:01:16Z","updated_at":"2023-02-27T10:01:16Z","author_association":"CONTRIBUTOR","body":"nice job, I also ran into this problem two days ago.  thanks @abmo-x ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1446036220/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1446045524","html_url":"https://github.com/apache/iceberg/pull/6789#issuecomment-1446045524","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6789","id":1446045524,"node_id":"IC_kwDOCW7NX85WMOdU","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-27T10:07:54Z","updated_at":"2023-02-27T10:08:42Z","author_association":"MEMBER","body":"@snazy, @dimas-b: \r\nI checked some more code today.\r\n**I found that `NessieTableOperation` works on a copy of the client. Not the actual client from `NessieCatalog`. as `withReference` creates a new client object.**\r\n\r\nhttps://github.com/apache/iceberg/blob/cb612ed142b600a7a4c8bb756fb71ffa5c1a0909/nessie/src/main/java/org/apache/iceberg/nessie/NessieCatalog.java#L197\r\n\r\nAnd the client inside the `NessieTableOperation` will never be refreshed/out of state. There is also this check.\r\nhttps://github.com/apache/iceberg/blob/cb612ed142b600a7a4c8bb756fb71ffa5c1a0909/core/src/main/java/org/apache/iceberg/BaseMetastoreTableOperations.java#L121\r\n\r\nTLDR;\r\nPR changes are for the client of `NessieCatalog`, not for the client of `NessieTableOperations`. Hence, I don't think there is any impact on the expected hash calculation of the commits of `NessieTableOperations`.\r\n\r\nPlease recheck the PR again and let me know if a change required on this.\r\n  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1446045524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1446241610","html_url":"https://github.com/apache/iceberg/pull/6757#issuecomment-1446241610","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6757","id":1446241610,"node_id":"IC_kwDOCW7NX85WM-VK","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-27T12:26:27Z","updated_at":"2023-02-27T12:26:27Z","author_association":"CONTRIBUTOR","body":"Closing this in favor of https://github.com/apache/iceberg/pull/6948","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1446241610/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1446336047","html_url":"https://github.com/apache/iceberg/pull/6906#issuecomment-1446336047","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6906","id":1446336047,"node_id":"IC_kwDOCW7NX85WNVYv","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-27T13:35:31Z","updated_at":"2023-02-27T13:35:31Z","author_association":"CONTRIBUTOR","body":"@Buktoria this is awesome, thanks for working on this. Let me know when it is ready for review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1446336047/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1446361115","html_url":"https://github.com/apache/iceberg/pull/6935#issuecomment-1446361115","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6935","id":1446361115,"node_id":"IC_kwDOCW7NX85WNbgb","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-27T13:53:43Z","updated_at":"2023-02-27T13:53:43Z","author_association":"CONTRIBUTOR","body":"> I'm all for adding what we need to Parquet. We can continue to use reflection until it is available.\r\n> \r\n> I think the main thing is that we don't currently handle the row ranges after we've skipped reading the pages. So the next steps are to verify what's in this PR and then to update the read paths so that values are skipped for the skipped rows.\r\n\r\nGot it!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1446361115/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1446393725","html_url":"https://github.com/apache/iceberg/pull/6440#issuecomment-1446393725","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6440","id":1446393725,"node_id":"IC_kwDOCW7NX85WNjd9","user":{"login":"xwmr-max","id":61017037,"node_id":"MDQ6VXNlcjYxMDE3MDM3","avatar_url":"https://avatars.githubusercontent.com/u/61017037?v=4","gravatar_id":"","url":"https://api.github.com/users/xwmr-max","html_url":"https://github.com/xwmr-max","followers_url":"https://api.github.com/users/xwmr-max/followers","following_url":"https://api.github.com/users/xwmr-max/following{/other_user}","gists_url":"https://api.github.com/users/xwmr-max/gists{/gist_id}","starred_url":"https://api.github.com/users/xwmr-max/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xwmr-max/subscriptions","organizations_url":"https://api.github.com/users/xwmr-max/orgs","repos_url":"https://api.github.com/users/xwmr-max/repos","events_url":"https://api.github.com/users/xwmr-max/events{/privacy}","received_events_url":"https://api.github.com/users/xwmr-max/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-27T14:12:56Z","updated_at":"2023-02-27T14:12:56Z","author_association":"CONTRIBUTOR","body":"@stevenzwu cc","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1446393725/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1446535463","html_url":"https://github.com/apache/iceberg/pull/6862#issuecomment-1446535463","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6862","id":1446535463,"node_id":"IC_kwDOCW7NX85WOGEn","user":{"login":"munendrasn","id":9696252,"node_id":"MDQ6VXNlcjk2OTYyNTI=","avatar_url":"https://avatars.githubusercontent.com/u/9696252?v=4","gravatar_id":"","url":"https://api.github.com/users/munendrasn","html_url":"https://github.com/munendrasn","followers_url":"https://api.github.com/users/munendrasn/followers","following_url":"https://api.github.com/users/munendrasn/following{/other_user}","gists_url":"https://api.github.com/users/munendrasn/gists{/gist_id}","starred_url":"https://api.github.com/users/munendrasn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/munendrasn/subscriptions","organizations_url":"https://api.github.com/users/munendrasn/orgs","repos_url":"https://api.github.com/users/munendrasn/repos","events_url":"https://api.github.com/users/munendrasn/events{/privacy}","received_events_url":"https://api.github.com/users/munendrasn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-27T15:25:47Z","updated_at":"2023-02-27T15:25:47Z","author_association":"CONTRIBUTOR","body":"Hi @jackye1995 \r\nThis looks good for review. Kindly, let me know if anything need to be addressed before the review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1446535463/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1446691211","html_url":"https://github.com/apache/iceberg/pull/6936#issuecomment-1446691211","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6936","id":1446691211,"node_id":"IC_kwDOCW7NX85WOsGL","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-27T16:57:34Z","updated_at":"2023-02-28T04:29:02Z","author_association":"CONTRIBUTOR","body":"@nastra a quick question. For Spark, does Iceberg scan or commit only happen at the driver side? Hence the SparkCatalog init of EnvironmentContext is good enough.\r\n\r\nThis also shows the drawback of global static hold of `EnvironmentContext`, which is a little tricky to manage the context. I ams wondering if we can bake those optional engine metadata into the APIs (for scan and update/commit).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1446691211/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1446853851","html_url":"https://github.com/apache/iceberg/pull/6651#issuecomment-1446853851","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6651","id":1446853851,"node_id":"IC_kwDOCW7NX85WPTzb","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-27T18:34:55Z","updated_at":"2023-02-27T18:34:55Z","author_association":"CONTRIBUTOR","body":"If there's no objections, I'll raise a separate PR since the approach and user experience is different than how the PR started. It also should make it easier to review for reviewers to avoid getting distracted by discussions which may no longer be relevant. I'll be sure to mark @namrathamyske as co-author too! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1446853851/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1446856475","html_url":"https://github.com/apache/iceberg/pull/6895#issuecomment-1446856475","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6895","id":1446856475,"node_id":"IC_kwDOCW7NX85WPUcb","user":{"login":"abmo-x","id":69539469,"node_id":"MDQ6VXNlcjY5NTM5NDY5","avatar_url":"https://avatars.githubusercontent.com/u/69539469?v=4","gravatar_id":"","url":"https://api.github.com/users/abmo-x","html_url":"https://github.com/abmo-x","followers_url":"https://api.github.com/users/abmo-x/followers","following_url":"https://api.github.com/users/abmo-x/following{/other_user}","gists_url":"https://api.github.com/users/abmo-x/gists{/gist_id}","starred_url":"https://api.github.com/users/abmo-x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abmo-x/subscriptions","organizations_url":"https://api.github.com/users/abmo-x/orgs","repos_url":"https://api.github.com/users/abmo-x/repos","events_url":"https://api.github.com/users/abmo-x/events{/privacy}","received_events_url":"https://api.github.com/users/abmo-x/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-27T18:36:55Z","updated_at":"2023-02-27T18:36:55Z","author_association":"CONTRIBUTOR","body":"Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1446856475/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447025267","html_url":"https://github.com/apache/iceberg/pull/6937#issuecomment-1447025267","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6937","id":1447025267,"node_id":"IC_kwDOCW7NX85WP9pz","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-27T20:19:09Z","updated_at":"2023-02-27T20:19:09Z","author_association":"CONTRIBUTOR","body":"thx @hililiwei . rebased and merged the two commits.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447025267/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447204489","html_url":"https://github.com/apache/iceberg/pull/6951#issuecomment-1447204489","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6951","id":1447204489,"node_id":"IC_kwDOCW7NX85WQpaJ","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-27T22:22:00Z","updated_at":"2023-02-27T22:22:00Z","author_association":"CONTRIBUTOR","body":"@jackye1995 It would be great if someone from the AWS could validate how we're configuration and signing these requests to make sure they're SigV4 compliant.  We're leveraging the SDKv2 for most of the mechanics, but verification from your side would be great since I don't know if we can actually validate the signatures are correct.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447204489/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447297524","html_url":"https://github.com/apache/iceberg/pull/6880#issuecomment-1447297524","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6880","id":1447297524,"node_id":"IC_kwDOCW7NX85WRAH0","user":{"login":"JonasJ-ap","id":55990951,"node_id":"MDQ6VXNlcjU1OTkwOTUx","avatar_url":"https://avatars.githubusercontent.com/u/55990951?v=4","gravatar_id":"","url":"https://api.github.com/users/JonasJ-ap","html_url":"https://github.com/JonasJ-ap","followers_url":"https://api.github.com/users/JonasJ-ap/followers","following_url":"https://api.github.com/users/JonasJ-ap/following{/other_user}","gists_url":"https://api.github.com/users/JonasJ-ap/gists{/gist_id}","starred_url":"https://api.github.com/users/JonasJ-ap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JonasJ-ap/subscriptions","organizations_url":"https://api.github.com/users/JonasJ-ap/orgs","repos_url":"https://api.github.com/users/JonasJ-ap/repos","events_url":"https://api.github.com/users/JonasJ-ap/events{/privacy}","received_events_url":"https://api.github.com/users/JonasJ-ap/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-27T23:51:55Z","updated_at":"2023-02-27T23:51:55Z","author_association":"CONTRIBUTOR","body":"Thanks @jackye1995, @amogh-jahagirdar for reviewing this. I added the file existence check and refactored the integration tests based on your suggestions. @amogh-jahagirdar May I ask if you could review this PR again? Thank you in advance for your help!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447297524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447320252","html_url":"https://github.com/apache/iceberg/issues/5678#issuecomment-1447320252","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5678","id":1447320252,"node_id":"IC_kwDOCW7NX85WRFq8","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T00:12:23Z","updated_at":"2023-02-28T00:12:23Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447320252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447320318","html_url":"https://github.com/apache/iceberg/issues/5677#issuecomment-1447320318","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5677","id":1447320318,"node_id":"IC_kwDOCW7NX85WRFr-","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T00:12:25Z","updated_at":"2023-02-28T00:12:25Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447320318/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447466992","html_url":"https://github.com/apache/iceberg/pull/6753#issuecomment-1447466992","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6753","id":1447466992,"node_id":"IC_kwDOCW7NX85WRpfw","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T02:19:25Z","updated_at":"2023-02-28T02:19:25Z","author_association":"CONTRIBUTOR","body":"@chenjunjiedada thx for the contribution. can you create the backport PR too?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447466992/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447511175","html_url":"https://github.com/apache/iceberg/pull/6753#issuecomment-1447511175","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6753","id":1447511175,"node_id":"IC_kwDOCW7NX85WR0SH","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T03:17:36Z","updated_at":"2023-02-28T03:17:36Z","author_association":"COLLABORATOR","body":"@stevenzwu I will do the backport today. Thanks for fixing the compiling failure!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447511175/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447522804","html_url":"https://github.com/apache/iceberg/pull/6953#issuecomment-1447522804","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6953","id":1447522804,"node_id":"IC_kwDOCW7NX85WR3H0","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T03:35:29Z","updated_at":"2023-02-28T03:35:29Z","author_association":"CONTRIBUTOR","body":"CI build is stuck. re-run all the checks. it seems that the build actually completed. but somehow CI system wasn't getting the result and move forward. also observed the CI stuck issue from another PR #6949.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447522804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447574271","html_url":"https://github.com/apache/iceberg/pull/6954#issuecomment-1447574271","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6954","id":1447574271,"node_id":"IC_kwDOCW7NX85WSDr_","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T04:55:04Z","updated_at":"2023-02-28T04:55:04Z","author_association":"COLLABORATOR","body":"@stevenzwu Rebased, thanks for the review.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447574271/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447627649","html_url":"https://github.com/apache/iceberg/pull/6729#issuecomment-1447627649","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6729","id":1447627649,"node_id":"IC_kwDOCW7NX85WSQuB","user":{"login":"tomtongue","id":43331405,"node_id":"MDQ6VXNlcjQzMzMxNDA1","avatar_url":"https://avatars.githubusercontent.com/u/43331405?v=4","gravatar_id":"","url":"https://api.github.com/users/tomtongue","html_url":"https://github.com/tomtongue","followers_url":"https://api.github.com/users/tomtongue/followers","following_url":"https://api.github.com/users/tomtongue/following{/other_user}","gists_url":"https://api.github.com/users/tomtongue/gists{/gist_id}","starred_url":"https://api.github.com/users/tomtongue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomtongue/subscriptions","organizations_url":"https://api.github.com/users/tomtongue/orgs","repos_url":"https://api.github.com/users/tomtongue/repos","events_url":"https://api.github.com/users/tomtongue/events{/privacy}","received_events_url":"https://api.github.com/users/tomtongue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T05:58:16Z","updated_at":"2023-02-28T05:58:52Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing! I updated the line based on the discussion. It would be great if you review it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447627649/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447649327","html_url":"https://github.com/apache/iceberg/pull/6955#issuecomment-1447649327","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6955","id":1447649327,"node_id":"IC_kwDOCW7NX85WSWAv","user":{"login":"zhouyifan279","id":88070094,"node_id":"MDQ6VXNlcjg4MDcwMDk0","avatar_url":"https://avatars.githubusercontent.com/u/88070094?v=4","gravatar_id":"","url":"https://api.github.com/users/zhouyifan279","html_url":"https://github.com/zhouyifan279","followers_url":"https://api.github.com/users/zhouyifan279/followers","following_url":"https://api.github.com/users/zhouyifan279/following{/other_user}","gists_url":"https://api.github.com/users/zhouyifan279/gists{/gist_id}","starred_url":"https://api.github.com/users/zhouyifan279/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhouyifan279/subscriptions","organizations_url":"https://api.github.com/users/zhouyifan279/orgs","repos_url":"https://api.github.com/users/zhouyifan279/repos","events_url":"https://api.github.com/users/zhouyifan279/events{/privacy}","received_events_url":"https://api.github.com/users/zhouyifan279/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T06:20:07Z","updated_at":"2023-02-28T08:06:35Z","author_association":"CONTRIBUTOR","body":"Gently ping @gaborkaszab @haizhou-zhao ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447649327/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447676341","html_url":"https://github.com/apache/iceberg/issues/3417#issuecomment-1447676341","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3417","id":1447676341,"node_id":"IC_kwDOCW7NX85WScm1","user":{"login":"owencwl","id":12462934,"node_id":"MDQ6VXNlcjEyNDYyOTM0","avatar_url":"https://avatars.githubusercontent.com/u/12462934?v=4","gravatar_id":"","url":"https://api.github.com/users/owencwl","html_url":"https://github.com/owencwl","followers_url":"https://api.github.com/users/owencwl/followers","following_url":"https://api.github.com/users/owencwl/following{/other_user}","gists_url":"https://api.github.com/users/owencwl/gists{/gist_id}","starred_url":"https://api.github.com/users/owencwl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/owencwl/subscriptions","organizations_url":"https://api.github.com/users/owencwl/orgs","repos_url":"https://api.github.com/users/owencwl/repos","events_url":"https://api.github.com/users/owencwl/events{/privacy}","received_events_url":"https://api.github.com/users/owencwl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T06:57:20Z","updated_at":"2023-02-28T06:57:20Z","author_association":"NONE","body":"It seems to be the same problem as the issue 4550， https://github.com/apache/iceberg/issues/4550 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447676341/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447680227","html_url":"https://github.com/apache/iceberg/issues/3417#issuecomment-1447680227","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3417","id":1447680227,"node_id":"IC_kwDOCW7NX85WSdjj","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T07:01:04Z","updated_at":"2023-02-28T07:01:04Z","author_association":"CONTRIBUTOR","body":"@tlchao Thanks for opening this issue. What catalog are you using?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447680227/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447690156","html_url":"https://github.com/apache/iceberg/issues/6956#issuecomment-1447690156","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6956","id":1447690156,"node_id":"IC_kwDOCW7NX85WSf-s","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T07:11:01Z","updated_at":"2023-02-28T07:11:01Z","author_association":"CONTRIBUTOR","body":"@ldwnt It looks like you're using merge on read. Did you consider using copy-on-write? Even if the table is relatively small, the deletes might stack up.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447690156/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447700356","html_url":"https://github.com/apache/iceberg/issues/6956#issuecomment-1447700356","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6956","id":1447700356,"node_id":"IC_kwDOCW7NX85WSieE","user":{"login":"ldwnt","id":7655486,"node_id":"MDQ6VXNlcjc2NTU0ODY=","avatar_url":"https://avatars.githubusercontent.com/u/7655486?v=4","gravatar_id":"","url":"https://api.github.com/users/ldwnt","html_url":"https://github.com/ldwnt","followers_url":"https://api.github.com/users/ldwnt/followers","following_url":"https://api.github.com/users/ldwnt/following{/other_user}","gists_url":"https://api.github.com/users/ldwnt/gists{/gist_id}","starred_url":"https://api.github.com/users/ldwnt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ldwnt/subscriptions","organizations_url":"https://api.github.com/users/ldwnt/orgs","repos_url":"https://api.github.com/users/ldwnt/repos","events_url":"https://api.github.com/users/ldwnt/events{/privacy}","received_events_url":"https://api.github.com/users/ldwnt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T07:23:12Z","updated_at":"2023-02-28T07:28:17Z","author_association":"NONE","body":"> @ldwnt It looks like you're using merge on read. Did you consider using copy-on-write? Even if the table is relatively small, the deletes might stack up.\r\n\r\nThis iceberg table is created by a flink connector v0.13.0. The write.delete.mode parameter seem not to be exposed in this version?\r\n\r\nAnd I have a question: with merge on read mode, in the worst case, does an executor have to read all delete records (in my case maybe all the rows before the whole table delete)?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447700356/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447709562","html_url":"https://github.com/apache/iceberg/issues/6956#issuecomment-1447709562","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6956","id":1447709562,"node_id":"IC_kwDOCW7NX85WSkt6","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T07:33:53Z","updated_at":"2023-02-28T07:33:53Z","author_association":"CONTRIBUTOR","body":"Ah, I see, using merge on read using Flink makes sense.\r\n\r\n> And I have a question: with merge on read mode, in the worst case, does an executor have to read all delete records (in my case maybe all the rows before the whole table delete)?\r\n\r\nThere is some logic involved to optimize this, but equality deletes aren't the best choice when it comes to performance. Because at some point Flink will write a delete (`id=5`), and you have to apply this to the subsequent data files, which is quite costly as you might imagine. Of course, this is limited to the partitions that you're reading and will prune the deletes of the partitions that are outside of the scope of the query.\r\n\r\nWhat also would work is to compact the table using a Spark job periodically (ideally the partitions that aren't being written to anymore). So you'll get rid of the deletes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447709562/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447723347","html_url":"https://github.com/apache/iceberg/issues/6956#issuecomment-1447723347","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6956","id":1447723347,"node_id":"IC_kwDOCW7NX85WSoFT","user":{"login":"ldwnt","id":7655486,"node_id":"MDQ6VXNlcjc2NTU0ODY=","avatar_url":"https://avatars.githubusercontent.com/u/7655486?v=4","gravatar_id":"","url":"https://api.github.com/users/ldwnt","html_url":"https://github.com/ldwnt","followers_url":"https://api.github.com/users/ldwnt/followers","following_url":"https://api.github.com/users/ldwnt/following{/other_user}","gists_url":"https://api.github.com/users/ldwnt/gists{/gist_id}","starred_url":"https://api.github.com/users/ldwnt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ldwnt/subscriptions","organizations_url":"https://api.github.com/users/ldwnt/orgs","repos_url":"https://api.github.com/users/ldwnt/repos","events_url":"https://api.github.com/users/ldwnt/events{/privacy}","received_events_url":"https://api.github.com/users/ldwnt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T07:49:48Z","updated_at":"2023-02-28T07:53:21Z","author_association":"NONE","body":"> Ah, I see, using merge on read using Flink makes sense.\r\n> \r\n> > And I have a question: with merge on read mode, in the worst case, does an executor have to read all delete records (in my case maybe all the rows before the whole table delete)?\r\n> \r\n> There is some logic involved to optimize this, but equality deletes aren't the best choice when it comes to performance. Because at some point Flink will write a delete (`id=5`), and you have to apply this to the subsequent data files, which is quite costly as you might imagine. Of course, this is limited to the partitions that you're reading and will prune the deletes of the partitions that are outside of the scope of the query.\r\n> \r\n> What also would work is to compact the table using a Spark job periodically (ideally the partitions that aren't being written to anymore). So you'll get rid of the deletes.\r\n\r\nThe iceberg table is written by a flink job with an iceberg sink, whose source is a mysql table. I can not control the way the source table is updated, which is deleting all rows and inserting the new ones. In this scenario, can I make the connector use position delete or by any means make the following rewriting more efficient?\r\n\r\nYes, the spark job runs everyday. Unfortunately due to the way the source table is updated, I'm still facing 9 millions row deletes in a single run. Currently I'm considering increasing the executor memory to let the rewriting finishes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447723347/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447815136","html_url":"https://github.com/apache/iceberg/pull/6936#issuecomment-1447815136","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6936","id":1447815136,"node_id":"IC_kwDOCW7NX85WS-fg","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T09:04:59Z","updated_at":"2023-02-28T09:20:13Z","author_association":"CONTRIBUTOR","body":"> @nastra a quick question. For Spark, does Iceberg scan or commit only happen at the driver side? Hence the SparkCatalog init of EnvironmentContext is good enough.\r\n\r\nI debugged this when I introduced `EnvironmentContext` and setting this in the `SparkCatalog` was enough iirc. We're adding all the info from `EnvironmentContext` as metadata when scan reports or commit reports finish. This looks as shown below:\r\n\r\n```\r\nReceived metrics report: CommitReport{....., metadata={engine-version=3.3.1, app-id=local-1677575185331, engine-name=spark, iceberg-version=Apache Iceberg 1.2.0-SNAPSHOT (commit d2a85cd55838597a5a49ce1cb60ef9a0e2e08810)}}\r\n....\r\nReceived metrics report: ScanReport{....., metadata={engine-version=3.3.1, iceberg-version=Apache Iceberg 1.2.0-SNAPSHOT (commit d2a85cd55838597a5a49ce1cb60ef9a0e2e08810), app-id=local-1677575185331, engine-name=spark}}\r\n```\r\n\r\n> This also shows the drawback of global static hold of EnvironmentContext, which is a little tricky to manage the context. I ams wondering if we can bake those optional engine metadata into the APIs (for scan and update/commit).\r\n\r\nAdding stuff like this to the APIs makes it so much more complicated, since you have to pass information around. Particularly scan reporting is quite tricky in this case, because scan planning happens in multiple phases/places. Hence why we opted for the approach with `EnvironmentContext`, which has its own drawbacks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447815136/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447912759","html_url":"https://github.com/apache/iceberg/pull/6892#issuecomment-1447912759","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6892","id":1447912759,"node_id":"IC_kwDOCW7NX85WTWU3","user":{"login":"LuigiCerone","id":24299345,"node_id":"MDQ6VXNlcjI0Mjk5MzQ1","avatar_url":"https://avatars.githubusercontent.com/u/24299345?v=4","gravatar_id":"","url":"https://api.github.com/users/LuigiCerone","html_url":"https://github.com/LuigiCerone","followers_url":"https://api.github.com/users/LuigiCerone/followers","following_url":"https://api.github.com/users/LuigiCerone/following{/other_user}","gists_url":"https://api.github.com/users/LuigiCerone/gists{/gist_id}","starred_url":"https://api.github.com/users/LuigiCerone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LuigiCerone/subscriptions","organizations_url":"https://api.github.com/users/LuigiCerone/orgs","repos_url":"https://api.github.com/users/LuigiCerone/repos","events_url":"https://api.github.com/users/LuigiCerone/events{/privacy}","received_events_url":"https://api.github.com/users/LuigiCerone/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T10:13:42Z","updated_at":"2023-02-28T10:13:53Z","author_association":"CONTRIBUTOR","body":"Need to update [`python/tests/expressions/test_evaluator.py`](https://github.com/apache/iceberg/blob/master/python/tests/expressions/test_evaluator.py) according to new syntax. I will work on it asap.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1447912759/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448016855","html_url":"https://github.com/apache/iceberg/issues/6904#issuecomment-1448016855","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6904","id":1448016855,"node_id":"IC_kwDOCW7NX85WTvvX","user":{"login":"lexluo09","id":39718951,"node_id":"MDQ6VXNlcjM5NzE4OTUx","avatar_url":"https://avatars.githubusercontent.com/u/39718951?v=4","gravatar_id":"","url":"https://api.github.com/users/lexluo09","html_url":"https://github.com/lexluo09","followers_url":"https://api.github.com/users/lexluo09/followers","following_url":"https://api.github.com/users/lexluo09/following{/other_user}","gists_url":"https://api.github.com/users/lexluo09/gists{/gist_id}","starred_url":"https://api.github.com/users/lexluo09/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lexluo09/subscriptions","organizations_url":"https://api.github.com/users/lexluo09/orgs","repos_url":"https://api.github.com/users/lexluo09/repos","events_url":"https://api.github.com/users/lexluo09/events{/privacy}","received_events_url":"https://api.github.com/users/lexluo09/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T11:27:51Z","updated_at":"2023-02-28T11:27:51Z","author_association":"NONE","body":" @findepi , can you take a look？ Thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448016855/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448500702","html_url":"https://github.com/apache/iceberg/issues/6956#issuecomment-1448500702","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6956","id":1448500702,"node_id":"IC_kwDOCW7NX85WVl3e","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T16:41:04Z","updated_at":"2023-02-28T16:41:04Z","author_association":"CONTRIBUTOR","body":"@ldwnt, if the upstream table is completely refreshed every day, then why use a stream to move the data over to analytic storage? Seems like using a one-time copy after the refresh makes more sense.\r\n\r\nI also think that, in general, directly updating an analytic table from Flink is a bad idea. It's usually much more efficient to write the changes directly into a table and periodically compact to materialize the latest table state.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448500702/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448716938","html_url":"https://github.com/apache/iceberg/pull/6889#issuecomment-1448716938","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6889","id":1448716938,"node_id":"IC_kwDOCW7NX85WWaqK","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T19:10:13Z","updated_at":"2023-02-28T19:10:13Z","author_association":"COLLABORATOR","body":"Merged, thanks @dramaticlly , and @hililiwei @abmo-x for review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448716938/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448718713","html_url":"https://github.com/apache/iceberg/pull/6729#issuecomment-1448718713","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6729","id":1448718713,"node_id":"IC_kwDOCW7NX85WWbF5","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T19:11:17Z","updated_at":"2023-02-28T19:11:17Z","author_association":"COLLABORATOR","body":"Merged, thanks @tomtongue !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448718713/reactions","total_count":2,"+1":1,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448723777","html_url":"https://github.com/apache/iceberg/pull/6849#issuecomment-1448723777","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6849","id":1448723777,"node_id":"IC_kwDOCW7NX85WWcVB","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T19:14:15Z","updated_at":"2023-02-28T19:14:15Z","author_association":"COLLABORATOR","body":"@dramaticlly i chatted with @RussellSpitzer offline, do you want to make an issue to explore if we can have the SparkUtil itself return these values, instead of using snapshot summary which is missing in some cases?  I am ok with this doc for this release, in any case.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448723777/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448784775","html_url":"https://github.com/apache/iceberg/pull/6849#issuecomment-1448784775","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6849","id":1448784775,"node_id":"IC_kwDOCW7NX85WWrOH","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T19:54:46Z","updated_at":"2023-02-28T19:58:29Z","author_association":"CONTRIBUTOR","body":"> * compatibility.snapshot-id-inheritance.enabled\r\n\r\nThank you @szehon-ho , created https://github.com/apache/iceberg/issues/6961 as suggested, feel free to edit/update","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448784775/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448875939","html_url":"https://github.com/apache/iceberg/pull/6852#issuecomment-1448875939","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6852","id":1448875939,"node_id":"IC_kwDOCW7NX85WXBej","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T20:33:37Z","updated_at":"2023-02-28T20:33:37Z","author_association":"CONTRIBUTOR","body":"Thanks for the review @nastra, @ajantha-bhat, @singhpk234, and @jackye1995. Much appreciated.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448875939/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448931543","html_url":"https://github.com/apache/iceberg/issues/5801#issuecomment-1448931543","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5801","id":1448931543,"node_id":"IC_kwDOCW7NX85WXPDX","user":{"login":"ianmcook","id":280509,"node_id":"MDQ6VXNlcjI4MDUwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/280509?v=4","gravatar_id":"","url":"https://api.github.com/users/ianmcook","html_url":"https://github.com/ianmcook","followers_url":"https://api.github.com/users/ianmcook/followers","following_url":"https://api.github.com/users/ianmcook/following{/other_user}","gists_url":"https://api.github.com/users/ianmcook/gists{/gist_id}","starred_url":"https://api.github.com/users/ianmcook/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ianmcook/subscriptions","organizations_url":"https://api.github.com/users/ianmcook/orgs","repos_url":"https://api.github.com/users/ianmcook/repos","events_url":"https://api.github.com/users/ianmcook/events{/privacy}","received_events_url":"https://api.github.com/users/ianmcook/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T21:19:58Z","updated_at":"2023-02-28T21:19:58Z","author_association":"MEMBER","body":"Nit: the term _Dataset_ has a [specific meaning in PyArrow](https://arrow.apache.org/docs/python/dataset.html). It refers to a lazily read set of files on disk. As opposed to a _Table_ in PyArrow which is materialized in memory. I believe what has been implemented in #6233 is converting an Iceberg Table to a PyArrow _Table_.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448931543/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448936674","html_url":"https://github.com/apache/iceberg/issues/5801#issuecomment-1448936674","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5801","id":1448936674,"node_id":"IC_kwDOCW7NX85WXQTi","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T21:25:01Z","updated_at":"2023-02-28T21:25:01Z","author_association":"CONTRIBUTOR","body":"@ianmcook that is correct. If you have a petabyte Iceberg table, and you'll select a subset of the rows, only the relevant files are being read. This is directly read into a `pa.table`, and not a `pa.dataset`. If we want to make this truly lazy, the Iceberg primitives need to be implemented on the PyArrow side.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448936674/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448967538","html_url":"https://github.com/apache/iceberg/pull/6960#issuecomment-1448967538","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6960","id":1448967538,"node_id":"IC_kwDOCW7NX85WXX1y","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T21:47:29Z","updated_at":"2023-02-28T21:47:29Z","author_association":"CONTRIBUTOR","body":"Thanks, @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448967538/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448987284","html_url":"https://github.com/apache/iceberg/pull/6650#issuecomment-1448987284","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6650","id":1448987284,"node_id":"IC_kwDOCW7NX85WXcqU","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T22:05:51Z","updated_at":"2023-02-28T22:05:51Z","author_association":"CONTRIBUTOR","body":"@namrathamyske I updated based on Amogh's comment","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448987284/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448998300","html_url":"https://github.com/apache/iceberg/pull/6949#issuecomment-1448998300","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6949","id":1448998300,"node_id":"IC_kwDOCW7NX85WXfWc","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T22:16:33Z","updated_at":"2023-02-28T22:16:33Z","author_association":"CONTRIBUTOR","body":"I rebased , saw there were some new changes and test additions. No conflicts but want to make sure tests pass after rebasing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1448998300/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449083247","html_url":"https://github.com/apache/iceberg/pull/6954#issuecomment-1449083247","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6954","id":1449083247,"node_id":"IC_kwDOCW7NX85WX0Fv","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T23:28:47Z","updated_at":"2023-02-28T23:28:47Z","author_association":"CONTRIBUTOR","body":"thanks @chenjunjiedada for the contribution","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449083247/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449084543","html_url":"https://github.com/apache/iceberg/pull/6958#issuecomment-1449084543","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6958","id":1449084543,"node_id":"IC_kwDOCW7NX85WX0Z_","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T23:30:26Z","updated_at":"2023-02-28T23:30:26Z","author_association":"CONTRIBUTOR","body":"thanks @xuzhiwen1255 for the fix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449084543/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449094697","html_url":"https://github.com/apache/iceberg/pull/6949#issuecomment-1449094697","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6949","id":1449094697,"node_id":"IC_kwDOCW7NX85WX24p","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T23:43:54Z","updated_at":"2023-02-28T23:43:54Z","author_association":"CONTRIBUTOR","body":"thanks @amogh-jahagirdar for the backport","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449094697/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449097475","html_url":"https://github.com/apache/iceberg/pull/6513#issuecomment-1449097475","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6513","id":1449097475,"node_id":"IC_kwDOCW7NX85WX3kD","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-28T23:47:43Z","updated_at":"2023-02-28T23:47:43Z","author_association":"CONTRIBUTOR","body":"@fqaiser94 I added a comment to the issue regarding the motivation use cases: https://github.com/apache/iceberg/issues/6514#issuecomment-1444388008. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449097475/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449120296","html_url":"https://github.com/apache/iceberg/issues/5560#issuecomment-1449120296","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5560","id":1449120296,"node_id":"IC_kwDOCW7NX85WX9Io","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T00:14:29Z","updated_at":"2023-03-01T00:14:29Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449120296/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449120340","html_url":"https://github.com/apache/iceberg/issues/5556#issuecomment-1449120340","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5556","id":1449120340,"node_id":"IC_kwDOCW7NX85WX9JU","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T00:14:32Z","updated_at":"2023-03-01T00:14:32Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449120340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449153096","html_url":"https://github.com/apache/iceberg/issues/2208#issuecomment-1449153096","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2208","id":1449153096,"node_id":"IC_kwDOCW7NX85WYFJI","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T00:59:43Z","updated_at":"2023-03-01T01:01:41Z","author_association":"CONTRIBUTOR","body":"here is the difference btw Kaka sink and Iceberg sink. Kafka essentially takes in byte[] as payload. Hence it doesn't care about the schema. Iceberg sink has table schema when writing out data files. that is why it is difficult for a single Iceberg sink to write to multiple Iceberg tables with different schemas.\r\n\r\nOn the other hand, this ask has been brought up a few times. so there is demand for it. If we are going to support it, it will likely be a facade sink that can creates the individual writers internally (one writer for each table). We would also need the multi-table transaction capability from PR #6948 first so that we can commit data files for all tables in one transaction.\r\n\r\nThen there is another question on if the Iceberg table creation should be outside the scope of the Flink sink, which is the case today. maybe we should continue to operate with that assumption that table creation is out of band.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449153096/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449207472","html_url":"https://github.com/apache/iceberg/pull/6955#issuecomment-1449207472","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6955","id":1449207472,"node_id":"IC_kwDOCW7NX85WYSaw","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T02:04:43Z","updated_at":"2023-03-01T02:04:43Z","author_association":"MEMBER","body":"cc @pvary ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449207472/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449221447","html_url":"https://github.com/apache/iceberg/pull/6962#issuecomment-1449221447","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6962","id":1449221447,"node_id":"IC_kwDOCW7NX85WYV1H","user":{"login":"yabola","id":31469905,"node_id":"MDQ6VXNlcjMxNDY5OTA1","avatar_url":"https://avatars.githubusercontent.com/u/31469905?v=4","gravatar_id":"","url":"https://api.github.com/users/yabola","html_url":"https://github.com/yabola","followers_url":"https://api.github.com/users/yabola/followers","following_url":"https://api.github.com/users/yabola/following{/other_user}","gists_url":"https://api.github.com/users/yabola/gists{/gist_id}","starred_url":"https://api.github.com/users/yabola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yabola/subscriptions","organizations_url":"https://api.github.com/users/yabola/orgs","repos_url":"https://api.github.com/users/yabola/repos","events_url":"https://api.github.com/users/yabola/events{/privacy}","received_events_url":"https://api.github.com/users/yabola/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T02:18:31Z","updated_at":"2023-03-01T02:18:31Z","author_association":"CONTRIBUTOR","body":"@rdblue @aokolnychyi @gustavoatt If you have time, please take a look, thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449221447/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449242280","html_url":"https://github.com/apache/iceberg/issues/6964#issuecomment-1449242280","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6964","id":1449242280,"node_id":"IC_kwDOCW7NX85WYa6o","user":{"login":"BiuBiu2323","id":32856649,"node_id":"MDQ6VXNlcjMyODU2NjQ5","avatar_url":"https://avatars.githubusercontent.com/u/32856649?v=4","gravatar_id":"","url":"https://api.github.com/users/BiuBiu2323","html_url":"https://github.com/BiuBiu2323","followers_url":"https://api.github.com/users/BiuBiu2323/followers","following_url":"https://api.github.com/users/BiuBiu2323/following{/other_user}","gists_url":"https://api.github.com/users/BiuBiu2323/gists{/gist_id}","starred_url":"https://api.github.com/users/BiuBiu2323/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BiuBiu2323/subscriptions","organizations_url":"https://api.github.com/users/BiuBiu2323/orgs","repos_url":"https://api.github.com/users/BiuBiu2323/repos","events_url":"https://api.github.com/users/BiuBiu2323/events{/privacy}","received_events_url":"https://api.github.com/users/BiuBiu2323/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T02:34:57Z","updated_at":"2023-03-01T02:34:57Z","author_association":"NONE","body":"can i just load the parquet file from old table into new table?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449242280/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449274994","html_url":"https://github.com/apache/iceberg/pull/6651#issuecomment-1449274994","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6651","id":1449274994,"node_id":"IC_kwDOCW7NX85WYi5y","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T03:21:21Z","updated_at":"2023-03-01T03:22:46Z","author_association":"CONTRIBUTOR","body":"> To get this working in other situations, I think we should go back to the original idea of using the branch name in the table identifier, like catalog.db.table.branch. While that's not ideal for column references (by default columns would be branch.col rather than table.col) it is the most reliable solution for writes, reads, and dynamic pruning.\r\n\r\nWhat about using the exact same syntax we support for reads? I believe it would be `catalog.db.table.branch_{NAME}`?\r\n\r\ncc @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449274994/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449275575","html_url":"https://github.com/apache/iceberg/pull/6651#issuecomment-1449275575","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6651","id":1449275575,"node_id":"IC_kwDOCW7NX85WYjC3","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T03:22:21Z","updated_at":"2023-03-01T03:22:37Z","author_association":"CONTRIBUTOR","body":"> If there's no objections, I'll raise a separate PR since the approach and user experience is different than how the PR started. It also should make it easier to review for reviewers to avoid getting distracted by discussions which may no longer be relevant.\r\n\r\nI am a bit confused in terms of what PRs to review. Do we plan to migrate to table identifiers in this PR or separate?\r\n\r\ncc @amogh-jahagirdar","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449275575/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449360753","html_url":"https://github.com/apache/iceberg/pull/6929#issuecomment-1449360753","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6929","id":1449360753,"node_id":"IC_kwDOCW7NX85WY31x","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T05:11:40Z","updated_at":"2023-03-01T05:11:40Z","author_association":"CONTRIBUTOR","body":"Merging the change since we have enough votes, thanks for the contribution @hililiwei !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449360753/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449361669","html_url":"https://github.com/apache/iceberg/pull/6880#issuecomment-1449361669","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6880","id":1449361669,"node_id":"IC_kwDOCW7NX85WY4EF","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T05:12:48Z","updated_at":"2023-03-01T05:12:48Z","author_association":"CONTRIBUTOR","body":"Merging, thanks for the fix @JonasJ-ap , and thanks for the review @yyanyy and @amogh-jahagirdar !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449361669/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449363198","html_url":"https://github.com/apache/iceberg/pull/6651#issuecomment-1449363198","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6651","id":1449363198,"node_id":"IC_kwDOCW7NX85WY4b-","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T05:14:53Z","updated_at":"2023-03-01T06:55:41Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi I synced with Amogh offline, I will create a new PR for the new approach and will ping everyone here for review. It will be through the same syntax as read through table identifier.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449363198/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449386215","html_url":"https://github.com/apache/iceberg/issues/6956#issuecomment-1449386215","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6956","id":1449386215,"node_id":"IC_kwDOCW7NX85WY-Dn","user":{"login":"ldwnt","id":7655486,"node_id":"MDQ6VXNlcjc2NTU0ODY=","avatar_url":"https://avatars.githubusercontent.com/u/7655486?v=4","gravatar_id":"","url":"https://api.github.com/users/ldwnt","html_url":"https://github.com/ldwnt","followers_url":"https://api.github.com/users/ldwnt/followers","following_url":"https://api.github.com/users/ldwnt/following{/other_user}","gists_url":"https://api.github.com/users/ldwnt/gists{/gist_id}","starred_url":"https://api.github.com/users/ldwnt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ldwnt/subscriptions","organizations_url":"https://api.github.com/users/ldwnt/orgs","repos_url":"https://api.github.com/users/ldwnt/repos","events_url":"https://api.github.com/users/ldwnt/events{/privacy}","received_events_url":"https://api.github.com/users/ldwnt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T05:47:04Z","updated_at":"2023-03-01T05:47:04Z","author_association":"NONE","body":"> @ldwnt, if the upstream table is completely refreshed every day, then why use a stream to move the data over to analytic storage? Seems like using a one-time copy after the refresh makes more sense.\r\n> \r\n> I also think that, in general, directly updating an analytic table from Flink is a bad idea. It's usually much more efficient to write the changes directly into a table and periodically compact to materialize the latest table state.\r\n\r\nIt's possible to handle the completely refreshed tables in the way you metioned. The reason it's not is that I'm ingesting tables from 20 mysql dbs to iceberg and want to archieve the goal using the same set of flink applications.\r\n\r\nI change the spark executor memory from 3g to 4g and the rewriting finishes without oom. It seems the cause of the oom is the many delete records collected in memory. Also, the 1.4g used memory of executor displayed in spark UI is not accurate.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449386215/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449393872","html_url":"https://github.com/apache/iceberg/issues/2208#issuecomment-1449393872","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2208","id":1449393872,"node_id":"IC_kwDOCW7NX85WY_7Q","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T05:57:41Z","updated_at":"2023-03-01T05:57:41Z","author_association":"CONTRIBUTOR","body":"[better shuffling support](https://github.com/apache/iceberg/issues/6303) is another necessary building block for implement this multi-table sink. this is to avoid every writer task have to write to every Iceberg table, which could cause small files problem.\r\n\r\nOnce the multi-table transaction and the shuffling support are in place. I think we can probably come back on this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449393872/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449418876","html_url":"https://github.com/apache/iceberg/pull/6614#issuecomment-1449418876","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6614","id":1449418876,"node_id":"IC_kwDOCW7NX85WZGB8","user":{"login":"xuzhiwen1255","id":105710753,"node_id":"U_kgDOBk0EoQ","avatar_url":"https://avatars.githubusercontent.com/u/105710753?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzhiwen1255","html_url":"https://github.com/xuzhiwen1255","followers_url":"https://api.github.com/users/xuzhiwen1255/followers","following_url":"https://api.github.com/users/xuzhiwen1255/following{/other_user}","gists_url":"https://api.github.com/users/xuzhiwen1255/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzhiwen1255/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzhiwen1255/subscriptions","organizations_url":"https://api.github.com/users/xuzhiwen1255/orgs","repos_url":"https://api.github.com/users/xuzhiwen1255/repos","events_url":"https://api.github.com/users/xuzhiwen1255/events{/privacy}","received_events_url":"https://api.github.com/users/xuzhiwen1255/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T06:20:09Z","updated_at":"2023-03-01T06:20:09Z","author_association":"CONTRIBUTOR","body":"@stevenzwu  It has been modified, please check it, thank you.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449418876/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449434428","html_url":"https://github.com/apache/iceberg/pull/6650#issuecomment-1449434428","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6650","id":1449434428,"node_id":"IC_kwDOCW7NX85WZJ08","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T06:39:18Z","updated_at":"2023-03-01T06:39:18Z","author_association":"CONTRIBUTOR","body":"Merging since all comments are addressed, thanks for the review @yyanyy and @amogh-jahagirdar!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449434428/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449457419","html_url":"https://github.com/apache/iceberg/pull/6929#issuecomment-1449457419","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6929","id":1449457419,"node_id":"IC_kwDOCW7NX85WZPcL","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T07:04:28Z","updated_at":"2023-03-01T07:04:28Z","author_association":"CONTRIBUTOR","body":"Thanks @jackye1995 @yyanyy ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449457419/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449482274","html_url":"https://github.com/apache/iceberg/issues/6966#issuecomment-1449482274","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6966","id":1449482274,"node_id":"IC_kwDOCW7NX85WZVgi","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T07:29:42Z","updated_at":"2023-03-01T07:29:42Z","author_association":"CONTRIBUTOR","body":"@amogh-jahagirdar can you take this and fix before 1.2 release? If not I will take it","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449482274/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449486734","html_url":"https://github.com/apache/iceberg/pull/6887#issuecomment-1449486734","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6887","id":1449486734,"node_id":"IC_kwDOCW7NX85WZWmO","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T07:34:32Z","updated_at":"2023-03-01T07:34:32Z","author_association":"CONTRIBUTOR","body":"Sorry I'm quite late to the discussion around deprecating `RuntimeIOException`, but I was wondering whether we could get by without having to introduce `FileHandlingException`? \r\nHow critical is it to have a special `RuntimeException` class to indicate that something went wrong, or could we make things work by directly using `RuntimeException`?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449486734/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449489814","html_url":"https://github.com/apache/iceberg/pull/6887#issuecomment-1449489814","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6887","id":1449489814,"node_id":"IC_kwDOCW7NX85WZXWW","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T07:37:57Z","updated_at":"2023-03-01T07:42:59Z","author_association":"MEMBER","body":"> How critical is it to have a special RuntimeException class to indicate that something went wrong, or could we make things work by directly using RuntimeException?\r\n\r\nI think Iceberg follows a style of wrapping the `RuntimeException` with a class to indicate that Iceberg is aware of this exception. So, I followed the same style. \r\n\r\nIn the original PR #4776, @rdblue also suggested using some other exception than `IOException`. So, I  assumed it is `RuntimeException` and wrapped it.\r\n\r\nBeing said that I am ok to directly use `RuntimeException` if people agrees to it.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449489814/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449492777","html_url":"https://github.com/apache/iceberg/pull/6967#issuecomment-1449492777","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6967","id":1449492777,"node_id":"IC_kwDOCW7NX85WZYEp","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T07:40:38Z","updated_at":"2023-03-01T07:40:38Z","author_association":"CONTRIBUTOR","body":"@rdblue @Fokko Can you help to review this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449492777/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449496140","html_url":"https://github.com/apache/iceberg/pull/6965#issuecomment-1449496140","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6965","id":1449496140,"node_id":"IC_kwDOCW7NX85WZY5M","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T07:44:10Z","updated_at":"2023-03-01T07:44:10Z","author_association":"CONTRIBUTOR","body":"@amogh-jahagirdar @namrathamyske @rdblue @aokolnychyi \r\n\r\nI am still adding all the tests, but want to first publish the impl if there is any early feedback.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449496140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449500715","html_url":"https://github.com/apache/iceberg/pull/6938#issuecomment-1449500715","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6938","id":1449500715,"node_id":"IC_kwDOCW7NX85WZaAr","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T07:49:04Z","updated_at":"2023-03-01T07:49:04Z","author_association":"CONTRIBUTOR","body":"LGTM, thanks @dependabot! And @ajantha-bhat, @nastra and @singhpk234 for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449500715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449501779","html_url":"https://github.com/apache/iceberg/pull/6813#issuecomment-1449501779","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6813","id":1449501779,"node_id":"IC_kwDOCW7NX85WZaRT","user":{"login":"dependabot[bot]","id":49699333,"node_id":"MDM6Qm90NDk2OTkzMzM=","avatar_url":"https://avatars.githubusercontent.com/in/29110?v=4","gravatar_id":"","url":"https://api.github.com/users/dependabot%5Bbot%5D","html_url":"https://github.com/apps/dependabot","followers_url":"https://api.github.com/users/dependabot%5Bbot%5D/followers","following_url":"https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dependabot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/dependabot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/dependabot%5Bbot%5D/repos","events_url":"https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/dependabot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T07:50:01Z","updated_at":"2023-03-01T07:50:01Z","author_association":"CONTRIBUTOR","body":"Superseded by #6969.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449501779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449503883","html_url":"https://github.com/apache/iceberg/pull/6920#issuecomment-1449503883","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6920","id":1449503883,"node_id":"IC_kwDOCW7NX85WZayL","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T07:52:05Z","updated_at":"2023-03-01T07:52:05Z","author_association":"CONTRIBUTOR","body":"Sure @agnes-xinyi-lu, just wanted to give other a bit of time to also look at this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449503883/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449699304","html_url":"https://github.com/apache/iceberg/pull/6936#issuecomment-1449699304","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6936","id":1449699304,"node_id":"IC_kwDOCW7NX85WaKfo","user":{"login":"wangyinsheng","id":13392313,"node_id":"MDQ6VXNlcjEzMzkyMzEz","avatar_url":"https://avatars.githubusercontent.com/u/13392313?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyinsheng","html_url":"https://github.com/wangyinsheng","followers_url":"https://api.github.com/users/wangyinsheng/followers","following_url":"https://api.github.com/users/wangyinsheng/following{/other_user}","gists_url":"https://api.github.com/users/wangyinsheng/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyinsheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyinsheng/subscriptions","organizations_url":"https://api.github.com/users/wangyinsheng/orgs","repos_url":"https://api.github.com/users/wangyinsheng/repos","events_url":"https://api.github.com/users/wangyinsheng/events{/privacy}","received_events_url":"https://api.github.com/users/wangyinsheng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T09:36:20Z","updated_at":"2023-03-01T09:36:20Z","author_association":"CONTRIBUTOR","body":"@stevenzwu PTAL","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1449699304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450109465","html_url":"https://github.com/apache/iceberg/pull/6970#issuecomment-1450109465","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6970","id":1450109465,"node_id":"IC_kwDOCW7NX85WbuoZ","user":{"login":"cccs-eric","id":56447460,"node_id":"MDQ6VXNlcjU2NDQ3NDYw","avatar_url":"https://avatars.githubusercontent.com/u/56447460?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-eric","html_url":"https://github.com/cccs-eric","followers_url":"https://api.github.com/users/cccs-eric/followers","following_url":"https://api.github.com/users/cccs-eric/following{/other_user}","gists_url":"https://api.github.com/users/cccs-eric/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-eric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-eric/subscriptions","organizations_url":"https://api.github.com/users/cccs-eric/orgs","repos_url":"https://api.github.com/users/cccs-eric/repos","events_url":"https://api.github.com/users/cccs-eric/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-eric/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T12:56:49Z","updated_at":"2023-03-01T12:56:49Z","author_association":"CONTRIBUTOR","body":"Thanks for pointing this out @Fokko .  IMHO, if we are going to list `connection-string` as an ADLS options in Iceberg's documentation, maybe we should add some more details about it.  There is a catch with this one since it will overwrite other values like `account-name` (see https://github.com/fsspec/adlfs/blob/f15c37a43afd87a04f01b61cd90294dd57181e1d/adlfs/spec.py#L350-L354).  So a user could be mislead by configuring both `connection-string` and `account-name` with different values.  If I'm right, conftest.py could be changed to only configure `connection-string`.  Not sure if we should copy AzureBlobFileSystem's doc over here, or simply link to it.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450109465/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450175761","html_url":"https://github.com/apache/iceberg/issues/6904#issuecomment-1450175761","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6904","id":1450175761,"node_id":"IC_kwDOCW7NX85Wb-0R","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T13:44:48Z","updated_at":"2023-03-01T13:44:48Z","author_association":"MEMBER","body":"I did and 👍 'd @nastra 's comment as accurate and answering the question","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450175761/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450201196","html_url":"https://github.com/apache/iceberg/issues/6904#issuecomment-1450201196","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6904","id":1450201196,"node_id":"IC_kwDOCW7NX85WcFBs","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T14:02:05Z","updated_at":"2023-03-01T14:02:05Z","author_association":"CONTRIBUTOR","body":"Closing this as resolved, @lexluo09 feel free to re-open if necessary.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450201196/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450299741","html_url":"https://github.com/apache/iceberg/pull/6975#issuecomment-1450299741","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6975","id":1450299741,"node_id":"IC_kwDOCW7NX85WcdFd","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T15:03:46Z","updated_at":"2023-03-01T15:03:46Z","author_association":"MEMBER","body":"cc: @szehon-ho, @aokolnychyi, @RussellSpitzer, @jackye1995    ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450299741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450306142","html_url":"https://github.com/apache/iceberg/pull/6661#issuecomment-1450306142","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6661","id":1450306142,"node_id":"IC_kwDOCW7NX85Wcepe","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T15:07:27Z","updated_at":"2023-03-01T15:08:06Z","author_association":"MEMBER","body":"@szehon-ho:  \r\na) I have addressed the duplicate delete file problem using `HashSet` instead of `PositionDeletesScan` because we don't have a similar logic for equality deletes and code looks odd. Maybe later we can replace the logic as it is internal logic.\r\n\r\nb) I have derived the refactoring work of this PR into a separate one #6975 to reduce the review effort on this PR (we need to merge that first)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450306142/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450318988","html_url":"https://github.com/apache/iceberg/issues/6966#issuecomment-1450318988","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6966","id":1450318988,"node_id":"IC_kwDOCW7NX85WchyM","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T15:15:10Z","updated_at":"2023-03-01T15:15:10Z","author_association":"CONTRIBUTOR","body":"@jackye1995 sure I will fix this before 1.2.0 release, feel free to assign to me! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450318988/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450422397","html_url":"https://github.com/apache/iceberg/pull/6976#issuecomment-1450422397","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6976","id":1450422397,"node_id":"IC_kwDOCW7NX85Wc7B9","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T16:16:10Z","updated_at":"2023-03-01T16:16:10Z","author_association":"CONTRIBUTOR","body":"@nastra @rdblue could you take a quick look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450422397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450682749","html_url":"https://github.com/apache/iceberg/issues/6978#issuecomment-1450682749","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6978","id":1450682749,"node_id":"IC_kwDOCW7NX85Wd6l9","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T18:47:03Z","updated_at":"2023-03-01T18:48:06Z","author_association":"COLLABORATOR","body":"Interesting, this sounds like a serious bug.  \r\n\r\nBut I tried to reproduce this in latest master, but following test passed for me (add to TestMetadataTables):\r\n\r\n```\r\n  @Test\r\n  public void testFilesVersionAsOf() throws Exception {\r\n    // Create table and insert data\r\n    sql(\r\n        \"CREATE TABLE %s (id bigint, data string) \"\r\n            + \"USING iceberg \"\r\n            + \"PARTITIONED BY (data) \"\r\n            + \"TBLPROPERTIES\"\r\n            + \"('format-version'='2', 'write.delete.mode'='merge-on-read')\",\r\n        tableName);\r\n\r\n    List<SimpleRecord> recordsA =\r\n        Lists.newArrayList(new SimpleRecord(1, \"a\"), new SimpleRecord(2, \"a\"));\r\n    spark\r\n        .createDataset(recordsA, Encoders.bean(SimpleRecord.class))\r\n        .coalesce(1)\r\n        .writeTo(tableName)\r\n        .append();\r\n\r\n    Table table = Spark3Util.loadIcebergTable(spark, tableName);\r\n    Long currentSnapshotId = table.currentSnapshot().snapshotId();\r\n\r\n    List<SimpleRecord> recordsB =\r\n        Lists.newArrayList(new SimpleRecord(1, \"b\"), new SimpleRecord(2, \"b\"));\r\n    spark\r\n        .createDataset(recordsB, Encoders.bean(SimpleRecord.class))\r\n        .coalesce(1)\r\n        .writeTo(tableName)\r\n        .append();\r\n\r\n\r\n    List<Object[]> res1 = sql(\"SELECT * from %s.files VERSION AS OF %s\", tableName, currentSnapshotId);\r\n\r\n    Dataset<Row> ds = spark.read().format(\"iceberg\").option(\"snapshot-id\", currentSnapshotId).load(tableName + \".files\");\r\n    List<Row> res2 = ds.collectAsList();\r\n\r\n  }\r\n```\r\n\r\nNot sure what I'm missing here","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450682749/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450692373","html_url":"https://github.com/apache/iceberg/pull/6976#issuecomment-1450692373","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6976","id":1450692373,"node_id":"IC_kwDOCW7NX85Wd88V","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T18:55:39Z","updated_at":"2023-03-01T18:55:39Z","author_association":"CONTRIBUTOR","body":"Given the fact that this is blocking 1.2 release, and we already had consensus in the community sync, I will go ahead to merge this PR. Thanks for the review @nastra and @ajantha-bhat !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450692373/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450799205","html_url":"https://github.com/apache/iceberg/pull/6091#issuecomment-1450799205","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6091","id":1450799205,"node_id":"IC_kwDOCW7NX85WeXBl","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T20:24:08Z","updated_at":"2023-03-01T20:24:08Z","author_association":"CONTRIBUTOR","body":"@szehon-ho @flyrain @aokolnychyi @RussellSpitzer can any one of you take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450799205/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450799483","html_url":"https://github.com/apache/iceberg/issues/2468#issuecomment-1450799483","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2468","id":1450799483,"node_id":"IC_kwDOCW7NX85WeXF7","user":{"login":"MarquisC","id":73242797,"node_id":"MDQ6VXNlcjczMjQyNzk3","avatar_url":"https://avatars.githubusercontent.com/u/73242797?v=4","gravatar_id":"","url":"https://api.github.com/users/MarquisC","html_url":"https://github.com/MarquisC","followers_url":"https://api.github.com/users/MarquisC/followers","following_url":"https://api.github.com/users/MarquisC/following{/other_user}","gists_url":"https://api.github.com/users/MarquisC/gists{/gist_id}","starred_url":"https://api.github.com/users/MarquisC/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MarquisC/subscriptions","organizations_url":"https://api.github.com/users/MarquisC/orgs","repos_url":"https://api.github.com/users/MarquisC/repos","events_url":"https://api.github.com/users/MarquisC/events{/privacy}","received_events_url":"https://api.github.com/users/MarquisC/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T20:24:24Z","updated_at":"2023-03-01T20:28:57Z","author_association":"NONE","body":"@leichangqing thank you for specifically haha:\r\n```\r\nI think that flink default jar have conflict with -j.\r\n```\r\nI'm testing through a brew install of flink and I dropped the dependent jars under:\r\n```\r\n/usr/local/Cellar/apache-flink/1.16.1/libexec/lib/\r\n```\r\nAnd it's good so far.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450799483/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450880716","html_url":"https://github.com/apache/iceberg/issues/6978#issuecomment-1450880716","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6978","id":1450880716,"node_id":"IC_kwDOCW7NX85Weq7M","user":{"login":"sungwy","id":107272191,"node_id":"U_kgDOBmTX_w","avatar_url":"https://avatars.githubusercontent.com/u/107272191?v=4","gravatar_id":"","url":"https://api.github.com/users/sungwy","html_url":"https://github.com/sungwy","followers_url":"https://api.github.com/users/sungwy/followers","following_url":"https://api.github.com/users/sungwy/following{/other_user}","gists_url":"https://api.github.com/users/sungwy/gists{/gist_id}","starred_url":"https://api.github.com/users/sungwy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sungwy/subscriptions","organizations_url":"https://api.github.com/users/sungwy/orgs","repos_url":"https://api.github.com/users/sungwy/repos","events_url":"https://api.github.com/users/sungwy/events{/privacy}","received_events_url":"https://api.github.com/users/sungwy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T21:37:14Z","updated_at":"2023-03-01T21:37:25Z","author_association":"CONTRIBUTOR","body":"@szehon-ho  This issue only happens if the schema of the table is updated (not the metadata table, but its corresponding iceberg table).\r\nIn the following example, I'm adding a new column to the existing table to invoke a schema update - i.e. there are now a total of 2 schemas (for the iceberg table) in the snapshot metadata.json file:\r\n\r\n(SimpleExtraColumnRecord is a SimpleRecord with just one extra string column)\r\n```\r\n  @Test\r\n  public void testFilesVersionAsOf() throws Exception {\r\n    // Create table and insert data\r\n    sql(\r\n            \"CREATE TABLE %s (id bigint, data string) \"\r\n                    + \"USING iceberg \"\r\n                    + \"PARTITIONED BY (data) \"\r\n                    + \"TBLPROPERTIES\"\r\n                    + \"('format-version'='2', 'write.delete.mode'='merge-on-read')\",\r\n            tableName);\r\n\r\n    List<SimpleRecord> recordsA =\r\n            Lists.newArrayList(new SimpleRecord(1, \"a\"), new SimpleRecord(2, \"a\"));\r\n    spark\r\n            .createDataset(recordsA, Encoders.bean(SimpleRecord.class))\r\n            .coalesce(1)\r\n            .writeTo(tableName)\r\n            .append();\r\n\r\n    Table table = Spark3Util.loadIcebergTable(spark, tableName);\r\n    Long olderSnapshotId = table.currentSnapshot().snapshotId();\r\n\r\n    sql(\r\n            \"ALTER TABLE %s ADD COLUMNS (data2 string)\",\r\n            tableName);\r\n\r\n    List<SimpleExtraColumnRecord> recordsB =\r\n            Lists.newArrayList(new SimpleExtraColumnRecord(1, \"b\", \"c\"), new SimpleExtraColumnRecord (2, \"b\", \"c\"));\r\n    spark\r\n            .createDataset(recordsB, Encoders.bean(SimpleExtraColumnRecord.class))\r\n            .coalesce(1)\r\n            .writeTo(tableName)\r\n            .append();\r\n\r\n\r\n    List<Object[]> res1 = sql(\"SELECT * from %s.files VERSION AS OF %s\", tableName, olderSnapshotId );\r\n\r\n    Dataset<Row> ds = spark.read().format(\"iceberg\").option(\"snapshot-id\", olderSnapshotId ).load(tableName + \".files\");\r\n    List<Row> res2 = ds.collectAsList();\r\n\r\n    Long currentSnapshotId = table.currentSnapshot().snapshotId();\r\n\r\n    List<Object[]> res3 = sql(\"SELECT * from %s.files VERSION AS OF %s\", tableName, currentSnapshotId);\r\n\r\n    Dataset<Row> ds2 = spark.read().format(\"iceberg\").option(\"snapshot-id\", currentSnapshotId ).load(tableName + \".files\");\r\n    List<Row> res4 = ds2.collectAsList();\r\n  }\r\n```\r\n\r\nThis test fails on this call:\r\n`List<Object[]> res3 = sql(\"SELECT * from %s.files VERSION AS OF %s\", tableName, currentSnapshotId);`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450880716/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450898243","html_url":"https://github.com/apache/iceberg/issues/6978#issuecomment-1450898243","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6978","id":1450898243,"node_id":"IC_kwDOCW7NX85WevND","user":{"login":"sungwy","id":107272191,"node_id":"U_kgDOBmTX_w","avatar_url":"https://avatars.githubusercontent.com/u/107272191?v=4","gravatar_id":"","url":"https://api.github.com/users/sungwy","html_url":"https://github.com/sungwy","followers_url":"https://api.github.com/users/sungwy/followers","following_url":"https://api.github.com/users/sungwy/following{/other_user}","gists_url":"https://api.github.com/users/sungwy/gists{/gist_id}","starred_url":"https://api.github.com/users/sungwy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sungwy/subscriptions","organizations_url":"https://api.github.com/users/sungwy/orgs","repos_url":"https://api.github.com/users/sungwy/repos","events_url":"https://api.github.com/users/sungwy/events{/privacy}","received_events_url":"https://api.github.com/users/sungwy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T21:52:43Z","updated_at":"2023-03-01T21:52:43Z","author_association":"CONTRIBUTOR","body":"Adding these conditions to these two locations in SparkTable.java fixes the issue:\r\n\r\nhttps://github.com/apache/iceberg/blob/master/spark/v3.1/spark/src/main/java/org/apache/iceberg/spark/source/SparkTable.java#L201\r\n```\r\n  @Override\r\n  public ScanBuilder newScanBuilder(CaseInsensitiveStringMap options) {\r\n    if (options.containsKey(SparkReadOptions.FILE_SCAN_TASK_SET_ID)) {\r\n      // skip planning the job and fetch already staged file scan tasks\r\n      return new SparkFilesScanBuilder(sparkSession(), icebergTable, options);\r\n    }\r\n\r\n    if (refreshEagerly) {\r\n      icebergTable.refresh();\r\n    }\r\n\r\n    CaseInsensitiveStringMap scanOptions = addSnapshotId(options, snapshotId);\r\n    if (icebergTable instanceof BaseMetadataTable) {\r\n      return new SparkScanBuilder(sparkSession(), icebergTable, options);\r\n    } else {\r\n      return new SparkScanBuilder(sparkSession(), icebergTable, snapshotSchema(), scanOptions);\r\n    }\r\n  }\r\n```\r\nhttps://github.com/apache/iceberg/blob/master/spark/v3.1/spark/src/main/java/org/apache/iceberg/spark/source/SparkTable.java#L133\r\n\r\n\r\n```\r\n  @Override\r\n  public StructType schema() {\r\n    if (lazyTableSchema == null) {\r\n      if (icebergTable instanceof BaseMetadataTable) {\r\n        this.lazyTableSchema = SparkSchemaUtil.convert(icebergTable.schema());\r\n      } else {\r\n        this.lazyTableSchema = SparkSchemaUtil.convert(snapshotSchema());\r\n      }\r\n    }\r\n\r\n    return lazyTableSchema;\r\n  }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450898243/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450979122","html_url":"https://github.com/apache/iceberg/issues/6978#issuecomment-1450979122","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6978","id":1450979122,"node_id":"IC_kwDOCW7NX85WfC8y","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T22:58:12Z","updated_at":"2023-03-01T22:59:56Z","author_association":"COLLABORATOR","body":"Got it, missed that part, need time to look at that.  Feel free to open a pr, and add the test case repro.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450979122/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450987559","html_url":"https://github.com/apache/iceberg/issues/6978#issuecomment-1450987559","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6978","id":1450987559,"node_id":"IC_kwDOCW7NX85WfFAn","user":{"login":"sungwy","id":107272191,"node_id":"U_kgDOBmTX_w","avatar_url":"https://avatars.githubusercontent.com/u/107272191?v=4","gravatar_id":"","url":"https://api.github.com/users/sungwy","html_url":"https://github.com/sungwy","followers_url":"https://api.github.com/users/sungwy/followers","following_url":"https://api.github.com/users/sungwy/following{/other_user}","gists_url":"https://api.github.com/users/sungwy/gists{/gist_id}","starred_url":"https://api.github.com/users/sungwy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sungwy/subscriptions","organizations_url":"https://api.github.com/users/sungwy/orgs","repos_url":"https://api.github.com/users/sungwy/repos","events_url":"https://api.github.com/users/sungwy/events{/privacy}","received_events_url":"https://api.github.com/users/sungwy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-01T23:03:28Z","updated_at":"2023-03-02T01:10:08Z","author_association":"CONTRIBUTOR","body":"Thank you @szehon-ho !\r\nI opened one up for Spark-3.3. The issue is in Spark 3.2 and 3.1 as well and has been around since Iceberg 0.13.0 release...\r\n\r\nHappy to open up separate PRs for Spark-3.2 and Spark-3.1 (not sure if putting them all in the same PR or separately is better for cherry-picking for a release)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1450987559/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451076449","html_url":"https://github.com/apache/iceberg/issues/5692#issuecomment-1451076449","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5692","id":1451076449,"node_id":"IC_kwDOCW7NX85Wfath","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T00:13:24Z","updated_at":"2023-03-02T00:13:24Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1451076449/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]