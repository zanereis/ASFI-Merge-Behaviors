[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581387647","html_url":"https://github.com/apache/iceberg/issues/760#issuecomment-581387647","issue_url":"https://api.github.com/repos/apache/iceberg/issues/760","id":581387647,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTM4NzY0Nw==","user":{"login":"arina-ielchiieva","id":15086720,"node_id":"MDQ6VXNlcjE1MDg2NzIw","avatar_url":"https://avatars.githubusercontent.com/u/15086720?v=4","gravatar_id":"","url":"https://api.github.com/users/arina-ielchiieva","html_url":"https://github.com/arina-ielchiieva","followers_url":"https://api.github.com/users/arina-ielchiieva/followers","following_url":"https://api.github.com/users/arina-ielchiieva/following{/other_user}","gists_url":"https://api.github.com/users/arina-ielchiieva/gists{/gist_id}","starred_url":"https://api.github.com/users/arina-ielchiieva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arina-ielchiieva/subscriptions","organizations_url":"https://api.github.com/users/arina-ielchiieva/orgs","repos_url":"https://api.github.com/users/arina-ielchiieva/repos","events_url":"https://api.github.com/users/arina-ielchiieva/events{/privacy}","received_events_url":"https://api.github.com/users/arina-ielchiieva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-03T12:19:03Z","updated_at":"2020-02-03T12:19:03Z","author_association":"MEMBER","body":"@jun-he thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581387647/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581520368","html_url":"https://github.com/apache/iceberg/pull/768#issuecomment-581520368","issue_url":"https://api.github.com/repos/apache/iceberg/issues/768","id":581520368,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTUyMDM2OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-03T17:16:08Z","updated_at":"2020-02-03T17:16:08Z","author_association":"CONTRIBUTOR","body":"Mostly looks good, but I don't understand the motivation for the new test case.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581520368/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581521200","html_url":"https://github.com/apache/iceberg/pull/743#issuecomment-581521200","issue_url":"https://api.github.com/repos/apache/iceberg/issues/743","id":581521200,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTUyMTIwMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-03T17:17:51Z","updated_at":"2020-02-03T17:17:51Z","author_association":"CONTRIBUTOR","body":"Looks good! Thanks for working on this @yujiantao!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581521200/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581543316","html_url":"https://github.com/apache/iceberg/issues/764#issuecomment-581543316","issue_url":"https://api.github.com/repos/apache/iceberg/issues/764","id":581543316,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTU0MzMxNg==","user":{"login":"sudssf","id":10800873,"node_id":"MDQ6VXNlcjEwODAwODcz","avatar_url":"https://avatars.githubusercontent.com/u/10800873?v=4","gravatar_id":"","url":"https://api.github.com/users/sudssf","html_url":"https://github.com/sudssf","followers_url":"https://api.github.com/users/sudssf/followers","following_url":"https://api.github.com/users/sudssf/following{/other_user}","gists_url":"https://api.github.com/users/sudssf/gists{/gist_id}","starred_url":"https://api.github.com/users/sudssf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sudssf/subscriptions","organizations_url":"https://api.github.com/users/sudssf/orgs","repos_url":"https://api.github.com/users/sudssf/repos","events_url":"https://api.github.com/users/sudssf/events{/privacy}","received_events_url":"https://api.github.com/users/sudssf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-03T18:10:01Z","updated_at":"2020-02-03T18:10:01Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue  for reply. in one of our ingestion flow, we are writing files directly to iceberg table using java API. when we build location string and datafiles I am not sure how to pass partition information using `StructLike` as its interface.\r\n\r\nfor now I am using following API when creating data files\r\n` new DataFiles.Builder(table.spec).withPartition(partLike)`\r\n\r\nthere is helper method which returns PartitionData\r\n```\r\ndef getPartitionData(spec: PartitionSpec, par : String) : PartitionData = {\r\n    val partition = new PartitionData(spec.partitionType())\r\n    partition.set(0, par)\r\n    partition\r\n  }\r\n```\r\n\r\ncan you point me to example where we can use `StructLike` directly?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581543316/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581593929","html_url":"https://github.com/apache/iceberg/issues/764#issuecomment-581593929","issue_url":"https://api.github.com/repos/apache/iceberg/issues/764","id":581593929,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTU5MzkyOQ==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-03T20:06:21Z","updated_at":"2020-02-03T20:06:21Z","author_association":"CONTRIBUTOR","body":"@sudssf you should be able to implement `StructLike`  e.g\r\n```\r\n return new StructLike() {\r\n      @Override\r\n      public int size() {\r\n        return // return number of your partition columns\r\n      }\r\n\r\n      @Override\r\n      public <T> T get(int pos, Class<T> javaClass) {\r\n        // At this point you should have all partition column values. You may return the one based on `pos`;\r\n      }\r\n\r\n      @Override\r\n      public <T> void set(int pos, T value) {\r\n         // maybe just throw?\r\n        throw new UnsupportedOperationException(\"Set not supported\");\r\n      }\r\n    };\r\n```\r\n\r\nWhat's your concern?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581593929/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581615179","html_url":"https://github.com/apache/iceberg/issues/764#issuecomment-581615179","issue_url":"https://api.github.com/repos/apache/iceberg/issues/764","id":581615179,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTYxNTE3OQ==","user":{"login":"sudssf","id":10800873,"node_id":"MDQ6VXNlcjEwODAwODcz","avatar_url":"https://avatars.githubusercontent.com/u/10800873?v=4","gravatar_id":"","url":"https://api.github.com/users/sudssf","html_url":"https://github.com/sudssf","followers_url":"https://api.github.com/users/sudssf/followers","following_url":"https://api.github.com/users/sudssf/following{/other_user}","gists_url":"https://api.github.com/users/sudssf/gists{/gist_id}","starred_url":"https://api.github.com/users/sudssf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sudssf/subscriptions","organizations_url":"https://api.github.com/users/sudssf/orgs","repos_url":"https://api.github.com/users/sudssf/repos","events_url":"https://api.github.com/users/sudssf/events{/privacy}","received_events_url":"https://api.github.com/users/sudssf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-03T20:58:42Z","updated_at":"2020-02-03T20:58:51Z","author_association":"CONTRIBUTOR","body":"@rdsr yes interface can be implemented, which code would you prefer implementing `StructLike` or  reusing boilerplate from `PartitionData`?\r\nalso partition logic is much cleaner using `PartitionSpec`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581615179/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581618827","html_url":"https://github.com/apache/iceberg/issues/764#issuecomment-581618827","issue_url":"https://api.github.com/repos/apache/iceberg/issues/764","id":581618827,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTYxODgyNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-03T21:08:02Z","updated_at":"2020-02-03T21:08:02Z","author_association":"CONTRIBUTOR","body":"We don't want to open up `PartitionData` because it includes quite a bit that we don't want to make part of our public API. For example, it implements Avro's `IndexedRecord` API that we may not support indefinitely. The guarantee we provide is `StructLike`.\r\n\r\nBut, you should be able to use [`GenericRecord`](https://github.com/apache/incubator-iceberg/blob/master/data/src/main/java/org/apache/iceberg/data/GenericRecord.java) with `PartitionSpec.partitionType()` to get a `StructLike` that works for you without implementing that interface directly. Of course, you're welcome to implement that interface if you'd like more control over the implementation.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581618827/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581646436","html_url":"https://github.com/apache/iceberg/issues/764#issuecomment-581646436","issue_url":"https://api.github.com/repos/apache/iceberg/issues/764","id":581646436,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTY0NjQzNg==","user":{"login":"sudssf","id":10800873,"node_id":"MDQ6VXNlcjEwODAwODcz","avatar_url":"https://avatars.githubusercontent.com/u/10800873?v=4","gravatar_id":"","url":"https://api.github.com/users/sudssf","html_url":"https://github.com/sudssf","followers_url":"https://api.github.com/users/sudssf/followers","following_url":"https://api.github.com/users/sudssf/following{/other_user}","gists_url":"https://api.github.com/users/sudssf/gists{/gist_id}","starred_url":"https://api.github.com/users/sudssf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sudssf/subscriptions","organizations_url":"https://api.github.com/users/sudssf/orgs","repos_url":"https://api.github.com/users/sudssf/repos","events_url":"https://api.github.com/users/sudssf/events{/privacy}","received_events_url":"https://api.github.com/users/sudssf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-03T22:18:40Z","updated_at":"2020-02-03T22:18:40Z","author_association":"CONTRIBUTOR","body":"thanks @rdblue  I test using `GenericRecord `","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581646436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581657736","html_url":"https://github.com/apache/iceberg/pull/675#issuecomment-581657736","issue_url":"https://api.github.com/repos/apache/iceberg/issues/675","id":581657736,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTY1NzczNg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-03T22:51:59Z","updated_at":"2020-02-03T22:51:59Z","author_association":"CONTRIBUTOR","body":"I am going to merge this one.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581657736/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581658549","html_url":"https://github.com/apache/iceberg/pull/675#issuecomment-581658549","issue_url":"https://api.github.com/repos/apache/iceberg/issues/675","id":581658549,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTY1ODU0OQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-03T22:54:11Z","updated_at":"2020-02-03T22:54:11Z","author_association":"CONTRIBUTOR","body":"Thanks for the review, @rdblue and @chenjunjiedada!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581658549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581659155","html_url":"https://github.com/apache/iceberg/pull/675#issuecomment-581659155","issue_url":"https://api.github.com/repos/apache/iceberg/issues/675","id":581659155,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTY1OTE1NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-03T22:55:52Z","updated_at":"2020-02-03T22:55:52Z","author_association":"CONTRIBUTOR","body":"Thank you for building the framework for inheritance! This is really helpful.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581659155/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581663812","html_url":"https://github.com/apache/iceberg/issues/773#issuecomment-581663812","issue_url":"https://api.github.com/repos/apache/iceberg/issues/773","id":581663812,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTY2MzgxMg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-03T23:10:02Z","updated_at":"2020-02-03T23:10:02Z","author_association":"CONTRIBUTOR","body":"The first such change is snapshot id inheritance done in #675.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581663812/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581673351","html_url":"https://github.com/apache/iceberg/pull/695#issuecomment-581673351","issue_url":"https://api.github.com/repos/apache/iceberg/issues/695","id":581673351,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTY3MzM1MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-03T23:42:55Z","updated_at":"2020-02-03T23:42:55Z","author_association":"CONTRIBUTOR","body":"@rominparekh, @prodeezy, I was able to find out why those tests were failing. I opened a PR against your branch. Can you merge and update this PR?\r\n\r\nYou may also want to review #774, which was one of the reasons why this happened.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581673351/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581779965","html_url":"https://github.com/apache/iceberg/pull/695#issuecomment-581779965","issue_url":"https://api.github.com/repos/apache/iceberg/issues/695","id":581779965,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTc3OTk2NQ==","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T07:36:38Z","updated_at":"2020-02-04T07:36:38Z","author_association":"CONTRIBUTOR","body":"thanks a lot @rdblue for helping out! I will take a look today.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581779965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581997453","html_url":"https://github.com/apache/iceberg/pull/776#issuecomment-581997453","issue_url":"https://api.github.com/repos/apache/iceberg/issues/776","id":581997453,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTk5NzQ1Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T16:35:22Z","updated_at":"2020-02-04T16:35:22Z","author_association":"CONTRIBUTOR","body":"@jerryshao, could you review this one, please?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581997453/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582018832","html_url":"https://github.com/apache/iceberg/pull/774#issuecomment-582018832","issue_url":"https://api.github.com/repos/apache/iceberg/issues/774","id":582018832,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjAxODgzMg==","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T17:18:10Z","updated_at":"2020-02-04T17:31:35Z","author_association":"CONTRIBUTOR","body":"nice catch! 2 failures that seem related:\r\n\r\n```\r\norg.apache.iceberg.hadoop.TestHadoopCommits > testRenameThrow FAILED\r\n    org.apache.iceberg.exceptions.ValidationException at TestHadoopCommits.java:360\r\norg.apache.iceberg.hadoop.TestHadoopCommits > testRenameReturnFalse FAILED\r\n    org.apache.iceberg.exceptions.ValidationException at TestHadoopCommits.java:360\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582018832/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582023593","html_url":"https://github.com/apache/iceberg/pull/588#issuecomment-582023593","issue_url":"https://api.github.com/repos/apache/iceberg/issues/588","id":582023593,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjAyMzU5Mw==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T17:28:35Z","updated_at":"2020-02-04T17:28:35Z","author_association":"COLLABORATOR","body":"Hi @rdblue,  @aokolnychyi, I rebased the code. Could you please help to have a look at your convenience?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582023593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582023967","html_url":"https://github.com/apache/iceberg/pull/774#issuecomment-582023967","issue_url":"https://api.github.com/repos/apache/iceberg/issues/774","id":582023967,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjAyMzk2Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T17:29:25Z","updated_at":"2020-02-04T17:29:25Z","author_association":"CONTRIBUTOR","body":"LGTM as we have similar logic for Hive tables. Test failures seem relevant. @rdblue, could you check?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582023967/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582032363","html_url":"https://github.com/apache/iceberg/pull/774#issuecomment-582032363","issue_url":"https://api.github.com/repos/apache/iceberg/issues/774","id":582032363,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjAzMjM2Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T17:48:39Z","updated_at":"2020-02-04T17:48:39Z","author_association":"CONTRIBUTOR","body":"Test failures had two causes. First, `shouldRefresh` wasn't reset correctly. Second, use of a spy prevented the table from loading the correct metadata because the mocked FS wasn't returning correct results. The test only worked in the first place because of this bug, which would reload v1 metadata as a different object so the operations would attempt to commit and trigger the injected failure.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582032363/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582037583","html_url":"https://github.com/apache/iceberg/pull/695#issuecomment-582037583","issue_url":"https://api.github.com/repos/apache/iceberg/issues/695","id":582037583,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjAzNzU4Mw==","user":{"login":"rominparekh","id":3831468,"node_id":"MDQ6VXNlcjM4MzE0Njg=","avatar_url":"https://avatars.githubusercontent.com/u/3831468?v=4","gravatar_id":"","url":"https://api.github.com/users/rominparekh","html_url":"https://github.com/rominparekh","followers_url":"https://api.github.com/users/rominparekh/followers","following_url":"https://api.github.com/users/rominparekh/following{/other_user}","gists_url":"https://api.github.com/users/rominparekh/gists{/gist_id}","starred_url":"https://api.github.com/users/rominparekh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rominparekh/subscriptions","organizations_url":"https://api.github.com/users/rominparekh/orgs","repos_url":"https://api.github.com/users/rominparekh/repos","events_url":"https://api.github.com/users/rominparekh/events{/privacy}","received_events_url":"https://api.github.com/users/rominparekh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T18:00:42Z","updated_at":"2020-02-04T18:00:42Z","author_association":"CONTRIBUTOR","body":"@rdblue : Thanks for picking it up. I believe we are in good place to merge this in? \r\n\r\n\\cc : @aokolnychyi , @prodeezy \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582037583/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582045242","html_url":"https://github.com/apache/iceberg/pull/695#issuecomment-582045242","issue_url":"https://api.github.com/repos/apache/iceberg/issues/695","id":582045242,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjA0NTI0Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T18:18:07Z","updated_at":"2020-02-04T18:18:07Z","author_association":"CONTRIBUTOR","body":"I think we are ready. I'll let tests finish first.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582045242/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582050833","html_url":"https://github.com/apache/iceberg/pull/774#issuecomment-582050833","issue_url":"https://api.github.com/repos/apache/iceberg/issues/774","id":582050833,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjA1MDgzMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T18:31:21Z","updated_at":"2020-02-04T18:31:21Z","author_association":"CONTRIBUTOR","body":"Looks like style check failed:\r\n```\r\n[ant:checkstyle] [ERROR] /home/travis/build/apache/incubator-iceberg/core/src/test/java/org/apache/iceberg/hadoop/TestHadoopCommits.java:29:8: Unused import - org.apache.hadoop.conf.Configuration. [UnusedImports]\r\n\r\n[ant:checkstyle] [ERROR] /home/travis/build/apache/incubator-iceberg/core/src/test/java/org/apache/iceberg/hadoop/TestHadoopCommits.java:31:8: Unused import - org.apache.hadoop.fs.Path. [UnusedImports]\r\n\r\n[ant:checkstyle] [ERROR] /home/travis/build/apache/incubator-iceberg/core/src/test/java/org/apache/iceberg/hadoop/TestHadoopCommits.java:56:15: Unused import - org.mockito.Mockito.spy. [UnusedImports]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582050833/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582055865","html_url":"https://github.com/apache/iceberg/issues/767#issuecomment-582055865","issue_url":"https://api.github.com/repos/apache/iceberg/issues/767","id":582055865,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjA1NTg2NQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T18:43:13Z","updated_at":"2020-02-04T18:44:49Z","author_association":"CONTRIBUTOR","body":"I think [the spec](https://iceberg.apache.org/spec/) partially mentions this (i.e. while describing `data_file` struct) but I agree we should reiterate.\r\n\r\nIt seems we used to have `distinct_counts` but it is deprecated now. @rdblue, do you remember why?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582055865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582068857","html_url":"https://github.com/apache/iceberg/issues/767#issuecomment-582068857","issue_url":"https://api.github.com/repos/apache/iceberg/issues/767","id":582068857,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjA2ODg1Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T19:13:18Z","updated_at":"2020-02-04T19:13:18Z","author_association":"CONTRIBUTOR","body":"I actually missed #768.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582068857/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582074029","html_url":"https://github.com/apache/iceberg/issues/771#issuecomment-582074029","issue_url":"https://api.github.com/repos/apache/iceberg/issues/771","id":582074029,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjA3NDAyOQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T19:25:14Z","updated_at":"2020-02-04T19:25:14Z","author_association":"CONTRIBUTOR","body":"The last snippet you have does not actually use Iceberg. Instead, it uses the default data source in Spark.\r\n\r\n[The user docs](https://iceberg.apache.org/spark/) contain a few examples on how to use Iceberg with Spark 2.4. First of all, you need to decide whether you will be using `HadoopTables` or `HiveCatalog` in Iceberg based on the underlying storage. Depending on that, you should use one of the two examples below.\r\n\r\n```\r\n// if you created your table via HiveCatalog\r\nspark.read.format(\"iceberg\").load(\"db.table\")\r\n\r\n// if you created your table via HadoopTables\r\nspark.read.format(\"iceberg\").load(\"hdfs://nn:8020/path/to/table\")\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582074029/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582075530","html_url":"https://github.com/apache/iceberg/pull/774#issuecomment-582075530","issue_url":"https://api.github.com/repos/apache/iceberg/issues/774","id":582075530,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjA3NTUzMA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T19:28:54Z","updated_at":"2020-02-04T19:28:54Z","author_association":"CONTRIBUTOR","body":"Thanks, @rdblue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582075530/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582076447","html_url":"https://github.com/apache/iceberg/pull/588#issuecomment-582076447","issue_url":"https://api.github.com/repos/apache/iceberg/issues/588","id":582076447,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjA3NjQ0Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T19:31:09Z","updated_at":"2020-02-04T19:31:09Z","author_association":"CONTRIBUTOR","body":"Thanks, @chenjunjiedada! Will take a look today.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582076447/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582078840","html_url":"https://github.com/apache/iceberg/issues/771#issuecomment-582078840","issue_url":"https://api.github.com/repos/apache/iceberg/issues/771","id":582078840,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjA3ODg0MA==","user":{"login":"CarreauClement","id":6469565,"node_id":"MDQ6VXNlcjY0Njk1NjU=","avatar_url":"https://avatars.githubusercontent.com/u/6469565?v=4","gravatar_id":"","url":"https://api.github.com/users/CarreauClement","html_url":"https://github.com/CarreauClement","followers_url":"https://api.github.com/users/CarreauClement/followers","following_url":"https://api.github.com/users/CarreauClement/following{/other_user}","gists_url":"https://api.github.com/users/CarreauClement/gists{/gist_id}","starred_url":"https://api.github.com/users/CarreauClement/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CarreauClement/subscriptions","organizations_url":"https://api.github.com/users/CarreauClement/orgs","repos_url":"https://api.github.com/users/CarreauClement/repos","events_url":"https://api.github.com/users/CarreauClement/events{/privacy}","received_events_url":"https://api.github.com/users/CarreauClement/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T19:36:39Z","updated_at":"2020-02-04T19:36:39Z","author_association":"NONE","body":"I know the last snippet does not use Iceberg. It was to show my spark is working when not using Iceberg.\r\n\r\nI'm trying to create a table, not reading a table like in the code you provide.\r\n\r\nThanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582078840/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582081307","html_url":"https://github.com/apache/iceberg/issues/771#issuecomment-582081307","issue_url":"https://api.github.com/repos/apache/iceberg/issues/771","id":582081307,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjA4MTMwNw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T19:42:32Z","updated_at":"2020-02-04T19:42:32Z","author_association":"CONTRIBUTOR","body":"You will have to specify the table location directly while calling `catalog$createTable` because `hive.metastore.warehouse.dir` is not set in your Hadoop conf. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582081307/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582088784","html_url":"https://github.com/apache/iceberg/issues/771#issuecomment-582088784","issue_url":"https://api.github.com/repos/apache/iceberg/issues/771","id":582088784,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjA4ODc4NA==","user":{"login":"CarreauClement","id":6469565,"node_id":"MDQ6VXNlcjY0Njk1NjU=","avatar_url":"https://avatars.githubusercontent.com/u/6469565?v=4","gravatar_id":"","url":"https://api.github.com/users/CarreauClement","html_url":"https://github.com/CarreauClement","followers_url":"https://api.github.com/users/CarreauClement/followers","following_url":"https://api.github.com/users/CarreauClement/following{/other_user}","gists_url":"https://api.github.com/users/CarreauClement/gists{/gist_id}","starred_url":"https://api.github.com/users/CarreauClement/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CarreauClement/subscriptions","organizations_url":"https://api.github.com/users/CarreauClement/orgs","repos_url":"https://api.github.com/users/CarreauClement/repos","events_url":"https://api.github.com/users/CarreauClement/events{/privacy}","received_events_url":"https://api.github.com/users/CarreauClement/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T20:00:23Z","updated_at":"2020-02-04T20:01:10Z","author_association":"NONE","body":"I'm trying to add the path :\r\n\r\n\r\n\r\n```\r\nimport org.apache.iceberg.Schema\r\nimport org.apache.iceberg.types.Types._\r\nimport org.apache.iceberg.hive.HiveCatalog\r\nimport org.apache.iceberg.catalog._   \r\n\r\nval schema = new Schema(NestedField.optional(1, \"level\", StringType.get()))\r\nval spec = PartitionSpec.unpartitioned()\r\n\r\nval catalog = new HiveCatalog(spark.sparkContext.hadoopConfiguration)\r\nval name = TableIdentifier.of(\"logging\", \"logs\")\r\n\r\nval table = catalog.createTable(name, schema, spec, \"file:///home/user/bench/iceberg\", Maps.newHashMap())\r\n```\r\n\r\nNow I get the following error :\r\n\r\n> java.lang.RuntimeException: Metastore operation failed for logging.logs\r\n>   at org.apache.iceberg.hive.HiveTableOperations.doCommit(HiveTableOperations.java:198)\r\n>   at org.apache.iceberg.BaseMetastoreTableOperations.commit(BaseMetastoreTableOperations.java:103)\r\n>   at org.apache.iceberg.BaseMetastoreCatalog.createTable(BaseMetastoreCatalog.java:70)\r\n>   ... 77 elided\r\n> Caused by: org.apache.hadoop.hive.metastore.api.InvalidObjectException: logging\r\n>   at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$create_table_with_environment_context_result$create_table_with_environment_context_resultStandardScheme.read(ThriftHiveMetastore.java:29974)\r\n>   at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$create_table_with_environment_context_result$create_table_with_environment_context_resultStandardScheme.read(ThriftHiveMetastore.java:29951)\r\n>   at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$create_table_with_environment_context_result.read(ThriftHiveMetastore.java:29877)\r\n>   at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:86)\r\n>   at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.recv_create_table_with_environment_context(ThriftHiveMetastore.java:1075)\r\n>   at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.create_table_with_environment_context(ThriftHiveMetastore.java:1061)\r\n>   at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.create_table_with_environment_context(HiveMetaStoreClient.java:2050)\r\n>   at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:669)\r\n>   at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:657)\r\n>   at org.apache.iceberg.hive.HiveTableOperations.lambda$doCommit$3(HiveTableOperations.java:183)\r\n>   at org.apache.iceberg.hive.ClientPool.run(ClientPool.java:54)\r\n>   at org.apache.iceberg.hive.HiveTableOperations.doCommit(HiveTableOperations.java:182)\r\n>   ... 79 more\r\n\r\nNote that the path is correct. It works when not using iceberg.\r\n\r\nThank you for your help, I'm currently benching iceberg for our future data lake and it's annoying not being able to create a table.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582088784/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582116216","html_url":"https://github.com/apache/iceberg/issues/771#issuecomment-582116216","issue_url":"https://api.github.com/repos/apache/iceberg/issues/771","id":582116216,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjExNjIxNg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T21:09:34Z","updated_at":"2020-02-04T21:09:34Z","author_association":"CONTRIBUTOR","body":"It looks like an issue with the HMS setup but the error message is not descriptive. I would advise to check the logs to see what caused `InvalidObjectException`.\r\n\r\nIn general, there might be issues if you are using the embedded Spark metastore in Iceberg as the embedded metastore only allows one client at a time.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582116216/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582117372","html_url":"https://github.com/apache/iceberg/issues/771#issuecomment-582117372","issue_url":"https://api.github.com/repos/apache/iceberg/issues/771","id":582117372,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjExNzM3Mg==","user":{"login":"CarreauClement","id":6469565,"node_id":"MDQ6VXNlcjY0Njk1NjU=","avatar_url":"https://avatars.githubusercontent.com/u/6469565?v=4","gravatar_id":"","url":"https://api.github.com/users/CarreauClement","html_url":"https://github.com/CarreauClement","followers_url":"https://api.github.com/users/CarreauClement/followers","following_url":"https://api.github.com/users/CarreauClement/following{/other_user}","gists_url":"https://api.github.com/users/CarreauClement/gists{/gist_id}","starred_url":"https://api.github.com/users/CarreauClement/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CarreauClement/subscriptions","organizations_url":"https://api.github.com/users/CarreauClement/orgs","repos_url":"https://api.github.com/users/CarreauClement/repos","events_url":"https://api.github.com/users/CarreauClement/events{/privacy}","received_events_url":"https://api.github.com/users/CarreauClement/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T21:12:39Z","updated_at":"2020-02-04T21:12:39Z","author_association":"NONE","body":"Thank you for your help.\r\nI'm not using the embedded metastore. I'm using an external Hive metastore.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582117372/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582118291","html_url":"https://github.com/apache/iceberg/pull/775#issuecomment-582118291","issue_url":"https://api.github.com/repos/apache/iceberg/issues/775","id":582118291,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjExODI5MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T21:15:00Z","updated_at":"2020-02-04T21:15:00Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582118291/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582127768","html_url":"https://github.com/apache/iceberg/pull/776#issuecomment-582127768","issue_url":"https://api.github.com/repos/apache/iceberg/issues/776","id":582127768,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjEyNzc2OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T21:38:47Z","updated_at":"2020-02-04T21:38:47Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi I don't think that this is a case where we want to call `newHadoopConf`. That should be called if we intend to make changes to the configuration so that it doesn't affect the base configuration used by Spark. But here we just want to use a conf to get a file system. Since creating a new configuration is fairly expensive, I don't think we want to do it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582127768/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582129147","html_url":"https://github.com/apache/iceberg/pull/776#issuecomment-582129147","issue_url":"https://api.github.com/repos/apache/iceberg/issues/776","id":582129147,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjEyOTE0Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T21:42:14Z","updated_at":"2020-02-04T21:42:14Z","author_association":"CONTRIBUTOR","body":"@rdblue, I think the main problem is that we won't have the correct Hadoop configuration as all `spark.hadoop.*` properties will be ignored. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582129147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582131678","html_url":"https://github.com/apache/iceberg/pull/776#issuecomment-582131678","issue_url":"https://api.github.com/repos/apache/iceberg/issues/776","id":582131678,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjEzMTY3OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T21:48:49Z","updated_at":"2020-02-04T21:48:49Z","author_association":"CONTRIBUTOR","body":"> spark.hadoop.* properties will be ignored\r\n\r\nThat shouldn't be the case. Those are merged in when creating `hadoopConfiguration` (I thought). You can merge more config in by calling `newHadoopConfWithOptions` but I think the usual `newHadoopConf` just creates a copy.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582131678/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582132412","html_url":"https://github.com/apache/iceberg/pull/695#issuecomment-582132412","issue_url":"https://api.github.com/repos/apache/iceberg/issues/695","id":582132412,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjEzMjQxMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T21:50:32Z","updated_at":"2020-02-04T21:50:32Z","author_association":"CONTRIBUTOR","body":"Merged! Thanks for all your work on this, @prodeezy & @rominparekh!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582132412/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582167495","html_url":"https://github.com/apache/iceberg/pull/776#issuecomment-582167495","issue_url":"https://api.github.com/repos/apache/iceberg/issues/776","id":582167495,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjE2NzQ5NQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T23:32:32Z","updated_at":"2020-02-04T23:32:32Z","author_association":"CONTRIBUTOR","body":"Sorry, `spark.hadoop.*` is for `SparkConf` and are static. What I really meant is Hadoop properties that are set directly in Spark SQL. They won't be propagated.\r\n\r\n```\r\nprivate[sql] object SessionState {\r\n  def newHadoopConf(hadoopConf: Configuration, sqlConf: SQLConf): Configuration = {\r\n    val newHadoopConf = new Configuration(hadoopConf)\r\n    sqlConf.getAllConfs.foreach { case (k, v) => if (v ne null) newHadoopConf.set(k, v) }\r\n    newHadoopConf\r\n  }\r\n}\r\n```\r\n\r\nThe performance concern, though, is valid. Especially, in `ReadTask`. Let's keep it as is.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582167495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582170338","html_url":"https://github.com/apache/iceberg/pull/776#issuecomment-582170338","issue_url":"https://api.github.com/repos/apache/iceberg/issues/776","id":582170338,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjE3MDMzOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-04T23:42:19Z","updated_at":"2020-02-04T23:42:19Z","author_association":"CONTRIBUTOR","body":"Thanks for the clarification, I'm glad you pointed it out.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582170338/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582192665","html_url":"https://github.com/apache/iceberg/issues/767#issuecomment-582192665","issue_url":"https://api.github.com/repos/apache/iceberg/issues/767","id":582192665,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjE5MjY2NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-05T01:05:43Z","updated_at":"2020-02-05T01:05:43Z","author_association":"CONTRIBUTOR","body":"Yes, value counts includes null values. I think Anton wrote good tests to validate the behavior here.\r\n\r\nWe deprecated `distinct_counts` because it wasn't useful. It doesn't do much good to know how many distinct values are in a single file unless you can combine that across files. To do that, we need more information than just the distinct count. We need a data sketch.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582192665/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582550439","html_url":"https://github.com/apache/iceberg/issues/629#issuecomment-582550439","issue_url":"https://api.github.com/repos/apache/iceberg/issues/629","id":582550439,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjU1MDQzOQ==","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-05T18:37:59Z","updated_at":"2020-02-05T18:37:59Z","author_association":"CONTRIBUTOR","body":"We can close this now @rdblue?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582550439/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582551718","html_url":"https://github.com/apache/iceberg/issues/42#issuecomment-582551718","issue_url":"https://api.github.com/repos/apache/iceberg/issues/42","id":582551718,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjU1MTcxOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-05T18:41:09Z","updated_at":"2020-02-05T18:41:09Z","author_association":"CONTRIBUTOR","body":"Implemented for appends in #695.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582551718/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582551868","html_url":"https://github.com/apache/iceberg/issues/629#issuecomment-582551868","issue_url":"https://api.github.com/repos/apache/iceberg/issues/629","id":582551868,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjU1MTg2OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-05T18:41:33Z","updated_at":"2020-02-05T18:41:33Z","author_association":"CONTRIBUTOR","body":"Yes, and I closed #42 as Anton pointed out.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582551868/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582552571","html_url":"https://github.com/apache/iceberg/pull/779#issuecomment-582552571","issue_url":"https://api.github.com/repos/apache/iceberg/issues/779","id":582552571,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjU1MjU3MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-05T18:43:14Z","updated_at":"2020-02-05T18:43:14Z","author_association":"CONTRIBUTOR","body":"Metadata files should be created using `overwrite` instead of `create`. In most s3 file systems, that will avoid the HEAD request to see if the file exists that s3 will cache. That fixes these in most cases.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582552571/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582554306","html_url":"https://github.com/apache/iceberg/pull/779#issuecomment-582554306","issue_url":"https://api.github.com/repos/apache/iceberg/issues/779","id":582554306,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjU1NDMwNg==","user":{"login":"alexey-fin","id":45828782,"node_id":"MDQ6VXNlcjQ1ODI4Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/45828782?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-fin","html_url":"https://github.com/alexey-fin","followers_url":"https://api.github.com/users/alexey-fin/followers","following_url":"https://api.github.com/users/alexey-fin/following{/other_user}","gists_url":"https://api.github.com/users/alexey-fin/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-fin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-fin/subscriptions","organizations_url":"https://api.github.com/users/alexey-fin/orgs","repos_url":"https://api.github.com/users/alexey-fin/repos","events_url":"https://api.github.com/users/alexey-fin/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-fin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-05T18:47:19Z","updated_at":"2020-02-05T18:47:19Z","author_association":"CONTRIBUTOR","body":"It not only checks if the file exists, it also checks if there is a dir\nwith this name, we are running into this problem\n\nOn Wed, Feb 5, 2020, 20:43 Ryan Blue <notifications@github.com> wrote:\n\n> Metadata files should be created using overwrite instead of create. In\n> most s3 file systems, that will avoid the HEAD request to see if the file\n> exists that s3 will cache. That fixes these in most cases.\n>\n> —\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/incubator-iceberg/pull/779?email_source=notifications&email_token=AK5UVLURZ2AEPGRYI4UMVJTRBMCEJA5CNFSM4KQO37CKYY3PNVWWK3TUL52HS4DFVREXG43VMVBW63LNMVXHJKTDN5WW2ZLOORPWSZGOEK4QX6Y#issuecomment-582552571>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AK5UVLQDPDWCEP7UL7LF2VTRBMCEJANCNFSM4KQO37CA>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582554306/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582556513","html_url":"https://github.com/apache/iceberg/pull/779#issuecomment-582556513","issue_url":"https://api.github.com/repos/apache/iceberg/issues/779","id":582556513,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjU1NjUxMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-05T18:52:41Z","updated_at":"2020-02-05T18:52:41Z","author_association":"CONTRIBUTOR","body":"In that case, I'd recommend plugging in a different FileIO for S3 file systems that will retry reads for some period of time. I don't think it makes sense to change the commit behavior if the problem is read consistency.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582556513/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582568583","html_url":"https://github.com/apache/iceberg/pull/777#issuecomment-582568583","issue_url":"https://api.github.com/repos/apache/iceberg/issues/777","id":582568583,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjU2ODU4Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-05T19:21:38Z","updated_at":"2020-02-05T19:21:38Z","author_association":"CONTRIBUTOR","body":"+1\r\n\r\nThanks @aokolnychyi!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582568583/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582571256","html_url":"https://github.com/apache/iceberg/pull/769#issuecomment-582571256","issue_url":"https://api.github.com/repos/apache/iceberg/issues/769","id":582571256,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjU3MTI1Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-05T19:27:34Z","updated_at":"2020-02-05T19:27:34Z","author_association":"CONTRIBUTOR","body":"Would it be difficult to separate these changes into different pull requests? It would be easier to review that way, since many of the changes are independent.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582571256/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582575228","html_url":"https://github.com/apache/iceberg/pull/766#issuecomment-582575228","issue_url":"https://api.github.com/repos/apache/iceberg/issues/766","id":582575228,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjU3NTIyOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-05T19:36:18Z","updated_at":"2020-02-05T19:36:18Z","author_association":"CONTRIBUTOR","body":"+1\r\n\r\nThanks @jun-he! I'll merge this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582575228/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582662549","html_url":"https://github.com/apache/iceberg/pull/769#issuecomment-582662549","issue_url":"https://api.github.com/repos/apache/iceberg/issues/769","id":582662549,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjY2MjU0OQ==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-05T23:28:16Z","updated_at":"2020-02-05T23:28:16Z","author_association":"CONTRIBUTOR","body":"Should be doable.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582662549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582669043","html_url":"https://github.com/apache/iceberg/pull/769#issuecomment-582669043","issue_url":"https://api.github.com/repos/apache/iceberg/issues/769","id":582669043,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjY2OTA0Mw==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-05T23:52:16Z","updated_at":"2020-02-05T23:52:16Z","author_association":"CONTRIBUTOR","body":"Closing this in favor of smaller patches","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582669043/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582860009","html_url":"https://github.com/apache/iceberg/issues/761#issuecomment-582860009","issue_url":"https://api.github.com/repos/apache/iceberg/issues/761","id":582860009,"node_id":"MDEyOklzc3VlQ29tbWVudDU4Mjg2MDAwOQ==","user":{"login":"ramkumarkb","id":511301,"node_id":"MDQ6VXNlcjUxMTMwMQ==","avatar_url":"https://avatars.githubusercontent.com/u/511301?v=4","gravatar_id":"","url":"https://api.github.com/users/ramkumarkb","html_url":"https://github.com/ramkumarkb","followers_url":"https://api.github.com/users/ramkumarkb/followers","following_url":"https://api.github.com/users/ramkumarkb/following{/other_user}","gists_url":"https://api.github.com/users/ramkumarkb/gists{/gist_id}","starred_url":"https://api.github.com/users/ramkumarkb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ramkumarkb/subscriptions","organizations_url":"https://api.github.com/users/ramkumarkb/orgs","repos_url":"https://api.github.com/users/ramkumarkb/repos","events_url":"https://api.github.com/users/ramkumarkb/events{/privacy}","received_events_url":"https://api.github.com/users/ramkumarkb/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-06T11:23:57Z","updated_at":"2020-02-06T11:23:57Z","author_association":"NONE","body":"Ryan,\r\n\r\nThank you for your reply.\r\n\r\nAs per the MinIO docs - https://docs.minio.io/docs/distributed-minio-quickstart-guide.html \r\n> MinIO follows strict read-after-write and list-after-write consistency model for all i/o operations both in distributed and standalone modes.\r\n\r\nWith this, a Hive Metastore is still needed? \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582860009/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582973644","html_url":"https://github.com/apache/iceberg/pull/779#issuecomment-582973644","issue_url":"https://api.github.com/repos/apache/iceberg/issues/779","id":582973644,"node_id":"MDEyOklzc3VlQ29tbWVudDU4Mjk3MzY0NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-06T15:58:19Z","updated_at":"2020-02-06T15:58:19Z","author_association":"CONTRIBUTOR","body":"Quick question. The file name in the description indicates that we failed to read the manifest list. Every time we attempt to commit, we have a new manifest list location. `HadoopFileIO` will delegate the creation of the file to `HadoopOutputFile`. As Ryan pointed out, we always set the overwrite flag. Are we saying `fs.create(path, true /* createOrOverwrite */)` sends a GET request that triggers eventual consistency?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582973644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582974652","html_url":"https://github.com/apache/iceberg/pull/779#issuecomment-582974652","issue_url":"https://api.github.com/repos/apache/iceberg/issues/779","id":582974652,"node_id":"MDEyOklzc3VlQ29tbWVudDU4Mjk3NDY1Mg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-06T16:00:27Z","updated_at":"2020-02-06T16:00:27Z","author_association":"CONTRIBUTOR","body":"@alexey-fin, is this S3 or S3-compatible file system?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582974652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582979633","html_url":"https://github.com/apache/iceberg/issues/761#issuecomment-582979633","issue_url":"https://api.github.com/repos/apache/iceberg/issues/761","id":582979633,"node_id":"MDEyOklzc3VlQ29tbWVudDU4Mjk3OTYzMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-06T16:10:39Z","updated_at":"2020-02-06T16:10:39Z","author_association":"CONTRIBUTOR","body":"@ramkumarkb, it isn't clear from that alone. Iceberg's Hadoop table implementation requires atomic rename for correctness.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582979633/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582985723","html_url":"https://github.com/apache/iceberg/pull/779#issuecomment-582985723","issue_url":"https://api.github.com/repos/apache/iceberg/issues/779","id":582985723,"node_id":"MDEyOklzc3VlQ29tbWVudDU4Mjk4NTcyMw==","user":{"login":"alexey-fin","id":45828782,"node_id":"MDQ6VXNlcjQ1ODI4Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/45828782?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-fin","html_url":"https://github.com/alexey-fin","followers_url":"https://api.github.com/users/alexey-fin/followers","following_url":"https://api.github.com/users/alexey-fin/following{/other_user}","gists_url":"https://api.github.com/users/alexey-fin/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-fin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-fin/subscriptions","organizations_url":"https://api.github.com/users/alexey-fin/orgs","repos_url":"https://api.github.com/users/alexey-fin/repos","events_url":"https://api.github.com/users/alexey-fin/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-fin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-06T16:23:07Z","updated_at":"2020-02-06T16:23:07Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi yeah definitely, look at the s3afilesystem from hadoop-aws : try {\r\n\t\t\t// get the status or throw an FNFE\r\n\t\t\tstatus = getFileStatus(path);\r\n\r\n\t\t\t// if the thread reaches here, there is something at the path\r\n\t\t\tif (status.isDirectory()) {\r\n\t\t\t\t// path references a directory: automatic error\r\n\t\t\t\tthrow new FileAlreadyExistsException(path + \" is a directory\");\r\n\t\t\t}\r\nIt is s3","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582985723/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582990214","html_url":"https://github.com/apache/iceberg/pull/779#issuecomment-582990214","issue_url":"https://api.github.com/repos/apache/iceberg/issues/779","id":582990214,"node_id":"MDEyOklzc3VlQ29tbWVudDU4Mjk5MDIxNA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-06T16:32:28Z","updated_at":"2020-02-06T16:32:28Z","author_association":"CONTRIBUTOR","body":"I agree with Ryan that building another `FileIO` implementation to address this would be a better option. @alexey-fin, would you be interested to contribute this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/582990214/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/583015791","html_url":"https://github.com/apache/iceberg/pull/779#issuecomment-583015791","issue_url":"https://api.github.com/repos/apache/iceberg/issues/779","id":583015791,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MzAxNTc5MQ==","user":{"login":"alexey-fin","id":45828782,"node_id":"MDQ6VXNlcjQ1ODI4Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/45828782?v=4","gravatar_id":"","url":"https://api.github.com/users/alexey-fin","html_url":"https://github.com/alexey-fin","followers_url":"https://api.github.com/users/alexey-fin/followers","following_url":"https://api.github.com/users/alexey-fin/following{/other_user}","gists_url":"https://api.github.com/users/alexey-fin/gists{/gist_id}","starred_url":"https://api.github.com/users/alexey-fin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexey-fin/subscriptions","organizations_url":"https://api.github.com/users/alexey-fin/orgs","repos_url":"https://api.github.com/users/alexey-fin/repos","events_url":"https://api.github.com/users/alexey-fin/events{/privacy}","received_events_url":"https://api.github.com/users/alexey-fin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-06T17:24:55Z","updated_at":"2020-02-06T17:24:55Z","author_association":"CONTRIBUTOR","body":"Actually what Ryan says there are apparently several existing implementations, one example is PrestoS3FileSystem, we might just wanna use it","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/583015791/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/583044458","html_url":"https://github.com/apache/iceberg/pull/780#issuecomment-583044458","issue_url":"https://api.github.com/repos/apache/iceberg/issues/780","id":583044458,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MzA0NDQ1OA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-06T18:28:17Z","updated_at":"2020-02-06T18:28:17Z","author_association":"CONTRIBUTOR","body":"I think this PR is a follow-up on #631. \r\n\r\nAs far as I remember, we planned that the main place to remove old metadata JSON files will be while expiring snapshots. After a quick look, it seems we won't delete metadata files unless the user explicitly calls a method in `ExpireSnapshots`. I would, probably, always reduce the number of metadata JSON files to a smaller number and expose a method to overwrite the number of files to keep. For example, we can have a table property that defines the default number of files to keep while expiring snapshots and a method to override this value programmatically.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/583044458/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/583044654","html_url":"https://github.com/apache/iceberg/pull/780#issuecomment-583044654","issue_url":"https://api.github.com/repos/apache/iceberg/issues/780","id":583044654,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MzA0NDY1NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-06T18:28:45Z","updated_at":"2020-02-06T18:28:45Z","author_association":"CONTRIBUTOR","body":"FYI @arina-ielchiieva ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/583044654/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/583264913","html_url":"https://github.com/apache/iceberg/issues/760#issuecomment-583264913","issue_url":"https://api.github.com/repos/apache/iceberg/issues/760","id":583264913,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MzI2NDkxMw==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-07T07:15:47Z","updated_at":"2020-02-07T07:15:47Z","author_association":"COLLABORATOR","body":"Can we close it as the change is merged? Thanks.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/583264913/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/583285403","html_url":"https://github.com/apache/iceberg/issues/726#issuecomment-583285403","issue_url":"https://api.github.com/repos/apache/iceberg/issues/726","id":583285403,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MzI4NTQwMw==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-07T08:26:59Z","updated_at":"2020-02-14T08:25:10Z","author_association":"COLLABORATOR","body":"@aokolnychyi  Looks like we can drop drop synchronization in WriterWrapper by grouping the remainingManifest by partitionSpecId and then passing each sublist as the input to the thread pool. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/583285403/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/583508974","html_url":"https://github.com/apache/iceberg/issues/760#issuecomment-583508974","issue_url":"https://api.github.com/repos/apache/iceberg/issues/760","id":583508974,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MzUwODk3NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-07T17:18:45Z","updated_at":"2020-02-07T17:18:45Z","author_association":"CONTRIBUTOR","body":"@jun-he, thanks for fixing this!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/583508974/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584424628","html_url":"https://github.com/apache/iceberg/pull/785#issuecomment-584424628","issue_url":"https://api.github.com/repos/apache/iceberg/issues/785","id":584424628,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDQyNDYyOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-11T00:24:43Z","updated_at":"2020-02-11T00:24:43Z","author_association":"CONTRIBUTOR","body":"Looks great. Thanks @vrozov!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584424628/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584435160","html_url":"https://github.com/apache/iceberg/pull/786#issuecomment-584435160","issue_url":"https://api.github.com/repos/apache/iceberg/issues/786","id":584435160,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDQzNTE2MA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-11T01:03:32Z","updated_at":"2020-02-11T01:03:32Z","author_association":"CONTRIBUTOR","body":"@chenjunjiedada, great work! I did a quick look and had only minor comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584435160/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584436464","html_url":"https://github.com/apache/iceberg/pull/789#issuecomment-584436464","issue_url":"https://api.github.com/repos/apache/iceberg/issues/789","id":584436464,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDQzNjQ2NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-11T01:08:45Z","updated_at":"2020-02-11T01:08:45Z","author_association":"CONTRIBUTOR","body":"@rdblue, could you take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584436464/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584440148","html_url":"https://github.com/apache/iceberg/pull/789#issuecomment-584440148","issue_url":"https://api.github.com/repos/apache/iceberg/issues/789","id":584440148,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDQ0MDE0OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-11T01:26:27Z","updated_at":"2020-02-11T01:26:27Z","author_association":"CONTRIBUTOR","body":"I'm not sure I understand the cases in which `snapshotId()` is called concurrently. Shouldn't that be set lazily just once for any given operation?\r\n\r\nAlso, since this is randomly generated, what about creating a new one in the constructor instead of using the double-checked lock?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584440148/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584445039","html_url":"https://github.com/apache/iceberg/pull/786#issuecomment-584445039","issue_url":"https://api.github.com/repos/apache/iceberg/issues/786","id":584445039,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDQ0NTAzOQ==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-11T01:45:09Z","updated_at":"2020-02-11T01:45:09Z","author_association":"COLLABORATOR","body":"@aokolnychyi , Thanks for the review, just updated.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584445039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584451751","html_url":"https://github.com/apache/iceberg/pull/786#issuecomment-584451751","issue_url":"https://api.github.com/repos/apache/iceberg/issues/786","id":584451751,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDQ1MTc1MQ==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-11T02:14:23Z","updated_at":"2020-02-11T02:14:23Z","author_association":"COLLABORATOR","body":"python build is failed. @aokolnychyi could you please help to trigger CI?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584451751/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584463615","html_url":"https://github.com/apache/iceberg/pull/782#issuecomment-584463615","issue_url":"https://api.github.com/repos/apache/iceberg/issues/782","id":584463615,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDQ2MzYxNQ==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-11T03:22:48Z","updated_at":"2020-02-11T03:22:48Z","author_association":"CONTRIBUTOR","body":"Python build failed. Seems like the failure is unrelated.\r\n```\r\nERROR: invocation failed (exit code 1), logfile: /home/travis/build/apache/incubator-iceberg/python/.tox/py36/log/py36-0.log\r\n================================== log start ===================================\r\nERROR:root:ImportError: cannot import name 'ensure_text'\r\n=================================== log end ====================================\r\nERROR: InvocationError for command /home/travis/virtualenv/python3.6.3/bin/python -m virtualenv --no-download --python /home/travis/virtualenv/python3.6.3/bin/python py36 (exited with code 1)\r\n___________________________________ summary ____________________________________\r\nERROR:   py36: InvocationError for command /home/travis/virtualenv/python3.6.3/bin/python -m virtualenv --no-download --python /home/travis/virtualenv/python3.6.3/bin/python py36 (exited with code 1)\r\nThe command \"tox\" exited with 1.\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584463615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584503640","html_url":"https://github.com/apache/iceberg/issues/788#issuecomment-584503640","issue_url":"https://api.github.com/repos/apache/iceberg/issues/788","id":584503640,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDUwMzY0MA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-11T07:12:42Z","updated_at":"2020-02-11T07:12:42Z","author_association":"MEMBER","body":"@aokolnychyi  How do you think about the document  ? I mean, would the flink's necessary incremental consumption and low latency violate iceberg's roadmap ? If not so, I can provide the more detailed design and make this work forward,  the iceberg would be the first data lake product which support apache flink.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584503640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584507664","html_url":"https://github.com/apache/iceberg/pull/789#issuecomment-584507664","issue_url":"https://api.github.com/repos/apache/iceberg/issues/789","id":584507664,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDUwNzY2NA==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-11T07:30:16Z","updated_at":"2020-02-11T07:36:08Z","author_association":"COLLABORATOR","body":"The race might happen in case that two threads call snapshotId at the same time when snapshot is not initialized. Then both pass the null check and then set its value to a new snapshotId. The snapshotId seen by the caller might be corrupted data (e.g. partially initialized object based on Java Memory Model). \r\n\r\n+1 to use initialization safety instead of double checked locking. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584507664/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584711200","html_url":"https://github.com/apache/iceberg/pull/789#issuecomment-584711200","issue_url":"https://api.github.com/repos/apache/iceberg/issues/789","id":584711200,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDcxMTIwMA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-11T16:07:12Z","updated_at":"2020-02-11T16:07:30Z","author_association":"CONTRIBUTOR","body":"@jun-he is correct. As an example, consider `filterManifests` in `MergingSnapshotProducer`. It uses a thread pool to process each manifest separately and each worker will call `snapshotId()`. Right now, we can write filtered manifests with different snapshot ids in the same operation.\r\n\r\n+1 on constructor as well","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584711200/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584729548","html_url":"https://github.com/apache/iceberg/pull/789#issuecomment-584729548","issue_url":"https://api.github.com/repos/apache/iceberg/issues/789","id":584729548,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDcyOTU0OA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-11T16:43:21Z","updated_at":"2020-02-11T16:45:51Z","author_association":"CONTRIBUTOR","body":"Actually, there is one consequence of moving the initialization of the snapshot id in the constructor that we should be careful about. We will always request a new snapshot id from our table ops even when we don't need it (e.g. rollback). It impacts table ops that return sequential ids. For example, some of our tests will fail because `TestTableOperations` return sequential ids and they currently assume rollback will not request it. There might be also a custom table ops implementation that returns sequential ids. It seems like a reason why the snapshot id was made lazy in the first place. \r\n\r\nHaving said that, we can simply modify the failing tests as it is also fine to request a new snapshot id during rollback even if we don't need it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584729548/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584769254","html_url":"https://github.com/apache/iceberg/pull/789#issuecomment-584769254","issue_url":"https://api.github.com/repos/apache/iceberg/issues/789","id":584769254,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDc2OTI1NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-11T17:59:29Z","updated_at":"2020-02-11T17:59:29Z","author_association":"CONTRIBUTOR","body":"Here is the list of tests to be adapted if we initialize in the constructor.\r\n\r\n```\r\norg.apache.iceberg.TestIncrementalDataTableScan > testRollbacks FAILED\r\n    java.lang.AssertionError at TestIncrementalDataTableScan.java:144\r\n\r\norg.apache.iceberg.TestWapWorkflow > testRollbackAndCherrypick FAILED\r\n    java.lang.AssertionError at TestWapWorkflow.java:185\r\n\r\norg.apache.iceberg.TestWapWorkflow > testWithTwoPhaseCherryPicking FAILED\r\n    java.lang.AssertionError at TestWapWorkflow.java:347\r\n\r\norg.apache.iceberg.TestOverwriteWithValidation > testOverwriteIncompatibleExpirationValidated FAILED\r\n    java.lang.AssertionError at TestOverwriteWithValidation.java:479\r\n\r\norg.apache.iceberg.TestOverwriteWithValidation > testOverwriteIncompatibleBaseExpirationEmptyTableValidated FAILED\r\n    java.lang.AssertionError at TestOverwriteWithValidation.java:508\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584769254/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584808267","html_url":"https://github.com/apache/iceberg/pull/789#issuecomment-584808267","issue_url":"https://api.github.com/repos/apache/iceberg/issues/789","id":584808267,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDgwODI2Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-11T19:25:52Z","updated_at":"2020-02-11T19:25:52Z","author_association":"CONTRIBUTOR","body":"I'm okay with either solution. Seems easier to do the double-checked lock to avoid test changes, though.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584808267/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584810714","html_url":"https://github.com/apache/iceberg/pull/790#issuecomment-584810714","issue_url":"https://api.github.com/repos/apache/iceberg/issues/790","id":584810714,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDgxMDcxNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-11T19:31:24Z","updated_at":"2020-02-11T19:31:24Z","author_association":"CONTRIBUTOR","body":"The value of `writers` doesn't change across threads. It is always the same concurrent map, so it doesn't matter that the variable isn't `volatile`. The important thing is that it is a concurrent map and makes guarantees about behavior across threads calling `get`.\r\n\r\nI think this change should be safe and gets rid of some complexity, so I'm fine with it. @aokolnychyi, what do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584810714/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584815363","html_url":"https://github.com/apache/iceberg/pull/789#issuecomment-584815363","issue_url":"https://api.github.com/repos/apache/iceberg/issues/789","id":584815363,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDgxNTM2Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-11T19:42:09Z","updated_at":"2020-02-11T19:42:09Z","author_association":"CONTRIBUTOR","body":"I propose to keep it as is to avoid additional changes and any hidden consequences.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584815363/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584817094","html_url":"https://github.com/apache/iceberg/pull/789#issuecomment-584817094","issue_url":"https://api.github.com/repos/apache/iceberg/issues/789","id":584817094,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDgxNzA5NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-11T19:45:56Z","updated_at":"2020-02-11T19:45:56Z","author_association":"CONTRIBUTOR","body":"Sounds good. I merged this. The test failure was Python and Ted is looking into it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584817094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584817879","html_url":"https://github.com/apache/iceberg/pull/782#issuecomment-584817879","issue_url":"https://api.github.com/repos/apache/iceberg/issues/782","id":584817879,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDgxNzg3OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-11T19:47:32Z","updated_at":"2020-02-11T19:47:32Z","author_association":"CONTRIBUTOR","body":"+1\r\n\r\nI'll merge this with the test failure because those are Python and aren't related.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584817879/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584909577","html_url":"https://github.com/apache/iceberg/issues/788#issuecomment-584909577","issue_url":"https://api.github.com/repos/apache/iceberg/issues/788","id":584909577,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDkwOTU3Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-11T23:22:24Z","updated_at":"2020-02-11T23:22:24Z","author_association":"CONTRIBUTOR","body":"@openinx, I want to make this work. As I said on the doc, we want Iceberg to be a great at-rest data layer. Supporting incremental consumption with reasonably low latency is something that I think we should work toward. Our goals are certainly compatible.\r\n\r\nI've read through the doc, but I'm not sure that I can see how the second idea would work. Right now, Iceberg transitions from one complete snapshot of table data to another. It sounds like the idea is to use logs that span snapshots so that the files can grow larger than the changes from a 1-minute period. The part about using the same log files across snapshots makes sense, but not how the data would be part of the table and accessible by other readers: If a log file is open in one writer, how would a process on another node read it? That isn't supported by object stores like S3.\r\n\r\nAnother problem is coordinating what parts of the log are in each snapshot, so we can reconstruct the table state (assuming that the visibility problem is solved). I see two options: first, you could have the writers notified that a snapshot, say s3, has ended and they should start writing rows for s4; then they need to flush; and finally send a message that all rows are written. After all of them are done, s3 can be committed. A second option is to just keep writing rows and not create new snapshots, but then we need to handle dirty reads because the files are incomplete.\r\n\r\nWhen comparing with the other option, I don't think you get that much value out of idea 2. Assuming that you could access the log files from other nodes, a log file would probably be used for maybe 10 minutes. You also need a compaction service to handle the log files, just like you would want to compact the small files written by the first option. That means you're not saving that much; granted it's about 10x the number of files, but the compaction service ensures that the files are short-lived and get compacted into the dataset regularly. The small files are only an issue if the files stay around for a long time. If you regularly compact them (as we would for the other option, too) then it shouldn't be a major problem.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584909577/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584954078","html_url":"https://github.com/apache/iceberg/pull/745#issuecomment-584954078","issue_url":"https://api.github.com/repos/apache/iceberg/issues/745","id":584954078,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDk1NDA3OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-12T00:54:17Z","updated_at":"2020-02-12T00:54:17Z","author_association":"CONTRIBUTOR","body":"@ravichinoy, thanks for working on this. It looks good.\r\n\r\nCan you either fix the methods that use a boxed Boolean or implement the builder-like API I suggested? I can add the builder in a follow-up if you want to get this in more quickly.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584954078/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584975942","html_url":"https://github.com/apache/iceberg/pull/793#issuecomment-584975942","issue_url":"https://api.github.com/repos/apache/iceberg/issues/793","id":584975942,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDk3NTk0Mg==","user":{"login":"chyzzqo2","id":52714809,"node_id":"MDQ6VXNlcjUyNzE0ODA5","avatar_url":"https://avatars.githubusercontent.com/u/52714809?v=4","gravatar_id":"","url":"https://api.github.com/users/chyzzqo2","html_url":"https://github.com/chyzzqo2","followers_url":"https://api.github.com/users/chyzzqo2/followers","following_url":"https://api.github.com/users/chyzzqo2/following{/other_user}","gists_url":"https://api.github.com/users/chyzzqo2/gists{/gist_id}","starred_url":"https://api.github.com/users/chyzzqo2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chyzzqo2/subscriptions","organizations_url":"https://api.github.com/users/chyzzqo2/orgs","repos_url":"https://api.github.com/users/chyzzqo2/repos","events_url":"https://api.github.com/users/chyzzqo2/events{/privacy}","received_events_url":"https://api.github.com/users/chyzzqo2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-12T01:45:55Z","updated_at":"2020-02-12T01:45:55Z","author_association":"CONTRIBUTOR","body":"python 3.6 is still pretty widely used so i think it's find to leave it there as the baseline. Unless of course you actually want / need 3.7 only features.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/584975942/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585038723","html_url":"https://github.com/apache/iceberg/issues/792#issuecomment-585038723","issue_url":"https://api.github.com/repos/apache/iceberg/issues/792","id":585038723,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTAzODcyMw==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-12T05:37:22Z","updated_at":"2020-02-12T05:37:22Z","author_association":"CONTRIBUTOR","body":"I tried out the above example. I think it is not working because there's a typo. The `logicalType` field should be under the `type` field, like so\r\n```\r\n{\r\n  \"type\" : \"record\",\r\n  \"name\" : \"r\",\r\n  \"namespace\" : \"n\",\r\n  \"fields\" : [ {\r\n    \"name\" : \"timestamp_with_logical_type\",\r\n    \"type\" : {\r\n      \"type\" : \"long\",\r\n      \"logicalType\" : \"timestamp-millis\"\r\n    }\r\n  }\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585038723/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585044154","html_url":"https://github.com/apache/iceberg/issues/791#issuecomment-585044154","issue_url":"https://api.github.com/repos/apache/iceberg/issues/791","id":585044154,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTA0NDE1NA==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-12T05:59:45Z","updated_at":"2020-02-12T05:59:45Z","author_association":"CONTRIBUTOR","body":"@figo10203, there could be an exception in your Metastore logs. We should also check that for clues.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585044154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585049569","html_url":"https://github.com/apache/iceberg/issues/771#issuecomment-585049569","issue_url":"https://api.github.com/repos/apache/iceberg/issues/771","id":585049569,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTA0OTU2OQ==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-12T06:21:35Z","updated_at":"2020-02-12T06:21:35Z","author_association":"CONTRIBUTOR","body":"@CarreauClement  for the line\r\n> val catalog = new HiveCatalog(spark.sparkContext.hadoopConfiguration)\r\n\r\nI'd double check if HiveCatalog is getting the write configuration object which has the right hive properties to talk to the Metastore","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585049569/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585077940","html_url":"https://github.com/apache/iceberg/pull/789#issuecomment-585077940","issue_url":"https://api.github.com/repos/apache/iceberg/issues/789","id":585077940,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTA3Nzk0MA==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-12T07:55:37Z","updated_at":"2020-02-12T07:57:15Z","author_association":"COLLABORATOR","body":"Another way to avoid double checked locking and test changes is to use lazy init.\r\nFor example, \r\n- declare `private final Supplier<Long> snapshotId` and \r\n- then in the constructor, set `snapshotId = Suppliers.memoize(ops::newSnapshotId);`, where `memoize` returns a thread-safe supplier. \r\n- The `snapshotId()` method will directly `return snapshotId.get();`, where `get()` method will be invoked at most once based on guava Javadoc.\r\n\r\n@rdblue @aokolnychyi I can make a small PR with this code change if it helps.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585077940/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585167992","html_url":"https://github.com/apache/iceberg/issues/788#issuecomment-585167992","issue_url":"https://api.github.com/repos/apache/iceberg/issues/788","id":585167992,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTE2Nzk5Mg==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-12T11:45:51Z","updated_at":"2020-02-12T11:45:51Z","author_association":"MEMBER","body":"@rdblue Thanks for your roadmap confirmation,  so the next thing to do would be how will we design and implement it.  Indeed, I didn't consider much about the s3 storage,  the readers might could not see the unclosed appending log(although it's not a problem in HDFS). it might be the biggest obstacle I guess,  the log would also introduce the coordinating issues as you said. Yeah, I have to admit that it's really not a very mature idea.  Anyway,  thanks for pointing those out and I would provide a more detailed document about the flink & iceberg integration and think about as many cases as I could. \r\n\r\nThanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585167992/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585184764","html_url":"https://github.com/apache/iceberg/pull/793#issuecomment-585184764","issue_url":"https://api.github.com/repos/apache/iceberg/issues/793","id":585184764,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTE4NDc2NA==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-12T12:34:19Z","updated_at":"2020-02-12T12:34:19Z","author_association":"CONTRIBUTOR","body":"I would support from 3.6 and higher. At this moment, it is only from 3.4 and onwards: https://github.com/apache/incubator-iceberg/blob/master/python/setup.py#L28","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585184764/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585193694","html_url":"https://github.com/apache/iceberg/pull/793#issuecomment-585193694","issue_url":"https://api.github.com/repos/apache/iceberg/issues/793","id":585193694,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTE5MzY5NA==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-12T12:59:24Z","updated_at":"2020-02-12T12:59:24Z","author_association":"CONTRIBUTOR","body":"Related: https://github.com/apache/incubator-iceberg/pull/795","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585193694/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585194414","html_url":"https://github.com/apache/iceberg/pull/795#issuecomment-585194414","issue_url":"https://api.github.com/repos/apache/iceberg/issues/795","id":585194414,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTE5NDQxNA==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-12T13:01:27Z","updated_at":"2020-02-12T13:01:27Z","author_association":"CONTRIBUTOR","body":"CI fails because of https://github.com/apache/incubator-iceberg/pull/794","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585194414/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585211402","html_url":"https://github.com/apache/iceberg/pull/794#issuecomment-585211402","issue_url":"https://api.github.com/repos/apache/iceberg/issues/794","id":585211402,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTIxMTQwMg==","user":{"login":"TGooch44","id":1591711,"node_id":"MDQ6VXNlcjE1OTE3MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1591711?v=4","gravatar_id":"","url":"https://api.github.com/users/TGooch44","html_url":"https://github.com/TGooch44","followers_url":"https://api.github.com/users/TGooch44/followers","following_url":"https://api.github.com/users/TGooch44/following{/other_user}","gists_url":"https://api.github.com/users/TGooch44/gists{/gist_id}","starred_url":"https://api.github.com/users/TGooch44/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TGooch44/subscriptions","organizations_url":"https://api.github.com/users/TGooch44/orgs","repos_url":"https://api.github.com/users/TGooch44/repos","events_url":"https://api.github.com/users/TGooch44/events{/privacy}","received_events_url":"https://api.github.com/users/TGooch44/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-12T13:44:19Z","updated_at":"2020-02-12T13:44:19Z","author_association":"CONTRIBUTOR","body":"@Fokko thanks for taking a look and submitting the PR!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585211402/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585233554","html_url":"https://github.com/apache/iceberg/pull/794#issuecomment-585233554","issue_url":"https://api.github.com/repos/apache/iceberg/issues/794","id":585233554,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTIzMzU1NA==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-12T14:33:44Z","updated_at":"2020-02-12T14:33:44Z","author_association":"CONTRIBUTOR","body":"My pleasure @TGooch44 . All green again 👍 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585233554/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585252478","html_url":"https://github.com/apache/iceberg/pull/588#issuecomment-585252478","issue_url":"https://api.github.com/repos/apache/iceberg/issues/588","id":585252478,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTI1MjQ3OA==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-12T15:12:35Z","updated_at":"2020-02-12T15:12:35Z","author_association":"COLLABORATOR","body":"@rdblue @aokolnychyi, Base on the comments, I assume the next steps are\r\n\r\n- bump the table format version\r\n- set a compatibility flag compatibility.sequence-number.enabled\r\n- update existing writers to add logic to check format version\r\n\r\nWhat do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585252478/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585286984","html_url":"https://github.com/apache/iceberg/issues/751#issuecomment-585286984","issue_url":"https://api.github.com/repos/apache/iceberg/issues/751","id":585286984,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTI4Njk4NA==","user":{"login":"waterlx","id":13976495,"node_id":"MDQ6VXNlcjEzOTc2NDk1","avatar_url":"https://avatars.githubusercontent.com/u/13976495?v=4","gravatar_id":"","url":"https://api.github.com/users/waterlx","html_url":"https://github.com/waterlx","followers_url":"https://api.github.com/users/waterlx/followers","following_url":"https://api.github.com/users/waterlx/following{/other_user}","gists_url":"https://api.github.com/users/waterlx/gists{/gist_id}","starred_url":"https://api.github.com/users/waterlx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/waterlx/subscriptions","organizations_url":"https://api.github.com/users/waterlx/orgs","repos_url":"https://api.github.com/users/waterlx/repos","events_url":"https://api.github.com/users/waterlx/events{/privacy}","received_events_url":"https://api.github.com/users/waterlx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-12T16:20:41Z","updated_at":"2020-02-12T16:20:41Z","author_association":"CONTRIBUTOR","body":"@rdblue got your idea. Thanks!\r\nI might need to check with you about the expected behavior of dropTable, especially when purge = false.\r\nCatalog # dropTable() defines the behavior to handle metadata and data when purge = true explicity, as \r\n```\r\n* @param purge if true, delete all metadata and data files in the table\r\n```\r\nBut what about purge = false? \r\n(1) keep both data and metadata\r\nor\r\n(2) keep data and delete metadata\r\n\r\n(1) is the current behavior of Iceberg. But is it the expected behavior? I might think that (2) is the correct behavior: When I am calling dropTable,  metadata is deleted for sure, while purge is used to determine if data files are deleted or not.\r\n\r\nCould you please share your idea about that? Thanks!\r\nI am trying to check the behavior of Spark or Hive regarding dropTable with purge = false.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585286984/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585294292","html_url":"https://github.com/apache/iceberg/pull/778#issuecomment-585294292","issue_url":"https://api.github.com/repos/apache/iceberg/issues/778","id":585294292,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTI5NDI5Mg==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-12T16:34:53Z","updated_at":"2020-02-12T17:33:28Z","author_association":"CONTRIBUTOR","body":">However, another approach can be to just store the timestamp forced to the UTC timezone as a \"Timestamp Instant\" so that ORC does not apply any offset calculations on it and let Iceberg handle the read to LocalDateTime (I believe this is what we do for Avro Generics today).\r\n\r\nI think  we should handle both `Timestamp` and `TimestampTz` on the  read side, since in the future Iceberg could support reading ORC data not written by Iceberg orc writers, so there could be data of `Timestamp` type on disc.\r\n\r\nWhen writing from Iceberg, I don't see a problem with always using the `TimestampTz` converter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585294292/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585307748","html_url":"https://github.com/apache/iceberg/pull/789#issuecomment-585307748","issue_url":"https://api.github.com/repos/apache/iceberg/issues/789","id":585307748,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTMwNzc0OA==","user":{"login":"vrozov","id":12200381,"node_id":"MDQ6VXNlcjEyMjAwMzgx","avatar_url":"https://avatars.githubusercontent.com/u/12200381?v=4","gravatar_id":"","url":"https://api.github.com/users/vrozov","html_url":"https://github.com/vrozov","followers_url":"https://api.github.com/users/vrozov/followers","following_url":"https://api.github.com/users/vrozov/following{/other_user}","gists_url":"https://api.github.com/users/vrozov/gists{/gist_id}","starred_url":"https://api.github.com/users/vrozov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vrozov/subscriptions","organizations_url":"https://api.github.com/users/vrozov/orgs","repos_url":"https://api.github.com/users/vrozov/repos","events_url":"https://api.github.com/users/vrozov/events{/privacy}","received_events_url":"https://api.github.com/users/vrozov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-12T17:00:51Z","updated_at":"2020-02-12T17:00:51Z","author_association":"MEMBER","body":"@jun-he I don't think that using `Suppliers.memoize()` avoids double locking, it makes it less explicit, moving double checked locking from `SnapshotProducer` to `MemoizingSupplier.get()` method. I don't think there is a way to completely avoid double locking with lazy initialization, but `synchronized` can be avoided with `AtomicLong.compareAndSet()` in case `snapshotId` can be initialized to an *invalid* value.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585307748/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585319156","html_url":"https://github.com/apache/iceberg/pull/789#issuecomment-585319156","issue_url":"https://api.github.com/repos/apache/iceberg/issues/789","id":585319156,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTMxOTE1Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-12T17:25:01Z","updated_at":"2020-02-12T17:25:01Z","author_association":"CONTRIBUTOR","body":"I think the current solution is a reasonable one. If we want to take the time to get rid of the synchronized block, then initializing this to a `final` field in the constructor is the right way to go.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585319156/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585319948","html_url":"https://github.com/apache/iceberg/pull/794#issuecomment-585319948","issue_url":"https://api.github.com/repos/apache/iceberg/issues/794","id":585319948,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTMxOTk0OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-12T17:26:45Z","updated_at":"2020-02-12T17:26:45Z","author_association":"CONTRIBUTOR","body":"Huge thanks, @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585319948/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585321090","html_url":"https://github.com/apache/iceberg/pull/793#issuecomment-585321090","issue_url":"https://api.github.com/repos/apache/iceberg/issues/793","id":585321090,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTMyMTA5MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-12T17:29:22Z","updated_at":"2020-02-12T17:29:22Z","author_association":"CONTRIBUTOR","body":"Looks like the Java test failure is caused by a new Java default version that isn't Java 8. Can we pin to Java 8 in the matrix?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/585321090/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]