[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/308374628","html_url":"https://github.com/apache/couchdb/issues/508#issuecomment-308374628","issue_url":"https://api.github.com/repos/apache/couchdb/issues/508","id":308374628,"node_id":"MDEyOklzc3VlQ29tbWVudDMwODM3NDYyOA==","user":{"login":"DCMay","id":5894868,"node_id":"MDQ6VXNlcjU4OTQ4Njg=","avatar_url":"https://avatars.githubusercontent.com/u/5894868?v=4","gravatar_id":"","url":"https://api.github.com/users/DCMay","html_url":"https://github.com/DCMay","followers_url":"https://api.github.com/users/DCMay/followers","following_url":"https://api.github.com/users/DCMay/following{/other_user}","gists_url":"https://api.github.com/users/DCMay/gists{/gist_id}","starred_url":"https://api.github.com/users/DCMay/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DCMay/subscriptions","organizations_url":"https://api.github.com/users/DCMay/orgs","repos_url":"https://api.github.com/users/DCMay/repos","events_url":"https://api.github.com/users/DCMay/events{/privacy}","received_events_url":"https://api.github.com/users/DCMay/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-14T09:20:40Z","updated_at":"2017-06-14T09:20:40Z","author_association":"NONE","body":"run the couchdb.cmd file as administrator manually. does not work for me. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/308374628/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/308475922","html_url":"https://github.com/apache/couchdb/issues/508#issuecomment-308475922","issue_url":"https://api.github.com/repos/apache/couchdb/issues/508","id":308475922,"node_id":"MDEyOklzc3VlQ29tbWVudDMwODQ3NTkyMg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-14T15:54:25Z","updated_at":"2017-06-14T15:54:25Z","author_association":"MEMBER","body":"@dcmay Did you try copying the pre-release version `nssm.exe` from [here](https://nssm.cc/download) over your existing `nssm.exe`? ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/308475922/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/308496244","html_url":"https://github.com/apache/couchdb/issues/508#issuecomment-308496244","issue_url":"https://api.github.com/repos/apache/couchdb/issues/508","id":308496244,"node_id":"MDEyOklzc3VlQ29tbWVudDMwODQ5NjI0NA==","user":{"login":"nueko","id":2134953,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIxMzQ5NTM=","avatar_url":"https://avatars.githubusercontent.com/u/2134953?v=4","gravatar_id":"","url":"https://api.github.com/users/nueko","html_url":"https://github.com/nueko","followers_url":"https://api.github.com/users/nueko/followers","following_url":"https://api.github.com/users/nueko/following{/other_user}","gists_url":"https://api.github.com/users/nueko/gists{/gist_id}","starred_url":"https://api.github.com/users/nueko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nueko/subscriptions","organizations_url":"https://api.github.com/users/nueko/orgs","repos_url":"https://api.github.com/users/nueko/repos","events_url":"https://api.github.com/users/nueko/events{/privacy}","received_events_url":"https://api.github.com/users/nueko/received_events","type":"Organization","user_view_type":"public","site_admin":false},"created_at":"2017-06-14T17:06:44Z","updated_at":"2017-06-14T17:08:11Z","author_association":"NONE","body":"@wohali I think @DCMay just run the `/CouchDB/bin/couchdb.cmd` directly.\r\nbut by doing that the `Command Prompt` will keep opening","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/308496244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/308547186","html_url":"https://github.com/apache/couchdb/pull/598#issuecomment-308547186","issue_url":"https://api.github.com/repos/apache/couchdb/issues/598","id":308547186,"node_id":"MDEyOklzc3VlQ29tbWVudDMwODU0NzE4Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-14T20:22:36Z","updated_at":"2017-06-14T20:22:36Z","author_association":"MEMBER","body":"+1 with the changes mentioned.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/308547186/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/308575740","html_url":"https://github.com/apache/couchdb/pull/595#issuecomment-308575740","issue_url":"https://api.github.com/repos/apache/couchdb/issues/595","id":308575740,"node_id":"MDEyOklzc3VlQ29tbWVudDMwODU3NTc0MA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-14T22:26:14Z","updated_at":"2017-06-14T22:27:21Z","author_association":"CONTRIBUTOR","body":"I think I lean more toward @eiri's idea of making it a 409. \r\n\r\nThe document itself is there it's just that the revision doesn't match. This is similar to updating a regular document (not an attachment) with an revision which doesn't match where we get a 409.\r\n\r\nNow if database is altogether missing then we do get a 404. But I think this is closer to the former than the later.\r\n\r\nAlso +1. Nice work!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/308575740/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/308764722","html_url":"https://github.com/apache/couchdb/pull/599#issuecomment-308764722","issue_url":"https://api.github.com/repos/apache/couchdb/issues/599","id":308764722,"node_id":"MDEyOklzc3VlQ29tbWVudDMwODc2NDcyMg==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-15T15:06:48Z","updated_at":"2017-06-15T15:06:48Z","author_association":"MEMBER","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/308764722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/308935154","html_url":"https://github.com/apache/couchdb/pull/595#issuecomment-308935154","issue_url":"https://api.github.com/repos/apache/couchdb/issues/595","id":308935154,"node_id":"MDEyOklzc3VlQ29tbWVudDMwODkzNTE1NA==","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-16T05:15:39Z","updated_at":"2017-06-16T05:15:39Z","author_association":"CONTRIBUTOR","body":"@eiri and @nickva I've updated this PR to return 409 instead of 404. If you are ok with this, can one of you merge this for me?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/308935154/reactions","total_count":3,"+1":2,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/308958132","html_url":"https://github.com/apache/couchdb/issues/535#issuecomment-308958132","issue_url":"https://api.github.com/repos/apache/couchdb/issues/535","id":308958132,"node_id":"MDEyOklzc3VlQ29tbWVudDMwODk1ODEzMg==","user":{"login":"noslon","id":809180,"node_id":"MDQ6VXNlcjgwOTE4MA==","avatar_url":"https://avatars.githubusercontent.com/u/809180?v=4","gravatar_id":"","url":"https://api.github.com/users/noslon","html_url":"https://github.com/noslon","followers_url":"https://api.github.com/users/noslon/followers","following_url":"https://api.github.com/users/noslon/following{/other_user}","gists_url":"https://api.github.com/users/noslon/gists{/gist_id}","starred_url":"https://api.github.com/users/noslon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/noslon/subscriptions","organizations_url":"https://api.github.com/users/noslon/orgs","repos_url":"https://api.github.com/users/noslon/repos","events_url":"https://api.github.com/users/noslon/events{/privacy}","received_events_url":"https://api.github.com/users/noslon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-16T07:47:10Z","updated_at":"2017-06-16T07:47:10Z","author_association":"NONE","body":"Have the same problem, can't run a Mango Query on the _users database.\r\n\r\n`{\r\n    \"error\": \"unknown_error\",\r\n    \"reason\": \"case_clause\",\r\n    \"ref\": 1948008234\r\n}`\r\n\r\nWhat is the current status of this issue?\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/308958132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309069233","html_url":"https://github.com/apache/couchdb/issues/535#issuecomment-309069233","issue_url":"https://api.github.com/repos/apache/couchdb/issues/535","id":309069233,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTA2OTIzMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-16T16:16:48Z","updated_at":"2017-06-16T16:16:48Z","author_association":"MEMBER","body":"Current status is the ticket is open and no one has picked it up yet.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309069233/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309078019","html_url":"https://github.com/apache/couchdb/pull/590#issuecomment-309078019","issue_url":"https://api.github.com/repos/apache/couchdb/issues/590","id":309078019,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTA3ODAxOQ==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-16T16:53:55Z","updated_at":"2017-06-16T16:53:55Z","author_association":"MEMBER","body":"So I've been pondering on this for a while and I don't see a good solution on how we can fix this race without altering the test.\r\n\r\nThe issue here is that when we are trying to confirm that handler got removed from `config_event` manager we are aiming in a pretty narrow gap between `config_listener`'s terminate and `couch_log_sup` spawning and registering new `config_listener_mon`.\r\n\r\nWe can ensure that we are not checking handlers before old listener dies, but we can't delay supervisor without mocking `couch_log_sup` to set delay in its `handle_config_terminate`.\r\nAnd mocking the very module we are testing doesn't seems right to me.\r\n\r\nSo I removed assertion on that short moment when handler is not in `config_event` and used it as a flag to wait on new listener to start. Then I've added assertion on that it is indeed a new listener and it is registered as the same handler id, which should be enough to confirm that listener's restart is working as expected.\r\n\r\n@davisp I believe you are the original author of this test. Do you think this change is acceptable and doesn't compromise integrity of the test?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309078019/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309082954","html_url":"https://github.com/apache/couchdb/issues/565#issuecomment-309082954","issue_url":"https://api.github.com/repos/apache/couchdb/issues/565","id":309082954,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTA4Mjk1NA==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-16T17:15:02Z","updated_at":"2017-06-16T17:15:02Z","author_association":"MEMBER","body":"Ok the problem here is not in a view, but in couch_server. During the test we are shutting down old db updater, swapping db file and then doing view query. In reality couch_server could be a bit slow on evicting old updater pid from its cache (as I found 5 ms is quite enough), so the query is getting old pid and naturally crashes with `noproc`.\r\n\r\nI've opened PR #600 to make sure we have new updater started.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309082954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309094611","html_url":"https://github.com/apache/couchdb/pull/600#issuecomment-309094611","issue_url":"https://api.github.com/repos/apache/couchdb/issues/600","id":309094611,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTA5NDYxMQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-16T18:03:21Z","updated_at":"2017-06-16T18:03:21Z","author_association":"CONTRIBUTOR","body":"```\r\n      couchdb_views_tests:backup_restore_test_/0\r\n======================== EUnit ========================\r\nUpgrade and bugs related tests\r\nApplication crypto was left running!\r\n  couchdb_views_tests:159: should_not_remember_docs_in_index_after_backup_restore...[0.150 s] ok\r\n[os_mon] cpu supervisor port (cpu_sup): Erlang has closed\r\n  [done in 0.282 s]\r\n=======================================================\r\n```\r\n+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309094611/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309104733","html_url":"https://github.com/apache/couchdb/pull/590#issuecomment-309104733","issue_url":"https://api.github.com/repos/apache/couchdb/issues/590","id":309104733,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTEwNDczMw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-16T18:45:18Z","updated_at":"2017-06-16T18:45:18Z","author_association":"MEMBER","body":"+1\r\n\r\nI didn't even remember writing this test so I went back to look at history. The reason this got all mixed up was the big config API changes that happened around the time I wrote this test. Originally it was its own gen_server which would wait 5s between reloads of the config listener but then we changed the config listener to be in the supervision tree which as you point out makes it quite the race. Looks like we hit that and then just changed the timeout without actually rethinking the test.\r\n\r\nYour changes to wait for the handler to exit, wait for a new one wiht the same id and a different pid I agree perform the same logical assertion that the restart is working.\r\n\r\nGood work on this!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309104733/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309127204","html_url":"https://github.com/apache/couchdb/issues/535#issuecomment-309127204","issue_url":"https://api.github.com/repos/apache/couchdb/issues/535","id":309127204,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTEyNzIwNA==","user":{"login":"noslon","id":809180,"node_id":"MDQ6VXNlcjgwOTE4MA==","avatar_url":"https://avatars.githubusercontent.com/u/809180?v=4","gravatar_id":"","url":"https://api.github.com/users/noslon","html_url":"https://github.com/noslon","followers_url":"https://api.github.com/users/noslon/followers","following_url":"https://api.github.com/users/noslon/following{/other_user}","gists_url":"https://api.github.com/users/noslon/gists{/gist_id}","starred_url":"https://api.github.com/users/noslon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/noslon/subscriptions","organizations_url":"https://api.github.com/users/noslon/orgs","repos_url":"https://api.github.com/users/noslon/repos","events_url":"https://api.github.com/users/noslon/events{/privacy}","received_events_url":"https://api.github.com/users/noslon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-16T20:32:16Z","updated_at":"2017-06-16T20:32:16Z","author_association":"NONE","body":"@wohali Okay thanks. Do you may know an alternative solution to find specific user data without a specific GET request to http://127.0.0.1:5984/_users/org.couchdb.user:USERNAME ?\r\n\r\nFor e.g. I have users which also have their email address in the document. If a user can't remember the password I would like to send them a new one. But for this I need to find the user with the provided email address, change the password and send it (via email) to the user. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309127204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309130687","html_url":"https://github.com/apache/couchdb/issues/535#issuecomment-309130687","issue_url":"https://api.github.com/repos/apache/couchdb/issues/535","id":309130687,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTEzMDY4Nw==","user":{"login":"mraygalaxy","id":966394,"node_id":"MDQ6VXNlcjk2NjM5NA==","avatar_url":"https://avatars.githubusercontent.com/u/966394?v=4","gravatar_id":"","url":"https://api.github.com/users/mraygalaxy","html_url":"https://github.com/mraygalaxy","followers_url":"https://api.github.com/users/mraygalaxy/followers","following_url":"https://api.github.com/users/mraygalaxy/following{/other_user}","gists_url":"https://api.github.com/users/mraygalaxy/gists{/gist_id}","starred_url":"https://api.github.com/users/mraygalaxy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mraygalaxy/subscriptions","organizations_url":"https://api.github.com/users/mraygalaxy/orgs","repos_url":"https://api.github.com/users/mraygalaxy/repos","events_url":"https://api.github.com/users/mraygalaxy/events{/privacy}","received_events_url":"https://api.github.com/users/mraygalaxy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-16T20:49:03Z","updated_at":"2017-06-16T20:49:03Z","author_association":"NONE","body":"I'm thinking about replicating the user database to a read-only copy database and performing the query that way.........\r\n\r\nThat should work right until someone picks up this ticket?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309130687/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309207845","html_url":"https://github.com/apache/couchdb/issues/535#issuecomment-309207845","issue_url":"https://api.github.com/repos/apache/couchdb/issues/535","id":309207845,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTIwNzg0NQ==","user":{"login":"noslon","id":809180,"node_id":"MDQ6VXNlcjgwOTE4MA==","avatar_url":"https://avatars.githubusercontent.com/u/809180?v=4","gravatar_id":"","url":"https://api.github.com/users/noslon","html_url":"https://github.com/noslon","followers_url":"https://api.github.com/users/noslon/followers","following_url":"https://api.github.com/users/noslon/following{/other_user}","gists_url":"https://api.github.com/users/noslon/gists{/gist_id}","starred_url":"https://api.github.com/users/noslon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/noslon/subscriptions","organizations_url":"https://api.github.com/users/noslon/orgs","repos_url":"https://api.github.com/users/noslon/repos","events_url":"https://api.github.com/users/noslon/events{/privacy}","received_events_url":"https://api.github.com/users/noslon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-17T10:48:57Z","updated_at":"2017-06-17T10:48:57Z","author_association":"NONE","body":"@hinesmr This could be a solution, I'll try that. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309207845/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309590031","html_url":"https://github.com/apache/couchdb/issues/602#issuecomment-309590031","issue_url":"https://api.github.com/repos/apache/couchdb/issues/602","id":309590031,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTU5MDAzMQ==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-19T22:21:10Z","updated_at":"2017-06-19T22:21:10Z","author_association":"MEMBER","body":"I'm wondering if we should allow the internal replicator to access security objects on shard replicas hosted by nodes in maintenance mode. That would have addressed the `no_majority` issue here and allowed for the security objects to be synced.\r\n\r\nWe don't see this issue in the \"typical\" case of an N=3 database hosted on a cluster with a single node in maintenance mode because we can still reach a quorum on the security object from the healthy copies, and the subsequent write request already \"punches through\" maintenance mode successfully.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309590031/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309708037","html_url":"https://github.com/apache/couchdb/issues/603#issuecomment-309708037","issue_url":"https://api.github.com/repos/apache/couchdb/issues/603","id":309708037,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTcwODAzNw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-20T10:09:27Z","updated_at":"2017-06-20T10:09:27Z","author_association":"MEMBER","body":"Hi there, can you please include an excerpt from `couch.log` showing what happens when the 500 is returned? Also, if possible, can you include the exact message returned to your client along with the 500, if any? Thanks.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309708037/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309758277","html_url":"https://github.com/apache/couchdb/issues/603#issuecomment-309758277","issue_url":"https://api.github.com/repos/apache/couchdb/issues/603","id":309758277,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTc1ODI3Nw==","user":{"login":"calonso","id":2392041,"node_id":"MDQ6VXNlcjIzOTIwNDE=","avatar_url":"https://avatars.githubusercontent.com/u/2392041?v=4","gravatar_id":"","url":"https://api.github.com/users/calonso","html_url":"https://github.com/calonso","followers_url":"https://api.github.com/users/calonso/followers","following_url":"https://api.github.com/users/calonso/following{/other_user}","gists_url":"https://api.github.com/users/calonso/gists{/gist_id}","starred_url":"https://api.github.com/users/calonso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calonso/subscriptions","organizations_url":"https://api.github.com/users/calonso/orgs","repos_url":"https://api.github.com/users/calonso/repos","events_url":"https://api.github.com/users/calonso/events{/privacy}","received_events_url":"https://api.github.com/users/calonso/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-20T13:46:04Z","updated_at":"2017-06-20T13:46:04Z","author_association":"NONE","body":"Sure!!\r\n\r\n```\r\n$ curl -X PUT \"http://admin:password@127.0.0.1:5984/newtestdb2\"\r\n{\"error\":\"error\",\"reason\":\"internal_server_error\"}\r\n```\r\nand the log, in debug mode\r\n```\r\n[debug] 2017-06-20T13:42:58.420676Z couchdb@couch-0.couchdb2 <0.18754.0> ac122995ef cache miss for admin\r\n[debug] 2017-06-20T13:42:58.421663Z couchdb@couch-0.couchdb2 <0.18754.0> ac122995ef no record of user admin\r\n[notice] 2017-06-20T13:42:58.564874Z couchdb@couch-0.couchdb2 <0.18754.0> ac122995ef 127.0.0.1:5984 127.0.0.1 undefined PUT /newtestdb2 500 ok 144\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309758277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309900359","html_url":"https://github.com/apache/couchdb/issues/604#issuecomment-309900359","issue_url":"https://api.github.com/repos/apache/couchdb/issues/604","id":309900359,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTkwMDM1OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-20T21:42:35Z","updated_at":"2017-06-20T21:42:35Z","author_association":"MEMBER","body":"This is not a bug.\r\n\r\nYou should be doing everything with CouchDB using port 5984. The only thing that should be done via port 5986 is cluster setup tasks as explicitly outlined in our documentation.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309900359/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309960949","html_url":"https://github.com/apache/couchdb/issues/604#issuecomment-309960949","issue_url":"https://api.github.com/repos/apache/couchdb/issues/604","id":309960949,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTk2MDk0OQ==","user":{"login":"inceptivetech","id":10934140,"node_id":"MDQ6VXNlcjEwOTM0MTQw","avatar_url":"https://avatars.githubusercontent.com/u/10934140?v=4","gravatar_id":"","url":"https://api.github.com/users/inceptivetech","html_url":"https://github.com/inceptivetech","followers_url":"https://api.github.com/users/inceptivetech/followers","following_url":"https://api.github.com/users/inceptivetech/following{/other_user}","gists_url":"https://api.github.com/users/inceptivetech/gists{/gist_id}","starred_url":"https://api.github.com/users/inceptivetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/inceptivetech/subscriptions","organizations_url":"https://api.github.com/users/inceptivetech/orgs","repos_url":"https://api.github.com/users/inceptivetech/repos","events_url":"https://api.github.com/users/inceptivetech/events{/privacy}","received_events_url":"https://api.github.com/users/inceptivetech/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-21T04:39:06Z","updated_at":"2017-06-21T04:39:06Z","author_association":"NONE","body":"Thanks for your response.\r\nHowever I tried following  API on 5984 \r\ncurl -X PUT http://admin:*****@localhost:5984/_users/org.couchdb.user:dan -H \"Accept: application/json\" -H \"Content-Type: application/json\" -d '{\"name\": \"dan\", \"password\": \"apple\", \"roles\": [], \"type\": \"user\"}'\r\n\r\nit results in below message\r\n{\"error\":\"not_found\",\"reason\":\"Database does not exist.\"}\r\n\r\nSame was working on port 5986. Not able to understand what is the issue with port 5984\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309960949/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309966323","html_url":"https://github.com/apache/couchdb/issues/604#issuecomment-309966323","issue_url":"https://api.github.com/repos/apache/couchdb/issues/604","id":309966323,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTk2NjMyMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-21T05:20:39Z","updated_at":"2017-06-21T05:20:39Z","author_association":"MEMBER","body":"You need to run *all* of your commands against port 5984. That error says your database was not created through the clustered interface.\r\n\r\nIf you are upgrading from couchdb 1.x you can migrate your database with these steps: http://docs.couchdb.org/en/latest/install/upgrading.html","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309966323/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309967254","html_url":"https://github.com/apache/couchdb/issues/604#issuecomment-309967254","issue_url":"https://api.github.com/repos/apache/couchdb/issues/604","id":309967254,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTk2NzI1NA==","user":{"login":"inceptivetech","id":10934140,"node_id":"MDQ6VXNlcjEwOTM0MTQw","avatar_url":"https://avatars.githubusercontent.com/u/10934140?v=4","gravatar_id":"","url":"https://api.github.com/users/inceptivetech","html_url":"https://github.com/inceptivetech","followers_url":"https://api.github.com/users/inceptivetech/followers","following_url":"https://api.github.com/users/inceptivetech/following{/other_user}","gists_url":"https://api.github.com/users/inceptivetech/gists{/gist_id}","starred_url":"https://api.github.com/users/inceptivetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/inceptivetech/subscriptions","organizations_url":"https://api.github.com/users/inceptivetech/orgs","repos_url":"https://api.github.com/users/inceptivetech/repos","events_url":"https://api.github.com/users/inceptivetech/events{/privacy}","received_events_url":"https://api.github.com/users/inceptivetech/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-21T05:27:30Z","updated_at":"2017-06-21T05:27:30Z","author_association":"NONE","body":"thanks again.\r\nIt was a fresh installation of couchdb 2.0.0, so there was no upgrade. I am using MAC, do you think re-installing couchdb will solve this problem.\r\n\r\nRegards,\r\nSuhas","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309967254/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309992456","html_url":"https://github.com/apache/couchdb/pull/582#issuecomment-309992456","issue_url":"https://api.github.com/repos/apache/couchdb/issues/582","id":309992456,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTk5MjQ1Ng==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-21T07:51:06Z","updated_at":"2017-06-21T07:51:06Z","author_association":"MEMBER","body":"@tonysun83 thanks for the review. I've made all the fixes you recommended","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/309992456/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310031163","html_url":"https://github.com/apache/couchdb/pull/605#issuecomment-310031163","issue_url":"https://api.github.com/repos/apache/couchdb/issues/605","id":310031163,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDAzMTE2Mw==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-21T10:00:10Z","updated_at":"2017-06-21T10:00:10Z","author_association":"MEMBER","body":"forgot to add, the structure of the change looks good to me. My comments are mainly about configurability. I like the use of a custom header to modify the response, rather than a query parameter. The recommendation these days is _not_ to add `X-` but there's so much precedence in CouchDB that it might be weird not to always have it. I do think the request header, and its permitted values, are a bit wordy at the same time as being a bit unclear. Perhaps if the filtering were controlled by config this problem goes away.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310031163/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310066795","html_url":"https://github.com/apache/couchdb/pull/605#issuecomment-310066795","issue_url":"https://api.github.com/repos/apache/couchdb/issues/605","id":310066795,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDA2Njc5NQ==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-21T12:44:02Z","updated_at":"2017-06-21T12:44:02Z","author_association":"MEMBER","body":"Thanks @rnewson I've changed it to support using a config setting.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310066795/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310126529","html_url":"https://github.com/apache/couchdb/issues/603#issuecomment-310126529","issue_url":"https://api.github.com/repos/apache/couchdb/issues/603","id":310126529,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDEyNjUyOQ==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-21T16:03:28Z","updated_at":"2017-06-21T16:03:28Z","author_association":"MEMBER","body":"This one is a bit tricky. We are throwing `internal_server_error` here when the writers quorum not met, but we can only know that after the fact, i.e. after we created db on all available nodes and didn't get enough replies from the writers.\r\n\r\nThe database is available after that, we can add docs to it and it'll be replicated to the rest of the nodes when they get up, so strictly speaking this is not a complete failure. But at the same time we want to have some kind of warning that the cluster is unstable, after all, if we'll get available nodes down and previously unavailable nodes up at the same time the database will as if suddenly disappear.\r\n\r\nI guess we can add a check for the nodes availability on db creation/deletion before starting operations and throw 412 there if we know we wouldn't have the quorum. It wouldn't solve the issue completely, the nodes could go down _during_ db creation, but at least it'll narrow the confusion gap. @davisp what do you think? Is it worth of try to implement?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310126529/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310155985","html_url":"https://github.com/apache/couchdb/issues/551#issuecomment-310155985","issue_url":"https://api.github.com/repos/apache/couchdb/issues/551","id":310155985,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDE1NTk4NQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-21T17:51:48Z","updated_at":"2017-06-21T17:51:48Z","author_association":"CONTRIBUTOR","body":"Got a traceback from a Jenkins Docker CentOS 7 test runner:\r\n\r\n```\r\n(gdb) bt\r\n#0  0x00007f35fcb924ef in js::NewBuiltinClassInstance(JSContext*, js::Class*, js::gc::FinalizeKind) ()\r\n   from /lib/libmozjs185.so.1.0\r\n#1  0x00007f35fcb93650 in js_ValueToNonNullObject(JSContext*, js::Value const&) ()\r\n   from /lib/libmozjs185.so.1.0\r\n#2  0x00007f35fcca7304 in js::mjit::stubs::GetElem(js::VMFrame&) () from /lib/libmozjs185.so.1.0\r\n#3  0x00007f35fcd0a07c in js::mjit::ic::GetElement(js::VMFrame&, js::mjit::ic::GetElementIC*) ()\r\n   from /lib/libmozjs185.so.1.0\r\n#4  0x00007f35fd1bef05 in ?? ()\r\n#5  0x000000004de2894d in ?? ()\r\n#6  0x00007f35f7670340 in ?? ()\r\n#7  0x0000000100000000 in ?? ()\r\n#8  0x0000000000000001 in ?? ()\r\n#9  0x00007f35fc527640 in ?? () from /lib64/libc.so.6\r\n#10 0x00007f35f76703b8 in ?? ()\r\n#11 0x00000000020bd302 in ?? ()\r\n#12 0x00007f35f7670340 in ?? ()\r\n#13 0x00000000020bd303 in ?? ()\r\n#14 0x00007f35f7670340 in ?? ()\r\n#15 0x0000000001fd0aa0 in ?? ()\r\n#16 0x00007f35f771a168 in ?? ()\r\n#17 0x00007f35f7670228 in ?? ()\r\n#18 0x0000000001fd0aa0 in ?? ()\r\n#19 0x0000000001fd0aa0 in ?? ()\r\n#20 0x00007f35f7a70000 in ?? ()\r\n#21 0x000000000000ffff in ?? ()\r\n#22 0x00007ffd4b6fac70 in ?? ()\r\n#23 0x00007f35f7670228 in ?? ()\r\n#24 0x00007f35fcca3bd6 in js::mjit::JaegerShotAtSafePoint(JSContext*, void*) () from /lib/libmozjs185.so.1.0\r\n#25 0x00007f35fcb6dc88 in js::Interpret(JSContext*, JSStackFrame*, unsigned int, JSInterpMode) ()\r\n   from /lib/libmozjs185.so.1.0\r\n#26 0x00007f35fcb6f4a5 in js::RunScript(JSContext*, JSScript*, JSStackFrame*) () from /lib/libmozjs185.so.1.0\r\n#27 0x00007f35fcb7022c in js::Execute(JSContext*, JSObject*, JSScript*, JSStackFrame*, unsigned int, js::Value*) () from /lib/libmozjs185.so.1.0\r\n#28 0x00007f35fcae3348 in JS_ExecuteScript () from /lib/libmozjs185.so.1.0\r\n#29 0x0000000000404c8a in main (argc=4, argv=0x7ffd4b6faf98) at priv/couch_js/main.c:470\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310155985/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310158370","html_url":"https://github.com/apache/couchdb/issues/603#issuecomment-310158370","issue_url":"https://api.github.com/repos/apache/couchdb/issues/603","id":310158370,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDE1ODM3MA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-21T18:00:25Z","updated_at":"2017-06-21T18:00:25Z","author_association":"MEMBER","body":"Assuming the db record gets written on one node then we should return a 202 Accepted as the dbs db will be replicated and at that point we'll have created the database.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310158370/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310168331","html_url":"https://github.com/apache/couchdb/issues/601#issuecomment-310168331","issue_url":"https://api.github.com/repos/apache/couchdb/issues/601","id":310168331,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDE2ODMzMQ==","user":{"login":"Aaron-Zhao","id":4712808,"node_id":"MDQ6VXNlcjQ3MTI4MDg=","avatar_url":"https://avatars.githubusercontent.com/u/4712808?v=4","gravatar_id":"","url":"https://api.github.com/users/Aaron-Zhao","html_url":"https://github.com/Aaron-Zhao","followers_url":"https://api.github.com/users/Aaron-Zhao/followers","following_url":"https://api.github.com/users/Aaron-Zhao/following{/other_user}","gists_url":"https://api.github.com/users/Aaron-Zhao/gists{/gist_id}","starred_url":"https://api.github.com/users/Aaron-Zhao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Aaron-Zhao/subscriptions","organizations_url":"https://api.github.com/users/Aaron-Zhao/orgs","repos_url":"https://api.github.com/users/Aaron-Zhao/repos","events_url":"https://api.github.com/users/Aaron-Zhao/events{/privacy}","received_events_url":"https://api.github.com/users/Aaron-Zhao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-21T18:38:44Z","updated_at":"2017-06-21T18:47:30Z","author_association":"NONE","body":"This has something to do with my server setting rather than CouchDB. My server has a limit on client max body size.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310168331/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310181702","html_url":"https://github.com/apache/couchdb/issues/604#issuecomment-310181702","issue_url":"https://api.github.com/repos/apache/couchdb/issues/604","id":310181702,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDE4MTcwMg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-21T19:31:21Z","updated_at":"2017-06-21T19:31:21Z","author_association":"MEMBER","body":"No need to reinstall. Just start over with:\r\n\r\n`curl -X PUT http://localhost:5984/eventdb`\r\n\r\nto create your database first.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310181702/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310241311","html_url":"https://github.com/apache/couchdb/issues/604#issuecomment-310241311","issue_url":"https://api.github.com/repos/apache/couchdb/issues/604","id":310241311,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDI0MTMxMQ==","user":{"login":"inceptivetech","id":10934140,"node_id":"MDQ6VXNlcjEwOTM0MTQw","avatar_url":"https://avatars.githubusercontent.com/u/10934140?v=4","gravatar_id":"","url":"https://api.github.com/users/inceptivetech","html_url":"https://github.com/inceptivetech","followers_url":"https://api.github.com/users/inceptivetech/followers","following_url":"https://api.github.com/users/inceptivetech/following{/other_user}","gists_url":"https://api.github.com/users/inceptivetech/gists{/gist_id}","starred_url":"https://api.github.com/users/inceptivetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/inceptivetech/subscriptions","organizations_url":"https://api.github.com/users/inceptivetech/orgs","repos_url":"https://api.github.com/users/inceptivetech/repos","events_url":"https://api.github.com/users/inceptivetech/events{/privacy}","received_events_url":"https://api.github.com/users/inceptivetech/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-22T00:25:56Z","updated_at":"2017-06-22T00:25:56Z","author_association":"NONE","body":"Thank you.\r\n\r\nStarted over, deleted eventdb and recreated one, however same issue exists. Added _security document to eventdb and assign an user to it and when tried\r\ncurl -u fan:apple http://localhost:5984/eventdb\r\n\r\nit results in \r\n\r\n{\"error\":\"unauthorized\",\"reason\":\"Name or password is incorrect.\"}","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310241311/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310256488","html_url":"https://github.com/apache/couchdb/issues/607#issuecomment-310256488","issue_url":"https://api.github.com/repos/apache/couchdb/issues/607","id":310256488,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDI1NjQ4OA==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-22T02:16:02Z","updated_at":"2017-06-22T02:16:02Z","author_association":"MEMBER","body":"Well, that's a gnarly one!\r\n\r\nI stared at this for a while this evening and could not quite suss out what's going wrong. I did go back and track down L343 from chttpd as of 2.0.0:\r\n\r\nhttps://github.com/apache/couchdb-chttpd/blob/2c1f3a3/src/chttpd.erl#L343\r\n\r\nA subtle point that might help future debuggers: the `undef` error with `<<\"lacc:get/2\">>` as the first element in the stacktrace is caused by trying to execute the `get` function supplying a `#lacc{}` record (an internal data structure defined by `couch_mrview` and used in list processing) instead of the mochiweb_response parameterized module that is supposed to be bound to `Resp`. Next step is to figure out how we get a final response of the form `{ok, #lacc{}}` from the list processor.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310256488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310256543","html_url":"https://github.com/apache/couchdb/issues/604#issuecomment-310256543","issue_url":"https://api.github.com/repos/apache/couchdb/issues/604","id":310256543,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDI1NjU0Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-22T02:16:32Z","updated_at":"2017-06-22T02:16:32Z","author_association":"MEMBER","body":"Can you paste the _entire_ set of things that you try? Is your user:password that you show there a CouchDB admin (listed in `[admins]` section of `local.ini`?)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310256543/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310275742","html_url":"https://github.com/apache/couchdb/issues/604#issuecomment-310275742","issue_url":"https://api.github.com/repos/apache/couchdb/issues/604","id":310275742,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDI3NTc0Mg==","user":{"login":"inceptivetech","id":10934140,"node_id":"MDQ6VXNlcjEwOTM0MTQw","avatar_url":"https://avatars.githubusercontent.com/u/10934140?v=4","gravatar_id":"","url":"https://api.github.com/users/inceptivetech","html_url":"https://github.com/inceptivetech","followers_url":"https://api.github.com/users/inceptivetech/followers","following_url":"https://api.github.com/users/inceptivetech/following{/other_user}","gists_url":"https://api.github.com/users/inceptivetech/gists{/gist_id}","starred_url":"https://api.github.com/users/inceptivetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/inceptivetech/subscriptions","organizations_url":"https://api.github.com/users/inceptivetech/orgs","repos_url":"https://api.github.com/users/inceptivetech/repos","events_url":"https://api.github.com/users/inceptivetech/events{/privacy}","received_events_url":"https://api.github.com/users/inceptivetech/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-22T04:59:27Z","updated_at":"2017-06-22T04:59:27Z","author_association":"NONE","body":"Hi,\r\nObjective : is to create an user which will be in _users collection and then provide eventdb member access to the user.\r\n\r\nthings I tried out \r\n1. For adding user\r\n\r\ncurl -X PUT http://admin:*****@localhost:5984/_users/org.couchdb.user:dan -H \"Accept: application/json\" -H \"Content-Type: application/json\" -d '{\"name\": \"dan\", \"password\": \"apple\", \"roles\": [], \"type\": \"user\"}'\r\n\r\nwhich results in below message \r\n{\"error\":\"not_found\",\"reason\":\"Database does not exist.\"}\r\n\r\nI searched on google for this error and come to know that system collection like _users are moved to port 5986 hence I fired below api\r\n\r\ncurl -X PUT http://admin:*****@localhost:5986/_users/org.couchdb.user:dan -H \"Accept: application/json\" -H \"Content-Type: application/json\" -d '{\"name\": \"dan\", \"password\": \"apple\", \"roles\": [], \"type\": \"user\"}'\r\nI was able to create an user. (please note port number 5986)\r\n\r\n2. Provide eventdb member access to dan\r\n\r\nI executed below command to provide an access\r\ncurl -X PUT http://localhost:5984/eventdb/_security -u admin:***** -H \"Content-Type: application/json\" -d '{\"admins\": { \"names\": [], \"roles\": [] }, \"members\": { \"names\": [\"dan\"], \"roles\": [] } }'\r\nwhich returns below result for me\r\n\r\n{\"ok\":true}\r\n3. Accessing eventdb using dan's credential\r\n\r\ncurl -u dan:apple http://localhost:5984/eventdb\r\n\r\nit results in\r\n{\"error\":\"unauthorized\",\"reason\":\"Name or password is incorrect.\"}\r\n\r\nI was following documentation at http://docs.couchdb.org/en/2.0.0/intro/security.html\r\n\r\nthanks for your help.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310275742/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310283535","html_url":"https://github.com/apache/couchdb/pull/582#issuecomment-310283535","issue_url":"https://api.github.com/repos/apache/couchdb/issues/582","id":310283535,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDI4MzUzNQ==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-22T05:58:11Z","updated_at":"2017-06-22T05:58:11Z","author_association":"CONTRIBUTOR","body":"+1 after squash","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310283535/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310296365","html_url":"https://github.com/apache/couchdb/issues/604#issuecomment-310296365","issue_url":"https://api.github.com/repos/apache/couchdb/issues/604","id":310296365,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDI5NjM2NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-22T07:14:25Z","updated_at":"2017-06-22T07:14:25Z","author_association":"MEMBER","body":"Your step 1 talking to port 5986 to create a user is wrong - you got bad advice.\r\n\r\nYou need to first create the `_users` database on port 5984 as outlined in our setup documentation: http://docs.couchdb.org/en/latest/install/setup.html#single-node-setup\r\n\r\nOnce you have created the `_users` database through port 5984, repeat your step 1 to create your user on port 5984.\r\n\r\nThen everything else should work normally.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310296365/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310328972","html_url":"https://github.com/apache/couchdb/issues/604#issuecomment-310328972","issue_url":"https://api.github.com/repos/apache/couchdb/issues/604","id":310328972,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDMyODk3Mg==","user":{"login":"inceptivetech","id":10934140,"node_id":"MDQ6VXNlcjEwOTM0MTQw","avatar_url":"https://avatars.githubusercontent.com/u/10934140?v=4","gravatar_id":"","url":"https://api.github.com/users/inceptivetech","html_url":"https://github.com/inceptivetech","followers_url":"https://api.github.com/users/inceptivetech/followers","following_url":"https://api.github.com/users/inceptivetech/following{/other_user}","gists_url":"https://api.github.com/users/inceptivetech/gists{/gist_id}","starred_url":"https://api.github.com/users/inceptivetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/inceptivetech/subscriptions","organizations_url":"https://api.github.com/users/inceptivetech/orgs","repos_url":"https://api.github.com/users/inceptivetech/repos","events_url":"https://api.github.com/users/inceptivetech/events{/privacy}","received_events_url":"https://api.github.com/users/inceptivetech/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-22T09:34:41Z","updated_at":"2017-06-22T09:34:41Z","author_association":"NONE","body":"Ooooo\r\nthanks for your help. I should have contacted you first. Any way thanks again. Much appreciated.\r\n\r\nRegards,\r\nSuhas","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310328972/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":2,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310432762","html_url":"https://github.com/apache/couchdb/issues/607#issuecomment-310432762","issue_url":"https://api.github.com/repos/apache/couchdb/issues/607","id":310432762,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDQzMjc2Mg==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-22T16:29:08Z","updated_at":"2017-06-22T16:41:10Z","author_association":"MEMBER","body":"@natevw one question for you -- when you invoke `getRow()` the second time, is the response `null`? The general pattern that I see for these list functions is a `while(getRow())` sort of thing, and it does look like there is some special logic that fires on the last invocation that returns null. Specifically, this happens when the database sends the `list_end` message, and there's definitely logic in that part of the code that transforms a `#lacc{}` into a proper mochiweb response.\r\n\r\nIt does look like we support \"short-circuit\" evaluation where your list function exits before getting to that last null response, but it's a different code path and so there could be some mistake there. I do find it interesting that this only crops up when you come in via a rewrite; I'm going to try to track that down now.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310432762/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310439222","html_url":"https://github.com/apache/couchdb/issues/607#issuecomment-310439222","issue_url":"https://api.github.com/repos/apache/couchdb/issues/607","id":310439222,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDQzOTIyMg==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-22T16:53:58Z","updated_at":"2017-06-22T16:53:58Z","author_association":"MEMBER","body":"Hah, well _this_ looks relevant:\r\n\r\nhttps://github.com/apache/couchdb-couch-mrview/commit/56616fad9b\r\n\r\nThis fix by @sagelywizard landed after we cut 2.0.0. @natevw do you have any opportunity to try a build off of master? I still don't know why you only see this on a rewrite, but I'd be willing to bet we have already fixed this bug :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310439222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310460143","html_url":"https://github.com/apache/couchdb/issues/548#issuecomment-310460143","issue_url":"https://api.github.com/repos/apache/couchdb/issues/548","id":310460143,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDQ2MDE0Mw==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-22T18:14:57Z","updated_at":"2017-06-22T18:14:57Z","author_association":"MEMBER","body":"I thought that perhaps with the work in #576 and #577 this might be resolved, but now I think we may have just morphed to an `{'EXIT',normal}` error. I've seen this twice in 10 runs locally.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310460143/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310491549","html_url":"https://github.com/apache/couchdb/issues/548#issuecomment-310491549","issue_url":"https://api.github.com/repos/apache/couchdb/issues/548","id":310491549,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDQ5MTU0OQ==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-22T20:20:55Z","updated_at":"2017-06-22T20:20:55Z","author_association":"MEMBER","body":"I think I know what's happening here. Every `db.query()` invocation in this test creates a ddoc with a random name, queries the view, and then deletes the ddoc. In many cases we have consecutive invocations where the ddocs have the same computed signature. It looks like we're hitting a race condition where we request to delete a ddoc, the server starts closing all the associated indexes, we create a new one with the same sig, the coordinator grabs an Fd from the cache with that sig, and the Fd is closed underneath it during the response.\r\n\r\nI tested this theory by adding a random string to each view, and so far I've looped through 40 consecutive runs without a failure. That's of course not fixing the real race condition, but if we can't track down the race condition in short order it might be a useful hack to stop the flakiness. It wouldn't be the first time, and this is not really a bug you'd expect to encounter in production ...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310491549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310504265","html_url":"https://github.com/apache/couchdb/issues/548#issuecomment-310504265","issue_url":"https://api.github.com/repos/apache/couchdb/issues/548","id":310504265,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDUwNDI2NQ==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-22T21:13:21Z","updated_at":"2017-06-22T21:13:21Z","author_association":"MEMBER","body":"@eiri I'm curious about your thoughts on this. You were poking at some of the same issues in #576 but I think that didn't totally address the race condition. There's a gap in between retrieving the index Pid from the `?BY_SIG` ets table and then monitoring the underlying `#mrst.fd`. You've introduced the retry logic to get the index state, but all the while I think the underlying Fd could be unmonitored.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310504265/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310508091","html_url":"https://github.com/apache/couchdb/issues/548#issuecomment-310508091","issue_url":"https://api.github.com/repos/apache/couchdb/issues/548","id":310508091,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDUwODA5MQ==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-22T21:29:42Z","updated_at":"2017-06-22T21:29:42Z","author_association":"MEMBER","body":"@kocolosk yes, we've discussed this on IRC before I did the patches and came to the same conclusion - this is a race happening because of rapid create\\delete cycle on views with same signature. The delay logic I did not solving the race, naturally, but we've decided that we don't really want to encourage this anti-pattern and this fix should be enough for javascript test suite because of its single-thread nature.\r\n\r\nI'm kind of curious how you running the tests to get the errors you are seeing, because to be honest I have hard time to fail javascript test suite locally even on VM with restricted resources.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310508091/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310508601","html_url":"https://github.com/apache/couchdb/issues/548#issuecomment-310508601","issue_url":"https://api.github.com/repos/apache/couchdb/issues/548","id":310508601,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDUwODYwMQ==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-22T21:32:02Z","updated_at":"2017-06-22T21:32:02Z","author_association":"MEMBER","body":"Hmm, I didn't need to do anything special -- just ran it in a bash loop and it would fail within the first 10 runs.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310508601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310522661","html_url":"https://github.com/apache/couchdb/issues/607#issuecomment-310522661","issue_url":"https://api.github.com/repos/apache/couchdb/issues/607","id":310522661,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDUyMjY2MQ==","user":{"login":"natevw","id":265902,"node_id":"MDQ6VXNlcjI2NTkwMg==","avatar_url":"https://avatars.githubusercontent.com/u/265902?v=4","gravatar_id":"","url":"https://api.github.com/users/natevw","html_url":"https://github.com/natevw","followers_url":"https://api.github.com/users/natevw/followers","following_url":"https://api.github.com/users/natevw/following{/other_user}","gists_url":"https://api.github.com/users/natevw/gists{/gist_id}","starred_url":"https://api.github.com/users/natevw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/natevw/subscriptions","organizations_url":"https://api.github.com/users/natevw/orgs","repos_url":"https://api.github.com/users/natevw/repos","events_url":"https://api.github.com/users/natevw/events{/privacy}","received_events_url":"https://api.github.com/users/natevw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-22T22:43:25Z","updated_at":"2017-06-22T22:43:25Z","author_association":"NONE","body":"I just made a build from this repo instead of the 2.0.0 release, and removed my workaround: I no longer encounter this problem. So I think this indeed already fixed. Thanks Adam for your quick detective work here!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310522661/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310541660","html_url":"https://github.com/apache/couchdb/issues/548#issuecomment-310541660","issue_url":"https://api.github.com/repos/apache/couchdb/issues/548","id":310541660,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDU0MTY2MA==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-23T00:59:14Z","updated_at":"2017-06-23T00:59:14Z","author_association":"MEMBER","body":"The more I dig the more I think this is a non-trivial race condition. I'd recommend that we file a separate ticket explicitly focused on addressing the race condition, including an easily-reproducible test case (should be straightforward in a multi-threaded environment), and then tweak the JS one to avoid the view signature optimization so it can focus on what it was originally designed to test.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310541660/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310663728","html_url":"https://github.com/apache/couchdb/issues/611#issuecomment-310663728","issue_url":"https://api.github.com/repos/apache/couchdb/issues/611","id":310663728,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDY2MzcyOA==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-23T13:21:47Z","updated_at":"2017-06-23T13:21:47Z","author_association":"MEMBER","body":"For what it's worth this seems to be a problem with your spider monkey installation, rather than with couch itself, it is technically possible to compile it with erlang 20\r\n\r\n```bash\r\nvagrant@sandbox:/tmp$ kerl active\r\nThe current active installation is:\r\n/opt/erlang/20.0\r\n\r\nvagrant@sandbox:/tmp$ git clone https://github.com/apache/couchdb.git\r\nCloning into 'couchdb'...\r\nremote: Counting objects: 67715, done.\r\n...\r\n\r\nvagrant@sandbox:/tmp$ cd couchdb/\r\nvagrant@sandbox:/tmp/couchdb (master)$ \r\n\r\nvagrant@sandbox:/tmp/couchdb (master)$ ./configure --disable-fauxton --disable-docs\r\n==> configuring couchdb in rel/couchdb.config\r\nCloning into '/tmp/couchdb/src/rebar'...\r\nremote: Counting objects: 367, done.\r\n...\r\nUpdating bear from {git,\"https://github.com/apache/couchdb-bear.git\",\r\n                        \"008f48aff819126e281d5ccae80a258bf9bf9c30\"}\r\nYou have configured Apache CouchDB, time to relax. Relax.\r\n\r\nvagrant@sandbox:/tmp/couchdb (master)$ vi rebar.config.script\r\n## add 20 to require_otp_vsn\r\n\r\nvagrant@sandbox:/tmp/couchdb (master)$ vi src/snappy/rebar.config\r\n## add 20 to require_otp_vsn\r\n\r\n$ make\r\n==> config (compile)\r\nCompiled src/config_sup.erl\r\nCompiled src/config_app.erl\r\n...\r\nCompiled src/rexi_sup.erl\r\nCompiled src/rexi.erl\r\n==> rel (compile)\r\n==> couchdb (compile)\r\n``` \r\n\r\nThat said erlang 20 hasn't been tested and not recommended for use, hence it's not in `require_otp_vsn`.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310663728/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310664804","html_url":"https://github.com/apache/couchdb/issues/611#issuecomment-310664804","issue_url":"https://api.github.com/repos/apache/couchdb/issues/611","id":310664804,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDY2NDgwNA==","user":{"login":"goncalotomas","id":11529216,"node_id":"MDQ6VXNlcjExNTI5MjE2","avatar_url":"https://avatars.githubusercontent.com/u/11529216?v=4","gravatar_id":"","url":"https://api.github.com/users/goncalotomas","html_url":"https://github.com/goncalotomas","followers_url":"https://api.github.com/users/goncalotomas/followers","following_url":"https://api.github.com/users/goncalotomas/following{/other_user}","gists_url":"https://api.github.com/users/goncalotomas/gists{/gist_id}","starred_url":"https://api.github.com/users/goncalotomas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/goncalotomas/subscriptions","organizations_url":"https://api.github.com/users/goncalotomas/orgs","repos_url":"https://api.github.com/users/goncalotomas/repos","events_url":"https://api.github.com/users/goncalotomas/events{/privacy}","received_events_url":"https://api.github.com/users/goncalotomas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-23T13:26:42Z","updated_at":"2017-06-23T13:26:42Z","author_association":"NONE","body":"I did not use the `--disable-fauxton --disable-docs` options. I'm guessing from your response it has no effect on the outcome, is that right?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310664804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310665818","html_url":"https://github.com/apache/couchdb/issues/611#issuecomment-310665818","issue_url":"https://api.github.com/repos/apache/couchdb/issues/611","id":310665818,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDY2NTgxOA==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-23T13:31:04Z","updated_at":"2017-06-23T13:31:04Z","author_association":"MEMBER","body":"yes, this is only to speed up things, both docs build tools and fauxton not depend or use erlang.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310665818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310669825","html_url":"https://github.com/apache/couchdb/issues/611#issuecomment-310669825","issue_url":"https://api.github.com/repos/apache/couchdb/issues/611","id":310669825,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDY2OTgyNQ==","user":{"login":"goncalotomas","id":11529216,"node_id":"MDQ6VXNlcjExNTI5MjE2","avatar_url":"https://avatars.githubusercontent.com/u/11529216?v=4","gravatar_id":"","url":"https://api.github.com/users/goncalotomas","html_url":"https://github.com/goncalotomas","followers_url":"https://api.github.com/users/goncalotomas/followers","following_url":"https://api.github.com/users/goncalotomas/following{/other_user}","gists_url":"https://api.github.com/users/goncalotomas/gists{/gist_id}","starred_url":"https://api.github.com/users/goncalotomas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/goncalotomas/subscriptions","organizations_url":"https://api.github.com/users/goncalotomas/orgs","repos_url":"https://api.github.com/users/goncalotomas/repos","events_url":"https://api.github.com/users/goncalotomas/events{/privacy}","received_events_url":"https://api.github.com/users/goncalotomas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-23T13:47:15Z","updated_at":"2017-06-23T13:47:15Z","author_association":"NONE","body":"> this seems to be a problem with your spider monkey installation\r\n\r\nThat explains it, I don't have spider monkey installed (I didn't know about the dependency).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310669825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310684280","html_url":"https://github.com/apache/couchdb/issues/551#issuecomment-310684280","issue_url":"https://api.github.com/repos/apache/couchdb/issues/551","id":310684280,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDY4NDI4MA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-23T14:43:14Z","updated_at":"2017-06-23T20:11:41Z","author_association":"CONTRIBUTOR","body":"Found a deterministic instance of a segfault.\r\n\r\nApparently this bit\r\n```\r\n[\"reset\",{\"reduce_limit\":true,\"timeout\":5000}]\r\n[\"add_fun\",\"function(doc) }{\"]\r\n```\r\nSegfaults in `ubuntu12erlang183` docker image when running on Ubuntu 17.04 host. \r\n\r\nHaven't tried others. The same input is expected to generate an exception about an invalid function, and it does so for example in the `centos7erlang18` docker image running on the same host.\r\n\r\nIt obviously doesn't always segfault because it runs as part of a test suite and it doesn't always crash in `ubuntu12erlang183`, sometimes it passes.  It could be just my specific host / docker running combination triggered it.\r\n\r\n```\r\n(gdb) run\r\nStarting program: /usr/src/couchdb/apache-couchdb-2.1.0-2f539e0/bin/couchjs /usr/src/couchdb/apache-couchdb-2.1.0-2f539e0/share/server/main.js < bad.in\r\nwarning: no loadable sections found in added symbol-file system-supplied DSO at 0x7ffff7ffa000\r\n[Thread debugging using libthread_db enabled]\r\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\r\n[New Thread 0x7ffff1af3700 (LWP 20)]\r\ntrue\r\nProgram received signal SIGSEGV, Segmentation fault.\r\n0x00007ffff79508a4 in ?? () from /usr/lib/libmozjs185.so.1.0\r\n(gdb) bt\r\n#0  0x00007ffff79508a4 in ?? () from /usr/lib/libmozjs185.so.1.0\r\n#1  0x00007ffff78c1603 in JS_TypeOfValue () from /usr/lib/libmozjs185.so.1.0\r\n#2  0x00007ffff793baf5 in ?? () from /usr/lib/libmozjs185.so.1.0\r\n#3  0x00007ffff794e285 in ?? () from /usr/lib/libmozjs185.so.1.0\r\n#4  0x00007ffff794e722 in ?? () from /usr/lib/libmozjs185.so.1.0\r\n#5  0x00007ffff7920791 in ?? () from /usr/lib/libmozjs185.so.1.0\r\n#6  0x00007ffff7944b46 in ?? () from /usr/lib/libmozjs185.so.1.0\r\n#7  0x00007ffff794e285 in ?? () from /usr/lib/libmozjs185.so.1.0\r\n#8  0x00007ffff794fdc5 in ?? () from /usr/lib/libmozjs185.so.1.0\r\n#9  0x00007ffff78c73aa in JS_ExecuteScript () from /usr/lib/libmozjs185.so.1.0\r\n#10 0x0000000000404e71 in main (argc=2, argv=0x7fffffffe728) at priv/couch_js/main.c:470\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310684280/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310723936","html_url":"https://github.com/apache/couchdb/pull/610#issuecomment-310723936","issue_url":"https://api.github.com/repos/apache/couchdb/issues/610","id":310723936,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDcyMzkzNg==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-23T17:18:53Z","updated_at":"2017-06-23T17:18:53Z","author_association":"MEMBER","body":"Refreshing my memory on the mem3 PR I can definitely apply a lot of that to this as well so I'll update things for that.\r\n\r\nFor the accessed messages there's not a lot I think we can do there with the existing structure. Although I could see changing things around a bit to make it a LFU cache instead of an LRU cache. It'd involve a table scan to evict but would remove a lot of the message passing to ddoc_cache_lru and friends. I'll make the mem3 inspired changes first and then will look at this approach.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310723936/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310724903","html_url":"https://github.com/apache/couchdb/pull/606#issuecomment-310724903","issue_url":"https://api.github.com/repos/apache/couchdb/issues/606","id":310724903,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDcyNDkwMw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-23T17:23:24Z","updated_at":"2017-06-23T17:23:24Z","author_association":"MEMBER","body":"Not sure what your test was there, but that's a pretty big red flag that the external sizes don't match between different compression algorithms as it should not be affected by that. You also probably want to do a pre/post compaction measurement as well to make sure compaction isn't affecting it either.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310724903/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310739835","html_url":"https://github.com/apache/couchdb/issues/564#issuecomment-310739835","issue_url":"https://api.github.com/repos/apache/couchdb/issues/564","id":310739835,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDczOTgzNQ==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-23T18:27:53Z","updated_at":"2017-06-23T18:27:53Z","author_association":"MEMBER","body":"So, this took some chasing to figure out. The function `wait_for_compaction` is actually waiting on compaction _monitor_, not db compaction and since we have `parallel_view_compact` set to `false` in compaction daemon, the whole thing is sequential and doesn't have a race.\r\n\r\nThere are, however, a race in view compacting process (not compactor server, but actual compacting worker). The issue is that we reuse same data dir for all the tests, so there are quite a few temp database leftovers from the previous tests. Since compaction daemon scans all the databases on `compact by default rule` test, this creates quite a crowd, so on starved resources compacting process could be slightly slow to release db monitor even after `swap_compacted` called.\r\n\r\nI've opened apache/couchdb#614 to ensure \"our\" compacting proc exits before we do the db idling test.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310739835/reactions","total_count":2,"+1":0,"-1":0,"laugh":1,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310748384","html_url":"https://github.com/apache/couchdb/pull/614#issuecomment-310748384","issue_url":"https://api.github.com/repos/apache/couchdb/issues/614","id":310748384,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDc0ODM4NA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-23T19:05:01Z","updated_at":"2017-06-23T19:07:41Z","author_association":"CONTRIBUTOR","body":"+1\r\n\r\nVery nice.\r\n\r\n```======================== EUnit ========================\r\nmodule 'couchdb_compaction_daemon_tests'\r\n  Compaction daemon tests\r\nApplication crypto was left running!\r\n    couchdb_compaction_daemon_tests:74: should_compact_by_default_rule...[0.251 s] ok\r\n    couchdb_compaction_daemon_tests:105: should_compact_by_dbname_rule...[0.273 s] ok\r\n[os_mon] cpu supervisor port (cpu_sup): Erlang has closed\r\n    [done in 33.027 s]\r\n  [done in 34.394 s]\r\n=======================================================\r\n  2 tests passed.\r\n```\r\n\r\nThe whole couch app passes as well:\r\n\r\n```\r\n  All 1154 tests passed.\r\n==> rel (eunit)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310748384/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310761948","html_url":"https://github.com/apache/couchdb/issues/611#issuecomment-310761948","issue_url":"https://api.github.com/repos/apache/couchdb/issues/611","id":310761948,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDc2MTk0OA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-23T20:12:46Z","updated_at":"2017-06-23T20:12:46Z","author_association":"MEMBER","body":"Our build dependencies are documented in the [INSTALL.Unix.md][1] file. If you find any inaccuracies in there, please let us know!\r\n\r\nI'm closing this ticket for now as not a bug in CouchDB. Thanks for using our software! 👯 \r\n\r\n[1]: https://github.com/apache/couchdb/blob/master/INSTALL.Unix.md","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310761948/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310762507","html_url":"https://github.com/apache/couchdb/issues/613#issuecomment-310762507","issue_url":"https://api.github.com/repos/apache/couchdb/issues/613","id":310762507,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDc2MjUwNw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-23T20:15:17Z","updated_at":"2017-06-23T20:15:48Z","author_association":"MEMBER","body":"I don't think the documentation is trying to show what the default value is, in the inset; it's just trying to show how you'd change the value in your own `local.ini` file. For instance, scrolling up it shows a sample setting for the `util_driver_dir` directory that is clearly not the default value.\r\n\r\n64MB is the correct default value. The `default.ini` file should be taken as the correct, in-practice defaults for all values.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310762507/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310847201","html_url":"https://github.com/apache/couchdb/pull/614#issuecomment-310847201","issue_url":"https://api.github.com/repos/apache/couchdb/issues/614","id":310847201,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDg0NzIwMQ==","user":{"login":"ditta95aR","id":26099828,"node_id":"MDQ6VXNlcjI2MDk5ODI4","avatar_url":"https://avatars.githubusercontent.com/u/26099828?v=4","gravatar_id":"","url":"https://api.github.com/users/ditta95aR","html_url":"https://github.com/ditta95aR","followers_url":"https://api.github.com/users/ditta95aR/followers","following_url":"https://api.github.com/users/ditta95aR/following{/other_user}","gists_url":"https://api.github.com/users/ditta95aR/gists{/gist_id}","starred_url":"https://api.github.com/users/ditta95aR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ditta95aR/subscriptions","organizations_url":"https://api.github.com/users/ditta95aR/orgs","repos_url":"https://api.github.com/users/ditta95aR/repos","events_url":"https://api.github.com/users/ditta95aR/events{/privacy}","received_events_url":"https://api.github.com/users/ditta95aR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-24T15:59:44Z","updated_at":"2017-06-24T15:59:44Z","author_association":"NONE","body":"d23b26d","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310847201/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310860345","html_url":"https://github.com/apache/couchdb/issues/617#issuecomment-310860345","issue_url":"https://api.github.com/repos/apache/couchdb/issues/617","id":310860345,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDg2MDM0NQ==","user":{"login":"chewbranca","id":5326,"node_id":"MDQ6VXNlcjUzMjY=","avatar_url":"https://avatars.githubusercontent.com/u/5326?v=4","gravatar_id":"","url":"https://api.github.com/users/chewbranca","html_url":"https://github.com/chewbranca","followers_url":"https://api.github.com/users/chewbranca/followers","following_url":"https://api.github.com/users/chewbranca/following{/other_user}","gists_url":"https://api.github.com/users/chewbranca/gists{/gist_id}","starred_url":"https://api.github.com/users/chewbranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chewbranca/subscriptions","organizations_url":"https://api.github.com/users/chewbranca/orgs","repos_url":"https://api.github.com/users/chewbranca/repos","events_url":"https://api.github.com/users/chewbranca/events{/privacy}","received_events_url":"https://api.github.com/users/chewbranca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-24T19:16:37Z","updated_at":"2017-06-24T19:16:37Z","author_association":"CONTRIBUTOR","body":"Well on a positive note it appears `crypto:rand_bytes` is the only undefined function preventing CouchDB from booting. I ran `for f in $(grep -rl crypto:rand_bytes src/); do sed -i 's/rand_bytes/strong_rand_bytes/' $f; done` and I was able to successfully boot CouchDB and query the welcome handler. I forgot to mention in the initial write up of this ticket that this is a runtime error, not a compile time error, so it's possible there are other now missing functions. I have not yet run the test suite with OTP-20 to look for other problematic areas.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310860345/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310863170","html_url":"https://github.com/apache/couchdb/issues/617#issuecomment-310863170","issue_url":"https://api.github.com/repos/apache/couchdb/issues/617","id":310863170,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDg2MzE3MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-24T20:14:49Z","updated_at":"2017-06-24T20:14:49Z","author_association":"MEMBER","body":"From IRC:\r\n\r\n```irc\r\n<+rnewson> the rand_bytes deprecation should be handled in couch_crypto following the same pattern\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310863170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310869562","html_url":"https://github.com/apache/couchdb/issues/617#issuecomment-310869562","issue_url":"https://api.github.com/repos/apache/couchdb/issues/617","id":310869562,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDg2OTU2Mg==","user":{"login":"chewbranca","id":5326,"node_id":"MDQ6VXNlcjUzMjY=","avatar_url":"https://avatars.githubusercontent.com/u/5326?v=4","gravatar_id":"","url":"https://api.github.com/users/chewbranca","html_url":"https://github.com/chewbranca","followers_url":"https://api.github.com/users/chewbranca/followers","following_url":"https://api.github.com/users/chewbranca/following{/other_user}","gists_url":"https://api.github.com/users/chewbranca/gists{/gist_id}","starred_url":"https://api.github.com/users/chewbranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chewbranca/subscriptions","organizations_url":"https://api.github.com/users/chewbranca/orgs","repos_url":"https://api.github.com/users/chewbranca/repos","events_url":"https://api.github.com/users/chewbranca/events{/privacy}","received_events_url":"https://api.github.com/users/chewbranca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-24T22:27:40Z","updated_at":"2017-06-24T22:27:40Z","author_association":"CONTRIBUTOR","body":"RE using couch_crypto, I think that logically makes sense for the `couch` Erlang app, but anything that does not depend on that app or is a dependency of that app will need a different approach. Similarly, mochiweb and snappy are external dependencies and will need to be handled explicitly.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310869562/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310983925","html_url":"https://github.com/apache/couchdb/issues/619#issuecomment-310983925","issue_url":"https://api.github.com/repos/apache/couchdb/issues/619","id":310983925,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDk4MzkyNQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-26T07:30:27Z","updated_at":"2017-06-26T07:30:27Z","author_association":"MEMBER","body":"Hi @spencerthayer , we'd love it if you could submit an app.json for CouchDB to the repo. We'd certainly merge such a pull request if you can work one out.\r\n\r\nApache CouchDB is a volunteer project and I don't think anyone on the project right now has the bandwidth to do this, especially since the process to build CouchDB is rather convoluted. (See our apache/couchdb-ci, apache/couchdb-pkg or apache/couchdb-docker repositories to see what it takes to build CouchDB from scratch.)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/310983925/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311095428","html_url":"https://github.com/apache/couchdb/issues/619#issuecomment-311095428","issue_url":"https://api.github.com/repos/apache/couchdb/issues/619","id":311095428,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTA5NTQyOA==","user":{"login":"spencerthayer","id":1019815,"node_id":"MDQ6VXNlcjEwMTk4MTU=","avatar_url":"https://avatars.githubusercontent.com/u/1019815?v=4","gravatar_id":"","url":"https://api.github.com/users/spencerthayer","html_url":"https://github.com/spencerthayer","followers_url":"https://api.github.com/users/spencerthayer/followers","following_url":"https://api.github.com/users/spencerthayer/following{/other_user}","gists_url":"https://api.github.com/users/spencerthayer/gists{/gist_id}","starred_url":"https://api.github.com/users/spencerthayer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spencerthayer/subscriptions","organizations_url":"https://api.github.com/users/spencerthayer/orgs","repos_url":"https://api.github.com/users/spencerthayer/repos","events_url":"https://api.github.com/users/spencerthayer/events{/privacy}","received_events_url":"https://api.github.com/users/spencerthayer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-26T15:33:47Z","updated_at":"2017-06-26T15:33:47Z","author_association":"NONE","body":"I'll give it a shot!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311095428/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311162481","html_url":"https://github.com/apache/couchdb/issues/620#issuecomment-311162481","issue_url":"https://api.github.com/repos/apache/couchdb/issues/620","id":311162481,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTE2MjQ4MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-26T19:47:48Z","updated_at":"2017-06-26T19:47:48Z","author_association":"MEMBER","body":"Confirmed:\r\n\r\n```bash\r\n $ curl --verbose -X POST -H \"Content-Type: application/json\" http://127.0.0.1:15984/foo -d '{\"am\":\"joan\"}'\r\n* Hostname was NOT found in DNS cache\r\n*   Trying 127.0.0.1...\r\n* Connected to 127.0.0.1 (127.0.0.1) port 15984 (#0)\r\n> POST /foo HTTP/1.1\r\n> User-Agent: curl/7.38.0\r\n> Host: 127.0.0.1:15984\r\n> Accept: */*\r\n> Content-Type: application/json\r\n> Content-Length: 13\r\n>\r\n* upload completely sent off: 13 out of 13 bytes\r\n< HTTP/1.1 201 Created\r\n< Cache-Control: must-revalidate\r\n< Content-Length: 95\r\n< Content-Type: application/json\r\n< Date: Mon, 26 Jun 2017 19:45:42 GMT\r\n< Location: http://127.0.0.1:15984/foo/263cad76416a130feb97e26cb400084a\r\n* Server CouchDB/2.1.0-3559b7f (Erlang OTP/17) is not blacklisted\r\n< Server: CouchDB/2.1.0-3559b7f (Erlang OTP/17)\r\n< X-Couch-Request-ID: acdbe8171b\r\n< X-CouchDB-Body-Time: 0\r\n<\r\n{\"ok\":true,\"id\":\"263cad76416a130feb97e26cb400084a\",\"rev\":\"1-c29e0faaccb770dc8964a43d22825195\"}\r\n* Connection #0 to host 127.0.0.1 left intact\r\n$ curl --verbose -X PUT -H \"Content-Type: application/json\" http://127.0.0.1:15984/foo/bar -d '{\"bread\":\"makes you fat\"}'\r\n* Hostname was NOT found in DNS cache\r\n*   Trying 127.0.0.1...\r\n* Connected to 127.0.0.1 (127.0.0.1) port 15984 (#0)\r\n> PUT /foo/bar HTTP/1.1\r\n> User-Agent: curl/7.38.0\r\n> Host: 127.0.0.1:15984\r\n> Accept: */*\r\n> Content-Type: application/json\r\n> Content-Length: 25\r\n>\r\n* upload completely sent off: 25 out of 25 bytes\r\n< HTTP/1.1 201 Created\r\n< Cache-Control: must-revalidate\r\n< Content-Length: 66\r\n< Content-Type: application/json\r\n< Date: Mon, 26 Jun 2017 19:46:36 GMT\r\n< ETag: \"1-4cd6186966b5c93e45a3f878d6029f67\"\r\n< Location: http://127.0.0.1:15984/foo/bar\r\n* Server CouchDB/2.1.0-3559b7f (Erlang OTP/17) is not blacklisted\r\n< Server: CouchDB/2.1.0-3559b7f (Erlang OTP/17)\r\n< X-Couch-Request-ID: cdbe78e97c\r\n< X-CouchDB-Body-Time: 0\r\n<\r\n{\"ok\":true,\"id\":\"bar\",\"rev\":\"1-4cd6186966b5c93e45a3f878d6029f67\"}\r\n* Connection #0 to host 127.0.0.1 left intact\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311162481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311163050","html_url":"https://github.com/apache/couchdb/pull/496#issuecomment-311163050","issue_url":"https://api.github.com/repos/apache/couchdb/issues/496","id":311163050,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTE2MzA1MA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-26T19:50:02Z","updated_at":"2017-06-26T19:50:02Z","author_association":"MEMBER","body":"Looks like not because it doesn't appear to exist in 17.x\n\nOn Mon, Jun 26, 2017 at 8:11 AM, garren smith <notifications@github.com>\nwrote:\n\n> *@garrensmith* commented on this pull request.\n> ------------------------------\n>\n> In src/couch/src/test_engine_fold_changes.erl\n> <https://github.com/apache/couchdb/pull/496#discussion_r124004438>:\n>\n> > +    {ok, RevOrder} = Engine:fold_changes(St, 0, fun fold_fun/2, [], []),\n> +    ?assertEqual(FinalDocSeqs, lists:reverse(RevOrder)),\n> +    ok;\n> +\n> +do_mutation_ordering(Engine, St, Seq, [{DocId, _OldSeq} | Rest], DocSeqAcc) ->\n> +    Actions = [{update, {DocId, []}}],\n> +    {ok, NewSt} = test_engine_util:apply_actions(Engine, St, Actions),\n> +    NewAcc = DocSeqAcc ++ [{DocId, Seq}],\n> +    Expected = Rest ++ NewAcc,\n> +    {ok, RevOrder} = Engine:fold_changes(NewSt, 0, fun fold_fun/2, [], []),\n> +    ?assertEqual(Expected, lists:reverse(RevOrder)),\n> +    do_mutation_ordering(Engine, NewSt, Seq + 1, Rest, NewAcc).\n> +\n> +\n> +shuffle(List) ->\n> +    random:seed(os:timestamp()),\n>\n> It seems that the random module is deprecated. Could we use the rand\n> module instead?\n>\n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/couchdb/pull/496#pullrequestreview-46255994>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AABN2RMN9XbSo7OzGBlysSqhKvGuFrnzks5sH63qgaJpZM4NKWJX>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311163050/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311253647","html_url":"https://github.com/apache/couchdb/pull/606#issuecomment-311253647","issue_url":"https://api.github.com/repos/apache/couchdb/issues/606","id":311253647,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTI1MzY0Nw==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-27T05:01:52Z","updated_at":"2017-06-27T05:02:59Z","author_association":"CONTRIBUTOR","body":"@davisp: I made the changes you suggested.  Also, I think the performance benchmarks were using port 5984 instead of 5986, so it was influenced by the clustered nature of things. Compression tests existed, so I just piggy backed off that code. Let me know if this looks good, and I'll create a temporary build to check the performance numbers before merging.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311253647/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311340717","html_url":"https://github.com/apache/couchdb/issues/612#issuecomment-311340717","issue_url":"https://api.github.com/repos/apache/couchdb/issues/612","id":311340717,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTM0MDcxNw==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-27T12:18:07Z","updated_at":"2017-06-27T12:18:07Z","author_association":"MEMBER","body":"@hongzhongfang Its not possible to sort the results when there is just in-memory filtering. Sorting would require CouchDB to load the entire result set into memory and then sort it. This will lead to performance issues and out of memory issues on a large cluster. \r\n\r\nFor your query you need to add another field in your query that will use the \"on-disk index\"  and will then also be sorted.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311340717/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311345152","html_url":"https://github.com/apache/couchdb/issues/621#issuecomment-311345152","issue_url":"https://api.github.com/repos/apache/couchdb/issues/621","id":311345152,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTM0NTE1Mg==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-27T12:37:36Z","updated_at":"2017-06-27T12:37:36Z","author_association":"MEMBER","body":"can you explain the difference to our view options and why we wanna differ here?\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311345152/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311374825","html_url":"https://github.com/apache/couchdb/issues/621#issuecomment-311374825","issue_url":"https://api.github.com/repos/apache/couchdb/issues/621","id":311374825,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTM3NDgyNQ==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-27T14:25:24Z","updated_at":"2017-06-27T14:25:24Z","author_association":"MEMBER","body":"This isn't different to view options. Its updating to support the new view options. Stale is deprecated see https://github.com/apache/couchdb-couch-mrview/commit/459a548f269b00bf2d2ace0\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311374825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311385739","html_url":"https://github.com/apache/couchdb/pull/610#issuecomment-311385739","issue_url":"https://api.github.com/repos/apache/couchdb/issues/610","id":311385739,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTM4NTczOQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-27T14:59:31Z","updated_at":"2017-06-27T14:59:31Z","author_association":"MEMBER","body":"@chewbranca You managed to nerd snipe me for like four days trying to figure out the mem3 and concurrent LRU stuff.\r\n\r\nFor the mem3 bits I think my conclusion is that its not appropriate here. For mem3_shards we wanted to make sure that there would always be progress so we load things outside of the gen_server and send them to cache. Given that its a local db read this isn't the most terrible thing in the world. Although, for ddoc_cache its a clustered fabric call, so if we followed the mem3_shards pattern we'd actually just be putting extra load on other parts of the system like rexi, and the couch_db_updaters at 3x the rate of client requests. So having them funnel through the opener actually makes more sense here.\r\n\r\nAs to the distributed LRU approach for writes I've been playing with a couple different standalone tests to try and get a feel for our maximum throughput with that. So far (with some *extremely* synthetic tests) I think we're looking at topping out at around 200K updates a second (at least on my laptop). However, this test doesn't actually take into account actually evicting things. My plan for today is to write a basho_bench driver to try and gauge the relative throughput between what I've got written now and a second approach based on your direct ets write idea. I'll post results here when I get them.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311385739/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311535523","html_url":"https://github.com/apache/couchdb/pull/608#issuecomment-311535523","issue_url":"https://api.github.com/repos/apache/couchdb/issues/608","id":311535523,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTUzNTUyMw==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-28T02:00:21Z","updated_at":"2017-06-28T03:11:34Z","author_association":"CONTRIBUTOR","body":"hmmm, pre compaction and post compaction is slightly off by a few hundred bytes, but the compression method does not matter. need to figure out why\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311535523/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311550655","html_url":"https://github.com/apache/couchdb/pull/608#issuecomment-311550655","issue_url":"https://api.github.com/repos/apache/couchdb/issues/608","id":311550655,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTU1MDY1NQ==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-28T04:01:43Z","updated_at":"2017-06-28T04:01:55Z","author_association":"CONTRIBUTOR","body":"looks like ```{ok, Result} = couch_query_servers:reduce(Lang, [FunSrc], KVs),``` returns a slightly different value after compaction. That's why post-compaction, when we do ```?term_size(Reduction)```, it returns a slightly different value.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311550655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311690964","html_url":"https://github.com/apache/couchdb/issues/551#issuecomment-311690964","issue_url":"https://api.github.com/repos/apache/couchdb/issues/551","id":311690964,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTY5MDk2NA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-28T15:12:53Z","updated_at":"2017-06-28T15:12:53Z","author_association":"CONTRIBUTOR","body":"So @davisp and I found out that building mozjs185 from source on Ubuntu12 docker image doesn't reproduce the segfault. But re-building deb package from source does. We tried applying the same ./configure options but still couldn't make the segfault happen.\r\n\r\nThere are differences in CFLAGS and some of those seem like would enable stack protection mechanisms.\r\n\r\nHere is the compile options diff between a deb package build vs build from source. The first one is the deb package\r\n\r\n```\r\n\r\n< configure:14198: c++ -o conftest -g -O2 -fstack-protector \r\n--param=ssp-buffer-size=4 -Wformat -Wformat-security \r\n-fno-strict-aliasing -pthread -D_FORTIFY_SOURCE=2 -lpthread \r\n-Wl,-Bsymbolic-functions -Wl,-z,relro conftest.C -ldl  1>&5\r\n---\r\n > configure:14198: c++ -o conftest  -fno-strict-aliasing -pthread \r\n-lpthread  conftest.C -ldl  1>&5\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311690964/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311714266","html_url":"https://github.com/apache/couchdb/issues/551#issuecomment-311714266","issue_url":"https://api.github.com/repos/apache/couchdb/issues/551","id":311714266,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTcxNDI2Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-28T16:28:24Z","updated_at":"2017-06-28T16:29:27Z","author_association":"MEMBER","body":"So we've been talking this over on #couchdb-dev IRC.\r\n\r\nThe working theory is:\r\n\r\n```\r\n<vatamane> jit + fortify source + extra stack protection causes segfault\r\n```\r\n\r\nOn Ubuntu 12.04, our Docker images currently use Debian's package, which is what @nickva analysed above. I will change our 12.04 image to build SM from source using flags as recommended via https://paste.apache.org/2UId . I'm not going to put a lot of effort in here - Ubuntu 12.04 is officially EOL at this point. Also worth noting is that the equivalent Debian package has a `--disable-methodjit` (and wrapped in a `ifdef` for `platform==Debian` only), which should also bypass the bug as found.\r\n\r\nOur CentOS 6/7 images currently build SM from source but do *not* include the build options above. That is, The *package* builds (in couchdb-pkg) **do** use these options, though (derived from the official CentOS 7 js-devel package definition).\r\n\r\nNone of this helps Ubuntu 14, though, which has shown multiple segfaults (including at least 2 recorded in JIRA), and should have the flags listed above as ideal.\r\n\r\nAll of this mess, plus the problems with building SM1.8.5 with gcc6+, make me want to get a `couchjs-chakracore` out the door as soon as possible, maybe for 2.2.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311714266/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311736726","html_url":"https://github.com/apache/couchdb/issues/551#issuecomment-311736726","issue_url":"https://api.github.com/repos/apache/couchdb/issues/551","id":311736726,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTczNjcyNg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-28T17:50:48Z","updated_at":"2017-06-28T17:50:48Z","author_association":"MEMBER","body":"Lunch gave me some perspective. I'm proceeding with a 3-step approach:\r\n\r\n1. Compile js-1.8.5 from source in all Docker images, with the `--disable-methodjit` configure option. This should remove the possibility for the current known segfault.\r\n2. Watch for more segfaults in test runs & in the field. Address on a case-by-case basis. If the chronic problem resurfaces in our test suite, reopen this issue.\r\n3. Because of the gcc6+ issues and this ticket, move couchjs to couchjs-chakracore as soon as possible (same external view server interface, just replacing SM 1.8.5)\r\n\r\n@janl what do you think about for #3 above, adding the daemon in 2.2, and making it the default in 3.0?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311736726/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311813243","html_url":"https://github.com/apache/couchdb/issues/551#issuecomment-311813243","issue_url":"https://api.github.com/repos/apache/couchdb/issues/551","id":311813243,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTgxMzI0Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-28T22:46:27Z","updated_at":"2017-06-28T22:46:27Z","author_association":"MEMBER","body":"Images are still uploading; once they have I'll push the button on Jenkins to run a few times and will share results in this ticket. If it's not fixed, I'll reopen.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311813243/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311816596","html_url":"https://github.com/apache/couchdb/pull/610#issuecomment-311816596","issue_url":"https://api.github.com/repos/apache/couchdb/issues/610","id":311816596,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTgxNjU5Ng==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-28T23:06:58Z","updated_at":"2017-06-28T23:06:58Z","author_association":"MEMBER","body":"@chewbranca Epic nerd snipe. I've sprinkled more parallel on the ddoc_cache. Care to take another look. Currently measuring 1M+ ops/sec against a 1,000 item cache on my MBP. I have to do some work on the test suite tomorrow to finish up the rewritten rewrite work but I'm currently pretty happy with it.\r\n\r\nNew style is one pid per entry which does all of the ets writes for the entry. the LRU process only exists to do evictions. I soaked 20,000 clients against a 500 item cache on my laptop for 30-45m and it sustained about 1.5M ops/sec without error and without blowing RAM up beyond 500M. Those numbers are for a custom module that does no loading but I think it shows that the cache itself won't be bound by the cache and instead it'll be fabric calls and or some other bottle neck before the cache.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311816596/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311816993","html_url":"https://github.com/apache/couchdb/pull/615#issuecomment-311816993","issue_url":"https://api.github.com/repos/apache/couchdb/issues/615","id":311816993,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTgxNjk5Mw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-28T23:09:28Z","updated_at":"2017-06-28T23:09:28Z","author_association":"MEMBER","body":"I would say that there's some work we can do here, but for the most part figuring out thigns based on initial_call and registered names is pretty easy. Granted there are a bunch that have an initial_call of erlang:apply/3. For those ones we should look into replacing erlang:spawn* with proc_lib:spawn* though for spawn_monitor we'll have to fake it cause proc_lib doesn't have a monitor related things (and prevents the option from being used for some unknown reason).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311816993/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311832165","html_url":"https://github.com/apache/couchdb/issues/551#issuecomment-311832165","issue_url":"https://api.github.com/repos/apache/couchdb/issues/551","id":311832165,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTgzMjE2NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-29T00:55:32Z","updated_at":"2017-06-29T00:55:32Z","author_association":"MEMBER","body":"One run done so far with no segfaults (though 4 other errors).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311832165/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":2,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311853484","html_url":"https://github.com/apache/couchdb/issues/612#issuecomment-311853484","issue_url":"https://api.github.com/repos/apache/couchdb/issues/612","id":311853484,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTg1MzQ4NA==","user":{"login":"hongzhongfang","id":11630563,"node_id":"MDQ6VXNlcjExNjMwNTYz","avatar_url":"https://avatars.githubusercontent.com/u/11630563?v=4","gravatar_id":"","url":"https://api.github.com/users/hongzhongfang","html_url":"https://github.com/hongzhongfang","followers_url":"https://api.github.com/users/hongzhongfang/followers","following_url":"https://api.github.com/users/hongzhongfang/following{/other_user}","gists_url":"https://api.github.com/users/hongzhongfang/gists{/gist_id}","starred_url":"https://api.github.com/users/hongzhongfang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hongzhongfang/subscriptions","organizations_url":"https://api.github.com/users/hongzhongfang/orgs","repos_url":"https://api.github.com/users/hongzhongfang/repos","events_url":"https://api.github.com/users/hongzhongfang/events{/privacy}","received_events_url":"https://api.github.com/users/hongzhongfang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-29T03:35:29Z","updated_at":"2017-06-29T03:35:29Z","author_association":"NONE","body":"Thanks @garrensmith and @wohali !\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311853484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311858916","html_url":"https://github.com/apache/couchdb/issues/551#issuecomment-311858916","issue_url":"https://api.github.com/repos/apache/couchdb/issues/551","id":311858916,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTg1ODkxNg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-29T04:23:38Z","updated_at":"2017-06-29T04:23:38Z","author_association":"MEMBER","body":"Two runs done with no segfaults. I'm declaring victory for now - we would have had a segfault by now.\r\n\r\nAgain, please reopen this ticket if another segfault happens in Jenkins.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/311858916/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312018463","html_url":"https://github.com/apache/couchdb/pull/605#issuecomment-312018463","issue_url":"https://api.github.com/repos/apache/couchdb/issues/605","id":312018463,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjAxODQ2Mw==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-29T16:21:19Z","updated_at":"2017-06-29T16:21:19Z","author_association":"MEMBER","body":"Take a look at RFC 7240 (https://tools.ietf.org/html/rfc7240).\r\n\r\n`Prefer: return=minimal`\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312018463/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312054001","html_url":"https://github.com/apache/couchdb/issues/551#issuecomment-312054001","issue_url":"https://api.github.com/repos/apache/couchdb/issues/551","id":312054001,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjA1NDAwMQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-29T18:25:21Z","updated_at":"2017-06-29T18:25:21Z","author_association":"CONTRIBUTOR","body":"Out of interest I found out that on Ubuntu 12 image. The predictable segfault is caused by this linker flag:\r\n\r\n`-Wl,-Bsymbolic-functions`\r\n\r\nDeb package adds that to config/autoconf.mk to `OS_LDFLAGS` variable.\r\n\r\nSo just adding that to the vanilla upstream source on Ubuntu 12 ends up reproducing the segfault.  ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312054001/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312064313","html_url":"https://github.com/apache/couchdb/issues/551#issuecomment-312064313","issue_url":"https://api.github.com/repos/apache/couchdb/issues/551","id":312064313,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjA2NDMxMw==","user":{"login":"tilgovi","id":20818,"node_id":"MDQ6VXNlcjIwODE4","avatar_url":"https://avatars.githubusercontent.com/u/20818?v=4","gravatar_id":"","url":"https://api.github.com/users/tilgovi","html_url":"https://github.com/tilgovi","followers_url":"https://api.github.com/users/tilgovi/followers","following_url":"https://api.github.com/users/tilgovi/following{/other_user}","gists_url":"https://api.github.com/users/tilgovi/gists{/gist_id}","starred_url":"https://api.github.com/users/tilgovi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tilgovi/subscriptions","organizations_url":"https://api.github.com/users/tilgovi/orgs","repos_url":"https://api.github.com/users/tilgovi/repos","events_url":"https://api.github.com/users/tilgovi/events{/privacy}","received_events_url":"https://api.github.com/users/tilgovi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-29T18:45:32Z","updated_at":"2017-06-29T18:45:43Z","author_association":"CONTRIBUTOR","body":"Great work isolating this, I was utterly lost.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312064313/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312074572","html_url":"https://github.com/apache/couchdb/issues/551#issuecomment-312074572","issue_url":"https://api.github.com/repos/apache/couchdb/issues/551","id":312074572,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjA3NDU3Mg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-29T19:27:03Z","updated_at":"2017-06-29T19:27:03Z","author_association":"CONTRIBUTOR","body":"I'll leave the full backtrace of the segfault here for future reference. Wohali's work on building from source seems fixed this problem (and disabling jit fixed other unpredictable segfaults).\r\n```\r\n(gdb) bt f\r\n#0  typeOf (cx=0x696a00, this=0x7ffffffffff6) at jsobj.h:1262\r\n        op = <optimized out>\r\n#1  js::TypeOfValue (cx=0x696a00, vref=...) at jsinterp.cpp:1202\r\n        v = <optimized out>\r\n#2  0x00007ffff7973ed3 in JS_TypeOfValue (cx=<optimized out>, v=18446744073709551606) at jsapi.cpp:578\r\nNo locals.\r\n#3  0x00007ffff79e9aa0 in js::Interpret (cx=0x696a00, entryFrame=0x7ffff19e92e0, inlineCallCount=1, interpMode=JSINTERP_NORMAL) at jsinterp.cpp:3914\r\n        type = JSTYPE_BOOLEAN\r\n        normalJumpTable = {0x7ffff79ea732, 0x7ffff79ebcab, 0x7ffff79e8e8f, 0x7ffff79ebb94, 0x7ffff79ebb60, 0x7ffff79ebb31, 0x7ffff79e9083, 0x7ffff79ec388, 0x7ffff79e9e8b, 0x7ffff79eef98, 0x7ffff79ebd58, 0x7ffff79e9d6e, 0x7ffff79e9fcb, 0x7ffff79e9d28, 0x7ffff79ec970, 0x7ffff79ec4a7, 0x7ffff79ec3f8, 0x7ffff79eba82, 0x7ffff79eb98d, 0x7ffff79eb89a, 0x7ffff79eb57e, 0x7ffff79eb436, 0x7ffff79eb2ee, 0x7ffff79eb1a6,\r\n          0x7ffff79eb0f3, 0x7ffff79eb040, 0x7ffff79eaf85, 0x7ffff79eae5e, 0x7ffff79ead7f, 0x7ffff79efed8, 0x7ffff79efdeb, 0x7ffff79ede85, 0x7ffff79ede02, 0x7ffff79edd7b, 0x7ffff79edceb, 0x7ffff79edcac, 0x7ffff79edbdf, 0x7ffff79ef1f0, 0x7ffff79ef0b0, 0x7ffff79e9a8c, 0x7ffff79edfbd, 0x7ffff79ea6a1, 0x7ffff79efd53, 0x7ffff79edfb8, 0x7ffff79ec285, 0x7ffff79efd58, 0x7ffff79edfb3, 0x7ffff79ec27f, 0x7ffff79e8328,\r\n          0x7ffff79e8210, 0x7ffff79efd98, 0x7ffff79e8328, 0x7ffff79e8210, 0x7ffff79e9aec, 0x7ffff79e8354, 0x7ffff79ea580, 0x7ffff79ea254, 0x7ffff79e848f, 0x7ffff79ebc3e, 0x7ffff79e848f, 0x7ffff79ecd85, 0x7ffff79ecd2d, 0x7ffff79ecb60, 0x7ffff79ecb1c, 0x7ffff79ef33e, 0x7ffff79efc3f, 0x7ffff79ef2fa, 0x7ffff79ef478, 0x7ffff79e9dea, 0x7ffff79ec295, 0x7ffff79ef3f3, 0x7ffff79ece48, 0x7ffff79eb81d, 0x7ffff79eb7a0,\r\n          0x7ffff79ecaff, 0x7ffff79ebedf, 0x7ffff79ebe25, 0x7ffff79ebdd3, 0x7ffff79e804d, 0x7ffff79ec935, 0x7ffff79eccba, 0x7ffff79ebc7f, 0x7ffff79ea009, 0x7ffff79ecdeb, 0x7ffff79e9a05, 0x7ffff79edf61, 0x7ffff79ef05c, 0x7ffff79ef2a7, 0x7ffff79eca78, 0x7ffff79ef643, 0x7ffff79ef5b5, 0x7ffff79eeb98, 0x7ffff79eeb75, 0x7ffff79e97c7, 0x7ffff79ed49b, 0x7ffff79ed3c5, 0x7ffff79ed2e1, 0x7ffff79efaa4, 0x7ffff79f00e6,\r\n          0x7ffff79efa0d, 0x7ffff79f00d9, 0x7ffff79efd2d, 0x7ffff79efd44, 0x7ffff79efcfe, 0x7ffff79efd3a, 0x7ffff79ec556, 0x7ffff79e8edc, 0x7ffff79eac3b, 0x7ffff79e9f58, 0x7ffff79ebc43, 0x7ffff79ec570, 0x7ffff79efd4e, 0x7ffff79ed98c, 0x7ffff79ebf40, 0x7ffff79ed7b4, 0x7ffff79ed6b5, 0x7ffff79edb71, 0x7ffff79edaa6, 0x7ffff79eda41, 0x7ffff79ebd35, 0x7ffff79ea70f, 0x7ffff79eb733, 0x7ffff79e907a, 0x7ffff79e8da9,\r\n          0x7ffff79ea108, 0x7ffff79e9c47, 0x7ffff79e9c47, 0x7ffff79ee3be, 0x7ffff79e90e2, 0x7ffff79e90e2, 0x7ffff79edff6, 0x7ffff79efda5, 0x7ffff79ed937, 0x7ffff79ec8ca, 0x7ffff79ea6ec, 0x7ffff79eda0c, 0x7ffff79e92d8, 0x7ffff79e92d8, 0x7ffff79eef19, 0x7ffff79ef382, 0x7ffff79ee259, 0x7ffff79e902f, 0x7ffff79ec318, 0x7ffff79ec1dd, 0x7ffff79ec12c, 0x7ffff79ec0a9, 0x7ffff79edae7, 0x7ffff79eb6c6, 0x7ffff79e9026,\r\n          0x7ffff79ef4bc, 0x7ffff79ecf9c, 0x7ffff79e94c4, 0x7ffff79e94c4, 0x7ffff79ed9c6, 0x7ffff79e8e8f, 0x7ffff79e8655, 0x7ffff79ec27a, 0x7ffff79ea8e7, 0x7ffff79efd93, 0x7ffff79efd9d, 0x7ffff79e7dd2, 0x7ffff79e7dd8, 0x7ffff79ecba4, 0x7ffff79ed66d, 0x7ffff79ed734, 0x7ffff79ed615, 0x7ffff79ee6f7, 0x7ffff79ee66e, 0x7ffff79ee60b, 0x7ffff79ee5a6, 0x7ffff79e9744, 0x7ffff79e9744, 0x7ffff79ee8d3, 0x7ffff79ee793,\r\n          0x7ffff79e9680, 0x7ffff79e95e0, 0x7ffff79eeb22, 0x7ffff79eea6e, 0x7ffff79eea05, 0x7ffff79ee99c, 0x7ffff79ed202, 0x7ffff79ed172, 0x7ffff79e90bf, 0x7ffff79ed0fa, 0x7ffff79ed082, 0x7ffff79ed001, 0x7ffff79e95e0, 0x7ffff79ea933, 0x7ffff79ebcef, 0x7ffff79ebd12, 0x7ffff79eca1b, 0x7ffff79ecad1, 0x7ffff79e9a65, 0x7ffff79e9a65, 0x7ffff79ea6c9, 0x7ffff79ea6a6, 0x7ffff79ea3ce, 0x7ffff79e8655, 0x7ffff79e9aec,\r\n          0x7ffff79e9680...}\r\n        argv = 0x7ffff19e9358\r\n        interruptJumpTable = {0x7ffff79ea755 <repeats 244 times>}\r\n        atoms = 0x788c68\r\n        op = JSOP_TYPEOF\r\n        rt = 0x609070\r\n        regs = {sp = 0x7ffff19e93f0, pc = 0x788e10 \"'=\", fp = 0x7ffff19e9370}\r\n        script = 0x788bb0\r\n        atomNotDefined = 0x7ffffffffff6\r\n#4  0x00007ffff79f912f in js::RunScript (cx=0x696a00, script=<optimized out>, fp=0x7ffff19e92e0) at jsinterp.cpp:653\r\n        prepareInterp = {cx = 0x696a00, script = <optimized out>}\r\n#5  0x00007ffff79f9482 in js::Invoke (cx=0x696a00, argsRef=..., flags=<optimized out>) at jsinterp.cpp:740\r\n        preserve = {cx = 0x696a00, enumerators = 0x0}\r\n        clasp = 0x5\r\n        fun = 0x0\r\n        frame = {cx_ = 0x696a00, regs_ = {sp = 0x7ffff19e9338, pc = 0x77c650 \";\", fp = 0x7ffff19e92e0}, prevRegs_ = 0x7fffffffe040}\r\n        ok = <optimized out>\r\n        script = 0x77c570\r\n#6  0x00007ffff79cf47a in js_fun_apply (cx=0x696a00, argc=<optimized out>, vp=0x7ffff19e92a8) at jsfun.cpp:2205\r\n        length = 1\r\n        fval = {data = {asBits = 18445618173559587696, debugView = {payload47 = 140737245234032, tag = JSVAL_TAG_OBJECT}, s = {payload = {i32 = -243121296, u32 = 4051846000, why = 4051846000, word = 18445618173559587696}}, asDouble = -nan(0xbfffff1824370), asPtr = 0xfffbfffff1824370}}\r\n        n = 1\r\n        args = {<js::CallArgs> = {argv_ = 0x7ffff19e92d8, argc_ = 1}, cx = 0x696a00, seg = 0x0, prevInvokeArgEnd = 0x0}\r\n#7  0x00007ffff79f2082 in CallJSNative (vp=<optimized out>, argc=<optimized out>, native=<optimized out>, cx=<optimized out>) at jscntxtinlines.h:701\r\n        ok = 5\r\n#8  js::Interpret (cx=0x696a00, entryFrame=0x7ffff19e90d8, inlineCallCount=2, interpMode=JSINTERP_NORMAL) at jsinterp.cpp:4799\r\n        ok = 5\r\n        flags = 0\r\n        vp = 0x7ffff19e92b0\r\n        argc = 2\r\n        normalJumpTable = {0x7ffff79ea732, 0x7ffff79ebcab, 0x7ffff79e8e8f, 0x7ffff79ebb94, 0x7ffff79ebb60, 0x7ffff79ebb31, 0x7ffff79e9083, 0x7ffff79ec388, 0x7ffff79e9e8b, 0x7ffff79eef98, 0x7ffff79ebd58, 0x7ffff79e9d6e, 0x7ffff79e9fcb, 0x7ffff79e9d28, 0x7ffff79ec970, 0x7ffff79ec4a7, 0x7ffff79ec3f8, 0x7ffff79eba82, 0x7ffff79eb98d, 0x7ffff79eb89a, 0x7ffff79eb57e, 0x7ffff79eb436, 0x7ffff79eb2ee, 0x7ffff79eb1a6,\r\n          0x7ffff79eb0f3, 0x7ffff79eb040, 0x7ffff79eaf85, 0x7ffff79eae5e, 0x7ffff79ead7f, 0x7ffff79efed8, 0x7ffff79efdeb, 0x7ffff79ede85, 0x7ffff79ede02, 0x7ffff79edd7b, 0x7ffff79edceb, 0x7ffff79edcac, 0x7ffff79edbdf, 0x7ffff79ef1f0, 0x7ffff79ef0b0, 0x7ffff79e9a8c, 0x7ffff79edfbd, 0x7ffff79ea6a1, 0x7ffff79efd53, 0x7ffff79edfb8, 0x7ffff79ec285, 0x7ffff79efd58, 0x7ffff79edfb3, 0x7ffff79ec27f, 0x7ffff79e8328,\r\n          0x7ffff79e8210, 0x7ffff79efd98, 0x7ffff79e8328, 0x7ffff79e8210, 0x7ffff79e9aec, 0x7ffff79e8354, 0x7ffff79ea580, 0x7ffff79ea254, 0x7ffff79e848f, 0x7ffff79ebc3e, 0x7ffff79e848f, 0x7ffff79ecd85, 0x7ffff79ecd2d, 0x7ffff79ecb60, 0x7ffff79ecb1c, 0x7ffff79ef33e, 0x7ffff79efc3f, 0x7ffff79ef2fa, 0x7ffff79ef478, 0x7ffff79e9dea, 0x7ffff79ec295, 0x7ffff79ef3f3, 0x7ffff79ece48, 0x7ffff79eb81d, 0x7ffff79eb7a0,\r\n          0x7ffff79ecaff, 0x7ffff79ebedf, 0x7ffff79ebe25, 0x7ffff79ebdd3, 0x7ffff79e804d, 0x7ffff79ec935, 0x7ffff79eccba, 0x7ffff79ebc7f, 0x7ffff79ea009, 0x7ffff79ecdeb, 0x7ffff79e9a05, 0x7ffff79edf61, 0x7ffff79ef05c, 0x7ffff79ef2a7, 0x7ffff79eca78, 0x7ffff79ef643, 0x7ffff79ef5b5, 0x7ffff79eeb98, 0x7ffff79eeb75, 0x7ffff79e97c7, 0x7ffff79ed49b, 0x7ffff79ed3c5, 0x7ffff79ed2e1, 0x7ffff79efaa4, 0x7ffff79f00e6,\r\n          0x7ffff79efa0d, 0x7ffff79f00d9, 0x7ffff79efd2d, 0x7ffff79efd44, 0x7ffff79efcfe, 0x7ffff79efd3a, 0x7ffff79ec556, 0x7ffff79e8edc, 0x7ffff79eac3b, 0x7ffff79e9f58, 0x7ffff79ebc43, 0x7ffff79ec570, 0x7ffff79efd4e, 0x7ffff79ed98c, 0x7ffff79ebf40, 0x7ffff79ed7b4, 0x7ffff79ed6b5, 0x7ffff79edb71, 0x7ffff79edaa6, 0x7ffff79eda41, 0x7ffff79ebd35, 0x7ffff79ea70f, 0x7ffff79eb733, 0x7ffff79e907a, 0x7ffff79e8da9,\r\n          0x7ffff79ea108, 0x7ffff79e9c47, 0x7ffff79e9c47, 0x7ffff79ee3be, 0x7ffff79e90e2, 0x7ffff79e90e2, 0x7ffff79edff6, 0x7ffff79efda5, 0x7ffff79ed937, 0x7ffff79ec8ca, 0x7ffff79ea6ec, 0x7ffff79eda0c, 0x7ffff79e92d8, 0x7ffff79e92d8, 0x7ffff79eef19, 0x7ffff79ef382, 0x7ffff79ee259, 0x7ffff79e902f, 0x7ffff79ec318, 0x7ffff79ec1dd, 0x7ffff79ec12c, 0x7ffff79ec0a9, 0x7ffff79edae7, 0x7ffff79eb6c6, 0x7ffff79e9026,\r\n          0x7ffff79ef4bc, 0x7ffff79ecf9c, 0x7ffff79e94c4, 0x7ffff79e94c4, 0x7ffff79ed9c6, 0x7ffff79e8e8f, 0x7ffff79e8655, 0x7ffff79ec27a, 0x7ffff79ea8e7, 0x7ffff79efd93, 0x7ffff79efd9d, 0x7ffff79e7dd2, 0x7ffff79e7dd8, 0x7ffff79ecba4, 0x7ffff79ed66d, 0x7ffff79ed734, 0x7ffff79ed615, 0x7ffff79ee6f7, 0x7ffff79ee66e, 0x7ffff79ee60b, 0x7ffff79ee5a6, 0x7ffff79e9744, 0x7ffff79e9744, 0x7ffff79ee8d3, 0x7ffff79ee793,\r\n          0x7ffff79e9680, 0x7ffff79e95e0, 0x7ffff79eeb22, 0x7ffff79eea6e, 0x7ffff79eea05, 0x7ffff79ee99c, 0x7ffff79ed202, 0x7ffff79ed172, 0x7ffff79e90bf, 0x7ffff79ed0fa, 0x7ffff79ed082, 0x7ffff79ed001, 0x7ffff79e95e0, 0x7ffff79ea933, 0x7ffff79ebcef, 0x7ffff79ebd12, 0x7ffff79eca1b, 0x7ffff79ecad1, 0x7ffff79e9a65, 0x7ffff79e9a65, 0x7ffff79ea6c9, 0x7ffff79ea6a6, 0x7ffff79ea3ce, 0x7ffff79e8655, 0x7ffff79e9aec,\r\n          0x7ffff79e9680...}\r\n        argv = 0x7ffff19e9228\r\n        interruptJumpTable = {0x7ffff79ea755 <repeats 244 times>}\r\n        atoms = 0x78a7e8\r\n        op = 4053701296\r\n        rt = 0x609070\r\n        regs = {sp = 0x7ffff19e92c8, pc = 0x78a95d \"N\", fp = 0x7ffff19e9228}\r\n        script = 0x78a730\r\n        atomNotDefined = 0x7ffffffffff6\r\n#9  0x00007ffff79f912f in js::RunScript (cx=0x696a00, script=<optimized out>, fp=0x7ffff19e90d8) at jsinterp.cpp:653\r\n        prepareInterp = {cx = 0x696a00, script = <optimized out>}\r\n#10 0x00007ffff79faa55 in js::Execute (cx=0x696a00, chain=0x7ffff1803048, script=0x78aa30, prev=<optimized out>, flags=<optimized out>, result=0x7fffffffe590) at jsinterp.cpp:1028\r\n        frame = {<js::FrameGuard> = {cx_ = 0x696a00, seg_ = 0x7ffff19e9090, vp_ = 0x7ffff19e90c8, fp_ = 0x7ffff19e90d8}, regs_ = {sp = 0x7ffff19e9130, pc = 0x78aae0 \"\\202\", fp = 0x7ffff19e90d8}}\r\n        initialVarObj = <optimized out>\r\n        preserve = {cx = 0x696a00, enumerators = 0x0}\r\n        ok = <optimized out>\r\n#11 0x00007ffff797987a in JS_ExecuteScript (cx=0x696a00, obj=<optimized out>, scriptObj=<optimized out>, rval=<optimized out>) at jsapi.cpp:4998\r\n        ok = <optimized out>\r\n#12 0x0000000000404e71 in main (argc=2, argv=0x7fffffffe6e8) at priv/couch_js/main.c:470\r\n        rt = 0x609070\r\n        cx = 0x696a00\r\n        global = 0x7ffff1803048\r\n        call = 0x6f47c0\r\n        klass = 0x0\r\n        script = 0x7ffff1803948\r\n        scriptsrc = 0x7ffff1818040\r\n        schars = 0x7253a0\r\n        slen = 52758\r\n        sroot = 18445336698582827072\r\n        result = 4841656\r\n        i = 0\r\n        args = 0x609040\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312074572/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312088802","html_url":"https://github.com/apache/couchdb/pull/624#issuecomment-312088802","issue_url":"https://api.github.com/repos/apache/couchdb/issues/624","id":312088802,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjA4ODgwMg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-29T20:05:02Z","updated_at":"2017-06-29T20:05:48Z","author_association":"MEMBER","body":"zOMG +1...except the tests are all failing in compaction now. What gives? Is this feature broken?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312088802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312103681","html_url":"https://github.com/apache/couchdb/pull/624#issuecomment-312103681","issue_url":"https://api.github.com/repos/apache/couchdb/issues/624","id":312103681,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjEwMzY4MQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-29T20:49:16Z","updated_at":"2017-06-29T20:49:16Z","author_association":"MEMBER","body":"Heh, the tests might assume the feature to be off, I'll check in the morning :)\r\n\r\nThe feature works fine. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312103681/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312322215","html_url":"https://github.com/apache/couchdb/pull/626#issuecomment-312322215","issue_url":"https://api.github.com/repos/apache/couchdb/issues/626","id":312322215,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjMyMjIxNQ==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-30T17:07:45Z","updated_at":"2017-06-30T17:07:45Z","author_association":"MEMBER","body":"Hmm, jiffy actually supporst JSON booleans\r\n```erlang\r\n(node1@192.168.50.50)1> jiffy:decode(<<\"{\\\"a\\\":true}\">>).\r\n{[{<<\"a\">>,true}]}\r\n(node1@192.168.50.50)2> jiffy:decode(<<\"{\\\"a\\\":\\\"true\\\"}\">>).\r\n{[{<<\"a\">>,<<\"true\">>}]}\r\n```\r\nSo this is more about invalid doc field allowed on admin /nodes endpoint rather than mem3 bug.\r\n\r\nI'd suggest either add validation on adding that \"decom\" field or make mem3 accept both boolean and string, after all you are trading one bug for another here.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312322215/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312327175","html_url":"https://github.com/apache/couchdb/pull/626#issuecomment-312327175","issue_url":"https://api.github.com/repos/apache/couchdb/issues/626","id":312327175,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjMyNzE3NQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-30T17:30:00Z","updated_at":"2017-06-30T18:49:35Z","author_association":"CONTRIBUTOR","body":"Agree with Eric. Since it's a user settable value maybe accept both values as truth?\r\n\r\nIdeally a VDU or other validation to prevent a non-boolean value to be set would be better.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312327175/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312327929","html_url":"https://github.com/apache/couchdb/pull/526#issuecomment-312327929","issue_url":"https://api.github.com/repos/apache/couchdb/issues/526","id":312327929,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjMyNzkyOQ==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-30T17:33:23Z","updated_at":"2017-06-30T17:33:23Z","author_association":"MEMBER","body":"@davisp sorry, I totally forgot about this PR!\r\n\r\nI tried modifying `fabric_view_all_docs` initially and then went with new module for three reasons:\r\n1. code got somehow confusing for first-time readers with usage of all `null`, numbers for offset and total and `nil` for exclusion of update_seq.\r\n1. code around that spawned process for getting doc count in `go/5` for `POST` with `keys` was rather ugly and running the whole thing as it is and then just throwing away the result felt like a waste.\r\n1.  shared config parameters and error log messages saying `_all_docs` were going to be confusing in production\r\n\r\nI agree there are lot of repetition, but it felt more cleaner to separate this functionality. If you think it's excessive I can amend `fabric_view_all_docs` instead.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312327929/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312339065","html_url":"https://github.com/apache/couchdb/pull/625#issuecomment-312339065","issue_url":"https://api.github.com/repos/apache/couchdb/issues/625","id":312339065,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjMzOTA2NQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-30T18:20:41Z","updated_at":"2017-06-30T18:20:41Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312339065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312401351","html_url":"https://github.com/apache/couchdb/pull/610#issuecomment-312401351","issue_url":"https://api.github.com/repos/apache/couchdb/issues/610","id":312401351,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjQwMTM1MQ==","user":{"login":"chewbranca","id":5326,"node_id":"MDQ6VXNlcjUzMjY=","avatar_url":"https://avatars.githubusercontent.com/u/5326?v=4","gravatar_id":"","url":"https://api.github.com/users/chewbranca","html_url":"https://github.com/chewbranca","followers_url":"https://api.github.com/users/chewbranca/followers","following_url":"https://api.github.com/users/chewbranca/following{/other_user}","gists_url":"https://api.github.com/users/chewbranca/gists{/gist_id}","starred_url":"https://api.github.com/users/chewbranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chewbranca/subscriptions","organizations_url":"https://api.github.com/users/chewbranca/orgs","repos_url":"https://api.github.com/users/chewbranca/repos","events_url":"https://api.github.com/users/chewbranca/events{/privacy}","received_events_url":"https://api.github.com/users/chewbranca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-01T01:06:42Z","updated_at":"2017-07-01T01:06:42Z","author_association":"CONTRIBUTOR","body":"@davisp hehehehe happy to help with the sniping ;-)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312401351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312407752","html_url":"https://github.com/apache/couchdb/pull/610#issuecomment-312407752","issue_url":"https://api.github.com/repos/apache/couchdb/issues/610","id":312407752,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjQwNzc1Mg==","user":{"login":"chewbranca","id":5326,"node_id":"MDQ6VXNlcjUzMjY=","avatar_url":"https://avatars.githubusercontent.com/u/5326?v=4","gravatar_id":"","url":"https://api.github.com/users/chewbranca","html_url":"https://github.com/chewbranca","followers_url":"https://api.github.com/users/chewbranca/followers","following_url":"https://api.github.com/users/chewbranca/following{/other_user}","gists_url":"https://api.github.com/users/chewbranca/gists{/gist_id}","starred_url":"https://api.github.com/users/chewbranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chewbranca/subscriptions","organizations_url":"https://api.github.com/users/chewbranca/orgs","repos_url":"https://api.github.com/users/chewbranca/repos","events_url":"https://api.github.com/users/chewbranca/events{/privacy}","received_events_url":"https://api.github.com/users/chewbranca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-01T03:37:16Z","updated_at":"2017-07-01T03:37:16Z","author_association":"CONTRIBUTOR","body":"@davisp overall looks solid to me.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312407752/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312455255","html_url":"https://github.com/apache/couchdb/pull/626#issuecomment-312455255","issue_url":"https://api.github.com/repos/apache/couchdb/issues/626","id":312455255,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjQ1NTI1NQ==","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-01T20:59:33Z","updated_at":"2017-07-01T20:59:44Z","author_association":"CONTRIBUTOR","body":"@nickva @eiri thanks for the reviews!\r\n\r\nI've updated this PR to allow \"decom\" to be either `true` or `\"true\"` to work.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312455255/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312542128","html_url":"https://github.com/apache/couchdb/pull/627#issuecomment-312542128","issue_url":"https://api.github.com/repos/apache/couchdb/issues/627","id":312542128,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjU0MjEyOA==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-03T03:33:19Z","updated_at":"2017-07-03T03:34:18Z","author_association":"CONTRIBUTOR","body":"The only thing that confuses me here a bit is that the original bug poster mentioned he created a index on id and name field. The error for ```fabric:all_docs``` call is initiated when there's no user-defined index, and we have to use the _all_docs index to retrieve results. It would be nice to have a python test that tries to query the _users db with and without an index just to be safe. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312542128/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312544173","html_url":"https://github.com/apache/couchdb/pull/627#issuecomment-312544173","issue_url":"https://api.github.com/repos/apache/couchdb/issues/627","id":312544173,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjU0NDE3Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-03T03:53:55Z","updated_at":"2017-07-03T03:53:55Z","author_association":"MEMBER","body":"@tonysun83 Ideally it'd be a eunit or a javascript test. Apache CouchDB has no python test framework at present.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312544173/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312572199","html_url":"https://github.com/apache/couchdb/pull/627#issuecomment-312572199","issue_url":"https://api.github.com/repos/apache/couchdb/issues/627","id":312572199,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjU3MjE5OQ==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-03T07:39:40Z","updated_at":"2017-07-03T07:39:40Z","author_association":"MEMBER","body":"@wohali the mango test suite is a python test suite https://github.com/apache/couchdb/tree/master/src/mango/test","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312572199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312634839","html_url":"https://github.com/apache/couchdb/pull/627#issuecomment-312634839","issue_url":"https://api.github.com/repos/apache/couchdb/issues/627","id":312634839,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjYzNDgzOQ==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-03T12:39:31Z","updated_at":"2017-07-03T12:39:31Z","author_association":"MEMBER","body":"@tonysun83 I've followed the steps in the original issue and got the described `case_clause` error, so I take it that actually there were no index created.\r\n\r\nSure, I'll add the notetests, but as @wohali mentioned, that mango's python test ran neither by travis or jenkins, so that's not awfully useful.  ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312634839/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312670308","html_url":"https://github.com/apache/couchdb/pull/626#issuecomment-312670308","issue_url":"https://api.github.com/repos/apache/couchdb/issues/626","id":312670308,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjY3MDMwOA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-03T15:06:11Z","updated_at":"2017-07-03T15:06:11Z","author_association":"CONTRIBUTOR","body":"@jaydoane looks good!\r\n\r\n+1 (but see comment about `andalso`)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/312670308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]