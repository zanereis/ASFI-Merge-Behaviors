[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945681519","html_url":"https://github.com/apache/iceberg/pull/3095#issuecomment-945681519","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3095","id":945681519,"node_id":"IC_kwDOCW7NX844XfRv","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T11:43:52Z","updated_at":"2021-10-18T11:43:52Z","author_association":"MEMBER","body":"Thanks for the work @hameizi , I think I will take a look at this tomorrow ! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945681519/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945696196","html_url":"https://github.com/apache/iceberg/issues/3299#issuecomment-945696196","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3299","id":945696196,"node_id":"IC_kwDOCW7NX844Xi3E","user":{"login":"fengguangyuan","id":10569747,"node_id":"MDQ6VXNlcjEwNTY5NzQ3","avatar_url":"https://avatars.githubusercontent.com/u/10569747?v=4","gravatar_id":"","url":"https://api.github.com/users/fengguangyuan","html_url":"https://github.com/fengguangyuan","followers_url":"https://api.github.com/users/fengguangyuan/followers","following_url":"https://api.github.com/users/fengguangyuan/following{/other_user}","gists_url":"https://api.github.com/users/fengguangyuan/gists{/gist_id}","starred_url":"https://api.github.com/users/fengguangyuan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fengguangyuan/subscriptions","organizations_url":"https://api.github.com/users/fengguangyuan/orgs","repos_url":"https://api.github.com/users/fengguangyuan/repos","events_url":"https://api.github.com/users/fengguangyuan/events{/privacy}","received_events_url":"https://api.github.com/users/fengguangyuan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T12:05:03Z","updated_at":"2021-10-18T12:05:03Z","author_association":"NONE","body":"From the test files `TestRewriteFiles.java` and `TestCreateActions.java`, you could figure out the following sample code:\r\n```java\r\nTestTables.TestTable table = TestTables.create(tableDir, \"test\", schema, spec, formatVersion);\r\n// or you do not need create a new HiveCatalog, instead using the internal\r\n// TableCatalog catalog = (TableCatalog) spark.sessionState().catalogManager().catalog(\"spark_catalog\");\r\n// SparkTable table =  catalog.loadTable(\"SUBSCRIBER\");\r\ntable.newRewrite()\r\n            .rewriteFiles(ImmutableSet.of(FILE_A), ImmutableSet.of(),\r\n                ImmutableSet.of(), ImmutableSet.of(FILE_A_DELETES))\r\n            .apply()\r\n```\r\nI think you lose the `apply()` action here.\r\nOr you may code simply:\r\n```java\r\n      spark.read().parquet(\"/path.parquet\").writeTo(\"SUBSCRIBER\");\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945696196/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945710063","html_url":"https://github.com/apache/iceberg/pull/3186#issuecomment-945710063","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3186","id":945710063,"node_id":"IC_kwDOCW7NX844XmPv","user":{"login":"rice668","id":6520673,"node_id":"MDQ6VXNlcjY1MjA2NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6520673?v=4","gravatar_id":"","url":"https://api.github.com/users/rice668","html_url":"https://github.com/rice668","followers_url":"https://api.github.com/users/rice668/followers","following_url":"https://api.github.com/users/rice668/following{/other_user}","gists_url":"https://api.github.com/users/rice668/gists{/gist_id}","starred_url":"https://api.github.com/users/rice668/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rice668/subscriptions","organizations_url":"https://api.github.com/users/rice668/orgs","repos_url":"https://api.github.com/users/rice668/repos","events_url":"https://api.github.com/users/rice668/events{/privacy}","received_events_url":"https://api.github.com/users/rice668/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T12:21:51Z","updated_at":"2021-10-18T12:21:51Z","author_association":"CONTRIBUTOR","body":"Hi @rdblue , Could you please take a look on this ? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945710063/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945773103","html_url":"https://github.com/apache/iceberg/issues/2575#issuecomment-945773103","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2575","id":945773103,"node_id":"IC_kwDOCW7NX844X1ov","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T13:33:29Z","updated_at":"2021-10-18T13:33:29Z","author_association":"CONTRIBUTOR","body":"I have been running into this quite frequently in the past, so I disabled it in https://github.com/apache/iceberg/pull/3307 until it's fixed","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945773103/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945773969","html_url":"https://github.com/apache/iceberg/issues/2384#issuecomment-945773969","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2384","id":945773969,"node_id":"IC_kwDOCW7NX844X12R","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T13:34:25Z","updated_at":"2021-10-18T13:34:25Z","author_association":"CONTRIBUTOR","body":"already covered by #2575, so closinig this","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945773969/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945779397","html_url":"https://github.com/apache/iceberg/pull/3305#issuecomment-945779397","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3305","id":945779397,"node_id":"IC_kwDOCW7NX844X3LF","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T13:40:27Z","updated_at":"2021-10-18T13:40:27Z","author_association":"CONTRIBUTOR","body":"Thanks for the review and the merge @openinx!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945779397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945800570","html_url":"https://github.com/apache/iceberg/issues/3157#issuecomment-945800570","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3157","id":945800570,"node_id":"IC_kwDOCW7NX844X8V6","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T13:58:35Z","updated_at":"2021-10-18T13:58:35Z","author_association":"CONTRIBUTOR","body":"For completeness, here's the thread dump:\r\n```\r\n\r\n\"org.apache.iceberg.spark.source.parquet.vectorized.VectorizedReadDictionaryEncodedFlatParquetDataBenchmark.readDatesIcebergVectorized5k-jmh-worker-1\" #24 daemon prio=5 os_prio=0 cpu=5302.39ms elapsed=71.73s allocated=664M defined_classes=11244 tid=0x00007fce504e5800 nid=0x12fe waiting on condition  [0x00007fce0e45a000]\r\n   java.lang.Thread.State: WAITING (parking)\r\n\tat jdk.internal.misc.Unsafe.park(java.base@11.0.12/Native Method)\r\n\t- parking to wait for  <0x000000060cad0600> (a scala.concurrent.impl.Promise$CompletionLatch)\r\n\tat java.util.concurrent.locks.LockSupport.park(java.base@11.0.12/LockSupport.java:194)\r\n\tat java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(java.base@11.0.12/AbstractQueuedSynchronizer.java:885)\r\n\tat java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(java.base@11.0.12/AbstractQueuedSynchronizer.java:1039)\r\n\tat java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(java.base@11.0.12/AbstractQueuedSynchronizer.java:1345)\r\n\tat scala.concurrent.impl.Promise$DefaultPromise.tryAwait(Promise.scala:242)\r\n\tat scala.concurrent.impl.Promise$DefaultPromise.ready(Promise.scala:258)\r\n\tat scala.concurrent.impl.Promise$DefaultPromise.ready(Promise.scala:187)\r\n\tat org.apache.spark.util.ThreadUtils$.awaitReady(ThreadUtils.scala:335)\r\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:766)\r\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2114)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2TableWriteExec.writeWithV2(WriteToDataSourceV2Exec.scala:382)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2TableWriteExec.writeWithV2$(WriteToDataSourceV2Exec.scala:361)\r\n\tat org.apache.spark.sql.execution.datasources.v2.AppendDataExec.writeWithV2(WriteToDataSourceV2Exec.scala:253)\r\n\tat org.apache.spark.sql.execution.datasources.v2.AppendDataExec.run(WriteToDataSourceV2Exec.scala:259)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2CommandExec.result$lzycompute(V2CommandExec.scala:39)\r\n\t- locked <0x000000060cad07e8> (a org.apache.spark.sql.execution.datasources.v2.AppendDataExec)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2CommandExec.result(V2CommandExec.scala:39)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2CommandExec.doExecute(V2CommandExec.scala:54)\r\n\tat org.apache.spark.sql.execution.SparkPlan.$anonfun$execute$1(SparkPlan.scala:180)\r\n\tat org.apache.spark.sql.execution.SparkPlan$$Lambda$1416/0x0000000800c9f840.apply(Unknown Source)\r\n\tat org.apache.spark.sql.execution.SparkPlan.$anonfun$executeQuery$1(SparkPlan.scala:218)\r\n\tat org.apache.spark.sql.execution.SparkPlan$$Lambda$1441/0x0000000800cbc440.apply(Unknown Source)\r\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\r\n\tat org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:215)\r\n\tat org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:176)\r\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:127)\r\n\t- locked <0x000000060cad09f0> (a org.apache.spark.sql.execution.QueryExecution)\r\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:126)\r\n\tat org.apache.spark.sql.DataFrameWriter.$anonfun$runCommand$1(DataFrameWriter.scala:962)\r\n\tat org.apache.spark.sql.DataFrameWriter$$Lambda$1674/0x0000000800e42040.apply(Unknown Source)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:100)\r\n\tat org.apache.spark.sql.execution.SQLExecution$$$Lambda$1679/0x0000000800e44840.apply(Unknown Source)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:160)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:87)\r\n\tat org.apache.spark.sql.execution.SQLExecution$$$Lambda$1675/0x0000000800e42440.apply(Unknown Source)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:767)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\r\n\tat org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:962)\r\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:353)\r\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:287)\r\n\tat org.apache.iceberg.spark.source.IcebergSourceBenchmark.appendAsFile(IcebergSourceBenchmark.java:127)\r\n\tat org.apache.iceberg.spark.source.parquet.vectorized.VectorizedReadDictionaryEncodedFlatParquetDataBenchmark.appendData(VectorizedReadDictionaryEncodedFlatParquetDataBenchmark.java:83)\r\n\tat org.apache.iceberg.spark.source.parquet.vectorized.VectorizedReadDictionaryEncodedFlatParquetDataBenchmark.setupBenchmark(VectorizedReadDictionaryEncodedFlatParquetDataBenchmark.java:57)\r\n\tat org.apache.iceberg.spark.source.parquet.vectorized.jmh_generated.VectorizedReadDictionaryEncodedFlatParquetDataBenchmark_readDatesIcebergVectorized5k_jmhTest._jmh_tryInit_f_vectorizedreaddictionaryencodedflatparquetdatabenchmark0_G(VectorizedReadDictionaryEncodedFlatParquetDataBenchmark_readDatesIcebergVectorized5k_jmhTest.java:438)\r\n\t- locked <0x000000060aaa13b0> (a java.lang.Class for org.apache.iceberg.spark.source.parquet.vectorized.jmh_generated.VectorizedReadDictionaryEncodedFlatParquetDataBenchmark_readDatesIcebergVectorized5k_jmhTest)\r\n\tat org.apache.iceberg.spark.source.parquet.vectorized.jmh_generated.VectorizedReadDictionaryEncodedFlatParquetDataBenchmark_readDatesIcebergVectorized5k_jmhTest.readDatesIcebergVectorized5k_SingleShotTime(VectorizedReadDictionaryEncodedFlatParquetDataBenchmark_readDatesIcebergVectorized5k_jmhTest.java:363)\r\n\tat jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(java.base@11.0.12/Native Method)\r\n\tat jdk.internal.reflect.NativeMethodAccessorImpl.invoke(java.base@11.0.12/NativeMethodAccessorImpl.java:62)\r\n\tat jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(java.base@11.0.12/DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(java.base@11.0.12/Method.java:566)\r\n\tat org.openjdk.jmh.runner.BenchmarkHandler$BenchmarkTask.call(BenchmarkHandler.java:470)\r\n\tat org.openjdk.jmh.runner.BenchmarkHandler$BenchmarkTask.call(BenchmarkHandler.java:453)\r\n\tat java.util.concurrent.FutureTask.run(java.base@11.0.12/FutureTask.java:264)\r\n\tat java.util.concurrent.Executors$RunnableAdapter.call(java.base@11.0.12/Executors.java:515)\r\n\tat java.util.concurrent.FutureTask.run(java.base@11.0.12/FutureTask.java:264)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@11.0.12/ThreadPoolExecutor.java:1128)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@11.0.12/ThreadPoolExecutor.java:628)\r\n\tat java.lang.Thread.run(java.base@11.0.12/Thread.java:829)\r\n\r\n   Locked ownable synchronizers:\r\n\t- <0x000000060b7b9a80> (a java.util.concurrent.ThreadPoolExecutor$Worker)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945800570/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945887024","html_url":"https://github.com/apache/iceberg/pull/3288#issuecomment-945887024","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3288","id":945887024,"node_id":"IC_kwDOCW7NX844YRcw","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T15:20:38Z","updated_at":"2021-10-18T15:20:38Z","author_association":"CONTRIBUTOR","body":"Overall, this looks good to me. There are a few minor things left, but I think it is about ready. Thanks for working on this, @xingbowu!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945887024/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945894573","html_url":"https://github.com/apache/iceberg/pull/3099#issuecomment-945894573","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3099","id":945894573,"node_id":"IC_kwDOCW7NX844YTSt","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T15:28:28Z","updated_at":"2021-10-18T15:28:28Z","author_association":"CONTRIBUTOR","body":"Thanks for getting this in, @pvary and @szehon-ho!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945894573/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945897346","html_url":"https://github.com/apache/iceberg/pull/3302#issuecomment-945897346","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3302","id":945897346,"node_id":"IC_kwDOCW7NX844YT-C","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T15:31:27Z","updated_at":"2021-10-18T15:31:27Z","author_association":"CONTRIBUTOR","body":"Thanks, @nastra! Sorry I accidentally broke JMH!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945897346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945912293","html_url":"https://github.com/apache/iceberg/pull/3301#issuecomment-945912293","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3301","id":945912293,"node_id":"IC_kwDOCW7NX844YXnl","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T15:45:48Z","updated_at":"2021-10-18T15:45:48Z","author_association":"CONTRIBUTOR","body":"@ConeyLiu, can you explain what the problem is in a bit more detail? An example would help. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945912293/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945926963","html_url":"https://github.com/apache/iceberg/pull/3300#issuecomment-945926963","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3300","id":945926963,"node_id":"IC_kwDOCW7NX844YbMz","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T16:02:50Z","updated_at":"2021-10-18T16:02:50Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945926963/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945927467","html_url":"https://github.com/apache/iceberg/pull/3300#issuecomment-945927467","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3300","id":945927467,"node_id":"IC_kwDOCW7NX844YbUr","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T16:03:22Z","updated_at":"2021-10-18T16:03:22Z","author_association":"CONTRIBUTOR","body":"Thanks, @aokolnychyi!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945927467/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945941096","html_url":"https://github.com/apache/iceberg/pull/3301#issuecomment-945941096","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3301","id":945941096,"node_id":"IC_kwDOCW7NX844Yepo","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T16:17:15Z","updated_at":"2021-10-18T16:17:15Z","author_association":"MEMBER","body":"This looks like a followup on our discussion of taking account of possible deleted records when estimating size of files being rewritten.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945941096/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945942719","html_url":"https://github.com/apache/iceberg/issues/3246#issuecomment-945942719","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3246","id":945942719,"node_id":"IC_kwDOCW7NX844YfC_","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T16:19:11Z","updated_at":"2021-10-18T16:19:11Z","author_association":"CONTRIBUTOR","body":"Using the `GC_ENABLED` flag makes probably sense.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945942719/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945972064","html_url":"https://github.com/apache/iceberg/issues/3228#issuecomment-945972064","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3228","id":945972064,"node_id":"IC_kwDOCW7NX844YmNg","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T16:55:28Z","updated_at":"2021-10-18T16:55:28Z","author_association":"CONTRIBUTOR","body":"This depends on the work in https://github.com/apache/iceberg/issues/3216 for types definition.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945972064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945987029","html_url":"https://github.com/apache/iceberg/pull/3279#issuecomment-945987029","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3279","id":945987029,"node_id":"IC_kwDOCW7NX844Yp3V","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T17:13:17Z","updated_at":"2021-10-18T17:13:17Z","author_association":"CONTRIBUTOR","body":"Looks good to me. Thanks @ajantha-bhat!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945987029/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946012151","html_url":"https://github.com/apache/iceberg/pull/3275#issuecomment-946012151","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3275","id":946012151,"node_id":"IC_kwDOCW7NX844Yv_3","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T17:45:33Z","updated_at":"2021-10-18T17:45:33Z","author_association":"CONTRIBUTOR","body":"Previously, a namespace existed if there was a table in that namespace. This changes the definition so that a namespace exists if there is a row in the namespaces table. That is an incompatible definition. I think we need to decide what the behavior should be for the JDBC catalog, and then make sure that the implementation is consistent. If you should be able to implicitly create a namespace by creating a table (as is still allowed) then this needs to return that a namespace exists if a table is in the namespace. On the other hand, if that isn't allowed then `createTable` needs to be updated to check `namespaceExists`. I think that because namespaces have been implicitly created up to now, we should either continue to allow it (for compatibility with existing catalogs) or we should add a property that enables the more strict behavior (probably preferred).\r\n\r\nNext, it looks like this creates a generic table with catalog name, namespace name, and string blobs. Is that the right way to go? Why not use a `namespace_properties` table that has the schema `catalog string, namespace string, key string, value string`? A namespace would exist if there is a table with the namespace or if there is at least one property for the namespace. That seems like a better way to model the information than converting to and from JSON or base64 to me. What is the benefit of using a row per namespace instead?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946012151/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946016616","html_url":"https://github.com/apache/iceberg/pull/3307#issuecomment-946016616","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3307","id":946016616,"node_id":"IC_kwDOCW7NX844YxFo","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T17:50:47Z","updated_at":"2021-10-18T17:50:47Z","author_association":"CONTRIBUTOR","body":"Linking the issue here: https://github.com/apache/iceberg/issues/2575","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946016616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946019086","html_url":"https://github.com/apache/iceberg/pull/3213#issuecomment-946019086","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3213","id":946019086,"node_id":"IC_kwDOCW7NX844YxsO","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T17:54:17Z","updated_at":"2021-10-18T17:54:17Z","author_association":"CONTRIBUTOR","body":"> > > @rdblue @kbendick @stevenzwu , could you help to review this PR? :)\r\n> > \r\n> > \r\n> > Thanks for working on this @myandpr. I am off this week but am interested in this so will review but might be a bit slow to respond. 🙂\r\n> > I agree with @rdblue's that it makes sense to avoid trying to compact the whole table (or scan the whole table) in an online streaming context, but rather pass around the file names that need to be compacted and committed.\r\n> \r\n> Hi @kbendick , I'd like to hear your opinion on my doubts [https://github.com/apache/iceberg/pull/3213#discussion_r724905119🙂](https://github.com/apache/iceberg/pull/3213#discussion_r724905119%F0%9F%99%82)\r\n\r\nHi @myandpr! Sorry I was also out of office for a bit so catching up on things still somewhat. Will take a look ASAP!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946019086/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946025275","html_url":"https://github.com/apache/iceberg/pull/3275#issuecomment-946025275","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3275","id":946025275,"node_id":"IC_kwDOCW7NX844YzM7","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T18:02:32Z","updated_at":"2021-10-18T18:02:32Z","author_association":"CONTRIBUTOR","body":"Thanks for the comments @rdblue .\r\n\r\nre: namespace and table\r\nI would prefer the scricter approach since it has the check in place to ensure a table is created only if a namespace exists. A config can be added for legacy reasons but that will mean a dual behavior for the NamespaceExists logic - one with the config and one without. If that breaking change is ok with the community and can be rolled out, I think I can amend the PR to have that implementation.\r\nThe only implementation issue I see here is we need to add the properties that the Catalog is initialized with to get connection properties within the JdbcTableOperations class. I have this in the larger PR https://github.com/apache/iceberg/pull/3274 by adding a dbProperties field. \r\n\r\nre: table schema\r\nI agree and I think that makes more sense. A namespace_properties table could hold the properties with a single row representing a property per namespace. I see this akin to the Hive Metastore. \r\nWe just have to do some stitching of the properties when retrieving for a single namespace.\r\nRemoval will be easier in this model.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946025275/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946038474","html_url":"https://github.com/apache/iceberg/pull/3213#issuecomment-946038474","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3213","id":946038474,"node_id":"IC_kwDOCW7NX844Y2bK","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T18:16:37Z","updated_at":"2021-10-18T18:16:37Z","author_association":"CONTRIBUTOR","body":"> Hi folks,\r\n> \r\n> I am an Apache Flink contributor and we are currently evaluating different options for this \"small-file\" problem. So far we only support the compaction of small files when using the StreamingFileSink [1]. Apparently, you have implemented your own way of writing files before committing them to Iceberg I'd also be happy to know the reason.\r\n> \r\n> We are open to feedback on what you need from Flink to support your use case because we are seeing a lot of other projects hitting the same problems (Hive, DeltaLake etc.)\r\n> \r\n> [1] https://github.com/apache/flink/blob/ac203a7a26d78fe270bd9941bb721be53a893040/flink-table/flink-table-runtime/src/main/java/org/apache/flink/table/filesystem/stream/StreamingSink.java#L82\r\n\r\nHi @fapaul! I wanted to firstly thank you for dropping by and introduce myself. I believe Ryan already answered your questions, but if you have any other questions you can always feel free to reach out to me (or anyone) and I'd be happy to help or try to point you in the right place. I often work or review Flink-Iceberg related stuff and there are some things I've seen here and there that might have been helpful for us or would be helpful for us in the future. Hope to collaborate with you over there or in here in the future!  🙂 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946038474/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946061427","html_url":"https://github.com/apache/iceberg/pull/3275#issuecomment-946061427","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3275","id":946061427,"node_id":"IC_kwDOCW7NX844Y8Bz","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T18:45:16Z","updated_at":"2021-10-18T18:45:16Z","author_association":"CONTRIBUTOR","body":"Also, I couldn't get clarity on whether we need both namespace `metadata` and `properties` or only properties, based on @jackye1995 's earlier comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946061427/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946073138","html_url":"https://github.com/apache/iceberg/pull/3275#issuecomment-946073138","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3275","id":946073138,"node_id":"IC_kwDOCW7NX844Y-4y","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T19:01:45Z","updated_at":"2021-10-18T19:01:45Z","author_association":"CONTRIBUTOR","body":"> A config can be added for legacy reasons but that will mean a dual behavior for the NamespaceExists logic - one with the config and one without. If that breaking change is ok with the community and can be rolled out, I think I can amend the PR to have that implementation.\r\n\r\nI don't think we should introduce a breaking change like this. We could, in theory, fix it up when starting up the catalog by populating the table... but that's a bit odd. I think it's better to keep behavior and allow an option to be more strict.\r\n\r\n> The only implementation issue I see here is . . .\r\n\r\nI didn't follow this. Can you explain it a bit more for me?\r\n\r\n> I agree and I think that makes more sense. A namespace_properties table could hold the properties with a single row representing a property per namespace. I see this akin to the Hive Metastore.\r\n\r\nThe trade-off here is that removing the last namespace property would basically drop the namespace. In that case, the logic to check whether tables or properties exist is actually a good thing. I like the idea of the two table being loosely coupled.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946073138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946079146","html_url":"https://github.com/apache/iceberg/pull/3275#issuecomment-946079146","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3275","id":946079146,"node_id":"IC_kwDOCW7NX844ZAWq","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T19:08:03Z","updated_at":"2021-10-18T19:08:03Z","author_association":"CONTRIBUTOR","body":"> I didn't follow this. Can you explain it a bit more for me?\r\n\r\nThe `JdbcTableOperations` doesn't seem to have the properties that are used to initialize the `JdbcCatalog`. I noticed this in tests. For `namespaceExists` to work in `JdbcTableOperations` there has to be an instance of `JdbcCatalog` in `JdbcTableOperations`. \r\n\r\n\r\nMore explanation: \r\n1. I added this field https://github.com/apache/iceberg/blob/a72de755ac3985af1db61f8cc4080834fd59feb8/core/src/main/java/org/apache/iceberg/jdbc/JdbcCatalog.java#L74 to be passed \r\nhttps://github.com/apache/iceberg/blob/a72de755ac3985af1db61f8cc4080834fd59feb8/core/src/main/java/org/apache/iceberg/jdbc/JdbcCatalog.java#L144\r\n2. This helps to initialize the catalog with the same connection properties as the JdbcCatalog: https://github.com/apache/iceberg/blob/a72de755ac3985af1db61f8cc4080834fd59feb8/core/src/main/java/org/apache/iceberg/jdbc/JdbcTableOperations.java#L65 \r\n\r\nMaybe there's a cleaner way to do this that I am missing. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946079146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946081993","html_url":"https://github.com/apache/iceberg/pull/3275#issuecomment-946081993","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3275","id":946081993,"node_id":"IC_kwDOCW7NX844ZBDJ","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T19:11:34Z","updated_at":"2021-10-18T19:11:34Z","author_association":"CONTRIBUTOR","body":"> I don't think we should introduce a breaking change like this. We could, in theory, fix it up when starting up the catalog by populating the table... but that's a bit odd. I think it's better to keep behavior and allow an option to be more strict.\r\n\r\nAgreed. \r\n\r\n> The trade-off here is that removing the last namespace property would basically drop the namespace. In that case, the logic to check whether tables or properties exist is actually a good thing. I like the idea of the two table being loosely coupled.\r\n\r\nAgreed.\r\n\r\nI'll make the changes in upcoming commits.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946081993/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946104928","html_url":"https://github.com/apache/iceberg/issues/2962#issuecomment-946104928","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2962","id":946104928,"node_id":"IC_kwDOCW7NX844ZGpg","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T19:42:01Z","updated_at":"2021-10-18T19:42:01Z","author_association":"CONTRIBUTOR","body":"Thanks to @kbendick providing a table that reproduces the problem, I've been able to debug to find out what's going on here. The issue is in column pruning. When Iceberg prunes the fields in the file schema using the expected Iceberg schema, it can return a Parquet schema that doesn't match the file anymore because of the field rename.\r\n\r\nIceberg uses Parquet's `Types.map` builder to produce a [new map type in `PruneColumns`](https://github.com/apache/iceberg/blob/0.11.x/parquet/src/main/java/org/apache/iceberg/parquet/PruneColumns.java#L133-L136). But that was changed in https://github.com/apache/parquet-mr/pull/798 to produce a key/value records named `key_value` instead of `map`. So rebuilding the type using Parquet's helpers actually produces a type with different names. Then Iceberg passes the new schema into Parquet as the projection and that causes the map column to be dropped because there is no `mapCol.key_value` structure, instead there is a `mapCol.map`.\r\n\r\nThe reason why this sometimes works in 0.12.0 is that the value check changed to `equals` instead of identity (`==`), so if you project the whole value the original map is returned. You can reproduce the issue in 0.12.0 by selecting a projection of the map value rather than `*`. For example:\r\n\r\n```sql\r\nSELECT mapCol.value.str FROM repro_table\r\n```\r\n\r\nThe solution is to rebuild the map structure to exactly match the incoming file schema rather than relying on Parquet to produce the same thing across versions. I'll open a PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946104928/reactions","total_count":3,"+1":0,"-1":0,"laugh":0,"hooray":3,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946107850","html_url":"https://github.com/apache/iceberg/issues/2962#issuecomment-946107850","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2962","id":946107850,"node_id":"IC_kwDOCW7NX844ZHXK","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T19:46:38Z","updated_at":"2021-10-18T19:46:38Z","author_association":"CONTRIBUTOR","body":"> The solution is to rebuild the map structure to exactly match the incoming file schema rather than relying on Parquet to produce the same thing across versions. I'll open a PR.\r\n\r\nThank you @rdblue! It will be good to have this solution in place that doesn't rely on parquet producing the same thing across versions. Great find.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946107850/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946125926","html_url":"https://github.com/apache/iceberg/pull/3304#issuecomment-946125926","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3304","id":946125926,"node_id":"IC_kwDOCW7NX844ZLxm","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T20:10:31Z","updated_at":"2021-10-18T20:10:31Z","author_association":"CONTRIBUTOR","body":"That seems like a lot tags to add for benchmarks. We would probably need to keep those up to date, and it would clutter the PR list.\r\n\r\nIs it possible to either reduce the number of tags to groups, like arrow-benchmarks and spark-benchmarks, or to change this to run benchmarks when specific files change instead? It seems like those would be easier ways to configure this. I'm a fan of using Github actions, though!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946125926/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946150341","html_url":"https://github.com/apache/iceberg/issues/2962#issuecomment-946150341","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2962","id":946150341,"node_id":"IC_kwDOCW7NX844ZRvF","user":{"login":"edgarRd","id":266670,"node_id":"MDQ6VXNlcjI2NjY3MA==","avatar_url":"https://avatars.githubusercontent.com/u/266670?v=4","gravatar_id":"","url":"https://api.github.com/users/edgarRd","html_url":"https://github.com/edgarRd","followers_url":"https://api.github.com/users/edgarRd/followers","following_url":"https://api.github.com/users/edgarRd/following{/other_user}","gists_url":"https://api.github.com/users/edgarRd/gists{/gist_id}","starred_url":"https://api.github.com/users/edgarRd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edgarRd/subscriptions","organizations_url":"https://api.github.com/users/edgarRd/orgs","repos_url":"https://api.github.com/users/edgarRd/repos","events_url":"https://api.github.com/users/edgarRd/events{/privacy}","received_events_url":"https://api.github.com/users/edgarRd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T20:44:27Z","updated_at":"2021-10-18T20:44:27Z","author_association":"CONTRIBUTOR","body":"> Since you're importing tables, can you run parquet-cli meta on the files that are imported and see what parquet version they are?\r\n\r\nFiles were created originally with Parquet `1.8.1` in Hive 2.3.4\r\n\r\nThanks @kbendick and @rdblue for debugging this issue with a solution directly in Iceberg, this is great news!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946150341/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946203193","html_url":"https://github.com/apache/iceberg/pull/2829#issuecomment-946203193","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2829","id":946203193,"node_id":"IC_kwDOCW7NX844Zeo5","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T22:03:28Z","updated_at":"2021-10-18T22:03:28Z","author_association":"MEMBER","body":"Thanks @rdblue for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946203193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946226124","html_url":"https://github.com/apache/iceberg/pull/3310#issuecomment-946226124","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3310","id":946226124,"node_id":"IC_kwDOCW7NX844ZkPM","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T22:46:40Z","updated_at":"2021-10-18T22:46:40Z","author_association":"CONTRIBUTOR","body":"Looks like Flink tests run in about 9 minutes, like the core tests. So when only Flink is modified, this should save quite a bit of time.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946226124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946227676","html_url":"https://github.com/apache/iceberg/pull/3309#issuecomment-946227676","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3309","id":946227676,"node_id":"IC_kwDOCW7NX844Zknc","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T22:50:12Z","updated_at":"2021-10-18T22:50:12Z","author_association":"CONTRIBUTOR","body":"We can add a test for `PruneColumns` directly that uses an alternative map structure. The only issue is that I had some trouble building the map type without going through the `Types` API. But there's probably a different way to do it that I was missing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946227676/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946249884","html_url":"https://github.com/apache/iceberg/pull/3312#issuecomment-946249884","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3312","id":946249884,"node_id":"IC_kwDOCW7NX844ZqCc","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T23:40:17Z","updated_at":"2021-10-18T23:40:17Z","author_association":"CONTRIBUTOR","body":"Thanks, @edgarRd!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946249884/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946256032","html_url":"https://github.com/apache/iceberg/pull/3312#issuecomment-946256032","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3312","id":946256032,"node_id":"IC_kwDOCW7NX844Zrig","user":{"login":"edgarRd","id":266670,"node_id":"MDQ6VXNlcjI2NjY3MA==","avatar_url":"https://avatars.githubusercontent.com/u/266670?v=4","gravatar_id":"","url":"https://api.github.com/users/edgarRd","html_url":"https://github.com/edgarRd","followers_url":"https://api.github.com/users/edgarRd/followers","following_url":"https://api.github.com/users/edgarRd/following{/other_user}","gists_url":"https://api.github.com/users/edgarRd/gists{/gist_id}","starred_url":"https://api.github.com/users/edgarRd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edgarRd/subscriptions","organizations_url":"https://api.github.com/users/edgarRd/orgs","repos_url":"https://api.github.com/users/edgarRd/repos","events_url":"https://api.github.com/users/edgarRd/events{/privacy}","received_events_url":"https://api.github.com/users/edgarRd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T23:57:45Z","updated_at":"2021-10-18T23:57:45Z","author_association":"CONTRIBUTOR","body":"Thanks, @rdblue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946256032/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946259363","html_url":"https://github.com/apache/iceberg/pull/3309#issuecomment-946259363","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3309","id":946259363,"node_id":"IC_kwDOCW7NX844ZsWj","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T00:06:16Z","updated_at":"2021-10-19T00:06:16Z","author_association":"CONTRIBUTOR","body":"Added the missing tests. I'll merge this when tests are passing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946259363/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946260935","html_url":"https://github.com/apache/iceberg/pull/3258#issuecomment-946260935","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3258","id":946260935,"node_id":"IC_kwDOCW7NX844ZsvH","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T00:10:16Z","updated_at":"2021-10-19T00:10:16Z","author_association":"CONTRIBUTOR","body":"Rebased and removed the test. I'll merge this when CI is passing. I also marked this for inclusion in a patch release, 0.12.1.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946260935/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946317431","html_url":"https://github.com/apache/iceberg/pull/3301#issuecomment-946317431","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3301","id":946317431,"node_id":"IC_kwDOCW7NX844Z6h3","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T02:37:57Z","updated_at":"2021-10-19T02:37:57Z","author_association":"CONTRIBUTOR","body":"> can you explain what the problem is in a bit more detail? An example would help. Thanks!\r\n\r\n@rdblue, I have updated the description. It should be more clearly.\r\n\r\n> This looks like a followup on our discussion of taking account of possible deleted records when estimating size of files being rewritten.\r\n\r\n@RussellSpitzer, this only disables count the weight of delete files when plan tasks. I have tried to estimate the file size after applied delete files, however I think we could only do this for position delete. I could submit a following pr if it is OK.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946317431/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946331382","html_url":"https://github.com/apache/iceberg/pull/3258#issuecomment-946331382","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3258","id":946331382,"node_id":"IC_kwDOCW7NX844Z972","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T03:15:30Z","updated_at":"2021-10-19T03:15:30Z","author_association":"MEMBER","body":"The broken unit test is the flaky one,  let's retry the CI.\r\n\r\n```java\r\norg.apache.iceberg.flink.TestFlinkTableSink > testHashDistributeMode[catalogName=testhadoop_basenamespace, baseNamespace=l0.l1, format=ORC, isStreaming=true] FAILED\r\n    java.lang.AssertionError: There should be 1 data file in partition 'aaa' expected:<1> but was:<2>\r\n        at org.junit.Assert.fail(Assert.java:89)\r\n        at org.junit.Assert.failNotEquals(Assert.java:835)\r\n        at org.junit.Assert.assertEquals(Assert.java:647)\r\n        at org.apache.iceberg.flink.TestFlinkTableSink.testHashDistributeMode(TestFlinkTableSink.java:281)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946331382/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946343329","html_url":"https://github.com/apache/iceberg/pull/3309#issuecomment-946343329","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3309","id":946343329,"node_id":"IC_kwDOCW7NX844aA2h","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T03:47:29Z","updated_at":"2021-10-19T03:47:29Z","author_association":"CONTRIBUTOR","body":"> Added the missing tests. I'll merge this when tests are passing.\r\n\r\nThese are great tests and this is great work. Thank you!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946343329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946346453","html_url":"https://github.com/apache/iceberg/pull/3258#issuecomment-946346453","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3258","id":946346453,"node_id":"IC_kwDOCW7NX844aBnV","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T03:57:09Z","updated_at":"2021-10-19T03:57:09Z","author_association":"CONTRIBUTOR","body":"> The broken unit test is the flaky one, let's retry the CI.\r\n> \r\n> ```java\r\n> org.apache.iceberg.flink.TestFlinkTableSink > testHashDistributeMode[catalogName=testhadoop_basenamespace, baseNamespace=l0.l1, format=ORC, isStreaming=true] FAILED\r\n>     java.lang.AssertionError: There should be 1 data file in partition 'aaa' expected:<1> but was:<2>\r\n>         at org.junit.Assert.fail(Assert.java:89)\r\n>         at org.junit.Assert.failNotEquals(Assert.java:835)\r\n>         at org.junit.Assert.assertEquals(Assert.java:647)\r\n>         at org.apache.iceberg.flink.TestFlinkTableSink.testHashDistributeMode(TestFlinkTableSink.java:281)\r\n> ```\r\n\r\n@openinx looks like @szehon-ho 's attempt of #2989  didn't fix the flakiness. so it is probably a different root cause.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946346453/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946353269","html_url":"https://github.com/apache/iceberg/pull/3307#issuecomment-946353269","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3307","id":946353269,"node_id":"IC_kwDOCW7NX844aDR1","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T04:16:10Z","updated_at":"2021-10-19T04:16:10Z","author_association":"CONTRIBUTOR","body":"Did I link the wrong thing? Issue 2525 doesn't seem to be for fixing it. Is there an issue for that already or do we need to make one?\r\n\r\nI am not getting the error in my local env but I'll keep checking as I'm sure you're getting it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946353269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946373781","html_url":"https://github.com/apache/iceberg/issues/3187#issuecomment-946373781","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3187","id":946373781,"node_id":"IC_kwDOCW7NX844aISV","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T05:15:23Z","updated_at":"2021-10-19T05:15:23Z","author_association":"CONTRIBUTOR","body":"I know this is old but thank you for tagging me @Reo-LEI.\r\n\r\nI have been out of office for a bit (just getting back this week) but thank you for the summary @openinx and for all of the work on this.\r\n\r\nThank you so much also @MartijnVisser and everybody involved.\r\n\r\nI have a new role as an open-source engineer now, in general vs before when my focus was a bit more Spark+Iceberg. So my work is a bit more flexible as to what is worked on then before. I'd love to be get set up to possibly help contribute back some of our learnings / experiences / use cases as I do feel that Iceberg is becoming quite popular on the Flink side, particularly with newer or more bleeding edge Flink users.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946373781/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946374283","html_url":"https://github.com/apache/iceberg/issues/3187#issuecomment-946374283","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3187","id":946374283,"node_id":"IC_kwDOCW7NX844aIaL","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T05:16:50Z","updated_at":"2021-10-19T05:19:59Z","author_association":"CONTRIBUTOR","body":"If we can get our Flink version up to be within 2 major versions of the current stable release, like is suggested in the Flink community, I think it would be much easier to contribute back where we might need configs or something to decide on which API path to take as things are evolving (as I myself have seen some where it defaults to one over the other and I would have liked to choose the other). The newer APIs are also more powerful and so I do understand why this is happening.\r\n\r\nI look forward to working with you all as I am a huge Flink streaming fan!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946374283/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946403444","html_url":"https://github.com/apache/iceberg/pull/3307#issuecomment-946403444","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3307","id":946403444,"node_id":"IC_kwDOCW7NX844aPh0","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T06:24:22Z","updated_at":"2021-10-19T06:24:22Z","author_association":"CONTRIBUTOR","body":"@kbendick #2575 is for fixing the test flakiness imo. I am not getting the error locally as well, but out of the last 10 CI runs across different PRs, I've seen it fail at least 3 times","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946403444/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946409702","html_url":"https://github.com/apache/iceberg/pull/3304#issuecomment-946409702","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3304","id":946409702,"node_id":"IC_kwDOCW7NX844aRDm","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T06:37:55Z","updated_at":"2021-10-19T06:37:55Z","author_association":"CONTRIBUTOR","body":"> That seems like a lot tags to add for benchmarks. We would probably need to keep those up to date, and it would clutter the PR list.\r\n> \r\n> Is it possible to either reduce the number of tags to groups, like arrow-benchmarks and spark-benchmarks, or to change this to run benchmarks when specific files change instead? It seems like those would be easier ways to configure this. I'm a fan of using Github actions, though!\r\n\r\nI agree that the number of tags required are quite long and have to be kept in sync with new benchmarks being added. However, I was thinking that this might be acceptable for the beginning until we know that all benchmarks are actually stable enough to run on GH actions.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946409702/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946416898","html_url":"https://github.com/apache/iceberg/pull/3304#issuecomment-946416898","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3304","id":946416898,"node_id":"IC_kwDOCW7NX844aS0C","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T06:52:13Z","updated_at":"2021-10-19T06:52:13Z","author_association":"CONTRIBUTOR","body":"Can we possibly make it a separate action entirely? Some of them can take\nquite a while to run.\n\nWe might want to just follow up on those issues if they become problems. Im\nnot a huge fan of running these tests via CI as I'm just admittedly not a\nhuge fan of JMH tests.\n\nBut I think this is good enough for now. Perhaps you can look for an\nexisting JMH workflow or some pattern to help form groupings or easily\nallow us to.\n\n+1 overall from me if we feel like having this.  But I do see the utility.\n\nOn Mon, Oct 18, 2021 at 11:38 PM Eduard Tudenhöfner <\n***@***.***> wrote:\n\n> That seems like a lot tags to add for benchmarks. We would probably need\n> to keep those up to date, and it would clutter the PR list.\n>\n> Is it possible to either reduce the number of tags to groups, like\n> arrow-benchmarks and spark-benchmarks, or to change this to run benchmarks\n> when specific files change instead? It seems like those would be easier\n> ways to configure this. I'm a fan of using Github actions, though!\n>\n> I agree that the number of tags required are quite long and have to be\n> kept in sync with new benchmarks being added. However, I was thinking that\n> this might be acceptable for the beginning until we know that all\n> benchmarks are actually stable enough to run on GH actions.\n>\n> —\n> You are receiving this because you commented.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/iceberg/pull/3304#issuecomment-946409702>, or\n> unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/ACLAXEXABFUCVMY43IKARE3UHUG45ANCNFSM5GGPEBIQ>\n> .\n> Triage notifications on the go with GitHub Mobile for iOS\n> <https://apps.apple.com/app/apple-store/id1477376905?ct=notification-email&mt=8&pt=524675>\n> or Android\n> <https://play.google.com/store/apps/details?id=com.github.android&referrer=utm_campaign%3Dnotification-email%26utm_medium%3Demail%26utm_source%3Dgithub>.\n>\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946416898/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946420479","html_url":"https://github.com/apache/iceberg/pull/3304#issuecomment-946420479","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3304","id":946420479,"node_id":"IC_kwDOCW7NX844aTr_","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T06:58:46Z","updated_at":"2021-10-19T06:58:46Z","author_association":"CONTRIBUTOR","body":"Actually, looking at it now, it is quite a clutter of tags, even for just a\nfew. So I withdraw that +1. Sorry.\n\nA hack that I’ve seen is to set the GitHub action configuration via a\nstring in the three dot menu (it has an input similar to the one you’re\nusing now). Like a comma separated input list maybe. Might not be safe for\nuser input but I guess tags aren't really either and I have no problem with\nthose.\n\nIt's not really a huge concern, but I can look into locking down the\npermissions for the generated tokens for the actions like I did for the\nlabeler. It's supposed to be a good idea in repos like this that are\ncommonly forked. https://github.com/apache/iceberg/pull/3007\n\nOn Mon, Oct 18, 2021 at 11:51 PM Kyle Bendickson ***@***.***> wrote:\n\n> Can we possibly make it a separate action entirely? Some of them can take\n> quite a while to run.\n>\n> We might want to just follow up on those issues if they become problems.\n> Im not a huge fan of running these tests via CI as I'm just admittedly not\n> a huge fan of JMH tests.\n>\n> But I think this is good enough for now. Perhaps you can look for an\n> existing JMH workflow or some pattern to help form groupings or easily\n> allow us to.\n>\n> +1 overall from me if we feel like having this.  But I do see the utility.\n>\n> On Mon, Oct 18, 2021 at 11:38 PM Eduard Tudenhöfner <\n> ***@***.***> wrote:\n>\n>> That seems like a lot tags to add for benchmarks. We would probably need\n>> to keep those up to date, and it would clutter the PR list.\n>>\n>> Is it possible to either reduce the number of tags to groups, like\n>> arrow-benchmarks and spark-benchmarks, or to change this to run benchmarks\n>> when specific files change instead? It seems like those would be easier\n>> ways to configure this. I'm a fan of using Github actions, though!\n>>\n>> I agree that the number of tags required are quite long and have to be\n>> kept in sync with new benchmarks being added. However, I was thinking that\n>> this might be acceptable for the beginning until we know that all\n>> benchmarks are actually stable enough to run on GH actions.\n>>\n>> —\n>> You are receiving this because you commented.\n>> Reply to this email directly, view it on GitHub\n>> <https://github.com/apache/iceberg/pull/3304#issuecomment-946409702>, or\n>> unsubscribe\n>> <https://github.com/notifications/unsubscribe-auth/ACLAXEXABFUCVMY43IKARE3UHUG45ANCNFSM5GGPEBIQ>\n>> .\n>> Triage notifications on the go with GitHub Mobile for iOS\n>> <https://apps.apple.com/app/apple-store/id1477376905?ct=notification-email&mt=8&pt=524675>\n>> or Android\n>> <https://play.google.com/store/apps/details?id=com.github.android&referrer=utm_campaign%3Dnotification-email%26utm_medium%3Demail%26utm_source%3Dgithub>.\n>>\n>>\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946420479/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946429747","html_url":"https://github.com/apache/iceberg/issues/3187#issuecomment-946429747","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3187","id":946429747,"node_id":"IC_kwDOCW7NX844aV8z","user":{"login":"MartijnVisser","id":2989614,"node_id":"MDQ6VXNlcjI5ODk2MTQ=","avatar_url":"https://avatars.githubusercontent.com/u/2989614?v=4","gravatar_id":"","url":"https://api.github.com/users/MartijnVisser","html_url":"https://github.com/MartijnVisser","followers_url":"https://api.github.com/users/MartijnVisser/followers","following_url":"https://api.github.com/users/MartijnVisser/following{/other_user}","gists_url":"https://api.github.com/users/MartijnVisser/gists{/gist_id}","starred_url":"https://api.github.com/users/MartijnVisser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MartijnVisser/subscriptions","organizations_url":"https://api.github.com/users/MartijnVisser/orgs","repos_url":"https://api.github.com/users/MartijnVisser/repos","events_url":"https://api.github.com/users/MartijnVisser/events{/privacy}","received_events_url":"https://api.github.com/users/MartijnVisser/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T07:13:56Z","updated_at":"2021-10-19T07:13:56Z","author_association":"NONE","body":"@kbendick Would love to jump on a call with some of our engineers to talk some more, it might be especially worthwhile since we're designing something to address compaction from a Flink perspective. Would be great to get some feedback from you. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946429747/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946441070","html_url":"https://github.com/apache/iceberg/pull/3304#issuecomment-946441070","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3304","id":946441070,"node_id":"IC_kwDOCW7NX844aYtu","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T07:31:47Z","updated_at":"2021-10-19T07:31:47Z","author_association":"CONTRIBUTOR","body":"After giving it some more thought, I'll experiment a bit with the `workflow_dispatch` event which would allow running the benchmark s completely separate from the PRs by giving it a list of Benchmark names","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946441070/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946460705","html_url":"https://github.com/apache/iceberg/pull/3304#issuecomment-946460705","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3304","id":946460705,"node_id":"IC_kwDOCW7NX844adgh","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T08:01:08Z","updated_at":"2021-10-19T08:01:08Z","author_association":"CONTRIBUTOR","body":"@kbendick @rdblue I pushed another commit that doesn't rely on labels and essentially creates an own Action that can be manually triggered with the respective benchmarks that should be executed. I also updated the PR description with the results from example runs on my own fork.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946460705/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946488082","html_url":"https://github.com/apache/iceberg/pull/3301#issuecomment-946488082","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3301","id":946488082,"node_id":"IC_kwDOCW7NX844akMS","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T08:36:24Z","updated_at":"2021-10-19T08:36:24Z","author_association":"CONTRIBUTOR","body":"thanks @kbendick for the review. Comments have been addressed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946488082/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946502324","html_url":"https://github.com/apache/iceberg/issues/3079#issuecomment-946502324","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3079","id":946502324,"node_id":"IC_kwDOCW7NX844anq0","user":{"login":"shengkui","id":17078500,"node_id":"MDQ6VXNlcjE3MDc4NTAw","avatar_url":"https://avatars.githubusercontent.com/u/17078500?v=4","gravatar_id":"","url":"https://api.github.com/users/shengkui","html_url":"https://github.com/shengkui","followers_url":"https://api.github.com/users/shengkui/followers","following_url":"https://api.github.com/users/shengkui/following{/other_user}","gists_url":"https://api.github.com/users/shengkui/gists{/gist_id}","starred_url":"https://api.github.com/users/shengkui/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shengkui/subscriptions","organizations_url":"https://api.github.com/users/shengkui/orgs","repos_url":"https://api.github.com/users/shengkui/repos","events_url":"https://api.github.com/users/shengkui/events{/privacy}","received_events_url":"https://api.github.com/users/shengkui/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T08:54:33Z","updated_at":"2021-10-19T08:54:33Z","author_association":"NONE","body":"This issue is caused by the version of hive-metastore. I changed the hive to 2.3.9, then it's ok to create table and insert in flink sql client.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946502324/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946518763","html_url":"https://github.com/apache/iceberg/pull/2395#issuecomment-946518763","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2395","id":946518763,"node_id":"IC_kwDOCW7NX844arrr","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T09:14:00Z","updated_at":"2021-10-19T09:14:00Z","author_association":"COLLABORATOR","body":"Issue fixed","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946518763/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946521587","html_url":"https://github.com/apache/iceberg/pull/3213#issuecomment-946521587","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3213","id":946521587,"node_id":"IC_kwDOCW7NX844asXz","user":{"login":"fapaul","id":7405553,"node_id":"MDQ6VXNlcjc0MDU1NTM=","avatar_url":"https://avatars.githubusercontent.com/u/7405553?v=4","gravatar_id":"","url":"https://api.github.com/users/fapaul","html_url":"https://github.com/fapaul","followers_url":"https://api.github.com/users/fapaul/followers","following_url":"https://api.github.com/users/fapaul/following{/other_user}","gists_url":"https://api.github.com/users/fapaul/gists{/gist_id}","starred_url":"https://api.github.com/users/fapaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fapaul/subscriptions","organizations_url":"https://api.github.com/users/fapaul/orgs","repos_url":"https://api.github.com/users/fapaul/repos","events_url":"https://api.github.com/users/fapaul/events{/privacy}","received_events_url":"https://api.github.com/users/fapaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T09:17:24Z","updated_at":"2021-10-19T09:17:24Z","author_association":"NONE","body":"@kbendick \r\nthanks for the introduction. I think @rdblue already made a good point noting that Flink's current FileSink is not extensible enough and can thereof not support most of the use cases. We are currently working on bringing compaction to the FileSink and as a next step try to generify it to support more usecases.\r\n\r\nOne thing I am still curious about is what drove the decision that the Flink Iceberg connector is built with the low-level operator API rather than using the unified Sink interface[1]. \r\nIn general, we designed the interface to allow users to support batch and streaming executions without the need to worry about the different semantics.\r\n\r\nI know there have been problems in the past about Flink's API stability and I am a bit worried that the operator model the Iceberg Sink currently uses, might be become difficult to maintain in the future.\r\n\r\nSorry for abusing this pull request thread for some general discussion ...\r\n\r\n[1] https://cwiki.apache.org/confluence/display/FLINK/FLIP-143%3A+Unified+Sink+API","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946521587/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946564228","html_url":"https://github.com/apache/iceberg/pull/3308#issuecomment-946564228","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3308","id":946564228,"node_id":"IC_kwDOCW7NX844a2yE","user":{"login":"omarsmak","id":1190920,"node_id":"MDQ6VXNlcjExOTA5MjA=","avatar_url":"https://avatars.githubusercontent.com/u/1190920?v=4","gravatar_id":"","url":"https://api.github.com/users/omarsmak","html_url":"https://github.com/omarsmak","followers_url":"https://api.github.com/users/omarsmak/followers","following_url":"https://api.github.com/users/omarsmak/following{/other_user}","gists_url":"https://api.github.com/users/omarsmak/gists{/gist_id}","starred_url":"https://api.github.com/users/omarsmak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omarsmak/subscriptions","organizations_url":"https://api.github.com/users/omarsmak/orgs","repos_url":"https://api.github.com/users/omarsmak/repos","events_url":"https://api.github.com/users/omarsmak/events{/privacy}","received_events_url":"https://api.github.com/users/omarsmak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T09:55:33Z","updated_at":"2021-10-19T09:55:33Z","author_association":"MEMBER","body":"@rdblue @kbendick I have tried to change the exception message (`Unknown catalog`) to have it more meaningful. As well, I have modified the docs a bit to reflect the proper behaviour. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946564228/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946590395","html_url":"https://github.com/apache/iceberg/issues/3247#issuecomment-946590395","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3247","id":946590395,"node_id":"IC_kwDOCW7NX844a9K7","user":{"login":"allendang001","id":40447216,"node_id":"MDQ6VXNlcjQwNDQ3MjE2","avatar_url":"https://avatars.githubusercontent.com/u/40447216?v=4","gravatar_id":"","url":"https://api.github.com/users/allendang001","html_url":"https://github.com/allendang001","followers_url":"https://api.github.com/users/allendang001/followers","following_url":"https://api.github.com/users/allendang001/following{/other_user}","gists_url":"https://api.github.com/users/allendang001/gists{/gist_id}","starred_url":"https://api.github.com/users/allendang001/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/allendang001/subscriptions","organizations_url":"https://api.github.com/users/allendang001/orgs","repos_url":"https://api.github.com/users/allendang001/repos","events_url":"https://api.github.com/users/allendang001/events{/privacy}","received_events_url":"https://api.github.com/users/allendang001/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T10:29:46Z","updated_at":"2021-10-19T10:29:46Z","author_association":"NONE","body":"> There are some missing feature in the Hive API. Especially in 2.x, but even in 3.x which prevented us to provide alter table support for Hive tables in Iceberg code.\r\n> \r\n> That said there is an implementation in the Hive master which allows some of the `ALTER` functionality. https://github.com/apache/hive/blob/master/iceberg/iceberg-handler/src/main/java/org/apache/iceberg/mr/hive/HiveIcebergMetaHook.java#L96-L99\r\n> \r\n> ```\r\n>   static final EnumSet<AlterTableType> SUPPORTED_ALTER_OPS = EnumSet.of(\r\n>       AlterTableType.ADDCOLS, AlterTableType.REPLACE_COLUMNS, AlterTableType.RENAME_COLUMN,\r\n>       AlterTableType.ADDPROPS, AlterTableType.DROPPROPS, AlterTableType.SETPARTITIONSPEC,\r\n>       AlterTableType.UPDATE_COLUMNS);\r\n> ```\r\n\r\nThanks a lot. It seems that the community has already achieved some realization, but it is still not enough and cannot support our current business. \r\nDo you know that the community will be improved in this regard in the future?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946590395/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946609293","html_url":"https://github.com/apache/iceberg/issues/3289#issuecomment-946609293","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3289","id":946609293,"node_id":"IC_kwDOCW7NX844bByN","user":{"login":"harshm-dev","id":57615655,"node_id":"MDQ6VXNlcjU3NjE1NjU1","avatar_url":"https://avatars.githubusercontent.com/u/57615655?v=4","gravatar_id":"","url":"https://api.github.com/users/harshm-dev","html_url":"https://github.com/harshm-dev","followers_url":"https://api.github.com/users/harshm-dev/followers","following_url":"https://api.github.com/users/harshm-dev/following{/other_user}","gists_url":"https://api.github.com/users/harshm-dev/gists{/gist_id}","starred_url":"https://api.github.com/users/harshm-dev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/harshm-dev/subscriptions","organizations_url":"https://api.github.com/users/harshm-dev/orgs","repos_url":"https://api.github.com/users/harshm-dev/repos","events_url":"https://api.github.com/users/harshm-dev/events{/privacy}","received_events_url":"https://api.github.com/users/harshm-dev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T10:58:25Z","updated_at":"2021-10-19T10:58:25Z","author_association":"CONTRIBUTOR","body":"@rdblue Thanks, I've updated this issue to cover all known types. Here's my understanding of types to be included - \r\n\r\n- dynamodb : DynamoDBCatalog\r\n- glue: GlueCatalog\r\n- nessie: NessieCatalog\r\n- jdbc: JdbcCatalog","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946609293/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946627435","html_url":"https://github.com/apache/iceberg/issues/3247#issuecomment-946627435","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3247","id":946627435,"node_id":"IC_kwDOCW7NX844bGNr","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T11:24:34Z","updated_at":"2021-10-19T11:24:34Z","author_association":"CONTRIBUTOR","body":"@allendang001: What do you need? What alter table functions would you like to use?\r\n\r\nThanks, Peter ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946627435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946646557","html_url":"https://github.com/apache/iceberg/pull/3288#issuecomment-946646557","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3288","id":946646557,"node_id":"IC_kwDOCW7NX844bK4d","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T11:54:04Z","updated_at":"2021-10-19T11:54:04Z","author_association":"MEMBER","body":"Got this merged !  Thanks @xingbowu for contribution, and thanks @rdblue @kbendick for reviewing !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946646557/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946647875","html_url":"https://github.com/apache/iceberg/pull/3258#issuecomment-946647875","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3258","id":946647875,"node_id":"IC_kwDOCW7NX844bLND","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T11:56:09Z","updated_at":"2021-10-19T11:56:09Z","author_association":"MEMBER","body":"@stevenzwu , Okay,  let me take a look for the root cause. Anyway it does not block this PR.  Let me get this merged first.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946647875/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946653190","html_url":"https://github.com/apache/iceberg/issues/3096#issuecomment-946653190","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3096","id":946653190,"node_id":"IC_kwDOCW7NX844bMgG","user":{"login":"jayfeihe","id":6350147,"node_id":"MDQ6VXNlcjYzNTAxNDc=","avatar_url":"https://avatars.githubusercontent.com/u/6350147?v=4","gravatar_id":"","url":"https://api.github.com/users/jayfeihe","html_url":"https://github.com/jayfeihe","followers_url":"https://api.github.com/users/jayfeihe/followers","following_url":"https://api.github.com/users/jayfeihe/following{/other_user}","gists_url":"https://api.github.com/users/jayfeihe/gists{/gist_id}","starred_url":"https://api.github.com/users/jayfeihe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jayfeihe/subscriptions","organizations_url":"https://api.github.com/users/jayfeihe/orgs","repos_url":"https://api.github.com/users/jayfeihe/repos","events_url":"https://api.github.com/users/jayfeihe/events{/privacy}","received_events_url":"https://api.github.com/users/jayfeihe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T12:03:35Z","updated_at":"2021-10-19T12:03:35Z","author_association":"NONE","body":"did you solve this problem? or have other way to avoid it ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946653190/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946661231","html_url":"https://github.com/apache/iceberg/issues/3096#issuecomment-946661231","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3096","id":946661231,"node_id":"IC_kwDOCW7NX844bOdv","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T12:14:34Z","updated_at":"2021-10-19T12:14:34Z","author_association":"MEMBER","body":"This is because we are using the mismatched iceberg version or flink version.  If you are using iceberg 0.12.0, then it's recommended to use flink 1.12.x,  while if you are using flink 1.13.x, then it's recommended to use the master branch to build flink-iceberg-runtime-xx.jar to submit your jobs.\r\n\r\nRelated work is here: https://github.com/apache/iceberg/pull/3116","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946661231/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946665817","html_url":"https://github.com/apache/iceberg/pull/3307#issuecomment-946665817","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3307","id":946665817,"node_id":"IC_kwDOCW7NX844bPlZ","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T12:20:28Z","updated_at":"2021-10-19T12:20:28Z","author_association":"MEMBER","body":"Linking the PR here: https://github.com/apache/iceberg/pull/3258","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946665817/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946683261","html_url":"https://github.com/apache/iceberg/pull/3307#issuecomment-946683261","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3307","id":946683261,"node_id":"IC_kwDOCW7NX844bT19","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T12:43:13Z","updated_at":"2021-10-19T12:45:04Z","author_association":"MEMBER","body":"Thanks @nastra for bringing this up.  I got a case that would break the flaky unit test from [here](https://github.com/apache/iceberg/blob/7ff9eb4a49c836dc8da0768153d77f19f405d649/flink/src/test/java/org/apache/iceberg/flink/SimpleDataUtil.java#L275): \r\n\r\nIn the unit test case,  we are trying to write the following records into apache iceberg table by shuffling by partition field `data`  (The parallelism is 2): \r\n\r\n```\r\n(1, 'aaa'), (1, 'bbb'), (1, 'ccc')\r\n(2, 'aaa'), (2, 'bbb'), (2, 'ccc')\r\n(3, 'aaa'), (3, 'bbb'), (3, 'ccc')\r\n```\r\n\r\nAs we may produces multiple checkpoints when the streaming job is running,   Then it's possible that we write the records in the following checkpoints: \r\n\r\n* checkpoint#1\r\n  * (1, 'aaa')\r\n  * (1, 'bbb')\r\n  * (1, 'ccc')\r\n\r\n* checkpoint#2\r\n\r\n  * (2, 'aaa'), \r\n  * (2, 'bbb'), \r\n  * (2, 'ccc')\r\n  * (3, 'aaa'), \r\n  * (3, 'bbb'), \r\n  * (3, 'ccc')\r\n\r\nThen  it will produces a seperate data file for each partition in the given checkpoint.  Let's say: \r\n\r\n* checkpoint#1 \r\n  * produces `data-file-1` for partition `aaa`\r\n  * produces `data-file-2` for partition `bbb`\r\n  * produces `data-file-3` for partition `ccc`\r\n\r\n* checkpoint#2\r\n  * produces `data-file-4` for partition `aaa`\r\n  * produces `data-file-5` for partition `bbb`\r\n  * produces `data-file-6` for partition `ccc`\r\n\r\n In the [IcebergFilesCommitter](https://github.com/apache/iceberg/blob/0abaa7ce670f74493cdc5aad43ec56c25d4a54d3/flink/src/main/java/org/apache/iceberg/flink/sink/IcebergFilesCommitter.java#L266) ,  we will use the default MergeAppend to merge the manifest.  Then we will produces: \r\n\r\n* checkpoint#1\r\n  * manifest-1:  includes `data-file-1`, `data-file-2`, `data-file-3`\r\n\r\n* checkpoint#2\r\n  * manifest-2: includes `data-file-1`, `data-file-2`, `data-file-3`, `data-file-4`, `data-file-5`, `data-file-6`\r\n\r\nThen finally, in this [line](https://github.com/apache/iceberg/blob/7ff9eb4a49c836dc8da0768153d77f19f405d649/flink/src/test/java/org/apache/iceberg/flink/SimpleDataUtil.java#L275),  we will encounter the `data-file1` twice in the `result` map.  Finally, the assert would be failure. \r\n\r\nI think we only need to find out the newly added data files for each given commit for fixing this unit test purpose.\r\n\r\n\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946683261/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946719127","html_url":"https://github.com/apache/iceberg/pull/3103#issuecomment-946719127","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3103","id":946719127,"node_id":"IC_kwDOCW7NX844bcmX","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T13:22:40Z","updated_at":"2021-10-19T13:22:40Z","author_association":"CONTRIBUTOR","body":"Close for #3258 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946719127/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946719494","html_url":"https://github.com/apache/iceberg/issues/3102#issuecomment-946719494","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3102","id":946719494,"node_id":"IC_kwDOCW7NX844bcsG","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T13:23:09Z","updated_at":"2021-10-19T13:23:09Z","author_association":"CONTRIBUTOR","body":"Close for #3258","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946719494/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946732931","html_url":"https://github.com/apache/iceberg/pull/3177#issuecomment-946732931","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3177","id":946732931,"node_id":"IC_kwDOCW7NX844bf-D","user":{"login":"miR172","id":5323771,"node_id":"MDQ6VXNlcjUzMjM3NzE=","avatar_url":"https://avatars.githubusercontent.com/u/5323771?v=4","gravatar_id":"","url":"https://api.github.com/users/miR172","html_url":"https://github.com/miR172","followers_url":"https://api.github.com/users/miR172/followers","following_url":"https://api.github.com/users/miR172/following{/other_user}","gists_url":"https://api.github.com/users/miR172/gists{/gist_id}","starred_url":"https://api.github.com/users/miR172/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/miR172/subscriptions","organizations_url":"https://api.github.com/users/miR172/orgs","repos_url":"https://api.github.com/users/miR172/repos","events_url":"https://api.github.com/users/miR172/events{/privacy}","received_events_url":"https://api.github.com/users/miR172/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T13:37:42Z","updated_at":"2021-10-19T13:37:42Z","author_association":"NONE","body":"Thanks for the discussion. Closing this pull request and issuing follow up changes in steps.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946732931/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946776641","html_url":"https://github.com/apache/iceberg/issues/3157#issuecomment-946776641","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3157","id":946776641,"node_id":"IC_kwDOCW7NX844bqpB","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T14:22:52Z","updated_at":"2021-10-19T14:22:52Z","author_association":"CONTRIBUTOR","body":"As @RussellSpitzer already pointed out in his comment, we're spending quite a lot of time writing a single parquet file. In my case it seems to take 3-5 mins to write a single Parquet file (<1MB in size) with 10M rows","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946776641/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946817041","html_url":"https://github.com/apache/iceberg/pull/3258#issuecomment-946817041","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3258","id":946817041,"node_id":"IC_kwDOCW7NX844b0gR","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T15:03:56Z","updated_at":"2021-10-19T15:03:56Z","author_association":"CONTRIBUTOR","body":"Thanks for merging, @openinx!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946817041/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946820688","html_url":"https://github.com/apache/iceberg/issues/2962#issuecomment-946820688","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2962","id":946820688,"node_id":"IC_kwDOCW7NX844b1ZQ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T15:07:40Z","updated_at":"2021-10-19T15:07:40Z","author_association":"CONTRIBUTOR","body":"I just merged #3309 to fix this. We'll also get this out in a 0.12.1 release shortly. Thanks for the bug reports and for helping us track this down, everyone. @kbendick, nice work on getting the repro case that could be debugged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946820688/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946826481","html_url":"https://github.com/apache/iceberg/pull/3317#issuecomment-946826481","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3317","id":946826481,"node_id":"IC_kwDOCW7NX844b2zx","user":{"login":"KnightChess","id":20125927,"node_id":"MDQ6VXNlcjIwMTI1OTI3","avatar_url":"https://avatars.githubusercontent.com/u/20125927?v=4","gravatar_id":"","url":"https://api.github.com/users/KnightChess","html_url":"https://github.com/KnightChess","followers_url":"https://api.github.com/users/KnightChess/followers","following_url":"https://api.github.com/users/KnightChess/following{/other_user}","gists_url":"https://api.github.com/users/KnightChess/gists{/gist_id}","starred_url":"https://api.github.com/users/KnightChess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KnightChess/subscriptions","organizations_url":"https://api.github.com/users/KnightChess/orgs","repos_url":"https://api.github.com/users/KnightChess/repos","events_url":"https://api.github.com/users/KnightChess/events{/privacy}","received_events_url":"https://api.github.com/users/KnightChess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T15:13:33Z","updated_at":"2021-10-19T15:13:33Z","author_association":"CONTRIBUTOR","body":"#3297 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946826481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946840803","html_url":"https://github.com/apache/iceberg/pull/3311#issuecomment-946840803","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3311","id":946840803,"node_id":"IC_kwDOCW7NX844b6Tj","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T15:28:49Z","updated_at":"2021-10-19T15:28:49Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @kbendick and @aokolnychyi!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946840803/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946842260","html_url":"https://github.com/apache/iceberg/pull/3307#issuecomment-946842260","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3307","id":946842260,"node_id":"IC_kwDOCW7NX844b6qU","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T15:30:22Z","updated_at":"2021-10-19T15:39:25Z","author_association":"CONTRIBUTOR","body":"> checkpoint#2\r\n> manifest-2: includes data-file-1, data-file-2, data-file-3, data-file-4, data-file-5, data-file-6\r\n\r\n@openinx why would the above happen? commit for checkpoint #1 failed and first set of data-file-[1-3] got committed along with the second set of data-file-[4-5]? if first commit is successful, 2nd commit shouldn't include data-file-[1-3] that are committed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946842260/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946843544","html_url":"https://github.com/apache/iceberg/pull/3276#issuecomment-946843544","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3276","id":946843544,"node_id":"IC_kwDOCW7NX844b6-Y","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T15:31:47Z","updated_at":"2021-10-19T15:31:47Z","author_association":"CONTRIBUTOR","body":"@velctor, can you post the problem that you're seeing? If you have a stream that was closed by the finalizer, how is anything still using it to hit the `Stream closed` error?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946843544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946848460","html_url":"https://github.com/apache/iceberg/pull/1508#issuecomment-946848460","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1508","id":946848460,"node_id":"IC_kwDOCW7NX844b8LM","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T15:37:11Z","updated_at":"2021-10-19T15:37:11Z","author_association":"CONTRIBUTOR","body":"@wypoon can you rebase? Looks like some of the Spark refactoring has conflicted.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946848460/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946852652","html_url":"https://github.com/apache/iceberg/issues/2482#issuecomment-946852652","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2482","id":946852652,"node_id":"IC_kwDOCW7NX844b9Ms","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T15:41:52Z","updated_at":"2021-10-19T15:41:52Z","author_association":"CONTRIBUTOR","body":"I've marked the fix for inclusion in the 0.12.1 patch release.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946852652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946861520","html_url":"https://github.com/apache/iceberg/pull/3204#issuecomment-946861520","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3204","id":946861520,"node_id":"IC_kwDOCW7NX844b_XQ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T15:51:47Z","updated_at":"2021-10-19T15:51:47Z","author_association":"CONTRIBUTOR","body":"Running CI.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946861520/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946862997","html_url":"https://github.com/apache/iceberg/pull/3213#issuecomment-946862997","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3213","id":946862997,"node_id":"IC_kwDOCW7NX844b_uV","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T15:53:23Z","updated_at":"2021-10-19T15:53:23Z","author_association":"CONTRIBUTOR","body":"@fapaul current Flink Iceberg connector was implemented before the FLIP-143 unified sink API.  I have participated in the discussion for FLIP-143 interfaces and make sure the requirements for Iceberg sink are reflected in the new FLIP-143 sink interface [1]. \r\n\r\nNobody has got time to pick up the work of moving to the new sink API. Also we are waiting for the new sink interface to mature/stabalize.\r\n\r\n[1] https://www.mail-archive.com/search?l=dev@flink.apache.org&q=subject:%22Re%5C%3A+%5C%5BDISCUSS%5C%5D+FLIP%5C-143%5C%3A+Unified+Sink+API%22&o=newest&f=1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946862997/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946881318","html_url":"https://github.com/apache/iceberg/issues/3318#issuecomment-946881318","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3318","id":946881318,"node_id":"IC_kwDOCW7NX844cEMm","user":{"login":"hendrikmakait","id":2699097,"node_id":"MDQ6VXNlcjI2OTkwOTc=","avatar_url":"https://avatars.githubusercontent.com/u/2699097?v=4","gravatar_id":"","url":"https://api.github.com/users/hendrikmakait","html_url":"https://github.com/hendrikmakait","followers_url":"https://api.github.com/users/hendrikmakait/followers","following_url":"https://api.github.com/users/hendrikmakait/following{/other_user}","gists_url":"https://api.github.com/users/hendrikmakait/gists{/gist_id}","starred_url":"https://api.github.com/users/hendrikmakait/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hendrikmakait/subscriptions","organizations_url":"https://api.github.com/users/hendrikmakait/orgs","repos_url":"https://api.github.com/users/hendrikmakait/repos","events_url":"https://api.github.com/users/hendrikmakait/events{/privacy}","received_events_url":"https://api.github.com/users/hendrikmakait/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T16:13:21Z","updated_at":"2021-10-19T16:13:21Z","author_association":"CONTRIBUTOR","body":"I'd love to take a stab at this one :) ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946881318/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946884267","html_url":"https://github.com/apache/iceberg/issues/3318#issuecomment-946884267","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3318","id":946884267,"node_id":"IC_kwDOCW7NX844cE6r","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T16:16:53Z","updated_at":"2021-10-19T16:16:53Z","author_association":"COLLABORATOR","body":"Thanks @hendrikmakait ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946884267/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946896942","html_url":"https://github.com/apache/iceberg/pull/3308#issuecomment-946896942","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3308","id":946896942,"node_id":"IC_kwDOCW7NX844cIAu","user":{"login":"omarsmak","id":1190920,"node_id":"MDQ6VXNlcjExOTA5MjA=","avatar_url":"https://avatars.githubusercontent.com/u/1190920?v=4","gravatar_id":"","url":"https://api.github.com/users/omarsmak","html_url":"https://github.com/omarsmak","followers_url":"https://api.github.com/users/omarsmak/followers","following_url":"https://api.github.com/users/omarsmak/following{/other_user}","gists_url":"https://api.github.com/users/omarsmak/gists{/gist_id}","starred_url":"https://api.github.com/users/omarsmak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omarsmak/subscriptions","organizations_url":"https://api.github.com/users/omarsmak/orgs","repos_url":"https://api.github.com/users/omarsmak/repos","events_url":"https://api.github.com/users/omarsmak/events{/privacy}","received_events_url":"https://api.github.com/users/omarsmak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T16:31:23Z","updated_at":"2021-10-19T16:31:23Z","author_association":"MEMBER","body":"@rdblue @nastra I have addressed your comments in regards to docs, error message rewording and using `Assertions`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946896942/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946900913","html_url":"https://github.com/apache/iceberg/pull/1508#issuecomment-946900913","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1508","id":946900913,"node_id":"IC_kwDOCW7NX844cI-x","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T16:36:03Z","updated_at":"2021-10-19T16:36:03Z","author_association":"CONTRIBUTOR","body":"@rdblue is there any known flakiness with hive-metastore tests?\r\n`./gradlew check -DsparkVersions= -DhiveVersions= -DflinkVersions= -Pquick=true -x javadoc` failed due to one failure in `:iceberg-hive-metastore:test`. I ran both `./gradlew :iceberg-hive-metastore:test` and `./gradlew check -DsparkVersions= -DhiveVersions= -DflinkVersions= -Pquick=true -x javadoc` locally and they passed on my machine. Is there a way to retrigger the CI easily? Or do I need to push a new change?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946900913/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946911321","html_url":"https://github.com/apache/iceberg/pull/1508#issuecomment-946911321","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1508","id":946911321,"node_id":"IC_kwDOCW7NX844cLhZ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T16:48:57Z","updated_at":"2021-10-19T16:48:57Z","author_association":"CONTRIBUTOR","body":"I restarted the tests.\r\n\r\nHere's the failure message so we don't lose it:\r\n```\r\norg.apache.iceberg.hive.HiveTableTest > testDropWithoutPurgeLeavesTableData FAILED\r\n    java.lang.RuntimeException: Metastore operation failed for hivedb.tbl\r\n        at org.apache.iceberg.hive.HiveCatalog.defaultWarehouseLocation(HiveCatalog.java:450)\r\n        at org.apache.iceberg.BaseMetastoreCatalog$BaseMetastoreCatalogTableBuilder.create(BaseMetastoreCatalog.java:160)\r\n        at org.apache.iceberg.catalog.Catalog.createTable(Catalog.java:78)\r\n        at org.apache.iceberg.catalog.Catalog.createTable(Catalog.java:112)\r\n        at org.apache.iceberg.hive.HiveTableBaseTest.createTestTable(HiveTableBaseTest.java:60)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)\r\n        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n        at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n\r\n        Caused by:\r\n        NoSuchObjectException(message:hivedb: No current connection.)\r\n            at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$get_database_result$get_database_resultStandardScheme.read(ThriftHiveMetastore.java:27584)\r\n            at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$get_database_result$get_database_resultStandardScheme.read(ThriftHiveMetastore.java:27561)\r\n            at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$get_database_result.read(ThriftHiveMetastore.java:27492)\r\n            at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:86)\r\n            at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.recv_get_database(ThriftHiveMetastore.java:782)\r\n            at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.get_database(ThriftHiveMetastore.java:769)\r\n            at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.getDatabase(HiveMetaStoreClient.java:1290)\r\n            at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n            at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n            at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n            at java.lang.reflect.Method.invoke(Method.java:498)\r\n            at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:169)\r\n            at com.sun.proxy.$Proxy21.getDatabase(Unknown Source)\r\n            at org.apache.iceberg.hive.HiveCatalog.lambda$defaultWarehouseLocation$13(HiveCatalog.java:443)\r\n            at org.apache.iceberg.ClientPoolImpl.run(ClientPoolImpl.java:58)\r\n            at org.apache.iceberg.ClientPoolImpl.run(ClientPoolImpl.java:51)\r\n            at org.apache.iceberg.hive.CachedClientPool.run(CachedClientPool.java:76)\r\n            at org.apache.iceberg.hive.HiveCatalog.defaultWarehouseLocation(HiveCatalog.java:443)\r\n            ... 52 more\r\n\r\n    java.lang.NullPointerException\r\n        at org.apache.iceberg.hive.HiveTableBaseTest.dropTestTable(HiveTableBaseTest.java:66)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n        at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)\r\n        at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n        at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n        at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)\r\n        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n        at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n        at org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n        at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n        at org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n        at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n        at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n        at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n        at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n        at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker$2.run(TestWorker.java:176)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n        at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n        at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n        at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n        at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\n```\r\n\r\nI don't think these tests are normally flaky, but there was a recent change to the HMS client so it could be that a problem was introduced.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946911321/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946963030","html_url":"https://github.com/apache/iceberg/pull/1508#issuecomment-946963030","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1508","id":946963030,"node_id":"IC_kwDOCW7NX844cYJW","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T17:54:21Z","updated_at":"2021-10-19T17:54:21Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue. The failure appears to have been due to some flakiness. CI is green now.\r\nYou might also be interested in #3314, which is based on your table name syntax for time travel (#3269).\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946963030/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946973951","html_url":"https://github.com/apache/iceberg/pull/3293#issuecomment-946973951","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3293","id":946973951,"node_id":"IC_kwDOCW7NX844caz_","user":{"login":"NeQuissimus","id":628342,"node_id":"MDQ6VXNlcjYyODM0Mg==","avatar_url":"https://avatars.githubusercontent.com/u/628342?v=4","gravatar_id":"","url":"https://api.github.com/users/NeQuissimus","html_url":"https://github.com/NeQuissimus","followers_url":"https://api.github.com/users/NeQuissimus/followers","following_url":"https://api.github.com/users/NeQuissimus/following{/other_user}","gists_url":"https://api.github.com/users/NeQuissimus/gists{/gist_id}","starred_url":"https://api.github.com/users/NeQuissimus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NeQuissimus/subscriptions","organizations_url":"https://api.github.com/users/NeQuissimus/orgs","repos_url":"https://api.github.com/users/NeQuissimus/repos","events_url":"https://api.github.com/users/NeQuissimus/events{/privacy}","received_events_url":"https://api.github.com/users/NeQuissimus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T18:07:50Z","updated_at":"2021-10-19T18:08:15Z","author_association":"CONTRIBUTOR","body":"@rdblue Could you take a look at the test failures with me?\r\nBoth Flink tests that run `abort` use this code: https://github.com/apache/iceberg/blob/3763952c7b5d101e2c84efb1651b88439f641099/flink/src/test/java/org/apache/iceberg/flink/sink/TestDeltaTaskWriter.java#L226-L229\r\n\r\nWith the writer here being lazy, it will not create the files the tests check for. And the actual writer is hidden away. I am unsure of the consequences, just a test with an invalid assumption?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/946973951/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947000787","html_url":"https://github.com/apache/iceberg/pull/3319#issuecomment-947000787","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3319","id":947000787,"node_id":"IC_kwDOCW7NX844chXT","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T18:34:24Z","updated_at":"2021-10-19T18:34:24Z","author_association":"CONTRIBUTOR","body":"Merging this to fix other builds.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947000787/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947127418","html_url":"https://github.com/apache/iceberg/pull/3321#issuecomment-947127418","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3321","id":947127418,"node_id":"IC_kwDOCW7NX844dAR6","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T21:40:36Z","updated_at":"2021-10-19T21:40:36Z","author_association":"CONTRIBUTOR","body":"Weird, the test failures are happening because I enabled test that was disabled for a while.\r\nIt looks the suite was ignored by accident in [this](https://github.com/apache/iceberg/commit/2f136e9da5630e1f4f402f847b1d9e6a40c7401a#diff-534ed65325ae5f7f180b4dbe6c[…]c8be0bfd681ccfb8a5243e8f93f70b7d) commit.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947127418/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947129529","html_url":"https://github.com/apache/iceberg/pull/3321#issuecomment-947129529","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3321","id":947129529,"node_id":"IC_kwDOCW7NX844dAy5","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T21:44:42Z","updated_at":"2021-10-19T21:44:42Z","author_association":"CONTRIBUTOR","body":"I'll revert enabling this test to unblock this PR but I wonder whether the original ignore was intentional.\r\n\r\n@rymurr @rdblue @RussellSpitzer, any context?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947129529/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947140885","html_url":"https://github.com/apache/iceberg/pull/3321#issuecomment-947140885","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3321","id":947140885,"node_id":"IC_kwDOCW7NX844dDkV","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T22:05:05Z","updated_at":"2021-10-19T22:05:05Z","author_association":"MEMBER","body":"As far as I can tell, our implementation of IcebergSource in Spark3 ignores Schema args all together,\r\nhttps://github.com/apache/iceberg/blob/3f4c9c99c82fc45fc77b97acc7a160be88b5cc20/spark/v3.0/spark3/src/main/java/org/apache/iceberg/spark/source/IcebergSource.java#L80-L93","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947140885/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947142058","html_url":"https://github.com/apache/iceberg/pull/3321#issuecomment-947142058","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3321","id":947142058,"node_id":"IC_kwDOCW7NX844dD2q","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T22:07:12Z","updated_at":"2021-10-19T22:07:12Z","author_association":"CONTRIBUTOR","body":"Then I assume that change was intentional and we simply need to remove that abstract test.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947142058/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947142600","html_url":"https://github.com/apache/iceberg/pull/3321#issuecomment-947142600","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3321","id":947142600,"node_id":"IC_kwDOCW7NX844dD_I","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T22:08:10Z","updated_at":"2021-10-19T22:08:10Z","author_association":"MEMBER","body":"Looks like we removed that capability in the commit in question \r\nhttps://github.com/apache/iceberg/commit/2f136e9da5630e1f4f402f847b1d9e6a40c7401a#diff-6137fecd2e0b341d7302673c2b286005f5ef1e30f7bf3ee16899b04402ca22d5L58-R96","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947142600/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947144074","html_url":"https://github.com/apache/iceberg/pull/3321#issuecomment-947144074","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3321","id":947144074,"node_id":"IC_kwDOCW7NX844dEWK","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T22:10:58Z","updated_at":"2021-10-19T22:10:58Z","author_association":"CONTRIBUTOR","body":"Thanks for checking, @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947144074/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947173357","html_url":"https://github.com/apache/iceberg/pull/3321#issuecomment-947173357","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3321","id":947173357,"node_id":"IC_kwDOCW7NX844dLft","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T23:12:48Z","updated_at":"2021-10-19T23:12:48Z","author_association":"CONTRIBUTOR","body":"Yeah, we don't support the schema argument in Spark 3 so the test isn't needed. Thanks for fixing this, @aokolnychyi! I merged it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947173357/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947174111","html_url":"https://github.com/apache/iceberg/pull/3308#issuecomment-947174111","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3308","id":947174111,"node_id":"IC_kwDOCW7NX844dLrf","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T23:14:20Z","updated_at":"2021-10-19T23:14:20Z","author_association":"CONTRIBUTOR","body":"Thanks, @omarsmak!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947174111/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947182438","html_url":"https://github.com/apache/iceberg/issues/3157#issuecomment-947182438","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3157","id":947182438,"node_id":"IC_kwDOCW7NX844dNtm","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T23:28:39Z","updated_at":"2021-10-19T23:28:39Z","author_association":"CONTRIBUTOR","body":"That thread dump is for the thread that submitted a Spark job. It's just waiting on tasks to do the write, so I don't think that's where the problem is.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947182438/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947190053","html_url":"https://github.com/apache/iceberg/pull/3321#issuecomment-947190053","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3321","id":947190053,"node_id":"IC_kwDOCW7NX844dPkl","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-19T23:49:25Z","updated_at":"2021-10-19T23:49:25Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @rdblue @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947190053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947208974","html_url":"https://github.com/apache/iceberg/pull/3322#issuecomment-947208974","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3322","id":947208974,"node_id":"IC_kwDOCW7NX844dUMO","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T00:33:03Z","updated_at":"2021-10-20T00:33:03Z","author_association":"CONTRIBUTOR","body":"I'm probably going to add a function `log_test` and `log_not_test` to simplify the checks. Or `do_in_test` etc.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947208974/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947224930","html_url":"https://github.com/apache/iceberg/pull/1471#issuecomment-947224930","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1471","id":947224930,"node_id":"IC_kwDOCW7NX844dYFi","user":{"login":"karuppayya","id":5082742,"node_id":"MDQ6VXNlcjUwODI3NDI=","avatar_url":"https://avatars.githubusercontent.com/u/5082742?v=4","gravatar_id":"","url":"https://api.github.com/users/karuppayya","html_url":"https://github.com/karuppayya","followers_url":"https://api.github.com/users/karuppayya/followers","following_url":"https://api.github.com/users/karuppayya/following{/other_user}","gists_url":"https://api.github.com/users/karuppayya/gists{/gist_id}","starred_url":"https://api.github.com/users/karuppayya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karuppayya/subscriptions","organizations_url":"https://api.github.com/users/karuppayya/orgs","repos_url":"https://api.github.com/users/karuppayya/repos","events_url":"https://api.github.com/users/karuppayya/events{/privacy}","received_events_url":"https://api.github.com/users/karuppayya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T01:12:39Z","updated_at":"2021-10-20T01:12:39Z","author_association":"CONTRIBUTOR","body":"In case of `S3FileIO`, default scheme is `s3://`.\r\nWrites happening from different clients, will have schemes based on `io-impl` property. The manifest might have mix of `s3://`, `s3a://` etc\r\nBut the file listing(in DeleteOrphanFiles), will have only only a single prefix(which is determined by the Client Hadoop configuration). This will result in orphan files not being cleaned.\r\nWhen the user is aware that the scheme can be ignored, I think we should provide a configuration to do that.\r\n\r\nI am not able to come up with a concrete case for the authority(may be HDFS with and with authority), but that could also be a configuration.\r\n\r\n@RussellSpitzer @aokolnychyi @rdblue @flyrain @raptond Your thoughts on this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947224930/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947249330","html_url":"https://github.com/apache/iceberg/pull/3188#issuecomment-947249330","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3188","id":947249330,"node_id":"IC_kwDOCW7NX844deCy","user":{"login":"jacques-n","id":183350,"node_id":"MDQ6VXNlcjE4MzM1MA==","avatar_url":"https://avatars.githubusercontent.com/u/183350?v=4","gravatar_id":"","url":"https://api.github.com/users/jacques-n","html_url":"https://github.com/jacques-n","followers_url":"https://api.github.com/users/jacques-n/followers","following_url":"https://api.github.com/users/jacques-n/following{/other_user}","gists_url":"https://api.github.com/users/jacques-n/gists{/gist_id}","starred_url":"https://api.github.com/users/jacques-n/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jacques-n/subscriptions","organizations_url":"https://api.github.com/users/jacques-n/orgs","repos_url":"https://api.github.com/users/jacques-n/repos","events_url":"https://api.github.com/users/jacques-n/events{/privacy}","received_events_url":"https://api.github.com/users/jacques-n/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T02:03:06Z","updated_at":"2021-10-20T02:03:06Z","author_association":"NONE","body":"@rdblue , I think your comments are mostly focused on table identifiers. I'll respond to those below.\r\n\r\nField names are probably the more important of the two. We should specify clearly what it means for a view to be \"invalid\". For example, if the SQL parses but the column names or column types are different, I would expect this to fail with an invalid view definition error. Additionally, I think we should probably cleanup the weird dual column definition pattern (if a user expressed column name aliases in the create view versus the population of derived * column names in the schema). Also, if we're capturing what the user wrote, we should probably capture the CREATE VIEW ... part of the command (not just the inner sql). I think this is consistent with how other tools expose the data.\r\n\r\nWRT to table identifiers, I struggle with being opinionated about resolution given that end users may work in a system that already has a particular resolution behavior.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947249330/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]