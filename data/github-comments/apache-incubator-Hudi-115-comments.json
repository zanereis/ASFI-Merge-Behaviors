[{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811060626","html_url":"https://github.com/apache/hudi/pull/2749#issuecomment-811060626","issue_url":"https://api.github.com/repos/apache/hudi/issues/2749","id":811060626,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTA2MDYyNg==","user":{"login":"li36909","id":3632162,"node_id":"MDQ6VXNlcjM2MzIxNjI=","avatar_url":"https://avatars.githubusercontent.com/u/3632162?v=4","gravatar_id":"","url":"https://api.github.com/users/li36909","html_url":"https://github.com/li36909","followers_url":"https://api.github.com/users/li36909/followers","following_url":"https://api.github.com/users/li36909/following{/other_user}","gists_url":"https://api.github.com/users/li36909/gists{/gist_id}","starred_url":"https://api.github.com/users/li36909/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/li36909/subscriptions","organizations_url":"https://api.github.com/users/li36909/orgs","repos_url":"https://api.github.com/users/li36909/repos","events_url":"https://api.github.com/users/li36909/events{/privacy}","received_events_url":"https://api.github.com/users/li36909/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T13:17:46Z","updated_at":"2021-03-31T13:17:46Z","author_association":"CONTRIBUTOR","body":"cc @n3nash could you help to take a look, thank you","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811060626/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811147597","html_url":"https://github.com/apache/hudi/pull/2749#issuecomment-811147597","issue_url":"https://api.github.com/repos/apache/hudi/issues/2749","id":811147597,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTE0NzU5Nw==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T15:15:55Z","updated_at":"2021-03-31T18:15:54Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2749?src=pr&el=h1) Report\n> Merging [#2749](https://codecov.io/gh/apache/hudi/pull/2749?src=pr&el=desc) (e97262f) into [master](https://codecov.io/gh/apache/hudi/commit/fe16d0de7c76105775c887b700751241bc82624c?el=desc) (fe16d0d) will **increase** coverage by `17.74%`.\n> The diff coverage is `n/a`.\n\n> :exclamation: Current head e97262f differs from pull request most recent head e0dcab7. Consider uploading reports for the commit e0dcab7 to get more accurate results\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2749/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2749?src=pr&el=tree)\n\n```diff\n@@              Coverage Diff              @@\n##             master    #2749       +/-   ##\n=============================================\n+ Coverage     52.04%   69.78%   +17.74%     \n+ Complexity     3625      372     -3253     \n=============================================\n  Files           479       54      -425     \n  Lines         22804     1989    -20815     \n  Branches       2415      236     -2179     \n=============================================\n- Hits          11868     1388    -10480     \n+ Misses         9911      471     -9440     \n+ Partials       1025      130      -895     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `?` | `?` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `69.78% <ø> (ø)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2749?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...i/hadoop/utils/HoodieRealtimeInputFormatUtils.java](https://codecov.io/gh/apache/hudi/pull/2749/diff?src=pr&el=tree#diff-aHVkaS1oYWRvb3AtbXIvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaGFkb29wL3V0aWxzL0hvb2RpZVJlYWx0aW1lSW5wdXRGb3JtYXRVdGlscy5qYXZh) | | | |\n| [...ache/hudi/sink/StreamWriteOperatorCoordinator.java](https://codecov.io/gh/apache/hudi/pull/2749/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL1N0cmVhbVdyaXRlT3BlcmF0b3JDb29yZGluYXRvci5qYXZh) | | | |\n| [...e/hudi/sink/transform/RowDataToHoodieFunction.java](https://codecov.io/gh/apache/hudi/pull/2749/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL3RyYW5zZm9ybS9Sb3dEYXRhVG9Ib29kaWVGdW5jdGlvbi5qYXZh) | | | |\n| [.../org/apache/hudi/exception/HoodieKeyException.java](https://codecov.io/gh/apache/hudi/pull/2749/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvZXhjZXB0aW9uL0hvb2RpZUtleUV4Y2VwdGlvbi5qYXZh) | | | |\n| [...g/apache/hudi/exception/InvalidTableException.java](https://codecov.io/gh/apache/hudi/pull/2749/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvZXhjZXB0aW9uL0ludmFsaWRUYWJsZUV4Y2VwdGlvbi5qYXZh) | | | |\n| [...org/apache/hudi/common/util/SpillableMapUtils.java](https://codecov.io/gh/apache/hudi/pull/2749/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3V0aWwvU3BpbGxhYmxlTWFwVXRpbHMuamF2YQ==) | | | |\n| [...java/org/apache/hudi/common/lock/LockProvider.java](https://codecov.io/gh/apache/hudi/pull/2749/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2xvY2svTG9ja1Byb3ZpZGVyLmphdmE=) | | | |\n| [...cala/org/apache/hudi/HoodieBootstrapRelation.scala](https://codecov.io/gh/apache/hudi/pull/2749/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL0hvb2RpZUJvb3RzdHJhcFJlbGF0aW9uLnNjYWxh) | | | |\n| [.../hudi/hadoop/realtime/HoodieRealtimeFileSplit.java](https://codecov.io/gh/apache/hudi/pull/2749/diff?src=pr&el=tree#diff-aHVkaS1oYWRvb3AtbXIvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaGFkb29wL3JlYWx0aW1lL0hvb2RpZVJlYWx0aW1lRmlsZVNwbGl0LmphdmE=) | | | |\n| [...g/apache/hudi/sink/partitioner/BucketAssigner.java](https://codecov.io/gh/apache/hudi/pull/2749/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL3BhcnRpdGlvbmVyL0J1Y2tldEFzc2lnbmVyLmphdmE=) | | | |\n| ... and [415 more](https://codecov.io/gh/apache/hudi/pull/2749/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811147597/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811154406","html_url":"https://github.com/apache/hudi/issues/2748#issuecomment-811154406","issue_url":"https://api.github.com/repos/apache/hudi/issues/2748","id":811154406,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTE1NDQwNg==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T15:25:11Z","updated_at":"2021-03-31T15:25:11Z","author_association":"CONTRIBUTOR","body":"thanks a lot for raising this @aditiwari01 . we are looking into it. \r\nhttps://issues.apache.org/jira/browse/HUDI-1745\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811154406/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811163812","html_url":"https://github.com/apache/hudi/pull/2747#issuecomment-811163812","issue_url":"https://api.github.com/repos/apache/hudi/issues/2747","id":811163812,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTE2MzgxMg==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T15:37:49Z","updated_at":"2021-03-31T15:37:49Z","author_association":"CONTRIBUTOR","body":"@vingov Thanks, but the CI has failed, would you please check the reason? If you not sure, you can push an empty commit to retrigger the Travis.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811163812/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811177897","html_url":"https://github.com/apache/hudi/issues/2609#issuecomment-811177897","issue_url":"https://api.github.com/repos/apache/hudi/issues/2609","id":811177897,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTE3Nzg5Nw==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T15:56:33Z","updated_at":"2021-03-31T15:56:33Z","author_association":"CONTRIBUTOR","body":"thanks Sudha. if you feel you are done w/ you response, feel free to remove the \"awaiting-community-help\" label ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811177897/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811179179","html_url":"https://github.com/apache/hudi/issues/2633#issuecomment-811179179","issue_url":"https://api.github.com/repos/apache/hudi/issues/2633","id":811179179,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTE3OTE3OQ==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T15:58:25Z","updated_at":"2021-03-31T15:58:25Z","author_association":"CONTRIBUTOR","body":"@n3nash : Can you please file a tracking jira and close this out. Do add labels w/ severity as appropriate to both issues and jira ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811179179/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811181956","html_url":"https://github.com/apache/hudi/issues/2717#issuecomment-811181956","issue_url":"https://api.github.com/repos/apache/hudi/issues/2717","id":811181956,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTE4MTk1Ng==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T16:02:13Z","updated_at":"2021-03-31T16:02:13Z","author_association":"CONTRIBUTOR","body":"sure. Closing this out. we can continue the discussion in PR. [Here](https://issues.apache.org/jira/browse/HUDI-1721) is the right jira (closed the other one as duplicate)","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811181956/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811188216","html_url":"https://github.com/apache/hudi/issues/2648#issuecomment-811188216","issue_url":"https://api.github.com/repos/apache/hudi/issues/2648","id":811188216,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTE4ODIxNg==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T16:10:32Z","updated_at":"2021-03-31T16:10:43Z","author_association":"CONTRIBUTOR","body":"@n3nash : can you please add severity label if you have sense of it. just reminding. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811188216/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811192144","html_url":"https://github.com/apache/hudi/pull/2655#issuecomment-811192144","issue_url":"https://api.github.com/repos/apache/hudi/issues/2655","id":811192144,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTE5MjE0NA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T16:15:20Z","updated_at":"2021-03-31T16:15:20Z","author_association":"CONTRIBUTOR","body":"yeah, I haven't got a chance to fix it. once its ready, will let you know. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811192144/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811202865","html_url":"https://github.com/apache/hudi/issues/2748#issuecomment-811202865","issue_url":"https://api.github.com/repos/apache/hudi/issues/2748","id":811202865,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTIwMjg2NQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T16:22:48Z","updated_at":"2021-03-31T16:22:48Z","author_association":"MEMBER","body":"@nsivabalan this would be a release blocker and we need to fix the RC if spark 2.x has issues. agree?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811202865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811224728","html_url":"https://github.com/apache/hudi/issues/2748#issuecomment-811224728","issue_url":"https://api.github.com/repos/apache/hudi/issues/2748","id":811224728,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTIyNDcyOA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T16:36:04Z","updated_at":"2021-03-31T16:36:04Z","author_association":"MEMBER","body":"@aditiwari01 This is a bit of my bad. Actually we have always required Spark 2.4 for a while now (we need `spark-avro` from there). So as long as Spark 2.4 works and Spark 3.x works we are good. \r\n\r\nSorry for the false alarms\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811224728/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811249839","html_url":"https://github.com/apache/hudi/issues/2696#issuecomment-811249839","issue_url":"https://api.github.com/repos/apache/hudi/issues/2696","id":811249839,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTI0OTgzOQ==","user":{"login":"kimberlyamandalu","id":25435575,"node_id":"MDQ6VXNlcjI1NDM1NTc1","avatar_url":"https://avatars.githubusercontent.com/u/25435575?v=4","gravatar_id":"","url":"https://api.github.com/users/kimberlyamandalu","html_url":"https://github.com/kimberlyamandalu","followers_url":"https://api.github.com/users/kimberlyamandalu/followers","following_url":"https://api.github.com/users/kimberlyamandalu/following{/other_user}","gists_url":"https://api.github.com/users/kimberlyamandalu/gists{/gist_id}","starred_url":"https://api.github.com/users/kimberlyamandalu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimberlyamandalu/subscriptions","organizations_url":"https://api.github.com/users/kimberlyamandalu/orgs","repos_url":"https://api.github.com/users/kimberlyamandalu/repos","events_url":"https://api.github.com/users/kimberlyamandalu/events{/privacy}","received_events_url":"https://api.github.com/users/kimberlyamandalu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T16:54:52Z","updated_at":"2021-03-31T16:54:52Z","author_association":"NONE","body":"> @kimberlyamandalu Can you try turning off the metadata table in hoodie to get your pipeline unblocked ?\r\n> \r\n> ```\r\n> hoodie.metadata.enable=false\r\n> ```\r\n> \r\n> This looks like an exception in the metadata table. Without any more logs, it's hard to debug what may be going on. If you are OK to deploy a custom build, we can work on adding more logs to help surface the underlying issue.\r\n> \r\n> https://github.com/apache/hudi/blob/release-0.7.0/hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/FileSystemViewHandler.java#L378 this is where the exception is coming from. If we can add more logs to this function to see why a runtime exception is being thrown, it may help to find the root cause.\r\n\r\nHi @n3nash,\r\nThanks for looking into this.\r\nI can try disabling metadata for my workload. Can we toggle metadata on and off for a data set? or does it need to be enabled from the time the data is bootstrapped? Is it something we can turn on after we have been ingesting for a bit and it will still work?\r\n\r\nI will be willing to deploy a custom build so we can get more details on this issue. I will need your help on it though as i'm not very familiar with how to do this.\r\n\r\nThanks!!!\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811249839/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811277730","html_url":"https://github.com/apache/hudi/issues/2748#issuecomment-811277730","issue_url":"https://api.github.com/repos/apache/hudi/issues/2748","id":811277730,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTI3NzczMA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T17:35:17Z","updated_at":"2021-03-31T17:35:17Z","author_association":"CONTRIBUTOR","body":"@vinothchandar : guess issue is w/ spark2.4.1. looks like the api is available from 2.4.2 and not available in 2.4.1.  ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811277730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811280058","html_url":"https://github.com/apache/hudi/issues/2748#issuecomment-811280058","issue_url":"https://api.github.com/repos/apache/hudi/issues/2748","id":811280058,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTI4MDA1OA==","user":{"login":"aditiwari01","id":16352977,"node_id":"MDQ6VXNlcjE2MzUyOTc3","avatar_url":"https://avatars.githubusercontent.com/u/16352977?v=4","gravatar_id":"","url":"https://api.github.com/users/aditiwari01","html_url":"https://github.com/aditiwari01","followers_url":"https://api.github.com/users/aditiwari01/followers","following_url":"https://api.github.com/users/aditiwari01/following{/other_user}","gists_url":"https://api.github.com/users/aditiwari01/gists{/gist_id}","starred_url":"https://api.github.com/users/aditiwari01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aditiwari01/subscriptions","organizations_url":"https://api.github.com/users/aditiwari01/orgs","repos_url":"https://api.github.com/users/aditiwari01/repos","events_url":"https://api.github.com/users/aditiwari01/events{/privacy}","received_events_url":"https://api.github.com/users/aditiwari01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T17:38:56Z","updated_at":"2021-03-31T17:38:56Z","author_association":"CONTRIBUTOR","body":"Yes. I faced the issue with 2.4.0 version itself.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811280058/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811284724","html_url":"https://github.com/apache/hudi/pull/2678#issuecomment-811284724","issue_url":"https://api.github.com/repos/apache/hudi/issues/2678","id":811284724,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTI4NDcyNA==","user":{"login":"jsbali","id":1778470,"node_id":"MDQ6VXNlcjE3Nzg0NzA=","avatar_url":"https://avatars.githubusercontent.com/u/1778470?v=4","gravatar_id":"","url":"https://api.github.com/users/jsbali","html_url":"https://github.com/jsbali","followers_url":"https://api.github.com/users/jsbali/followers","following_url":"https://api.github.com/users/jsbali/following{/other_user}","gists_url":"https://api.github.com/users/jsbali/gists{/gist_id}","starred_url":"https://api.github.com/users/jsbali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jsbali/subscriptions","organizations_url":"https://api.github.com/users/jsbali/orgs","repos_url":"https://api.github.com/users/jsbali/repos","events_url":"https://api.github.com/users/jsbali/events{/privacy}","received_events_url":"https://api.github.com/users/jsbali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T17:46:18Z","updated_at":"2021-03-31T17:46:18Z","author_association":"CONTRIBUTOR","body":"Created the jira https://issues.apache.org/jira/browse/HUDI-1746.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811284724/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811477227","html_url":"https://github.com/apache/hudi/issues/2294#issuecomment-811477227","issue_url":"https://api.github.com/repos/apache/hudi/issues/2294","id":811477227,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTQ3NzIyNw==","user":{"login":"rubenssoto","id":36298331,"node_id":"MDQ6VXNlcjM2Mjk4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/36298331?v=4","gravatar_id":"","url":"https://api.github.com/users/rubenssoto","html_url":"https://github.com/rubenssoto","followers_url":"https://api.github.com/users/rubenssoto/followers","following_url":"https://api.github.com/users/rubenssoto/following{/other_user}","gists_url":"https://api.github.com/users/rubenssoto/gists{/gist_id}","starred_url":"https://api.github.com/users/rubenssoto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rubenssoto/subscriptions","organizations_url":"https://api.github.com/users/rubenssoto/orgs","repos_url":"https://api.github.com/users/rubenssoto/repos","events_url":"https://api.github.com/users/rubenssoto/events{/privacy}","received_events_url":"https://api.github.com/users/rubenssoto/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T21:27:45Z","updated_at":"2021-03-31T21:27:45Z","author_association":"NONE","body":"@bvaradar is it expected that this bug exists on 0.7.0?\r\nWhat problem this bug cause?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811477227/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811513554","html_url":"https://github.com/apache/hudi/issues/2748#issuecomment-811513554","issue_url":"https://api.github.com/repos/apache/hudi/issues/2748","id":811513554,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTUxMzU1NA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T22:43:43Z","updated_at":"2021-03-31T22:43:43Z","author_association":"CONTRIBUTOR","body":"@aditiwari01 : don't think we are looking to support spark versions < 2.4.3. Its always been the case, and its a documentation issue. we will fix it. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811513554/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811565897","html_url":"https://github.com/apache/hudi/issues/2707#issuecomment-811565897","issue_url":"https://api.github.com/repos/apache/hudi/issues/2707","id":811565897,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTU2NTg5Nw==","user":{"login":"zherenyu831","id":52404525,"node_id":"MDQ6VXNlcjUyNDA0NTI1","avatar_url":"https://avatars.githubusercontent.com/u/52404525?v=4","gravatar_id":"","url":"https://api.github.com/users/zherenyu831","html_url":"https://github.com/zherenyu831","followers_url":"https://api.github.com/users/zherenyu831/followers","following_url":"https://api.github.com/users/zherenyu831/following{/other_user}","gists_url":"https://api.github.com/users/zherenyu831/gists{/gist_id}","starred_url":"https://api.github.com/users/zherenyu831/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zherenyu831/subscriptions","organizations_url":"https://api.github.com/users/zherenyu831/orgs","repos_url":"https://api.github.com/users/zherenyu831/repos","events_url":"https://api.github.com/users/zherenyu831/events{/privacy}","received_events_url":"https://api.github.com/users/zherenyu831/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T01:08:18Z","updated_at":"2021-04-01T01:09:58Z","author_association":"CONTRIBUTOR","body":"@jsbali \r\nFor make everything clear:\r\nOn archiving:\r\nSince the first replacecommit have 0 partitionToReplaceFileIds, and it failed at\r\nhttps://github.com/apache/hudi/blob/master/hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/ReplaceArchivalHelper.java#L73\r\n\r\nwith error `Positive number of partitions required`\r\n\r\nSolution is \r\nManually delete first replacecommit or  ignore deletion on  0 partitionToReplaceFileIds replacecommit  in the code as your mentioned on your ticket\r\n\r\nAfter I deleted the first replacecommit, the archiving finished successfully \r\nBut I got another issue, \r\nhttps://github.com/apache/hudi/issues/2707#issuecomment-804831651\r\n\r\nThis is not related to what I deleted, as you can see, instant time is different\r\nOnce the commits has been deleted on archiving process, hudi tried to load timeline again without reload the commits.\r\n\r\nI didn't debug more, since I want to ask the developers about how they want to deal with replaceFile deletion.\r\nseems like someone want to use cleaner to handle it.\r\nhttps://github.com/apache/hudi/issues/2707#issuecomment-804849028\r\n\r\nUnfortunately, I also found cleaner is not working well with insert_overwrite_table, \r\nit only keep one file group\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811565897/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811582115","html_url":"https://github.com/apache/hudi/pull/2751#issuecomment-811582115","issue_url":"https://api.github.com/repos/apache/hudi/issues/2751","id":811582115,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTU4MjExNQ==","user":{"login":"li36909","id":3632162,"node_id":"MDQ6VXNlcjM2MzIxNjI=","avatar_url":"https://avatars.githubusercontent.com/u/3632162?v=4","gravatar_id":"","url":"https://api.github.com/users/li36909","html_url":"https://github.com/li36909","followers_url":"https://api.github.com/users/li36909/followers","following_url":"https://api.github.com/users/li36909/following{/other_user}","gists_url":"https://api.github.com/users/li36909/gists{/gist_id}","starred_url":"https://api.github.com/users/li36909/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/li36909/subscriptions","organizations_url":"https://api.github.com/users/li36909/orgs","repos_url":"https://api.github.com/users/li36909/repos","events_url":"https://api.github.com/users/li36909/events{/privacy}","received_events_url":"https://api.github.com/users/li36909/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T01:59:22Z","updated_at":"2021-04-01T01:59:22Z","author_association":"CONTRIBUTOR","body":"cc @nsivabalan could you help to take a look, thank you","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811582115/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811582823","html_url":"https://github.com/apache/hudi/issues/2609#issuecomment-811582823","issue_url":"https://api.github.com/repos/apache/hudi/issues/2609","id":811582823,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTU4MjgyMw==","user":{"login":"rshanmugam1","id":42749351,"node_id":"MDQ6VXNlcjQyNzQ5MzUx","avatar_url":"https://avatars.githubusercontent.com/u/42749351?v=4","gravatar_id":"","url":"https://api.github.com/users/rshanmugam1","html_url":"https://github.com/rshanmugam1","followers_url":"https://api.github.com/users/rshanmugam1/followers","following_url":"https://api.github.com/users/rshanmugam1/following{/other_user}","gists_url":"https://api.github.com/users/rshanmugam1/gists{/gist_id}","starred_url":"https://api.github.com/users/rshanmugam1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rshanmugam1/subscriptions","organizations_url":"https://api.github.com/users/rshanmugam1/orgs","repos_url":"https://api.github.com/users/rshanmugam1/repos","events_url":"https://api.github.com/users/rshanmugam1/events{/privacy}","received_events_url":"https://api.github.com/users/rshanmugam1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T02:01:23Z","updated_at":"2021-04-01T02:01:23Z","author_association":"NONE","body":"Thanks very much Sudha and team. \r\n\r\ni will look in that direction and make sure that the cause. if that is the case, any pointers how to fix it. or any reference how it got fixed in facebook version of presto would be helpful. so that we can try same in Trino. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811582823/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811589593","html_url":"https://github.com/apache/hudi/pull/2722#issuecomment-811589593","issue_url":"https://api.github.com/repos/apache/hudi/issues/2722","id":811589593,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTU4OTU5Mw==","user":{"login":"garyli1019","id":23007841,"node_id":"MDQ6VXNlcjIzMDA3ODQx","avatar_url":"https://avatars.githubusercontent.com/u/23007841?v=4","gravatar_id":"","url":"https://api.github.com/users/garyli1019","html_url":"https://github.com/garyli1019","followers_url":"https://api.github.com/users/garyli1019/followers","following_url":"https://api.github.com/users/garyli1019/following{/other_user}","gists_url":"https://api.github.com/users/garyli1019/gists{/gist_id}","starred_url":"https://api.github.com/users/garyli1019/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garyli1019/subscriptions","organizations_url":"https://api.github.com/users/garyli1019/orgs","repos_url":"https://api.github.com/users/garyli1019/repos","events_url":"https://api.github.com/users/garyli1019/events{/privacy}","received_events_url":"https://api.github.com/users/garyli1019/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T02:21:53Z","updated_at":"2021-04-01T02:21:53Z","author_association":"MEMBER","body":"@xiarixiaoyao Thanks for your contribution. Looks like you are able to reproduce this problem in the unit test. Is that possible to add the unit test to this pr as well?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811589593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811590982","html_url":"https://github.com/apache/hudi/pull/2751#issuecomment-811590982","issue_url":"https://api.github.com/repos/apache/hudi/issues/2751","id":811590982,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTU5MDk4Mg==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T02:26:15Z","updated_at":"2021-04-01T02:26:15Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2751?src=pr&el=h1) Report\n> Merging [#2751](https://codecov.io/gh/apache/hudi/pull/2751?src=pr&el=desc) (2de7140) into [master](https://codecov.io/gh/apache/hudi/commit/fe16d0de7c76105775c887b700751241bc82624c?el=desc) (fe16d0d) will **increase** coverage by `17.69%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2751/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2751?src=pr&el=tree)\n\n```diff\n@@              Coverage Diff              @@\n##             master    #2751       +/-   ##\n=============================================\n+ Coverage     52.04%   69.73%   +17.69%     \n+ Complexity     3625      371     -3254     \n=============================================\n  Files           479       54      -425     \n  Lines         22804     1989    -20815     \n  Branches       2415      236     -2179     \n=============================================\n- Hits          11868     1387    -10481     \n+ Misses         9911      471     -9440     \n+ Partials       1025      131      -894     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `?` | `?` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `69.73% <ø> (-0.06%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2751?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...apache/hudi/utilities/deltastreamer/DeltaSync.java](https://codecov.io/gh/apache/hudi/pull/2751/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvRGVsdGFTeW5jLmphdmE=) | `71.37% <0.00%> (-0.35%)` | `55.00% <0.00%> (-1.00%)` | |\n| [...sioning/clean/CleanMetadataV2MigrationHandler.java](https://codecov.io/gh/apache/hudi/pull/2751/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL3RpbWVsaW5lL3ZlcnNpb25pbmcvY2xlYW4vQ2xlYW5NZXRhZGF0YVYyTWlncmF0aW9uSGFuZGxlci5qYXZh) | | | |\n| [...org/apache/hudi/common/table/log/AppendResult.java](https://codecov.io/gh/apache/hudi/pull/2751/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9BcHBlbmRSZXN1bHQuamF2YQ==) | | | |\n| [...oning/compaction/CompactionV2MigrationHandler.java](https://codecov.io/gh/apache/hudi/pull/2751/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL3RpbWVsaW5lL3ZlcnNpb25pbmcvY29tcGFjdGlvbi9Db21wYWN0aW9uVjJNaWdyYXRpb25IYW5kbGVyLmphdmE=) | | | |\n| [...on/table/timeline/versioning/MetadataMigrator.java](https://codecov.io/gh/apache/hudi/pull/2751/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL3RpbWVsaW5lL3ZlcnNpb25pbmcvTWV0YWRhdGFNaWdyYXRvci5qYXZh) | | | |\n| [...e/hudi/common/table/timeline/dto/FileGroupDTO.java](https://codecov.io/gh/apache/hudi/pull/2751/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL3RpbWVsaW5lL2R0by9GaWxlR3JvdXBEVE8uamF2YQ==) | | | |\n| [...di/sink/partitioner/delta/DeltaBucketAssigner.java](https://codecov.io/gh/apache/hudi/pull/2751/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL3BhcnRpdGlvbmVyL2RlbHRhL0RlbHRhQnVja2V0QXNzaWduZXIuamF2YQ==) | | | |\n| [...che/hudi/metadata/TimelineMergedTableMetadata.java](https://codecov.io/gh/apache/hudi/pull/2751/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvbWV0YWRhdGEvVGltZWxpbmVNZXJnZWRUYWJsZU1ldGFkYXRhLmphdmE=) | | | |\n| [...pache/hudi/io/storage/HoodieFileReaderFactory.java](https://codecov.io/gh/apache/hudi/pull/2751/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaW8vc3RvcmFnZS9Ib29kaWVGaWxlUmVhZGVyRmFjdG9yeS5qYXZh) | | | |\n| [...oning/compaction/CompactionV1MigrationHandler.java](https://codecov.io/gh/apache/hudi/pull/2751/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL3RpbWVsaW5lL3ZlcnNpb25pbmcvY29tcGFjdGlvbi9Db21wYWN0aW9uVjFNaWdyYXRpb25IYW5kbGVyLmphdmE=) | | | |\n| ... and [415 more](https://codecov.io/gh/apache/hudi/pull/2751/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811590982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811596187","html_url":"https://github.com/apache/hudi/pull/2752#issuecomment-811596187","issue_url":"https://api.github.com/repos/apache/hudi/issues/2752","id":811596187,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTU5NjE4Nw==","user":{"login":"li36909","id":3632162,"node_id":"MDQ6VXNlcjM2MzIxNjI=","avatar_url":"https://avatars.githubusercontent.com/u/3632162?v=4","gravatar_id":"","url":"https://api.github.com/users/li36909","html_url":"https://github.com/li36909","followers_url":"https://api.github.com/users/li36909/followers","following_url":"https://api.github.com/users/li36909/following{/other_user}","gists_url":"https://api.github.com/users/li36909/gists{/gist_id}","starred_url":"https://api.github.com/users/li36909/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/li36909/subscriptions","organizations_url":"https://api.github.com/users/li36909/orgs","repos_url":"https://api.github.com/users/li36909/repos","events_url":"https://api.github.com/users/li36909/events{/privacy}","received_events_url":"https://api.github.com/users/li36909/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T02:41:51Z","updated_at":"2021-04-01T02:41:51Z","author_association":"CONTRIBUTOR","body":"cc @nsivabalan could you help to take a look, thank you","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811596187/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811608059","html_url":"https://github.com/apache/hudi/pull/2753#issuecomment-811608059","issue_url":"https://api.github.com/repos/apache/hudi/issues/2753","id":811608059,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTYwODA1OQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T03:18:43Z","updated_at":"2021-04-01T03:18:43Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2753?src=pr&el=h1) Report\n> Merging [#2753](https://codecov.io/gh/apache/hudi/pull/2753?src=pr&el=desc) (43eb4f1) into [master](https://codecov.io/gh/apache/hudi/commit/fe16d0de7c76105775c887b700751241bc82624c?el=desc) (fe16d0d) will **decrease** coverage by `42.64%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2753/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2753?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master   #2753       +/-   ##\n============================================\n- Coverage     52.04%   9.40%   -42.65%     \n+ Complexity     3625      48     -3577     \n============================================\n  Files           479      54      -425     \n  Lines         22804    1989    -20815     \n  Branches       2415     236     -2179     \n============================================\n- Hits          11868     187    -11681     \n+ Misses         9911    1789     -8122     \n+ Partials       1025      13     -1012     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `?` | `?` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `9.40% <ø> (-60.39%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2753?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...va/org/apache/hudi/utilities/IdentitySplitter.java](https://codecov.io/gh/apache/hudi/pull/2753/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0lkZW50aXR5U3BsaXR0ZXIuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-2.00%)` | |\n| [...va/org/apache/hudi/utilities/schema/SchemaSet.java](https://codecov.io/gh/apache/hudi/pull/2753/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFTZXQuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-3.00%)` | |\n| [...a/org/apache/hudi/utilities/sources/RowSource.java](https://codecov.io/gh/apache/hudi/pull/2753/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUm93U291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [.../org/apache/hudi/utilities/sources/AvroSource.java](https://codecov.io/gh/apache/hudi/pull/2753/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQXZyb1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [.../org/apache/hudi/utilities/sources/JsonSource.java](https://codecov.io/gh/apache/hudi/pull/2753/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvblNvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [...rg/apache/hudi/utilities/sources/CsvDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2753/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQ3N2REZTU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-10.00%)` | |\n| [...g/apache/hudi/utilities/sources/JsonDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2753/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkRGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [...apache/hudi/utilities/sources/JsonKafkaSource.java](https://codecov.io/gh/apache/hudi/pull/2753/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkthZmthU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-6.00%)` | |\n| [...pache/hudi/utilities/sources/ParquetDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2753/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUGFycXVldERGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-5.00%)` | |\n| [...lities/schema/SchemaProviderWithPostProcessor.java](https://codecov.io/gh/apache/hudi/pull/2753/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFQcm92aWRlcldpdGhQb3N0UHJvY2Vzc29yLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| ... and [455 more](https://codecov.io/gh/apache/hudi/pull/2753/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811608059/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811610689","html_url":"https://github.com/apache/hudi/pull/2752#issuecomment-811610689","issue_url":"https://api.github.com/repos/apache/hudi/issues/2752","id":811610689,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTYxMDY4OQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T03:27:01Z","updated_at":"2021-04-01T03:27:01Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2752?src=pr&el=h1) Report\n> Merging [#2752](https://codecov.io/gh/apache/hudi/pull/2752?src=pr&el=desc) (2152760) into [master](https://codecov.io/gh/apache/hudi/commit/fe16d0de7c76105775c887b700751241bc82624c?el=desc) (fe16d0d) will **decrease** coverage by `0.00%`.\n> The diff coverage is `0.00%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2752/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2752?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2752      +/-   ##\n============================================\n- Coverage     52.04%   52.03%   -0.01%     \n+ Complexity     3625     3624       -1     \n============================================\n  Files           479      479              \n  Lines         22804    22808       +4     \n  Branches       2415     2415              \n============================================\n+ Hits          11868    11869       +1     \n- Misses         9911     9914       +3     \n  Partials       1025     1025              \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `36.94% <0.00%> (-0.07%)` | `0.00 <0.00> (ø)` | |\n| hudiclient | `∅ <ø> (∅)` | `0.00 <ø> (ø)` | |\n| hudicommon | `50.94% <ø> (+0.01%)` | `0.00 <ø> (ø)` | |\n| hudiflink | `56.01% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.44% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisparkdatasource | `70.87% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisync | `45.47% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `64.36% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.73% <ø> (-0.06%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2752?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...n/java/org/apache/hudi/cli/commands/SparkMain.java](https://codecov.io/gh/apache/hudi/pull/2752/diff?src=pr&el=tree#diff-aHVkaS1jbGkvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY2xpL2NvbW1hbmRzL1NwYXJrTWFpbi5qYXZh) | `6.72% <0.00%> (-0.12%)` | `4.00 <0.00> (ø)` | |\n| [...apache/hudi/utilities/deltastreamer/DeltaSync.java](https://codecov.io/gh/apache/hudi/pull/2752/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvRGVsdGFTeW5jLmphdmE=) | `71.37% <0.00%> (-0.35%)` | `55.00% <0.00%> (-1.00%)` | |\n| [...e/hudi/common/table/log/HoodieLogFormatWriter.java](https://codecov.io/gh/apache/hudi/pull/2752/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9Ib29kaWVMb2dGb3JtYXRXcml0ZXIuamF2YQ==) | `79.68% <0.00%> (+1.56%)` | `26.00% <0.00%> (ø%)` | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811610689/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811614768","html_url":"https://github.com/apache/hudi/issues/2609#issuecomment-811614768","issue_url":"https://api.github.com/repos/apache/hudi/issues/2609","id":811614768,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTYxNDc2OA==","user":{"login":"tooptoop4","id":33283496,"node_id":"MDQ6VXNlcjMzMjgzNDk2","avatar_url":"https://avatars.githubusercontent.com/u/33283496?v=4","gravatar_id":"","url":"https://api.github.com/users/tooptoop4","html_url":"https://github.com/tooptoop4","followers_url":"https://api.github.com/users/tooptoop4/followers","following_url":"https://api.github.com/users/tooptoop4/following{/other_user}","gists_url":"https://api.github.com/users/tooptoop4/gists{/gist_id}","starred_url":"https://api.github.com/users/tooptoop4/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tooptoop4/subscriptions","organizations_url":"https://api.github.com/users/tooptoop4/orgs","repos_url":"https://api.github.com/users/tooptoop4/repos","events_url":"https://api.github.com/users/tooptoop4/events{/privacy}","received_events_url":"https://api.github.com/users/tooptoop4/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T03:39:47Z","updated_at":"2021-04-01T03:39:47Z","author_association":"NONE","body":"@rshanmugam1 see https://prestodb.io/blog/2020/08/04/prestodb-and-hudi   and https://github.com/prestodb/presto/commit/9fd2459d98efd0809023b175ba53775466b74cc6 and https://github.com/prestodb/presto/commit/cfb2e7aa077954a02c048e81c97a47994d329852","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811614768/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811619487","html_url":"https://github.com/apache/hudi/issues/2707#issuecomment-811619487","issue_url":"https://api.github.com/repos/apache/hudi/issues/2707","id":811619487,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTYxOTQ4Nw==","user":{"login":"ssdong","id":3754011,"node_id":"MDQ6VXNlcjM3NTQwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/3754011?v=4","gravatar_id":"","url":"https://api.github.com/users/ssdong","html_url":"https://github.com/ssdong","followers_url":"https://api.github.com/users/ssdong/followers","following_url":"https://api.github.com/users/ssdong/following{/other_user}","gists_url":"https://api.github.com/users/ssdong/gists{/gist_id}","starred_url":"https://api.github.com/users/ssdong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ssdong/subscriptions","organizations_url":"https://api.github.com/users/ssdong/orgs","repos_url":"https://api.github.com/users/ssdong/repos","events_url":"https://api.github.com/users/ssdong/events{/privacy}","received_events_url":"https://api.github.com/users/ssdong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T03:56:40Z","updated_at":"2021-04-02T13:59:45Z","author_association":"CONTRIBUTOR","body":"@jsbali To give out extra insights and details, as @zherenyu831 has posted in the beginning:\r\n```\r\n[20210323080718__replacecommit__COMPLETED]: size : 0\r\n[20210323081449__replacecommit__COMPLETED]: size : 1\r\n[20210323082046__replacecommit__COMPLETED]: size : 1\r\n[20210323082758__replacecommit__COMPLETED]: size : 1\r\n[20210323084004__replacecommit__COMPLETED]: size : 1\r\n[20210323085044__replacecommit__COMPLETED]: size : 1\r\n[20210323085823__replacecommit__COMPLETED]: size : 1\r\n[20210323090550__replacecommit__COMPLETED]: size : 1\r\n[20210323091700__replacecommit__COMPLETED]: size : 1\r\n```\r\nIf we keep everything the same and let archive logic handling everything, it would fail at 0 `partitionToReplaceFileIds` against `20210323080718__replacecommit__COMPLETED`(the first item in the list above), and this is a known issue. \r\n\r\nTo make the archive work, we tried to _manually_ delete the first _empty_ commit file, which is `20210323080718__replacecommit__COMPLETED`(the first item in the list above). This has succeeded the archive, but instead, it has failed upon `User class threw exception: org.apache.hudi.exception.HoodieIOException: Could not read commit details from s3://xxx/data/.hoodie/20210323081449.replacecommit`(the second item in the list above)\r\n\r\nNow to reason through the underlying mechanism of this error, given the archive was successful, that means a few commit files have been placed within the `.archive` folder, let's say \r\n```\r\n[20210323081449__replacecommit__COMPLETED]: size : 1\r\n[20210323082046__replacecommit__COMPLETED]: size : 1\r\n[20210323082758__replacecommit__COMPLETED]: size : 1\r\n[20210323084004__replacecommit__COMPLETED]: size : 1\r\n[20210323085044__replacecommit__COMPLETED]: size : 1\r\n```\r\nhave been successfully moved and placed in `.archive`. At this moment, the timeline has been updated and there are 3 remaining commit files which are:\r\n```\r\n[20210323085823__replacecommit__COMPLETED]: size : 1\r\n[20210323090550__replacecommit__COMPLETED]: size : 1\r\n[20210323091700__replacecommit__COMPLETED]: size : 1\r\n```\r\n\r\nNow, if you pay attention to the stack trace which caused `User class threw exception: org.apache.hudi.exception.HoodieIOException: Could not read commit details from s3://xxx/data/.hoodie/20210323081449.replacecommit`, and I am just pasting them again:\r\n```\r\nUser class threw exception: org.apache.hudi.exception.HoodieIOException: Could not read commit details from s3://xxx/data/.hoodie/20210323081449.replacecommit\r\nat org.apache.hudi.common.table.timeline.HoodieActiveTimeline.readDataFromPath(HoodieActiveTimeline.java:530)\r\nat org.apache.hudi.common.table.timeline.HoodieActiveTimeline.getInstantDetails(HoodieActiveTimeline.java:194)\r\nat org.apache.hudi.common.table.view.AbstractTableFileSystemView.lambda$resetFileGroupsReplaced$8(AbstractTableFileSystemView.java:217)\r\nat java.util.stream.ReferencePipeline$7$1.accept(ReferencePipeline.java:269)\r\nat java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)\r\nat java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)\r\nat java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)\r\nat java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)\r\nat java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)\r\nat java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)\r\nat org.apache.hudi.common.table.view.AbstractTableFileSystemView.resetFileGroupsReplaced(AbstractTableFileSystemView.java:228)\r\nat org.apache.hudi.common.table.view.AbstractTableFileSystemView.init(AbstractTableFileSystemView.java:106)\r\nat org.apache.hudi.common.table.view.HoodieTableFileSystemView.init(HoodieTableFileSystemView.java:106)\r\nat org.apache.hudi.common.table.view.AbstractTableFileSystemView.reset(AbstractTableFileSystemView.java:248)\r\nat org.apache.hudi.common.table.view.HoodieTableFileSystemView.close(HoodieTableFileSystemView.java:353)\r\nat java.util.concurrent.ConcurrentHashMap$ValuesView.forEach(ConcurrentHashMap.java:4707)\r\nat org.apache.hudi.common.table.view.FileSystemViewManager.close(FileSystemViewManager.java:118)\r\nat org.apache.hudi.timeline.service.TimelineService.close(TimelineService.java:179)\r\nat org.apache.hudi.client.embedded.EmbeddedTimelineService.stop(EmbeddedTimelineService.java:112)\r\n```\r\n\r\nAfter a `close` action being triggered on `TimelineService`, which is understandable, it propagates to `HoodieTableFileSystemView.close` and there is:\r\n```\r\nat org.apache.hudi.common.table.view.AbstractTableFileSystemView.init(AbstractTableFileSystemView.java:106)\r\nat org.apache.hudi.common.table.view.HoodieTableFileSystemView.init(HoodieTableFileSystemView.java:106)\r\nat org.apache.hudi.common.table.view.AbstractTableFileSystemView.reset(AbstractTableFileSystemView.java:248)\r\n```\r\nhappening right after it. Now I am not exactly sure why we need an `init` after `close` being called upon the `HoodieTableFileSystemView`.(Probably someone with deep knowledge could answer it). If you look at the source code, the `reset` and `init` are _initializing with new Hoodie timeline_.  (\r\n```\r\n@Override\r\n  public final void reset() {\r\n    try {\r\n      writeLock.lock();\r\n\r\n      addedPartitions.clear();\r\n      resetViewState();\r\n\r\n      bootstrapIndex = null;\r\n\r\n      // Initialize with new Hoodie timeline.\r\n      init(metaClient, getTimeline());\r\n    } finally {\r\n      writeLock.unlock();\r\n    }\r\n  }\r\n```\r\nThis above `getTimeline()` _didn't_ really fetch a _new_ timeline since TimelineService has been closed, and obviously `public void sync()` isn't being triggered, which resets the old timeline with the new ones. The Hudi table view's in-memory timeline remains the very _old_ timeline, i.e. the one _before_ doing the archive. If it tries to read those commits from in-memory and perform corresponding actions, it will certainly fail without a doubt since we have archived the commit files, and now they exist in the `.archive` folder.\r\n\r\nIt does sound like a paradox here, given that it throws exceptions _after_ we manually delete the commit file to try to save the archive logic. Shouldn't it already exists from the beginning that even if we have a successful archiving action, the in-memory timeline remains old based on the mechanisms we do closing and initializing against a Hudi table view?\r\n\r\nThoughts? 😅 ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811619487/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811625350","html_url":"https://github.com/apache/hudi/pull/2754#issuecomment-811625350","issue_url":"https://api.github.com/repos/apache/hudi/issues/2754","id":811625350,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTYyNTM1MA==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T04:15:07Z","updated_at":"2021-04-06T08:26:13Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2754?src=pr&el=h1) Report\n> Merging [#2754](https://codecov.io/gh/apache/hudi/pull/2754?src=pr&el=desc) (b61ec85) into [master](https://codecov.io/gh/apache/hudi/commit/920537cac83d59ac05676fb952d5479c41adf757?el=desc) (920537c) will **increase** coverage by `17.41%`.\n> The diff coverage is `100.00%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2754/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2754?src=pr&el=tree)\n\n```diff\n@@              Coverage Diff              @@\n##             master    #2754       +/-   ##\n=============================================\n+ Coverage     52.30%   69.72%   +17.41%     \n+ Complexity     3689      373     -3316     \n=============================================\n  Files           483       54      -429     \n  Lines         23099     1995    -21104     \n  Branches       2460      235     -2225     \n=============================================\n- Hits          12082     1391    -10691     \n+ Misses         9949      473     -9476     \n+ Partials       1068      131      -937     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `?` | `?` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `69.72% <100.00%> (-0.02%)` | `0.00 <2.00> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2754?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...hudi/utilities/sources/helpers/KafkaOffsetGen.java](https://codecov.io/gh/apache/hudi/pull/2754/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvaGVscGVycy9LYWZrYU9mZnNldEdlbi5qYXZh) | `87.27% <100.00%> (+0.23%)` | `21.00 <2.00> (+2.00)` | |\n| [...apache/hudi/utilities/deltastreamer/DeltaSync.java](https://codecov.io/gh/apache/hudi/pull/2754/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvRGVsdGFTeW5jLmphdmE=) | `71.08% <0.00%> (-0.35%)` | `55.00% <0.00%> (-1.00%)` | |\n| [...e/hudi/exception/HoodieDeltaStreamerException.java](https://codecov.io/gh/apache/hudi/pull/2754/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvZXhjZXB0aW9uL0hvb2RpZURlbHRhU3RyZWFtZXJFeGNlcHRpb24uamF2YQ==) | | | |\n| [...til/jvm/HotSpotMemoryLayoutSpecification64bit.java](https://codecov.io/gh/apache/hudi/pull/2754/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3V0aWwvanZtL0hvdFNwb3RNZW1vcnlMYXlvdXRTcGVjaWZpY2F0aW9uNjRiaXQuamF2YQ==) | | | |\n| [...he/hudi/table/format/cow/ParquetDecimalVector.java](https://codecov.io/gh/apache/hudi/pull/2754/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS90YWJsZS9mb3JtYXQvY293L1BhcnF1ZXREZWNpbWFsVmVjdG9yLmphdmE=) | | | |\n| [...hudi/common/model/HoodieReplaceCommitMetadata.java](https://codecov.io/gh/apache/hudi/pull/2754/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL21vZGVsL0hvb2RpZVJlcGxhY2VDb21taXRNZXRhZGF0YS5qYXZh) | | | |\n| [.../apache/hudi/timeline/service/TimelineService.java](https://codecov.io/gh/apache/hudi/pull/2754/diff?src=pr&el=tree#diff-aHVkaS10aW1lbGluZS1zZXJ2aWNlL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9odWRpL3RpbWVsaW5lL3NlcnZpY2UvVGltZWxpbmVTZXJ2aWNlLmphdmE=) | | | |\n| [...rc/main/java/org/apache/hudi/ApiMaturityLevel.java](https://codecov.io/gh/apache/hudi/pull/2754/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvQXBpTWF0dXJpdHlMZXZlbC5qYXZh) | | | |\n| [...rg/apache/hudi/metadata/HoodieMetadataMetrics.java](https://codecov.io/gh/apache/hudi/pull/2754/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvbWV0YWRhdGEvSG9vZGllTWV0YWRhdGFNZXRyaWNzLmphdmE=) | | | |\n| [...ain/java/org/apache/hudi/cli/utils/CommitUtil.java](https://codecov.io/gh/apache/hudi/pull/2754/diff?src=pr&el=tree#diff-aHVkaS1jbGkvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY2xpL3V0aWxzL0NvbW1pdFV0aWwuamF2YQ==) | | | |\n| ... and [421 more](https://codecov.io/gh/apache/hudi/pull/2754/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811625350/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811627648","html_url":"https://github.com/apache/hudi/pull/1929#issuecomment-811627648","issue_url":"https://api.github.com/repos/apache/hudi/issues/1929","id":811627648,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTYyNzY0OA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T04:23:19Z","updated_at":"2021-04-01T04:23:19Z","author_association":"CONTRIBUTOR","body":"Closing in favor of https://github.com/apache/hudi/pull/2666","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811627648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811654731","html_url":"https://github.com/apache/hudi/pull/2747#issuecomment-811654731","issue_url":"https://api.github.com/repos/apache/hudi/issues/2747","id":811654731,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTY1NDczMQ==","user":{"login":"vingov","id":1142498,"node_id":"MDQ6VXNlcjExNDI0OTg=","avatar_url":"https://avatars.githubusercontent.com/u/1142498?v=4","gravatar_id":"","url":"https://api.github.com/users/vingov","html_url":"https://github.com/vingov","followers_url":"https://api.github.com/users/vingov/followers","following_url":"https://api.github.com/users/vingov/following{/other_user}","gists_url":"https://api.github.com/users/vingov/gists{/gist_id}","starred_url":"https://api.github.com/users/vingov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vingov/subscriptions","organizations_url":"https://api.github.com/users/vingov/orgs","repos_url":"https://api.github.com/users/vingov/repos","events_url":"https://api.github.com/users/vingov/events{/privacy}","received_events_url":"https://api.github.com/users/vingov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T05:36:38Z","updated_at":"2021-04-01T05:36:38Z","author_association":"CONTRIBUTOR","body":"@yanghua - I've fixed the build, can you please merge this code?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811654731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811678698","html_url":"https://github.com/apache/hudi/pull/2755#issuecomment-811678698","issue_url":"https://api.github.com/repos/apache/hudi/issues/2755","id":811678698,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTY3ODY5OA==","user":{"login":"xurunbai","id":34646333,"node_id":"MDQ6VXNlcjM0NjQ2MzMz","avatar_url":"https://avatars.githubusercontent.com/u/34646333?v=4","gravatar_id":"","url":"https://api.github.com/users/xurunbai","html_url":"https://github.com/xurunbai","followers_url":"https://api.github.com/users/xurunbai/followers","following_url":"https://api.github.com/users/xurunbai/following{/other_user}","gists_url":"https://api.github.com/users/xurunbai/gists{/gist_id}","starred_url":"https://api.github.com/users/xurunbai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xurunbai/subscriptions","organizations_url":"https://api.github.com/users/xurunbai/orgs","repos_url":"https://api.github.com/users/xurunbai/repos","events_url":"https://api.github.com/users/xurunbai/events{/privacy}","received_events_url":"https://api.github.com/users/xurunbai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T06:30:39Z","updated_at":"2021-04-01T06:30:39Z","author_association":"NONE","body":"Add HoodieFlinkClient InsertOverwrite","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811678698/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811679455","html_url":"https://github.com/apache/hudi/pull/2747#issuecomment-811679455","issue_url":"https://api.github.com/repos/apache/hudi/issues/2747","id":811679455,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTY3OTQ1NQ==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T06:32:18Z","updated_at":"2021-04-01T06:32:18Z","author_association":"CONTRIBUTOR","body":"> @yanghua - I've fixed the build, can you please merge this code?\r\n\r\nThanks, IMO, can you add a unit test for the feature.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811679455/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811705289","html_url":"https://github.com/apache/hudi/pull/2722#issuecomment-811705289","issue_url":"https://api.github.com/repos/apache/hudi/issues/2722","id":811705289,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTcwNTI4OQ==","user":{"login":"xiarixiaoyao","id":13514703,"node_id":"MDQ6VXNlcjEzNTE0NzAz","avatar_url":"https://avatars.githubusercontent.com/u/13514703?v=4","gravatar_id":"","url":"https://api.github.com/users/xiarixiaoyao","html_url":"https://github.com/xiarixiaoyao","followers_url":"https://api.github.com/users/xiarixiaoyao/followers","following_url":"https://api.github.com/users/xiarixiaoyao/following{/other_user}","gists_url":"https://api.github.com/users/xiarixiaoyao/gists{/gist_id}","starred_url":"https://api.github.com/users/xiarixiaoyao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiarixiaoyao/subscriptions","organizations_url":"https://api.github.com/users/xiarixiaoyao/orgs","repos_url":"https://api.github.com/users/xiarixiaoyao/repos","events_url":"https://api.github.com/users/xiarixiaoyao/events{/privacy}","received_events_url":"https://api.github.com/users/xiarixiaoyao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T07:24:23Z","updated_at":"2021-04-01T07:24:23Z","author_association":"CONTRIBUTOR","body":"thanks @garyli1019 .   ok， i will try to add unit test","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811705289/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811710440","html_url":"https://github.com/apache/hudi/pull/2755#issuecomment-811710440","issue_url":"https://api.github.com/repos/apache/hudi/issues/2755","id":811710440,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTcxMDQ0MA==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T07:33:48Z","updated_at":"2021-04-01T07:33:48Z","author_association":"CONTRIBUTOR","body":"@xurunbai Thanks for your contribution. Can you file a jira ticket for this feature?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811710440/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811770811","html_url":"https://github.com/apache/hudi/pull/2755#issuecomment-811770811","issue_url":"https://api.github.com/repos/apache/hudi/issues/2755","id":811770811,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTc3MDgxMQ==","user":{"login":"xurunbai","id":34646333,"node_id":"MDQ6VXNlcjM0NjQ2MzMz","avatar_url":"https://avatars.githubusercontent.com/u/34646333?v=4","gravatar_id":"","url":"https://api.github.com/users/xurunbai","html_url":"https://github.com/xurunbai","followers_url":"https://api.github.com/users/xurunbai/followers","following_url":"https://api.github.com/users/xurunbai/following{/other_user}","gists_url":"https://api.github.com/users/xurunbai/gists{/gist_id}","starred_url":"https://api.github.com/users/xurunbai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xurunbai/subscriptions","organizations_url":"https://api.github.com/users/xurunbai/orgs","repos_url":"https://api.github.com/users/xurunbai/repos","events_url":"https://api.github.com/users/xurunbai/events{/privacy}","received_events_url":"https://api.github.com/users/xurunbai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T09:10:42Z","updated_at":"2021-04-01T09:10:42Z","author_association":"NONE","body":"> @xurunbai Thanks for your contribution. Can you file a jira ticket for this feature?\r\n\r\nOK","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811770811/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811855554","html_url":"https://github.com/apache/hudi/pull/2438#issuecomment-811855554","issue_url":"https://api.github.com/repos/apache/hudi/issues/2438","id":811855554,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTg1NTU1NA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T11:54:41Z","updated_at":"2021-04-01T11:54:41Z","author_association":"CONTRIBUTOR","body":"Myself and Nishith discussed on this. Here is our proposal. \r\nLet's rely on Deltastreamer.Config.checkpoint to pass in any type of checkpoint. \r\nWe can add another config called \"checkpoint.type\" which could default to string for all default checkpoints. For checkpoint of interest of this PR, we could set the value for this new config to \"timestamp\". \r\n\r\nWith this, its upto each source to parse and interpret the checkpoint value and DeltaSync does not need to deal w/ diff checkpointing formats. \r\n\r\nHaving said this, DeltaSync readFromSource() should not have any changes in this diff. \r\nKafkaOffsetGen should have logic to parse diff checkpoint values, based on two values(deltastreamer.config.checkpoint and checkpoint.type). \r\n\r\nWith this, we also moved source specific checkpointing logic within source specific class and did not leak it to DeltaSync which should be agnostic to different Source. \r\n\r\n@liujinhui1994 : Let me know what do you think. Happy to chat more on this. \r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811855554/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811856279","html_url":"https://github.com/apache/hudi/pull/2666#issuecomment-811856279","issue_url":"https://api.github.com/repos/apache/hudi/issues/2666","id":811856279,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTg1NjI3OQ==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T11:56:14Z","updated_at":"2021-04-01T11:56:14Z","author_association":"CONTRIBUTOR","body":"@liujinhui1994 : Can you please update the description with an example. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811856279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811856655","html_url":"https://github.com/apache/hudi/pull/2438#issuecomment-811856655","issue_url":"https://api.github.com/repos/apache/hudi/issues/2438","id":811856655,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTg1NjY1NQ==","user":{"login":"liujinhui1994","id":25769285,"node_id":"MDQ6VXNlcjI1NzY5Mjg1","avatar_url":"https://avatars.githubusercontent.com/u/25769285?v=4","gravatar_id":"","url":"https://api.github.com/users/liujinhui1994","html_url":"https://github.com/liujinhui1994","followers_url":"https://api.github.com/users/liujinhui1994/followers","following_url":"https://api.github.com/users/liujinhui1994/following{/other_user}","gists_url":"https://api.github.com/users/liujinhui1994/gists{/gist_id}","starred_url":"https://api.github.com/users/liujinhui1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liujinhui1994/subscriptions","organizations_url":"https://api.github.com/users/liujinhui1994/orgs","repos_url":"https://api.github.com/users/liujinhui1994/repos","events_url":"https://api.github.com/users/liujinhui1994/events{/privacy}","received_events_url":"https://api.github.com/users/liujinhui1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T11:57:04Z","updated_at":"2021-04-01T11:57:04Z","author_association":"CONTRIBUTOR","body":"> Myself and Nishith discussed on this. Here is our proposal.\r\n> Let's rely on Deltastreamer.Config.checkpoint to pass in any type of checkpoint.\r\n> We can add another config called \"checkpoint.type\" which could default to string for all default checkpoints. For checkpoint of interest of this PR, we could set the value for this new config to \"timestamp\".\r\n> \r\n> With this, its upto each source to parse and interpret the checkpoint value and DeltaSync does not need to deal w/ diff checkpointing formats.\r\n> \r\n> Having said this, DeltaSync readFromSource() should not have any changes in this diff.\r\n> KafkaOffsetGen should have logic to parse diff checkpoint values, based on two values(deltastreamer.config.checkpoint and checkpoint.type).\r\n> \r\n> With this, we also moved source specific checkpointing logic within source specific class and did not leak it to DeltaSync which should be agnostic to different Source.\r\n> \r\n> @liujinhui1994 : Let me know what do you think. Happy to chat more on this.\r\n\r\nGreat, I will modify this PR based on this","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811856655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811861142","html_url":"https://github.com/apache/hudi/pull/2666#issuecomment-811861142","issue_url":"https://api.github.com/repos/apache/hudi/issues/2666","id":811861142,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTg2MTE0Mg==","user":{"login":"liujinhui1994","id":25769285,"node_id":"MDQ6VXNlcjI1NzY5Mjg1","avatar_url":"https://avatars.githubusercontent.com/u/25769285?v=4","gravatar_id":"","url":"https://api.github.com/users/liujinhui1994","html_url":"https://github.com/liujinhui1994","followers_url":"https://api.github.com/users/liujinhui1994/followers","following_url":"https://api.github.com/users/liujinhui1994/following{/other_user}","gists_url":"https://api.github.com/users/liujinhui1994/gists{/gist_id}","starred_url":"https://api.github.com/users/liujinhui1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liujinhui1994/subscriptions","organizations_url":"https://api.github.com/users/liujinhui1994/orgs","repos_url":"https://api.github.com/users/liujinhui1994/repos","events_url":"https://api.github.com/users/liujinhui1994/events{/privacy}","received_events_url":"https://api.github.com/users/liujinhui1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T12:05:52Z","updated_at":"2021-04-01T12:05:52Z","author_association":"CONTRIBUTOR","body":"> @liujinhui1994 : Can you please update the description with an example.\r\n\r\n1、old data \r\nid name        age\r\n1  liujinhui   26\r\n2  sam         25\r\n3  madeline    30\r\n\r\n2、new data\r\n{\"id\": 1,\"name\": \"abc\"}\r\n\r\n3、 final result\r\n1  abc         26\r\n2  sam         25\r\n3  madeline    30","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811861142/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811931337","html_url":"https://github.com/apache/hudi/pull/2091#issuecomment-811931337","issue_url":"https://api.github.com/repos/apache/hudi/issues/2091","id":811931337,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTkzMTMzNw==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T14:04:15Z","updated_at":"2021-04-01T14:04:15Z","author_association":"CONTRIBUTOR","body":"@ivorzhou : if your requirement is to fetch value from previous version of the record and inject into incoming record, we already have another PR open https://github.com/apache/hudi/pull/2666. Feel to clarify and close this PR out if the requirement is same. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811931337/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811939606","html_url":"https://github.com/apache/hudi/pull/2106#issuecomment-811939606","issue_url":"https://api.github.com/repos/apache/hudi/issues/2106","id":811939606,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTkzOTYwNg==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T14:17:27Z","updated_at":"2021-04-01T14:17:27Z","author_association":"CONTRIBUTOR","body":"@Karl-WangSK : we have another PR being reviewed right now for partial updates support. https://github.com/apache/hudi/pull/2666\r\nPlease check it out. We don't need to parse schema for every record. You can get some inspiration from the linked PR. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/811939606/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812019464","html_url":"https://github.com/apache/hudi/pull/2334#issuecomment-812019464","issue_url":"https://api.github.com/repos/apache/hudi/issues/2334","id":812019464,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjAxOTQ2NA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T16:20:43Z","updated_at":"2021-04-01T16:20:43Z","author_association":"CONTRIBUTOR","body":"just to clarify. some schema evolution just for types are working fine w/ hoodie. for eg: integer to double works fine. Problem is that, double to int is where the issue is. I am not sure why schema compatibility check does not fail this evolution.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812019464/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812021796","html_url":"https://github.com/apache/hudi/pull/2334#issuecomment-812021796","issue_url":"https://api.github.com/repos/apache/hudi/issues/2334","id":812021796,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjAyMTc5Ng==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T16:24:38Z","updated_at":"2021-04-01T16:25:38Z","author_association":"CONTRIBUTOR","body":"oh, didn't realize default schema compatibility check is false. I assume if I enable schema compatibility check, double to int evolution is likely to fail. So, not sure what this PR tries to achieve. At least from my local test run, integer to double worked for me. \r\nhttps://gist.github.com/nsivabalan/91f12109e0fe1ca9749ff5290c946778\r\nthis is COW btw. haven't tested w/ MOR. \r\n@pengzhiwei2018 : can you please clarify. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812021796/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812037473","html_url":"https://github.com/apache/hudi/pull/2751#issuecomment-812037473","issue_url":"https://api.github.com/repos/apache/hudi/issues/2751","id":812037473,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjAzNzQ3Mw==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T16:50:53Z","updated_at":"2021-04-01T16:52:45Z","author_association":"CONTRIBUTOR","body":"@li36909 : can you clarify what do you mean by concurrent operations. Ignoring any table services, you mean to say that just a batch of write and rt snapshot view happening concurrently is running into issues? which hudi version are you running.   \r\n@n3nash : you may want to check it out. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812037473/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812096323","html_url":"https://github.com/apache/hudi/issues/2707#issuecomment-812096323","issue_url":"https://api.github.com/repos/apache/hudi/issues/2707","id":812096323,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjA5NjMyMw==","user":{"login":"satishkotha","id":2992755,"node_id":"MDQ6VXNlcjI5OTI3NTU=","avatar_url":"https://avatars.githubusercontent.com/u/2992755?v=4","gravatar_id":"","url":"https://api.github.com/users/satishkotha","html_url":"https://github.com/satishkotha","followers_url":"https://api.github.com/users/satishkotha/followers","following_url":"https://api.github.com/users/satishkotha/following{/other_user}","gists_url":"https://api.github.com/users/satishkotha/gists{/gist_id}","starred_url":"https://api.github.com/users/satishkotha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/satishkotha/subscriptions","organizations_url":"https://api.github.com/users/satishkotha/orgs","repos_url":"https://api.github.com/users/satishkotha/repos","events_url":"https://api.github.com/users/satishkotha/events{/privacy}","received_events_url":"https://api.github.com/users/satishkotha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T18:37:38Z","updated_at":"2021-04-01T18:37:38Z","author_association":"MEMBER","body":"@ssdong thanks for detailed update. Yes, this one seems little tricky. We'll need some more time to investigate. In the meantime, as a workaround, i think you can disable embedded timeline server by setting option 'hoodie.embed.timeline.server'  to false.\r\n\r\n I can look into why reset needs to be called during close and if we can refresh meta client for getting timeline.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812096323/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812212286","html_url":"https://github.com/apache/hudi/issues/2633#issuecomment-812212286","issue_url":"https://api.github.com/repos/apache/hudi/issues/2633","id":812212286,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjIxMjI4Ng==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T22:32:19Z","updated_at":"2021-04-01T22:32:19Z","author_association":"CONTRIBUTOR","body":"@umehrot2 : Looking more closely on the code change to fix this. We need to do more changes.\r\nthe base file check  needs to change  in https://github.com/apache/hudi/blob/e599764c2dcfbbc15d6554fa0df55b7375e4a31d/hudi-client/src/main/java/org/apache/hudi/table/action/deltacommit/UpsertDeltaCommitPartitioner.java#L96\r\n\r\nWe need to be careful otherwise in determining the current commit Time. I think as fix, it is safer to disregard files in pending compaction when selecting small files.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812212286/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812247500","html_url":"https://github.com/apache/hudi/pull/2757#issuecomment-812247500","issue_url":"https://api.github.com/repos/apache/hudi/issues/2757","id":812247500,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjI0NzUwMA==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T00:24:25Z","updated_at":"2021-04-06T03:15:23Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2757?src=pr&el=h1) Report\n> Merging [#2757](https://codecov.io/gh/apache/hudi/pull/2757?src=pr&el=desc) (205ecfc) into [master](https://codecov.io/gh/apache/hudi/commit/9804662bc8e17d6936c20326f17ec7c0360dcaf6?el=desc) (9804662) will **increase** coverage by `0.14%`.\n> The diff coverage is `85.80%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2757/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2757?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2757      +/-   ##\n============================================\n+ Coverage     52.12%   52.27%   +0.14%     \n- Complexity     3646     3678      +32     \n============================================\n  Files           480      484       +4     \n  Lines         22867    23075     +208     \n  Branches       2417     2457      +40     \n============================================\n+ Hits          11920    12063     +143     \n- Misses         9916     9947      +31     \n- Partials       1031     1065      +34     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `37.01% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiclient | `∅ <ø> (∅)` | `0.00 <ø> (ø)` | |\n| hudicommon | `50.78% <ø> (-0.08%)` | `0.00 <ø> (ø)` | |\n| hudiflink | `56.58% <85.80%> (-0.14%)` | `0.00 <35.00> (ø)` | |\n| hudihadoopmr | `33.44% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisparkdatasource | `71.33% <ø> (+0.45%)` | `0.00 <ø> (ø)` | |\n| hudisync | `45.47% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `64.36% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.69% <ø> (-0.04%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2757?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...a/org/apache/hudi/common/util/ReflectionUtils.java](https://codecov.io/gh/apache/hudi/pull/2757/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3V0aWwvUmVmbGVjdGlvblV0aWxzLmphdmE=) | `21.15% <ø> (ø)` | `6.00 <0.00> (ø)` | |\n| [...in/java/org/apache/hudi/table/HoodieTableSink.java](https://codecov.io/gh/apache/hudi/pull/2757/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS90YWJsZS9Ib29kaWVUYWJsZVNpbmsuamF2YQ==) | `12.19% <0.00%> (ø)` | `2.00 <0.00> (ø)` | |\n| [.../main/java/org/apache/hudi/sink/CleanFunction.java](https://codecov.io/gh/apache/hudi/pull/2757/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL0NsZWFuRnVuY3Rpb24uamF2YQ==) | `40.00% <66.66%> (+3.15%)` | `3.00 <1.00> (+1.00)` | |\n| [...e/hudi/sink/transform/RowDataToHoodieFunction.java](https://codecov.io/gh/apache/hudi/pull/2757/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL3RyYW5zZm9ybS9Sb3dEYXRhVG9Ib29kaWVGdW5jdGlvbi5qYXZh) | `83.33% <73.91%> (-7.58%)` | `5.00 <0.00> (-1.00)` | |\n| [...ache/hudi/sink/StreamWriteOperatorCoordinator.java](https://codecov.io/gh/apache/hudi/pull/2757/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL1N0cmVhbVdyaXRlT3BlcmF0b3JDb29yZGluYXRvci5qYXZh) | `68.54% <78.26%> (-5.78%)` | `28.00 <15.00> (-5.00)` | |\n| [...he/hudi/sink/partitioner/BucketAssignFunction.java](https://codecov.io/gh/apache/hudi/pull/2757/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL3BhcnRpdGlvbmVyL0J1Y2tldEFzc2lnbkZ1bmN0aW9uLmphdmE=) | `87.67% <80.00%> (+1.07%)` | `15.00 <1.00> (-9.00)` | :arrow_up: |\n| [.../org/apache/hudi/sink/utils/NonThrownExecutor.java](https://codecov.io/gh/apache/hudi/pull/2757/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL3V0aWxzL05vblRocm93bkV4ZWN1dG9yLmphdmE=) | `66.66% <87.50%> (-11.12%)` | `4.00 <3.00> (-1.00)` | |\n| [...apache/hudi/sink/compact/CompactionCommitSink.java](https://codecov.io/gh/apache/hudi/pull/2757/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL2NvbXBhY3QvQ29tcGFjdGlvbkNvbW1pdFNpbmsuamF2YQ==) | `75.00% <91.66%> (+8.33%)` | `9.00 <3.00> (-1.00)` | :arrow_up: |\n| [...va/org/apache/hudi/configuration/FlinkOptions.java](https://codecov.io/gh/apache/hudi/pull/2757/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9jb25maWd1cmF0aW9uL0ZsaW5rT3B0aW9ucy5qYXZh) | `89.07% <100.00%> (+0.18%)` | `11.00 <0.00> (ø)` | |\n| [...java/org/apache/hudi/sink/StreamWriteFunction.java](https://codecov.io/gh/apache/hudi/pull/2757/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL1N0cmVhbVdyaXRlRnVuY3Rpb24uamF2YQ==) | `80.50% <100.00%> (-2.57%)` | `22.00 <2.00> (-1.00)` | |\n| ... and [25 more](https://codecov.io/gh/apache/hudi/pull/2757/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812247500/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812256475","html_url":"https://github.com/apache/hudi/issues/2588#issuecomment-812256475","issue_url":"https://api.github.com/repos/apache/hudi/issues/2588","id":812256475,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjI1NjQ3NQ==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T00:49:59Z","updated_at":"2021-04-02T00:49:59Z","author_association":"CONTRIBUTOR","body":"We use hive-2.3.4 and have more than 100 jobs running  ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812256475/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812271600","html_url":"https://github.com/apache/hudi/issues/2623#issuecomment-812271600","issue_url":"https://api.github.com/repos/apache/hudi/issues/2623","id":812271600,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjI3MTYwMA==","user":{"login":"root18039532923","id":45333549,"node_id":"MDQ6VXNlcjQ1MzMzNTQ5","avatar_url":"https://avatars.githubusercontent.com/u/45333549?v=4","gravatar_id":"","url":"https://api.github.com/users/root18039532923","html_url":"https://github.com/root18039532923","followers_url":"https://api.github.com/users/root18039532923/followers","following_url":"https://api.github.com/users/root18039532923/following{/other_user}","gists_url":"https://api.github.com/users/root18039532923/gists{/gist_id}","starred_url":"https://api.github.com/users/root18039532923/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/root18039532923/subscriptions","organizations_url":"https://api.github.com/users/root18039532923/orgs","repos_url":"https://api.github.com/users/root18039532923/repos","events_url":"https://api.github.com/users/root18039532923/events{/privacy}","received_events_url":"https://api.github.com/users/root18039532923/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T01:47:09Z","updated_at":"2021-04-02T01:47:09Z","author_association":"NONE","body":"how to operate this? @nsivabalan ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812271600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812271790","html_url":"https://github.com/apache/hudi/pull/2751#issuecomment-812271790","issue_url":"https://api.github.com/repos/apache/hudi/issues/2751","id":812271790,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjI3MTc5MA==","user":{"login":"li36909","id":3632162,"node_id":"MDQ6VXNlcjM2MzIxNjI=","avatar_url":"https://avatars.githubusercontent.com/u/3632162?v=4","gravatar_id":"","url":"https://api.github.com/users/li36909","html_url":"https://github.com/li36909","followers_url":"https://api.github.com/users/li36909/followers","following_url":"https://api.github.com/users/li36909/following{/other_user}","gists_url":"https://api.github.com/users/li36909/gists{/gist_id}","starred_url":"https://api.github.com/users/li36909/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/li36909/subscriptions","organizations_url":"https://api.github.com/users/li36909/orgs","repos_url":"https://api.github.com/users/li36909/repos","events_url":"https://api.github.com/users/li36909/events{/privacy}","received_events_url":"https://api.github.com/users/li36909/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T01:48:00Z","updated_at":"2021-04-02T01:48:00Z","author_association":"CONTRIBUTOR","body":"@nsivabalan I run the test at hudi 0.7. yes, you are right, I start a spark-shell for upserting, and query the same table by spark datasouce api, then the problem arises. The cause of the problem is clear, during the query, hudi get partitions at MergeOnReadSnapshotRelation, and build a new fsview at HoodieRealtimeInputFormatUtils.groupLogsByBaseFile, when a write operation is happening,  HoodieRealtimeInputFormatUtils.groupLogsByBaseFile will find some new base files.\r\nwe can reproduce this issue by add a Thread.sleep(60000) at HoodieRealtimeInputFormatUtils.groupLogsByBaseFile, then run this test:\r\nstep 1: write first batch into a hudi table:\r\nspark-shell\r\n\r\nimport org.apache.hudi.QuickstartUtils.\r\nimport scala.collection.JavaConversions.\r\nimport org.apache.spark.sql.SaveMode.\r\nimport org.apache.hudi.DataSourceReadOptions.\r\nimport org.apache.hudi.DataSourceWriteOptions.\r\nimport org.apache.hudi.config.HoodieWriteConfig.\r\n\r\n\r\nval tableName = \"hudi_mor_table\"\r\nval basePath = \"hdfs://hacluster/tmp/hudi_mor_table\"\r\nval dataGen = new DataGenerator\r\nval inserts = convertToStringList(dataGen.generateInserts(10))\r\nval df = spark.read.json(spark.sparkContext.parallelize(inserts, 2))\r\ndf.write.format(\"org.apache.hudi\").\r\noption(\"hoodie.datasource.write.table.type\", \"MERGE_ON_READ\").\r\noption(\"hoodie.datasource.write.operation\", \"bulk_insert\").\r\noptions(getQuickstartWriteConfigs).\r\noption(PRECOMBINE_FIELD_OPT_KEY, \"ts\").\r\noption(RECORDKEY_FIELD_OPT_KEY, \"uuid\").\r\noption(PARTITIONPATH_FIELD_OPT_KEY, \"partitionpath\").\r\noption(\"hoodie.datasource.write.hive_style_partitioning\", \"false\").\r\noption(TABLE_NAME, tableName).\r\noption(\"hoodie.datasource.hive_sync.enable\", \"true\").\r\noption(\"hoodie.datasource.hive_sync.use_jdbc\", \"false\").\r\noption(\"hoodie.datasource.hive_sync.table\", \"hudi_mor_test\").\r\noption(\"hoodie.datasource.hive_sync.partition_extractor_class\", \"org.apache.hudi.hive.MultiPartKeysValueExtractor\").\r\noption(\"hoodie.datasource.hive_sync.partition_fields\", \"continent,country,city\").\r\noption(\"hoodie.datasource.hive_sync.assume_date_partitioning\", \"false\").\r\noption(\"hoodie.insert.shuffle.parallelism\", \"2\").\r\noption(\"hoodie.upsert.shuffle.parallelism\",\"2\").\r\noption(\"hoodie.bulkinsert.shuffle.parallelism\", \"2\").\r\noption(\"hoodie.delete.shuffle.parallelism\",\"2\").\r\nmode(Append).\r\nsave(basePath);\r\n\r\nstep 2: run a query at new spark-shell (when the query hang at Thread.sleep, start to write a new batch at step3)\r\nspark.read.format(\"hudi\").load(\"hdfs://hacluster/tmp/hudi_mor_table/*/*/*/*\").count\r\n\r\nsetp 3:  go to the spark-shell at step1, write a new batch:\r\ndf.write.format(\"org.apache.hudi\").\r\noption(\"hoodie.datasource.write.table.type\", \"MERGE_ON_READ\").\r\noption(\"hoodie.datasource.write.operation\", \"bulk_insert\").\r\noptions(getQuickstartWriteConfigs).\r\noption(PRECOMBINE_FIELD_OPT_KEY, \"ts\").\r\noption(RECORDKEY_FIELD_OPT_KEY, \"uuid\").\r\noption(PARTITIONPATH_FIELD_OPT_KEY, \"partitionpath\").\r\noption(\"hoodie.datasource.write.hive_style_partitioning\", \"false\").\r\noption(TABLE_NAME, tableName).\r\noption(\"hoodie.datasource.hive_sync.enable\", \"true\").\r\noption(\"hoodie.datasource.hive_sync.use_jdbc\", \"false\").\r\noption(\"hoodie.datasource.hive_sync.table\", \"hudi_mor_test\").\r\noption(\"hoodie.datasource.hive_sync.partition_extractor_class\", \"org.apache.hudi.hive.MultiPartKeysValueExtractor\").\r\noption(\"hoodie.datasource.hive_sync.partition_fields\", \"continent,country,city\").\r\noption(\"hoodie.datasource.hive_sync.assume_date_partitioning\", \"false\").\r\noption(\"hoodie.insert.shuffle.parallelism\", \"2\").\r\noption(\"hoodie.upsert.shuffle.parallelism\",\"2\").\r\noption(\"hoodie.bulkinsert.shuffle.parallelism\", \"2\").\r\noption(\"hoodie.delete.shuffle.parallelism\",\"2\").\r\nmode(Append).\r\nsave(basePath);\r\n\r\nwe can see the step2 will throw a exception","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812271790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812274605","html_url":"https://github.com/apache/hudi/pull/2753#issuecomment-812274605","issue_url":"https://api.github.com/repos/apache/hudi/issues/2753","id":812274605,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjI3NDYwNQ==","user":{"login":"li36909","id":3632162,"node_id":"MDQ6VXNlcjM2MzIxNjI=","avatar_url":"https://avatars.githubusercontent.com/u/3632162?v=4","gravatar_id":"","url":"https://api.github.com/users/li36909","html_url":"https://github.com/li36909","followers_url":"https://api.github.com/users/li36909/followers","following_url":"https://api.github.com/users/li36909/following{/other_user}","gists_url":"https://api.github.com/users/li36909/gists{/gist_id}","starred_url":"https://api.github.com/users/li36909/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/li36909/subscriptions","organizations_url":"https://api.github.com/users/li36909/orgs","repos_url":"https://api.github.com/users/li36909/repos","events_url":"https://api.github.com/users/li36909/events{/privacy}","received_events_url":"https://api.github.com/users/li36909/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T01:59:56Z","updated_at":"2021-04-02T01:59:56Z","author_association":"CONTRIBUTOR","body":"cc @nsivabalan could you help to take a look, thank you.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812274605/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812290646","html_url":"https://github.com/apache/hudi/pull/2666#issuecomment-812290646","issue_url":"https://api.github.com/repos/apache/hudi/issues/2666","id":812290646,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjI5MDY0Ng==","user":{"login":"liujinhui1994","id":25769285,"node_id":"MDQ6VXNlcjI1NzY5Mjg1","avatar_url":"https://avatars.githubusercontent.com/u/25769285?v=4","gravatar_id":"","url":"https://api.github.com/users/liujinhui1994","html_url":"https://github.com/liujinhui1994","followers_url":"https://api.github.com/users/liujinhui1994/followers","following_url":"https://api.github.com/users/liujinhui1994/following{/other_user}","gists_url":"https://api.github.com/users/liujinhui1994/gists{/gist_id}","starred_url":"https://api.github.com/users/liujinhui1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liujinhui1994/subscriptions","organizations_url":"https://api.github.com/users/liujinhui1994/orgs","repos_url":"https://api.github.com/users/liujinhui1994/repos","events_url":"https://api.github.com/users/liujinhui1994/events{/privacy}","received_events_url":"https://api.github.com/users/liujinhui1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T03:01:13Z","updated_at":"2021-04-02T03:11:11Z","author_association":"CONTRIBUTOR","body":"Your suggestion is very good, please let me think about it, and then reply to you\r\n@nsivabalan ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812290646/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812296838","html_url":"https://github.com/apache/hudi/pull/2745#issuecomment-812296838","issue_url":"https://api.github.com/repos/apache/hudi/issues/2745","id":812296838,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjI5NjgzOA==","user":{"login":"RocMarshal","id":64569824,"node_id":"MDQ6VXNlcjY0NTY5ODI0","avatar_url":"https://avatars.githubusercontent.com/u/64569824?v=4","gravatar_id":"","url":"https://api.github.com/users/RocMarshal","html_url":"https://github.com/RocMarshal","followers_url":"https://api.github.com/users/RocMarshal/followers","following_url":"https://api.github.com/users/RocMarshal/following{/other_user}","gists_url":"https://api.github.com/users/RocMarshal/gists{/gist_id}","starred_url":"https://api.github.com/users/RocMarshal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RocMarshal/subscriptions","organizations_url":"https://api.github.com/users/RocMarshal/orgs","repos_url":"https://api.github.com/users/RocMarshal/repos","events_url":"https://api.github.com/users/RocMarshal/events{/privacy}","received_events_url":"https://api.github.com/users/RocMarshal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T03:26:30Z","updated_at":"2021-04-02T03:26:30Z","author_association":"CONTRIBUTOR","body":"@danny0405 Thank you so much.\r\nNow, ping @yanghua ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812296838/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812325694","html_url":"https://github.com/apache/hudi/pull/2758#issuecomment-812325694","issue_url":"https://api.github.com/repos/apache/hudi/issues/2758","id":812325694,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjMyNTY5NA==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T05:24:15Z","updated_at":"2021-04-02T05:25:11Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2758?src=pr&el=h1) Report\n> Merging [#2758](https://codecov.io/gh/apache/hudi/pull/2758?src=pr&el=desc) (ea0d401) into [master](https://codecov.io/gh/apache/hudi/commit/fe16d0de7c76105775c887b700751241bc82624c?el=desc) (fe16d0d) will **increase** coverage by `0.25%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2758/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2758?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2758      +/-   ##\n============================================\n+ Coverage     52.04%   52.30%   +0.25%     \n- Complexity     3625     3688      +63     \n============================================\n  Files           479      483       +4     \n  Lines         22804    23095     +291     \n  Branches       2415     2460      +45     \n============================================\n+ Hits          11868    12079     +211     \n- Misses         9911     9946      +35     \n- Partials       1025     1070      +45     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `37.01% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiclient | `∅ <ø> (∅)` | `0.00 <ø> (ø)` | |\n| hudicommon | `50.78% <ø> (-0.14%)` | `0.00 <ø> (ø)` | |\n| hudiflink | `56.71% <ø> (+0.69%)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.44% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisparkdatasource | `71.33% <ø> (+0.45%)` | `0.00 <ø> (ø)` | |\n| hudisync | `45.47% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `64.36% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.69% <ø> (-0.09%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2758?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...ache/hudi/sink/compact/CompactionPlanOperator.java](https://codecov.io/gh/apache/hudi/pull/2758/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL2NvbXBhY3QvQ29tcGFjdGlvblBsYW5PcGVyYXRvci5qYXZh) | `58.00% <0.00%> (-21.07%)` | `8.00% <0.00%> (-1.00%)` | |\n| [.../main/scala/org/apache/hudi/HoodieSparkUtils.scala](https://codecov.io/gh/apache/hudi/pull/2758/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL0hvb2RpZVNwYXJrVXRpbHMuc2NhbGE=) | `83.33% <0.00%> (-5.56%)` | `0.00% <0.00%> (ø%)` | |\n| [...src/main/scala/org/apache/hudi/DefaultSource.scala](https://codecov.io/gh/apache/hudi/pull/2758/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL0RlZmF1bHRTb3VyY2Uuc2NhbGE=) | `78.78% <0.00%> (-5.36%)` | `31.00% <0.00%> (+14.00%)` | :arrow_down: |\n| [...main/scala/org/apache/hudi/HoodieWriterUtils.scala](https://codecov.io/gh/apache/hudi/pull/2758/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL0hvb2RpZVdyaXRlclV0aWxzLnNjYWxh) | `83.33% <0.00%> (-5.24%)` | `0.00% <0.00%> (ø%)` | |\n| [...di/common/table/timeline/HoodieActiveTimeline.java](https://codecov.io/gh/apache/hudi/pull/2758/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL3RpbWVsaW5lL0hvb2RpZUFjdGl2ZVRpbWVsaW5lLmphdmE=) | `66.81% <0.00%> (-3.97%)` | `43.00% <0.00%> (ø%)` | |\n| [...apache/hudi/sink/compact/CompactionCommitSink.java](https://codecov.io/gh/apache/hudi/pull/2758/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL2NvbXBhY3QvQ29tcGFjdGlvbkNvbW1pdFNpbmsuamF2YQ==) | `66.66% <0.00%> (-3.55%)` | `10.00% <0.00%> (-1.00%)` | |\n| [...rg/apache/hudi/common/table/HoodieTableConfig.java](https://codecov.io/gh/apache/hudi/pull/2758/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL0hvb2RpZVRhYmxlQ29uZmlnLmphdmE=) | `43.20% <0.00%> (-2.25%)` | `17.00% <0.00%> (ø%)` | |\n| [...pache/hudi/common/table/HoodieTableMetaClient.java](https://codecov.io/gh/apache/hudi/pull/2758/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL0hvb2RpZVRhYmxlTWV0YUNsaWVudC5qYXZh) | `66.66% <0.00%> (-1.65%)` | `43.00% <0.00%> (ø%)` | |\n| [...c/main/java/org/apache/hudi/common/fs/FSUtils.java](https://codecov.io/gh/apache/hudi/pull/2758/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2ZzL0ZTVXRpbHMuamF2YQ==) | `47.34% <0.00%> (-0.94%)` | `57.00% <0.00%> (ø%)` | |\n| [...apache/hudi/utilities/deltastreamer/DeltaSync.java](https://codecov.io/gh/apache/hudi/pull/2758/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvRGVsdGFTeW5jLmphdmE=) | `71.08% <0.00%> (-0.64%)` | `55.00% <0.00%> (-1.00%)` | |\n| ... and [17 more](https://codecov.io/gh/apache/hudi/pull/2758/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812325694/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812329664","html_url":"https://github.com/apache/hudi/pull/2751#issuecomment-812329664","issue_url":"https://api.github.com/repos/apache/hudi/issues/2751","id":812329664,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjMyOTY2NA==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T05:36:22Z","updated_at":"2021-04-02T05:36:22Z","author_association":"CONTRIBUTOR","body":"@li36909 If I understand this correctly, you are saying reading a MOR table `_rt` view can fail if a concurrent write is happening ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812329664/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812334675","html_url":"https://github.com/apache/hudi/issues/2623#issuecomment-812334675","issue_url":"https://api.github.com/repos/apache/hudi/issues/2623","id":812334675,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjMzNDY3NQ==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T05:52:02Z","updated_at":"2021-04-02T05:52:02Z","author_association":"CONTRIBUTOR","body":"@root18039532923 Not sure if you're asking how to package this but leaving a comment here if that's what you are referring to.\r\n\r\n1. Do a git checkout of the 0.7.0 tag. `git checkout tags/version 0.7.0`\r\n2. Patch the change in the https://github.com/apache/hudi/commit/657e73f9b157a1ed4d6e6e515ae8f63156061b88 to your checked out tag.\r\n3. Re-build the packages using command `mvn clean package -DskipTests` \r\n\r\nNow use these new packages and test out your deployment.   ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812334675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812335639","html_url":"https://github.com/apache/hudi/issues/2637#issuecomment-812335639","issue_url":"https://api.github.com/repos/apache/hudi/issues/2637","id":812335639,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjMzNTYzOQ==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T05:54:56Z","updated_at":"2021-04-02T05:54:56Z","author_association":"CONTRIBUTOR","body":"@Sugamber If your issue is addressed, please close this issue. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812335639/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812339166","html_url":"https://github.com/apache/hudi/issues/2696#issuecomment-812339166","issue_url":"https://api.github.com/repos/apache/hudi/issues/2696","id":812339166,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjMzOTE2Ng==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T06:05:07Z","updated_at":"2021-04-02T06:05:07Z","author_association":"CONTRIBUTOR","body":"@kimberlyamandalu Yes, you should be able to switch off your metadata table without any side-effect. Although, if you want to later turn on the metadata table, you will need to delete data under `basepath/.hoodie/metadata`. Once the metadata folder is empty, you can toggle the metadata back on and things will work fine. \r\nThere is a change to do this automatically in master now but for your case to debug the issue, I would recommend just deleting the metadata folder. \r\n\r\nSure, I can help you with making the changes so you can build it and deploy the custom build. Before turning the metadata table `off`, you should make the following changes, deploy your custom build and get the logs because once you turn the metadata table `off` and then `on` the problem may not be reproducible. \r\n\r\n1. Checkout the 0.7.0 release tag by doing `git checkout tags/version 0.7.0`\r\n2. Add a bunch of logs to the following method -> https://github.com/apache/hudi/blob/release-0.7.0/hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/FileSystemViewHandler.java#L342. We ideally want to know which line of code is throwing the runtime exception and why. So, add logs before and after at any method invocation inside will be helpful. \r\n2. Run the following command : mvn clean package -DskipTests\r\n3. New bundle jars will be available under package/*. Use these new bundle jars to deploy and run to collect logs. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812339166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812341340","html_url":"https://github.com/apache/hudi/pull/2751#issuecomment-812341340","issue_url":"https://api.github.com/repos/apache/hudi/issues/2751","id":812341340,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjM0MTM0MA==","user":{"login":"li36909","id":3632162,"node_id":"MDQ6VXNlcjM2MzIxNjI=","avatar_url":"https://avatars.githubusercontent.com/u/3632162?v=4","gravatar_id":"","url":"https://api.github.com/users/li36909","html_url":"https://github.com/li36909","followers_url":"https://api.github.com/users/li36909/followers","following_url":"https://api.github.com/users/li36909/following{/other_user}","gists_url":"https://api.github.com/users/li36909/gists{/gist_id}","starred_url":"https://api.github.com/users/li36909/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/li36909/subscriptions","organizations_url":"https://api.github.com/users/li36909/orgs","repos_url":"https://api.github.com/users/li36909/repos","events_url":"https://api.github.com/users/li36909/events{/privacy}","received_events_url":"https://api.github.com/users/li36909/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T06:11:07Z","updated_at":"2021-04-02T06:11:07Z","author_association":"CONTRIBUTOR","body":"@n3nash yes","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812341340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812341544","html_url":"https://github.com/apache/hudi/pull/2752#issuecomment-812341544","issue_url":"https://api.github.com/repos/apache/hudi/issues/2752","id":812341544,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjM0MTU0NA==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T06:11:45Z","updated_at":"2021-04-02T06:11:45Z","author_association":"CONTRIBUTOR","body":"@li36909 Have you run into a scenario where these commands hang ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812341544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812357498","html_url":"https://github.com/apache/hudi/pull/2751#issuecomment-812357498","issue_url":"https://api.github.com/repos/apache/hudi/issues/2751","id":812357498,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjM1NzQ5OA==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T06:54:41Z","updated_at":"2021-04-02T06:54:41Z","author_association":"CONTRIBUTOR","body":"Okay, thanks for the confirmation, I will try to reproduce this issue on my end and get back. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812357498/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812402879","html_url":"https://github.com/apache/hudi/pull/2759#issuecomment-812402879","issue_url":"https://api.github.com/repos/apache/hudi/issues/2759","id":812402879,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjQwMjg3OQ==","user":{"login":"li36909","id":3632162,"node_id":"MDQ6VXNlcjM2MzIxNjI=","avatar_url":"https://avatars.githubusercontent.com/u/3632162?v=4","gravatar_id":"","url":"https://api.github.com/users/li36909","html_url":"https://github.com/li36909","followers_url":"https://api.github.com/users/li36909/followers","following_url":"https://api.github.com/users/li36909/following{/other_user}","gists_url":"https://api.github.com/users/li36909/gists{/gist_id}","starred_url":"https://api.github.com/users/li36909/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/li36909/subscriptions","organizations_url":"https://api.github.com/users/li36909/orgs","repos_url":"https://api.github.com/users/li36909/repos","events_url":"https://api.github.com/users/li36909/events{/privacy}","received_events_url":"https://api.github.com/users/li36909/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T08:05:01Z","updated_at":"2021-04-02T08:05:01Z","author_association":"CONTRIBUTOR","body":"The retry issue is cause by: when close metaStoreClient, or sessionState, or hiveDriver, they will all call 'Hive.closeCurrent()', so both sessionState and hiveDriver should be a class member","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812402879/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812403045","html_url":"https://github.com/apache/hudi/pull/2759#issuecomment-812403045","issue_url":"https://api.github.com/repos/apache/hudi/issues/2759","id":812403045,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjQwMzA0NQ==","user":{"login":"li36909","id":3632162,"node_id":"MDQ6VXNlcjM2MzIxNjI=","avatar_url":"https://avatars.githubusercontent.com/u/3632162?v=4","gravatar_id":"","url":"https://api.github.com/users/li36909","html_url":"https://github.com/li36909","followers_url":"https://api.github.com/users/li36909/followers","following_url":"https://api.github.com/users/li36909/following{/other_user}","gists_url":"https://api.github.com/users/li36909/gists{/gist_id}","starred_url":"https://api.github.com/users/li36909/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/li36909/subscriptions","organizations_url":"https://api.github.com/users/li36909/orgs","repos_url":"https://api.github.com/users/li36909/repos","events_url":"https://api.github.com/users/li36909/events{/privacy}","received_events_url":"https://api.github.com/users/li36909/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T08:05:21Z","updated_at":"2021-04-02T08:05:21Z","author_association":"CONTRIBUTOR","body":"cc @nsivabalan could you help to take a look, thank you","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812403045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812460441","html_url":"https://github.com/apache/hudi/pull/2325#issuecomment-812460441","issue_url":"https://api.github.com/repos/apache/hudi/issues/2325","id":812460441,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjQ2MDQ0MQ==","user":{"login":"hddong","id":17537134,"node_id":"MDQ6VXNlcjE3NTM3MTM0","avatar_url":"https://avatars.githubusercontent.com/u/17537134?v=4","gravatar_id":"","url":"https://api.github.com/users/hddong","html_url":"https://github.com/hddong","followers_url":"https://api.github.com/users/hddong/followers","following_url":"https://api.github.com/users/hddong/following{/other_user}","gists_url":"https://api.github.com/users/hddong/gists{/gist_id}","starred_url":"https://api.github.com/users/hddong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hddong/subscriptions","organizations_url":"https://api.github.com/users/hddong/orgs","repos_url":"https://api.github.com/users/hddong/repos","events_url":"https://api.github.com/users/hddong/events{/privacy}","received_events_url":"https://api.github.com/users/hddong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T09:53:58Z","updated_at":"2021-04-02T09:53:58Z","author_association":"CONTRIBUTOR","body":"@yanghua @wangxianghu: had address them.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812460441/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812496550","html_url":"https://github.com/apache/hudi/pull/2334#issuecomment-812496550","issue_url":"https://api.github.com/repos/apache/hudi/issues/2334","id":812496550,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjQ5NjU1MA==","user":{"login":"pengzhiwei2018","id":42458891,"node_id":"MDQ6VXNlcjQyNDU4ODkx","avatar_url":"https://avatars.githubusercontent.com/u/42458891?v=4","gravatar_id":"","url":"https://api.github.com/users/pengzhiwei2018","html_url":"https://github.com/pengzhiwei2018","followers_url":"https://api.github.com/users/pengzhiwei2018/followers","following_url":"https://api.github.com/users/pengzhiwei2018/following{/other_user}","gists_url":"https://api.github.com/users/pengzhiwei2018/gists{/gist_id}","starred_url":"https://api.github.com/users/pengzhiwei2018/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pengzhiwei2018/subscriptions","organizations_url":"https://api.github.com/users/pengzhiwei2018/orgs","repos_url":"https://api.github.com/users/pengzhiwei2018/repos","events_url":"https://api.github.com/users/pengzhiwei2018/events{/privacy}","received_events_url":"https://api.github.com/users/pengzhiwei2018/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T11:48:07Z","updated_at":"2021-04-02T11:48:07Z","author_association":"NONE","body":"> https://gist.github.com/nsivabalan/91f12109e0fe1ca9749ff5290c946778\r\n\r\nHi @nsivabalan , I have take a review for your test code. First you write a \"int\" to the table, so the table schema type is \"int\". Then you write a \"double\" to the table, so the table schema become to \"double\". The table schema changed from \"int\" to \"double\". I think this is more reasonable.\r\n\r\nIn my original idea, I think the first write schema(e.g. \"int\") is the table schema forever. The incoming records after that should be compatible with the origin table schema(e.g. \"int\"). This is this PR wants to solve. I can understand more clearly now. The table schema should be change to a more generic type (e.g. from \"int\" to \"double\"), but not always be the first write schema.\r\nSo I can close this PR now. Thanks @nsivabalan for correct me.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812496550/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812496806","html_url":"https://github.com/apache/hudi/pull/2752#issuecomment-812496806","issue_url":"https://api.github.com/repos/apache/hudi/issues/2752","id":812496806,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjQ5NjgwNg==","user":{"login":"li36909","id":3632162,"node_id":"MDQ6VXNlcjM2MzIxNjI=","avatar_url":"https://avatars.githubusercontent.com/u/3632162?v=4","gravatar_id":"","url":"https://api.github.com/users/li36909","html_url":"https://github.com/li36909","followers_url":"https://api.github.com/users/li36909/followers","following_url":"https://api.github.com/users/li36909/following{/other_user}","gists_url":"https://api.github.com/users/li36909/gists{/gist_id}","starred_url":"https://api.github.com/users/li36909/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/li36909/subscriptions","organizations_url":"https://api.github.com/users/li36909/orgs","repos_url":"https://api.github.com/users/li36909/repos","events_url":"https://api.github.com/users/li36909/events{/privacy}","received_events_url":"https://api.github.com/users/li36909/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T11:49:02Z","updated_at":"2021-04-02T11:56:19Z","author_association":"CONTRIBUTOR","body":"just run any rollback/compaction command, and make it fail by injection fault, then the command will hang.\r\nFor example, currently hudi only support rollback to the latest commit, we can make a rollback fail by rollback to a older commit, and observation the hang problem. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812496806/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812496813","html_url":"https://github.com/apache/hudi/issues/2756#issuecomment-812496813","issue_url":"https://api.github.com/repos/apache/hudi/issues/2756","id":812496813,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjQ5NjgxMw==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T11:49:03Z","updated_at":"2021-04-02T11:49:03Z","author_association":"CONTRIBUTOR","body":"yes, this is expected. if you are using OverwriteWithLatestAvroPayload as your payload class, combineAndGetUpdateValue does not honor ordering value. And so we added another payload for this purpose. DefaultHoodieRecordPayload. While using this, ensure you set \"hoodie.payload.ordering.field\" accordingly. Let me know how it goes. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812496813/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812497980","html_url":"https://github.com/apache/hudi/issues/2728#issuecomment-812497980","issue_url":"https://api.github.com/repos/apache/hudi/issues/2728","id":812497980,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjQ5Nzk4MA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T11:52:54Z","updated_at":"2021-04-02T11:52:54Z","author_association":"CONTRIBUTOR","body":"thanks for letting us know. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812497980/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812516130","html_url":"https://github.com/apache/hudi/pull/2334#issuecomment-812516130","issue_url":"https://api.github.com/repos/apache/hudi/issues/2334","id":812516130,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjUxNjEzMA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T12:50:54Z","updated_at":"2021-04-02T12:50:54Z","author_association":"CONTRIBUTOR","body":"Yeah, I did verify by enabling schema compatability check. it will fail if we try to evolve a field from double to int.\r\n\r\n```\r\nscala> dfFromData5.write.format(\"hudi\").\r\n     |   options(getQuickstartWriteConfigs).\r\n     |   option(PRECOMBINE_FIELD_OPT_KEY, \"preComb\").\r\n     |   option(RECORDKEY_FIELD_OPT_KEY, \"rowId\").\r\n     |   option(PARTITIONPATH_FIELD_OPT_KEY, \"partitionId\").\r\n     |   option(\"hoodie.index.type\",\"SIMPLE\").\r\n     |   option(TABLE_NAME, tableName).\r\n     |   option(\"hoodie.avro.schema.validate\",\"true\").\r\n     |     mode(Append).\r\n     |   save(basePath)\r\norg.apache.hudi.exception.HoodieUpsertException: Failed upsert schema compatibility check.\r\n  at org.apache.hudi.table.HoodieTable.validateUpsertSchema(HoodieTable.java:629)\r\n  at org.apache.hudi.client.SparkRDDWriteClient.upsert(SparkRDDWriteClient.java:152)\r\n  at org.apache.hudi.DataSourceUtils.doWriteOperation(DataSourceUtils.java:214)\r\n  at org.apache.hudi.HoodieSparkSqlWriter$.write(HoodieSparkSqlWriter.scala:186)\r\n  at org.apache.hudi.DefaultSource.createRelation(DefaultSource.scala:145)\r\n  at org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:45)\r\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\r\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\r\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:86)\r\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:131)\r\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:127)\r\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:155)\r\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\r\n  at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)\r\n  at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)\r\n  at org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:83)\r\n  at org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:81)\r\n  at org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:677)\r\n  at org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:677)\r\n  at org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1.apply(SQLExecution.scala:80)\r\n  at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:127)\r\n  at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:75)\r\n  at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:677)\r\n  at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:286)\r\n  at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:272)\r\n  at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:230)\r\n  ... 72 elided\r\nCaused by: org.apache.hudi.exception.HoodieException: Failed schema compatibility check for writerSchema :{\"type\":\"record\",\"name\":\"hudi_trips_cow_record\",\"namespace\":\"hoodie.hudi_trips_cow\",\"fields\":[{\"name\":\"_hoodie_commit_time\",\"type\":[\"null\",\"string\"],\"doc\":\"\",\"default\":null},{\"name\":\"_hoodie_commit_seqno\",\"type\":[\"null\",\"string\"],\"doc\":\"\",\"default\":null},{\"name\":\"_hoodie_record_key\",\"type\":[\"null\",\"string\"],\"doc\":\"\",\"default\":null},{\"name\":\"_hoodie_partition_path\",\"type\":[\"null\",\"string\"],\"doc\":\"\",\"default\":null},{\"name\":\"_hoodie_file_name\",\"type\":[\"null\",\"string\"],\"doc\":\"\",\"default\":null},{\"name\":\"rowId\",\"type\":[\"string\",\"null\"]},{\"name\":\"partitionId\",\"type\":[\"string\",\"null\"]},{\"name\":\"preComb\",\"type\":[\"long\",\"null\"]},{\"name\":\"name\",\"type\":[\"string\",\"null\"]},{\"name\":\"versionId\",\"type\":[\"string\",\"null\"]},{\"name\":\"doubleToInt\",\"type\":[\"int\",\"null\"]}]}, table schema :{\"type\":\"record\",\"name\":\"hudi_trips_cow_record\",\"namespace\":\"hoodie.hudi_trips_cow\",\"fields\":[{\"name\":\"_hoodie_commit_time\",\"type\":[\"null\",\"string\"],\"doc\":\"\",\"default\":null},{\"name\":\"_hoodie_commit_seqno\",\"type\":[\"null\",\"string\"],\"doc\":\"\",\"default\":null},{\"name\":\"_hoodie_record_key\",\"type\":[\"null\",\"string\"],\"doc\":\"\",\"default\":null},{\"name\":\"_hoodie_partition_path\",\"type\":[\"null\",\"string\"],\"doc\":\"\",\"default\":null},{\"name\":\"_hoodie_file_name\",\"type\":[\"null\",\"string\"],\"doc\":\"\",\"default\":null},{\"name\":\"rowId\",\"type\":[\"string\",\"null\"]},{\"name\":\"partitionId\",\"type\":[\"string\",\"null\"]},{\"name\":\"preComb\",\"type\":[\"long\",\"null\"]},{\"name\":\"name\",\"type\":[\"string\",\"null\"]},{\"name\":\"versionId\",\"type\":[\"string\",\"null\"]},{\"name\":\"doubleToInt\",\"type\":[\"double\",\"null\"]}]}, base path :file:/tmp/hudi_trips_cow\r\n  at org.apache.hudi.table.HoodieTable.validateSchema(HoodieTable.java:621)\r\n  at org.apache.hudi.table.HoodieTable.validateUpsertSchema(HoodieTable.java:627)\r\n  ... 97 more\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812516130/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812516535","html_url":"https://github.com/apache/hudi/issues/2756#issuecomment-812516535","issue_url":"https://api.github.com/repos/apache/hudi/issues/2756","id":812516535,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjUxNjUzNQ==","user":{"login":"aditiwari01","id":16352977,"node_id":"MDQ6VXNlcjE2MzUyOTc3","avatar_url":"https://avatars.githubusercontent.com/u/16352977?v=4","gravatar_id":"","url":"https://api.github.com/users/aditiwari01","html_url":"https://github.com/aditiwari01","followers_url":"https://api.github.com/users/aditiwari01/followers","following_url":"https://api.github.com/users/aditiwari01/following{/other_user}","gists_url":"https://api.github.com/users/aditiwari01/gists{/gist_id}","starred_url":"https://api.github.com/users/aditiwari01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aditiwari01/subscriptions","organizations_url":"https://api.github.com/users/aditiwari01/orgs","repos_url":"https://api.github.com/users/aditiwari01/repos","events_url":"https://api.github.com/users/aditiwari01/events{/privacy}","received_events_url":"https://api.github.com/users/aditiwari01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T12:52:10Z","updated_at":"2021-04-02T12:52:28Z","author_association":"CONTRIBUTOR","body":"I think I couldn't explain myself. I am using DefaultHoodieRecordPayload only. I have attached sample command regardinng same.\r\n\r\nThe issue is not with \"combineAndGetUpdateValue\", rather with \"preCombine\".\r\n As per my uderstanding, combineAndGetUpdateValue is used to merge record from parquet and in memory record, whereas preCombine is used to dedupe multiple records in memory with same key. The preCombine function uses orderingVal field to sort and while creating record from log file we do not set this ordering field. And hence the issue. \r\n\r\nThe constructors are as foolows:\r\n\r\n1. DefaultHoodieRecordPayload(Option<GenericRecord> record) {this(recordl, 0);}\r\n2. DefaultHoodieRecordPayload(GenericRecord record, Comparable orderingVal) {super(record, orderingVal)}\r\n\r\nIn the read path we only call the 1st constructor and hence lose the ordering value.\r\n\r\nAlso, if we compact after each commit we dont see this issue since \"combineAndGetUpdateValue\" works absolutely fine.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812516535/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812703790","html_url":"https://github.com/apache/hudi/issues/2756#issuecomment-812703790","issue_url":"https://api.github.com/repos/apache/hudi/issues/2756","id":812703790,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjcwMzc5MA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T20:42:59Z","updated_at":"2021-04-02T20:42:59Z","author_association":"CONTRIBUTOR","body":"CC @n3nash ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812703790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812710497","html_url":"https://github.com/apache/hudi/issues/2675#issuecomment-812710497","issue_url":"https://api.github.com/repos/apache/hudi/issues/2675","id":812710497,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjcxMDQ5Nw==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T20:51:07Z","updated_at":"2021-04-02T20:51:07Z","author_association":"CONTRIBUTOR","body":"Closing this as we have a tracking jira. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812710497/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812712095","html_url":"https://github.com/apache/hudi/issues/2586#issuecomment-812712095","issue_url":"https://api.github.com/repos/apache/hudi/issues/2586","id":812712095,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjcxMjA5NQ==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T20:55:49Z","updated_at":"2021-04-02T20:55:49Z","author_association":"CONTRIBUTOR","body":"Closing this for now. please feel free to reopen or open a new ticket. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812712095/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812713158","html_url":"https://github.com/apache/hudi/issues/2284#issuecomment-812713158","issue_url":"https://api.github.com/repos/apache/hudi/issues/2284","id":812713158,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjcxMzE1OA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T20:58:53Z","updated_at":"2021-04-02T20:58:53Z","author_association":"CONTRIBUTOR","body":"CC @n3nash ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812713158/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812713376","html_url":"https://github.com/apache/hudi/issues/2338#issuecomment-812713376","issue_url":"https://api.github.com/repos/apache/hudi/issues/2338","id":812713376,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjcxMzM3Ng==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-02T20:59:34Z","updated_at":"2021-04-02T20:59:34Z","author_association":"CONTRIBUTOR","body":"Closing due to inactivity. but feel free to reopen to create a new ticket. would be happy to assist you.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812713376/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812815163","html_url":"https://github.com/apache/hudi/pull/2761#issuecomment-812815163","issue_url":"https://api.github.com/repos/apache/hudi/issues/2761","id":812815163,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjgxNTE2Mw==","user":{"login":"xiarixiaoyao","id":13514703,"node_id":"MDQ6VXNlcjEzNTE0NzAz","avatar_url":"https://avatars.githubusercontent.com/u/13514703?v=4","gravatar_id":"","url":"https://api.github.com/users/xiarixiaoyao","html_url":"https://github.com/xiarixiaoyao","followers_url":"https://api.github.com/users/xiarixiaoyao/followers","following_url":"https://api.github.com/users/xiarixiaoyao/following{/other_user}","gists_url":"https://api.github.com/users/xiarixiaoyao/gists{/gist_id}","starred_url":"https://api.github.com/users/xiarixiaoyao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiarixiaoyao/subscriptions","organizations_url":"https://api.github.com/users/xiarixiaoyao/orgs","repos_url":"https://api.github.com/users/xiarixiaoyao/repos","events_url":"https://api.github.com/users/xiarixiaoyao/events{/privacy}","received_events_url":"https://api.github.com/users/xiarixiaoyao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-03T05:31:04Z","updated_at":"2021-04-03T05:31:04Z","author_association":"CONTRIBUTOR","body":"@vinothchandar , could you help me to review this pr,  thanks","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812815163/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812815750","html_url":"https://github.com/apache/hudi/pull/2761#issuecomment-812815750","issue_url":"https://api.github.com/repos/apache/hudi/issues/2761","id":812815750,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjgxNTc1MA==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-03T05:37:02Z","updated_at":"2021-04-08T13:23:47Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2761?src=pr&el=h1) Report\n> Merging [#2761](https://codecov.io/gh/apache/hudi/pull/2761?src=pr&el=desc) (e862a1a) into [master](https://codecov.io/gh/apache/hudi/commit/e970e1f48302aec3af7eeca009a2c793757cd501?el=desc) (e970e1f) will **decrease** coverage by `2.45%`.\n> The diff coverage is `0.00%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2761/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2761?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2761      +/-   ##\n============================================\n- Coverage     52.32%   49.86%   -2.46%     \n- Complexity     3689     3702      +13     \n============================================\n  Files           483      500      +17     \n  Lines         23095    24364    +1269     \n  Branches       2460     2757     +297     \n============================================\n+ Hits          12084    12150      +66     \n- Misses         9942    11142    +1200     \n- Partials       1069     1072       +3     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `40.29% <ø> (+3.28%)` | `0.00 <ø> (ø)` | |\n| hudiclient | `∅ <ø> (∅)` | `0.00 <ø> (ø)` | |\n| hudicommon | `50.69% <ø> (-0.15%)` | `0.00 <ø> (ø)` | |\n| hudiflink | `56.36% <ø> (-0.36%)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.44% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisparkdatasource | `42.31% <0.00%> (-29.03%)` | `0.00 <0.00> (ø)` | |\n| hudisync | `45.47% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `64.36% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.72% <ø> (+0.03%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2761?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...c/main/scala/org/apache/hudi/HoodieFileIndex.scala](https://codecov.io/gh/apache/hudi/pull/2761/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL0hvb2RpZUZpbGVJbmRleC5zY2FsYQ==) | `78.06% <0.00%> (-1.03%)` | `24.00 <0.00> (ø)` | |\n| [...scala/io/hudi/sql/HudiSpark3SessionExtension.scala](https://codecov.io/gh/apache/hudi/pull/2761/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3BhcmszLWV4dGVuc2lvbnNfMi4xMi9zcmMvbWFpbi9zY2FsYS9pby9odWRpL3NxbC9IdWRpU3BhcmszU2Vzc2lvbkV4dGVuc2lvbi5zY2FsYQ==) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (?)` | |\n| [...scala/org/apache/hudi/execution/HudiSQLUtils.scala](https://codecov.io/gh/apache/hudi/pull/2761/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3BhcmszLWV4dGVuc2lvbnNfMi4xMi9zcmMvbWFpbi9zY2FsYS9vcmcvYXBhY2hlL2h1ZGkvZXhlY3V0aW9uL0h1ZGlTUUxVdGlscy5zY2FsYQ==) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (?)` | |\n| [...che/spark/sql/catalyst/analysis/HudiAnalysis.scala](https://codecov.io/gh/apache/hudi/pull/2761/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3BhcmszLWV4dGVuc2lvbnNfMi4xMi9zcmMvbWFpbi9zY2FsYS9vcmcvYXBhY2hlL3NwYXJrL3NxbC9jYXRhbHlzdC9hbmFseXNpcy9IdWRpQW5hbHlzaXMuc2NhbGE=) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (?)` | |\n| [...rk/sql/catalyst/analysis/HudiOperationsCheck.scala](https://codecov.io/gh/apache/hudi/pull/2761/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3BhcmszLWV4dGVuc2lvbnNfMi4xMi9zcmMvbWFpbi9zY2FsYS9vcmcvYXBhY2hlL3NwYXJrL3NxbC9jYXRhbHlzdC9hbmFseXNpcy9IdWRpT3BlcmF0aW9uc0NoZWNrLnNjYWxh) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (?)` | |\n| [...k/sql/catalyst/analysis/PostprocessHudiTable.scala](https://codecov.io/gh/apache/hudi/pull/2761/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3BhcmszLWV4dGVuc2lvbnNfMi4xMi9zcmMvbWFpbi9zY2FsYS9vcmcvYXBhY2hlL3NwYXJrL3NxbC9jYXRhbHlzdC9hbmFseXNpcy9Qb3N0cHJvY2Vzc0h1ZGlUYWJsZS5zY2FsYQ==) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (?)` | |\n| [...spark/sql/catalyst/analysis/ProcessHudiMerge.scala](https://codecov.io/gh/apache/hudi/pull/2761/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3BhcmszLWV4dGVuc2lvbnNfMi4xMi9zcmMvbWFpbi9zY2FsYS9vcmcvYXBhY2hlL3NwYXJrL3NxbC9jYXRhbHlzdC9hbmFseXNpcy9Qcm9jZXNzSHVkaU1lcmdlLnNjYWxh) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (?)` | |\n| [...rg/apache/spark/sql/catalyst/merge/Interface.scala](https://codecov.io/gh/apache/hudi/pull/2761/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3BhcmszLWV4dGVuc2lvbnNfMi4xMi9zcmMvbWFpbi9zY2FsYS9vcmcvYXBhY2hlL3NwYXJrL3NxbC9jYXRhbHlzdC9tZXJnZS9JbnRlcmZhY2Uuc2NhbGE=) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (?)` | |\n| [...ql/catalyst/optimizer/OptimizerconditionHudi.scala](https://codecov.io/gh/apache/hudi/pull/2761/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3BhcmszLWV4dGVuc2lvbnNfMi4xMi9zcmMvbWFpbi9zY2FsYS9vcmcvYXBhY2hlL3NwYXJrL3NxbC9jYXRhbHlzdC9vcHRpbWl6ZXIvT3B0aW1pemVyY29uZGl0aW9uSHVkaS5zY2FsYQ==) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (?)` | |\n| [.../spark/sql/catalyst/optimizer/RewriteHudiUID.scala](https://codecov.io/gh/apache/hudi/pull/2761/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3BhcmszLWV4dGVuc2lvbnNfMi4xMi9zcmMvbWFpbi9zY2FsYS9vcmcvYXBhY2hlL3NwYXJrL3NxbC9jYXRhbHlzdC9vcHRpbWl6ZXIvUmV3cml0ZUh1ZGlVSUQuc2NhbGE=) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (?)` | |\n| ... and [51 more](https://codecov.io/gh/apache/hudi/pull/2761/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812815750/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812856042","html_url":"https://github.com/apache/hudi/issues/2707#issuecomment-812856042","issue_url":"https://api.github.com/repos/apache/hudi/issues/2707","id":812856042,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjg1NjA0Mg==","user":{"login":"ssdong","id":3754011,"node_id":"MDQ6VXNlcjM3NTQwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/3754011?v=4","gravatar_id":"","url":"https://api.github.com/users/ssdong","html_url":"https://github.com/ssdong","followers_url":"https://api.github.com/users/ssdong/followers","following_url":"https://api.github.com/users/ssdong/following{/other_user}","gists_url":"https://api.github.com/users/ssdong/gists{/gist_id}","starred_url":"https://api.github.com/users/ssdong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ssdong/subscriptions","organizations_url":"https://api.github.com/users/ssdong/orgs","repos_url":"https://api.github.com/users/ssdong/repos","events_url":"https://api.github.com/users/ssdong/events{/privacy}","received_events_url":"https://api.github.com/users/ssdong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-03T12:03:35Z","updated_at":"2021-04-03T12:07:11Z","author_association":"CONTRIBUTOR","body":"@satishkotha Thanks for the tips! In fact, I was also able to reproduce this issue locally on my machine regarding the `insert_overwrite_table` issue that @jsbali has raised tickets https://issues.apache.org/jira/browse/HUDI-1739 and https://issues.apache.org/jira/browse/HUDI-1740 against with.\r\n\r\nFor tracking and maybe helping you guys test the fix(in the future), I am pasting the script I used for reproducing the issue here. 😅 \r\n```\r\nimport org.apache.hudi.QuickstartUtils._\r\nimport scala.collection.JavaConversions._\r\nimport org.apache.spark.sql.SaveMode._\r\nimport org.apache.hudi.DataSourceReadOptions._\r\nimport org.apache.hudi.DataSourceWriteOptions._\r\nimport org.apache.hudi.config.HoodieWriteConfig._\r\nimport java.util.UUID\r\nimport java.sql.Timestamp\r\n\r\nval tableName = \"hudi_date_mor\"\r\nval basePath = \"<absolute_path_to_your_hudi_folder>\" <---- fill out this value to point to your local folder(in absolute path)\r\nval writeConfigs = Map(\r\n     \"hoodie.cleaner.incremental.mode\" -> \"true\",\r\n     \"hoodie.insert.shuffle.parallelism\" -> \"20\",\r\n     \"hoodie.upsert.shuffle.parallelism\" -> \"2\",\r\n     \"hoodie.clean.automatic\" -> \"false\",\r\n     \"hoodie.datasource.write.operation\" -> \"insert_overwrite_table\",\r\n     \"hoodie.table.name\" -> tableName,\r\n     \"hoodie.datasource.write.table.type\" -> \"MERGE_ON_READ\",\r\n     \"hoodie.cleaner.policy\" -> \"KEEP_LATEST_FILE_VERSIONS\",\r\n     \"hoodie.keep.max.commits\" -> \"3\",\r\n     \"hoodie.cleaner.commits.retained\" -> \"1\",\r\n     \"hoodie.keep.min.commits\" -> \"2\",\r\n     \"hoodie.compact.inline.max.delta.commits\" -> \"1\"\r\n     )\r\n\r\nval dateSMap: Map[Int, String] = Map(\r\n    0-> \"2020-07-01\",\r\n    1-> \"2020-08-01\",\r\n    2-> \"2020-09-01\",\r\n)\r\nval dateMap: Map[Int, Timestamp] = Map(\r\n    0-> Timestamp.valueOf(\"2010-07-01 11:00:15\"),\r\n    1-> Timestamp.valueOf(\"2010-08-01 11:00:15\"),\r\n    2-> Timestamp.valueOf(\"2010-09-01 11:00:15\"),\r\n)\r\nvar seq = Seq(\r\n    (0, \"value\", dateMap(0), dateSMap(0), UUID.randomUUID.toString)\r\n)\r\nfor(i <- 501 to 1000) {\r\n    seq :+= (i, \"value\", dateMap(i % 3), dateSMap(i % 3), UUID.randomUUID.toString)\r\n}\r\nval df = seq.toDF(\"id\", \"string_column\", \"timestamp_column\", \"date_string\", \"uuid\")\r\n```\r\n\r\nRun the spark shell(the one taken from hudi quick start page and I am using spark version `spark-3.0.1-bin-hadoop2.7`):\r\n```\r\n./spark-shell --packages org.apache.hudi:hudi-spark-bundle_2.12:0.7.0,org.apache.spark:spark-avro_2.12:3.0.1 --conf 'spark.serializer=org.apache.spark.serializer.KryoSerializer'\r\n```\r\nCopy the above script in there and hit `df.write.format(\"hudi\").options(writeConfigs).mode(Overwrite).save(basePath)` 4 times and on the fifth time, it throws the anticipated\r\n```\r\nCaused by: java.lang.IllegalArgumentException: Positive number of partitions required` issue.\r\n```\r\n\r\nNow, the thing is, we _still_ have to _manually_ delete the first commit file, which contains the empty `partitionToReplaceFileIds`; otherwise, it would still keep throwing the `Positive number of partitions required issue` error.\r\nThe `\"hoodie.embed.timeline.server\" -> \"false\"` _does_ help as it forces the write to refresh its timeline so we wouldn't see the second error again, which is \r\n```\r\njava.io.FileNotFoundException: <path_to_hoodie_folder>/.hoodie/20210403201659.replacecommit does not exist\r\n```\r\nHowever, it appears `\"hoodie.embed.timeline.server\" -> \"false\"` to be not _quite_ necessary since the _6th_ time we write, the writer is automatically being refreshed with the _newest_ timeline and it will put all `*replacecommit` files back to a status of integrity again. \r\n\r\nIf we fix the empty `partitionToReplaceFileIds` issue, we might not need to dig into the `replacecommit does not exist` issue anymore since it is caused by the workaround of _manually_ deleting the empty commit file. It would fix everything from the start. However, I would still be curious to learn about _why_ we would need a `reset` of the timeline server within the `close` action upon the `HoodieTableFileSystemView`. It appears unnecessary to me and could be removed if there is no strong reason behind it. \r\n\r\nThe `reset` within `close` was originally introduced in #600 after a bit of digging in that code. I hope that helps you narrow down the scope a little bit. Maybe @bvaradar could explain it if the memory is still fresh to you since that PR is about 2 years ago from now. 😅 Thanks.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812856042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812891514","html_url":"https://github.com/apache/hudi/issues/2760#issuecomment-812891514","issue_url":"https://api.github.com/repos/apache/hudi/issues/2760","id":812891514,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjg5MTUxNA==","user":{"login":"pratyakshsharma","id":30863489,"node_id":"MDQ6VXNlcjMwODYzNDg5","avatar_url":"https://avatars.githubusercontent.com/u/30863489?v=4","gravatar_id":"","url":"https://api.github.com/users/pratyakshsharma","html_url":"https://github.com/pratyakshsharma","followers_url":"https://api.github.com/users/pratyakshsharma/followers","following_url":"https://api.github.com/users/pratyakshsharma/following{/other_user}","gists_url":"https://api.github.com/users/pratyakshsharma/gists{/gist_id}","starred_url":"https://api.github.com/users/pratyakshsharma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pratyakshsharma/subscriptions","organizations_url":"https://api.github.com/users/pratyakshsharma/orgs","repos_url":"https://api.github.com/users/pratyakshsharma/repos","events_url":"https://api.github.com/users/pratyakshsharma/events{/privacy}","received_events_url":"https://api.github.com/users/pratyakshsharma/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-03T16:44:17Z","updated_at":"2021-04-03T16:44:17Z","author_association":"CONTRIBUTOR","body":"Filed a jira here for the same - https://issues.apache.org/jira/browse/HUDI-1760.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812891514/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812904015","html_url":"https://github.com/apache/hudi/pull/2627#issuecomment-812904015","issue_url":"https://api.github.com/repos/apache/hudi/issues/2627","id":812904015,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjkwNDAxNQ==","user":{"login":"rubenssoto","id":36298331,"node_id":"MDQ6VXNlcjM2Mjk4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/36298331?v=4","gravatar_id":"","url":"https://api.github.com/users/rubenssoto","html_url":"https://github.com/rubenssoto","followers_url":"https://api.github.com/users/rubenssoto/followers","following_url":"https://api.github.com/users/rubenssoto/following{/other_user}","gists_url":"https://api.github.com/users/rubenssoto/gists{/gist_id}","starred_url":"https://api.github.com/users/rubenssoto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rubenssoto/subscriptions","organizations_url":"https://api.github.com/users/rubenssoto/orgs","repos_url":"https://api.github.com/users/rubenssoto/repos","events_url":"https://api.github.com/users/rubenssoto/events{/privacy}","received_events_url":"https://api.github.com/users/rubenssoto/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-03T18:11:35Z","updated_at":"2021-04-03T18:11:35Z","author_association":"NONE","body":"Hello Guys,\r\n\r\nNonPartitionedExtractor of hudi sync will work too?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812904015/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812936183","html_url":"https://github.com/apache/hudi/issues/2508#issuecomment-812936183","issue_url":"https://api.github.com/repos/apache/hudi/issues/2508","id":812936183,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjkzNjE4Mw==","user":{"login":"rubenssoto","id":36298331,"node_id":"MDQ6VXNlcjM2Mjk4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/36298331?v=4","gravatar_id":"","url":"https://api.github.com/users/rubenssoto","html_url":"https://github.com/rubenssoto","followers_url":"https://api.github.com/users/rubenssoto/followers","following_url":"https://api.github.com/users/rubenssoto/following{/other_user}","gists_url":"https://api.github.com/users/rubenssoto/gists{/gist_id}","starred_url":"https://api.github.com/users/rubenssoto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rubenssoto/subscriptions","organizations_url":"https://api.github.com/users/rubenssoto/orgs","repos_url":"https://api.github.com/users/rubenssoto/repos","events_url":"https://api.github.com/users/rubenssoto/events{/privacy}","received_events_url":"https://api.github.com/users/rubenssoto/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-03T22:48:03Z","updated_at":"2021-04-03T22:48:03Z","author_association":"NONE","body":"Hello,\r\n\r\nSorry for my very late response, but I tried again and I have problems with only one table, same table, same error:\r\n\r\n21/04/03 22:09:32 WARN TaskSetManager: Lost task 0.0 in stage 31.0 (TID 1025, ip-10-0-49-182.us-west-2.compute.internal, executor 2): org.apache.hudi.exception.HoodieUpsertException: Error upserting bucketType UPDATE for partition :0\r\n\tat org.apache.hudi.table.action.commit.BaseSparkCommitActionExecutor.handleUpsertPartition(BaseSparkCommitActionExecutor.java:288)\r\n\tat org.apache.hudi.table.action.commit.BaseSparkCommitActionExecutor.lambda$execute$ecf5068c$1(BaseSparkCommitActionExecutor.java:139)\r\n\tat org.apache.spark.api.java.JavaRDDLike.$anonfun$mapPartitionsWithIndex$1(JavaRDDLike.scala:102)\r\n\tat org.apache.spark.api.java.JavaRDDLike.$anonfun$mapPartitionsWithIndex$1$adapted(JavaRDDLike.scala:102)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsWithIndex$2(RDD.scala:889)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsWithIndex$2$adapted(RDD.scala:889)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:349)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:313)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:349)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$getOrCompute$1(RDD.scala:362)\r\n\tat org.apache.spark.storage.BlockManager.$anonfun$doPutIterator$1(BlockManager.scala:1388)\r\n\tat org.apache.spark.storage.BlockManager.org$apache$spark$storage$BlockManager$$doPut(BlockManager.scala:1298)\r\n\tat org.apache.spark.storage.BlockManager.doPutIterator(BlockManager.scala:1362)\r\n\tat org.apache.spark.storage.BlockManager.getOrElseUpdate(BlockManager.scala:1186)\r\n\tat org.apache.spark.rdd.RDD.getOrCompute(RDD.scala:360)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:311)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:349)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:313)\r\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\r\n\tat org.apache.spark.scheduler.Task.run(Task.scala:127)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:446)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1377)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:449)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\nCaused by: org.apache.hudi.exception.HoodieException: org.apache.hudi.exception.HoodieException: java.util.concurrent.ExecutionException: org.apache.hudi.exception.HoodieException: operation has failed\r\n\tat org.apache.hudi.table.action.commit.SparkMergeHelper.runMerge(SparkMergeHelper.java:102)\r\n\tat org.apache.hudi.table.action.commit.BaseSparkCommitActionExecutor.handleUpdateInternal(BaseSparkCommitActionExecutor.java:317)\r\n\tat org.apache.hudi.table.action.commit.BaseSparkCommitActionExecutor.handleUpdate(BaseSparkCommitActionExecutor.java:308)\r\n\tat org.apache.hudi.table.action.commit.BaseSparkCommitActionExecutor.handleUpsertPartition(BaseSparkCommitActionExecutor.java:281)\r\n\t... 28 more\r\nCaused by: org.apache.hudi.exception.HoodieException: java.util.concurrent.ExecutionException: org.apache.hudi.exception.HoodieException: operation has failed\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryExecutor.execute(BoundedInMemoryExecutor.java:143)\r\n\tat org.apache.hudi.table.action.commit.SparkMergeHelper.runMerge(SparkMergeHelper.java:100)\r\n\t... 31 more\r\nCaused by: java.util.concurrent.ExecutionException: org.apache.hudi.exception.HoodieException: operation has failed\r\n\tat java.util.concurrent.FutureTask.report(FutureTask.java:122)\r\n\tat java.util.concurrent.FutureTask.get(FutureTask.java:192)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryExecutor.execute(BoundedInMemoryExecutor.java:141)\r\n\t... 32 more\r\nCaused by: org.apache.hudi.exception.HoodieException: operation has failed\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueue.throwExceptionIfFailed(BoundedInMemoryQueue.java:247)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueue.readNextRecord(BoundedInMemoryQueue.java:226)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueue.access$100(BoundedInMemoryQueue.java:52)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueue$QueueIterator.hasNext(BoundedInMemoryQueue.java:277)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueueConsumer.consume(BoundedInMemoryQueueConsumer.java:36)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryExecutor.lambda$null$2(BoundedInMemoryExecutor.java:121)\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n\t... 3 more\r\nCaused by: org.apache.parquet.io.ParquetDecodingException: Can not read value at 0 in block -1 in file s3://31-ze-datalake-raw/courier_api/order/7acd6348-88ab-46f9-adf9-b09293b2d8bd-0_46-10253-0_20210403213218.parquet\r\n\tat org.apache.parquet.hadoop.InternalParquetRecordReader.nextKeyValue(InternalParquetRecordReader.java:251)\r\n\tat org.apache.parquet.hadoop.ParquetReader.read(ParquetReader.java:132)\r\n\tat org.apache.parquet.hadoop.ParquetReader.read(ParquetReader.java:136)\r\n\tat org.apache.hudi.common.util.ParquetReaderIterator.hasNext(ParquetReaderIterator.java:49)\r\n\tat org.apache.hudi.common.util.queue.IteratorBasedQueueProducer.produce(IteratorBasedQueueProducer.java:45)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryExecutor.lambda$null$0(BoundedInMemoryExecutor.java:92)\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n\t... 4 more\r\nCaused by: java.lang.UnsupportedOperationException: org.apache.parquet.column.values.dictionary.PlainValuesDictionary$PlainLongDictionary\r\n\tat org.apache.parquet.column.Dictionary.decodeToBinary(Dictionary.java:41)\r\n\tat org.apache.parquet.avro.AvroConverters$BinaryConverter.setDictionary(AvroConverters.java:75)\r\n\tat org.apache.parquet.column.impl.ColumnReaderImpl.<init>(ColumnReaderImpl.java:341)\r\n\tat org.apache.parquet.column.impl.ColumnReadStoreImpl.newMemColumnReader(ColumnReadStoreImpl.java:80)\r\n\tat org.apache.parquet.column.impl.ColumnReadStoreImpl.getColumnReader(ColumnReadStoreImpl.java:75)\r\n\tat org.apache.parquet.io.RecordReaderImplementation.<init>(RecordReaderImplementation.java:271)\r\n\tat org.apache.parquet.io.MessageColumnIO$1.visit(MessageColumnIO.java:147)\r\n\tat org.apache.parquet.io.MessageColumnIO$1.visit(MessageColumnIO.java:109)\r\n\tat org.apache.parquet.filter2.compat.FilterCompat$NoOpFilter.accept(FilterCompat.java:165)\r\n\tat org.apache.parquet.io.MessageColumnIO.getRecordReader(MessageColumnIO.java:109)\r\n\tat org.apache.parquet.hadoop.InternalParquetRecordReader.checkRead(InternalParquetRecordReader.java:137)\r\n\tat org.apache.parquet.hadoop.InternalParquetRecordReader.nextKeyValue(InternalParquetRecordReader.java:222)\r\n\t... 11 more\r\n\r\n21/04/03 22:09:32 INFO TaskSetManager: Starting task 0.1 in stage 31.0 (TID 1033, ip-10-0-49-182.us-west-2.compute.internal, executor 2, partition 0, NODE_LOCAL, 7132 bytes)\r\n21/04/03 22:09:32 WARN TaskSetManager: Lost task 4.0 in stage 31.0 (TID 1029, ip-10-0-49-182.us-west-2.compute.internal, executor 2): org.apache.hudi.exception.HoodieUpsertException: Error upserting bucketType UPDATE for partition :4\r\n\tat org.apache.hudi.table.action.commit.BaseSparkCommitActionExecutor.handleUpsertPartition(BaseSparkCommitActionExecutor.java:288)\r\n\tat org.apache.hudi.table.action.commit.BaseSparkCommitActionExecutor.lambda$execute$ecf5068c$1(BaseSparkCommitActionExecutor.java:139)\r\n\tat org.apache.spark.api.java.JavaRDDLike.$anonfun$mapPartitionsWithIndex$1(JavaRDDLike.scala:102)\r\n\tat org.apache.spark.api.java.JavaRDDLike.$anonfun$mapPartitionsWithIndex$1$adapted(JavaRDDLike.scala:102)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsWithIndex$2(RDD.scala:889)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsWithIndex$2$adapted(RDD.scala:889)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:349)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:313)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:349)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$getOrCompute$1(RDD.scala:362)\r\n\tat org.apache.spark.storage.BlockManager.$anonfun$doPutIterator$1(BlockManager.scala:1388)\r\n\tat org.apache.spark.storage.BlockManager.org$apache$spark$storage$BlockManager$$doPut(BlockManager.scala:1298)\r\n\tat org.apache.spark.storage.BlockManager.doPutIterator(BlockManager.scala:1362)\r\n\tat org.apache.spark.storage.BlockManager.getOrElseUpdate(BlockManager.scala:1186)\r\n\tat org.apache.spark.rdd.RDD.getOrCompute(RDD.scala:360)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:311)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:349)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:313)\r\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\r\n\tat org.apache.spark.scheduler.Task.run(Task.scala:127)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:446)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1377)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:449)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\nCaused by: org.apache.hudi.exception.HoodieException: org.apache.hudi.exception.HoodieException: java.util.concurrent.ExecutionException: org.apache.hudi.exception.HoodieException: operation has failed\r\n\tat org.apache.hudi.table.action.commit.SparkMergeHelper.runMerge(SparkMergeHelper.java:102)\r\n\tat org.apache.hudi.table.action.commit.BaseSparkCommitActionExecutor.handleUpdateInternal(BaseSparkCommitActionExecutor.java:317)\r\n\tat org.apache.hudi.table.action.commit.BaseSparkCommitActionExecutor.handleUpdate(BaseSparkCommitActionExecutor.java:308)\r\n\tat org.apache.hudi.table.action.commit.BaseSparkCommitActionExecutor.handleUpsertPartition(BaseSparkCommitActionExecutor.java:281)\r\n\t... 28 more\r\nCaused by: org.apache.hudi.exception.HoodieException: java.util.concurrent.ExecutionException: org.apache.hudi.exception.HoodieException: operation has failed\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryExecutor.execute(BoundedInMemoryExecutor.java:143)\r\n\tat org.apache.hudi.table.action.commit.SparkMergeHelper.runMerge(SparkMergeHelper.java:100)\r\n\t... 31 more\r\nCaused by: java.util.concurrent.ExecutionException: org.apache.hudi.exception.HoodieException: operation has failed\r\n\tat java.util.concurrent.FutureTask.report(FutureTask.java:122)\r\n\tat java.util.concurrent.FutureTask.get(FutureTask.java:192)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryExecutor.execute(BoundedInMemoryExecutor.java:141)\r\n\t... 32 more\r\nCaused by: org.apache.hudi.exception.HoodieException: operation has failed\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueue.throwExceptionIfFailed(BoundedInMemoryQueue.java:247)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueue.readNextRecord(BoundedInMemoryQueue.java:226)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueue.access$100(BoundedInMemoryQueue.java:52)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueue$QueueIterator.hasNext(BoundedInMemoryQueue.java:277)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryQueueConsumer.consume(BoundedInMemoryQueueConsumer.java:36)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryExecutor.lambda$null$2(BoundedInMemoryExecutor.java:121)\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n\t... 3 more\r\nCaused by: org.apache.parquet.io.ParquetDecodingException: Can not read value at 0 in block -1 in file s3://31-ze-datalake-raw/courier_api/order/c2b48006-dfb3-4715-86d5-09692665089d-0_45-10252-0_20210403213218.parquet\r\n\tat org.apache.parquet.hadoop.InternalParquetRecordReader.nextKeyValue(InternalParquetRecordReader.java:251)\r\n\tat org.apache.parquet.hadoop.ParquetReader.read(ParquetReader.java:132)\r\n\tat org.apache.parquet.hadoop.ParquetReader.read(ParquetReader.java:136)\r\n\tat org.apache.hudi.common.util.ParquetReaderIterator.hasNext(ParquetReaderIterator.java:49)\r\n\tat org.apache.hudi.common.util.queue.IteratorBasedQueueProducer.produce(IteratorBasedQueueProducer.java:45)\r\n\tat org.apache.hudi.common.util.queue.BoundedInMemoryExecutor.lambda$null$0(BoundedInMemoryExecutor.java:92)\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n\t... 4 more\r\nCaused by: java.lang.UnsupportedOperationException: org.apache.parquet.column.values.dictionary.PlainValuesDictionary$PlainLongDictionary\r\n\tat org.apache.parquet.column.Dictionary.decodeToBinary(Dictionary.java:41)\r\n\tat org.apache.parquet.avro.AvroConverters$BinaryConverter.setDictionary(AvroConverters.java:75)\r\n\tat org.apache.parquet.column.impl.ColumnReaderImpl.<init>(ColumnReaderImpl.java:341)\r\n\tat org.apache.parquet.column.impl.ColumnReadStoreImpl.newMemColumnReader(ColumnReadStoreImpl.java:80)\r\n\tat org.apache.parquet.column.impl.ColumnReadStoreImpl.getColumnReader(ColumnReadStoreImpl.java:75)\r\n\tat org.apache.parquet.io.RecordReaderImplementation.<init>(RecordReaderImplementation.java:271)\r\n\tat org.apache.parquet.io.MessageColumnIO$1.visit(MessageColumnIO.java:147)\r\n\tat org.apache.parquet.io.MessageColumnIO$1.visit(MessageColumnIO.java:109)\r\n\tat org.apache.parquet.filter2.compat.FilterCompat$NoOpFilter.accept(FilterCompat.java:165)\r\n\tat org.apache.parquet.io.MessageColumnIO.getRecordReader(MessageColumnIO.java:109)\r\n\tat org.apache.parquet.hadoop.InternalParquetRecordReader.checkRead(InternalParquetRecordReader.java:137)\r\n\tat org.apache.parquet.hadoop.InternalParquetRecordReader.nextKeyValue(InternalParquetRecordReader.java:222)\r\n\t... 11 more","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812936183/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812936246","html_url":"https://github.com/apache/hudi/issues/2508#issuecomment-812936246","issue_url":"https://api.github.com/repos/apache/hudi/issues/2508","id":812936246,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjkzNjI0Ng==","user":{"login":"rubenssoto","id":36298331,"node_id":"MDQ6VXNlcjM2Mjk4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/36298331?v=4","gravatar_id":"","url":"https://api.github.com/users/rubenssoto","html_url":"https://github.com/rubenssoto","followers_url":"https://api.github.com/users/rubenssoto/followers","following_url":"https://api.github.com/users/rubenssoto/following{/other_user}","gists_url":"https://api.github.com/users/rubenssoto/gists{/gist_id}","starred_url":"https://api.github.com/users/rubenssoto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rubenssoto/subscriptions","organizations_url":"https://api.github.com/users/rubenssoto/orgs","repos_url":"https://api.github.com/users/rubenssoto/repos","events_url":"https://api.github.com/users/rubenssoto/events{/privacy}","received_events_url":"https://api.github.com/users/rubenssoto/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-03T22:48:42Z","updated_at":"2021-04-03T22:48:42Z","author_association":"NONE","body":"When I dont use row writer enable on bulk insert I have no problems.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812936246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812936268","html_url":"https://github.com/apache/hudi/issues/2508#issuecomment-812936268","issue_url":"https://api.github.com/repos/apache/hudi/issues/2508","id":812936268,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjkzNjI2OA==","user":{"login":"rubenssoto","id":36298331,"node_id":"MDQ6VXNlcjM2Mjk4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/36298331?v=4","gravatar_id":"","url":"https://api.github.com/users/rubenssoto","html_url":"https://github.com/rubenssoto","followers_url":"https://api.github.com/users/rubenssoto/followers","following_url":"https://api.github.com/users/rubenssoto/following{/other_user}","gists_url":"https://api.github.com/users/rubenssoto/gists{/gist_id}","starred_url":"https://api.github.com/users/rubenssoto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rubenssoto/subscriptions","organizations_url":"https://api.github.com/users/rubenssoto/orgs","repos_url":"https://api.github.com/users/rubenssoto/repos","events_url":"https://api.github.com/users/rubenssoto/events{/privacy}","received_events_url":"https://api.github.com/users/rubenssoto/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-03T22:49:04Z","updated_at":"2021-04-03T22:49:04Z","author_association":"NONE","body":"Now Im testing with Hudi 0.8.0-rc1\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812936268/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812964282","html_url":"https://github.com/apache/hudi/issues/2707#issuecomment-812964282","issue_url":"https://api.github.com/repos/apache/hudi/issues/2707","id":812964282,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjk2NDI4Mg==","user":{"login":"ssdong","id":3754011,"node_id":"MDQ6VXNlcjM3NTQwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/3754011?v=4","gravatar_id":"","url":"https://api.github.com/users/ssdong","html_url":"https://github.com/ssdong","followers_url":"https://api.github.com/users/ssdong/followers","following_url":"https://api.github.com/users/ssdong/following{/other_user}","gists_url":"https://api.github.com/users/ssdong/gists{/gist_id}","starred_url":"https://api.github.com/users/ssdong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ssdong/subscriptions","organizations_url":"https://api.github.com/users/ssdong/orgs","repos_url":"https://api.github.com/users/ssdong/repos","events_url":"https://api.github.com/users/ssdong/events{/privacy}","received_events_url":"https://api.github.com/users/ssdong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-04T03:26:02Z","updated_at":"2021-04-04T03:26:02Z","author_association":"CONTRIBUTOR","body":"btw, @jsbali, are you working on both of these tickets? \r\nhttps://issues.apache.org/jira/browse/HUDI-1739\r\nhttps://issues.apache.org/jira/browse/HUDI-1740\r\nCan I pick up one as I would be happy to contribute? 😄 ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812964282/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812969426","html_url":"https://github.com/apache/hudi/pull/2762#issuecomment-812969426","issue_url":"https://api.github.com/repos/apache/hudi/issues/2762","id":812969426,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjk2OTQyNg==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-04T04:27:51Z","updated_at":"2021-04-04T04:27:51Z","author_association":"CONTRIBUTOR","body":"@bvaradar : I see that SchemaConverters.toAvroType(...) is used in 3 places in hudi code base. 2 of those have been fixed as part of this patch. Wondering if we need to fix HoodieSparkBootstrapSchemaProvider as well. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812969426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812973626","html_url":"https://github.com/apache/hudi/issues/2637#issuecomment-812973626","issue_url":"https://api.github.com/repos/apache/hudi/issues/2637","id":812973626,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjk3MzYyNg==","user":{"login":"Sugamber","id":43312063,"node_id":"MDQ6VXNlcjQzMzEyMDYz","avatar_url":"https://avatars.githubusercontent.com/u/43312063?v=4","gravatar_id":"","url":"https://api.github.com/users/Sugamber","html_url":"https://github.com/Sugamber","followers_url":"https://api.github.com/users/Sugamber/followers","following_url":"https://api.github.com/users/Sugamber/following{/other_user}","gists_url":"https://api.github.com/users/Sugamber/gists{/gist_id}","starred_url":"https://api.github.com/users/Sugamber/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Sugamber/subscriptions","organizations_url":"https://api.github.com/users/Sugamber/orgs","repos_url":"https://api.github.com/users/Sugamber/repos","events_url":"https://api.github.com/users/Sugamber/events{/privacy}","received_events_url":"https://api.github.com/users/Sugamber/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-04T05:15:28Z","updated_at":"2021-04-04T05:15:28Z","author_association":"NONE","body":"@n3nash  I'm waiting for below pull request to merge. Please let me know if we can close once pull request merged.\r\nhttps://github.com/apache/hudi/pull/2666","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812973626/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812980356","html_url":"https://github.com/apache/hudi/issues/2707#issuecomment-812980356","issue_url":"https://api.github.com/repos/apache/hudi/issues/2707","id":812980356,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjk4MDM1Ng==","user":{"login":"jsbali","id":1778470,"node_id":"MDQ6VXNlcjE3Nzg0NzA=","avatar_url":"https://avatars.githubusercontent.com/u/1778470?v=4","gravatar_id":"","url":"https://api.github.com/users/jsbali","html_url":"https://github.com/jsbali","followers_url":"https://api.github.com/users/jsbali/followers","following_url":"https://api.github.com/users/jsbali/following{/other_user}","gists_url":"https://api.github.com/users/jsbali/gists{/gist_id}","starred_url":"https://api.github.com/users/jsbali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jsbali/subscriptions","organizations_url":"https://api.github.com/users/jsbali/orgs","repos_url":"https://api.github.com/users/jsbali/repos","events_url":"https://api.github.com/users/jsbali/events{/privacy}","received_events_url":"https://api.github.com/users/jsbali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-04T06:11:48Z","updated_at":"2021-04-04T06:22:21Z","author_association":"CONTRIBUTOR","body":"Sure @ssdong. You can pick either of the above","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812980356/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812985549","html_url":"https://github.com/apache/hudi/pull/2762#issuecomment-812985549","issue_url":"https://api.github.com/repos/apache/hudi/issues/2762","id":812985549,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjk4NTU0OQ==","user":{"login":"aditiwari01","id":16352977,"node_id":"MDQ6VXNlcjE2MzUyOTc3","avatar_url":"https://avatars.githubusercontent.com/u/16352977?v=4","gravatar_id":"","url":"https://api.github.com/users/aditiwari01","html_url":"https://github.com/aditiwari01","followers_url":"https://api.github.com/users/aditiwari01/followers","following_url":"https://api.github.com/users/aditiwari01/following{/other_user}","gists_url":"https://api.github.com/users/aditiwari01/gists{/gist_id}","starred_url":"https://api.github.com/users/aditiwari01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aditiwari01/subscriptions","organizations_url":"https://api.github.com/users/aditiwari01/orgs","repos_url":"https://api.github.com/users/aditiwari01/repos","events_url":"https://api.github.com/users/aditiwari01/events{/privacy}","received_events_url":"https://api.github.com/users/aditiwari01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-04T07:03:52Z","updated_at":"2021-04-04T07:03:52Z","author_association":"CONTRIBUTOR","body":"> @bvaradar : I see that SchemaConverters.toAvroType(...) is used in 3 places in hudi code base. 2 of those have been fixed as part of this patch. Wondering if we need to fix HoodieSparkBootstrapSchemaProvider as well.\r\n\r\nYes, One of the tests fails because of that. Should be fixed for bootstrap also.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/812985549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813003454","html_url":"https://github.com/apache/hudi/pull/2764#issuecomment-813003454","issue_url":"https://api.github.com/repos/apache/hudi/issues/2764","id":813003454,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMzAwMzQ1NA==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-04T09:36:03Z","updated_at":"2021-04-04T09:36:03Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2764?src=pr&el=h1) Report\n> Merging [#2764](https://codecov.io/gh/apache/hudi/pull/2764?src=pr&el=desc) (0ed6e5b) into [master](https://codecov.io/gh/apache/hudi/commit/e970e1f48302aec3af7eeca009a2c793757cd501?el=desc) (e970e1f) will **increase** coverage by `17.42%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2764/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2764?src=pr&el=tree)\n\n```diff\n@@              Coverage Diff              @@\n##             master    #2764       +/-   ##\n=============================================\n+ Coverage     52.32%   69.74%   +17.42%     \n+ Complexity     3689      372     -3317     \n=============================================\n  Files           483       54      -429     \n  Lines         23095     1993    -21102     \n  Branches       2460      236     -2224     \n=============================================\n- Hits          12084     1390    -10694     \n+ Misses         9942      473     -9469     \n+ Partials       1069      130      -939     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `?` | `?` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `69.74% <ø> (+0.05%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2764?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...e/hudi/common/table/timeline/dto/FileSliceDTO.java](https://codecov.io/gh/apache/hudi/pull/2764/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL3RpbWVsaW5lL2R0by9GaWxlU2xpY2VEVE8uamF2YQ==) | | | |\n| [...a/org/apache/hudi/common/bloom/InternalFilter.java](https://codecov.io/gh/apache/hudi/pull/2764/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2Jsb29tL0ludGVybmFsRmlsdGVyLmphdmE=) | | | |\n| [...le/view/IncrementalTimelineSyncFileSystemView.java](https://codecov.io/gh/apache/hudi/pull/2764/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL3ZpZXcvSW5jcmVtZW50YWxUaW1lbGluZVN5bmNGaWxlU3lzdGVtVmlldy5qYXZh) | | | |\n| [...rg/apache/hudi/io/storage/HoodieParquetReader.java](https://codecov.io/gh/apache/hudi/pull/2764/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaW8vc3RvcmFnZS9Ib29kaWVQYXJxdWV0UmVhZGVyLmphdmE=) | | | |\n| [...ache/hudi/common/util/collection/DiskBasedMap.java](https://codecov.io/gh/apache/hudi/pull/2764/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3V0aWwvY29sbGVjdGlvbi9EaXNrQmFzZWRNYXAuamF2YQ==) | | | |\n| [...mon/table/log/block/HoodieCommandBlockVersion.java](https://codecov.io/gh/apache/hudi/pull/2764/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9ibG9jay9Ib29kaWVDb21tYW5kQmxvY2tWZXJzaW9uLmphdmE=) | | | |\n| [...a/org/apache/hudi/common/util/CompactionUtils.java](https://codecov.io/gh/apache/hudi/pull/2764/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3V0aWwvQ29tcGFjdGlvblV0aWxzLmphdmE=) | | | |\n| [...org/apache/hudi/common/model/TableServiceType.java](https://codecov.io/gh/apache/hudi/pull/2764/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL21vZGVsL1RhYmxlU2VydmljZVR5cGUuamF2YQ==) | | | |\n| [...pache/hudi/common/table/HoodieTableMetaClient.java](https://codecov.io/gh/apache/hudi/pull/2764/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL0hvb2RpZVRhYmxlTWV0YUNsaWVudC5qYXZh) | | | |\n| [...e/hudi/common/table/log/block/HoodieDataBlock.java](https://codecov.io/gh/apache/hudi/pull/2764/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9ibG9jay9Ib29kaWVEYXRhQmxvY2suamF2YQ==) | | | |\n| ... and [420 more](https://codecov.io/gh/apache/hudi/pull/2764/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813003454/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813006720","html_url":"https://github.com/apache/hudi/issues/2756#issuecomment-813006720","issue_url":"https://api.github.com/repos/apache/hudi/issues/2756","id":813006720,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMzAwNjcyMA==","user":{"login":"aditiwari01","id":16352977,"node_id":"MDQ6VXNlcjE2MzUyOTc3","avatar_url":"https://avatars.githubusercontent.com/u/16352977?v=4","gravatar_id":"","url":"https://api.github.com/users/aditiwari01","html_url":"https://github.com/aditiwari01","followers_url":"https://api.github.com/users/aditiwari01/followers","following_url":"https://api.github.com/users/aditiwari01/following{/other_user}","gists_url":"https://api.github.com/users/aditiwari01/gists{/gist_id}","starred_url":"https://api.github.com/users/aditiwari01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aditiwari01/subscriptions","organizations_url":"https://api.github.com/users/aditiwari01/orgs","repos_url":"https://api.github.com/users/aditiwari01/repos","events_url":"https://api.github.com/users/aditiwari01/events{/privacy}","received_events_url":"https://api.github.com/users/aditiwari01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-04T10:04:13Z","updated_at":"2021-04-04T10:04:13Z","author_association":"CONTRIBUTOR","body":"Can we change the tag for the issue? Or is there anythinng required from my side?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813006720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813008111","html_url":"https://github.com/apache/hudi/pull/2765#issuecomment-813008111","issue_url":"https://api.github.com/repos/apache/hudi/issues/2765","id":813008111,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMzAwODExMQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-04T10:16:43Z","updated_at":"2021-04-07T12:21:08Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2765?src=pr&el=h1) Report\n> Merging [#2765](https://codecov.io/gh/apache/hudi/pull/2765?src=pr&el=desc) (4a979fb) into [master](https://codecov.io/gh/apache/hudi/commit/e970e1f48302aec3af7eeca009a2c793757cd501?el=desc) (e970e1f) will **decrease** coverage by `0.04%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2765/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2765?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2765      +/-   ##\n============================================\n- Coverage     52.32%   52.27%   -0.05%     \n+ Complexity     3689     3683       -6     \n============================================\n  Files           483      484       +1     \n  Lines         23095    23094       -1     \n  Branches       2460     2456       -4     \n============================================\n- Hits          12084    12072      -12     \n- Misses         9942     9959      +17     \n+ Partials       1069     1063       -6     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `36.94% <ø> (-0.07%)` | `0.00 <ø> (ø)` | |\n| hudiclient | `∅ <ø> (∅)` | `0.00 <ø> (ø)` | |\n| hudicommon | `50.77% <ø> (-0.07%)` | `0.00 <ø> (ø)` | |\n| hudiflink | `56.58% <ø> (-0.14%)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.44% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisparkdatasource | `71.38% <ø> (+0.05%)` | `0.00 <ø> (ø)` | |\n| hudisync | `45.47% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `64.36% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.77% <ø> (+0.08%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2765?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [.../org/apache/hudi/sink/utils/NonThrownExecutor.java](https://codecov.io/gh/apache/hudi/pull/2765/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL3V0aWxzL05vblRocm93bkV4ZWN1dG9yLmphdmE=) | `66.66% <0.00%> (-11.12%)` | `4.00% <0.00%> (-1.00%)` | |\n| [...ache/hudi/common/fs/inline/InMemoryFileSystem.java](https://codecov.io/gh/apache/hudi/pull/2765/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2ZzL2lubGluZS9Jbk1lbW9yeUZpbGVTeXN0ZW0uamF2YQ==) | `79.31% <0.00%> (-10.35%)` | `15.00% <0.00%> (-1.00%)` | |\n| [...e/hudi/sink/transform/RowDataToHoodieFunction.java](https://codecov.io/gh/apache/hudi/pull/2765/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL3RyYW5zZm9ybS9Sb3dEYXRhVG9Ib29kaWVGdW5jdGlvbi5qYXZh) | `83.33% <0.00%> (-7.58%)` | `5.00% <0.00%> (-1.00%)` | |\n| [...ache/hudi/sink/StreamWriteOperatorCoordinator.java](https://codecov.io/gh/apache/hudi/pull/2765/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL1N0cmVhbVdyaXRlT3BlcmF0b3JDb29yZGluYXRvci5qYXZh) | `68.54% <0.00%> (-5.78%)` | `28.00% <0.00%> (-5.00%)` | |\n| [...n/java/org/apache/hudi/common/model/HoodieKey.java](https://codecov.io/gh/apache/hudi/pull/2765/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL21vZGVsL0hvb2RpZUtleS5qYXZh) | `41.66% <0.00%> (-2.78%)` | `7.00% <0.00%> (+1.00%)` | :arrow_down: |\n| [...java/org/apache/hudi/sink/StreamWriteFunction.java](https://codecov.io/gh/apache/hudi/pull/2765/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL1N0cmVhbVdyaXRlRnVuY3Rpb24uamF2YQ==) | `80.50% <0.00%> (-2.57%)` | `22.00% <0.00%> (-1.00%)` | |\n| [...e/hudi/common/table/log/HoodieLogFormatWriter.java](https://codecov.io/gh/apache/hudi/pull/2765/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9Ib29kaWVMb2dGb3JtYXRXcml0ZXIuamF2YQ==) | `78.12% <0.00%> (-1.57%)` | `26.00% <0.00%> (ø%)` | |\n| [...n/java/org/apache/hudi/cli/commands/SparkMain.java](https://codecov.io/gh/apache/hudi/pull/2765/diff?src=pr&el=tree#diff-aHVkaS1jbGkvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY2xpL2NvbW1hbmRzL1NwYXJrTWFpbi5qYXZh) | `6.72% <0.00%> (-0.12%)` | `4.00% <0.00%> (ø%)` | |\n| [.../org/apache/hudi/sink/compact/CompactFunction.java](https://codecov.io/gh/apache/hudi/pull/2765/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL2NvbXBhY3QvQ29tcGFjdEZ1bmN0aW9uLmphdmE=) | `100.00% <0.00%> (ø)` | `6.00% <0.00%> (+3.00%)` | |\n| [.../org/apache/hudi/common/model/HoodieFileGroup.java](https://codecov.io/gh/apache/hudi/pull/2765/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL21vZGVsL0hvb2RpZUZpbGVHcm91cC5qYXZh) | `84.48% <0.00%> (ø)` | `28.00% <0.00%> (ø%)` | |\n| ... and [15 more](https://codecov.io/gh/apache/hudi/pull/2765/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813008111/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813027238","html_url":"https://github.com/apache/hudi/pull/2714#issuecomment-813027238","issue_url":"https://api.github.com/repos/apache/hudi/issues/2714","id":813027238,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMzAyNzIzOA==","user":{"login":"pratyakshsharma","id":30863489,"node_id":"MDQ6VXNlcjMwODYzNDg5","avatar_url":"https://avatars.githubusercontent.com/u/30863489?v=4","gravatar_id":"","url":"https://api.github.com/users/pratyakshsharma","html_url":"https://github.com/pratyakshsharma","followers_url":"https://api.github.com/users/pratyakshsharma/followers","following_url":"https://api.github.com/users/pratyakshsharma/following{/other_user}","gists_url":"https://api.github.com/users/pratyakshsharma/gists{/gist_id}","starred_url":"https://api.github.com/users/pratyakshsharma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pratyakshsharma/subscriptions","organizations_url":"https://api.github.com/users/pratyakshsharma/orgs","repos_url":"https://api.github.com/users/pratyakshsharma/repos","events_url":"https://api.github.com/users/pratyakshsharma/events{/privacy}","received_events_url":"https://api.github.com/users/pratyakshsharma/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-04T12:47:39Z","updated_at":"2021-04-04T12:47:39Z","author_association":"CONTRIBUTOR","body":"@vburenin Can you please fix the build? There are test failures. \r\n\r\nJust one minor comment from my side and rest looks good. :) ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813027238/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813030279","html_url":"https://github.com/apache/hudi/pull/1650#issuecomment-813030279","issue_url":"https://api.github.com/repos/apache/hudi/issues/1650","id":813030279,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMzAzMDI3OQ==","user":{"login":"pratyakshsharma","id":30863489,"node_id":"MDQ6VXNlcjMwODYzNDg5","avatar_url":"https://avatars.githubusercontent.com/u/30863489?v=4","gravatar_id":"","url":"https://api.github.com/users/pratyakshsharma","html_url":"https://github.com/pratyakshsharma","followers_url":"https://api.github.com/users/pratyakshsharma/followers","following_url":"https://api.github.com/users/pratyakshsharma/following{/other_user}","gists_url":"https://api.github.com/users/pratyakshsharma/gists{/gist_id}","starred_url":"https://api.github.com/users/pratyakshsharma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pratyakshsharma/subscriptions","organizations_url":"https://api.github.com/users/pratyakshsharma/orgs","repos_url":"https://api.github.com/users/pratyakshsharma/repos","events_url":"https://api.github.com/users/pratyakshsharma/events{/privacy}","received_events_url":"https://api.github.com/users/pratyakshsharma/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-04T13:09:15Z","updated_at":"2021-04-04T13:09:15Z","author_association":"CONTRIBUTOR","body":"@bvaradar Got chance to take a pass?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813030279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813067816","html_url":"https://github.com/apache/hudi/pull/2767#issuecomment-813067816","issue_url":"https://api.github.com/repos/apache/hudi/issues/2767","id":813067816,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMzA2NzgxNg==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-04T17:17:36Z","updated_at":"2021-04-04T17:38:19Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2767?src=pr&el=h1) Report\n> Merging [#2767](https://codecov.io/gh/apache/hudi/pull/2767?src=pr&el=desc) (dca9350) into [master](https://codecov.io/gh/apache/hudi/commit/e970e1f48302aec3af7eeca009a2c793757cd501?el=desc) (e970e1f) will **increase** coverage by `17.42%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2767/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2767?src=pr&el=tree)\n\n```diff\n@@              Coverage Diff              @@\n##             master    #2767       +/-   ##\n=============================================\n+ Coverage     52.32%   69.74%   +17.42%     \n+ Complexity     3689      372     -3317     \n=============================================\n  Files           483       54      -429     \n  Lines         23095     1993    -21102     \n  Branches       2460      236     -2224     \n=============================================\n- Hits          12084     1390    -10694     \n+ Misses         9942      473     -9469     \n+ Partials       1069      130      -939     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `?` | `?` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `69.74% <ø> (+0.05%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2767?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...g/apache/hudi/exception/HoodieRemoteException.java](https://codecov.io/gh/apache/hudi/pull/2767/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvZXhjZXB0aW9uL0hvb2RpZVJlbW90ZUV4Y2VwdGlvbi5qYXZh) | | | |\n| [...e/hudi/exception/HoodieSerializationException.java](https://codecov.io/gh/apache/hudi/pull/2767/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvZXhjZXB0aW9uL0hvb2RpZVNlcmlhbGl6YXRpb25FeGNlcHRpb24uamF2YQ==) | | | |\n| [...va/org/apache/hudi/cli/commands/ExportCommand.java](https://codecov.io/gh/apache/hudi/pull/2767/diff?src=pr&el=tree#diff-aHVkaS1jbGkvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY2xpL2NvbW1hbmRzL0V4cG9ydENvbW1hbmQuamF2YQ==) | | | |\n| [...a/org/apache/hudi/common/util/collection/Pair.java](https://codecov.io/gh/apache/hudi/pull/2767/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3V0aWwvY29sbGVjdGlvbi9QYWlyLmphdmE=) | | | |\n| [...i/bootstrap/SparkParquetBootstrapDataProvider.java](https://codecov.io/gh/apache/hudi/pull/2767/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvYm9vdHN0cmFwL1NwYXJrUGFycXVldEJvb3RzdHJhcERhdGFQcm92aWRlci5qYXZh) | | | |\n| [...g/apache/hudi/exception/InvalidTableException.java](https://codecov.io/gh/apache/hudi/pull/2767/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvZXhjZXB0aW9uL0ludmFsaWRUYWJsZUV4Y2VwdGlvbi5qYXZh) | | | |\n| [.../java/org/apache/hudi/common/util/CommitUtils.java](https://codecov.io/gh/apache/hudi/pull/2767/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3V0aWwvQ29tbWl0VXRpbHMuamF2YQ==) | | | |\n| [...va/org/apache/hudi/common/model/CleanFileInfo.java](https://codecov.io/gh/apache/hudi/pull/2767/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL21vZGVsL0NsZWFuRmlsZUluZm8uamF2YQ==) | | | |\n| [...transform/JsonStringToHoodieRecordMapFunction.java](https://codecov.io/gh/apache/hudi/pull/2767/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL3RyYW5zZm9ybS9Kc29uU3RyaW5nVG9Ib29kaWVSZWNvcmRNYXBGdW5jdGlvbi5qYXZh) | | | |\n| [...n/java/org/apache/hudi/hadoop/InputSplitUtils.java](https://codecov.io/gh/apache/hudi/pull/2767/diff?src=pr&el=tree#diff-aHVkaS1oYWRvb3AtbXIvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaGFkb29wL0lucHV0U3BsaXRVdGlscy5qYXZh) | | | |\n| ... and [419 more](https://codecov.io/gh/apache/hudi/pull/2767/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813067816/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813079061","html_url":"https://github.com/apache/hudi/pull/2768#issuecomment-813079061","issue_url":"https://api.github.com/repos/apache/hudi/issues/2768","id":813079061,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMzA3OTA2MQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-04T18:29:30Z","updated_at":"2021-04-04T18:30:27Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2768?src=pr&el=h1) Report\n> Merging [#2768](https://codecov.io/gh/apache/hudi/pull/2768?src=pr&el=desc) (5d32a15) into [master](https://codecov.io/gh/apache/hudi/commit/e970e1f48302aec3af7eeca009a2c793757cd501?el=desc) (e970e1f) will **decrease** coverage by `0.01%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2768/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2768?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2768      +/-   ##\n============================================\n- Coverage     52.32%   52.30%   -0.02%     \n  Complexity     3689     3689              \n============================================\n  Files           483      483              \n  Lines         23095    23095              \n  Branches       2460     2460              \n============================================\n- Hits          12084    12080       -4     \n- Misses         9942     9946       +4     \n  Partials       1069     1069              \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `37.01% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiclient | `∅ <ø> (∅)` | `0.00 <ø> (ø)` | |\n| hudicommon | `50.78% <ø> (-0.05%)` | `0.00 <ø> (ø)` | |\n| hudiflink | `56.71% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.44% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisparkdatasource | `71.33% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisync | `45.47% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `64.36% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.74% <ø> (+0.05%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2768?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...ache/hudi/common/fs/inline/InMemoryFileSystem.java](https://codecov.io/gh/apache/hudi/pull/2768/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2ZzL2lubGluZS9Jbk1lbW9yeUZpbGVTeXN0ZW0uamF2YQ==) | `79.31% <0.00%> (-10.35%)` | `15.00% <0.00%> (-1.00%)` | |\n| [...e/hudi/common/table/log/HoodieLogFormatWriter.java](https://codecov.io/gh/apache/hudi/pull/2768/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9Ib29kaWVMb2dGb3JtYXRXcml0ZXIuamF2YQ==) | `78.12% <0.00%> (-1.57%)` | `26.00% <0.00%> (ø%)` | |\n| [...apache/hudi/utilities/deltastreamer/DeltaSync.java](https://codecov.io/gh/apache/hudi/pull/2768/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvRGVsdGFTeW5jLmphdmE=) | `71.42% <0.00%> (+0.34%)` | `56.00% <0.00%> (+1.00%)` | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813079061/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813086549","html_url":"https://github.com/apache/hudi/pull/2769#issuecomment-813086549","issue_url":"https://api.github.com/repos/apache/hudi/issues/2769","id":813086549,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMzA4NjU0OQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-04T19:23:19Z","updated_at":"2021-04-04T19:47:37Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2769?src=pr&el=h1) Report\n> Merging [#2769](https://codecov.io/gh/apache/hudi/pull/2769?src=pr&el=desc) (bd962cb) into [master](https://codecov.io/gh/apache/hudi/commit/e970e1f48302aec3af7eeca009a2c793757cd501?el=desc) (e970e1f) will **increase** coverage by `17.37%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2769/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2769?src=pr&el=tree)\n\n```diff\n@@              Coverage Diff              @@\n##             master    #2769       +/-   ##\n=============================================\n+ Coverage     52.32%   69.69%   +17.37%     \n+ Complexity     3689      371     -3318     \n=============================================\n  Files           483       54      -429     \n  Lines         23095     1993    -21102     \n  Branches       2460      236     -2224     \n=============================================\n- Hits          12084     1389    -10695     \n+ Misses         9942      473     -9469     \n+ Partials       1069      131      -938     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `?` | `?` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `69.69% <ø> (ø)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2769?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [.../src/main/java/org/apache/hudi/dla/util/Utils.java](https://codecov.io/gh/apache/hudi/pull/2769/diff?src=pr&el=tree#diff-aHVkaS1zeW5jL2h1ZGktZGxhLXN5bmMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvZGxhL3V0aWwvVXRpbHMuamF2YQ==) | | | |\n| [.../apache/hudi/exception/TableNotFoundException.java](https://codecov.io/gh/apache/hudi/pull/2769/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvZXhjZXB0aW9uL1RhYmxlTm90Rm91bmRFeGNlcHRpb24uamF2YQ==) | | | |\n| [...java/org/apache/hudi/sink/StreamWriteFunction.java](https://codecov.io/gh/apache/hudi/pull/2769/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL1N0cmVhbVdyaXRlRnVuY3Rpb24uamF2YQ==) | | | |\n| [.../org/apache/hudi/cli/commands/SparkEnvCommand.java](https://codecov.io/gh/apache/hudi/pull/2769/diff?src=pr&el=tree#diff-aHVkaS1jbGkvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY2xpL2NvbW1hbmRzL1NwYXJrRW52Q29tbWFuZC5qYXZh) | | | |\n| [...he/hudi/common/bootstrap/index/BootstrapIndex.java](https://codecov.io/gh/apache/hudi/pull/2769/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2Jvb3RzdHJhcC9pbmRleC9Cb290c3RyYXBJbmRleC5qYXZh) | | | |\n| [.../hudi/common/table/log/HoodieLogFormatVersion.java](https://codecov.io/gh/apache/hudi/pull/2769/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9Ib29kaWVMb2dGb3JtYXRWZXJzaW9uLmphdmE=) | | | |\n| [...java/org/apache/hudi/cli/HoodieCliSparkConfig.java](https://codecov.io/gh/apache/hudi/pull/2769/diff?src=pr&el=tree#diff-aHVkaS1jbGkvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY2xpL0hvb2RpZUNsaVNwYXJrQ29uZmlnLmphdmE=) | | | |\n| [...he/hudi/common/fs/SizeAwareFSDataOutputStream.java](https://codecov.io/gh/apache/hudi/pull/2769/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2ZzL1NpemVBd2FyZUZTRGF0YU91dHB1dFN0cmVhbS5qYXZh) | | | |\n| [...pache/hudi/common/table/HoodieTableMetaClient.java](https://codecov.io/gh/apache/hudi/pull/2769/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL0hvb2RpZVRhYmxlTWV0YUNsaWVudC5qYXZh) | | | |\n| [.../java/org/apache/hudi/common/model/ActionType.java](https://codecov.io/gh/apache/hudi/pull/2769/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL21vZGVsL0FjdGlvblR5cGUuamF2YQ==) | | | |\n| ... and [419 more](https://codecov.io/gh/apache/hudi/pull/2769/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813086549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813086786","html_url":"https://github.com/apache/hudi/pull/1565#issuecomment-813086786","issue_url":"https://api.github.com/repos/apache/hudi/issues/1565","id":813086786,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMzA4Njc4Ng==","user":{"login":"pratyakshsharma","id":30863489,"node_id":"MDQ6VXNlcjMwODYzNDg5","avatar_url":"https://avatars.githubusercontent.com/u/30863489?v=4","gravatar_id":"","url":"https://api.github.com/users/pratyakshsharma","html_url":"https://github.com/pratyakshsharma","followers_url":"https://api.github.com/users/pratyakshsharma/followers","following_url":"https://api.github.com/users/pratyakshsharma/following{/other_user}","gists_url":"https://api.github.com/users/pratyakshsharma/gists{/gist_id}","starred_url":"https://api.github.com/users/pratyakshsharma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pratyakshsharma/subscriptions","organizations_url":"https://api.github.com/users/pratyakshsharma/orgs","repos_url":"https://api.github.com/users/pratyakshsharma/repos","events_url":"https://api.github.com/users/pratyakshsharma/events{/privacy}","received_events_url":"https://api.github.com/users/pratyakshsharma/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-04T19:25:12Z","updated_at":"2021-04-04T19:25:12Z","author_association":"CONTRIBUTOR","body":"> @pratyakshsharma I'm referring to this commit -> 900de34\r\n\r\n@n3nash I went through the commit you are referring to. It basically takes care of passing in custom reader schema for deserialization. It does not take care of kafka setup without schema-registry. Still there is some work that needs to be done in this regard. I will sync up with @nsivabalan for the same. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813086786/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813088110","html_url":"https://github.com/apache/hudi/pull/1565#issuecomment-813088110","issue_url":"https://api.github.com/repos/apache/hudi/issues/1565","id":813088110,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMzA4ODExMA==","user":{"login":"pratyakshsharma","id":30863489,"node_id":"MDQ6VXNlcjMwODYzNDg5","avatar_url":"https://avatars.githubusercontent.com/u/30863489?v=4","gravatar_id":"","url":"https://api.github.com/users/pratyakshsharma","html_url":"https://github.com/pratyakshsharma","followers_url":"https://api.github.com/users/pratyakshsharma/followers","following_url":"https://api.github.com/users/pratyakshsharma/following{/other_user}","gists_url":"https://api.github.com/users/pratyakshsharma/gists{/gist_id}","starred_url":"https://api.github.com/users/pratyakshsharma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pratyakshsharma/subscriptions","organizations_url":"https://api.github.com/users/pratyakshsharma/orgs","repos_url":"https://api.github.com/users/pratyakshsharma/repos","events_url":"https://api.github.com/users/pratyakshsharma/events{/privacy}","received_events_url":"https://api.github.com/users/pratyakshsharma/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-04T19:35:10Z","updated_at":"2021-04-04T19:35:10Z","author_association":"CONTRIBUTOR","body":"> @afilipchik @pratyakshsharma : can you folks summarize whats pending wrt this patch. I can take this up and try to get this in upcoming release. Would appreciate if you can go over what needs to be done to get this to closure.\r\n\r\n@nsivabalan Basically we need to figure out/ decide on the below items - \r\n1. Is it okay to mandate use of MockSchemaRegistryClient while serializing data before sending it to kafka for users?\r\n2. Referring to this comment - https://github.com/apache/hudi/pull/1565#issuecomment-629811530, I guess the actual scope of this PR was supporting vanilla kafka setup w/o supporting schema evolution. If indeed, we want to move forward with supporting schema evolutions along with vanilla setup, we need to explore around how to achieve the same. \r\n\r\nAny thoughts are welcome. :) ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813088110/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813088782","html_url":"https://github.com/apache/hudi/pull/2714#issuecomment-813088782","issue_url":"https://api.github.com/repos/apache/hudi/issues/2714","id":813088782,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMzA4ODc4Mg==","user":{"login":"vburenin","id":4350891,"node_id":"MDQ6VXNlcjQzNTA4OTE=","avatar_url":"https://avatars.githubusercontent.com/u/4350891?v=4","gravatar_id":"","url":"https://api.github.com/users/vburenin","html_url":"https://github.com/vburenin","followers_url":"https://api.github.com/users/vburenin/followers","following_url":"https://api.github.com/users/vburenin/following{/other_user}","gists_url":"https://api.github.com/users/vburenin/gists{/gist_id}","starred_url":"https://api.github.com/users/vburenin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vburenin/subscriptions","organizations_url":"https://api.github.com/users/vburenin/orgs","repos_url":"https://api.github.com/users/vburenin/repos","events_url":"https://api.github.com/users/vburenin/events{/privacy}","received_events_url":"https://api.github.com/users/vburenin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-04T19:40:33Z","updated_at":"2021-04-04T19:40:33Z","author_association":"CONTRIBUTOR","body":"I wonder what could cause those failures as the only change I made is log level and some extra config print out... unless tests are looking into the logs... which is not good.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813088782/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813089246","html_url":"https://github.com/apache/hudi/pull/2714#issuecomment-813089246","issue_url":"https://api.github.com/repos/apache/hudi/issues/2714","id":813089246,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMzA4OTI0Ng==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-04T19:44:23Z","updated_at":"2021-04-10T19:20:00Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2714?src=pr&el=h1) Report\n> Merging [#2714](https://codecov.io/gh/apache/hudi/pull/2714?src=pr&el=desc) (334ac44) into [master](https://codecov.io/gh/apache/hudi/commit/8d4a7fe33e041719e2509f1f8ad3667e2ae7bbb4?el=desc) (8d4a7fe) will **decrease** coverage by `5.21%`.\n> The diff coverage is `32.00%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2714/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2714?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2714      +/-   ##\n============================================\n- Coverage     52.55%   47.34%   -5.22%     \n+ Complexity     3707     3383     -324     \n============================================\n  Files           485      485              \n  Lines         23172    23185      +13     \n  Branches       2459     2463       +4     \n============================================\n- Hits          12179    10976    -1203     \n- Misses         9922    11254    +1332     \n+ Partials       1071      955     -116     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `40.29% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiclient | `∅ <ø> (∅)` | `0.00 <ø> (ø)` | |\n| hudicommon | `50.70% <83.33%> (+<0.01%)` | `0.00 <1.00> (ø)` | |\n| hudiflink | `56.57% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.44% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisparkdatasource | `71.33% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisync | `45.70% <100.00%> (ø)` | `0.00 <0.00> (ø)` | |\n| huditimelineservice | `64.36% <50.00%> (ø)` | `0.00 <0.00> (ø)` | |\n| hudiutilities | `9.31% <0.00%> (-60.41%)` | `0.00 <0.00> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2714?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...apache/hudi/utilities/deltastreamer/DeltaSync.java](https://codecov.io/gh/apache/hudi/pull/2714/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvRGVsdGFTeW5jLmphdmE=) | `0.00% <0.00%> (-71.09%)` | `0.00 <0.00> (-55.00)` | |\n| [...i/utilities/deltastreamer/HoodieDeltaStreamer.java](https://codecov.io/gh/apache/hudi/pull/2714/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvSG9vZGllRGVsdGFTdHJlYW1lci5qYXZh) | `0.00% <0.00%> (-71.20%)` | `0.00 <0.00> (-18.00)` | |\n| [.../utilities/transform/SqlQueryBasedTransformer.java](https://codecov.io/gh/apache/hudi/pull/2714/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3RyYW5zZm9ybS9TcWxRdWVyeUJhc2VkVHJhbnNmb3JtZXIuamF2YQ==) | `0.00% <0.00%> (-75.00%)` | `0.00 <0.00> (-3.00)` | |\n| [...di/common/table/timeline/HoodieActiveTimeline.java](https://codecov.io/gh/apache/hudi/pull/2714/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL3RpbWVsaW5lL0hvb2RpZUFjdGl2ZVRpbWVsaW5lLmphdmE=) | `66.52% <50.00%> (-0.29%)` | `43.00 <0.00> (ø)` | |\n| [...g/apache/hudi/timeline/service/RequestHandler.java](https://codecov.io/gh/apache/hudi/pull/2714/diff?src=pr&el=tree#diff-aHVkaS10aW1lbGluZS1zZXJ2aWNlL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9odWRpL3RpbWVsaW5lL3NlcnZpY2UvUmVxdWVzdEhhbmRsZXIuamF2YQ==) | `73.37% <50.00%> (ø)` | `30.00 <0.00> (ø)` | |\n| [...common/table/view/AbstractTableFileSystemView.java](https://codecov.io/gh/apache/hudi/pull/2714/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL3ZpZXcvQWJzdHJhY3RUYWJsZUZpbGVTeXN0ZW1WaWV3LmphdmE=) | `86.07% <100.00%> (ø)` | `142.00 <0.00> (ø)` | |\n| [...i/common/table/view/HoodieTableFileSystemView.java](https://codecov.io/gh/apache/hudi/pull/2714/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL3ZpZXcvSG9vZGllVGFibGVGaWxlU3lzdGVtVmlldy5qYXZh) | `66.66% <100.00%> (ø)` | `34.00 <1.00> (ø)` | |\n| [...java/org/apache/hudi/hive/util/HiveSchemaUtil.java](https://codecov.io/gh/apache/hudi/pull/2714/diff?src=pr&el=tree#diff-aHVkaS1zeW5jL2h1ZGktaGl2ZS1zeW5jL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9odWRpL2hpdmUvdXRpbC9IaXZlU2NoZW1hVXRpbC5qYXZh) | `69.31% <100.00%> (ø)` | `43.00 <0.00> (ø)` | |\n| [...va/org/apache/hudi/utilities/IdentitySplitter.java](https://codecov.io/gh/apache/hudi/pull/2714/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0lkZW50aXR5U3BsaXR0ZXIuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-2.00%)` | |\n| [...va/org/apache/hudi/utilities/schema/SchemaSet.java](https://codecov.io/gh/apache/hudi/pull/2714/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFTZXQuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-3.00%)` | |\n| ... and [41 more](https://codecov.io/gh/apache/hudi/pull/2714/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/813089246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]