[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635727819","html_url":"https://github.com/apache/iceberg/pull/5007#issuecomment-1635727819","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5007","id":1635727819,"node_id":"IC_kwDOCW7NX85hfznL","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T11:30:16Z","updated_at":"2023-07-14T11:30:16Z","author_association":"CONTRIBUTOR","body":"Hey @szehon-ho @rdblue, could you please help review this when you have time? Thanks. (I've seen users misled by this)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635727819/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635746582","html_url":"https://github.com/apache/iceberg/pull/5007#issuecomment-1635746582","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5007","id":1635746582,"node_id":"IC_kwDOCW7NX85hf4MW","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T11:46:55Z","updated_at":"2023-07-14T13:00:43Z","author_association":"CONTRIBUTOR","body":"> Looks like Postgres supports this by immediately checking the table to see if there are any null values. We should be able to use a metadata check to do the same, assuming that the column's metadata collection is not set toÂ none.\r\n\r\nThis is cool and I'd like to give a try on this. \r\nI did some investigation, I think we may need to check the metadata of all files (including deleted data file), because CDC read workload may read deleted files, we also need to check the fields in the equality delete file, because the equality fields are derived from the table schema. This ensures that not-null constraint updates are totally compatible. What do you think ? @szehon-ho  @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635746582/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636026823","html_url":"https://github.com/apache/iceberg/pull/8051#issuecomment-1636026823","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8051","id":1636026823,"node_id":"IC_kwDOCW7NX85hg8nH","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T15:29:46Z","updated_at":"2023-07-14T15:29:46Z","author_association":"CONTRIBUTOR","body":"Empty files seem a little stranger to be existed. Should this delete could be achieved by `rewrite data files` + `expire snapshots`?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636026823/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636030692","html_url":"https://github.com/apache/iceberg/pull/7382#issuecomment-1636030692","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7382","id":1636030692,"node_id":"IC_kwDOCW7NX85hg9jk","user":{"login":"manuzhang","id":1191767,"node_id":"MDQ6VXNlcjExOTE3Njc=","avatar_url":"https://avatars.githubusercontent.com/u/1191767?v=4","gravatar_id":"","url":"https://api.github.com/users/manuzhang","html_url":"https://github.com/manuzhang","followers_url":"https://api.github.com/users/manuzhang/followers","following_url":"https://api.github.com/users/manuzhang/following{/other_user}","gists_url":"https://api.github.com/users/manuzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/manuzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manuzhang/subscriptions","organizations_url":"https://api.github.com/users/manuzhang/orgs","repos_url":"https://api.github.com/users/manuzhang/repos","events_url":"https://api.github.com/users/manuzhang/events{/privacy}","received_events_url":"https://api.github.com/users/manuzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T15:32:36Z","updated_at":"2023-07-14T15:32:36Z","author_association":"COLLABORATOR","body":"@bitsondatadev Comments addressed. Please take another look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636030692/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636073297","html_url":"https://github.com/apache/iceberg/issues/7154#issuecomment-1636073297","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7154","id":1636073297,"node_id":"IC_kwDOCW7NX85hhH9R","user":{"login":"coded9","id":9302330,"node_id":"MDQ6VXNlcjkzMDIzMzA=","avatar_url":"https://avatars.githubusercontent.com/u/9302330?v=4","gravatar_id":"","url":"https://api.github.com/users/coded9","html_url":"https://github.com/coded9","followers_url":"https://api.github.com/users/coded9/followers","following_url":"https://api.github.com/users/coded9/following{/other_user}","gists_url":"https://api.github.com/users/coded9/gists{/gist_id}","starred_url":"https://api.github.com/users/coded9/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coded9/subscriptions","organizations_url":"https://api.github.com/users/coded9/orgs","repos_url":"https://api.github.com/users/coded9/repos","events_url":"https://api.github.com/users/coded9/events{/privacy}","received_events_url":"https://api.github.com/users/coded9/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T16:09:04Z","updated_at":"2023-07-14T16:09:04Z","author_association":"CONTRIBUTOR","body":"@clownxc are you still working on this ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636073297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636107382","html_url":"https://github.com/apache/iceberg/pull/7382#issuecomment-1636107382","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7382","id":1636107382,"node_id":"IC_kwDOCW7NX85hhQR2","user":{"login":"bitsondatadev","id":8547669,"node_id":"MDQ6VXNlcjg1NDc2Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8547669?v=4","gravatar_id":"","url":"https://api.github.com/users/bitsondatadev","html_url":"https://github.com/bitsondatadev","followers_url":"https://api.github.com/users/bitsondatadev/followers","following_url":"https://api.github.com/users/bitsondatadev/following{/other_user}","gists_url":"https://api.github.com/users/bitsondatadev/gists{/gist_id}","starred_url":"https://api.github.com/users/bitsondatadev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitsondatadev/subscriptions","organizations_url":"https://api.github.com/users/bitsondatadev/orgs","repos_url":"https://api.github.com/users/bitsondatadev/repos","events_url":"https://api.github.com/users/bitsondatadev/events{/privacy}","received_events_url":"https://api.github.com/users/bitsondatadev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T16:38:31Z","updated_at":"2023-07-14T16:38:31Z","author_association":"COLLABORATOR","body":"@stevenzwu, please review this at your earliest convenience.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636107382/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636121959","html_url":"https://github.com/apache/iceberg/pull/8042#issuecomment-1636121959","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8042","id":1636121959,"node_id":"IC_kwDOCW7NX85hhT1n","user":{"login":"namrathamyske","id":17932873,"node_id":"MDQ6VXNlcjE3OTMyODcz","avatar_url":"https://avatars.githubusercontent.com/u/17932873?v=4","gravatar_id":"","url":"https://api.github.com/users/namrathamyske","html_url":"https://github.com/namrathamyske","followers_url":"https://api.github.com/users/namrathamyske/followers","following_url":"https://api.github.com/users/namrathamyske/following{/other_user}","gists_url":"https://api.github.com/users/namrathamyske/gists{/gist_id}","starred_url":"https://api.github.com/users/namrathamyske/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/namrathamyske/subscriptions","organizations_url":"https://api.github.com/users/namrathamyske/orgs","repos_url":"https://api.github.com/users/namrathamyske/repos","events_url":"https://api.github.com/users/namrathamyske/events{/privacy}","received_events_url":"https://api.github.com/users/namrathamyske/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T16:52:23Z","updated_at":"2023-07-14T16:52:23Z","author_association":"CONTRIBUTOR","body":"@huaxingao Thanks for your review! I have addressed all review comments ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636121959/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636161627","html_url":"https://github.com/apache/iceberg/pull/8059#issuecomment-1636161627","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8059","id":1636161627,"node_id":"IC_kwDOCW7NX85hhdhb","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T17:24:47Z","updated_at":"2023-07-14T17:24:47Z","author_association":"COLLABORATOR","body":"Sure let me do this in follow up pr.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636161627/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636217731","html_url":"https://github.com/apache/iceberg/issues/7841#issuecomment-1636217731","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7841","id":1636217731,"node_id":"IC_kwDOCW7NX85hhrOD","user":{"login":"rahil-c","id":32500120,"node_id":"MDQ6VXNlcjMyNTAwMTIw","avatar_url":"https://avatars.githubusercontent.com/u/32500120?v=4","gravatar_id":"","url":"https://api.github.com/users/rahil-c","html_url":"https://github.com/rahil-c","followers_url":"https://api.github.com/users/rahil-c/followers","following_url":"https://api.github.com/users/rahil-c/following{/other_user}","gists_url":"https://api.github.com/users/rahil-c/gists{/gist_id}","starred_url":"https://api.github.com/users/rahil-c/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rahil-c/subscriptions","organizations_url":"https://api.github.com/users/rahil-c/orgs","repos_url":"https://api.github.com/users/rahil-c/repos","events_url":"https://api.github.com/users/rahil-c/events{/privacy}","received_events_url":"https://api.github.com/users/rahil-c/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T18:15:59Z","updated_at":"2023-07-14T23:42:04Z","author_association":"CONTRIBUTOR","body":"@nastra Thanks for responding, just curious why it would need to be done in `GlueTableOperations` as opposed to in `GlueCatalog`? \r\n\r\n##Update\r\n\r\nFor some reason when I implement a similar logic of fileIoCloser within either of these classes(GlueCatalog or GlueTableOperations) I encounter the following exception for Entity Not Found exception when doing a basic create table query. When I remove the fileIOcloser logic then this error goes away and I can create table. Do you have any idea why the fileIOcloser logic would cause this? @nastra \r\n\r\n\r\nDiff\r\n\r\n```\r\ndiff --git a/aws/src/main/java/org/apache/iceberg/aws/glue/GlueCatalog.java b/aws/src/main/java/org/apache/iceberg/aws/glue/GlueCatalog.java\r\nindex db6e8ead7..d0b09e580 100644\r\n--- a/aws/src/main/java/org/apache/iceberg/aws/glue/GlueCatalog.java\r\n+++ b/aws/src/main/java/org/apache/iceberg/aws/glue/GlueCatalog.java\r\n@@ -231,7 +231,7 @@ public class GlueCatalog extends BaseMetastoreCatalog\r\n \r\n       // FileIO initialization depends on tableSpecificCatalogProperties, so a new FileIO is\r\n       // initialized each time\r\n-      return new GlueTableOperations(\r\n+      GlueTableOperations ops = new GlueTableOperations(\r\n           glue,\r\n           lockManager,\r\n           catalogName,\r\n@@ -239,9 +239,11 @@ public class GlueCatalog extends BaseMetastoreCatalog\r\n           tableSpecificCatalogPropertiesBuilder.buildOrThrow(),\r\n           hadoopConf,\r\n           tableIdentifier);\r\n+      ops.trackFileIO();\r\n+      return ops;\r\n     }\r\n \r\n-    return new GlueTableOperations(\r\n+    GlueTableOperations ops =  new GlueTableOperations(\r\n         glue,\r\n         lockManager,\r\n         catalogName,\r\n@@ -249,6 +251,8 @@ public class GlueCatalog extends BaseMetastoreCatalog\r\n         catalogProperties,\r\n         hadoopConf,\r\n         tableIdentifier);\r\n+    ops.trackFileIO();\r\n+    return ops;\r\n   }\r\n \r\n   /**\r\ndiff --git a/aws/src/main/java/org/apache/iceberg/aws/glue/GlueTableOperations.java b/aws/src/main/java/org/apache/iceberg/aws/glue/GlueTableOperations.java\r\nindex 6e53e707a..2fbe034df 100644\r\n--- a/aws/src/main/java/org/apache/iceberg/aws/glue/GlueTableOperations.java\r\n+++ b/aws/src/main/java/org/apache/iceberg/aws/glue/GlueTableOperations.java\r\n@@ -18,6 +18,12 @@\r\n  */\r\n package org.apache.iceberg.aws.glue;\r\n \r\n+import com.github.benmanes.caffeine.cache.Cache;\r\n+import com.github.benmanes.caffeine.cache.Caffeine;\r\n+import com.github.benmanes.caffeine.cache.RemovalListener;\r\n+\r\n+import java.io.Closeable;\r\n+import java.io.IOException;\r\n import java.util.Locale;\r\n import java.util.Map;\r\n import java.util.Objects;\r\n@@ -26,6 +32,7 @@ import org.apache.iceberg.CatalogProperties;\r\n import org.apache.iceberg.CatalogUtil;\r\n import org.apache.iceberg.LockManager;\r\n import org.apache.iceberg.TableMetadata;\r\n+import org.apache.iceberg.TableOperations;\r\n import org.apache.iceberg.aws.AwsProperties;\r\n import org.apache.iceberg.aws.s3.S3FileIO;\r\n import org.apache.iceberg.aws.util.RetryDetector;\r\n@@ -39,6 +46,7 @@ import org.apache.iceberg.exceptions.NoSuchIcebergTableException;\r\n import org.apache.iceberg.exceptions.NoSuchTableException;\r\n import org.apache.iceberg.exceptions.NotFoundException;\r\n import org.apache.iceberg.exceptions.ValidationException;\r\n+import org.apache.iceberg.io.CloseableGroup;\r\n import org.apache.iceberg.io.FileIO;\r\n import org.apache.iceberg.relocated.com.google.common.annotations.VisibleForTesting;\r\n import org.apache.iceberg.relocated.com.google.common.collect.Maps;\r\n@@ -59,7 +67,7 @@ import software.amazon.awssdk.services.glue.model.TableInput;\r\n import software.amazon.awssdk.services.glue.model.UpdateTableRequest;\r\n import software.amazon.awssdk.utils.ImmutableMap;\r\n \r\n-class GlueTableOperations extends BaseMetastoreTableOperations {\r\n+class GlueTableOperations extends BaseMetastoreTableOperations implements Closeable {\r\n \r\n   private static final Logger LOG = LoggerFactory.getLogger(GlueTableOperations.class);\r\n \r\n@@ -77,6 +85,9 @@ class GlueTableOperations extends BaseMetastoreTableOperations {\r\n   private final Object hadoopConf;\r\n   private final LockManager lockManager;\r\n   private FileIO fileIO;\r\n+  private CloseableGroup closeables = null;\r\n+\r\n+  private Cache<TableOperations, FileIO> fileIOCloser;\r\n \r\n   // Attempt to set versionId if available on the path\r\n   private static final DynMethods.UnboundMethod SET_VERSION_ID =\r\n@@ -107,6 +118,11 @@ class GlueTableOperations extends BaseMetastoreTableOperations {\r\n     this.tableCatalogProperties = tableCatalogProperties;\r\n     this.hadoopConf = hadoopConf;\r\n     this.lockManager = lockManager;\r\n+    this.fileIOCloser = newFileIOCloser();\r\n+    this.closeables = new CloseableGroup();\r\n+    this.closeables.addCloseable(this.fileIO);\r\n+    this.closeables.addCloseable(this.glue);\r\n+    this.closeables.setSuppressCloseFailure(true);\r\n   }\r\n \r\n   @Override\r\n@@ -406,4 +422,35 @@ class GlueTableOperations extends BaseMetastoreTableOperations {\r\n   Map<String, String> tableCatalogProperties() {\r\n     return tableCatalogProperties;\r\n   }\r\n+\r\n+  protected void trackFileIO() {\r\n+    if (fileIO != this.io()) {\r\n+      fileIOCloser.put(this, this.io());\r\n+    }\r\n+  }\r\n+\r\n+  private Cache<TableOperations, FileIO> newFileIOCloser() {\r\n+    return Caffeine.newBuilder()\r\n+            .weakKeys()\r\n+            .removalListener(\r\n+                (RemovalListener<TableOperations, FileIO>)\r\n+                  (ops, fileIO, cause) -> {\r\n+                    if (null != fileIO) {\r\n+                      fileIO.close();\r\n+                    }\r\n+                  })\r\n+            .build();\r\n+  }\r\n+\r\n+  @Override\r\n+  public void close() throws IOException {\r\n+    closeables.close();\r\n+    if (closeables != null) {\r\n+      closeables.close();\r\n+    }\r\n+    if (fileIOCloser != null) {\r\n+      fileIOCloser.invalidateAll();\r\n+      fileIOCloser.cleanUp();\r\n+    }\r\n+  }\r\n }\r\n\r\n```\r\n\r\n\r\nException\r\n```\r\nEntity Not Found (Service: Glue, Status Code: 400)\r\nsoftware.amazon.awssdk.services.glue.model.EntityNotFoundException: Entity Not Found (Service: Glue, Status Code: 400, Request ID: e6f1f94f-e394-4d2f-9807-65252db08a9e)\r\n\tat software.amazon.awssdk.core.internal.http.CombinedResponseHandler.handleErrorResponse(CombinedResponseHandler.java:125)\r\n\tat software.amazon.awssdk.core.internal.http.CombinedResponseHandler.handleResponse(CombinedResponseHandler.java:82)\r\n\tat software.amazon.awssdk.core.internal.http.CombinedResponseHandler.handle(CombinedResponseHandler.java:60)\r\n\tat software.amazon.awssdk.core.internal.http.CombinedResponseHandler.handle(CombinedResponseHandler.java:41)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.HandleResponseStage.execute(HandleResponseStage.java:40)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.HandleResponseStage.execute(HandleResponseStage.java:30)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallAttemptTimeoutTrackingStage.execute(ApiCallAttemptTimeoutTrackingStage.java:73)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallAttemptTimeoutTrackingStage.execute(ApiCallAttemptTimeoutTrackingStage.java:42)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.TimeoutExceptionHandlingStage.execute(TimeoutExceptionHandlingStage.java:78)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.TimeoutExceptionHandlingStage.execute(TimeoutExceptionHandlingStage.java:40)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallAttemptMetricCollectionStage.execute(ApiCallAttemptMetricCollectionStage.java:50)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallAttemptMetricCollectionStage.execute(ApiCallAttemptMetricCollectionStage.java:36)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.RetryableStage.execute(RetryableStage.java:81)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.RetryableStage.execute(RetryableStage.java:36)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206)\r\n\tat software.amazon.awssdk.core.internal.http.StreamManagingStage.execute(StreamManagingStage.java:56)\r\n\tat software.amazon.awssdk.core.internal.http.StreamManagingStage.execute(StreamManagingStage.java:36)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallTimeoutTrackingStage.executeWithTimer(ApiCallTimeoutTrackingStage.java:80)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallTimeoutTrackingStage.execute(ApiCallTimeoutTrackingStage.java:60)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallTimeoutTrackingStage.execute(ApiCallTimeoutTrackingStage.java:42)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallMetricCollectionStage.execute(ApiCallMetricCollectionStage.java:48)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallMetricCollectionStage.execute(ApiCallMetricCollectionStage.java:31)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ExecutionFailureExceptionReportingStage.execute(ExecutionFailureExceptionReportingStage.java:37)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ExecutionFailureExceptionReportingStage.execute(ExecutionFailureExceptionReportingStage.java:26)\r\n\tat software.amazon.awssdk.core.internal.http.AmazonSyncHttpClient$RequestExecutionBuilderImpl.execute(AmazonSyncHttpClient.java:193)\r\n\tat software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.invoke(BaseSyncClientHandler.java:103)\r\n\tat software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.doExecute(BaseSyncClientHandler.java:171)\r\n\tat software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.lambda$execute$1(BaseSyncClientHandler.java:82)\r\n\tat software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.measureApiCallSuccess(BaseSyncClientHandler.java:179)\r\n\tat software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.execute(BaseSyncClientHandler.java:76)\r\n\tat software.amazon.awssdk.core.client.handler.SdkSyncClientHandler.execute(SdkSyncClientHandler.java:45)\r\n\tat software.amazon.awssdk.awscore.client.handler.AwsSyncClientHandler.execute(AwsSyncClientHandler.java:56)\r\n\tat software.amazon.awssdk.services.glue.DefaultGlueClient.getTable(DefaultGlueClient.java:8903)\r\n\tat org.apache.iceberg.aws.lakeformation.LakeFormationAwsClientFactory.isTableRegisteredWithLakeFormation(LakeFormationAwsClientFactory.java:166)\r\n\tat org.apache.iceberg.aws.lakeformation.LakeFormationAwsClientFactory.s3(LakeFormationAwsClientFactory.java:104)\r\n\tat org.apache.iceberg.aws.s3.S3FileIO.client(S3FileIO.java:330)\r\n\tat org.apache.iceberg.aws.s3.S3FileIO.initialize(S3FileIO.java:378)\r\n\tat org.apache.iceberg.CatalogUtil.loadFileIO(CatalogUtil.java:325)\r\n\tat org.apache.iceberg.aws.glue.GlueTableOperations.initializeFileIO(GlueTableOperations.java:239)\r\n\tat org.apache.iceberg.aws.glue.GlueTableOperations.io(GlueTableOperations.java:131)\r\n\tat org.apache.iceberg.aws.glue.GlueTableOperations.trackFileIO(GlueTableOperations.java:427)\r\n\tat org.apache.iceberg.aws.glue.GlueCatalog.newTableOps(GlueCatalog.java:242)\r\n\tat org.apache.iceberg.BaseMetastoreCatalog.loadTable(BaseMetastoreCatalog.java:46)\r\n\tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.lambda$doComputeIfAbsent$14(BoundedLocalCache.java:2406)\r\n\tat java.util.concurrent.ConcurrentHashMap.compute(ConcurrentHashMap.java:1853)\r\n\tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.doComputeIfAbsent(BoundedLocalCache.java:2404)\r\n\tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.computeIfAbsent(BoundedLocalCache.java:2387)\r\n\tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.LocalCache.computeIfAbsent(LocalCache.java:108)\r\n\tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.LocalManualCache.get(LocalManualCache.java:62)\r\n\tat org.apache.iceberg.CachingCatalog.loadTable(CachingCatalog.java:166)\r\n\tat org.apache.iceberg.spark.SparkCatalog.load(SparkCatalog.java:641)\r\n\tat org.apache.iceberg.spark.SparkCatalog.loadTable(SparkCatalog.java:159)\r\n\tat org.apache.spark.sql.connector.catalog.TableCatalog.tableExists(TableCatalog.java:163)\r\n\tat org.apache.spark.sql.execution.datasources.v2.AtomicReplaceTableExec.run(ReplaceTableExec.scala:69)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2CommandExec.result$lzycompute(V2CommandExec.scala:43)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2CommandExec.result(V2CommandExec.scala:43)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2CommandExec.executeCollect(V2CommandExec.scala:49)\r\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:104)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:107)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withTracker(SQLExecution.scala:250)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.executeQuery$1(SQLExecution.scala:123)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$9(SQLExecution.scala:160)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:107)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withTracker(SQLExecution.scala:250)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$8(SQLExecution.scala:160)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:271)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:159)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:827)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:69)\r\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:101)\r\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:97)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:554)\r\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:107)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:554)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:530)\r\n\tat org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:97)\r\n\tat org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:84)\r\n\tat org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:82)\r\n\tat org.apache.spark.sql.Dataset.<init>(Dataset.scala:221)\r\n\tat org.apache.spark.sql.Dataset$.$anonfun$ofRows$2(Dataset.scala:101)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:827)\r\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:98)\r\n\tat org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:640)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:827)\r\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:630)\r\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:671)\r\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:651)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLDriver.run(SparkSQLDriver.scala:67)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.processCmd(SparkSQLCLIDriver.scala:415)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.$anonfun$processLine$1(SparkSQLCLIDriver.scala:533)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.$anonfun$processLine$1$adapted(SparkSQLCLIDriver.scala:527)\r\n\tat scala.collection.Iterator.foreach(Iterator.scala:943)\r\n\tat scala.collection.Iterator.foreach$(Iterator.scala:943)\r\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1431)\r\n\tat scala.collection.IterableLike.foreach(IterableLike.scala:74)\r\n\tat scala.collection.IterableLike.foreach$(IterableLike.scala:73)\r\n\tat scala.collection.AbstractIterable.foreach(Iterable.scala:56)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.processLine(SparkSQLCLIDriver.scala:527)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver$.main(SparkSQLCLIDriver.scala:307)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.main(SparkSQLCLIDriver.scala)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)\r\n\tat org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:1066)\r\n\tat org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:192)\r\n\tat org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:215)\r\n\tat org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:91)\r\n\tat org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1158)\r\n\tat org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1167)\r\n\tat org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)\r\nspark-sql (default)> quit;\r\n\r\n```\r\n\r\ncc @jackye1995 @xiaoxuandev ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636217731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636323065","html_url":"https://github.com/apache/iceberg/pull/8063#issuecomment-1636323065","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8063","id":1636323065,"node_id":"IC_kwDOCW7NX85hiE75","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T19:29:52Z","updated_at":"2023-07-14T19:29:52Z","author_association":"COLLABORATOR","body":"Thanks @lirui-apache !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636323065/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636369336","html_url":"https://github.com/apache/iceberg/issues/3494#issuecomment-1636369336","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3494","id":1636369336,"node_id":"IC_kwDOCW7NX85hiQO4","user":{"login":"atifiu","id":48252551,"node_id":"MDQ6VXNlcjQ4MjUyNTUx","avatar_url":"https://avatars.githubusercontent.com/u/48252551?v=4","gravatar_id":"","url":"https://api.github.com/users/atifiu","html_url":"https://github.com/atifiu","followers_url":"https://api.github.com/users/atifiu/followers","following_url":"https://api.github.com/users/atifiu/following{/other_user}","gists_url":"https://api.github.com/users/atifiu/gists{/gist_id}","starred_url":"https://api.github.com/users/atifiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/atifiu/subscriptions","organizations_url":"https://api.github.com/users/atifiu/orgs","repos_url":"https://api.github.com/users/atifiu/repos","events_url":"https://api.github.com/users/atifiu/events{/privacy}","received_events_url":"https://api.github.com/users/atifiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T20:13:43Z","updated_at":"2023-07-14T20:13:43Z","author_association":"NONE","body":"Problem I see here is that I have to read two partitions if in query I give 24 hour range since local partition is ranging over two days based on UTC. I am using daily partitions. Any alternative to this ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636369336/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636381954","html_url":"https://github.com/apache/iceberg/issues/3494#issuecomment-1636381954","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3494","id":1636381954,"node_id":"IC_kwDOCW7NX85hiTUC","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T20:19:03Z","updated_at":"2023-07-14T20:19:03Z","author_association":"MEMBER","body":"@atifiu sort on timestamp as well as partiion on day, that way all the files will be excluded that don't have information from the 24 hour range you are looking for. This would also be timezone agnostic if you happen to change query timezones","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636381954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636387935","html_url":"https://github.com/apache/iceberg/issues/3494#issuecomment-1636387935","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3494","id":1636387935,"node_id":"IC_kwDOCW7NX85hiUxf","user":{"login":"atifiu","id":48252551,"node_id":"MDQ6VXNlcjQ4MjUyNTUx","avatar_url":"https://avatars.githubusercontent.com/u/48252551?v=4","gravatar_id":"","url":"https://api.github.com/users/atifiu","html_url":"https://github.com/atifiu","followers_url":"https://api.github.com/users/atifiu/followers","following_url":"https://api.github.com/users/atifiu/following{/other_user}","gists_url":"https://api.github.com/users/atifiu/gists{/gist_id}","starred_url":"https://api.github.com/users/atifiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/atifiu/subscriptions","organizations_url":"https://api.github.com/users/atifiu/orgs","repos_url":"https://api.github.com/users/atifiu/repos","events_url":"https://api.github.com/users/atifiu/events{/privacy}","received_events_url":"https://api.github.com/users/atifiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T20:22:12Z","updated_at":"2023-07-14T20:22:12Z","author_association":"NONE","body":"You meant to write data by sorting on timestamp column... example write ordered by timestamp, col1 ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636387935/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636399901","html_url":"https://github.com/apache/iceberg/issues/7948#issuecomment-1636399901","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7948","id":1636399901,"node_id":"IC_kwDOCW7NX85hiXsd","user":{"login":"Marcus-Rosti","id":8094255,"node_id":"MDQ6VXNlcjgwOTQyNTU=","avatar_url":"https://avatars.githubusercontent.com/u/8094255?v=4","gravatar_id":"","url":"https://api.github.com/users/Marcus-Rosti","html_url":"https://github.com/Marcus-Rosti","followers_url":"https://api.github.com/users/Marcus-Rosti/followers","following_url":"https://api.github.com/users/Marcus-Rosti/following{/other_user}","gists_url":"https://api.github.com/users/Marcus-Rosti/gists{/gist_id}","starred_url":"https://api.github.com/users/Marcus-Rosti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Marcus-Rosti/subscriptions","organizations_url":"https://api.github.com/users/Marcus-Rosti/orgs","repos_url":"https://api.github.com/users/Marcus-Rosti/repos","events_url":"https://api.github.com/users/Marcus-Rosti/events{/privacy}","received_events_url":"https://api.github.com/users/Marcus-Rosti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T20:28:22Z","updated_at":"2023-07-14T20:28:22Z","author_association":"NONE","body":"please!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636399901/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636462712","html_url":"https://github.com/apache/iceberg/pull/7447#issuecomment-1636462712","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7447","id":1636462712,"node_id":"IC_kwDOCW7NX85hinB4","user":{"login":"karuppayya","id":5082742,"node_id":"MDQ6VXNlcjUwODI3NDI=","avatar_url":"https://avatars.githubusercontent.com/u/5082742?v=4","gravatar_id":"","url":"https://api.github.com/users/karuppayya","html_url":"https://github.com/karuppayya","followers_url":"https://api.github.com/users/karuppayya/followers","following_url":"https://api.github.com/users/karuppayya/following{/other_user}","gists_url":"https://api.github.com/users/karuppayya/gists{/gist_id}","starred_url":"https://api.github.com/users/karuppayya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karuppayya/subscriptions","organizations_url":"https://api.github.com/users/karuppayya/orgs","repos_url":"https://api.github.com/users/karuppayya/repos","events_url":"https://api.github.com/users/karuppayya/events{/privacy}","received_events_url":"https://api.github.com/users/karuppayya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T21:26:30Z","updated_at":"2023-07-14T21:26:30Z","author_association":"CONTRIBUTOR","body":"The test failures doesn't seem to be related\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636462712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636545352","html_url":"https://github.com/apache/iceberg/pull/8069#issuecomment-1636545352","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8069","id":1636545352,"node_id":"IC_kwDOCW7NX85hi7NI","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T23:15:00Z","updated_at":"2023-07-14T23:15:00Z","author_association":"COLLABORATOR","body":"Merged, thanks @aokolnychyi for review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636545352/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636566389","html_url":"https://github.com/apache/iceberg/pull/8070#issuecomment-1636566389","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8070","id":1636566389,"node_id":"IC_kwDOCW7NX85hjAV1","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T23:51:32Z","updated_at":"2023-07-14T23:51:32Z","author_association":"COLLABORATOR","body":"@nastra @aokolnychyi does this look right?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636566389/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636576962","html_url":"https://github.com/apache/iceberg/issues/5671#issuecomment-1636576962","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5671","id":1636576962,"node_id":"IC_kwDOCW7NX85hjC7C","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-07-15T00:13:01Z","updated_at":"2023-07-15T00:13:01Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636576962/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636691959","html_url":"https://github.com/apache/iceberg/pull/8072#issuecomment-1636691959","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8072","id":1636691959,"node_id":"IC_kwDOCW7NX85hje_3","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-15T06:57:11Z","updated_at":"2023-07-15T06:57:11Z","author_association":"CONTRIBUTOR","body":"Hi @rdblue @jackye1995, I see you have discussed this at here #7075, could you help to review this when you are free? Thanks a lot.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636691959/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636708788","html_url":"https://github.com/apache/iceberg/pull/8072#issuecomment-1636708788","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8072","id":1636708788,"node_id":"IC_kwDOCW7NX85hjjG0","user":{"login":"zhangbutao","id":9760681,"node_id":"MDQ6VXNlcjk3NjA2ODE=","avatar_url":"https://avatars.githubusercontent.com/u/9760681?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangbutao","html_url":"https://github.com/zhangbutao","followers_url":"https://api.github.com/users/zhangbutao/followers","following_url":"https://api.github.com/users/zhangbutao/following{/other_user}","gists_url":"https://api.github.com/users/zhangbutao/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangbutao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangbutao/subscriptions","organizations_url":"https://api.github.com/users/zhangbutao/orgs","repos_url":"https://api.github.com/users/zhangbutao/repos","events_url":"https://api.github.com/users/zhangbutao/events{/privacy}","received_events_url":"https://api.github.com/users/zhangbutao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-15T08:25:41Z","updated_at":"2023-07-15T08:25:41Z","author_association":"CONTRIBUTOR","body":"+1 for this change. This will solve this issue https://github.com/apache/iceberg/pull/7593 at its root.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636708788/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636799872","html_url":"https://github.com/apache/iceberg/issues/3896#issuecomment-1636799872","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3896","id":1636799872,"node_id":"IC_kwDOCW7NX85hj5WA","user":{"login":"sungwy","id":107272191,"node_id":"U_kgDOBmTX_w","avatar_url":"https://avatars.githubusercontent.com/u/107272191?v=4","gravatar_id":"","url":"https://api.github.com/users/sungwy","html_url":"https://github.com/sungwy","followers_url":"https://api.github.com/users/sungwy/followers","following_url":"https://api.github.com/users/sungwy/following{/other_user}","gists_url":"https://api.github.com/users/sungwy/gists{/gist_id}","starred_url":"https://api.github.com/users/sungwy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sungwy/subscriptions","organizations_url":"https://api.github.com/users/sungwy/orgs","repos_url":"https://api.github.com/users/sungwy/repos","events_url":"https://api.github.com/users/sungwy/events{/privacy}","received_events_url":"https://api.github.com/users/sungwy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-15T15:21:58Z","updated_at":"2023-07-15T15:21:58Z","author_association":"CONTRIBUTOR","body":"Hi folks, I see this PR was merged to enable support for writing to branches with table identifiers in Spark 3.3. https://github.com/apache/iceberg/pull/6965\r\n\r\nDo we need to go through a separate effort to backport it to Spark 3.2, and is it possible to backport to 3.2? (Are there any Spark features that are only available in 3.3 that's required for introducing custom table identifiers?)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636799872/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636806852","html_url":"https://github.com/apache/iceberg/pull/8060#issuecomment-1636806852","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8060","id":1636806852,"node_id":"IC_kwDOCW7NX85hj7DE","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-15T15:51:35Z","updated_at":"2023-07-15T15:51:35Z","author_association":"CONTRIBUTOR","body":"Thanks @szehon-ho ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636806852/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636857216","html_url":"https://github.com/apache/iceberg/pull/8074#issuecomment-1636857216","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8074","id":1636857216,"node_id":"IC_kwDOCW7NX85hkHWA","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-15T18:57:13Z","updated_at":"2023-07-15T18:57:13Z","author_association":"CONTRIBUTOR","body":"@rustyconover This is great! Can you run `pip3 install pre-commit && pre-commit run --all-files`?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636857216/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636868418","html_url":"https://github.com/apache/iceberg/pull/8074#issuecomment-1636868418","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8074","id":1636868418,"node_id":"IC_kwDOCW7NX85hkKFC","user":{"login":"rustyconover","id":731941,"node_id":"MDQ6VXNlcjczMTk0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/731941?v=4","gravatar_id":"","url":"https://api.github.com/users/rustyconover","html_url":"https://github.com/rustyconover","followers_url":"https://api.github.com/users/rustyconover/followers","following_url":"https://api.github.com/users/rustyconover/following{/other_user}","gists_url":"https://api.github.com/users/rustyconover/gists{/gist_id}","starred_url":"https://api.github.com/users/rustyconover/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rustyconover/subscriptions","organizations_url":"https://api.github.com/users/rustyconover/orgs","repos_url":"https://api.github.com/users/rustyconover/repos","events_url":"https://api.github.com/users/rustyconover/events{/privacy}","received_events_url":"https://api.github.com/users/rustyconover/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-15T19:25:29Z","updated_at":"2023-07-15T19:25:29Z","author_association":"CONTRIBUTOR","body":"Done","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636868418/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636873434","html_url":"https://github.com/apache/iceberg/pull/8074#issuecomment-1636873434","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8074","id":1636873434,"node_id":"IC_kwDOCW7NX85hkLTa","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-15T19:52:19Z","updated_at":"2023-07-15T19:52:19Z","author_association":"CONTRIBUTOR","body":"> This will improve efficiency of parsing Avro files when the blocks are entirely in memory.\r\n\r\nThis is great! Avro files we always consume all the way. So we might also want to tune the buffer sizes, or even better, check if there is a file API to read the whole file.\r\n\r\nThis is great @rustyconover Thanks for working on this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636873434/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636877192","html_url":"https://github.com/apache/iceberg/pull/8075#issuecomment-1636877192","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8075","id":1636877192,"node_id":"IC_kwDOCW7NX85hkMOI","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-15T20:10:38Z","updated_at":"2023-07-15T20:10:38Z","author_association":"CONTRIBUTOR","body":"@rustyconover This is great. I'm curious, do you have any numbers on the impact of this change?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636877192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636877973","html_url":"https://github.com/apache/iceberg/pull/8075#issuecomment-1636877973","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8075","id":1636877973,"node_id":"IC_kwDOCW7NX85hkMaV","user":{"login":"rustyconover","id":731941,"node_id":"MDQ6VXNlcjczMTk0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/731941?v=4","gravatar_id":"","url":"https://api.github.com/users/rustyconover","html_url":"https://github.com/rustyconover","followers_url":"https://api.github.com/users/rustyconover/followers","following_url":"https://api.github.com/users/rustyconover/following{/other_user}","gists_url":"https://api.github.com/users/rustyconover/gists{/gist_id}","starred_url":"https://api.github.com/users/rustyconover/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rustyconover/subscriptions","organizations_url":"https://api.github.com/users/rustyconover/orgs","repos_url":"https://api.github.com/users/rustyconover/repos","events_url":"https://api.github.com/users/rustyconover/events{/privacy}","received_events_url":"https://api.github.com/users/rustyconover/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-15T20:14:34Z","updated_at":"2023-07-15T20:14:34Z","author_association":"CONTRIBUTOR","body":"Do you know of a publicly accessible Iceberg table with a large amount of metadata?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636877973/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636879833","html_url":"https://github.com/apache/iceberg/pull/8075#issuecomment-1636879833","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8075","id":1636879833,"node_id":"IC_kwDOCW7NX85hkM3Z","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-15T20:26:04Z","updated_at":"2023-07-15T20:26:04Z","author_association":"CONTRIBUTOR","body":"I use the [`docker-spark-iceberg` docker-compose setup](https://github.com/tabular-io/docker-spark-iceberg). You can easily point to it in your `cat ~/.pyiceberg.yaml`:\r\n\r\n```yaml\r\ndefault-catalog: local\r\n\r\ncatalog:\r\n    local:\r\n        uri: http://127.0.0.1:8181\r\n        s3.endpoint: http://127.0.0.1:9000\r\n        py-io-impl: pyiceberg.io.pyarrow.PyArrowFileIO\r\n        s3.access-key-id: admin\r\n        s3.secret-access-key: password\r\n```\r\n\r\nThe `PyIceberg - Getting Started.ipynb` creates a table of five months of taxi data. You could add more data to it since there is [more](https://github.com/tabular-io/docker-spark-iceberg/blob/main/spark/Dockerfile#L81-L95). Or you could change the daily partitioning to an hourly once, creating a crazy amount of partitions (which Iceberg handles fine but should create large manifest files).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636879833/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636882972","html_url":"https://github.com/apache/iceberg/pull/8075#issuecomment-1636882972","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8075","id":1636882972,"node_id":"IC_kwDOCW7NX85hkNoc","user":{"login":"rustyconover","id":731941,"node_id":"MDQ6VXNlcjczMTk0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/731941?v=4","gravatar_id":"","url":"https://api.github.com/users/rustyconover","html_url":"https://github.com/rustyconover","followers_url":"https://api.github.com/users/rustyconover/followers","following_url":"https://api.github.com/users/rustyconover/following{/other_user}","gists_url":"https://api.github.com/users/rustyconover/gists{/gist_id}","starred_url":"https://api.github.com/users/rustyconover/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rustyconover/subscriptions","organizations_url":"https://api.github.com/users/rustyconover/orgs","repos_url":"https://api.github.com/users/rustyconover/repos","events_url":"https://api.github.com/users/rustyconover/events{/privacy}","received_events_url":"https://api.github.com/users/rustyconover/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-15T20:42:27Z","updated_at":"2023-07-15T20:42:27Z","author_association":"CONTRIBUTOR","body":"I'm testing on a single 8mb Avro file that took 40 seconds to load in the profiler.  With these changes time time is now 32 seconds.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636882972/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636925308","html_url":"https://github.com/apache/iceberg/issues/6604#issuecomment-1636925308","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6604","id":1636925308,"node_id":"IC_kwDOCW7NX85hkX98","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-07-16T00:14:48Z","updated_at":"2023-07-16T00:14:48Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636925308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636925320","html_url":"https://github.com/apache/iceberg/issues/6579#issuecomment-1636925320","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6579","id":1636925320,"node_id":"IC_kwDOCW7NX85hkX-I","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-07-16T00:14:49Z","updated_at":"2023-07-16T00:14:49Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1636925320/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1637091560","html_url":"https://github.com/apache/iceberg/pull/8081#issuecomment-1637091560","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8081","id":1637091560,"node_id":"IC_kwDOCW7NX85hlAjo","user":{"login":"rakesh-das08","id":16017562,"node_id":"MDQ6VXNlcjE2MDE3NTYy","avatar_url":"https://avatars.githubusercontent.com/u/16017562?v=4","gravatar_id":"","url":"https://api.github.com/users/rakesh-das08","html_url":"https://github.com/rakesh-das08","followers_url":"https://api.github.com/users/rakesh-das08/followers","following_url":"https://api.github.com/users/rakesh-das08/following{/other_user}","gists_url":"https://api.github.com/users/rakesh-das08/gists{/gist_id}","starred_url":"https://api.github.com/users/rakesh-das08/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rakesh-das08/subscriptions","organizations_url":"https://api.github.com/users/rakesh-das08/orgs","repos_url":"https://api.github.com/users/rakesh-das08/repos","events_url":"https://api.github.com/users/rakesh-das08/events{/privacy}","received_events_url":"https://api.github.com/users/rakesh-das08/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-16T13:58:37Z","updated_at":"2023-07-16T14:12:49Z","author_association":"CONTRIBUTOR","body":"@nastra , @rdblue, @bitsondatadev, @flyrain , @amogh-jahagirdar, @jackye1995, @aokolnychyi, @ajantha-bhat \r\nCould you please review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1637091560/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1637141671","html_url":"https://github.com/apache/iceberg/pull/8075#issuecomment-1637141671","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8075","id":1637141671,"node_id":"IC_kwDOCW7NX85hlMyn","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-16T17:09:01Z","updated_at":"2023-07-16T17:09:01Z","author_association":"CONTRIBUTOR","body":"Nice, I'm also seeing some speedup:\r\n```\r\nâ  python git:(master) hyperfine --warmup 1 \"python3 /tmp/benchamrk.py\"\r\nBenchmark 1: python3 /tmp/vo.py\r\n  Time (mean Â± Ï):      2.689 s Â±  0.028 s    [User: 2.799 s, System: 1.945 s]\r\n  Range (min â¦ max):    2.659 s â¦  2.756 s    10 runs\r\n \r\nâ  python git:(master) git checkout fix_avro_use_slots\r\nSwitched to branch 'fix_avro_use_slots'\r\nYour branch is up to date with 'rustyconover/fix_avro_use_slots'.\r\nâ  python git:(fix_avro_use_slots) hyperfine --warmup 1 \"python3 /tmp/benchmark.py\"\r\nBenchmark 1: python3 /tmp/vo.py\r\n  Time (mean Â± Ï):      2.194 s Â±  0.013 s    [User: 2.370 s, System: 1.937 s]\r\n  Range (min â¦ max):    2.175 s â¦  2.217 s    10 runs\r\n```\r\n\r\nWhere `benchmark.py`:\r\n\r\n```python\r\nfrom pyiceberg.catalog import load_catalog\r\nfrom pyiceberg.expressions import GreaterThanOrEqual, LessThan, And\r\n\r\ncatalog = load_catalog('local')\r\n\r\ntable = catalog.load_table('nyc.taxis')\r\n\r\nexpected_rows = 63454\r\n\r\ndf = table.scan(row_filter=And(\r\n        GreaterThanOrEqual(\"tpep_pickup_datetime\", \"2022-01-01T00:00:00.000000+00:00\"),\r\n        LessThan(\"tpep_pickup_datetime\", \"2022-01-02T00:00:00.000000+00:00\"),\r\n)).to_arrow()\r\n\r\nassert len(df) == expected_rows, f\"Got {len(df)} rows, instead of {expected_rows}\"\r\n```\r\n\r\nThis is the taxi dataset with one year of data, and hourly partitioned (~160kb manifest files).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1637141671/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1637220140","html_url":"https://github.com/apache/iceberg/pull/7694#issuecomment-1637220140","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7694","id":1637220140,"node_id":"IC_kwDOCW7NX85hlf8s","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-16T23:50:46Z","updated_at":"2023-07-16T23:50:46Z","author_association":"CONTRIBUTOR","body":"It's great to see progress on replacing the existing solution, so thank you for putting this up.\r\n\r\nI want to jump in quickly to just remind everyone about our ASF responsibilities. We need to have accurate LICENSE and NOTICE documentation for all release artifacts, including each Jar. Changes like this can easily alter what is included in the binary Jars so we must validate that these changes produce no changes to the Jars themselves before merging this. @nastra, please keep an eye on this before it goes in to check that's the case.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1637220140/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1637227111","html_url":"https://github.com/apache/iceberg/issues/6613#issuecomment-1637227111","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6613","id":1637227111,"node_id":"IC_kwDOCW7NX85hlhpn","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-07-17T00:14:39Z","updated_at":"2023-07-17T00:14:39Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1637227111/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1637312031","html_url":"https://github.com/apache/iceberg/pull/8084#issuecomment-1637312031","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8084","id":1637312031,"node_id":"IC_kwDOCW7NX85hl2Yf","user":{"login":"rustyconover","id":731941,"node_id":"MDQ6VXNlcjczMTk0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/731941?v=4","gravatar_id":"","url":"https://api.github.com/users/rustyconover","html_url":"https://github.com/rustyconover","followers_url":"https://api.github.com/users/rustyconover/followers","following_url":"https://api.github.com/users/rustyconover/following{/other_user}","gists_url":"https://api.github.com/users/rustyconover/gists{/gist_id}","starred_url":"https://api.github.com/users/rustyconover/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rustyconover/subscriptions","organizations_url":"https://api.github.com/users/rustyconover/orgs","repos_url":"https://api.github.com/users/rustyconover/repos","events_url":"https://api.github.com/users/rustyconover/events{/privacy}","received_events_url":"https://api.github.com/users/rustyconover/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-17T03:01:24Z","updated_at":"2023-07-17T03:01:24Z","author_association":"CONTRIBUTOR","body":"Some benchmark results\r\n\r\n```\r\n# Main branch\r\n$ hyperfine \"python3 measure.py\"\r\nBenchmark 1: python3 measure.py\r\n  Time (mean Â± Ï):      8.340 s Â±  0.113 s    [User: 8.598 s, System: 0.563 s]\r\n  Range (min â¦ max):    8.161 s â¦  8.484 s    10 runs\r\n \r\n# With this PR\r\n$ hyperfine \"python3 measure.py\"\r\nBenchmark 1: python3 measure.py\r\n  Time (mean Â± Ï):      4.565 s Â±  0.032 s    [User: 4.854 s, System: 0.536 s]\r\n  Range (min â¦ max):    4.520 s â¦  4.607 s    10 runs\r\n```\r\n\r\nSeems to be about a 46% decrease in run time to parse my test Avro file.\r\n\r\nThis is still pure-python.\r\n\r\nAfter this PR applied here is the current profiler output for my test file.  The profiler does slow things down.\r\n\r\n```\r\n         9888710 function calls (9858577 primitive calls) in 10.129 seconds\r\n\r\n   Ordered by: internal time\r\n   List reduced from 256 to 100 due to restriction <100>\r\n\r\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\r\n  8125697    6.257    0.000    6.257    0.000 /Users/rusty/Development/iceberg/python/pyiceberg/avro/decoder.py:287(read_int)\r\n    36357    1.672    0.000    6.652    0.000 /Users/rusty/Development/iceberg/python/pyiceberg/avro/decoder.py:77(read_int_int_dict)\r\n    24238    0.744    0.000    1.645    0.000 /Users/rusty/Development/iceberg/python/pyiceberg/avro/decoder.py:303(read_int_bytes_dict)\r\n42934/14312    0.268    0.000    9.851    0.001 /Users/rusty/Development/iceberg/python/pyiceberg/avro/reader.py:310(read)\r\n   343467    0.148    0.000    0.290    0.000 /Users/rusty/Development/iceberg/python/pyiceberg/typedef.py:155(__setitem__)\r\n   214665    0.147    0.000    8.957    0.000 /Users/rusty/Development/iceberg/python/pyiceberg/avro/reader.py:250(read)\r\n   257599    0.143    0.000    0.151    0.000 /Users/rusty/Development/iceberg/python/pyiceberg/manifest.py:204(__setattr__)\r\n        1    0.101    0.101   10.129   10.129 <string>:1(<module>)\r\n      551    0.093    0.000    0.093    0.000 {built-in method zlib.decompress}\r\n    85867    0.092    0.000    8.468    0.000 /Users/rusty/Development/iceberg/python/pyiceberg/avro/reader.py:392(read)\r\n    42938    0.066    0.000    0.115    0.000 /Users/rusty/Development/iceberg/python/pyiceberg/typedef.py:137(__init__)\r\n    57244    0.049    0.000    0.083    0.000 /Users/rusty/Development/iceberg/python/pyiceberg/avro/decoder.py:315(read_bytes)\r\n    14312    0.046    0.000    0.083    0.000 /Users/rusty/Development/iceberg/python/pyiceberg/manifest.py:245(__init__)\r\n    57260    0.042    0.000    0.138    0.000 /Users/rusty/Development/iceberg/python/pyiceberg/avro/decoder.py:133(read_utf8)\r\n   114488    0.041    0.000    0.185    0.000 /Users/rusty/Development/iceberg/python/pyiceberg/avro/reader.py:132(read)\r\n    57260    0.022    0.000    0.160    0.000 /Users/rusty/Development/iceberg/python/pyiceberg/avro/reader.py:188(read)\r\n    43007    0.019    0.000    0.026    0.000 {built-in method builtins.hash}\r\n    14311    0.017    0.000    0.051    0.000 /Users/rusty/Development/iceberg/python/pyiceberg/avro/reader.py:353(read)\r\n    14312    0.015    0.000    0.062    0.000 /Users/rusty/Development/iceberg/python/pyiceberg/manifest.py:211(__init__)\r\n    14311    0.015    0.000    9.868    0.001 /Users/rusty/Development/iceberg/python/pyiceberg/avro/file.py:123(__next__)\r\n    12119    0.014    0.000    0.022    0.000 /Users/rusty/Development/iceberg/python/pyiceberg/avro/decoder.py:72(read_ints)\r\n```\r\n\r\nI have a single table that has about uses 100 Avro files of this complexity, so more improvements are still desired.\r\n\r\nA few things about this test Avro file, contains references to 14,000 MetadataFiles and the table has >200 columns.\r\n\r\nThere are few ideas to pursue:\r\n\r\n1. Implement Cython for parsing integers.  Replace `decoder::read_int` with this the Cython implementation for the InMemoryBinaryDecoder.\r\n2. Defer parsing maps and lists until they are accessed, keep their byte representation in memory and when the actual values are requested deserialize them.  This would be helpful for common cases where not all min/max values are required.  There is currently a problem with skipping maps and lists, the Iceberg serialization code does not use the proper Avro encoder it uses [directBinaryEncoder](https://avro.apache.org/docs/1.7.4/api/java/org/apache/avro/io/DirectBinaryEncoder.html) rather than [blockingBinaryEncoder](https://avro.apache.org/docs/1.7.4/api/java/org/apache/avro/io/BlockingBinaryEncoder.html) which buffers data and writes byte sizes after the Avro block size.  See \r\n[IcebergEncoder.java](https://github.com/apache/iceberg/blame/cdbaf5754e0cd2ee7439a1d94cb4cfc92fc29731/core/src/main/java/org/apache/iceberg/data/avro/IcebergEncoder.java#L101), [KeyMetadataEncoder.java](https://github.com/apache/iceberg/blob/cdbaf5754e0cd2ee7439a1d94cb4cfc92fc29731/core/src/main/java/org/apache/iceberg/encryption/KeyMetadataEncoder.java#L93) and [AvroEncoderUtil.java](https://github.com/apache/iceberg/blob/cdbaf5754e0cd2ee7439a1d94cb4cfc92fc29731/core/src/main/java/org/apache/iceberg/avro/AvroEncoderUtil.java#L57) for examples where the Avro encoder is specified.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1637312031/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1637700674","html_url":"https://github.com/apache/iceberg/pull/7694#issuecomment-1637700674","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7694","id":1637700674,"node_id":"IC_kwDOCW7NX85hnVRC","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-17T09:38:15Z","updated_at":"2023-07-17T09:38:15Z","author_association":"MEMBER","body":"The current state LGTM (despite the CI errors, which look like these are caused by typos in this change)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1637700674/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1637953253","html_url":"https://github.com/apache/iceberg/issues/3494#issuecomment-1637953253","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3494","id":1637953253,"node_id":"IC_kwDOCW7NX85hoS7l","user":{"login":"atifiu","id":48252551,"node_id":"MDQ6VXNlcjQ4MjUyNTUx","avatar_url":"https://avatars.githubusercontent.com/u/48252551?v=4","gravatar_id":"","url":"https://api.github.com/users/atifiu","html_url":"https://github.com/atifiu","followers_url":"https://api.github.com/users/atifiu/followers","following_url":"https://api.github.com/users/atifiu/following{/other_user}","gists_url":"https://api.github.com/users/atifiu/gists{/gist_id}","starred_url":"https://api.github.com/users/atifiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/atifiu/subscriptions","organizations_url":"https://api.github.com/users/atifiu/orgs","repos_url":"https://api.github.com/users/atifiu/repos","events_url":"https://api.github.com/users/atifiu/events{/privacy}","received_events_url":"https://api.github.com/users/atifiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-17T11:37:14Z","updated_at":"2023-07-17T11:37:14Z","author_association":"NONE","body":"@RussellSpitzer This approach doesn't help me much because I have filter criteria on other columns which I have included in sort order while writing the data files. If I sort on timestamp column without days or hours, within each file other filter column values are present and if I use date then it is same as previously i.e. two partitions are read. Please suggest ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1637953253/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1637972370","html_url":"https://github.com/apache/iceberg/issues/3494#issuecomment-1637972370","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3494","id":1637972370,"node_id":"IC_kwDOCW7NX85hoXmS","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-17T11:51:38Z","updated_at":"2023-07-17T11:51:38Z","author_association":"MEMBER","body":"I don't understand your comment, you sort on the time stamp and then your others columns ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1637972370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1637972926","html_url":"https://github.com/apache/iceberg/issues/3494#issuecomment-1637972926","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3494","id":1637972926,"node_id":"IC_kwDOCW7NX85hoXu-","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-17T11:52:07Z","updated_at":"2023-07-17T11:52:07Z","author_association":"MEMBER","body":"If you have so much data that this is still an issue just partition on hour","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1637972926/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1637986729","html_url":"https://github.com/apache/iceberg/issues/3494#issuecomment-1637986729","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3494","id":1637986729,"node_id":"IC_kwDOCW7NX85hobGp","user":{"login":"atifiu","id":48252551,"node_id":"MDQ6VXNlcjQ4MjUyNTUx","avatar_url":"https://avatars.githubusercontent.com/u/48252551?v=4","gravatar_id":"","url":"https://api.github.com/users/atifiu","html_url":"https://github.com/atifiu","followers_url":"https://api.github.com/users/atifiu/followers","following_url":"https://api.github.com/users/atifiu/following{/other_user}","gists_url":"https://api.github.com/users/atifiu/gists{/gist_id}","starred_url":"https://api.github.com/users/atifiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/atifiu/subscriptions","organizations_url":"https://api.github.com/users/atifiu/orgs","repos_url":"https://api.github.com/users/atifiu/repos","events_url":"https://api.github.com/users/atifiu/events{/privacy}","received_events_url":"https://api.github.com/users/atifiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-17T12:01:15Z","updated_at":"2023-07-17T12:01:15Z","author_association":"NONE","body":"Existing sort order col1, col2, col3 and daily partition on timestamp column. After your suggestion my new sort order timestamp, col1, col2, col3. While my filter criteria is partition column with 24 hour range i.e one full day and then col1, col2, col3. I dont really want to change my partition spec because it means too many partition approx 2 yrs data 730x24 = 17520 partitions. Will this not impact performance adversely ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1637986729/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1638112482","html_url":"https://github.com/apache/iceberg/pull/7996#issuecomment-1638112482","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7996","id":1638112482,"node_id":"IC_kwDOCW7NX85ho5zi","user":{"login":"skytin1004","id":99078115,"node_id":"U_kgDOBefP4w","avatar_url":"https://avatars.githubusercontent.com/u/99078115?v=4","gravatar_id":"","url":"https://api.github.com/users/skytin1004","html_url":"https://github.com/skytin1004","followers_url":"https://api.github.com/users/skytin1004/followers","following_url":"https://api.github.com/users/skytin1004/following{/other_user}","gists_url":"https://api.github.com/users/skytin1004/gists{/gist_id}","starred_url":"https://api.github.com/users/skytin1004/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skytin1004/subscriptions","organizations_url":"https://api.github.com/users/skytin1004/orgs","repos_url":"https://api.github.com/users/skytin1004/repos","events_url":"https://api.github.com/users/skytin1004/events{/privacy}","received_events_url":"https://api.github.com/users/skytin1004/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-17T13:10:38Z","updated_at":"2023-07-17T13:11:08Z","author_association":"CONTRIBUTOR","body":"> I think SparkDeltaLakeSnapshotTestBase / TestSnapshotDeltaLakeTable are still missing\r\n\r\nI will replace SparkDeltaLakeSnapshotTestBase / TestSnapshotDeltaLakeTable with JUnit5.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1638112482/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1638201238","html_url":"https://github.com/apache/iceberg/issues/3494#issuecomment-1638201238","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3494","id":1638201238,"node_id":"IC_kwDOCW7NX85hpPeW","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-17T13:56:24Z","updated_at":"2023-07-17T13:56:24Z","author_association":"MEMBER","body":"Depends on how much data you have, if you don't have enough data for that many partitions you probably aren't benefiting from all those sort columns either. Also if you don't have enough data to make multiple files in each \"day\" partition it's probably fine to just do nothing. Reading 2 files is not that much worse than reading one in most distributed engines.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1638201238/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1638235406","html_url":"https://github.com/apache/iceberg/pull/8061#issuecomment-1638235406","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8061","id":1638235406,"node_id":"IC_kwDOCW7NX85hpX0O","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-17T14:13:25Z","updated_at":"2023-07-17T14:13:25Z","author_association":"CONTRIBUTOR","body":"Thanks for fixing this @mr-brobot, and looking forward to your use-case using AWS Lambda's","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1638235406/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1638361740","html_url":"https://github.com/apache/iceberg/issues/3494#issuecomment-1638361740","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3494","id":1638361740,"node_id":"IC_kwDOCW7NX85hp2qM","user":{"login":"atifiu","id":48252551,"node_id":"MDQ6VXNlcjQ4MjUyNTUx","avatar_url":"https://avatars.githubusercontent.com/u/48252551?v=4","gravatar_id":"","url":"https://api.github.com/users/atifiu","html_url":"https://github.com/atifiu","followers_url":"https://api.github.com/users/atifiu/followers","following_url":"https://api.github.com/users/atifiu/following{/other_user}","gists_url":"https://api.github.com/users/atifiu/gists{/gist_id}","starred_url":"https://api.github.com/users/atifiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/atifiu/subscriptions","organizations_url":"https://api.github.com/users/atifiu/orgs","repos_url":"https://api.github.com/users/atifiu/repos","events_url":"https://api.github.com/users/atifiu/events{/privacy}","received_events_url":"https://api.github.com/users/atifiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-17T15:18:41Z","updated_at":"2023-07-17T15:18:41Z","author_association":"NONE","body":"@RussellSpitzer I have approx 200 million rows for single day with 200 files for each day. Each file has size of approx 300mb. Query will be generally for a single day with additional filter criteria.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1638361740/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1638564485","html_url":"https://github.com/apache/iceberg/issues/7774#issuecomment-1638564485","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7774","id":1638564485,"node_id":"IC_kwDOCW7NX85hqoKF","user":{"login":"ZachDischner","id":1893326,"node_id":"MDQ6VXNlcjE4OTMzMjY=","avatar_url":"https://avatars.githubusercontent.com/u/1893326?v=4","gravatar_id":"","url":"https://api.github.com/users/ZachDischner","html_url":"https://github.com/ZachDischner","followers_url":"https://api.github.com/users/ZachDischner/followers","following_url":"https://api.github.com/users/ZachDischner/following{/other_user}","gists_url":"https://api.github.com/users/ZachDischner/gists{/gist_id}","starred_url":"https://api.github.com/users/ZachDischner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ZachDischner/subscriptions","organizations_url":"https://api.github.com/users/ZachDischner/orgs","repos_url":"https://api.github.com/users/ZachDischner/repos","events_url":"https://api.github.com/users/ZachDischner/events{/privacy}","received_events_url":"https://api.github.com/users/ZachDischner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-17T17:22:15Z","updated_at":"2023-07-17T17:22:15Z","author_association":"NONE","body":"I am seeing this behavior specifically when attempting to query the `.files` metadata table in Iceberg. \r\n\r\nWhen running against a table created with Iceberg 1.1.0, querying the `partitions` struct does not seem to work when I upgrade to spark 3.4.\r\n\r\n```\r\nspark-shell --packages \"org.apache.spark:spark-sql_2.13:3.3.1,org.apache.iceberg:iceberg-spark-runtime-3.4_2.12:1.3.0,org.apache.iceberg:iceberg-aws:1.1.0,org.apache.iceberg:iceberg-core:1.1.0\r\n<--conf for existing Iceberg 1.1.0 table>\r\n```\r\n\r\nExample query:\r\n```\r\nSELECT * FROM catalog.db.table.files where partition.myPartitionName = ...\r\n\r\n\r\n23/07/13 13:26:48 WARN SparkScanBuilder: Failed to check if IsNotNull(partition.myPartitionName) can be pushed down: Cannot find field 'partition.myPartitionName' in struct: struct<>\r\n23/07/13 13:26:48 WARN SparkScanBuilder: Failed to check if GreaterThanOrEqual(partition.myPartitionName,2023-07-03T00:00:00Z) can be pushed down: Cannot find field 'partition.myPartitionName' in struct: struct<>\r\n```\r\n\r\nhttps://iceberg.apache.org/docs/latest/spark-queries/#files - `partition` is a struct. It appears as though we cannot push down predicates in spark to query against this field. This impacts reading and writing. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1638564485/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1638594488","html_url":"https://github.com/apache/iceberg/issues/8089#issuecomment-1638594488","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8089","id":1638594488,"node_id":"IC_kwDOCW7NX85hqve4","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-17T17:44:42Z","updated_at":"2023-07-17T17:46:07Z","author_association":"CONTRIBUTOR","body":"cc @jun-he @aokolnychyi @RussellSpitzer @szehon-ho ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1638594488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1638678182","html_url":"https://github.com/apache/iceberg/issues/7774#issuecomment-1638678182","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7774","id":1638678182,"node_id":"IC_kwDOCW7NX85hrD6m","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-17T18:41:00Z","updated_at":"2023-07-17T18:41:00Z","author_association":"COLLABORATOR","body":"Yea this sounds like a regression.  (Though there may be several problems listed here).  A bit preoccupied at the moment, but will take a look , at least starting from files table, when I get a chance.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1638678182/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1638722592","html_url":"https://github.com/apache/iceberg/issues/3494#issuecomment-1638722592","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3494","id":1638722592,"node_id":"IC_kwDOCW7NX85hrOwg","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-17T19:11:17Z","updated_at":"2023-07-17T19:11:17Z","author_association":"MEMBER","body":"If you have 200 files per day, you will be fine with \"Hours\" the number of partitions is really not as important as file size and 200/ 24 > 1 which means you should have no problem","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1638722592/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1638747508","html_url":"https://github.com/apache/iceberg/issues/3494#issuecomment-1638747508","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3494","id":1638747508,"node_id":"IC_kwDOCW7NX85hrU10","user":{"login":"atifiu","id":48252551,"node_id":"MDQ6VXNlcjQ4MjUyNTUx","avatar_url":"https://avatars.githubusercontent.com/u/48252551?v=4","gravatar_id":"","url":"https://api.github.com/users/atifiu","html_url":"https://github.com/atifiu","followers_url":"https://api.github.com/users/atifiu/followers","following_url":"https://api.github.com/users/atifiu/following{/other_user}","gists_url":"https://api.github.com/users/atifiu/gists{/gist_id}","starred_url":"https://api.github.com/users/atifiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/atifiu/subscriptions","organizations_url":"https://api.github.com/users/atifiu/orgs","repos_url":"https://api.github.com/users/atifiu/repos","events_url":"https://api.github.com/users/atifiu/events{/privacy}","received_events_url":"https://api.github.com/users/atifiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-17T19:30:58Z","updated_at":"2023-07-17T19:30:58Z","author_association":"NONE","body":"@RussellSpitzer Really appreciate your help. I got your point now. Just one final advice I need, what should be more ideal solution, partition with lesser number of bigger files or partition with more number of smaller files ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1638747508/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1638755071","html_url":"https://github.com/apache/iceberg/issues/3494#issuecomment-1638755071","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3494","id":1638755071,"node_id":"IC_kwDOCW7NX85hrWr_","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-17T19:36:59Z","updated_at":"2023-07-17T19:36:59Z","author_association":"MEMBER","body":"In Iceberg partitions are really just tuples associated with file metadata, so number of partitions really doesn't matter except as it defines file size.  In general, you want files between 128 - 512 (or some multiple of your row group size). The opening file cost is different in different file systems and some have better performance with smaller vs larger files. \r\n\r\nThose partition tuples though are used during queries, so I think you generally want the most granular partitioning you can get so you can support more types of queries. Like I mentioned above, you can get similar effects though with sorting although that tends to me a little more expensive at write time or by doing sort optimizes.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1638755071/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639031874","html_url":"https://github.com/apache/iceberg/pull/8042#issuecomment-1639031874","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8042","id":1639031874,"node_id":"IC_kwDOCW7NX85hsaRC","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-17T23:29:57Z","updated_at":"2023-07-17T23:29:57Z","author_association":"CONTRIBUTOR","body":"LGTM. cc @RussellSpitzer @aokolnychyi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639031874/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639073830","html_url":"https://github.com/apache/iceberg/issues/6455#issuecomment-1639073830","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6455","id":1639073830,"node_id":"IC_kwDOCW7NX85hskgm","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T00:19:56Z","updated_at":"2023-07-18T00:19:56Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639073830/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639163691","html_url":"https://github.com/apache/iceberg/issues/7040#issuecomment-1639163691","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7040","id":1639163691,"node_id":"IC_kwDOCW7NX85hs6cr","user":{"login":"tobehardest","id":88612778,"node_id":"MDQ6VXNlcjg4NjEyNzc4","avatar_url":"https://avatars.githubusercontent.com/u/88612778?v=4","gravatar_id":"","url":"https://api.github.com/users/tobehardest","html_url":"https://github.com/tobehardest","followers_url":"https://api.github.com/users/tobehardest/followers","following_url":"https://api.github.com/users/tobehardest/following{/other_user}","gists_url":"https://api.github.com/users/tobehardest/gists{/gist_id}","starred_url":"https://api.github.com/users/tobehardest/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tobehardest/subscriptions","organizations_url":"https://api.github.com/users/tobehardest/orgs","repos_url":"https://api.github.com/users/tobehardest/repos","events_url":"https://api.github.com/users/tobehardest/events{/privacy}","received_events_url":"https://api.github.com/users/tobehardest/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T02:00:05Z","updated_at":"2023-07-18T02:00:05Z","author_association":"NONE","body":"Yes, I am on.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639163691/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639164139","html_url":"https://github.com/apache/iceberg/issues/7040#issuecomment-1639164139","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7040","id":1639164139,"node_id":"IC_kwDOCW7NX85hs6jr","user":{"login":"tobehardest","id":88612778,"node_id":"MDQ6VXNlcjg4NjEyNzc4","avatar_url":"https://avatars.githubusercontent.com/u/88612778?v=4","gravatar_id":"","url":"https://api.github.com/users/tobehardest","html_url":"https://github.com/tobehardest","followers_url":"https://api.github.com/users/tobehardest/followers","following_url":"https://api.github.com/users/tobehardest/following{/other_user}","gists_url":"https://api.github.com/users/tobehardest/gists{/gist_id}","starred_url":"https://api.github.com/users/tobehardest/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tobehardest/subscriptions","organizations_url":"https://api.github.com/users/tobehardest/orgs","repos_url":"https://api.github.com/users/tobehardest/repos","events_url":"https://api.github.com/users/tobehardest/events{/privacy}","received_events_url":"https://api.github.com/users/tobehardest/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T02:00:51Z","updated_at":"2023-07-18T02:00:51Z","author_association":"NONE","body":"My name inside is, Yikun Chen.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639164139/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639187888","html_url":"https://github.com/apache/iceberg/pull/8081#issuecomment-1639187888","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8081","id":1639187888,"node_id":"IC_kwDOCW7NX85htAWw","user":{"login":"zinking","id":118241,"node_id":"MDQ6VXNlcjExODI0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/118241?v=4","gravatar_id":"","url":"https://api.github.com/users/zinking","html_url":"https://github.com/zinking","followers_url":"https://api.github.com/users/zinking/followers","following_url":"https://api.github.com/users/zinking/following{/other_user}","gists_url":"https://api.github.com/users/zinking/gists{/gist_id}","starred_url":"https://api.github.com/users/zinking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zinking/subscriptions","organizations_url":"https://api.github.com/users/zinking/orgs","repos_url":"https://api.github.com/users/zinking/repos","events_url":"https://api.github.com/users/zinking/events{/privacy}","received_events_url":"https://api.github.com/users/zinking/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T02:33:38Z","updated_at":"2023-07-18T02:33:38Z","author_association":"CONTRIBUTOR","body":"can we provide more context in the issue or PR description so that I don't need to go to slack? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639187888/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639226808","html_url":"https://github.com/apache/iceberg/pull/8023#issuecomment-1639226808","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8023","id":1639226808,"node_id":"IC_kwDOCW7NX85htJ24","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T02:57:10Z","updated_at":"2023-07-18T02:57:10Z","author_association":"CONTRIBUTOR","body":"Hi, @nastra @zinking @Fokko would you mind taking another look at this? Thanks in advance.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639226808/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639231957","html_url":"https://github.com/apache/iceberg/pull/8023#issuecomment-1639231957","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8023","id":1639231957,"node_id":"IC_kwDOCW7NX85htLHV","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T03:00:05Z","updated_at":"2023-07-18T03:00:05Z","author_association":"CONTRIBUTOR","body":"Also cc @jackye1995 @amogh-jahagirdar who have disscuessed this at #6736","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639231957/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639452443","html_url":"https://github.com/apache/iceberg/pull/7382#issuecomment-1639452443","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7382","id":1639452443,"node_id":"IC_kwDOCW7NX85huA8b","user":{"login":"manuzhang","id":1191767,"node_id":"MDQ6VXNlcjExOTE3Njc=","avatar_url":"https://avatars.githubusercontent.com/u/1191767?v=4","gravatar_id":"","url":"https://api.github.com/users/manuzhang","html_url":"https://github.com/manuzhang","followers_url":"https://api.github.com/users/manuzhang/followers","following_url":"https://api.github.com/users/manuzhang/following{/other_user}","gists_url":"https://api.github.com/users/manuzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/manuzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manuzhang/subscriptions","organizations_url":"https://api.github.com/users/manuzhang/orgs","repos_url":"https://api.github.com/users/manuzhang/repos","events_url":"https://api.github.com/users/manuzhang/events{/privacy}","received_events_url":"https://api.github.com/users/manuzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T04:47:36Z","updated_at":"2023-07-18T04:47:36Z","author_association":"COLLABORATOR","body":"@hililiwei @nastra @stevenzwu @bitsondatadev ping again.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639452443/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639454331","html_url":"https://github.com/apache/iceberg/pull/7653#issuecomment-1639454331","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7653","id":1639454331,"node_id":"IC_kwDOCW7NX85huBZ7","user":{"login":"manuzhang","id":1191767,"node_id":"MDQ6VXNlcjExOTE3Njc=","avatar_url":"https://avatars.githubusercontent.com/u/1191767?v=4","gravatar_id":"","url":"https://api.github.com/users/manuzhang","html_url":"https://github.com/manuzhang","followers_url":"https://api.github.com/users/manuzhang/followers","following_url":"https://api.github.com/users/manuzhang/following{/other_user}","gists_url":"https://api.github.com/users/manuzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/manuzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manuzhang/subscriptions","organizations_url":"https://api.github.com/users/manuzhang/orgs","repos_url":"https://api.github.com/users/manuzhang/repos","events_url":"https://api.github.com/users/manuzhang/events{/privacy}","received_events_url":"https://api.github.com/users/manuzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T04:48:30Z","updated_at":"2023-07-18T04:48:30Z","author_association":"COLLABORATOR","body":"Any more comments here?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639454331/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639528371","html_url":"https://github.com/apache/iceberg/issues/8085#issuecomment-1639528371","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8085","id":1639528371,"node_id":"IC_kwDOCW7NX85huTez","user":{"login":"rakesh-das08","id":16017562,"node_id":"MDQ6VXNlcjE2MDE3NTYy","avatar_url":"https://avatars.githubusercontent.com/u/16017562?v=4","gravatar_id":"","url":"https://api.github.com/users/rakesh-das08","html_url":"https://github.com/rakesh-das08","followers_url":"https://api.github.com/users/rakesh-das08/followers","following_url":"https://api.github.com/users/rakesh-das08/following{/other_user}","gists_url":"https://api.github.com/users/rakesh-das08/gists{/gist_id}","starred_url":"https://api.github.com/users/rakesh-das08/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rakesh-das08/subscriptions","organizations_url":"https://api.github.com/users/rakesh-das08/orgs","repos_url":"https://api.github.com/users/rakesh-das08/repos","events_url":"https://api.github.com/users/rakesh-das08/events{/privacy}","received_events_url":"https://api.github.com/users/rakesh-das08/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T05:52:18Z","updated_at":"2023-07-18T05:52:18Z","author_association":"CONTRIBUTOR","body":"I will raise a PR to fix this bug","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639528371/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":2,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639610871","html_url":"https://github.com/apache/iceberg/pull/8023#issuecomment-1639610871","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8023","id":1639610871,"node_id":"IC_kwDOCW7NX85hunn3","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T06:57:11Z","updated_at":"2023-07-18T06:57:11Z","author_association":"CONTRIBUTOR","body":"@ConeyLiu I think this is a great topic to mention on the DEV mailist list & Iceberg Sync, so that people are aware about this effort","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639610871/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639611847","html_url":"https://github.com/apache/iceberg/pull/5984#issuecomment-1639611847","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5984","id":1639611847,"node_id":"IC_kwDOCW7NX85hun3H","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T06:58:05Z","updated_at":"2023-07-18T06:58:05Z","author_association":"CONTRIBUTOR","body":"> @hililiwei could you please rebase onto latest master?\r\n\r\nDone.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639611847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639643076","html_url":"https://github.com/apache/iceberg/pull/8049#issuecomment-1639643076","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8049","id":1639643076,"node_id":"IC_kwDOCW7NX85huvfE","user":{"login":"ktk1012","id":11807027,"node_id":"MDQ6VXNlcjExODA3MDI3","avatar_url":"https://avatars.githubusercontent.com/u/11807027?v=4","gravatar_id":"","url":"https://api.github.com/users/ktk1012","html_url":"https://github.com/ktk1012","followers_url":"https://api.github.com/users/ktk1012/followers","following_url":"https://api.github.com/users/ktk1012/following{/other_user}","gists_url":"https://api.github.com/users/ktk1012/gists{/gist_id}","starred_url":"https://api.github.com/users/ktk1012/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktk1012/subscriptions","organizations_url":"https://api.github.com/users/ktk1012/orgs","repos_url":"https://api.github.com/users/ktk1012/repos","events_url":"https://api.github.com/users/ktk1012/events{/privacy}","received_events_url":"https://api.github.com/users/ktk1012/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T07:20:05Z","updated_at":"2023-07-18T07:20:05Z","author_association":"CONTRIBUTOR","body":"@Fokko Thank you for reply, I saw referenced PR. It would be more proper that handle optional field correctly, I'll close this PR","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639643076/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639644419","html_url":"https://github.com/apache/iceberg/issues/8013#issuecomment-1639644419","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8013","id":1639644419,"node_id":"IC_kwDOCW7NX85huv0D","user":{"login":"ktk1012","id":11807027,"node_id":"MDQ6VXNlcjExODA3MDI3","avatar_url":"https://avatars.githubusercontent.com/u/11807027?v=4","gravatar_id":"","url":"https://api.github.com/users/ktk1012","html_url":"https://github.com/ktk1012","followers_url":"https://api.github.com/users/ktk1012/followers","following_url":"https://api.github.com/users/ktk1012/following{/other_user}","gists_url":"https://api.github.com/users/ktk1012/gists{/gist_id}","starred_url":"https://api.github.com/users/ktk1012/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktk1012/subscriptions","organizations_url":"https://api.github.com/users/ktk1012/orgs","repos_url":"https://api.github.com/users/ktk1012/repos","events_url":"https://api.github.com/users/ktk1012/events{/privacy}","received_events_url":"https://api.github.com/users/ktk1012/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T07:21:08Z","updated_at":"2023-07-18T07:21:08Z","author_association":"CONTRIBUTOR","body":"I'll close this issue, #8050 will resolve it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639644419/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639667617","html_url":"https://github.com/apache/iceberg/pull/7362#issuecomment-1639667617","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7362","id":1639667617,"node_id":"IC_kwDOCW7NX85hu1eh","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T07:35:40Z","updated_at":"2023-07-18T07:35:40Z","author_association":"CONTRIBUTOR","body":"Could you take an other look? @pvary ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639667617/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639668488","html_url":"https://github.com/apache/iceberg/pull/7294#issuecomment-1639668488","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7294","id":1639668488,"node_id":"IC_kwDOCW7NX85hu1sI","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T07:36:23Z","updated_at":"2023-07-18T07:36:23Z","author_association":"CONTRIBUTOR","body":"cc @amogh-jahagirdar @jackye1995 could please take a look when you have chance?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639668488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639670981","html_url":"https://github.com/apache/iceberg/pull/6732#issuecomment-1639670981","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6732","id":1639670981,"node_id":"IC_kwDOCW7NX85hu2TF","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T07:37:40Z","updated_at":"2023-07-18T07:37:40Z","author_association":"CONTRIBUTOR","body":"ping @nastra @aokolnychyi ð ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639670981/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639674622","html_url":"https://github.com/apache/iceberg/issues/4176#issuecomment-1639674622","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4176","id":1639674622,"node_id":"IC_kwDOCW7NX85hu3L-","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T07:39:46Z","updated_at":"2023-07-18T07:39:46Z","author_association":"CONTRIBUTOR","body":"I've updated the wording in https://github.com/apache/iceberg/pull/8094","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639674622/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639738170","html_url":"https://github.com/apache/iceberg/pull/7653#issuecomment-1639738170","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7653","id":1639738170,"node_id":"IC_kwDOCW7NX85hvGs6","user":{"login":"manuzhang","id":1191767,"node_id":"MDQ6VXNlcjExOTE3Njc=","avatar_url":"https://avatars.githubusercontent.com/u/1191767?v=4","gravatar_id":"","url":"https://api.github.com/users/manuzhang","html_url":"https://github.com/manuzhang","followers_url":"https://api.github.com/users/manuzhang/followers","following_url":"https://api.github.com/users/manuzhang/following{/other_user}","gists_url":"https://api.github.com/users/manuzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/manuzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manuzhang/subscriptions","organizations_url":"https://api.github.com/users/manuzhang/orgs","repos_url":"https://api.github.com/users/manuzhang/repos","events_url":"https://api.github.com/users/manuzhang/events{/privacy}","received_events_url":"https://api.github.com/users/manuzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T08:16:27Z","updated_at":"2023-07-18T08:16:27Z","author_association":"COLLABORATOR","body":"@szehon-ho thanks for review. I'll backport #5495 in a follow-up PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639738170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639833202","html_url":"https://github.com/apache/iceberg/pull/8023#issuecomment-1639833202","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8023","id":1639833202,"node_id":"IC_kwDOCW7NX85hvd5y","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T09:06:56Z","updated_at":"2023-07-18T09:06:56Z","author_association":"CONTRIBUTOR","body":"Thanks @nastra, raised the discussion at the dev mail list.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1639833202/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640030223","html_url":"https://github.com/apache/iceberg/pull/8093#issuecomment-1640030223","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8093","id":1640030223,"node_id":"IC_kwDOCW7NX85hwOAP","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T11:19:45Z","updated_at":"2023-07-18T11:19:45Z","author_association":"CONTRIBUTOR","body":"Thanks @snazy and @nastra for the review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640030223/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640049227","html_url":"https://github.com/apache/iceberg/issues/7154#issuecomment-1640049227","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7154","id":1640049227,"node_id":"IC_kwDOCW7NX85hwSpL","user":{"login":"liuxiaocs7","id":42756849,"node_id":"MDQ6VXNlcjQyNzU2ODQ5","avatar_url":"https://avatars.githubusercontent.com/u/42756849?v=4","gravatar_id":"","url":"https://api.github.com/users/liuxiaocs7","html_url":"https://github.com/liuxiaocs7","followers_url":"https://api.github.com/users/liuxiaocs7/followers","following_url":"https://api.github.com/users/liuxiaocs7/following{/other_user}","gists_url":"https://api.github.com/users/liuxiaocs7/gists{/gist_id}","starred_url":"https://api.github.com/users/liuxiaocs7/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liuxiaocs7/subscriptions","organizations_url":"https://api.github.com/users/liuxiaocs7/orgs","repos_url":"https://api.github.com/users/liuxiaocs7/repos","events_url":"https://api.github.com/users/liuxiaocs7/events{/privacy}","received_events_url":"https://api.github.com/users/liuxiaocs7/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T11:34:31Z","updated_at":"2023-07-18T11:34:31Z","author_association":"MEMBER","body":"Hi, @clownxc, any update with this? Hi, @nastra, i want to have to try if no one works on this now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640049227/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640074625","html_url":"https://github.com/apache/iceberg/issues/5626#issuecomment-1640074625","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5626","id":1640074625,"node_id":"IC_kwDOCW7NX85hwY2B","user":{"login":"advancedxy","id":807537,"node_id":"MDQ6VXNlcjgwNzUzNw==","avatar_url":"https://avatars.githubusercontent.com/u/807537?v=4","gravatar_id":"","url":"https://api.github.com/users/advancedxy","html_url":"https://github.com/advancedxy","followers_url":"https://api.github.com/users/advancedxy/followers","following_url":"https://api.github.com/users/advancedxy/following{/other_user}","gists_url":"https://api.github.com/users/advancedxy/gists{/gist_id}","starred_url":"https://api.github.com/users/advancedxy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/advancedxy/subscriptions","organizations_url":"https://api.github.com/users/advancedxy/orgs","repos_url":"https://api.github.com/users/advancedxy/repos","events_url":"https://api.github.com/users/advancedxy/events{/privacy}","received_events_url":"https://api.github.com/users/advancedxy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T11:55:22Z","updated_at":"2023-07-18T11:55:22Z","author_association":"CONTRIBUTOR","body":"> @vamen, you can just add multiple bucket partitions to bucket by more than one column. We chose to do this rather than hash the fields together so they can be used together or independently.\r\n\r\nHi, @rdblue I think we cannot express the same semantic for bucket transform on multiple columns with multiple bucket partitions. \r\n\r\nFor example `bucket(16, id_col, sec_col)` means that we need to bucket the `(id_col, sec_col)` into 16 buckets. If we are going to replace it with `bucket(16, id_col) + bucket(16, sec_col)`, it would create 16 * 16 = 256 buckets. The most similar bucket spec would be `bucket(4, id_col) + bucket(4, sec_col)`, which creates 4 * 4 = 16 buckets. However that assumes the cardinality of bucket columns are balanced. It might also possible be `bucket(2, id_col) + bucket(8, sec_col)`. \r\nDid I miss anything?\r\n\r\nTherefore, I believe it's still valuable to support bucketing on multiple columns, especially for primary key is made of multiple columns. WDYT?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640074625/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640118093","html_url":"https://github.com/apache/iceberg/issues/5626#issuecomment-1640118093","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5626","id":1640118093,"node_id":"IC_kwDOCW7NX85hwjdN","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T12:26:55Z","updated_at":"2023-07-18T12:26:55Z","author_association":"MEMBER","body":"> > @vamen, you can just add multiple bucket partitions to bucket by more than one column. We chose to do this rather than hash the fields together so they can be used together or independently.\r\n> \r\n> Hi, @rdblue I think we cannot express the same semantic for bucket transform on multiple columns with multiple bucket partitions.\r\n> \r\n> For example `bucket(16, id_col, sec_col)` means that we need to bucket the `(id_col, sec_col)` into 16 buckets. If we are going to replace it with `bucket(16, id_col) + bucket(16, sec_col)`, it would create 16 * 16 = 256 buckets. The most similar bucket spec would be `bucket(4, id_col) + bucket(4, sec_col)`, which creates 4 * 4 = 16 buckets. However that assumes the cardinality of bucket columns are balanced. It might also possible be `bucket(2, id_col) + bucket(8, sec_col)`. Did I miss anything?\r\n> \r\n> Therefore, I believe it's still valuable to support bucketing on multiple columns, especially for primary key is made of multiple columns. WDYT?\r\n\r\nOther than being able to do prime numbers of buckets, i'm not sure I see the difference between \r\nBucket(column_a, x) and Bucket(column_b, y)  and Bucket(column_a, column_b, x*y). In the example above I don't think 2, 8 or 4, 4 would actually be distributed differently for normally distributed data. For skewed data they both would still most likely have an issue since only a single bucket would receive skew.\r\n\r\nCould you be a bit more clear?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640118093/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640205717","html_url":"https://github.com/apache/iceberg/issues/5626#issuecomment-1640205717","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5626","id":1640205717,"node_id":"IC_kwDOCW7NX85hw42V","user":{"login":"advancedxy","id":807537,"node_id":"MDQ6VXNlcjgwNzUzNw==","avatar_url":"https://avatars.githubusercontent.com/u/807537?v=4","gravatar_id":"","url":"https://api.github.com/users/advancedxy","html_url":"https://github.com/advancedxy","followers_url":"https://api.github.com/users/advancedxy/followers","following_url":"https://api.github.com/users/advancedxy/following{/other_user}","gists_url":"https://api.github.com/users/advancedxy/gists{/gist_id}","starred_url":"https://api.github.com/users/advancedxy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/advancedxy/subscriptions","organizations_url":"https://api.github.com/users/advancedxy/orgs","repos_url":"https://api.github.com/users/advancedxy/repos","events_url":"https://api.github.com/users/advancedxy/events{/privacy}","received_events_url":"https://api.github.com/users/advancedxy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T13:12:20Z","updated_at":"2023-07-18T13:12:20Z","author_association":"CONTRIBUTOR","body":"> Other than being able to do prime numbers of buckets,\r\n\r\nIt didn't occur to me, thanks for pointing out.\r\n\r\n> In the example above I don't think 2, 8 or 4, 4 would actually be distributed differently for normally distributed data.\r\n\r\nLike you said, for normally distributed data, and to be more precisely, it requires every bucket column to be almost normally distributed. The buckets are more likely to be skewed if any of the bucket column is skewed or has low cardinality. \r\n\r\nHere is an extreme example: suppose col_a is a enum type column, it has finite values, such as 1,2, col_b is a uniformly distributed. Then `bucket(col_a, 4)` is going to have only two non-empty buckets, which means `bucket(col_a, 4) + bucket(col_b, 4)` would have half(2/4) of empty buckets, which I didn't think it's acceptable.  In contrast, for `bucket(col_a, col_b, 16)` its buckets are most likely balanced.\r\n\r\nIn summary, bucketing on multiple data columns makes data distribution more balanced.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640205717/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640326506","html_url":"https://github.com/apache/iceberg/issues/5626#issuecomment-1640326506","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5626","id":1640326506,"node_id":"IC_kwDOCW7NX85hxWVq","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T14:22:36Z","updated_at":"2023-07-18T14:22:36Z","author_association":"MEMBER","body":"The example you give is a problem though regardless of the bucketing function if the number of buckets is ~ = the cardinality of the column (or group of columns). The other thing to note about this example is that we would probably have just as good a distribution of rows if we just bucket'd (col_b,16). If we really wanted to include col_a we would do an identity transform correct?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640326506/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640392900","html_url":"https://github.com/apache/iceberg/pull/8052#issuecomment-1640392900","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8052","id":1640392900,"node_id":"IC_kwDOCW7NX85hxmjE","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T14:58:51Z","updated_at":"2023-07-18T14:58:51Z","author_association":"CONTRIBUTOR","body":"LGTM, thanks @nastra and @singhpk234 for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640392900/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640422971","html_url":"https://github.com/apache/iceberg/pull/6906#issuecomment-1640422971","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6906","id":1640422971,"node_id":"IC_kwDOCW7NX85hxt47","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T15:16:21Z","updated_at":"2023-07-18T15:16:21Z","author_association":"CONTRIBUTOR","body":"@Buktoria Gente ping from my side. Would be great to get this in. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640422971/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640501450","html_url":"https://github.com/apache/iceberg/issues/5626#issuecomment-1640501450","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5626","id":1640501450,"node_id":"IC_kwDOCW7NX85hyBDK","user":{"login":"advancedxy","id":807537,"node_id":"MDQ6VXNlcjgwNzUzNw==","avatar_url":"https://avatars.githubusercontent.com/u/807537?v=4","gravatar_id":"","url":"https://api.github.com/users/advancedxy","html_url":"https://github.com/advancedxy","followers_url":"https://api.github.com/users/advancedxy/followers","following_url":"https://api.github.com/users/advancedxy/following{/other_user}","gists_url":"https://api.github.com/users/advancedxy/gists{/gist_id}","starred_url":"https://api.github.com/users/advancedxy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/advancedxy/subscriptions","organizations_url":"https://api.github.com/users/advancedxy/orgs","repos_url":"https://api.github.com/users/advancedxy/repos","events_url":"https://api.github.com/users/advancedxy/events{/privacy}","received_events_url":"https://api.github.com/users/advancedxy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T15:55:40Z","updated_at":"2023-07-18T15:55:40Z","author_association":"CONTRIBUTOR","body":"> The example you give is a problem though regardless of the bucketing function if the number of buckets is ~ = the cardinality of the column (or group of columns). The other thing to note about this example is that we would probably have just as good a distribution of rows if we just bucket'd (col_b,16). If we really wanted to include col_a we would do an identity transform correct?\r\n\r\nI don't think I made it clearly. Let me try to rephrase it in probability.\r\n\r\nTL;DR: bucket on each column multiplies the skewness between columns, bucket on multiple columns don't, instead it would reduce the skewness in different buckets as it has more entropy and more likely to be balanced.\r\n\r\nTo make the example a bit simple, suppose:\r\n1. we have two columns: col_a and col_b, and we need to create 4 buckets via `bucket(col_a, col_b, 4)`\r\n2. the possibility of `hash(col_a) mod 2 === 0` is `1/3`, `hash(col_a) mod 2 === 1` is `2/3`\r\n3. the possibility of `hash(col_b) mod 2 === 0` is `1/4`, `hash(col_b) mod 2 === 1` is `3/4`\r\n\r\nThen, for partition spec: `bucket(col_a, 2) + bucket(col_b, 2)`, the possibility of each bucket(this is effectively the possible row number of that bucket) is: [1/12, 1/6, 1/4, 1/2](See calculations below).\r\n| c2 - c1 | c1 = 0 | c1 = 1 |\r\n|--------|--------|--------|\r\n| c2 = 0 | 1/3 * 1/4 = 1/12 | 2/3 * 1/4 = 1/6 |\r\n| c2 = 1 | 1/3 * 3/4 = 1/4  | 2/3 * 3/4 = 1/2 |\r\n\r\nWhat about the possibility of each bucket for `bucket(col_a, col_b, 4)`? We may need to add another assumption that:\r\n1. the possibility of `hash(col_a) mod 4 === 0` is `1/6`, `hash(col_a) mod 4 === 1` is `1/3`, `hash(col_a) mod 4 === 2` is `1/6`, `hash(col_a) mod 4 === 3` is `1/3`. (one may argue that the distribution could be in other ways, yeah, that's correct. But this distribution is most likely).\r\n2. the possibility of col_b is likewise.\r\n\r\nThen the possibility of each bucket is: [7/24, 5/24, 7/24, 5/24] (assuming my calculation is correct and I don't miss anything).\r\n![IMG_3608](https://github.com/apache/iceberg/assets/807537/f9358aaa-3f9e-4735-bc12-988488e03606)\r\n\r\nCompare [1/12, 1/6, 1/4, 1/2] vs [7/24, 5/24, 7/24, 5/24], I believe the second one is more balanced.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640501450/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640738766","html_url":"https://github.com/apache/iceberg/pull/8070#issuecomment-1640738766","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8070","id":1640738766,"node_id":"IC_kwDOCW7NX85hy6_O","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T18:27:53Z","updated_at":"2023-07-18T18:27:53Z","author_association":"COLLABORATOR","body":"Thanks for the tips on AssertJ, addressed comments, @dramaticlly @nastra ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640738766/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640973300","html_url":"https://github.com/apache/iceberg/issues/7774#issuecomment-1640973300","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7774","id":1640973300,"node_id":"IC_kwDOCW7NX85hz0P0","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T20:49:40Z","updated_at":"2023-07-18T20:49:40Z","author_association":"COLLABORATOR","body":"I tried a few of these cases (ExpireSnapshot, files table).  I see the predicate pushdown happening.\r\n\r\nI think what may be happening, is you are not using the right Iceberg version for Spark 3.4.  See :  https://github.com/apache/iceberg/tree/1.1.x/spark   Iceberg 1.1 does not have support for Spark 3.4, so maybe it does not understand the Spark 3.4 filters.\r\n\r\nPlease use latest Iceberg.  There's a vote ongoing, that should be done soon, for Iceberg 1.3.1.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640973300/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640979221","html_url":"https://github.com/apache/iceberg/pull/7653#issuecomment-1640979221","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7653","id":1640979221,"node_id":"IC_kwDOCW7NX85hz1sV","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T20:54:51Z","updated_at":"2023-07-18T20:54:51Z","author_association":"COLLABORATOR","body":"Thanks @manuzhang ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640979221/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640981306","html_url":"https://github.com/apache/iceberg/pull/8092#issuecomment-1640981306","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8092","id":1640981306,"node_id":"IC_kwDOCW7NX85hz2M6","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T20:56:40Z","updated_at":"2023-07-18T20:56:40Z","author_association":"COLLABORATOR","body":"Thanks @dramaticlly ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1640981306/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1641002011","html_url":"https://github.com/apache/iceberg/issues/7774#issuecomment-1641002011","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7774","id":1641002011,"node_id":"IC_kwDOCW7NX85hz7Qb","user":{"login":"ZachDischner","id":1893326,"node_id":"MDQ6VXNlcjE4OTMzMjY=","avatar_url":"https://avatars.githubusercontent.com/u/1893326?v=4","gravatar_id":"","url":"https://api.github.com/users/ZachDischner","html_url":"https://github.com/ZachDischner","followers_url":"https://api.github.com/users/ZachDischner/followers","following_url":"https://api.github.com/users/ZachDischner/following{/other_user}","gists_url":"https://api.github.com/users/ZachDischner/gists{/gist_id}","starred_url":"https://api.github.com/users/ZachDischner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ZachDischner/subscriptions","organizations_url":"https://api.github.com/users/ZachDischner/orgs","repos_url":"https://api.github.com/users/ZachDischner/repos","events_url":"https://api.github.com/users/ZachDischner/events{/privacy}","received_events_url":"https://api.github.com/users/ZachDischner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T21:15:28Z","updated_at":"2023-07-18T21:15:28Z","author_association":"NONE","body":"Can you clarify what you mean by \"not using the right version of Iceberg\"? Do you mean the existing Iceberg tables I'm working with (created with Iceberg V 1.1.0) must be upgraded? \r\n\r\nI'm seeing the same behavior when I use updated 1.3.0 libs with my Spark 3.4 session.\r\n\r\n```\r\nspark-shell --packages \"org.apache.spark:spark-sql_2.13:3.3.1,org.apache.iceberg:iceberg-spark-runtime-3.4_2.12:1.3.0,org.apache.iceberg:iceberg-aws:1.3.0,org.apache.iceberg:iceberg-core:1.3.0,software.amazon.awssdk:bundle:2.20.25,software.amazon.awssdk:url-connection-client:2.20.25\"\\\r\n   --conf spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions\\\r\n  ...catalog conf pointing at 1.1.0-created Iceberg catalog\r\n\r\nspark.sql(\"SELECT * FROM catalog.db.table.files WHERE partition.<something> = 'value'\r\n23/07/18 16:06:40 WARN SparkScanBuilder: Failed to check if GreaterThanOrEqual(partition.something,'value) can be pushed down: Cannot find field 'partition.something' in struct: struct<>\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1641002011/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1641070362","html_url":"https://github.com/apache/iceberg/issues/5626#issuecomment-1641070362","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5626","id":1641070362,"node_id":"IC_kwDOCW7NX85h0L8a","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T22:25:33Z","updated_at":"2023-07-18T22:25:33Z","author_association":"MEMBER","body":"I think the distribution math there is a bit off since it assumes that the skew is only present at the first bit of the hashing function. The assumption that increasing the number of buckets evenly divides the skew is a bit of an issue since this assumes the skew is generally present and correlated with the hashing function but only at the first bit.\r\n\r\nThat said I did run some experiments on my own and while there wasn't a ton of difference between composition and running the function on it's own, there was a benefit to using the combined function. I'll try to finish up my test framework for running more examples.\r\n\r\nAnyway we probably do need to support multi-arg transforms within Iceberg at some point, so this may be a good time to start a design document and work towards adding that to spec as a First step.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1641070362/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1641086986","html_url":"https://github.com/apache/iceberg/issues/3546#issuecomment-1641086986","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3546","id":1641086986,"node_id":"IC_kwDOCW7NX85h0QAK","user":{"login":"ahmedriza","id":2463311,"node_id":"MDQ6VXNlcjI0NjMzMTE=","avatar_url":"https://avatars.githubusercontent.com/u/2463311?v=4","gravatar_id":"","url":"https://api.github.com/users/ahmedriza","html_url":"https://github.com/ahmedriza","followers_url":"https://api.github.com/users/ahmedriza/followers","following_url":"https://api.github.com/users/ahmedriza/following{/other_user}","gists_url":"https://api.github.com/users/ahmedriza/gists{/gist_id}","starred_url":"https://api.github.com/users/ahmedriza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ahmedriza/subscriptions","organizations_url":"https://api.github.com/users/ahmedriza/orgs","repos_url":"https://api.github.com/users/ahmedriza/repos","events_url":"https://api.github.com/users/ahmedriza/events{/privacy}","received_events_url":"https://api.github.com/users/ahmedriza/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T22:47:50Z","updated_at":"2023-07-18T22:51:07Z","author_association":"NONE","body":"In the doc on [JDBC integration](https://iceberg.apache.org/docs/latest/jdbc/) we have the following\r\n```\r\nClass.forName(\"com.mysql.cj.jdbc.Driver\"); // ensure JDBC driver is at runtime classpath\r\nMap<String, String> properties = new HashMap<>();\r\nproperties.put(CatalogProperties.CATALOG_IMPL, JdbcCatalog.class.getName());\r\nproperties.put(CatalogProperties.URI, \"jdbc:mysql://localhost:3306/test\");\r\nproperties.put(JdbcCatalog.PROPERTY_PREFIX + \"user\", \"admin\");\r\nproperties.put(JdbcCatalog.PROPERTY_PREFIX + \"password\", \"pass\");\r\nproperties.put(CatalogProperties.WAREHOUSE_LOCATION, \"s3://warehouse/path\");\r\nConfiguration hadoopConf = new Configuration(); // configs if you use HadoopFileIO\r\nJdbcCatalog catalog = CatalogUtil.buildIcebergCatalog(\"test_jdbc_catalog\", properties, hadoopConf);\r\n```\r\n\r\nThis configuration uses Hadoop File IO to write the warehouse data to S3.  Isn't this unsafe as well, since the actual write takes place on S3?  Or, in this case, are we safe, since the database (behind the JDBC connection) ensures atomicity?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1641086986/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1641108245","html_url":"https://github.com/apache/iceberg/issues/7774#issuecomment-1641108245","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7774","id":1641108245,"node_id":"IC_kwDOCW7NX85h0VMV","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-18T23:17:17Z","updated_at":"2023-07-18T23:18:16Z","author_association":"COLLABORATOR","body":"OK I looked into it some more.  I think its a problem with metadata tables throwing an alarming warning message.\r\n\r\nBut I verified that the pushdown does happen.\r\n\r\nIn this code:   https://github.com/apache/iceberg/blob/master/spark/v3.4/spark/src/main/java/org/apache/iceberg/spark/source/SparkScanBuilder.java#L167   \r\n\r\nwe add to pushedFilters, so filters _are_ used.\r\n```\r\n        if (expr != null) {\r\n          // try binding the expression to ensure it can be pushed down\r\n          Binder.bind(schema.asStruct(), expr, caseSensitive);\r\n          expressions.add(expr);\r\n          pushableFilters.add(filter);\r\n        }\r\n```\r\n\r\nBut the next part fails as it tries to figure out whether the filter selects the entire partition, so we do not need to return to Spark.  This just fails as the metadata table does not have any partition spec.\r\n```\r\n        if (expr == null || !ExpressionUtil.selectsPartitions(expr, table, caseSensitive)) {\r\n          postScanFilters.add(filter);\r\n        } else {\r\n          LOG.info(\"Evaluating completely on Iceberg side: {}\", filter);\r\n        }\r\n```\r\n\r\nHere, we get an error message, and in fact it does get returned to Spark here, so it is correct, just alarming.\r\n```\r\n      } catch (Exception e) {\r\n        LOG.warn(\"Failed to check if {} can be pushed down: {}\", filter, e.getMessage());\r\n        postScanFilters.add(filter);\r\n      }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1641108245/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1641368530","html_url":"https://github.com/apache/iceberg/issues/5626#issuecomment-1641368530","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5626","id":1641368530,"node_id":"IC_kwDOCW7NX85h1UvS","user":{"login":"advancedxy","id":807537,"node_id":"MDQ6VXNlcjgwNzUzNw==","avatar_url":"https://avatars.githubusercontent.com/u/807537?v=4","gravatar_id":"","url":"https://api.github.com/users/advancedxy","html_url":"https://github.com/advancedxy","followers_url":"https://api.github.com/users/advancedxy/followers","following_url":"https://api.github.com/users/advancedxy/following{/other_user}","gists_url":"https://api.github.com/users/advancedxy/gists{/gist_id}","starred_url":"https://api.github.com/users/advancedxy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/advancedxy/subscriptions","organizations_url":"https://api.github.com/users/advancedxy/orgs","repos_url":"https://api.github.com/users/advancedxy/repos","events_url":"https://api.github.com/users/advancedxy/events{/privacy}","received_events_url":"https://api.github.com/users/advancedxy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-19T03:42:49Z","updated_at":"2023-07-19T03:42:49Z","author_association":"CONTRIBUTOR","body":"> I think the distribution math there is a bit off since it assumes that the skew is only present at the first bit of the hashing function. The assumption that increasing the number of buckets evenly divides the skew is a bit of an issue since this assumes the skew is generally present and correlated with the hashing function but only at the first bit. \r\n\r\nThe assumption is that skew is generally present especially for multiple cols. I don't agree with the part `the skew is only present at the first bit of the hashing function`. When the skew is present, it would somehow related to the hash result.\r\n\r\n> That said I did run some experiments on my own and while there wasn't a ton of difference between composition and running the function on it's own, there was a benefit to using the combined function. I'll try to finish up my test framework for running more examples.\r\n\r\nThis is a good way to demonstrate the distribution. I also did a quick program to demonstrate my idea, see https://gist.github.com/advancedxy/236a8db8de03cf40c2ecbfebd4bf07ef for details. That might still be a simplified version, but I think it matches my previous calculation.\r\n\r\n> If we really wanted to include col_a we would do an identity transform correct?\r\n\r\nFor this part, when we are dealing with primary key table when the primary key is made of multiple columns, I think it's important to include all columns as buckets. An identity transform might not be sufficient.\r\n\r\n> Anyway we probably do need to support multi-arg transforms within Iceberg at some point, so this may be a good time to start a design document and work towards adding that to spec as a First step.\r\n\r\n+1. I agree adding that to spec as first step.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1641368530/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1641393552","html_url":"https://github.com/apache/iceberg/pull/7653#issuecomment-1641393552","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7653","id":1641393552,"node_id":"IC_kwDOCW7NX85h1a2Q","user":{"login":"manuzhang","id":1191767,"node_id":"MDQ6VXNlcjExOTE3Njc=","avatar_url":"https://avatars.githubusercontent.com/u/1191767?v=4","gravatar_id":"","url":"https://api.github.com/users/manuzhang","html_url":"https://github.com/manuzhang","followers_url":"https://api.github.com/users/manuzhang/followers","following_url":"https://api.github.com/users/manuzhang/following{/other_user}","gists_url":"https://api.github.com/users/manuzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/manuzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manuzhang/subscriptions","organizations_url":"https://api.github.com/users/manuzhang/orgs","repos_url":"https://api.github.com/users/manuzhang/repos","events_url":"https://api.github.com/users/manuzhang/events{/privacy}","received_events_url":"https://api.github.com/users/manuzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-19T04:28:36Z","updated_at":"2023-07-19T04:28:47Z","author_association":"COLLABORATOR","body":"@szehon-ho I'm wondering whether we still need to backport #5495 since from [Anton's comment](https://github.com/apache/iceberg/pull/5495#issuecomment-1219689082) there's no big difference after the change.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1641393552/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1641413568","html_url":"https://github.com/apache/iceberg/pull/8023#issuecomment-1641413568","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8023","id":1641413568,"node_id":"IC_kwDOCW7NX85h1fvA","user":{"login":"zinking","id":118241,"node_id":"MDQ6VXNlcjExODI0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/118241?v=4","gravatar_id":"","url":"https://api.github.com/users/zinking","html_url":"https://github.com/zinking","followers_url":"https://api.github.com/users/zinking/followers","following_url":"https://api.github.com/users/zinking/following{/other_user}","gists_url":"https://api.github.com/users/zinking/gists{/gist_id}","starred_url":"https://api.github.com/users/zinking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zinking/subscriptions","organizations_url":"https://api.github.com/users/zinking/orgs","repos_url":"https://api.github.com/users/zinking/repos","events_url":"https://api.github.com/users/zinking/events{/privacy}","received_events_url":"https://api.github.com/users/zinking/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-19T05:03:04Z","updated_at":"2023-07-19T05:03:04Z","author_association":"CONTRIBUTOR","body":"LGTM now, I'd suggest let's get this style in early. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1641413568/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1641486741","html_url":"https://github.com/apache/iceberg/pull/5313#issuecomment-1641486741","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5313","id":1641486741,"node_id":"IC_kwDOCW7NX85h1xmV","user":{"login":"chenwyi2","id":19389434,"node_id":"MDQ6VXNlcjE5Mzg5NDM0","avatar_url":"https://avatars.githubusercontent.com/u/19389434?v=4","gravatar_id":"","url":"https://api.github.com/users/chenwyi2","html_url":"https://github.com/chenwyi2","followers_url":"https://api.github.com/users/chenwyi2/followers","following_url":"https://api.github.com/users/chenwyi2/following{/other_user}","gists_url":"https://api.github.com/users/chenwyi2/gists{/gist_id}","starred_url":"https://api.github.com/users/chenwyi2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenwyi2/subscriptions","organizations_url":"https://api.github.com/users/chenwyi2/orgs","repos_url":"https://api.github.com/users/chenwyi2/repos","events_url":"https://api.github.com/users/chenwyi2/events{/privacy}","received_events_url":"https://api.github.com/users/chenwyi2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-19T06:22:00Z","updated_at":"2023-07-19T06:22:00Z","author_association":"NONE","body":"ORC_BLOOM_FILTER_COLUMNS this property will work on spark? when i set write.orc.bloom.filter.columns=xx and used spark to write data, i found that bloomfilter had no effect on querying.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1641486741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1641528892","html_url":"https://github.com/apache/iceberg/pull/7996#issuecomment-1641528892","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7996","id":1641528892,"node_id":"IC_kwDOCW7NX85h1748","user":{"login":"skytin1004","id":99078115,"node_id":"U_kgDOBefP4w","avatar_url":"https://avatars.githubusercontent.com/u/99078115?v=4","gravatar_id":"","url":"https://api.github.com/users/skytin1004","html_url":"https://github.com/skytin1004","followers_url":"https://api.github.com/users/skytin1004/followers","following_url":"https://api.github.com/users/skytin1004/following{/other_user}","gists_url":"https://api.github.com/users/skytin1004/gists{/gist_id}","starred_url":"https://api.github.com/users/skytin1004/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skytin1004/subscriptions","organizations_url":"https://api.github.com/users/skytin1004/orgs","repos_url":"https://api.github.com/users/skytin1004/repos","events_url":"https://api.github.com/users/skytin1004/events{/privacy}","received_events_url":"https://api.github.com/users/skytin1004/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-19T07:02:47Z","updated_at":"2023-07-19T07:02:47Z","author_association":"CONTRIBUTOR","body":"Thanks @nastra , I have modified the code based on your review.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1641528892/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1641721530","html_url":"https://github.com/apache/iceberg/pull/8094#issuecomment-1641721530","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8094","id":1641721530,"node_id":"IC_kwDOCW7NX85h2q66","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-19T09:11:45Z","updated_at":"2023-07-19T09:11:45Z","author_association":"CONTRIBUTOR","body":"thanks for reviewing @Fokko and @singhpk234 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1641721530/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1642065703","html_url":"https://github.com/apache/iceberg/issues/8011#issuecomment-1642065703","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8011","id":1642065703,"node_id":"IC_kwDOCW7NX85h3-8n","user":{"login":"mr-brobot","id":18426892,"node_id":"MDQ6VXNlcjE4NDI2ODky","avatar_url":"https://avatars.githubusercontent.com/u/18426892?v=4","gravatar_id":"","url":"https://api.github.com/users/mr-brobot","html_url":"https://github.com/mr-brobot","followers_url":"https://api.github.com/users/mr-brobot/followers","following_url":"https://api.github.com/users/mr-brobot/following{/other_user}","gists_url":"https://api.github.com/users/mr-brobot/gists{/gist_id}","starred_url":"https://api.github.com/users/mr-brobot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mr-brobot/subscriptions","organizations_url":"https://api.github.com/users/mr-brobot/orgs","repos_url":"https://api.github.com/users/mr-brobot/repos","events_url":"https://api.github.com/users/mr-brobot/events{/privacy}","received_events_url":"https://api.github.com/users/mr-brobot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-19T13:16:59Z","updated_at":"2023-07-19T13:16:59Z","author_association":"CONTRIBUTOR","body":"I'm doing some more research to continue the multi-processing conversation in a separate issue. But the primary problem stated in this issue, the ability to run PyIceberg in AWS Lambda / AWS Fargate, is solved. ð ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1642065703/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1642124333","html_url":"https://github.com/apache/iceberg/pull/8098#issuecomment-1642124333","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8098","id":1642124333,"node_id":"IC_kwDOCW7NX85h4NQt","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-19T13:51:07Z","updated_at":"2023-07-19T13:51:07Z","author_association":"CONTRIBUTOR","body":"@ajantha-bhat can you rebase please?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1642124333/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1642158518","html_url":"https://github.com/apache/iceberg/pull/8098#issuecomment-1642158518","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8098","id":1642158518,"node_id":"IC_kwDOCW7NX85h4Vm2","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-19T14:07:43Z","updated_at":"2023-07-19T14:07:43Z","author_association":"MEMBER","body":"> @ajantha-bhat can you rebase please?\r\n\r\nDone. I would have saved some effort on https://github.com/apache/iceberg/pull/8056 if I have found it earlier. \r\nSince, this PR removes one of the file it just refactored :) ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1642158518/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1642172414","html_url":"https://github.com/apache/iceberg/pull/4898#issuecomment-1642172414","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4898","id":1642172414,"node_id":"IC_kwDOCW7NX85h4Y_-","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-19T14:16:02Z","updated_at":"2023-07-19T14:16:02Z","author_association":"CONTRIBUTOR","body":"Hi @rdblue @szehon-ho @aokolnychyi do you have any time to look at this again? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1642172414/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1642204387","html_url":"https://github.com/apache/iceberg/issues/4977#issuecomment-1642204387","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4977","id":1642204387,"node_id":"IC_kwDOCW7NX85h4gzj","user":{"login":"mr-brobot","id":18426892,"node_id":"MDQ6VXNlcjE4NDI2ODky","avatar_url":"https://avatars.githubusercontent.com/u/18426892?v=4","gravatar_id":"","url":"https://api.github.com/users/mr-brobot","html_url":"https://github.com/mr-brobot","followers_url":"https://api.github.com/users/mr-brobot/followers","following_url":"https://api.github.com/users/mr-brobot/following{/other_user}","gists_url":"https://api.github.com/users/mr-brobot/gists{/gist_id}","starred_url":"https://api.github.com/users/mr-brobot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mr-brobot/subscriptions","organizations_url":"https://api.github.com/users/mr-brobot/orgs","repos_url":"https://api.github.com/users/mr-brobot/repos","events_url":"https://api.github.com/users/mr-brobot/events{/privacy}","received_events_url":"https://api.github.com/users/mr-brobot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-19T14:32:27Z","updated_at":"2023-07-19T14:32:27Z","author_association":"CONTRIBUTOR","body":"Tabular recently created a [Kafka Iceberg Sink connector](https://github.com/tabular-io/iceberg-kafka-connect). That seems like a good place to consolidate efforts.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1642204387/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1642246921","html_url":"https://github.com/apache/iceberg/issues/5626#issuecomment-1642246921","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5626","id":1642246921,"node_id":"IC_kwDOCW7NX85h4rMJ","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-19T14:55:29Z","updated_at":"2023-07-19T14:55:29Z","author_association":"MEMBER","body":"> The assumption is that skew is generally present especially for multiple cols. I don't agree with the part the skew is only present at the first bit of the hashing function. When the skew is present, it would somehow related to the hash result.\r\n\r\nThis was in reference to \r\n\r\n> the possibility of hash(col_a) mod 4 === 0 is 1/6, hash(col_a) mod 4 === 1 is 1/3, hash(col_a) mod 4 === 2 is 1/6, hash(col_a) mod 4 === 3 is 1/3. (one may argue that the distribution could be in other ways, yeah, that's correct. But this distribution is most likely).\r\n\r\nI think we have very different models for skew. In my mind skew is an artifact of a small number of values which are extremely over-represented in a data set, not a systematic alignment with the hashing function. In my model increasing the number of buckets does not evenly divide their contents. Skew is apparent in our buckets because each time we bucket we get some random assortment of partitions and the number of \"skewed\" partitions.  As a trivial example, if I have a data set containing of the integers 1,2,3,4 but 3 is common for 70% of the dataset and the remaining digits cover 10% each. I would see\r\n(1,3 - 80% ) (2, 4 - %20)  \r\n\r\nBut if I divide my buckets I see\r\n\r\n(10%, 70%, 10%, 10%)\r\n\r\nBecause in my model skew is modeled like this there is no correlation with the hashing function (at least not in a broad way) and whenever we change our bucketing it's really just changing what random number of the \"skewed\" partitions end up in in a specific bucket. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1642246921/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]