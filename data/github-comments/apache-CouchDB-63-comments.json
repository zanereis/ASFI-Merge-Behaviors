[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/451568972","html_url":"https://github.com/apache/couchdb/issues/1832#issuecomment-451568972","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1832","id":451568972,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MTU2ODk3Mg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-04T21:08:24Z","updated_at":"2019-01-04T21:08:24Z","author_association":"MEMBER","body":"@ArchangeGabriel Yes, one of the patches in our repo does break ABI compatibility because of required changes for `aarch64`. (An additional high address bit is masked off in the VA space because of limitations on that platform.)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/451568972/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/451780664","html_url":"https://github.com/apache/couchdb/issues/1832#issuecomment-451780664","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1832","id":451780664,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MTc4MDY2NA==","user":{"login":"ArchangeGabriel","id":490531,"node_id":"MDQ6VXNlcjQ5MDUzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/490531?v=4","gravatar_id":"","url":"https://api.github.com/users/ArchangeGabriel","html_url":"https://github.com/ArchangeGabriel","followers_url":"https://api.github.com/users/ArchangeGabriel/followers","following_url":"https://api.github.com/users/ArchangeGabriel/following{/other_user}","gists_url":"https://api.github.com/users/ArchangeGabriel/gists{/gist_id}","starred_url":"https://api.github.com/users/ArchangeGabriel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ArchangeGabriel/subscriptions","organizations_url":"https://api.github.com/users/ArchangeGabriel/orgs","repos_url":"https://api.github.com/users/ArchangeGabriel/repos","events_url":"https://api.github.com/users/ArchangeGabriel/events{/privacy}","received_events_url":"https://api.github.com/users/ArchangeGabriel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-06T22:23:32Z","updated_at":"2019-01-06T22:23:32Z","author_association":"NONE","body":"OK, fixed the CouchDB package by rebuilding against ABI-modified mozjs. Everything is in order now, this can be closed. Thanks for your help and pointing me towards your patchset. :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/451780664/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":2,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/451832094","html_url":"https://github.com/apache/couchdb/pull/1789#issuecomment-451832094","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1789","id":451832094,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MTgzMjA5NA==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-07T06:12:52Z","updated_at":"2019-01-08T06:21:51Z","author_association":"CONTRIBUTOR","body":"**update: this no longer occurs**\r\n\r\nWhen creating a mango json/text index, and the user doesn't specify`\"ddoc\" : \"<partitionname>:<design_docid>\"`, we get a 500 error (instead of a 400). \r\n\r\n```\r\n{\r\n    \"error\": \"error_saving_ddoc\",\r\n    \"reason\": \"Unknown error while saving the design document: unknown_error\",\r\n    \"ref\": 452476559\r\n}\r\n```\r\nWe know mango automatically creates the ddocid when not provided so it's not conforming to the partition format. I think the error message isn't handled correctly somewhere(looks like `couch_db_updater`) leading to a gen_server crash and  thus it doesn't get propagated up.\r\n\r\n```\r\n[error] 2019-01-07T06:14:15.427886Z node3@127.0.0.1 <0.322.1> -------- CRASH REPORT Process  (<0.322.1>) with 0 neighbors exited with reason: bad return value {illegal_docid,<<\"Doc id must be of form partition:id\">>} at gen_server:handle_common_reply/8(line:730) <= couch_db_updater:init/1(line:56) <= proc_lib:init_p_do_apply/3(line:247); initial_call: {couch_db_updater,init,['Argument__1']}, ancestors: [<0.321.1>], message_queue_len: 0, messages: [], links: [<0.319.0>], dictionary: [{io_priority,{db_update,<<\"shards/20000000-3fffffff/partitiondb.154682...\">>}},...], trap_exit: false, status: running, heap_size: 987, stack_size: 27, reductions: 2701\r\n```\r\n\r\n\r\n```\r\n[info] 2019-01-07T06:06:47.415090Z node1@127.0.0.1 <0.24733.0> 9108cd090a 9108cd090a 127.0.0.1  localhost:5984 POST /partitiondb/_index 500 ok 8\r\n[error] 2019-01-07T06:06:47.414666Z node3@127.0.0.1 <0.11851.0> -------- gen_server <0.11851.0> terminated with reason: bad return value {illegal_docid,<<\"Doc id must be of form partition:id\">>}\r\n  last msg: {update_docs,<0.24906.0>,[[{doc,<<\"_design/c1d29e81d94c805422e8b27d5891b97c0fa0a0d2\">>,{1,[<<218,118,244,112,98,6,119,52,117,157,178,147,84,93,101,169>>]},[<<128,0,0,225>>,<<245,194,40,241,77,161,96,237,110,110,181,149,3,122,8,42>>,<<131,104,2,109,0,0,0,207,1,174,2,88,131,104,1,108,0,0,0,3,104,2,109,0,0,0,8,108,97,110,103,117,97,103,101,1,13,20,5,113,117,101,114,121,9,25,20,5,118,105,101,119,115,9,44,0,1,9,19,36,9,102,111,111,45,105,110,100,101,120,9,23,13,67,12,3,109,97,112,9,17,0,2,9,40,20,6,102,105,101,108,100,54,60,0,4,1,97,1,97,16,3,97,115,99,106,9,37,104,23,112,97,114,116,105,97,108,95,102,105,108,116,101,114,95,115,101,108,101,99,116,111,114,104,1,106,13,34,20,6,114,101,100,117,99,5,153,24,6,95,99,111,117,110,116,9,58,28,7,111,112,116,105,111,110,115,9,116,13,156,12,3,100,101,102,50,17,0,13,133,1,235,0,1,1,123,8,1,97,106,1,1,106,67,0,0,11,5,146,56,116,105,111,110,101,100,100,0,4,116,114,117,101,106,106,109,0,0,0,5,1,2,4,131,106>>],[],false,[{comp_body,<<1,174,2,88,131,104,1,108,0,0,0,3,104,2,109,0,0,0,8,108,97,110,103,117,97,103,101,1,13,20,5,113,117,101,114,121,9,25,20,5,118,105,101,119,115,9,44,0,1,9,19,36,9,102,111,111,45,105,110,100,101,120,9,23,13,67,12,3,109,97,112,9,17,0,2,9,40,20,6,102,105,101,108,100,54,60,0,4,1,97,1,97,16,3,97,115,99,106,9,37,104,23,112,97,114,116,105,97,108,95,102,105,108,116,101,114,95,115,101,108,101,99,116,111,114,104,1,106,13,34,20,6,114,101,100,117,99,5,153,24,6,95,99,111,117,110,116,9,58,28,7,111,112,116,105,111,110,115,9,116,13,156,12,3,100,101,102,50,17,0,13,133,1,235,0,1,1,123,8,1,97,106,1,1,106,67,0,0,11,5,146,56,116,105,111,110,101,100,100,0,4,116,114,117,101,106,106>>},{size_info,[]},{atts_stream,nil},{ejson_size,387},{ref,#Ref<0.2404497343.1436811265.145848>}]}]],[],false,true}\r\n     state: {db,1,<<\"shards/20000000-3fffffff/partitiondb.1546826084\">>,\"/Users/tonysun/github/cloudant/partitiondb/dev/lib/node3/data/dbs/shards/20000000-3fffffff/partitiondb.1546826084.couch\",{couch_bt_engine,{st,\"/Users/tonysun/github/cloudant/partitiondb/dev/lib/node3/data/dbs/shards/20000000-3fffffff/partitiondb.1546826084.couch\",<0.11852.0>,#Ref<0.2404497343.1436811269.53299>,[before_header,after_header,on_file_open],{db_header,7,0,0,nil,nil,{12448,[],326},nil,nil,4253,1000,<<\"d947ffdbbb88cfcceec1aa1dfa8ee453\">>,[{'node3@127.0.0.1',0}],0,1000,0},false,{btree,<0.11852.0>,nil,#Fun<couch_bt_engine.id_tree_split.1>,#Fun<couch_bt_engine.id_tree_join.2>,undefined,#Fun<couch_bt_engine.id_tree_reduce.2>,snappy},{btree,<0.11852.0>,nil,#Fun<couch_bt_engine.seq_tree_split.1>,#Fun<couch_bt_engine.seq_tree_join.2>,undefined,#Fun<couch_bt_engine.seq_tree_reduce.2>,snappy},{btree,<0.11852.0>,{12448,[],326},#Fun<couch_bt_engine.local_tree_split.1>,#Fun<couch_bt_engine.local_tree_join.2>,undefined,nil,snappy},snappy,{btree,<0.11852.0>,nil,#Fun<couch_bt_engine.purge_tree_split.1>,#Fun<couch_bt_engine.purge_tree_join.2>,undefined,#Fun<couch_bt_engine.purge_tree_reduce.2>,snappy},{btree,<0.11852.0>,nil,#Fun<couch_bt_engine.purge_seq_tree_split.1>,#Fun<couch_bt_engine.purge_seq_tree_join.2>,undefined,#Fun<couch_bt_engine.purge_tree_reduce.2>,snappy}}},<0.11851.0>,nil,0,<<\"1546840571318289\">>,{user_ctx,null,[],undefined},[],undefined,nil,nil,nil,[{default_security_object,[]},{create_if_missing,true},{props,[{partitioned,true},{hash,[couch_partition,hash,[]]}]}],undefined}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/451832094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/451992371","html_url":"https://github.com/apache/couchdb/issues/1841#issuecomment-451992371","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1841","id":451992371,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MTk5MjM3MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-07T16:26:30Z","updated_at":"2019-01-07T16:37:53Z","author_association":"MEMBER","body":"I can't confirm this - what is the `timezone` setting on your server? Erlang should be picking it up from that.\r\n\r\n```bash\r\n$ curl -X PUT http://127.0.0.1:15984/baseball_1\r\n{\"ok\":true}\r\n$ curl -X PUT http://127.0.0.1:15984/baseball_2\r\n{\"ok\":true}\r\n$ curl -H 'Content-Type: application/json' -X POST \"http://127.0.0.1:15984/baseball_1/\" -d '{}'\r\n$ curl -H 'Content-Type: application/json' -X POST \"http://127.0.0.1:15984/_replicate\" -d '{\"source\":{\"url\":\"http://127.0.0.1:15984/baseball_1\"},\"target\":{\"url\":\"https://127.0.0.1:15984/baseball_2\"},\"doc_ids\":[\"41fa187659bd5957ab3d2d22a80006f4\"]}'\r\n{\"ok\":true,\"session_id\":\"5ac147f405fb75b6b7107d76a14e7c30\",\"source_last_seq\":\"1-g1AAAAGXeJzLYWBg4MhgTmHgz8tPSTV0MDQy1zMAQsMcoARTIkOS_P___7MymBMZcoEC7BYGlommhhYpDJyleSmpaZl5qSk4NScpAMkke5D-RAbcqhxAquIJqUoAqaonoCqPBUgyNAApoML5hFUugKjcj_CfUWJKqhGR_oOYcQBixn2QGYxgM0wtzC0tk4wwdREw6QHEJJAPswD_amrS\",\"replication_id_version\":4,\"start_time\":\"Mon, 07 Jan 2019 21:35:51 GMT\",\"end_time\":\"Mon, 07 Jan 2019 16:35:56 GMT\",\"docs_read\":1,\"docs_written\":1,\"doc_write_failures\":0,\"history\":[{\"session_id\":\"5ac147f405fb75b6b7107d76a14e7c30\",\"start_time\":\"Mon, 07 Jan 2019 21:35:51 GMT\",\"end_time\":\"Mon, 07 Jan 2019 16:35:56 GMT\",\"start_last_seq\":0,\"end_last_seq\":\"1-g1AAAAGXeJzLYWBg4MhgTmHgz8tPSTV0MDQy1zMAQsMcoARTIkOS_P___7MymBMZcoEC7BYGlommhhYpDJyleSmpaZl5qSk4NScpAMkke5D-RAbcqhxAquIJqUoAqaonoCqPBUgyNAApoML5hFUugKjcj_CfUWJKqhGR_oOYcQBixn2QGYxgM0wtzC0tk4wwdREw6QHEJJAPswD_amrS\",\"recorded_seq\":\"1-g1AAAAGXeJzLYWBg4MhgTmHgz8tPSTV0MDQy1zMAQsMcoARTIkOS_P___7MymBMZcoEC7BYGlommhhYpDJyleSmpaZl5qSk4NScpAMkke5D-RAbcqhxAquIJqUoAqaonoCqPBUgyNAApoML5hFUugKjcj_CfUWJKqhGR_oOYcQBixn2QGYxgM0wtzC0tk4wwdREw6QHEJJAPswD_amrS\",\"missing_checked\":1,\"missing_found\":1,\"docs_read\":1,\"docs_written\":1,\"doc_write_failures\":0}]}\r\n[688 atypical:joant ~] $ date -u\r\nMon Jan  7 16:36:47 UTC 2019\r\n```\r\nObviously the recommendation is to run with your server set to `UTC`.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/451992371/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452022086","html_url":"https://github.com/apache/couchdb/issues/1841#issuecomment-452022086","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1841","id":452022086,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjAyMjA4Ng==","user":{"login":"skeyby","id":1609532,"node_id":"MDQ6VXNlcjE2MDk1MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1609532?v=4","gravatar_id":"","url":"https://api.github.com/users/skeyby","html_url":"https://github.com/skeyby","followers_url":"https://api.github.com/users/skeyby/followers","following_url":"https://api.github.com/users/skeyby/following{/other_user}","gists_url":"https://api.github.com/users/skeyby/gists{/gist_id}","starred_url":"https://api.github.com/users/skeyby/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skeyby/subscriptions","organizations_url":"https://api.github.com/users/skeyby/orgs","repos_url":"https://api.github.com/users/skeyby/repos","events_url":"https://api.github.com/users/skeyby/events{/privacy}","received_events_url":"https://api.github.com/users/skeyby/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-07T17:54:31Z","updated_at":"2019-01-07T17:55:12Z","author_association":"NONE","body":"```\r\n$ date -u\r\nMon Jan  7 17:53:08 UTC 2019\r\n$ date\r\nMon Jan  7 18:53:10 CET 2019\r\n```\r\n\r\nThe server is in GMT+1, we're in Rome.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452022086/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452023075","html_url":"https://github.com/apache/couchdb/issues/1841#issuecomment-452023075","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1841","id":452023075,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjAyMzA3NQ==","user":{"login":"skeyby","id":1609532,"node_id":"MDQ6VXNlcjE2MDk1MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1609532?v=4","gravatar_id":"","url":"https://api.github.com/users/skeyby","html_url":"https://github.com/skeyby","followers_url":"https://api.github.com/users/skeyby/followers","following_url":"https://api.github.com/users/skeyby/following{/other_user}","gists_url":"https://api.github.com/users/skeyby/gists{/gist_id}","starred_url":"https://api.github.com/users/skeyby/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skeyby/subscriptions","organizations_url":"https://api.github.com/users/skeyby/orgs","repos_url":"https://api.github.com/users/skeyby/repos","events_url":"https://api.github.com/users/skeyby/events{/privacy}","received_events_url":"https://api.github.com/users/skeyby/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-07T17:57:15Z","updated_at":"2019-01-07T17:57:50Z","author_association":"NONE","body":"Sorry Joan but your example confirm my report. Maybe I didn't explain myself correctly.\r\n\r\n> \"start_time\":\"Mon, 07 Jan 2019 21:35:51 GMT\",\"end_time\":\"Mon, 07 Jan 2019 16:35:56 GMT\"\r\n\r\nYour End Time is 5 hours before your start time.\r\n\r\nMaybe your replication was called Delorean :-)\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452023075/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452033347","html_url":"https://github.com/apache/couchdb/issues/1841#issuecomment-452033347","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1841","id":452033347,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjAzMzM0Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-07T18:28:40Z","updated_at":"2019-01-07T18:28:40Z","author_association":"MEMBER","body":"Ah, this is because the shell from which I launched CouchDB has my TZ set to EST5EDT:\r\n\r\n```\r\n$ echo $TZ\r\nEST5EDT\r\n```\r\n\r\nwhich is overriding `/etc/timezone`.\r\n\r\nCheck the TZ variable for your launch process for CouchDB. If you launched this from the command line, you may have your local \r\n\r\nIf you're on Linux, you can confirm this by looking in `/proc/<pid-of-couchdb>/environ`.\r\n\r\nNot saying this is fixed, just a workaround.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452033347/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452033478","html_url":"https://github.com/apache/couchdb/issues/1841#issuecomment-452033478","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1841","id":452033478,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjAzMzQ3OA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-07T18:29:09Z","updated_at":"2019-01-07T18:29:09Z","author_association":"MEMBER","body":"@nickva looks like we have a TZ problem","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452033478/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452043249","html_url":"https://github.com/apache/couchdb/issues/1841#issuecomment-452043249","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1841","id":452043249,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjA0MzI0OQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-07T18:59:44Z","updated_at":"2019-01-07T18:59:44Z","author_association":"CONTRIBUTOR","body":"@skeyby Thank you for the report!\r\n\r\n@wohali , indeed seems like a bug, thanks for digging in and debugging it. I'll assign the ticket to me.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452043249/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452188597","html_url":"https://github.com/apache/couchdb/pull/1789#issuecomment-452188597","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1789","id":452188597,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjE4ODU5Nw==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T06:20:33Z","updated_at":"2019-01-08T06:20:33Z","author_association":"CONTRIBUTOR","body":"After grabbing the latest commit on this branch. I no longer get an unknown error 500's. I think the code is working as designed. We might want to add in an extra field so users know which indexes have partitioned = false. \r\n\r\n```\r\n{\r\n    \"total_rows\": 4,\r\n    \"indexes\": [\r\n        {\r\n            \"ddoc\": null,\r\n            \"name\": \"_all_docs\",\r\n            \"type\": \"special\",\r\n            \"def\": {\r\n                \"fields\": [\r\n                    {\r\n                        \"_id\": \"asc\"\r\n                    }\r\n                ]\r\n            }\r\n        },\r\n        {\r\n            \"ddoc\": \"_design/foo-default-partition-index\",\r\n            \"name\": \"foo-default-partition-index\",\r\n            \"type\": \"json\",\r\n            \"def\": {\r\n                \"fields\": [\r\n                    {\r\n                        \"a\": \"asc\"\r\n                    }\r\n                ]\r\n            }\r\n        },\r\n        {\r\n            \"ddoc\": \"_design/foo-partition-false-index\",\r\n            \"name\": \"foo-default-partition-false-index\",\r\n            \"type\": \"json\",\r\n            \"def\": {\r\n                \"fields\": [\r\n                    {\r\n                        \"a\": \"asc\"\r\n                    }\r\n                ]\r\n            }\r\n        },\r\n        {\r\n            \"ddoc\": \"_design/foo-partition-true-index\",\r\n            \"name\": \"foo-default-partition-true-index\",\r\n            \"type\": \"json\",\r\n            \"def\": {\r\n                \"fields\": [\r\n                    {\r\n                        \"a\": \"asc\"\r\n                    }\r\n                ]\r\n            }\r\n        }\r\n    ]\r\n}\r\n```\r\n\r\n```\r\n{\r\n    \"_id\": \"_design/foo-default-partition-index\",\r\n    \"_rev\": \"1-f55c91d8a173c5b1e7e61f35b3f4b594\",\r\n    \"language\": \"query\",\r\n    \"views\": {\r\n        \"foo-default-partition-index\": {\r\n            \"map\": {\r\n                \"fields\": {\r\n                    \"a\": \"asc\"\r\n                },\r\n                \"partial_filter_selector\": {}\r\n            },\r\n            \"reduce\": \"_count\",\r\n            \"options\": {\r\n                \"def\": {\r\n                    \"fields\": [\r\n                        \"a\"\r\n                    ]\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452188597/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452202337","html_url":"https://github.com/apache/couchdb/pull/1789#issuecomment-452202337","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1789","id":452202337,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjIwMjMzNw==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T07:36:40Z","updated_at":"2019-01-09T06:46:36Z","author_association":"CONTRIBUTOR","body":"we'll need to figure out what layer (core, dreyfus or clouseau) this issue is occuring, but it seems for text indexes, it still uses a `\"partitioned\": \"false\"` index for a partitoned query :\r\n\r\n```\r\nhttp://localhost:5984/partitiondb/_partition/foo/_explain\r\n\r\n{\r\n    \"selector\": {\r\n      \"a\": 1\r\n    },\r\n  \"use_index\": \"_design/11be2d55f04e03e19c5dc9a1a7038bb5a8a0f6f2\"\r\n}\r\n```\r\n\r\n```\r\n{\r\n    \"dbname\": \"partitiondb\",\r\n    \"index\": {\r\n        \"ddoc\": \"_design/11be2d55f04e03e19c5dc9a1a7038bb5a8a0f6f2\",\r\n        \"name\": \"11be2d55f04e03e19c5dc9a1a7038bb5a8a0f6f2\",\r\n        \"type\": \"text\",\r\n        \"def\": {\r\n            \"default_analyzer\": \"keyword\",\r\n            \"default_field\": {},\r\n            \"selector\": {},\r\n            \"fields\": [],\r\n            \"index_array_lengths\": true\r\n        }\r\n    },\r\n    \"partitioned\": false,\r\n    \"selector\": {\r\n        \"a\": {\r\n            \"$eq\": 1\r\n        }\r\n    },\r\n    \"opts\": {\r\n        \"use_index\": [\r\n            \"11be2d55f04e03e19c5dc9a1a7038bb5a8a0f6f2\"\r\n        ],\r\n        \"bookmark\": [],\r\n        \"limit\": 10000000000,\r\n        \"skip\": 0,\r\n        \"sort\": {},\r\n        \"fields\": \"all_fields\",\r\n        \"partition\": \"foo\",\r\n        \"r\": [\r\n            49\r\n        ],\r\n        \"conflicts\": false,\r\n        \"stale\": false,\r\n        \"update\": true,\r\n        \"stable\": false,\r\n        \"execution_stats\": false\r\n    },\r\n    \"limit\": 200,\r\n    \"skip\": 0,\r\n    \"fields\": \"all_fields\",\r\n    \"query\": \"(a_3anumber:1)\",\r\n    \"partition\": \"foo\",\r\n    \"sort\": \"relevance\"\r\n}\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452202337/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452206444","html_url":"https://github.com/apache/couchdb/issues/1841#issuecomment-452206444","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1841","id":452206444,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjIwNjQ0NA==","user":{"login":"skeyby","id":1609532,"node_id":"MDQ6VXNlcjE2MDk1MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1609532?v=4","gravatar_id":"","url":"https://api.github.com/users/skeyby","html_url":"https://github.com/skeyby","followers_url":"https://api.github.com/users/skeyby/followers","following_url":"https://api.github.com/users/skeyby/following{/other_user}","gists_url":"https://api.github.com/users/skeyby/gists{/gist_id}","starred_url":"https://api.github.com/users/skeyby/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skeyby/subscriptions","organizations_url":"https://api.github.com/users/skeyby/orgs","repos_url":"https://api.github.com/users/skeyby/repos","events_url":"https://api.github.com/users/skeyby/events{/privacy}","received_events_url":"https://api.github.com/users/skeyby/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T07:56:12Z","updated_at":"2019-01-08T07:56:12Z","author_association":"NONE","body":"> Ah, this is because the shell from which I launched CouchDB has my TZ set to EST5EDT:\r\n> \r\n> ```\r\n> $ echo $TZ\r\n> EST5EDT\r\n> ```\r\n> which is overriding `/etc/timezone`.\r\n> \r\n> Check the TZ variable for your launch process for CouchDB. If you launched this from the command line, you may have your local\r\n> \r\n> If you're on Linux, you can confirm this by looking in `/proc/<pid-of-couchdb>/environ`.\r\n> \r\n> Not saying this is fixed, just a workaround.\r\n\r\nHi Joan. Just as a general note, FreeBSD neither have /etc/timezone or $TZ environment variable.\r\n\r\nI guess Erlang is finding the correct timezone somehow else. \r\n\r\nThanks.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452206444/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452212308","html_url":"https://github.com/apache/couchdb/issues/1841#issuecomment-452212308","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1841","id":452212308,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjIxMjMwOA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T08:21:19Z","updated_at":"2019-01-08T08:21:19Z","author_association":"MEMBER","body":"Hi @skeyby ,\r\n\r\nAh, didn't realize you were on FreeBSD. In this case it's using what's at `/etc/localtime`:\r\n\r\n```\r\ncd /usr/share/zoneinfo/ && find * -type f -exec cmp -s {} /etc/localtime \\; -print;\r\n```\r\n\r\nwill tell you what you have it set to.\r\n\r\nYou can simply `cp /usr/share/zoneinfo/UTC /etc/localtime` to work around this for now if you want. Of course, all times in your shell will now be in UTC instead of in GMT+1.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452212308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452376513","html_url":"https://github.com/apache/couchdb/pull/1789#issuecomment-452376513","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1789","id":452376513,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjM3NjUxMw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T17:08:29Z","updated_at":"2019-01-08T17:08:29Z","author_association":"MEMBER","body":"@eiri Thanks for the review!\r\n\r\nFor the default yeah, we'll have to call that out in the docs that the paritioned flag defaults to the database flag.\r\n\r\nFor replications there's a create_target_params [1] option for replications where a user can specify the partitioned=true. I don't have an immediate good argument in either direction on whether we should default that to the partitioned option on the source db.\r\n\r\n[1] https://github.com/apache/couchdb/commit/3e511b37bde8238918edc18c1bed9ab7ca1cbc5f","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452376513/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452378305","html_url":"https://github.com/apache/couchdb/pull/1789#issuecomment-452378305","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1789","id":452378305,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjM3ODMwNQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T17:14:05Z","updated_at":"2019-01-08T17:14:05Z","author_association":"MEMBER","body":"@tonysun83 Good idea on adding the partitoned option. Have done that.\r\n\r\nFor that bug you found its because you're specifying an un-partitioned ddoc for a partition query and were weren't properly catching that after the fact. I've got a simple fix for that.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452378305/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452390497","html_url":"https://github.com/apache/couchdb/issues/1810#issuecomment-452390497","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1810","id":452390497,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjM5MDQ5Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T17:50:53Z","updated_at":"2019-01-08T17:50:53Z","author_association":"MEMBER","body":"@nickva bump, we need to solve this, see #1843. Any comments on my proposal?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452390497/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452390525","html_url":"https://github.com/apache/couchdb/issues/1843#issuecomment-452390525","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1843","id":452390525,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjM5MDUyNQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T17:50:58Z","updated_at":"2019-01-08T17:50:58Z","author_association":"MEMBER","body":"This is probably a duplicate of #1810 , can you test:\r\n\r\n```\r\n[chttpd]\r\nserver_option = [{recbuf, 8192}]\r\n```\r\n\r\nand see if this helps?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452390525/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452391321","html_url":"https://github.com/apache/couchdb/pull/1844#issuecomment-452391321","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1844","id":452391321,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjM5MTMyMQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T17:53:31Z","updated_at":"2019-01-08T17:53:31Z","author_association":"MEMBER","body":"This is a huge diff and includes a bunch of partition stuff that might be unrelated?\r\n\r\nCan you check that your PR'ed the right thing, and if so, possibly add even developer-level documentation on how this works? I couldn't find the needle in the haystack of 69 changed files.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452391321/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452392772","html_url":"https://github.com/apache/couchdb/pull/1844#issuecomment-452392772","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1844","id":452392772,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjM5Mjc3Mg==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T17:58:02Z","updated_at":"2019-01-08T17:58:02Z","author_association":"MEMBER","body":"@wohali Sorry, on a meeting and did this half brained and forgot to set the correct base branch. I should have also mentioned I have yet to write an example module for use with this but wanted to have a place for people to start responding to the general idea.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452392772/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452392898","html_url":"https://github.com/apache/couchdb/issues/1843#issuecomment-452392898","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1843","id":452392898,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjM5Mjg5OA==","user":{"login":"jlami","id":8522993,"node_id":"MDQ6VXNlcjg1MjI5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/8522993?v=4","gravatar_id":"","url":"https://api.github.com/users/jlami","html_url":"https://github.com/jlami","followers_url":"https://api.github.com/users/jlami/followers","following_url":"https://api.github.com/users/jlami/following{/other_user}","gists_url":"https://api.github.com/users/jlami/gists{/gist_id}","starred_url":"https://api.github.com/users/jlami/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jlami/subscriptions","organizations_url":"https://api.github.com/users/jlami/orgs","repos_url":"https://api.github.com/users/jlami/repos","events_url":"https://api.github.com/users/jlami/events{/privacy}","received_events_url":"https://api.github.com/users/jlami/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T17:58:24Z","updated_at":"2019-01-08T17:58:24Z","author_association":"NONE","body":"That sounds very plausible, will try it tomorrow and report back.\r\n\r\nBut if this is the solution, wouldn't that just be postponing the error until there are enough branches that the next limit is reached? I don't fully get why resolving the conflicts would not eliminate elements from the atts_since. I guess you could still bring back a deleted branch so it needs to be checked?\r\nWould purging deleted_conflicts help here?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452392898/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452393432","html_url":"https://github.com/apache/couchdb/issues/1810#issuecomment-452393432","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1810","id":452393432,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjM5MzQzMg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T17:59:54Z","updated_at":"2019-01-08T17:59:54Z","author_association":"CONTRIBUTOR","body":"@wohali oh, sorry, dropped this one, it's already solved, just need to merge latest mochiweb master to our copy and tag it\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452393432/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452393921","html_url":"https://github.com/apache/couchdb/issues/1810#issuecomment-452393921","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1810","id":452393921,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjM5MzkyMQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T18:01:25Z","updated_at":"2019-01-08T18:01:25Z","author_association":"MEMBER","body":"@nickva did you read my comment above?  https://github.com/apache/couchdb/issues/1810#issuecomment-448060589\r\n\r\nMaybe we just call it good enough with 8192 for now, but I'm not sure it's sufficient.\r\n\r\nDo we want to cut a 2.3.1 with this?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452393921/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452398589","html_url":"https://github.com/apache/couchdb/issues/1843#issuecomment-452398589","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1843","id":452398589,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjM5ODU4OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T18:16:21Z","updated_at":"2019-01-08T18:16:21Z","author_association":"MEMBER","body":"paging @nickva ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452398589/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452401169","html_url":"https://github.com/apache/couchdb/issues/1810#issuecomment-452401169","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1810","id":452401169,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjQwMTE2OQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T18:24:28Z","updated_at":"2019-01-08T18:24:28Z","author_association":"CONTRIBUTOR","body":"@wohali I wasn't sure I understood some parts 1409 so didn't know how and whether it would affect that case.\r\n\r\n> Basically, the patch as written I think only sets the buffer to 8192 if recbuf is undefined. This means if you need >8k of headers you have no choice but to peg recbuf higher, which causes the issue seen in #1409. \r\n\r\nThe patch sets the buffer to 8k if recbuf if not defined, because that was the setting before the recbuf undefined became an option. I am not sure if 1k userland buffer size is what affected case 1409 the most. But this patch also allows setting a custom buffer size in general via mochiweb's socket options.\r\n\r\n> An alternative without going back to mochiweb would be to pass in {buffer, BIGNUM} .\r\n\r\nDon't think it would work currently on a listening mochiweb socket (need this patch for that). It could be set later in chttpd but by that point the headers would have failed to parsed.\r\n\r\n> and 50k of headers should be sufficient. \r\n\r\nI think it's not as much about 50k worth of headers but 50k being the longest line in the header (just the `GET /....long...path` line). That used to work well with an 8k buffer but doesn't with an 1k buffer anymore.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452401169/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452416846","html_url":"https://github.com/apache/couchdb/issues/1810#issuecomment-452416846","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1810","id":452416846,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjQxNjg0Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T19:11:41Z","updated_at":"2019-01-08T19:11:41Z","author_association":"MEMBER","body":"@nickva can you hop on IRC briefly to finish hashing this out? I want to be sure I understand where you're talking about the OS buffer (recbuf) and the mochiweb buffer (buffer) above, so that we don't force people to have to manually specify recbuf's size just to bump buffer's size.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452416846/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452418456","html_url":"https://github.com/apache/couchdb/issues/1843#issuecomment-452418456","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1843","id":452418456,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjQxODQ1Ng==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T19:16:51Z","updated_at":"2019-01-08T19:16:51Z","author_association":"CONTRIBUTOR","body":"@jlami  I guess you could still bring back a deleted branch so it needs to be checked?\r\n\r\nExactly, deletions are replicated in the normal case. However, you could add replication selector filter to not replicate deletions to the target.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452418456/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452429260","html_url":"https://github.com/apache/couchdb/issues/1843#issuecomment-452429260","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1843","id":452429260,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjQyOTI2MA==","user":{"login":"jlami","id":8522993,"node_id":"MDQ6VXNlcjg1MjI5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/8522993?v=4","gravatar_id":"","url":"https://api.github.com/users/jlami","html_url":"https://github.com/jlami","followers_url":"https://api.github.com/users/jlami/followers","following_url":"https://api.github.com/users/jlami/following{/other_user}","gists_url":"https://api.github.com/users/jlami/gists{/gist_id}","starred_url":"https://api.github.com/users/jlami/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jlami/subscriptions","organizations_url":"https://api.github.com/users/jlami/orgs","repos_url":"https://api.github.com/users/jlami/repos","events_url":"https://api.github.com/users/jlami/events{/privacy}","received_events_url":"https://api.github.com/users/jlami/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T19:50:53Z","updated_at":"2019-01-08T19:50:53Z","author_association":"NONE","body":"Ok, so my fear of receive buffer overflow in the future is kinda valid if this is the culprit. Couchdb would actually need to split up into multiple requests to work around this limitation to be correct. Does it do this currently?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452429260/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452440798","html_url":"https://github.com/apache/couchdb/pull/1845#issuecomment-452440798","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1845","id":452440798,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjQ0MDc5OA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T20:30:08Z","updated_at":"2019-01-08T20:30:08Z","author_association":"CONTRIBUTOR","body":"To reproduce followed instructions in #1841 \r\n\r\n```\r\ncurl -X PUT http://adm:pass@127.0.0.1:15984/baseball_1\r\ncurl -X PUT http://adm:pass@127.0.0.1:15984/baseball_2\r\ncurl -H 'Content-Type: application/json' -X POST \"http://adm:pass@127.0.0.1:15984/baseball_1/\" -d '{}'\r\ncurl -H 'Content-Type: application/json' -X POST \"http://adm:pass@127.0.0.1:15984/_replicate\" -d '{\"source\":{\"url\":\"http://adm:pass@127.0.0.1:15984/baseball_1\"},\"target\":{\"url\":\"https://adm:pass@127.0.0.1:15984/baseball_2\"}}' | jq '.'\r\n```\r\n\r\nBefore I got:\r\n\r\n```\r\n      \"start_time\": \"Wed, 09 Jan 2019 01:05:27 GMT\",\r\n      \"end_time\": \"Tue, 08 Jan 2019 20:10:29 GMT\",\r\n```\r\n\r\nAfter\r\n\r\n```\r\n      \"start_time\": \"Tue, 08 Jan 2019 20:16:37 GMT\",\r\n      \"end_time\": \"Tue, 08 Jan 2019 20:16:40 GMT\",\r\n```\r\n\r\nWith the times being \r\n\r\n```\r\n $ date\r\nTue Jan  8 15:29:19 EST 2019\r\n\r\n$ date -u\r\nTue Jan  8 20:29:20 UTC 2019\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452440798/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452441361","html_url":"https://github.com/apache/couchdb/issues/1843#issuecomment-452441361","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1843","id":452441361,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjQ0MTM2MQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T20:32:08Z","updated_at":"2019-01-08T20:32:08Z","author_association":"CONTRIBUTOR","body":"@jlami open_revs request which is failing above does have logic to reduce url request size actually. However it needs to receive a 414 response (which is a marker for \"url too long\").\r\n\r\nIn this case the response is 400, likely because of the #1810 issue (see details there, related to a bug in the url parser, but setting a socket buffer fixes the issue).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452441361/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452441709","html_url":"https://github.com/apache/couchdb/issues/1841#issuecomment-452441709","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1841","id":452441709,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjQ0MTcwOQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T20:33:14Z","updated_at":"2019-01-08T20:33:24Z","author_association":"CONTRIBUTOR","body":"@skeyby @wohali I tried to fix it in https://github.com/apache/couchdb/pull/1845 give it a try and see if it works on your machines","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452441709/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452442366","html_url":"https://github.com/apache/couchdb/pull/1845#issuecomment-452442366","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1845","id":452442366,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjQ0MjM2Ng==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T20:35:40Z","updated_at":"2019-01-08T20:35:40Z","author_association":"CONTRIBUTOR","body":"Also for reference, here is what rfc1123_date does:\r\n\r\nhttps://github.com/erlang/otp/blob/d6285b0a347b9489ce939511ee9a979acd868f71/lib/inets/src/http_server/httpd_util.erl#L334","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452442366/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452467465","html_url":"https://github.com/apache/couchdb/issues/1843#issuecomment-452467465","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1843","id":452467465,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjQ2NzQ2NQ==","user":{"login":"jlami","id":8522993,"node_id":"MDQ6VXNlcjg1MjI5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/8522993?v=4","gravatar_id":"","url":"https://api.github.com/users/jlami","html_url":"https://github.com/jlami","followers_url":"https://api.github.com/users/jlami/followers","following_url":"https://api.github.com/users/jlami/following{/other_user}","gists_url":"https://api.github.com/users/jlami/gists{/gist_id}","starred_url":"https://api.github.com/users/jlami/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jlami/subscriptions","organizations_url":"https://api.github.com/users/jlami/orgs","repos_url":"https://api.github.com/users/jlami/repos","events_url":"https://api.github.com/users/jlami/events{/privacy}","received_events_url":"https://api.github.com/users/jlami/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-08T22:00:19Z","updated_at":"2019-01-08T22:00:19Z","author_association":"NONE","body":"Ok, that sounds better. Without knowing about the 414 I was expecting the normal 400 failure again. \r\n\r\nWill let you know if a higher recbuf fixes it for now.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452467465/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452589970","html_url":"https://github.com/apache/couchdb/pull/1789#issuecomment-452589970","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1789","id":452589970,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjU4OTk3MA==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-09T06:47:29Z","updated_at":"2019-01-09T06:47:29Z","author_association":"CONTRIBUTOR","body":"+1, new text index tests worked with partitioned dbs and mango text regression suite passed also","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452589970/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452611550","html_url":"https://github.com/apache/couchdb/issues/1846#issuecomment-452611550","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1846","id":452611550,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjYxMTU1MA==","user":{"login":"chintan-mishra","id":24296709,"node_id":"MDQ6VXNlcjI0Mjk2NzA5","avatar_url":"https://avatars.githubusercontent.com/u/24296709?v=4","gravatar_id":"","url":"https://api.github.com/users/chintan-mishra","html_url":"https://github.com/chintan-mishra","followers_url":"https://api.github.com/users/chintan-mishra/followers","following_url":"https://api.github.com/users/chintan-mishra/following{/other_user}","gists_url":"https://api.github.com/users/chintan-mishra/gists{/gist_id}","starred_url":"https://api.github.com/users/chintan-mishra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chintan-mishra/subscriptions","organizations_url":"https://api.github.com/users/chintan-mishra/orgs","repos_url":"https://api.github.com/users/chintan-mishra/repos","events_url":"https://api.github.com/users/chintan-mishra/events{/privacy}","received_events_url":"https://api.github.com/users/chintan-mishra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-09T08:26:38Z","updated_at":"2019-01-09T08:26:38Z","author_association":"NONE","body":"Please close this issue","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452611550/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452621087","html_url":"https://github.com/apache/couchdb/issues/1843#issuecomment-452621087","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1843","id":452621087,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjYyMTA4Nw==","user":{"login":"jlami","id":8522993,"node_id":"MDQ6VXNlcjg1MjI5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/8522993?v=4","gravatar_id":"","url":"https://api.github.com/users/jlami","html_url":"https://github.com/jlami","followers_url":"https://api.github.com/users/jlami/followers","following_url":"https://api.github.com/users/jlami/following{/other_user}","gists_url":"https://api.github.com/users/jlami/gists{/gist_id}","starred_url":"https://api.github.com/users/jlami/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jlami/subscriptions","organizations_url":"https://api.github.com/users/jlami/orgs","repos_url":"https://api.github.com/users/jlami/repos","events_url":"https://api.github.com/users/jlami/events{/privacy}","received_events_url":"https://api.github.com/users/jlami/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-09T09:00:54Z","updated_at":"2019-01-09T09:00:54Z","author_association":"NONE","body":"With a defined recvbuf of 8192 the 400 error goes away and replication seems to work.\r\n\r\nI don't see a 414 if I make a very large dummy request. It just gives a 400 again.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452621087/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452622129","html_url":"https://github.com/apache/couchdb/issues/1841#issuecomment-452622129","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1841","id":452622129,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjYyMjEyOQ==","user":{"login":"skeyby","id":1609532,"node_id":"MDQ6VXNlcjE2MDk1MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1609532?v=4","gravatar_id":"","url":"https://api.github.com/users/skeyby","html_url":"https://github.com/skeyby","followers_url":"https://api.github.com/users/skeyby/followers","following_url":"https://api.github.com/users/skeyby/following{/other_user}","gists_url":"https://api.github.com/users/skeyby/gists{/gist_id}","starred_url":"https://api.github.com/users/skeyby/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skeyby/subscriptions","organizations_url":"https://api.github.com/users/skeyby/orgs","repos_url":"https://api.github.com/users/skeyby/repos","events_url":"https://api.github.com/users/skeyby/events{/privacy}","received_events_url":"https://api.github.com/users/skeyby/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-09T09:04:32Z","updated_at":"2019-01-09T09:04:32Z","author_association":"NONE","body":"> @skeyby @wohali I tried to fix it in #1845 give it a try and see if it works on your machines\r\n\r\nHi Nick,\r\n\r\nunfortunately I don't have a \"development\" machine where I can easily try the fix.\r\n\r\nBTW the wrong field was _start time_ (and in fact that is the one you corrected in the code) not the _end time_ you referenced in the commit message...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452622129/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452744074","html_url":"https://github.com/apache/couchdb/issues/1843#issuecomment-452744074","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1843","id":452744074,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1Mjc0NDA3NA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-09T15:47:26Z","updated_at":"2019-01-09T15:47:26Z","author_association":"CONTRIBUTOR","body":"@jlami \r\n\r\nI think you were hitting the same bug in the Erlang http headers parser (exposed through Mochiweb webserver, which CouchDB is using) as #1810. Normally some proxies should send 414 and CouchDB would send it as well if you set `[httpd] max_uri_length = SomeNumber`.  So perhaps setting that is another workaround, so you'd set it to 8000 or so and when request limit is hit 414 will be returned instead.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452744074/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452745028","html_url":"https://github.com/apache/couchdb/issues/1843#issuecomment-452745028","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1843","id":452745028,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1Mjc0NTAyOA==","user":{"login":"jlami","id":8522993,"node_id":"MDQ6VXNlcjg1MjI5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/8522993?v=4","gravatar_id":"","url":"https://api.github.com/users/jlami","html_url":"https://github.com/jlami","followers_url":"https://api.github.com/users/jlami/followers","following_url":"https://api.github.com/users/jlami/following{/other_user}","gists_url":"https://api.github.com/users/jlami/gists{/gist_id}","starred_url":"https://api.github.com/users/jlami/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jlami/subscriptions","organizations_url":"https://api.github.com/users/jlami/orgs","repos_url":"https://api.github.com/users/jlami/repos","events_url":"https://api.github.com/users/jlami/events{/privacy}","received_events_url":"https://api.github.com/users/jlami/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-09T15:50:01Z","updated_at":"2019-01-09T15:50:01Z","author_association":"NONE","body":"Ok, sounds logical. But I'm hoping something like that would end up in the stable setup. Thanks for looking into this!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452745028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452827680","html_url":"https://github.com/apache/couchdb/issues/1810#issuecomment-452827680","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1810","id":452827680,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjgyNzY4MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-09T19:33:16Z","updated_at":"2019-01-09T19:35:47Z","author_association":"MEMBER","body":"OK, for those who are curious - @nickva 's patch to mochiweb does the right thing, it's just that above our discussion of `recbuf` vs. `buffer` as mochiweb settings isn't 100% clear.\r\n\r\nWith the patch to mochiweb, and a stock CouchDB (no changes in `*.ini`), we set mochiweb's `recbuf` to undefined. Mochiweb then lets the kernel manage its buffer size itself (`recbuf` is undefined), and sets the Erlang kernel buffer to `8192`.\r\n\r\nBecause the Erlang `http` packet parser requires the entire header line (URL path, cookie, anything is fair game) to be in the buffer returned from the kernel, if the request exceeds `8192` bytes, erlang/mochiweb explode, and CouchDB will return a 400. (The parser can't handle header lines split across buffers.)\r\n\r\nThe workaround for this is to set your `server_options = [{buffer, 16384}]` or other suitably large size, leaving `recbuf` undefined. This way the kernel still manages its buffer size automatically, and only the Erlang userland buffer is made bigger to handle that.\r\n\r\nThis doesn't catch 100% of the use cases - `buffer` can only be made as large as the kernel `recbuf`, and if the kernel buffer isn't big enough for all the headers, you still fail. In that case - and in my testing, you're talking about ~50k on Linux - you have to bump `recbuf` (which, in turn, auto-bumps `buffer` to the same size). This should be very, very rare, though, on modern OSes.\r\n\r\nUnfortunately there's no easy way to make mochiweb smarter here. If `buffer < recbuf`, and the line length is > `buffer`, mochiweb gets an `emsgsize` error back and returns a 400 before Couch even gets its hands on anything. If `buffer = recbuf` and the Request-uri is still too long, Erlang fails with an `http_error` message. I think our best bet is to document this.\r\n\r\nWhat's left to do:\r\n\r\n1. Write a test that bumping `[{buffer, 16384}]` for a 16k URL path is successful\r\n1. Document the above in a useful way in the CouchDB Documentation troubleshooting section\r\n1. Release 2.3.1, as this is very surprising for users.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452827680/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452832968","html_url":"https://github.com/apache/couchdb/issues/1848#issuecomment-452832968","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1848","id":452832968,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjgzMjk2OA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-09T19:48:16Z","updated_at":"2019-01-09T19:48:16Z","author_association":"MEMBER","body":"You need to uninstall your `js` package first, then you can install our `couch-js` package.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452832968/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452836235","html_url":"https://github.com/apache/couchdb/issues/1849#issuecomment-452836235","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1849","id":452836235,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjgzNjIzNQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-09T19:58:01Z","updated_at":"2019-01-09T19:58:01Z","author_association":"MEMBER","body":"It's there, and has been since the date we announced the release:\r\n\r\nhttp://apache.bintray.com/couchdb/mac/2.3.0/\r\nhttp://apache.bintray.com/couchdb/win/2.3.0/\r\nhttp://apache.bintray.com/couchdb-deb/pool/C/CouchDB/\r\nhttp://apache.bintray.com/couchdb-rpm/el6/x86_64/\r\nhttp://apache.bintray.com/couchdb-rpm/el7/x86_64/\r\n\r\nWhat are you looking for that you aren't able to find?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452836235/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452836383","html_url":"https://github.com/apache/couchdb/issues/1843#issuecomment-452836383","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1843","id":452836383,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjgzNjM4Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-09T19:58:31Z","updated_at":"2019-01-09T19:58:31Z","author_association":"MEMBER","body":"Yup, we're planning a 2.3.1 release with this fix.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452836383/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452903795","html_url":"https://github.com/apache/couchdb/issues/1841#issuecomment-452903795","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1841","id":452903795,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjkwMzc5NQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-09T23:08:02Z","updated_at":"2019-01-09T23:08:02Z","author_association":"CONTRIBUTOR","body":"@skeyby Argh it looks like I put the wrong commit message in. It is fixing the start time in the code:\r\n\r\nhttps://github.com/apache/couchdb/pull/1845/files\r\n\r\nThe problem previously was that start_time was kept internally as a \"system\" timestamp. Then we translated that to the \"universal\" time and then called another function which translated from local to the universal. So it applied the same transformation twice. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/452903795/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453051825","html_url":"https://github.com/apache/couchdb/issues/1850#issuecomment-453051825","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1850","id":453051825,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzA1MTgyNQ==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-10T10:45:18Z","updated_at":"2019-01-10T10:45:18Z","author_association":"MEMBER","body":"confirmed that case is preserved on OSX for me (using dev/run)\r\n\r\nCan you show your local.ini file after the PUT in step 2 please?\r\n\r\n```\r\ncurl foo:bar@localhost:15984/_node/_local/_config/httpd/WWW-Authenticate -XPUT -d '\"Hello\"'\r\n\"\"\r\n➜  couchdb git:(feature/database-partitions) ✗ grep WWW-A ./dev/lib/node1/etc/local.ini\r\n;WWW-Authenticate = Basic realm=\"administrator\"\r\nWWW-Authenticate = Hello\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453051825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453053723","html_url":"https://github.com/apache/couchdb/issues/1850#issuecomment-453053723","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1850","id":453053723,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzA1MzcyMw==","user":{"login":"SCdF","id":583851,"node_id":"MDQ6VXNlcjU4Mzg1MQ==","avatar_url":"https://avatars.githubusercontent.com/u/583851?v=4","gravatar_id":"","url":"https://api.github.com/users/SCdF","html_url":"https://github.com/SCdF","followers_url":"https://api.github.com/users/SCdF/followers","following_url":"https://api.github.com/users/SCdF/following{/other_user}","gists_url":"https://api.github.com/users/SCdF/gists{/gist_id}","starred_url":"https://api.github.com/users/SCdF/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SCdF/subscriptions","organizations_url":"https://api.github.com/users/SCdF/orgs","repos_url":"https://api.github.com/users/SCdF/repos","events_url":"https://api.github.com/users/SCdF/events{/privacy}","received_events_url":"https://api.github.com/users/SCdF/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-10T10:51:59Z","updated_at":"2019-01-10T10:51:59Z","author_association":"NONE","body":"@rnewson it doesn't appear to be written my `local.ini`\r\n\r\n```\r\n$ cat /Users/scdf/Library/Application\\ Support/CouchDB2/etc/couchdb/local.ini\r\n<snip>\r\n[httpd]\r\nsecure_rewrites = false\r\nenable_cors = true\r\nmax_http_request_size = 134217728\r\n<snip>\r\n```\r\n\r\nLet me know if I should be looking somewhere else","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453053723/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453054183","html_url":"https://github.com/apache/couchdb/issues/1053#issuecomment-453054183","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1053","id":453054183,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzA1NDE4Mw==","user":{"login":"SohamChakraborty","id":2478694,"node_id":"MDQ6VXNlcjI0Nzg2OTQ=","avatar_url":"https://avatars.githubusercontent.com/u/2478694?v=4","gravatar_id":"","url":"https://api.github.com/users/SohamChakraborty","html_url":"https://github.com/SohamChakraborty","followers_url":"https://api.github.com/users/SohamChakraborty/followers","following_url":"https://api.github.com/users/SohamChakraborty/following{/other_user}","gists_url":"https://api.github.com/users/SohamChakraborty/gists{/gist_id}","starred_url":"https://api.github.com/users/SohamChakraborty/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SohamChakraborty/subscriptions","organizations_url":"https://api.github.com/users/SohamChakraborty/orgs","repos_url":"https://api.github.com/users/SohamChakraborty/repos","events_url":"https://api.github.com/users/SohamChakraborty/events{/privacy}","received_events_url":"https://api.github.com/users/SohamChakraborty/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-10T10:53:29Z","updated_at":"2019-01-10T10:54:30Z","author_association":"NONE","body":"@wohali I am still getting same error. Same meaning without providing --login and --password it doesn't work, and the password may need to be presented in a different manner.\r\n\r\n```\r\n# /opt/couchdb/bin/couchup replicate -a --login admin --password whateverisadminpassword\r\nStarting replication for configuration...\r\nTraceback (most recent call last):\r\n  File \"/opt/couchdb/bin/couchup\", line 508, in <module>\r\n    main(sys.argv)\r\n  File \"/opt/couchdb/bin/couchup\", line 502, in main\r\n    args.func(args)\r\n  File \"/opt/couchdb/bin/couchup\", line 223, in _replicate\r\n    auth = 'Basic ' + base64.b64encode(':'.join(args['creds']))\r\n  File \"/usr/lib/python3.6/base64.py\", line 58, in b64encode\r\n    encoded = binascii.b2a_base64(s, newline=False)\r\nTypeError: a bytes-like object is required, not 'str'\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453054183/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453055381","html_url":"https://github.com/apache/couchdb/issues/1850#issuecomment-453055381","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1850","id":453055381,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzA1NTM4MQ==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-10T10:57:36Z","updated_at":"2019-01-10T10:57:36Z","author_association":"MEMBER","body":"Ah, well that is the more likely explanation of your report, it was never persisted, so it doesn't survive restart. That is, it's not inadvertent case folding afaict.\r\n\r\nI don't know the OSX binary bundle at all so can't speculate on why it can't write to local.ini but you could you confirm my hypothesis by setting a fully lower-case property key and confirm that it is also not persisted to local.ini?\r\n\r\nSidebar: double check that there's only that local.ini, perhaps you have two installs or somesuch?\r\n\r\n@janl any thoughts on why _config can't write to local.ini?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453055381/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453056270","html_url":"https://github.com/apache/couchdb/issues/1850#issuecomment-453056270","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1850","id":453056270,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzA1NjI3MA==","user":{"login":"SCdF","id":583851,"node_id":"MDQ6VXNlcjU4Mzg1MQ==","avatar_url":"https://avatars.githubusercontent.com/u/583851?v=4","gravatar_id":"","url":"https://api.github.com/users/SCdF","html_url":"https://github.com/SCdF","followers_url":"https://api.github.com/users/SCdF/followers","following_url":"https://api.github.com/users/SCdF/following{/other_user}","gists_url":"https://api.github.com/users/SCdF/gists{/gist_id}","starred_url":"https://api.github.com/users/SCdF/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SCdF/subscriptions","organizations_url":"https://api.github.com/users/SCdF/orgs","repos_url":"https://api.github.com/users/SCdF/repos","events_url":"https://api.github.com/users/SCdF/events{/privacy}","received_events_url":"https://api.github.com/users/SCdF/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-10T11:00:35Z","updated_at":"2019-01-10T11:00:48Z","author_association":"NONE","body":">  it was never persisted, so it doesn't survive restart.\r\n\r\nA lower case version *is* persisted though, and that must be generated from my mixed case version, so that must be being stored somewhere.\r\n\r\nI'm really confused as to where though! I'm going to search my entire hdd for `local.ini` and take a look at each one. It has to be there somewhere...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453056270/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453056984","html_url":"https://github.com/apache/couchdb/issues/1850#issuecomment-453056984","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1850","id":453056984,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzA1Njk4NA==","user":{"login":"SCdF","id":583851,"node_id":"MDQ6VXNlcjU4Mzg1MQ==","avatar_url":"https://avatars.githubusercontent.com/u/583851?v=4","gravatar_id":"","url":"https://api.github.com/users/SCdF","html_url":"https://github.com/SCdF","followers_url":"https://api.github.com/users/SCdF/followers","following_url":"https://api.github.com/users/SCdF/following{/other_user}","gists_url":"https://api.github.com/users/SCdF/gists{/gist_id}","starred_url":"https://api.github.com/users/SCdF/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SCdF/subscriptions","organizations_url":"https://api.github.com/users/SCdF/orgs","repos_url":"https://api.github.com/users/SCdF/repos","events_url":"https://api.github.com/users/SCdF/events{/privacy}","received_events_url":"https://api.github.com/users/SCdF/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-10T11:03:01Z","updated_at":"2019-01-10T11:03:01Z","author_association":"NONE","body":"Note: this machine **does** have CouchDB 1.x on it as well, which I use for supporting older versions of our software. They are in different places on disk though (CouchDB 1.x is via brew, 2.x is a MacOS app). Could they be fighting?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453056984/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453059001","html_url":"https://github.com/apache/couchdb/issues/1850#issuecomment-453059001","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1850","id":453059001,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzA1OTAwMQ==","user":{"login":"SCdF","id":583851,"node_id":"MDQ6VXNlcjU4Mzg1MQ==","avatar_url":"https://avatars.githubusercontent.com/u/583851?v=4","gravatar_id":"","url":"https://api.github.com/users/SCdF","html_url":"https://github.com/SCdF","followers_url":"https://api.github.com/users/SCdF/followers","following_url":"https://api.github.com/users/SCdF/following{/other_user}","gists_url":"https://api.github.com/users/SCdF/gists{/gist_id}","starred_url":"https://api.github.com/users/SCdF/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SCdF/subscriptions","organizations_url":"https://api.github.com/users/SCdF/orgs","repos_url":"https://api.github.com/users/SCdF/repos","events_url":"https://api.github.com/users/SCdF/events{/privacy}","received_events_url":"https://api.github.com/users/SCdF/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-10T11:10:38Z","updated_at":"2019-01-10T11:10:54Z","author_association":"NONE","body":"```\r\n$ sudo find . -name \"local.ini\" 2>/dev/null\r\n./usr/local/etc/couchdb/local.ini\r\n./Users/scdf/Code/Other/couchdb/couchdb/etc/couchdb/local.ini\r\n./Users/scdf/Code/Other/angular-pouchdb/node_modules/semantic-release/test/registry/local.ini\r\n./Users/scdf/Code/Medic/medic-os/platform/packages/medic-core/settings/medic-core/couchdb/private/local.ini\r\n./Users/scdf/Library/Application Support/CouchDB2/etc/couchdb/local.ini\r\n./Applications/Xcode.app/Contents/Developer/usr/share/xcs/CouchDB/etc/couchdb/local.ini\r\n./Applications/Apache CouchDB.app/Contents/Resources/couchdbx-core/etc/local.ini\r\n```\r\n\r\nNone of those files have been touched recently. Interestingly the correct one (in `~Library`) hasn't been touched for months either. \r\n\r\nI presume these permissions are correct: `-rw-r--r--  1 scdf  staff  1189 13 Aug 20:03`, I'm running CouchDB as `scdf` so it should have write access.\r\n\r\nI have no idea where this parameter is being written 😨 ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453059001/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453060474","html_url":"https://github.com/apache/couchdb/issues/1850#issuecomment-453060474","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1850","id":453060474,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzA2MDQ3NA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-10T11:16:22Z","updated_at":"2019-01-10T11:16:22Z","author_association":"MEMBER","body":"@SCdF can you paste the output of `ps ax | grep beam`? and `ls -la /Users/scdf/Library/Application\\ Support/CouchDB2/etc/couchdb/local.ini`","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453060474/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453064664","html_url":"https://github.com/apache/couchdb/issues/1850#issuecomment-453064664","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1850","id":453064664,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzA2NDY2NA==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-10T11:32:34Z","updated_at":"2019-01-10T11:32:34Z","author_association":"MEMBER","body":"you could confirm which local.ini is used by stopping couchdb, manually adding a new item to it somewhere, and starting up again. then query :5984 as above to see if the item is there.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453064664/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453067852","html_url":"https://github.com/apache/couchdb/issues/1850#issuecomment-453067852","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1850","id":453067852,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzA2Nzg1Mg==","user":{"login":"SCdF","id":583851,"node_id":"MDQ6VXNlcjU4Mzg1MQ==","avatar_url":"https://avatars.githubusercontent.com/u/583851?v=4","gravatar_id":"","url":"https://api.github.com/users/SCdF","html_url":"https://github.com/SCdF","followers_url":"https://api.github.com/users/SCdF/followers","following_url":"https://api.github.com/users/SCdF/following{/other_user}","gists_url":"https://api.github.com/users/SCdF/gists{/gist_id}","starred_url":"https://api.github.com/users/SCdF/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SCdF/subscriptions","organizations_url":"https://api.github.com/users/SCdF/orgs","repos_url":"https://api.github.com/users/SCdF/repos","events_url":"https://api.github.com/users/SCdF/events{/privacy}","received_events_url":"https://api.github.com/users/SCdF/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-10T11:45:07Z","updated_at":"2019-01-10T11:45:07Z","author_association":"NONE","body":"@janl , Okey dokey we're getting somewhere:\r\n\r\n```\r\n$ ps ax | grep beam\r\n47368   ??  S      1:10.29 /Applications/Apache CouchDB.app/Contents/Resources/couchdbx-core/bin/../erts-8.3/bin/beam.smp -K true -A 16 -Bd -- -root /Applications/Apache CouchDB.app/Contents/Resources/couchdbx-core/bin/.. -progname couchdb -- -home /Users/scdf -- -boot /Applications/Apache CouchDB.app/Contents/Resources/couchdbx-core/bin/../releases/2.3.0/couchdb -name couchdb@localhost -setcookie monster -kernel error_logger silent -sasl sasl_error_logger false -noshell -noinput -smp enable -ssl session_lifetime 300 -config /Applications/Apache CouchDB.app/Contents/Resources/couchdbx-core/bin/../releases/2.3.0/sys.config -couch_ini /Applications/Apache CouchDB.app/Contents/Resources/couchdbx-core/etc/default.ini /Users/scdf/Library/Preferences/couchdb2-local.ini\r\n19838 s018  S+     0:00.01 grep beam\r\n\r\n$ ls -la /Users/scdf/Library/Application\\ Support/CouchDB2/etc/couchdb/local.ini\r\n-rw-r--r--  1 scdf  staff  1189 13 Aug 20:03 /Users/scdf/Library/Application Support/CouchDB2/etc/couchdb/local.ini\r\n```\r\n\r\nSo the config I'm using is `/Users/scdf/Library/Preferences/couchdb2-local.ini`. IDK if that's supposed to happen or not, but there it is?\r\n\r\nSo, repeating the gist, but checking that file each step, the badness happens when I *start* CouchDB with `WWW-Authenticate` in the file. When I start CouchDB it at some point in its startup re-writes it to disk as `www-authenticate`. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453067852/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453093248","html_url":"https://github.com/apache/couchdb/issues/1848#issuecomment-453093248","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1848","id":453093248,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzA5MzI0OA==","user":{"login":"zubeydeBurcu","id":42058883,"node_id":"MDQ6VXNlcjQyMDU4ODgz","avatar_url":"https://avatars.githubusercontent.com/u/42058883?v=4","gravatar_id":"","url":"https://api.github.com/users/zubeydeBurcu","html_url":"https://github.com/zubeydeBurcu","followers_url":"https://api.github.com/users/zubeydeBurcu/followers","following_url":"https://api.github.com/users/zubeydeBurcu/following{/other_user}","gists_url":"https://api.github.com/users/zubeydeBurcu/gists{/gist_id}","starred_url":"https://api.github.com/users/zubeydeBurcu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zubeydeBurcu/subscriptions","organizations_url":"https://api.github.com/users/zubeydeBurcu/orgs","repos_url":"https://api.github.com/users/zubeydeBurcu/repos","events_url":"https://api.github.com/users/zubeydeBurcu/events{/privacy}","received_events_url":"https://api.github.com/users/zubeydeBurcu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-10T13:19:43Z","updated_at":"2019-01-10T13:19:43Z","author_association":"NONE","body":"Thanks Joan,\r\n\r\nI have uninstalled js patch and  installed with the yum,  customer enabled yum with the js repulsitory and i am able to install  couch-js and couch db. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453093248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453097634","html_url":"https://github.com/apache/couchdb/issues/1850#issuecomment-453097634","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1850","id":453097634,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzA5NzYzNA==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-10T13:35:36Z","updated_at":"2019-01-10T13:35:36Z","author_association":"MEMBER","body":"hm, it's unusual to customise the list of ini files but perhaps that's in the binary .pkg scripting.\r\n\r\ncouchdb will write any config changes to the last file in that list, so couchdb2-local.ini should get that write. I noticed that many parts of that ps output has filenames with spaces in them. That's usually because ps is just crap at formatting things, but if the input filenames were not quoted properly, then that would be a problem.\r\n\r\nI cannot induce case folding locally and there's no call to the function that does it anywhere in the config app itself.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453097634/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453130518","html_url":"https://github.com/apache/couchdb/issues/1850#issuecomment-453130518","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1850","id":453130518,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzEzMDUxOA==","user":{"login":"SCdF","id":583851,"node_id":"MDQ6VXNlcjU4Mzg1MQ==","avatar_url":"https://avatars.githubusercontent.com/u/583851?v=4","gravatar_id":"","url":"https://api.github.com/users/SCdF","html_url":"https://github.com/SCdF","followers_url":"https://api.github.com/users/SCdF/followers","following_url":"https://api.github.com/users/SCdF/following{/other_user}","gists_url":"https://api.github.com/users/SCdF/gists{/gist_id}","starred_url":"https://api.github.com/users/SCdF/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SCdF/subscriptions","organizations_url":"https://api.github.com/users/SCdF/orgs","repos_url":"https://api.github.com/users/SCdF/repos","events_url":"https://api.github.com/users/SCdF/events{/privacy}","received_events_url":"https://api.github.com/users/SCdF/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-10T15:14:44Z","updated_at":"2019-01-10T15:15:13Z","author_association":"NONE","body":"@rnewson so AFAICT:\r\n - It's writing correctly. If anything, the bug is either the [config documentation](http://docs.couchdb.org/en/stable/config/intro.html#configuration-files) is wrong for MacOS, or for some reason my particular install is pointing somewhere else\r\n - The spaces are OK I think, all of them are just part of the `Apache CouchDB.app` name, which is not something I can control anyway\r\n - The second bug is that it's defo somehow reading that file and then re-writing it as lower case. I unfortunately suck at Erlang so I wouldn't even know where to look here :-(","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453130518/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453392086","html_url":"https://github.com/apache/couchdb/issues/1850#issuecomment-453392086","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1850","id":453392086,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzM5MjA4Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-11T06:25:18Z","updated_at":"2019-01-11T06:25:18Z","author_association":"MEMBER","body":"Think this is in @janl 's code for \"CouchDB Server\" on macOS exclusively @rnewson \r\n\r\nhttps://github.com/janl/couchdb-mac-app/blob/2c2e65528b8d10e001065bd3d5d3582373cc48a8/CouchDB%20Server/iniparser.c#L268-L279\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453392086/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453392203","html_url":"https://github.com/apache/couchdb/issues/1851#issuecomment-453392203","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1851","id":453392203,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzM5MjIwMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-11T06:25:55Z","updated_at":"2019-01-11T06:25:55Z","author_association":"MEMBER","body":"Do not use sticky sessions with CouchDB, period.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453392203/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453392751","html_url":"https://github.com/apache/couchdb/issues/1851#issuecomment-453392751","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1851","id":453392751,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzM5Mjc1MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-11T06:29:04Z","updated_at":"2019-01-11T06:29:04Z","author_association":"MEMBER","body":"That error is coming from the replicator trying to parse the AuthSession cookie header, if it's missing, the replication fails.\r\n\r\nBe sure you are not removing this header.\r\n\r\nIf you are trying to replicate against 2.2.0, you need to turn off session-based authentication in the replicator, see #1607.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453392751/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453413816","html_url":"https://github.com/apache/couchdb/pull/1783#issuecomment-453413816","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1783","id":453413816,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzQxMzgxNg==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-11T07:46:37Z","updated_at":"2019-01-11T07:46:37Z","author_association":"CONTRIBUTOR","body":"@willholley : Your additional testing suggestion revealed a conflicting issue with special/view indexes vs text indexes.\r\n\r\n```\r\n{\"$or\": []} \r\n{\"$all\": []} \r\n{\"$in\": []} \r\n{\"$and\": []} \r\n```\r\n\r\nSpecial/View - We do a full range scan, then filter.\r\nText Index - The current implementation doesn't execute the query. \r\n\r\nI think the solution is to make special/view indexes ignore the query(not execute the fabric call)  as well. But it get's a little ugly as the _explain endpoint needs to reflect this as well. \r\n\r\ncc @michaelbreslin \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453413816/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453481026","html_url":"https://github.com/apache/couchdb/issues/1850#issuecomment-453481026","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1850","id":453481026,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzQ4MTAyNg==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-11T10:57:42Z","updated_at":"2019-01-11T10:57:42Z","author_association":"MEMBER","body":"@wohali aha! well that looks like it, thanks.\r\n\r\nhttps://github.com/janl/couchdb-mac-app/blob/2c2e65528b8d10e001065bd3d5d3582373cc48a8/CouchDB%20Server/iniparser.c#L276 is where the bug is.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453481026/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453481281","html_url":"https://github.com/apache/couchdb/issues/1850#issuecomment-453481281","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1850","id":453481281,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzQ4MTI4MQ==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-11T10:58:41Z","updated_at":"2019-01-11T10:58:41Z","author_association":"MEMBER","body":"oh and https://github.com/janl/couchdb-mac-app/blob/2c2e65528b8d10e001065bd3d5d3582373cc48a8/CouchDB%20Server/iniparser.c#L427\r\n\r\n@janl just forgot that property names are case-sensitive is all.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453481281/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453490737","html_url":"https://github.com/apache/couchdb/issues/1851#issuecomment-453490737","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1851","id":453490737,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzQ5MDczNw==","user":{"login":"skeyby","id":1609532,"node_id":"MDQ6VXNlcjE2MDk1MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1609532?v=4","gravatar_id":"","url":"https://api.github.com/users/skeyby","html_url":"https://github.com/skeyby","followers_url":"https://api.github.com/users/skeyby/followers","following_url":"https://api.github.com/users/skeyby/following{/other_user}","gists_url":"https://api.github.com/users/skeyby/gists{/gist_id}","starred_url":"https://api.github.com/users/skeyby/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skeyby/subscriptions","organizations_url":"https://api.github.com/users/skeyby/orgs","repos_url":"https://api.github.com/users/skeyby/repos","events_url":"https://api.github.com/users/skeyby/events{/privacy}","received_events_url":"https://api.github.com/users/skeyby/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-11T11:38:15Z","updated_at":"2019-01-11T11:38:15Z","author_association":"NONE","body":"> Do not use sticky sessions with CouchDB, period.\r\n\r\nOK, that makes sense - I'm removing it, let's see if the error disappears.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453490737/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453493647","html_url":"https://github.com/apache/couchdb/issues/1851#issuecomment-453493647","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1851","id":453493647,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzQ5MzY0Nw==","user":{"login":"skeyby","id":1609532,"node_id":"MDQ6VXNlcjE2MDk1MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1609532?v=4","gravatar_id":"","url":"https://api.github.com/users/skeyby","html_url":"https://github.com/skeyby","followers_url":"https://api.github.com/users/skeyby/followers","following_url":"https://api.github.com/users/skeyby/following{/other_user}","gists_url":"https://api.github.com/users/skeyby/gists{/gist_id}","starred_url":"https://api.github.com/users/skeyby/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skeyby/subscriptions","organizations_url":"https://api.github.com/users/skeyby/orgs","repos_url":"https://api.github.com/users/skeyby/repos","events_url":"https://api.github.com/users/skeyby/events{/privacy}","received_events_url":"https://api.github.com/users/skeyby/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-11T11:50:42Z","updated_at":"2019-01-11T11:52:58Z","author_association":"NONE","body":"> Do not use sticky sessions with CouchDB, period.\r\n\r\nJoan, removing sticky session immediately broke Fauxton (it seems like it broke sessions).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453493647/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453559980","html_url":"https://github.com/apache/couchdb/issues/1850#issuecomment-453559980","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1850","id":453559980,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzU1OTk4MA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-11T15:46:14Z","updated_at":"2019-01-11T15:46:14Z","author_association":"MEMBER","body":"That’s stuff I’ve inherited from elsewhere, PRs welcome :)\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453559980/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453659798","html_url":"https://github.com/apache/couchdb/issues/1851#issuecomment-453659798","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1851","id":453659798,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzY1OTc5OA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-11T21:19:10Z","updated_at":"2019-01-11T21:19:10Z","author_association":"MEMBER","body":"@skeyby That means that you have not set up CouchDB correctly. You need the exact same admin password hashes on every machine - the [admins] line in local.ini must be completely identical on all boxes. As well, all machines need the exact same [couchdb] uuid. Please check.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453659798/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453660552","html_url":"https://github.com/apache/couchdb/issues/1851#issuecomment-453660552","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1851","id":453660552,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzY2MDU1Mg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-11T21:21:51Z","updated_at":"2019-01-11T21:21:51Z","author_association":"MEMBER","body":"The uuid bit is documented at https://docs.couchdb.org/en/latest/setup/cluster.html?highlight=uuid\r\n\r\nThe password hash bit is currently being hashed out (hah) over in #1803 and #1781.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453660552/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453661229","html_url":"https://github.com/apache/couchdb/issues/1854#issuecomment-453661229","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1854","id":453661229,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzY2MTIyOQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-11T21:24:20Z","updated_at":"2019-01-11T21:24:20Z","author_association":"MEMBER","body":"Not given the current AP design, no. Consistent choices cannot be made in CouchDB 1.x/2.x, and the very nature of replication makes duplicate IDs a very real possibility and problem.\r\n\r\nSee https://docs.couchdb.org/en/latest/best-practices/documents.html#alternatives-to-auto-incrementing-sequences","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453661229/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453661623","html_url":"https://github.com/apache/couchdb/issues/1854#issuecomment-453661623","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1854","id":453661623,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzY2MTYyMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-11T21:25:40Z","updated_at":"2019-01-11T21:25:40Z","author_association":"MEMBER","body":"UUIDs are unique values and are provided by default on creating a document. You can also use the `/_uuids` endpoint to get more, optionally specifying a `?count=<number>` value.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453661623/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453661899","html_url":"https://github.com/apache/couchdb/issues/1852#issuecomment-453661899","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1852","id":453661899,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzY2MTg5OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-11T21:26:43Z","updated_at":"2019-01-11T21:26:43Z","author_association":"MEMBER","body":"@garrensmith can you answer this one?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453661899/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453662636","html_url":"https://github.com/apache/couchdb/issues/1853#issuecomment-453662636","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1853","id":453662636,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzY2MjYzNg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-11T21:29:25Z","updated_at":"2019-01-11T21:29:25Z","author_association":"MEMBER","body":"@garrensmith correct me if I'm wrong, but doesn't the `$in` operator always requires a full database scan?\r\n\r\n@kobeyk did you create an index first? If so, what is the output of the same query being sent to the `/{db}/_explain` endpoint instead?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453662636/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453700931","html_url":"https://github.com/apache/couchdb/issues/1853#issuecomment-453700931","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1853","id":453700931,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzcwMDkzMQ==","user":{"login":"kobeyk","id":35584450,"node_id":"MDQ6VXNlcjM1NTg0NDUw","avatar_url":"https://avatars.githubusercontent.com/u/35584450?v=4","gravatar_id":"","url":"https://api.github.com/users/kobeyk","html_url":"https://github.com/kobeyk","followers_url":"https://api.github.com/users/kobeyk/followers","following_url":"https://api.github.com/users/kobeyk/following{/other_user}","gists_url":"https://api.github.com/users/kobeyk/gists{/gist_id}","starred_url":"https://api.github.com/users/kobeyk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kobeyk/subscriptions","organizations_url":"https://api.github.com/users/kobeyk/orgs","repos_url":"https://api.github.com/users/kobeyk/repos","events_url":"https://api.github.com/users/kobeyk/events{/privacy}","received_events_url":"https://api.github.com/users/kobeyk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-12T00:31:52Z","updated_at":"2019-01-12T00:35:31Z","author_association":"NONE","body":"@wohali this is my query explain:\r\n\r\n[this is my query explain](https://api.cacher.io/raw/a382d5aa539d3f111e5a/508cf8f5a900511dbc01/couchdb_find_in_explain.json)\r\n=======================================\r\n\r\nfull database scan","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453700931/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453922772","html_url":"https://github.com/apache/couchdb/issues/1856#issuecomment-453922772","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1856","id":453922772,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzkyMjc3Mg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-14T07:53:03Z","updated_at":"2019-01-14T07:53:03Z","author_association":"MEMBER","body":"I can't reproduce on a local 18.04 system.\r\n\r\nCan you make sure you have `apt-transport-https` installed?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453922772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453936403","html_url":"https://github.com/apache/couchdb/issues/1852#issuecomment-453936403","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1852","id":453936403,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzkzNjQwMw==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-14T09:01:43Z","updated_at":"2019-01-14T09:01:43Z","author_association":"MEMBER","body":"@fungiboletus using $or can be tricky. If you use an `$or` the same field has to be on both sides of the $or for an index to be selected:\r\n\r\n```\r\n{\r\n  \"selector\": {\r\n    \"_id\": {\r\n      \"$or\": [\r\n        \"abc\"\r\n      ]\r\n    }\r\n  },\r\n}\r\n```\r\n\r\nA query like the above will use the `_all_docs` index which is a built-in index and it will scan all the documents in the database. So that will always be very slow. Sidenote you don't need the $or in that query. It doesn't actually do anything.\r\n\r\nIf you want to write a fast $or query you need a query like this:\r\n\r\n```\r\n{\r\n    \"selector\": {\r\n        \"year\": 1977,\r\n        \"$or\": [\r\n            { \"director\": \"George Lucas\" },\r\n            { \"director\": \"Steven Spielberg\" }\r\n        ]\r\n    },\r\n```\r\n\r\nWith an index on `['year', 'director']` because `director` is in both parts of the $or it can use the index.\r\n\r\nOtherwise if you want different fields in the $or. You need to only create an index with the field outside the $or:\r\n\r\n```\r\n{\r\n    \"selector\": {\r\n        \"year\": 1977,\r\n        \"$or\": [\r\n            { \"director\": \"George Lucas\" },\r\n            { \"producer\": \"Garren\" }\r\n        ]\r\n    },\r\n\r\n```\r\n\r\nHope that helps.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453936403/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453937019","html_url":"https://github.com/apache/couchdb/issues/1853#issuecomment-453937019","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1853","id":453937019,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzkzNzAxOQ==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-14T09:04:27Z","updated_at":"2019-01-14T09:04:27Z","author_association":"MEMBER","body":"That is weird. It is using an index `ddoc\": \"_design/b25ce9a6eaeca74ab29f8b0b4d67f693362264\",` But not sure why its taking so long. If you run other queries that are just simple `$eq` queries are they also that slow. If you run the above query multiple times is it still that slow. Is the index fully built?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453937019/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453941180","html_url":"https://github.com/apache/couchdb/issues/1852#issuecomment-453941180","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1852","id":453941180,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1Mzk0MTE4MA==","user":{"login":"fungiboletus","id":45740,"node_id":"MDQ6VXNlcjQ1NzQw","avatar_url":"https://avatars.githubusercontent.com/u/45740?v=4","gravatar_id":"","url":"https://api.github.com/users/fungiboletus","html_url":"https://github.com/fungiboletus","followers_url":"https://api.github.com/users/fungiboletus/followers","following_url":"https://api.github.com/users/fungiboletus/following{/other_user}","gists_url":"https://api.github.com/users/fungiboletus/gists{/gist_id}","starred_url":"https://api.github.com/users/fungiboletus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fungiboletus/subscriptions","organizations_url":"https://api.github.com/users/fungiboletus/orgs","repos_url":"https://api.github.com/users/fungiboletus/repos","events_url":"https://api.github.com/users/fungiboletus/events{/privacy}","received_events_url":"https://api.github.com/users/fungiboletus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-14T09:20:57Z","updated_at":"2019-01-14T09:20:57Z","author_association":"NONE","body":"Thanks for the help.\r\n\r\nI tested with the request and index you suggested, and while the `total_docs_examined` looks correct, the performances are still relatively poor (many seconds). I tested a  `_find` with dates comparison returning a similar number of documents,  and a `_bulk_get` and they both run instantly.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453941180/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453979329","html_url":"https://github.com/apache/couchdb/issues/1852#issuecomment-453979329","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1852","id":453979329,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1Mzk3OTMyOQ==","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-14T11:49:21Z","updated_at":"2019-01-14T11:49:21Z","author_association":"MEMBER","body":"To expand on @garrensmith's description,`_find` is only able to perform a single index scan per query. If the selector can be mapped to a direct lookup on the index (i.e. you have a predicate which maps exactly to a key in the index) then your query performance will be roughly proportional to the number of documents that match that key in the index; it will still need to load each matching document and evaluate the selector against them before returning a result.\r\n\r\nIn the case of a disjoint `$or` such as:\r\n\r\n```\r\n\"selector\": {\r\n        \"$or\": [\r\n            { \"director\": \"George Lucas\" },\r\n            { \"director\": \"Steven Spielberg\" }\r\n        ]\r\n}\r\n```\r\n\r\nan index on `\"director\"` would be used in preference to a full database scan because it only includes documents containing a `\"director\"` field. However, the query planner doesn't narrow the keyrange down to the minimal values (which you can verify by looking at the `\"mrargs\"` field in the explain plan which lists the startkey/endkey used); it just performs a full index scan, opening every document referenced by the index and testing them individually against the selector. The performance of the query is therefore approximately proportional to the number of documents in the index.\r\n\r\nIn the case that you have different fields referenced within the `$or` predicate, the same logic applies except it will scan the primary index (`_all_docs`) instead.\r\n\r\nRegarding optimisation, the thing I would look at is execution stats - whether there's a significantly larger number of documents scanned than matches returned. For static queries, you may be able to improve matters using a [partial index](https://docs.couchdb.org/en/2.3.0/api/database/find.html#find-partial-indexes) to perform the filtering at indexing time rather than query time. For dynamic queries you may need to look at the [text indexes extension](https://developer.ibm.com/dwblog/2015/text-search-apache-couchdb/) which uses Lucene indexes and has rich support for multi-dimensional queries (e.g. using `$or` with multiple complex predicates).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453979329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453989594","html_url":"https://github.com/apache/couchdb/issues/1852#issuecomment-453989594","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1852","id":453989594,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1Mzk4OTU5NA==","user":{"login":"fungiboletus","id":45740,"node_id":"MDQ6VXNlcjQ1NzQw","avatar_url":"https://avatars.githubusercontent.com/u/45740?v=4","gravatar_id":"","url":"https://api.github.com/users/fungiboletus","html_url":"https://github.com/fungiboletus","followers_url":"https://api.github.com/users/fungiboletus/followers","following_url":"https://api.github.com/users/fungiboletus/following{/other_user}","gists_url":"https://api.github.com/users/fungiboletus/gists{/gist_id}","starred_url":"https://api.github.com/users/fungiboletus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fungiboletus/subscriptions","organizations_url":"https://api.github.com/users/fungiboletus/orgs","repos_url":"https://api.github.com/users/fungiboletus/repos","events_url":"https://api.github.com/users/fungiboletus/events{/privacy}","received_events_url":"https://api.github.com/users/fungiboletus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-14T12:31:58Z","updated_at":"2019-01-14T12:31:58Z","author_association":"NONE","body":"> `_find` is only able to perform a single index scan per query.\r\n\r\nI see, it makes sense now. Do you think this may change in the future ?\r\n\r\nI do need dynamic queries, and the indexes extensions looks promising. However I feel a bit inconfortable patching couchdb to add such feature. Also, having to maintain the indexes outside of CouchDB makes my system more complex and less resilient in my humble opinion.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/453989594/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454004783","html_url":"https://github.com/apache/couchdb/pull/1783#issuecomment-454004783","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1783","id":454004783,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDAwNDc4Mw==","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-14T13:29:56Z","updated_at":"2019-01-14T13:29:56Z","author_association":"MEMBER","body":"@tonysun83 is the text index behaviour just an optimisation or does it generate an error? If it's just an optimisation then I agree we should be consistent and apply that at a higher level regardless of the index type. If you're proposing generating an error where Mango would previously return an empty result set then I think it needs more discussion as it would be a breaking change.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454004783/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454017325","html_url":"https://github.com/apache/couchdb/issues/1851#issuecomment-454017325","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1851","id":454017325,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDAxNzMyNQ==","user":{"login":"skeyby","id":1609532,"node_id":"MDQ6VXNlcjE2MDk1MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1609532?v=4","gravatar_id":"","url":"https://api.github.com/users/skeyby","html_url":"https://github.com/skeyby","followers_url":"https://api.github.com/users/skeyby/followers","following_url":"https://api.github.com/users/skeyby/following{/other_user}","gists_url":"https://api.github.com/users/skeyby/gists{/gist_id}","starred_url":"https://api.github.com/users/skeyby/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skeyby/subscriptions","organizations_url":"https://api.github.com/users/skeyby/orgs","repos_url":"https://api.github.com/users/skeyby/repos","events_url":"https://api.github.com/users/skeyby/events{/privacy}","received_events_url":"https://api.github.com/users/skeyby/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-14T14:10:47Z","updated_at":"2019-01-14T14:10:47Z","author_association":"NONE","body":"Thanks Joan, the UUID and Secret were aligned on the two nodes unfortunately the admin users were created before aligning them. 👌🏻","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454017325/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454079925","html_url":"https://github.com/apache/couchdb/issues/1852#issuecomment-454079925","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1852","id":454079925,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDA3OTkyNQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-14T17:00:26Z","updated_at":"2019-01-14T17:00:26Z","author_association":"MEMBER","body":"@fungiboletus CouchDB has always required you to create your own indexes, whether using the Mango query syntax or the older JavaScript MapReduce engine.\r\n\r\nUnfortunately, at the moment packaging and licensing considerations make it impossible for us to directly provide you binaries with the text index extension built in. Improving this for the future is definitely on the table, see #1515 and #1269.\r\n\r\nRemeber you can use the `/{db}/_explain` endpoint to determine whether or not an index has been used for a given query.\r\n\r\nAs the situation has been explained well enough, and we have tickets for the requested work, I'm closing this bug for now.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454079925/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454080393","html_url":"https://github.com/apache/couchdb/issues/1853#issuecomment-454080393","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1853","id":454080393,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDA4MDM5Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-14T17:01:41Z","updated_at":"2019-01-14T17:01:41Z","author_association":"MEMBER","body":"@garrensmith I thought that `$in` operations always ended up in a full scan, regardless of index, am I wrong?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454080393/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454087491","html_url":"https://github.com/apache/couchdb/issues/1858#issuecomment-454087491","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1858","id":454087491,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDA4NzQ5MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-14T17:21:53Z","updated_at":"2019-01-14T17:21:53Z","author_association":"MEMBER","body":"We're not going to add a key in the exact same location as 1.x, but I'll mark this as a future enhancement request.\r\n\r\nYou can write a C# program to get the path you need:\r\n\r\nhttps://stackoverflow.com/questions/9787940/correct-method-to-get-installed-application-path-by-app-name-in-c-sharp#9788036\r\n\r\nOr, you can be sure that when you install CouchDB, you specify the installation path consistently and use that path in your scripts.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454087491/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454158282","html_url":"https://github.com/apache/couchdb/issues/1856#issuecomment-454158282","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1856","id":454158282,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDE1ODI4Mg==","user":{"login":"StoicLoofah","id":1123311,"node_id":"MDQ6VXNlcjExMjMzMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1123311?v=4","gravatar_id":"","url":"https://api.github.com/users/StoicLoofah","html_url":"https://github.com/StoicLoofah","followers_url":"https://api.github.com/users/StoicLoofah/followers","following_url":"https://api.github.com/users/StoicLoofah/following{/other_user}","gists_url":"https://api.github.com/users/StoicLoofah/gists{/gist_id}","starred_url":"https://api.github.com/users/StoicLoofah/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/StoicLoofah/subscriptions","organizations_url":"https://api.github.com/users/StoicLoofah/orgs","repos_url":"https://api.github.com/users/StoicLoofah/repos","events_url":"https://api.github.com/users/StoicLoofah/events{/privacy}","received_events_url":"https://api.github.com/users/StoicLoofah/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-14T20:56:30Z","updated_at":"2019-01-14T20:56:30Z","author_association":"NONE","body":"Looks like that is installed, too.\r\n\r\n```\r\nme@server:~$ sudo apt install apt-transport-https\r\nReading package lists... Done\r\nBuilding dependency tree       \r\nReading state information... Done\r\napt-transport-https is already the newest version (1.6.6).\r\n0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.\r\n```\r\n\r\nIf this isn't ringing any bells and isn't reproducible from your side, I'll just close it out since I'm not sure whether it makes sense for you to help me debug this if it's just my problem. Maybe someone else will stumble across it with an idea of what to do","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454158282/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454173750","html_url":"https://github.com/apache/couchdb/issues/1559#issuecomment-454173750","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1559","id":454173750,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDE3Mzc1MA==","user":{"login":"zekenaulty","id":1479041,"node_id":"MDQ6VXNlcjE0NzkwNDE=","avatar_url":"https://avatars.githubusercontent.com/u/1479041?v=4","gravatar_id":"","url":"https://api.github.com/users/zekenaulty","html_url":"https://github.com/zekenaulty","followers_url":"https://api.github.com/users/zekenaulty/followers","following_url":"https://api.github.com/users/zekenaulty/following{/other_user}","gists_url":"https://api.github.com/users/zekenaulty/gists{/gist_id}","starred_url":"https://api.github.com/users/zekenaulty/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zekenaulty/subscriptions","organizations_url":"https://api.github.com/users/zekenaulty/orgs","repos_url":"https://api.github.com/users/zekenaulty/repos","events_url":"https://api.github.com/users/zekenaulty/events{/privacy}","received_events_url":"https://api.github.com/users/zekenaulty/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-14T21:46:46Z","updated_at":"2019-01-14T21:46:46Z","author_association":"NONE","body":"Is there a proposed time frame for something like this to be implemented? \r\n\r\nI am currently looking at a project where a user may import 1,000,000+ \"rows\" of data at a time. Not needing to do a full fetch to update would be very, very nice with that amount of data. CouchDB is currently on the same server, no wire, but that may not always be the case. \r\n\r\nThis feature should be a priority, I know my use case would benefit from it, and I assume many others would as well.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454173750/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454192886","html_url":"https://github.com/apache/couchdb/issues/1856#issuecomment-454192886","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1856","id":454192886,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDE5Mjg4Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-14T22:55:45Z","updated_at":"2019-01-14T22:55:45Z","author_association":"MEMBER","body":"Yeah, sorry - I would suggest to build a new machine and see if you have the same problem again. It looks for all the world like you're not actually getting the CouchDB packages into apt. Perhaps run `aptitude` and see if you can see CouchDB at all. Also check any release pinning you might have, or any other oddball changes you made under the `/etc/apt` directory.\r\n\r\nGood luck, and do report back if/when you fix things.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454192886/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454193171","html_url":"https://github.com/apache/couchdb/issues/1559#issuecomment-454193171","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1559","id":454193171,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDE5MzE3MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-14T22:56:53Z","updated_at":"2019-01-14T22:56:53Z","author_association":"MEMBER","body":"@zekenaulty Sorry, no time frame as of yet. We are a project of volunteers -- pull requests are always welcome! :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454193171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454285236","html_url":"https://github.com/apache/couchdb/issues/1853#issuecomment-454285236","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1853","id":454285236,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDI4NTIzNg==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-15T06:50:21Z","updated_at":"2019-01-15T06:50:21Z","author_association":"MEMBER","body":"@wohali we recently changed that. In some cases, it can use an index. The explain in the link above gives some nice insight. Mango is using the index and doing a full index scan and then doing an in memory comparison, comparing each doc against the $in selector.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454285236/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454420154","html_url":"https://github.com/apache/couchdb/issues/1852#issuecomment-454420154","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1852","id":454420154,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDQyMDE1NA==","user":{"login":"fungiboletus","id":45740,"node_id":"MDQ6VXNlcjQ1NzQw","avatar_url":"https://avatars.githubusercontent.com/u/45740?v=4","gravatar_id":"","url":"https://api.github.com/users/fungiboletus","html_url":"https://github.com/fungiboletus","followers_url":"https://api.github.com/users/fungiboletus/followers","following_url":"https://api.github.com/users/fungiboletus/following{/other_user}","gists_url":"https://api.github.com/users/fungiboletus/gists{/gist_id}","starred_url":"https://api.github.com/users/fungiboletus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fungiboletus/subscriptions","organizations_url":"https://api.github.com/users/fungiboletus/orgs","repos_url":"https://api.github.com/users/fungiboletus/repos","events_url":"https://api.github.com/users/fungiboletus/events{/privacy}","received_events_url":"https://api.github.com/users/fungiboletus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-15T14:55:29Z","updated_at":"2019-01-15T14:55:29Z","author_association":"NONE","body":"Alright, thanks for your great explanations. It's appreciated.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454420154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454548277","html_url":"https://github.com/apache/couchdb/pull/1842#issuecomment-454548277","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1842","id":454548277,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDU0ODI3Nw==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-15T20:57:06Z","updated_at":"2019-01-15T20:57:06Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454548277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454567956","html_url":"https://github.com/apache/couchdb/pull/1842#issuecomment-454567956","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1842","id":454567956,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDU2Nzk1Ng==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-15T21:59:39Z","updated_at":"2019-01-15T21:59:39Z","author_association":"MEMBER","body":"@davisp Here is a thing - I see three corner cases where this approach is... not perfect.\r\n\r\n1) A bulk update that tips a partition over will insert all its docs anyway, because we gather `FullPartitions` before `merge_rev_trees` and the partition that was not already overflown is not going to be considered for a doc's size check.\r\n\r\n2) The ddocs can be inserted into overflown partition freely and there are some big ddocs out there. I believe this is what you've meant about not 100% happy, but to be honest I can't think of a clever way to do this better.\r\n\r\n3) The attachments written before the overflow check, so a rouge (or a malicious) client with an aggressive attachment's upload retry can really bloat a database.\r\n\r\nI don't see a good way to address any of these without really overcomplicated things, so this is just an awareness note to come along with my +1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454567956/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454661005","html_url":"https://github.com/apache/couchdb/issues/1857#issuecomment-454661005","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1857","id":454661005,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDY2MTAwNQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-16T05:52:38Z","updated_at":"2019-01-16T05:52:38Z","author_association":"MEMBER","body":"```\r\n[notice] 2019-01-14T07:56:41.928596Z node1@127.0.0.1 <0.15144.0> -------- rexi_buffer : started servers \r\n[notice] 2019-01-14T07:56:41.937638Z node1@127.0.0.1 <0.14937.0> -------- config: [features] scheduler set to true for reason nil\r\n[notice] 2019-01-14T07:56:42.007170Z node1@127.0.0.1 <0.15182.0> 640d3f245f 127.0.0.1:15984 127.0.0.1 undefined GET /_node/node1@127.0.0.1/_system 200 ok 1\r\n[notice] 2019-01-14T07:56:42.011893Z node1@127.0.0.1 <0.15182.0> be5192f0d9 127.0.0.1:15984 127.0.0.1 undefined GET /test_suite_db_eywat/bin_doc/foo.txt 200 ok 4\r\n[notice] 2019-01-14T07:56:42.014992Z node1@127.0.0.1 <0.15182.0> d50ba1cf01 127.0.0.1:15984 127.0.0.1 undefined GET /test_suite_db_eywat/ 200 ok 3\r\n[notice] 2019-01-14T07:56:42.015681Z node1@127.0.0.1 <0.15182.0> 18014b7636 127.0.0.1:15984 127.0.0.1 undefined GET /test_suite_db_eywat/ 200 ok 1\r\n[notice] 2019-01-14T07:56:42.016378Z node1@127.0.0.1 <0.15182.0> 964c476f03 127.0.0.1:15984 127.0.0.1 undefined GET /test_suite_db_eywat/ 200 ok 1\r\n[notice] 2019-01-14T07:56:42.017148Z node1@127.0.0.1 <0.15182.0> a6b12270da 127.0.0.1:15984 127.0.0.1 undefined GET /test_suite_db_eywat/ 200 ok 1\r\nnifs/common/prim_file_nif.c:388:owner_death_callback(): Internal error: Failed to defer prim_file close.^M\r\n[notice] 2019-01-14T07:56:42.020951Z node1@127.0.0.1 <0.15182.0> bb28d3dd56 127.0.0.1:15984 127.0.0.1 undefined DELETE /test_suite_db_eywat/?sync=true 200 ok 4\r\n[os_mon] cpu supervisor port (cpu_sup): Erlang has closed^M\r\n[os_mon] memory supervisor port (memsup): Erlang has closed^M\r\n```\r\n\r\nHmm.\r\n\r\n```\r\nii  esl-erlang                            1:21.2.2-1                                   amd64        Erlang\r\n```\r\n\r\nOops, let me try an older Erlang, that's not what's supposed to be installed.\r\n\r\n/cc @dch ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454661005/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454663039","html_url":"https://github.com/apache/couchdb/issues/1857#issuecomment-454663039","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1857","id":454663039,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDY2MzAzOQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-16T06:04:47Z","updated_at":"2019-01-16T06:04:47Z","author_association":"MEMBER","body":"OK, that fixed it. We know 21.2 is bad. We should blacklist it in our config setup.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454663039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454663857","html_url":"https://github.com/apache/couchdb/issues/1857#issuecomment-454663857","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1857","id":454663857,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDY2Mzg1Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-16T06:09:32Z","updated_at":"2019-01-16T06:22:50Z","author_association":"MEMBER","body":"Duplicate of #1837.\r\n\r\n* https://bugs.erlang.org/browse/ERL-821 (thanks @nickva )\r\n  * 21.1.2 and forward fail, not yet fixed\r\n* https://bugs.erlang.org/browse/ERL-827 (thanks @dch )\r\n  * also fails in 21.2.2\r\n\r\nWe might also want to blacklist 20.3.8.10 and lower in the 20 series:\r\n* https://bugs.erlang.org/browse/ERL-751 (thanks @davisp)\r\n  * fixed in 20.3.8.11 and up","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454663857/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454671886","html_url":"https://github.com/apache/couchdb/issues/1857#issuecomment-454671886","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1857","id":454671886,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDY3MTg4Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-16T06:52:51Z","updated_at":"2019-01-16T06:52:51Z","author_association":"MEMBER","body":"Well, poop. perhaps we can't.\r\n\r\nhttps://github.com/rebar/rebar/blob/b6d309417c502ca243f810e5313bea36951ef038/src/rebar_require_vsn.erl#L92-L102\r\n\r\n```\r\nEshell V9.3.3.7  (abort with ^G)\r\n1> erlang:system_info(otp_release).\r\n\"20\"\r\n```\r\n\r\nThat's not enough info to go on. We'd have to write something.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454671886/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454672787","html_url":"https://github.com/apache/couchdb/issues/1857#issuecomment-454672787","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1857","id":454672787,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDY3Mjc4Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-16T06:57:29Z","updated_at":"2019-01-16T06:57:29Z","author_association":"MEMBER","body":"Looks like `rebar3` gives us `blacklisted_otp_versions` which is what we really want here.\r\n\r\nhttps://github.com/erlang/rebar3/commit/04fedc7422c26002785f6e7cb6e814fdb8a2f0dd\r\n\r\nSo this is really dependent on #1428 .","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454672787/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454675818","html_url":"https://github.com/apache/couchdb/issues/1226#issuecomment-454675818","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1226","id":454675818,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDY3NTgxOA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-16T07:12:33Z","updated_at":"2019-01-16T07:12:33Z","author_association":"MEMBER","body":"@eiri earlier in this ticket you said:\r\n\r\n> A side note: I don't think chttpd family of etag functions is actually working. Make ETag generates binary make_etag, but validator etag_match/2 checks it versus tokenized header value, which gives a list of strings.\r\n> \r\n> It's an easy fix, but I'm hesitant to introduce it as part of this work, it seems that etag_respond/3 used in quite a few places in chttpd, so complete fix would make this PR rather messy.\r\n\r\nIs that still true? Do you want me to open a new ticket for you on this?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454675818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454710094","html_url":"https://github.com/apache/couchdb/issues/1857#issuecomment-454710094","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1857","id":454710094,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDcxMDA5NA==","user":{"login":"AlexanderKaraberov","id":3254818,"node_id":"MDQ6VXNlcjMyNTQ4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3254818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderKaraberov","html_url":"https://github.com/AlexanderKaraberov","followers_url":"https://api.github.com/users/AlexanderKaraberov/followers","following_url":"https://api.github.com/users/AlexanderKaraberov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderKaraberov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderKaraberov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderKaraberov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderKaraberov/orgs","repos_url":"https://api.github.com/users/AlexanderKaraberov/repos","events_url":"https://api.github.com/users/AlexanderKaraberov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderKaraberov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-16T09:25:57Z","updated_at":"2019-01-16T09:25:57Z","author_association":"CONTRIBUTOR","body":"@wohali  Does this mean that it's not safe to update our production environment to OTP 21.2? (actually we already did this). We are using the latest CouchDB 2.3+our patch set. It's been several days since we migrated to OTP 21.2 and haven't observed any serious deterioration (as of yet). What would be your or other core maintainers advice? Shall we rollback to OTP 21.1 to be sure all the things work?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454710094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454799720","html_url":"https://github.com/apache/couchdb/issues/1226#issuecomment-454799720","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1226","id":454799720,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDc5OTcyMA==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-16T14:31:41Z","updated_at":"2019-01-16T14:31:41Z","author_association":"MEMBER","body":"@wohali Thank you for the remainder, I totally forgot about this! Yes, can you please open an issue for this, I'll get to it later this week.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454799720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454804607","html_url":"https://github.com/apache/couchdb/issues/1857#issuecomment-454804607","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1857","id":454804607,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDgwNDYwNw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-01-16T14:46:04Z","updated_at":"2019-01-16T14:46:04Z","author_association":"CONTRIBUTOR","body":"There is another one as well:\r\n\r\nhttps://bugs.erlang.org/browse/ERL-830\r\n\r\nThis one might affect systems which use TLS connections (either as a server or via ibrowse as replication clients). This seems to be fixed in 21.2.3 (just released).\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/454804607/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]