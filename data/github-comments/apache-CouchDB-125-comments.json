[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1832749227","html_url":"https://github.com/apache/couchdb/pull/4883#issuecomment-1832749227","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4883","id":1832749227,"node_id":"IC_kwDOAAMmUc5tPYir","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-11-29T21:45:15Z","updated_at":"2023-11-29T21:45:15Z","author_association":"CONTRIBUTOR","body":"I see the `nouveau.zip` in the `rel/couchdb`, that works well.\r\n\r\nIs there a way to run it as is, like we can run `./bin/couchdb` and it starts up couchdb?\r\n\r\nI tried `java -jar nouveau.zip`  and got:\r\n```\r\nError: Invalid or corrupt jarfile nouveau.zip\r\n```\r\n\r\nI tried unpacking it and `./bin/server server` didn't seem to work either:\r\n\r\n```\r\n./bin/server server\r\nio.dropwizard.configuration.ConfigurationValidationException: default configuration has an error:\r\n  * rootDir must not be null\r\n\r\n\tat io.dropwizard.configuration.BaseConfigurationFactory.validate(BaseConfigurationFactory.java:272)\r\n\tat io.dropwizard.configuration.BaseConfigurationFactory.build(BaseConfigurationFactory.java:149)\r\n\tat io.dropwizard.configuration.BaseConfigurationFactory.build(BaseConfigurationFactory.java:121)\r\n\tat io.dropwizard.core.cli.ConfiguredCommand.parseConfiguration(ConfiguredCommand.java:141)\r\n\tat io.dropwizard.core.cli.ConfiguredCommand.run(ConfiguredCommand.java:85)\r\n\tat io.dropwizard.core.cli.Cli.run(Cli.java:78)\r\n\tat io.dropwizard.core.Application.run(Application.java:94)\r\n\tat org.apache.couchdb.nouveau.NouveauApplication.main(NouveauApplication.java:34)\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1832749227/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1833265914","html_url":"https://github.com/apache/couchdb/issues/4885#issuecomment-1833265914","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4885","id":1833265914,"node_id":"IC_kwDOAAMmUc5tRWr6","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-11-30T07:53:07Z","updated_at":"2023-11-30T07:53:07Z","author_association":"CONTRIBUTOR","body":"Without an error message, there is not much we can do. What is your exact error? Maybe it's a temporary problem? ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1833265914/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1833427012","html_url":"https://github.com/apache/couchdb/issues/4885#issuecomment-1833427012","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4885","id":1833427012,"node_id":"IC_kwDOAAMmUc5tR-BE","user":{"login":"ishaiavrahami","id":33962719,"node_id":"MDQ6VXNlcjMzOTYyNzE5","avatar_url":"https://avatars.githubusercontent.com/u/33962719?v=4","gravatar_id":"","url":"https://api.github.com/users/ishaiavrahami","html_url":"https://github.com/ishaiavrahami","followers_url":"https://api.github.com/users/ishaiavrahami/followers","following_url":"https://api.github.com/users/ishaiavrahami/following{/other_user}","gists_url":"https://api.github.com/users/ishaiavrahami/gists{/gist_id}","starred_url":"https://api.github.com/users/ishaiavrahami/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ishaiavrahami/subscriptions","organizations_url":"https://api.github.com/users/ishaiavrahami/orgs","repos_url":"https://api.github.com/users/ishaiavrahami/repos","events_url":"https://api.github.com/users/ishaiavrahami/events{/privacy}","received_events_url":"https://api.github.com/users/ishaiavrahami/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-11-30T09:50:08Z","updated_at":"2023-11-30T09:50:08Z","author_association":"NONE","body":"the issue was that i installed it on ubuntu 22.04 and the package is ubuntu 20.04","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1833427012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1835031863","html_url":"https://github.com/apache/couchdb/pull/4871#issuecomment-1835031863","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4871","id":1835031863,"node_id":"IC_kwDOAAMmUc5tYF03","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-01T00:17:12Z","updated_at":"2023-12-01T00:17:12Z","author_association":"CONTRIBUTOR","body":"@rnewson are you okay with the current version?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1835031863/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1836147773","html_url":"https://github.com/apache/couchdb/issues/4868#issuecomment-1836147773","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4868","id":1836147773,"node_id":"IC_kwDOAAMmUc5tcWQ9","user":{"login":"sergey-safarov","id":2562241,"node_id":"MDQ6VXNlcjI1NjIyNDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562241?v=4","gravatar_id":"","url":"https://api.github.com/users/sergey-safarov","html_url":"https://github.com/sergey-safarov","followers_url":"https://api.github.com/users/sergey-safarov/followers","following_url":"https://api.github.com/users/sergey-safarov/following{/other_user}","gists_url":"https://api.github.com/users/sergey-safarov/gists{/gist_id}","starred_url":"https://api.github.com/users/sergey-safarov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergey-safarov/subscriptions","organizations_url":"https://api.github.com/users/sergey-safarov/orgs","repos_url":"https://api.github.com/users/sergey-safarov/repos","events_url":"https://api.github.com/users/sergey-safarov/events{/privacy}","received_events_url":"https://api.github.com/users/sergey-safarov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-01T13:47:42Z","updated_at":"2023-12-01T13:47:42Z","author_association":"NONE","body":"Looks like CouchDB update to 3.3.2 solved the errors described in the original message.\r\nThanks @nickva again","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1836147773/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":2,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1836218025","html_url":"https://github.com/apache/couchdb/issues/4870#issuecomment-1836218025","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4870","id":1836218025,"node_id":"IC_kwDOAAMmUc5tcnap","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-01T14:34:21Z","updated_at":"2023-12-01T14:34:21Z","author_association":"MEMBER","body":"@nickva that’s a fair ask :) — We tracked it as far as checking that the retry logic has not changed (much) since 2.3.1.\r\n\r\nThe problem for us is that the app and environment that causes this fails completely with 3.x, but that’s a thing we are working on separately. Will report back :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1836218025/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1836268176","html_url":"https://github.com/apache/couchdb/issues/4868#issuecomment-1836268176","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4868","id":1836268176,"node_id":"IC_kwDOAAMmUc5tczqQ","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-01T15:02:07Z","updated_at":"2023-12-01T15:02:07Z","author_association":"CONTRIBUTOR","body":"You’re very welcome. Thanks for reaching out to us!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1836268176/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1837053696","html_url":"https://github.com/apache/couchdb/issues/4891#issuecomment-1837053696","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4891","id":1837053696,"node_id":"IC_kwDOAAMmUc5tfzcA","user":{"login":"sergey-safarov","id":2562241,"node_id":"MDQ6VXNlcjI1NjIyNDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562241?v=4","gravatar_id":"","url":"https://api.github.com/users/sergey-safarov","html_url":"https://github.com/sergey-safarov","followers_url":"https://api.github.com/users/sergey-safarov/followers","following_url":"https://api.github.com/users/sergey-safarov/following{/other_user}","gists_url":"https://api.github.com/users/sergey-safarov/gists{/gist_id}","starred_url":"https://api.github.com/users/sergey-safarov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergey-safarov/subscriptions","organizations_url":"https://api.github.com/users/sergey-safarov/orgs","repos_url":"https://api.github.com/users/sergey-safarov/repos","events_url":"https://api.github.com/users/sergey-safarov/events{/privacy}","received_events_url":"https://api.github.com/users/sergey-safarov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-02T06:00:17Z","updated_at":"2023-12-02T06:00:17Z","author_association":"NONE","body":"I have set docs_id array to one element in the my curl command and have rerproduced error.\r\nHere is stack error\r\n> [error] 2023-12-02T05:57:21.583678Z couchdb@db1a.example.com <0.19605.1025> 5ddaa614bb rexi_server: from: couchdb@db0b.example.com(<17533.26366.1526>) mfa: fabric_rpc:open_revs/3 error:undef [{fabric_rpc,open_revs,[<<\"shards/00000000-7fffffff/account/33/0d/7bfd3f38d7b0e0f2bd6ec392f975-202311.1698796803\">>,[{{<<\"_design/resources\">>,all},[]}],[{user_ctx,{user_ctx,<<\"admin\">>,[<<\"_admin\">>],<<\"default\">>}},attachments]],[]},{rexi_server,init_p,3,[{file,\"src/rexi_server.erl\"},{line,141}]}]\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1837053696/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1837056208","html_url":"https://github.com/apache/couchdb/issues/4891#issuecomment-1837056208","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4891","id":1837056208,"node_id":"IC_kwDOAAMmUc5tf0DQ","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-02T06:11:37Z","updated_at":"2023-12-02T06:11:37Z","author_association":"CONTRIBUTOR","body":"The `fabric_rpc:all_docs/3 exit:timeout` looks a fabric request timeout. Wonder if it would help to increase fabric request_timeout value a bit:\r\n\r\n```ini\r\n[fabric]\r\nrequest_timeout = 60000\r\n```\r\n\r\nMaybe make that 90000 (90 sec).\r\n\r\nThis one `mfa: fabric_rpc:open_revs/3 error:undef` indicates one of the functions in the call is not defined at all. In this case the first candidate might be the the `fabric_rpc:open_revs/3` function itself. That function is new in 3.3.2 so wonder if there is a possibility some of your nodes were upgraded and some were not , and some new nodes were dispatching requests to un-upgraded yet (old) <3.3.2 nodes.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1837056208/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1837058886","html_url":"https://github.com/apache/couchdb/issues/4891#issuecomment-1837058886","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4891","id":1837058886,"node_id":"IC_kwDOAAMmUc5tf0tG","user":{"login":"sergey-safarov","id":2562241,"node_id":"MDQ6VXNlcjI1NjIyNDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562241?v=4","gravatar_id":"","url":"https://api.github.com/users/sergey-safarov","html_url":"https://github.com/sergey-safarov","followers_url":"https://api.github.com/users/sergey-safarov/followers","following_url":"https://api.github.com/users/sergey-safarov/following{/other_user}","gists_url":"https://api.github.com/users/sergey-safarov/gists{/gist_id}","starred_url":"https://api.github.com/users/sergey-safarov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergey-safarov/subscriptions","organizations_url":"https://api.github.com/users/sergey-safarov/orgs","repos_url":"https://api.github.com/users/sergey-safarov/repos","events_url":"https://api.github.com/users/sergey-safarov/events{/privacy}","received_events_url":"https://api.github.com/users/sergey-safarov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-02T06:26:33Z","updated_at":"2023-12-02T06:26:33Z","author_association":"NONE","body":"yes, you are correct.\r\nI found used wrong verions on the one node. Here on the two nodes used 3.3.2 and on the one node 3.2.1\r\nThank you for hint.\r\nClosing.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1837058886/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1837108807","html_url":"https://github.com/apache/couchdb/issues/4890#issuecomment-1837108807","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4890","id":1837108807,"node_id":"IC_kwDOAAMmUc5tgA5H","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-02T10:02:54Z","updated_at":"2023-12-02T10:02:54Z","author_association":"MEMBER","body":"That's a neat fix for a real problem. PR please.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1837108807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1837824729","html_url":"https://github.com/apache/couchdb/pull/4893#issuecomment-1837824729","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4893","id":1837824729,"node_id":"IC_kwDOAAMmUc5tivrZ","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T04:32:09Z","updated_at":"2023-12-04T04:32:09Z","author_association":"CONTRIBUTOR","body":"> +1\r\n> \r\n> Python has a built-in ini parser at some time in the future we could probably use that instead of the hack_ini_local thing we have there.\r\n\r\nOh, nice. An actual parser _would_ be a good idea. Thanks for the suggestion!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1837824729/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1839112672","html_url":"https://github.com/apache/couchdb/pull/4813#issuecomment-1839112672","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4813","id":1839112672,"node_id":"IC_kwDOAAMmUc5tnqHg","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T17:18:29Z","updated_at":"2023-12-04T17:18:29Z","author_association":"CONTRIBUTOR","body":"> nice improvements here. I tried it out in remsh also and found everything working the way we discussed.\r\n\r\nThanks for the review, Bob.\r\n\r\nUnfortunately, while this PR does indeed \"fix\" `reload` to honor delete markers, it turns out that at least one big downstream user actually _relies_ on this bug to operate their DBaaS. I've added some details in the Additional Context of this issue: https://github.com/apache/couchdb/issues/4892","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1839112672/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1839122091","html_url":"https://github.com/apache/couchdb/pull/4813#issuecomment-1839122091","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4813","id":1839122091,"node_id":"IC_kwDOAAMmUc5tnsar","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T17:23:33Z","updated_at":"2023-12-04T17:23:33Z","author_association":"MEMBER","body":"hm, that's unfortunate, but not a good enough reason not fix a bug imo.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1839122091/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1839127108","html_url":"https://github.com/apache/couchdb/issues/4892#issuecomment-1839127108","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4892","id":1839127108,"node_id":"IC_kwDOAAMmUc5tntpE","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T17:26:24Z","updated_at":"2023-12-04T17:26:24Z","author_association":"MEMBER","body":"That's unfortunate (for Cloudant). Could you explain what this \"fiasco\" actually is? The text above appears not to mention what problems ensue from fixing this bug.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1839127108/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1839179549","html_url":"https://github.com/apache/couchdb/issues/4892#issuecomment-1839179549","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4892","id":1839179549,"node_id":"IC_kwDOAAMmUc5tn6cd","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T17:57:54Z","updated_at":"2023-12-04T21:44:30Z","author_association":"CONTRIBUTOR","body":"> That's unfortunate (for Cloudant). Could you explain what this \"fiasco\" actually is? The text above appears not to mention what problems ensue from fixing this bug.\r\n\r\nThe specific problems are that Cloudant manages `default.ini` with chef, but uses persistent `set` and `delete` which write to an unmanaged `local.ini`.  Cloudant operators don't appreciate they are writing delete markers into `local.ini`, and use `reload` extensively to mask the inconsistency. TBF, \"delete markers\" arguably do not conform to the principle of least surprise.\r\n\r\nIf we \"fix\" `reload` to ignore delete markers, then those persistent deletes would end up preventing the managed values in `default.ini` from ever being used. The settings they assumed would come from chef would be ignored.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1839179549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1839291517","html_url":"https://github.com/apache/couchdb/pull/4894#issuecomment-1839291517","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4894","id":1839291517,"node_id":"IC_kwDOAAMmUc5toVx9","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T19:06:43Z","updated_at":"2023-12-04T19:06:43Z","author_association":"CONTRIBUTOR","body":"For the failing tests we'd probably want to either mock config get or make sure config app is started.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1839291517/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1839735643","html_url":"https://github.com/apache/couchdb/issues/1624#issuecomment-1839735643","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1624","id":1839735643,"node_id":"IC_kwDOAAMmUc5tqCNb","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T23:42:41Z","updated_at":"2023-12-04T23:42:41Z","author_association":"CONTRIBUTOR","body":"This issue seems tied to the behavior of delete markers which is not necessarily related to writing to the last file in the config chain. Let's re-open it as it may be possible to fix without completely re-writting the config system.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1839735643/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1839812596","html_url":"https://github.com/apache/couchdb/pull/4895#issuecomment-1839812596","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4895","id":1839812596,"node_id":"IC_kwDOAAMmUc5tqU_0","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T00:50:20Z","updated_at":"2023-12-05T00:50:20Z","author_association":"CONTRIBUTOR","body":"A merge of all commits doesn't merge properly it seems. We were not diligent enough to cherry-pick them exactly it seems. The best we can do is probably just cherry-pick the version updates to 3.3.3 and the release notes which we do here: https://github.com/apache/couchdb/pull/4896","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1839812596/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1839862757","html_url":"https://github.com/apache/couchdb/pull/4894#issuecomment-1839862757","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4894","id":1839862757,"node_id":"IC_kwDOAAMmUc5tqhPl","user":{"login":"chewbranca","id":5326,"node_id":"MDQ6VXNlcjUzMjY=","avatar_url":"https://avatars.githubusercontent.com/u/5326?v=4","gravatar_id":"","url":"https://api.github.com/users/chewbranca","html_url":"https://github.com/chewbranca","followers_url":"https://api.github.com/users/chewbranca/followers","following_url":"https://api.github.com/users/chewbranca/following{/other_user}","gists_url":"https://api.github.com/users/chewbranca/gists{/gist_id}","starred_url":"https://api.github.com/users/chewbranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chewbranca/subscriptions","organizations_url":"https://api.github.com/users/chewbranca/orgs","repos_url":"https://api.github.com/users/chewbranca/repos","events_url":"https://api.github.com/users/chewbranca/events{/privacy}","received_events_url":"https://api.github.com/users/chewbranca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T01:49:27Z","updated_at":"2023-12-05T01:49:27Z","author_association":"CONTRIBUTOR","body":"Hmmm... the failures in that build seem to be isolated to just `chttpd_db` for the most part, and the build only took 13 minutes, I suspect there will be many more failures. In the case here, I see we're already meck'ing `config:get/3` https://github.com/apache/couchdb/blob/main/src/chttpd/src/chttpd_db.erl#L2612 which _should_ work, unless meck only intercedes public invocations of the module, rather than an internal invocation from get_integer. You can see we're hitting `{config_meck_original, get, 3}` in the stacktrace despite that test being covered by the setup clause linked above mecking `config:get/3`:\r\n\r\n```\r\n18:15:58  chttpd_db:2687 -t_should_throw_on_invalid_n/0-fun-1-\r\n18:15:58  ----------------------------------------------------\r\n18:15:58  \r\n18:15:58  ::in function chttpd_db:'-t_should_throw_on_invalid_n/0-fun-1-'/0 (src/chttpd_db.erl, line 2690)\r\n18:15:58  in call from eunit_test:run_testfun/1 (eunit_test.erl, line 71)\r\n18:15:58  in call from eunit_proc:run_test/1 (eunit_proc.erl, line 531)\r\n18:15:58  in call from eunit_proc:with_timeout/3 (eunit_proc.erl, line 356)\r\n18:15:58  in call from eunit_proc:handle_test/2 (eunit_proc.erl, line 514)\r\n18:15:58  in call from eunit_proc:tests_inorder/3 (eunit_proc.erl, line 456)\r\n18:15:58  in call from eunit_proc:with_timeout/3 (eunit_proc.erl, line 346)\r\n18:15:58  in call from eunit_proc:run_group/2 (eunit_proc.erl, line 570)\r\n18:15:58  **error:{assertException,\r\n18:15:58      [{module,chttpd_db},\r\n18:15:58       {line,2690},\r\n18:15:58       {expression,\"parse_shards_opt ( Req )\"},\r\n18:15:58       {pattern,\"{ throw , { bad_request , Err } , [...] }\"},\r\n18:15:58       {unexpected_exception,\r\n18:15:58           {error,badarg,\r\n18:15:58               [{ets,lookup,\r\n18:15:58                    [config,{\"cluster\",\"n\"}],\r\n18:15:58                    [{error_info,#{cause => id,module => erl_stdlib_errors}}]},\r\n18:15:58                {config_meck_original,get,3,\r\n18:15:58                    [{file,\"src/config.erl\"},{line,163}]},\r\n18:15:58                {config_meck_original,get_integer,3,\r\n18:15:58                    [{file,\"src/config.erl\"},{line,71}]},\r\n18:15:58                {chttpd_db,parse_shards_opt,1,\r\n18:15:58                    [{file,\"src/chttpd_db.erl\"},{line,1951}]},\r\n18:15:58                {chttpd_db,'-t_should_throw_on_invalid_n/0-fun-1-',0,\r\n18:15:58                    [{file,\"src/chttpd_db.erl\"},{line,2690}]},\r\n18:15:58                {eunit_test,run_testfun,1,[{file,\"eunit_test.erl\"},{line,71}]},\r\n18:15:58                {eunit_proc,run_test,1,[{file,\"eunit_proc.erl\"},{line,531}]},\r\n18:15:58                {config,get_integer,[\"cluster\",\"n\",3],[]}]}}]}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1839862757/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1842030225","html_url":"https://github.com/apache/couchdb/issues/4886#issuecomment-1842030225","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4886","id":1842030225,"node_id":"IC_kwDOAAMmUc5tyyaR","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T03:35:05Z","updated_at":"2023-12-06T03:35:05Z","author_association":"CONTRIBUTOR","body":"```\r\nstate: {os_proc,\"./bin/couchjs ./share/server/main.js\",#Port<0.53>,\r\n[error] 2023-11-30T07:45:35.406044Z couchdb@localhost <0.1186.0> -------- OS Process died with status: 143\r\n[error] 2023-11-30T07:45:35.406269Z couchdb@localhost <0.1186.0> -------- gen_server <0.1186.0> terminated with reason: {exit_status,143}\r\n```\r\n\r\nThis indicates `couch_js` processes are being killed with the SIGTERM signal. 143 = 128 + 15 (SIGTERM). It's hard to say why that's happening or what's doing that. Maybe they are consuming too much memory or too many CPU resources.\r\n\r\nYou could try adjusting the values of `[query_server_config] os_process_limit = 100` and `[query_server_config] os_process_soft_limit = 100` to some other value, higher or lower and see if would make a difference.  See the config reference: https://docs.couchdb.org/en/stable/config/query-servers.html#query_server_config for more details.\r\n\r\nAlternatively, try adding more CPU or memory resources to your container/server.  \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1842030225/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1842035719","html_url":"https://github.com/apache/couchdb/issues/4850#issuecomment-1842035719","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4850","id":1842035719,"node_id":"IC_kwDOAAMmUc5tyzwH","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T03:43:34Z","updated_at":"2023-12-06T03:43:34Z","author_association":"CONTRIBUTOR","body":"@benel I wonder if updating to 3.3.3 would change the situation. We upgraded the Erlang version and also updated a few vm.args (Erlang VM) config settings that might make it work better in a containerized environment:\r\n\r\nhttps://github.com/apache/couchdb-docker/blob/58910ed097489dc588b2a87592406f8faa1bdadf/3.3.3/vm.args#L39-L44\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1842035719/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1842037380","html_url":"https://github.com/apache/couchdb/issues/4815#issuecomment-1842037380","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4815","id":1842037380,"node_id":"IC_kwDOAAMmUc5ty0KE","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T03:46:30Z","updated_at":"2023-12-06T03:46:30Z","author_association":"CONTRIBUTOR","body":"Wonder if that resolved it and if we should close the issue?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1842037380/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1842062495","html_url":"https://github.com/apache/couchdb/issues/4725#issuecomment-1842062495","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4725","id":1842062495,"node_id":"IC_kwDOAAMmUc5ty6Sf","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T04:24:38Z","updated_at":"2023-12-06T04:24:38Z","author_association":"CONTRIBUTOR","body":"* I'll second @rnewson's proposal to try a old-ddoc/new-ddoc strategy to deploy new views.\r\n\r\n* For clients could  use `stable=false&update=false` and let ken (index auto-builder) to build the indices for you in the background. Monitor with `_active_tasks`.\r\n\r\n* There is an undocumented `[smoosh.ignore] $shard = true` setting to allow the auto-compactor to ignore specific shards. For example:\r\n```\r\n[smoosh.ignore]\r\nshards/e0000000-ffffffff/dbname.1660859921 = true\r\n```\r\n\r\n* @fr2lancer if you're asking about debug logging for compaction/auto-compaction see issue https://github.com/apache/couchdb/issues/4815#issuecomment-1791518288. That's a bit tricky to set but it should work.\r\n\r\n * In your version of CouchDB 3.2.2 we had a bug calculating the slack and ratio and ended up triggering the auto-compactor too often. Consider upgrading to 3.3.3 if possible. You might find some of the compaction don't trigger as often any longer. That was fixed in 3.3.0 (https://github.com/apache/couchdb/pull/4264)\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1842062495/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1842065265","html_url":"https://github.com/apache/couchdb/issues/4723#issuecomment-1842065265","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4723","id":1842065265,"node_id":"IC_kwDOAAMmUc5ty69x","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T04:27:45Z","updated_at":"2023-12-06T04:27:45Z","author_association":"CONTRIBUTOR","body":"Having found that CIS hardened images don't seem to be [available](https://www.cisecurity.org/cis-hardened-image-list) for a general download only on cloud providers, I am closing the issue. Without an image at hand it will just end up being guess work.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1842065265/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1842181987","html_url":"https://github.com/apache/couchdb/issues/4706#issuecomment-1842181987","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4706","id":1842181987,"node_id":"IC_kwDOAAMmUc5tzXdj","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T06:40:28Z","updated_at":"2023-12-06T06:40:28Z","author_association":"CONTRIBUTOR","body":"@jjrodrig apologies, I just noticed missed your comment! I am sorry. \r\n\r\nNice find. Yeah, let's try running `@-mix clean --deps` then, that makes sense. So we will get a better `clean` target and won't fail for package builds. If you get a chance can try to make a PR with a `jenkins-` branch name prefix and that way the package builds will run.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1842181987/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1842199638","html_url":"https://github.com/apache/couchdb/issues/4639#issuecomment-1842199638","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4639","id":1842199638,"node_id":"IC_kwDOAAMmUc5tzbxW","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T06:59:22Z","updated_at":"2023-12-06T06:59:22Z","author_association":"CONTRIBUTOR","body":"@smulikHakipod the issue is that the source doesn't allow `_ensure_full_commit` so you'd have to try to replicate with `use_checkpoints = false` settings.\r\n\r\n\r\n@jdai1 The replication is probably timing out or throttling our replication job. I'd suggest trying much lower settings like 1 worker and a batch of 100 or so only. With higher retries_per_request and a high timeout.\r\n\r\nThere is a hidden (undocumented) `\"since_seq\": \"...-......\"` replication job setting that allows starting a replication changes sequence from a particular start sequence (instead of 0) once you've replicated far enough you save the update sequence then start using that as the `\"since_seq\":...` in the replication job and so on.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1842199638/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1842259307","html_url":"https://github.com/apache/couchdb/issues/4508#issuecomment-1842259307","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4508","id":1842259307,"node_id":"IC_kwDOAAMmUc5tzqVr","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T07:36:52Z","updated_at":"2023-12-06T07:36:52Z","author_association":"CONTRIBUTOR","body":"That might work, but the issue with returning other than a 200 would be strange for a GET request. You could try writting with a `w=3` consistency, though even then if a node disconnects it will be automatically downgraded to `w=2` or `w=1` and you'll get a 202 response.\r\n\r\nIf you read with `r=3` and read all the doc revisions `.../doc'?open_revs=all&latest=true'` (you might have to use `Accept: application/json` request header too) then in the coordinator there is a revision tree built using all the response from all the 3 copies and you should get the latest winning revision that way.\r\n\r\nOf course if a nodes doesn't respond, we'll automatically downgrade the response automatically to whichever nodes respond only.\r\n\r\nIf you're worried about nodes being out of sync, we've recently sped up the internal replicator, which should help with it. But that's not in a release yet.  You could build from source `main` or configure/apply some of the settings in this commit https://github.com/apache/couchdb/commit/85e1fa7913b5a564c1731ad86fbba294a9d9a16c","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1842259307/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843257644","html_url":"https://github.com/apache/couchdb/issues/4634#issuecomment-1843257644","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4634","id":1843257644,"node_id":"IC_kwDOAAMmUc5t3eEs","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T16:36:37Z","updated_at":"2023-12-06T16:36:37Z","author_association":"CONTRIBUTOR","body":"`erl_prim_loader,check_file_result,3,[]` it looks like it might not be able to perform disk I/O. Is there a chance it's a disk / volume problem.\r\n\r\nPerhaps there was something with our docker image. But like @big-r81 mention, that's quite an old image, we also just released 3.3.3, would you be able to give that release a try? Perhaps it fixed the issue  you were seeing?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843257644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843296454","html_url":"https://github.com/apache/couchdb/issues/4034#issuecomment-1843296454","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4034","id":1843296454,"node_id":"IC_kwDOAAMmUc5t3njG","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T17:00:27Z","updated_at":"2023-12-06T17:00:27Z","author_association":"CONTRIBUTOR","body":"`winning_revs_only` is now part of the 3.3.0+ release. We also just released 3.3.3 that also has a few security and replication correctness fixes so upgrade if you get a chance.\r\n\r\n`skip_deleted = true` might have to be a VDU or selector implemented. I don't know if it will be become it's own replication option currently.\r\n\r\nI'll close the issue for now. Feel free to re-open if needed.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843296454/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843457248","html_url":"https://github.com/apache/couchdb/issues/3487#issuecomment-1843457248","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3487","id":1843457248,"node_id":"IC_kwDOAAMmUc5t4Ozg","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T18:32:04Z","updated_at":"2023-12-06T18:32:04Z","author_association":"CONTRIBUTOR","body":"Wonder if this is still an issue. We recently in 3.3.0 updated the collation driver. Would you mind giving 3.3.3 a try?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843457248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843473303","html_url":"https://github.com/apache/couchdb/issues/4536#issuecomment-1843473303","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4536","id":1843473303,"node_id":"IC_kwDOAAMmUc5t4SuX","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T18:39:38Z","updated_at":"2023-12-06T18:41:02Z","author_association":"CONTRIBUTOR","body":"Making sure streaming requests processes exit when connections close fix was deployed to 3.3.3: https://github.com/apache/couchdb/pull/4736\r\n\r\nThis should prevent connections from piling up. \r\n\r\n3.3.3 also has a few security (including CVE) fixes.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843473303/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843493061","html_url":"https://github.com/apache/couchdb/issues/4538#issuecomment-1843493061","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4538","id":1843493061,"node_id":"IC_kwDOAAMmUc5t4XjF","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T18:46:47Z","updated_at":"2023-12-06T18:46:47Z","author_association":"CONTRIBUTOR","body":"Wonder if the above suggestions worked for you?\r\n\r\nSince there is no activity on the issue for a while, I'll close the issue. Feel free to re-open it of course if there is an update.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843493061/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843526463","html_url":"https://github.com/apache/couchdb/pull/4862#issuecomment-1843526463","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4862","id":1843526463,"node_id":"IC_kwDOAAMmUc5t4fs_","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T19:05:37Z","updated_at":"2023-12-06T19:05:37Z","author_association":"CONTRIBUTOR","body":"To reduce the size of the PR, wonder if it would make sense to extract the enhanced tests into a separate PR. We don't intend to change the behavior of `_changes` endpoint to tests could be updated first then optimize the doc loading separately.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843526463/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843535264","html_url":"https://github.com/apache/couchdb/issues/4621#issuecomment-1843535264","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4621","id":1843535264,"node_id":"IC_kwDOAAMmUc5t4h2g","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T19:11:54Z","updated_at":"2023-12-06T19:11:54Z","author_association":"CONTRIBUTOR","body":"This was fixed. Closing issue. Thank you for your report, @xrobau ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843535264/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843542034","html_url":"https://github.com/apache/couchdb/issues/4586#issuecomment-1843542034","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4586","id":1843542034,"node_id":"IC_kwDOAAMmUc5t4jgS","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T19:16:59Z","updated_at":"2023-12-06T19:16:59Z","author_association":"CONTRIBUTOR","body":"We now support RHEL 9 https://apache.jfrog.io/ui/repos/tree/General/couchdb-rpm/el9 (as Almalinux 9) and we just released 3.3.3. Give that a try, wonder if it will show the same memory usage pattern you saw before.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843542034/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843548291","html_url":"https://github.com/apache/couchdb/pull/4862#issuecomment-1843548291","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4862","id":1843548291,"node_id":"IC_kwDOAAMmUc5t4lCD","user":{"login":"jiahuili430","id":54631519,"node_id":"MDQ6VXNlcjU0NjMxNTE5","avatar_url":"https://avatars.githubusercontent.com/u/54631519?v=4","gravatar_id":"","url":"https://api.github.com/users/jiahuili430","html_url":"https://github.com/jiahuili430","followers_url":"https://api.github.com/users/jiahuili430/followers","following_url":"https://api.github.com/users/jiahuili430/following{/other_user}","gists_url":"https://api.github.com/users/jiahuili430/gists{/gist_id}","starred_url":"https://api.github.com/users/jiahuili430/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiahuili430/subscriptions","organizations_url":"https://api.github.com/users/jiahuili430/orgs","repos_url":"https://api.github.com/users/jiahuili430/repos","events_url":"https://api.github.com/users/jiahuili430/events{/privacy}","received_events_url":"https://api.github.com/users/jiahuili430/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T19:21:45Z","updated_at":"2023-12-06T19:21:45Z","author_association":"CONTRIBUTOR","body":"> To reduce the size of the PR, wonder if it would make sense to extract the enhanced tests into a separate PR. We don't intend to change the behavior of `_changes` endpoint to tests could be updated first then optimize the doc loading separately.\r\n\r\nSure, dropped the first commit.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843548291/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843795666","html_url":"https://github.com/apache/couchdb/issues/4897#issuecomment-1843795666","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4897","id":1843795666,"node_id":"IC_kwDOAAMmUc5t5hbS","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T22:33:29Z","updated_at":"2023-12-06T22:33:29Z","author_association":"CONTRIBUTOR","body":"* If you don't see the replications in `_scheduler/jobs` try passing in a higher `limit=N` value. By default `_scheduler/jobs` returns the first 100 jobs if you have more, pass in a higher limit value. There is a `skip=N` parameter too to skip over a number of jobs if paginating over the jobs.\r\n\r\n* 32 worker processes and 300 http connections does seems a bit high, try reducing them some. Especially with 1500 jobs per cluster (if indeed you reach that limit).\r\n\r\n* `retries_per_request = 10` also seems higher, try using 5 or so. When a single request fails it will be retried with an exponential backoff 10 retries can be a relatively long backoff so the replication job would then be stalled waiting to retry that one request. It may be better to just let the job crash and restart again.\r\n\r\n *  We just released 3.3.3, there we fixed a few security and replication related issues as well as upgraded our Erlang version (used for packages and docker) see if upgrading would make any difference.\r\n\r\n * See if there are any associated crashes or timeouts in the logs right around the time it looks like the replication jobs get \"stuck\".","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843795666/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843998781","html_url":"https://github.com/apache/couchdb/pull/4899#issuecomment-1843998781","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4899","id":1843998781,"node_id":"IC_kwDOAAMmUc5t6TA9","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-07T01:41:02Z","updated_at":"2023-12-07T01:41:02Z","author_association":"CONTRIBUTOR","body":"```\r\n% ls -lh tmp\r\n     ...   10M Dec  6 20:40 couch.log\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1843998781/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1844096552","html_url":"https://github.com/apache/couchdb/pull/4899#issuecomment-1844096552","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4899","id":1844096552,"node_id":"IC_kwDOAAMmUc5t6q4o","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-07T02:19:56Z","updated_at":"2023-12-07T02:19:56Z","author_association":"CONTRIBUTOR","body":"As luck would have it, it did fail and the logs are actually viewable in the browser: https://ci-couchdb.apache.org/blue/rest/organizations/jenkins/pipelines/jenkins-cm1/pipelines/PullRequests/branches/PR-4899/runs/1/nodes/140/steps/210/log/?start=0\r\n\r\n\r\nIt looks like nouveau elixir cluster setup is still flaky:\r\n```\r\n[2023-12-07T02:07:54.538Z]   jason 1.4.1\r\n[2023-12-07T02:07:54.538Z]   junit_formatter 3.3.1\r\n[2023-12-07T02:07:54.538Z]   ssl_verify_fun 1.1.7\r\n[2023-12-07T02:07:58.437Z] Traceback (most recent call last):\r\n[2023-12-07T02:07:58.437Z]   File \"/home/jenkins/workspace/jenkins-cm1_PullRequests_PR-4899/26.1.2/build/apache-couchdb-3.3.3-22387ff/dev/run\", line 1193, in <module>\r\n[2023-12-07T02:07:58.437Z]     main()\r\n[2023-12-07T02:07:58.437Z]   File \"/home/jenkins/workspace/jenkins-cm1_PullRequests_PR-4899/26.1.2/build/apache-couchdb-3.3.3-22387ff/dev/run\", line 96, in main\r\n[2023-12-07T02:07:58.437Z]     startup(ctx)\r\n[2023-12-07T02:07:58.437Z]   File \"/home/jenkins/workspace/jenkins-cm1_PullRequests_PR-4899/26.1.2/build/apache-couchdb-3.3.3-22387ff/dev/run\", line 852, in startup\r\n[2023-12-07T02:07:58.437Z]     cluster_setup(ctx)\r\n[2023-12-07T02:07:58.437Z]   File \"/home/jenkins/workspace/jenkins-cm1_PullRequests_PR-4899/26.1.2/build/apache-couchdb-3.3.3-22387ff/dev/run\", line 75, in wrapper\r\n[2023-12-07T02:07:58.437Z]     res = func(*args, **kwargs)\r\n[2023-12-07T02:07:58.437Z]   File \"/home/jenkins/workspace/jenkins-cm1_PullRequests_PR-4899/26.1.2/build/apache-couchdb-3.3.3-22387ff/dev/run\", line 1007, in cluster_setup\r\n[2023-12-07T02:07:58.437Z]     finish_cluster(lead_port, *ctx[\"admin\"])\r\n[2023-12-07T02:07:58.437Z]   File \"/home/jenkins/workspace/jenkins-cm1_PullRequests_PR-4899/26.1.2/build/apache-couchdb-3.3.3-22387ff/dev/run\", line 1084, in finish_cluster\r\n[2023-12-07T02:07:58.437Z]     conn.request(\r\n[2023-12-07T02:07:58.437Z]   File \"/usr/lib/python3.9/http/client.py\", line 1255, in request\r\n[2023-12-07T02:07:58.437Z]     self._send_request(method, url, body, headers, encode_chunked)\r\n[2023-12-07T02:07:58.437Z]   File \"/usr/lib/python3.9/http/client.py\", line 1301, in _send_request\r\n[2023-12-07T02:07:58.437Z]     self.endheaders(body, encode_chunked=encode_chunked)\r\n[2023-12-07T02:07:58.437Z]   File \"/usr/lib/python3.9/http/client.py\", line 1250, in endheaders\r\n[2023-12-07T02:07:58.437Z]     self._send_output(message_body, encode_chunked=encode_chunked)\r\n[2023-12-07T02:07:58.437Z]   File \"/usr/lib/python3.9/http/client.py\", line 1010, in _send_output\r\n[2023-12-07T02:07:58.437Z]     self.send(msg)\r\n[2023-12-07T02:07:58.437Z]   File \"/usr/lib/python3.9/http/client.py\", line 950, in send\r\n[2023-12-07T02:07:58.437Z]     self.connect()\r\n[2023-12-07T02:07:58.437Z]   File \"/usr/lib/python3.9/http/client.py\", line 921, in connect\r\n[2023-12-07T02:07:58.437Z]     self.sock = self._create_connection(\r\n[2023-12-07T02:07:58.437Z]   File \"/usr/lib/python3.9/socket.py\", line 843, in create_connection\r\n[2023-12-07T02:07:58.437Z]     raise err\r\n[2023-12-07T02:07:58.437Z]   File \"/usr/lib/python3.9/socket.py\", line 831, in create_connection\r\n[2023-12-07T02:07:58.437Z]     sock.connect(sa)\r\n[2023-12-07T02:07:58.437Z] ConnectionRefusedError: [Errno 111] Connection refused\r\n[2023-12-07T02:07:58.437Z] make[1]: *** [Makefile:568: nouveau-test-elixir] Error 1\r\n[2023-12-07T02:07:58.437Z] make[1]: Leaving directory '/home/jenkins/workspace/jenkins-cm1_PullRequests_PR-4899/26.1.2/build/apache-couchdb-3.3.3-22387ff'\r\n[2023-12-07T02:07:58.437Z] make: *** [Makefile:162: check] Error 2\r\n[2023-12-07T02:07:58.437Z] + make build-report\r\n```\r\n\r\nBut that's for another PR to fix. it's nice that we don't have to download the Jenkins logs just to inspect them","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1844096552/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1844406917","html_url":"https://github.com/apache/couchdb/pull/4898#issuecomment-1844406917","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4898","id":1844406917,"node_id":"IC_kwDOAAMmUc5t72qF","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-07T04:56:24Z","updated_at":"2023-12-07T04:56:24Z","author_association":"CONTRIBUTOR","body":"The `style_and_include_docs` test looks like a nice addition. One improvement we can do there in a separate PR after this merges, is to try to create a more complex revision tree so the all_docs and main styles actually return different results.\r\n\r\nThe revision tree we create doesn't have to be too complex, just to cover at least one live conflict, one deleted conflict, and a deleted doc. I'll see if I can find an example on how to do as it can be a bit tricky...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1844406917/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1845377957","html_url":"https://github.com/apache/couchdb/pull/4898#issuecomment-1845377957","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4898","id":1845377957,"node_id":"IC_kwDOAAMmUc5t_jul","user":{"login":"jiahuili430","id":54631519,"node_id":"MDQ6VXNlcjU0NjMxNTE5","avatar_url":"https://avatars.githubusercontent.com/u/54631519?v=4","gravatar_id":"","url":"https://api.github.com/users/jiahuili430","html_url":"https://github.com/jiahuili430","followers_url":"https://api.github.com/users/jiahuili430/followers","following_url":"https://api.github.com/users/jiahuili430/following{/other_user}","gists_url":"https://api.github.com/users/jiahuili430/gists{/gist_id}","starred_url":"https://api.github.com/users/jiahuili430/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiahuili430/subscriptions","organizations_url":"https://api.github.com/users/jiahuili430/orgs","repos_url":"https://api.github.com/users/jiahuili430/repos","events_url":"https://api.github.com/users/jiahuili430/events{/privacy}","received_events_url":"https://api.github.com/users/jiahuili430/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-07T13:50:36Z","updated_at":"2023-12-07T13:50:36Z","author_association":"CONTRIBUTOR","body":"Sure, I will add more test cases. Thank you for the review.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1845377957/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1846158975","html_url":"https://github.com/apache/couchdb/issues/4901#issuecomment-1846158975","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4901","id":1846158975,"node_id":"IC_kwDOAAMmUc5uCiZ_","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-07T21:45:29Z","updated_at":"2023-12-07T21:45:29Z","author_association":"CONTRIBUTOR","body":"Thanks @sergey-safarov. That looks like couch_file closed while a view_update write was pending.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1846158975/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1846175799","html_url":"https://github.com/apache/couchdb/issues/4901#issuecomment-1846175799","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4901","id":1846175799,"node_id":"IC_kwDOAAMmUc5uCmg3","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-07T22:00:31Z","updated_at":"2023-12-07T22:00:51Z","author_association":"MEMBER","body":"noting that we would not 'handle' that unexpected value in the way you might imagine. it is the erlang way to assert the positive case, safe in the knowledge that anything _unexpected_ will cause the erlang process to crash. so, while quite noisy as a log line, that looks like the right error handling.\r\n\r\nthe real question is why that erlang process crashed while it was in use. there might be other lines in the log file that tell us more.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1846175799/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1846965968","html_url":"https://github.com/apache/couchdb/issues/4901#issuecomment-1846965968","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4901","id":1846965968,"node_id":"IC_kwDOAAMmUc5uFnbQ","user":{"login":"sergey-safarov","id":2562241,"node_id":"MDQ6VXNlcjI1NjIyNDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562241?v=4","gravatar_id":"","url":"https://api.github.com/users/sergey-safarov","html_url":"https://github.com/sergey-safarov","followers_url":"https://api.github.com/users/sergey-safarov/followers","following_url":"https://api.github.com/users/sergey-safarov/following{/other_user}","gists_url":"https://api.github.com/users/sergey-safarov/gists{/gist_id}","starred_url":"https://api.github.com/users/sergey-safarov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergey-safarov/subscriptions","organizations_url":"https://api.github.com/users/sergey-safarov/orgs","repos_url":"https://api.github.com/users/sergey-safarov/repos","events_url":"https://api.github.com/users/sergey-safarov/events{/privacy}","received_events_url":"https://api.github.com/users/sergey-safarov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-08T11:00:49Z","updated_at":"2023-12-08T11:00:49Z","author_association":"NONE","body":"Here installed 3 node cluster.\r\nFor two nodes log for this time range is clean.\r\nFull error log for one node with issue follow.\r\n\r\n>[error] 2023-12-06T17:36:36.080062Z couchdb@db1a.example.com <0.26820.435> -------- CRASH REPORT Process  (<0.26820.435>) with 2 neighbors crashed with reason: no match of right hand value {'EXIT',noproc} at couch_file:pread_binary/2(line:166) <= couch_file:pread_term/2(line:155) <= couch_btree:get_node/2(line:474) <= couch_btree:lookup/3(line:314) <= couch_btree:lookup/2(line:304) <= couch_bt_engine:open_local_docs/2(line:388) <= couch_db:open_doc_int/3(line:1875) <= couch_db:open_doc/3(line:301); initial_call: {couch_index,init,['Argument__1']}, ancestors: [<0.20772.431>], message_queue_len: 0, links: [<0.20772.431>,<0.24852.435>], dictionary: [{io_priority,{view_update,<<\"shards/80000000-9fffffff/account/8d/b1/c4...\">>}}], trap_exit: false, status: running, heap_size: 2586, stack_size: 28, reductions: 6532\r\n[error] 2023-12-06T17:36:36.079813Z couchdb@db1a.example.com <0.26820.435> -------- CRASH REPORT Process  (<0.26820.435>) with 2 neighbors crashed with reason: no match of right hand value {'EXIT',noproc} at couch_file:pread_binary/2(line:166) <= couch_file:pread_term/2(line:155) <= couch_btree:get_node/2(line:474) <= couch_btree:lookup/3(line:314) <= couch_btree:lookup/2(line:304) <= couch_bt_engine:open_local_docs/2(line:388) <= couch_db:open_doc_int/3(line:1875) <= couch_db:open_doc/3(line:301); initial_call: {couch_index,init,['Argument__1']}, ancestors: [<0.20772.431>], message_queue_len: 0, links: [<0.20772.431>,<0.24852.435>], dictionary: [{io_priority,{view_update,<<\"shards/80000000-9fffffff/account/8d/b1/c4...\">>}}], trap_exit: false, status: running, heap_size: 2586, stack_size: 28, reductions: 6532\r\n    extra: []\r\n     state: {st,\"./data\",index_server_2,couchdb_indexes_by_sig_2,couchdb_indexes_by_pid_2,couchdb_indexes_by_db_2}\r\n  last msg: redacted\r\n[error] 2023-12-06T17:36:36.082938Z couchdb@db1a.example.com <0.283.0> -------- gen_server index_server_2 terminated with reason: no match of right hand value {'EXIT',noproc} at couch_file:pread_binary/2(line:166) <= couch_file:pread_term/2(line:155) <= couch_btree:get_node/2(line:474) <= couch_btree:lookup/3(line:314) <= couch_btree:lookup/2(line:304) <= couch_bt_engine:open_local_docs/2(line:388) <= couch_db:open_doc_int/3(line:1875) <= couch_db:open_doc/3(line:301) at couch_index_server:handle_info/2(line:207) <= gen_server:try_dispatch/4(line:695) <= gen_server:handle_msg/6(line:771) <= proc_lib:init_p_do_apply/3(line:226)\r\n    extra: []\r\n     state: {st,\"./data\",index_server_2,couchdb_indexes_by_sig_2,couchdb_indexes_by_pid_2,couchdb_indexes_by_db_2}\r\n  last msg: redacted\r\n[error] 2023-12-06T17:36:36.083228Z couchdb@db1a.example.com <0.283.0> -------- gen_server index_server_2 terminated with reason: no match of right hand value {'EXIT',noproc} at couch_file:pread_binary/2(line:166) <= couch_file:pread_term/2(line:155) <= couch_btree:get_node/2(line:474) <= couch_btree:lookup/3(line:314) <= couch_btree:lookup/2(line:304) <= couch_bt_engine:open_local_docs/2(line:388) <= couch_db:open_doc_int/3(line:1875) <= couch_db:open_doc/3(line:301) at couch_index_server:handle_info/2(line:207) <= gen_server:try_dispatch/4(line:695) <= gen_server:handle_msg/6(line:771) <= proc_lib:init_p_do_apply/3(line:226)\r\n[error] 2023-12-06T17:36:36.083514Z couchdb@db1a.example.com <0.283.0> -------- CRASH REPORT Process index_server_2 (<0.283.0>) with 1 neighbors exited with reason: no match of right hand value {'EXIT',noproc} at couch_file:pread_binary/2(line:166) <= couch_file:pread_term/2(line:155) <= couch_btree:get_node/2(line:474) <= couch_btree:lookup/3(line:314) <= couch_btree:lookup/2(line:304) <= couch_bt_engine:open_local_docs/2(line:388) <= couch_db:open_doc_int/3(line:1875) <= couch_db:open_doc/3(line:301) at couch_index_server:handle_info/2(line:207) <= gen_server:try_dispatch/4(line:695) <= gen_server:handle_msg/6(line:771) <= proc_lib:init_p_do_apply/3(line:226); initial_call: {couch_index_server,init,['Argument__1']}, ancestors: [couch_secondary_services,couch_sup,<0.253.0>], message_queue_len: 0, links: [<0.285.0>,<0.271.0>], dictionary: [], trap_exit: true, status: running, heap_size: 1598, stack_size: 28, reductions: 3560362\r\n[error] 2023-12-06T17:36:36.083784Z couchdb@db1a.example.com <0.283.0> -------- CRASH REPORT Process index_server_2 (<0.283.0>) with 1 neighbors exited with reason: no match of right hand value {'EXIT',noproc} at couch_file:pread_binary/2(line:166) <= couch_file:pread_term/2(line:155) <= couch_btree:get_node/2(line:474) <= couch_btree:lookup/3(line:314) <= couch_btree:lookup/2(line:304) <= couch_bt_engine:open_local_docs/2(line:388) <= couch_db:open_doc_int/3(line:1875) <= couch_db:open_doc/3(line:301) at couch_index_server:handle_info/2(line:207) <= gen_server:try_dispatch/4(line:695) <= gen_server:handle_msg/6(line:771) <= proc_lib:init_p_do_apply/3(line:226); initial_call: {couch_index_server,init,['Argument__1']}, ancestors: [couch_secondary_services,couch_sup,<0.253.0>], message_queue_len: 0, links: [<0.285.0>,<0.271.0>], dictionary: [], trap_exit: true, status: running, heap_size: 1598, stack_size: 28, reductions: 3560362\r\n[error] 2023-12-06T17:36:36.084049Z couchdb@db1a.example.com <0.271.0> -------- Supervisor couch_secondary_services had child index_server_2 started with couch_index_server:start_link(2) at <0.283.0> exit with reason no match of right hand value {'EXIT',noproc} at couch_file:pread_binary/2(line:166) <= couch_file:pread_term/2(line:155) <= couch_btree:get_node/2(line:474) <= couch_btree:lookup/3(line:314) <= couch_btree:lookup/2(line:304) <= couch_bt_engine:open_local_docs/2(line:388) <= couch_db:open_doc_int/3(line:1875) <= couch_db:open_doc/3(line:301) in context child_terminated\r\n[error] 2023-12-06T17:36:36.084248Z couchdb@db1a.example.com <0.271.0> -------- Supervisor couch_secondary_services had child index_server_2 started with couch_index_server:start_link(2) at <0.283.0> exit with reason no match of right hand value {'EXIT',noproc} at couch_file:pread_binary/2(line:166) <= couch_file:pread_term/2(line:155) <= couch_btree:get_node/2(line:474) <= couch_btree:lookup/3(line:314) <= couch_btree:lookup/2(line:304) <= couch_bt_engine:open_local_docs/2(line:388) <= couch_db:open_doc_int/3(line:1875) <= couch_db:open_doc/3(line:301) in context child_terminated\r\n\r\nAfter this timestamp and before CouchDB log is clean.\r\nI also check CouchDB process uptime and found no CouchDB process restart at this time range.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1846965968/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1847251604","html_url":"https://github.com/apache/couchdb/pull/4862#issuecomment-1847251604","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4862","id":1847251604,"node_id":"IC_kwDOAAMmUc5uGtKU","user":{"login":"jiahuili430","id":54631519,"node_id":"MDQ6VXNlcjU0NjMxNTE5","avatar_url":"https://avatars.githubusercontent.com/u/54631519?v=4","gravatar_id":"","url":"https://api.github.com/users/jiahuili430","html_url":"https://github.com/jiahuili430","followers_url":"https://api.github.com/users/jiahuili430/followers","following_url":"https://api.github.com/users/jiahuili430/following{/other_user}","gists_url":"https://api.github.com/users/jiahuili430/gists{/gist_id}","starred_url":"https://api.github.com/users/jiahuili430/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiahuili430/subscriptions","organizations_url":"https://api.github.com/users/jiahuili430/orgs","repos_url":"https://api.github.com/users/jiahuili430/repos","events_url":"https://api.github.com/users/jiahuili430/events{/privacy}","received_events_url":"https://api.github.com/users/jiahuili430/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-08T14:19:10Z","updated_at":"2023-12-08T14:19:10Z","author_association":"CONTRIBUTOR","body":"Thanks for the script, @nickva. I'll investigate more.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1847251604/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1847674992","html_url":"https://github.com/apache/couchdb/issues/4901#issuecomment-1847674992","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4901","id":1847674992,"node_id":"IC_kwDOAAMmUc5uIUhw","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-08T18:59:56Z","updated_at":"2023-12-08T18:59:56Z","author_association":"CONTRIBUTOR","body":"What's worrying here is that the index server itself seems to crash:\r\n\r\n```\r\ngen_server index_server_2 terminated with reason: no match of right hand value {'EXIT',noproc} at couch_file:pread_binary/2(line:166) <= couch_file:pread_term/2(line:155) <= couch_btree:get_node/2(line:474) <= couch_btree:lookup/3(line:314) <= couch_btree:lookup/2(line:304) <= couch_bt_engine:open_local_docs/2(line:388) <= couch_db:open_doc_int/3(line:1875) <= couch_db:open_doc/3(line:301) at couch_index_server:handle_info/2(line:207) <= gen_server:try_dispatch/4(line:695) <= gen_server:handle_msg/6(line:771) <= proc_lib:init_p_do_apply/3(line:226)\r\nextra: []\r\nstate: {st,\"./data\",index_server_2,couchdb_indexes_by_sig_2,couchdb_indexes_by_pid_2,couchdb_indexes_by_db_2}\r\nlast msg: redacted\r\n```\r\n\r\nI wonder if it's the case of reaching some lru limit or the idle timeout and then db handles are closed while index is still updating it. So something about is_idle check doesn't work (there is a race condition there?).\r\n\r\n@sergey-safarov to help debug the issue would you be able to tweak two settings:\r\n\r\n1) Make [max_dbs_open](https://docs.couchdb.org/en/stable/config/couchdb.html#couchdb/max_dbs_open) larger. Making it larger will take a bit more memory but default value is quite conservative. This may help if you have a lot database shards open or indexing at the same time.\r\n\r\n2) Set `[couchdb] idle_check_timeout = infinity`, that would eliminate the case where the db handles are periodically closed if they are idle, and we can see if that's what's involved here. At Cloudant we have that set to `infinity` for an unrelated reason. So maybe that's the reason we have not been seeing that particular crash happen as much.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1847674992/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1848606743","html_url":"https://github.com/apache/couchdb/issues/4907#issuecomment-1848606743","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4907","id":1848606743,"node_id":"IC_kwDOAAMmUc5uL4AX","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-09T18:24:21Z","updated_at":"2023-12-09T18:24:21Z","author_association":"MEMBER","body":"The restriction only applies at the top-level, so if it's possible to put your FHIR object in a subobject you'll be fine.\r\n\r\nUnfortunately it will not be possible to make this configurable for a bunch of reason, not least replication compatibility but also security aspects. The underscore prefix in couchdb is well-established and used for a variety of features.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1848606743/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1848615821","html_url":"https://github.com/apache/couchdb/issues/4907#issuecomment-1848615821","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4907","id":1848615821,"node_id":"IC_kwDOAAMmUc5uL6ON","user":{"login":"larrachecoeur","id":112547267,"node_id":"U_kgDOBrVVww","avatar_url":"https://avatars.githubusercontent.com/u/112547267?v=4","gravatar_id":"","url":"https://api.github.com/users/larrachecoeur","html_url":"https://github.com/larrachecoeur","followers_url":"https://api.github.com/users/larrachecoeur/followers","following_url":"https://api.github.com/users/larrachecoeur/following{/other_user}","gists_url":"https://api.github.com/users/larrachecoeur/gists{/gist_id}","starred_url":"https://api.github.com/users/larrachecoeur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/larrachecoeur/subscriptions","organizations_url":"https://api.github.com/users/larrachecoeur/orgs","repos_url":"https://api.github.com/users/larrachecoeur/repos","events_url":"https://api.github.com/users/larrachecoeur/events{/privacy}","received_events_url":"https://api.github.com/users/larrachecoeur/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-09T19:03:41Z","updated_at":"2023-12-09T19:03:41Z","author_association":"NONE","body":"hello robertwow ! thank you for answering immediately. in between i was out for run and ordered my thaughtsi have no control overat what level the field is set. but i see at least two nice solutions1. wrap it in a persistance-metastructure and send those candidates one level down.2. write an adapter to replace the underscore against something else for persistence and vice versa as the problem only can hapen in im / export usecaseskindly regardsmarcoAm 09.12.2023 19:24 schrieb Robert Newson ***@***.***>:\nThe restriction only applies at the top-level, so if it's possible to put your FHIR object in a subobject you'll be fine.\nUnfortunately it will not be possible to make this configurable for a bunch of reason, not least replication compatibility but also security aspects. The underscore prefix in couchdb is well-established and used for a variety of features.\n\n—Reply to this email directly, view it on GitHub, or unsubscribe.You are receiving this because you authored the thread.Message ID: ***@***.***>","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1848615821/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1850983935","html_url":"https://github.com/apache/couchdb/issues/4909#issuecomment-1850983935","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4909","id":1850983935,"node_id":"IC_kwDOAAMmUc5uU8X_","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-11T22:20:17Z","updated_at":"2023-12-11T22:20:17Z","author_association":"MEMBER","body":"reusing an erlang process between requests is surprising to me but I can't find docs that reassure me that this was ever a promise from mochiweb.\r\n\r\nhowever, if true, it does point out our folly in using the process dictionary so freely given the blanket advice not to do so.\r\n\r\nI'd rather see us fix the real problem(s) instead of this PR. Or, perhaps, a patch for mochiweb to ensure a new process at the start of each request, even for keepalive connections.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1850983935/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1850998199","html_url":"https://github.com/apache/couchdb/issues/4909#issuecomment-1850998199","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4909","id":1850998199,"node_id":"IC_kwDOAAMmUc5uU_23","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-11T22:32:54Z","updated_at":"2023-12-11T22:32:54Z","author_association":"MEMBER","body":"chatted with davisp and he confirms the general problem too. 🤷 \r\n\r\nhe did have a better suggestion for fix. 1) record the pdict keys at the start of _our_ handle_request 2) delete any keys not in that set at the end of handle_request (in an `after`). And, yes, I think we'd have to store that list in the pdict...\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1850998199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1851004143","html_url":"https://github.com/apache/couchdb/issues/4909#issuecomment-1851004143","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4909","id":1851004143,"node_id":"IC_kwDOAAMmUc5uVBTv","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-11T22:37:58Z","updated_at":"2023-12-11T22:37:58Z","author_association":"MEMBER","body":"noting that neither davisp or I think that a mochiweb erlang process is reused across _sockets_ though. If that is happening we have a big problem, as that would be state/data passing between different clients.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1851004143/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1851014140","html_url":"https://github.com/apache/couchdb/issues/4909#issuecomment-1851014140","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4909","id":1851014140,"node_id":"IC_kwDOAAMmUc5uVDv8","user":{"login":"chewbranca","id":5326,"node_id":"MDQ6VXNlcjUzMjY=","avatar_url":"https://avatars.githubusercontent.com/u/5326?v=4","gravatar_id":"","url":"https://api.github.com/users/chewbranca","html_url":"https://github.com/chewbranca","followers_url":"https://api.github.com/users/chewbranca/followers","following_url":"https://api.github.com/users/chewbranca/following{/other_user}","gists_url":"https://api.github.com/users/chewbranca/gists{/gist_id}","starred_url":"https://api.github.com/users/chewbranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chewbranca/subscriptions","organizations_url":"https://api.github.com/users/chewbranca/orgs","repos_url":"https://api.github.com/users/chewbranca/repos","events_url":"https://api.github.com/users/chewbranca/events{/privacy}","received_events_url":"https://api.github.com/users/chewbranca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-11T22:46:49Z","updated_at":"2023-12-11T22:46:49Z","author_association":"CONTRIBUTOR","body":"Yeah I was surprised as well about the `chttpd` process reuse. I stumbled upon this because I thought it was _not_ doing that lol. @nickva mentioned we probably use the same processes to keep direct access to the same socket allowing for connection re-use from load balancers, so I didn't think injecting spawning of a new process would be a clean solution here.\r\n\r\nHmmmm... what do you consider \"better\" about that suggestion? It avoids the licensing and bleed over of including the names of the Mochiweb pdict values, but I personally prefer an explicit whitelist of the fields we will allow, rather than a dynamic approach that assumes the found live pdict value is allowed.\r\n\r\nWe already hardcode `mochiweb` in `chttpd.erl`, so it's not like the use of Mochiweb is pluggable. An alternative option would be to patch into Mochiweb a function that exposes a list of atoms used in the pdicts, `like mochiweb:pdict_values_used()` or something and then exclude that list. We could then achieve similar results as my suggested diff with `[erlang:erase(K) || K <- erlang:get() -- mochiweb:pdict_values_used()]`.\r\n\r\nI'm not really attached to any particular approach, but I don't really like the dynamic nature of the alternative suggestion.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1851014140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1851033236","html_url":"https://github.com/apache/couchdb/issues/4909#issuecomment-1851033236","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4909","id":1851033236,"node_id":"IC_kwDOAAMmUc5uVIaU","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-11T23:03:22Z","updated_at":"2023-12-11T23:03:22Z","author_association":"MEMBER","body":"my point is that whatever is in the pdict before handle_request is called is, by definition, mochiweb's entries. removing anything other than those at the end should avoid any \"leak\" now and in the future. your static approach invites problems down the line if mochiweb adds to its set and we forget to update our hard-coded list.\r\n\r\nThe true fix is to remove all reliance on the process dict in our chttpd handling.\r\n\r\nhave you a full list of potential issues caused by this process reuse across requests?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1851033236/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1851049864","html_url":"https://github.com/apache/couchdb/issues/4909#issuecomment-1851049864","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4909","id":1851049864,"node_id":"IC_kwDOAAMmUc5uVMeI","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-11T23:19:13Z","updated_at":"2023-12-11T23:19:13Z","author_association":"CONTRIBUTOR","body":"stashing away the mochiweb pdict entries and clearing everything except those at the end makes sense.\r\n\r\nwe may also have some stray messages in the mailbox and could be worth checking if we return early to the client while there are still workers finishing any doc updates or something like that ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1851049864/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1851070601","html_url":"https://github.com/apache/couchdb/issues/4909#issuecomment-1851070601","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4909","id":1851070601,"node_id":"IC_kwDOAAMmUc5uVRiJ","user":{"login":"chewbranca","id":5326,"node_id":"MDQ6VXNlcjUzMjY=","avatar_url":"https://avatars.githubusercontent.com/u/5326?v=4","gravatar_id":"","url":"https://api.github.com/users/chewbranca","html_url":"https://github.com/chewbranca","followers_url":"https://api.github.com/users/chewbranca/followers","following_url":"https://api.github.com/users/chewbranca/following{/other_user}","gists_url":"https://api.github.com/users/chewbranca/gists{/gist_id}","starred_url":"https://api.github.com/users/chewbranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chewbranca/subscriptions","organizations_url":"https://api.github.com/users/chewbranca/orgs","repos_url":"https://api.github.com/users/chewbranca/repos","events_url":"https://api.github.com/users/chewbranca/events{/privacy}","received_events_url":"https://api.github.com/users/chewbranca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-11T23:41:22Z","updated_at":"2023-12-11T23:41:33Z","author_association":"CONTRIBUTOR","body":"> stashing away the mochiweb pdict entries and clearing everything except those at the end makes sense.\r\n\r\nI think this makes sense, but how do you assert those pdict entries are for mochiweb without having a list of all mochiweb pdict entries or doing something we should avoid like `string_starts_with(\"mochi\", atom_to_list(Key))`.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1851070601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1851696096","html_url":"https://github.com/apache/couchdb/issues/4748#issuecomment-1851696096","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4748","id":1851696096,"node_id":"IC_kwDOAAMmUc5uXqPg","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-12T09:54:07Z","updated_at":"2023-12-12T09:54:07Z","author_association":"CONTRIBUTOR","body":"Linking https://github.com/apache/couchdb-pkg/issues/123","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1851696096/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1853071814","html_url":"https://github.com/apache/couchdb/pull/4911#issuecomment-1853071814","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4911","id":1853071814,"node_id":"IC_kwDOAAMmUc5uc6HG","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-13T00:24:34Z","updated_at":"2023-12-13T00:24:34Z","author_association":"CONTRIBUTOR","body":"I caught a case missed where when a change feed process exits but it doesn't have to rescan again I didn't clear its old Pid from the ets table. So I added a clause for it:\r\n\r\n```\r\n                [{DbName, _EndSeq, false, From}] ->\r\n                    ets:update_element(NewState#state.tid, DbName, {4, undefined}),\r\n                    {noreply, NewState};\r\n```\r\n\r\nAlso running on my slow laptop a few times in a row I noticed a few `couch_replicator_scheduler_docs_tests` had a few flaky timeout so I bumped their timeouts from 10 to 15","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1853071814/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1853197568","html_url":"https://github.com/apache/couchdb/issues/4912#issuecomment-1853197568","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4912","id":1853197568,"node_id":"IC_kwDOAAMmUc5udY0A","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-13T03:09:27Z","updated_at":"2023-12-13T03:09:27Z","author_association":"CONTRIBUTOR","body":"Do you see any errors or failures in the logs?\r\n\r\nYou can try to configure compaction according to https://docs.couchdb.org/en/stable/maintenance/compaction.html#compaction and see if when it triggers by following active tasks and the logs.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1853197568/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1853256533","html_url":"https://github.com/apache/couchdb/issues/4916#issuecomment-1853256533","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4916","id":1853256533,"node_id":"IC_kwDOAAMmUc5udnNV","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-13T04:37:03Z","updated_at":"2023-12-13T04:37:03Z","author_association":"CONTRIBUTOR","body":"Another one. This one doesn't explicitly show a couch_js execution error but it failed to build an index:\r\n\r\n```\r\n[2023-12-13T04:34:11.011Z] module 'couch_mrview_ddoc_updated_tests'\r\n[2023-12-13T04:34:11.011Z]   Check ddoc update actions\r\n[2023-12-13T04:34:11.011Z]     undefined\r\n[2023-12-13T04:34:11.011Z]     *** context setup failed ***\r\n[2023-12-13T04:34:11.011Z] **in function couch_mrview_util:get_view_index_state/5 (src/couch_mrview_util.erl, line 219)\r\n[2023-12-13T04:34:11.011Z] in call from couch_mrview_util:get_view/4 (src/couch_mrview_util.erl, line 153)\r\n[2023-12-13T04:34:11.011Z] in call from couch_mrview:query_view/6 (src/couch_mrview.erl, line 286)\r\n[2023-12-13T04:34:11.011Z] in call from couch_mrview_ddoc_updated_tests:setup/0 (test/eunit/couch_mrview_ddoc_updated_tests.erl, line 50)\r\n[2023-12-13T04:34:11.011Z] **throw:{not_found,missing}\r\n[2023-12-13T04:34:11.011Z] \r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1853256533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1854151758","html_url":"https://github.com/apache/couchdb/issues/4850#issuecomment-1854151758","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4850","id":1854151758,"node_id":"IC_kwDOAAMmUc5uhBxO","user":{"login":"benel","id":597307,"node_id":"MDQ6VXNlcjU5NzMwNw==","avatar_url":"https://avatars.githubusercontent.com/u/597307?v=4","gravatar_id":"","url":"https://api.github.com/users/benel","html_url":"https://github.com/benel","followers_url":"https://api.github.com/users/benel/followers","following_url":"https://api.github.com/users/benel/following{/other_user}","gists_url":"https://api.github.com/users/benel/gists{/gist_id}","starred_url":"https://api.github.com/users/benel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benel/subscriptions","organizations_url":"https://api.github.com/users/benel/orgs","repos_url":"https://api.github.com/users/benel/repos","events_url":"https://api.github.com/users/benel/events{/privacy}","received_events_url":"https://api.github.com/users/benel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-13T15:32:15Z","updated_at":"2023-12-13T15:32:15Z","author_association":"NONE","body":"Thank you Robert and Nick. I upgraded to 3.3.3. \r\nI will tell you if such a resource exhaustion occurs again.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1854151758/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1854582491","html_url":"https://github.com/apache/couchdb/issues/4916#issuecomment-1854582491","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4916","id":1854582491,"node_id":"IC_kwDOAAMmUc5uiq7b","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-13T19:30:55Z","updated_at":"2023-12-13T19:30:55Z","author_association":"CONTRIBUTOR","body":"Another example:\r\n\r\n```\r\n\r\n[2023-12-13T19:12:08.828Z] module 'couchdb_design_doc_tests'\r\n[2023-12-13T19:12:08.828Z]   Check _list functionality\r\n[2023-12-13T19:12:09.390Z]     undefined\r\n[2023-12-13T19:12:09.390Z]     *** context setup failed ***\r\n[2023-12-13T19:12:09.390Z] **in function couch_db:update_doc/4 (src/couch_db.erl, line 875)\r\n[2023-12-13T19:12:09.390Z] in call from couchdb_design_doc_tests:create_design_doc/2 (test/eunit/couchdb_design_doc_tests.erl, line 90)\r\n[2023-12-13T19:12:09.390Z] in call from couchdb_design_doc_tests:setup/0 (test/eunit/couchdb_design_doc_tests.erl, line 22)\r\n[2023-12-13T19:12:09.390Z] **throw:{bad_request,compilation_error,\r\n[2023-12-13T19:12:09.390Z]              [67,111,109,112,105,108,97,116,105,111,110,32,111,102,32,116|...]}\r\n[2023-12-13T19:12:09.390Z] \r\n[2023-12-13T19:12:09.390Z] \r\n[2023-12-13T19:12:09.390Z]   couchdb_design_doc_tests:60: -should_return_empty_when_no_docs/1-fun-1-...[0.068 s] ok\r\n[2023-12-13T19:12:09.390Z]   [done in 0.360 s]\r\n[2023-12-13T19:12:09.390Z] [done in 0.477 s]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1854582491/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1854631680","html_url":"https://github.com/apache/couchdb/issues/4892#issuecomment-1854631680","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4892","id":1854631680,"node_id":"IC_kwDOAAMmUc5ui28A","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-13T20:09:07Z","updated_at":"2023-12-13T20:09:07Z","author_association":"CONTRIBUTOR","body":"While `config:reload/0` still ignores delete markers, [support for delete markers themselves has been removed](https://github.com/apache/couchdb/pull/4813), so this is no longer an issue.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1854631680/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1854640962","html_url":"https://github.com/apache/couchdb/issues/1624#issuecomment-1854640962","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1624","id":1854640962,"node_id":"IC_kwDOAAMmUc5ui5NC","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-13T20:16:30Z","updated_at":"2023-12-13T20:16:30Z","author_association":"CONTRIBUTOR","body":"https://github.com/apache/couchdb/pull/4813 has been merged, which removes support for delete markers (e.g. lines like`key =` in `.ini` files), so `DELETE /_config/{section}/{key}` will now delete the entire line. Hopefully, this will be less surprising and confusing for users.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1854640962/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":2,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1854812953","html_url":"https://github.com/apache/couchdb/issues/4897#issuecomment-1854812953","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4897","id":1854812953,"node_id":"IC_kwDOAAMmUc5ujjMZ","user":{"login":"Sdas0000","id":138152510,"node_id":"U_kgDOCDwKPg","avatar_url":"https://avatars.githubusercontent.com/u/138152510?v=4","gravatar_id":"","url":"https://api.github.com/users/Sdas0000","html_url":"https://github.com/Sdas0000","followers_url":"https://api.github.com/users/Sdas0000/followers","following_url":"https://api.github.com/users/Sdas0000/following{/other_user}","gists_url":"https://api.github.com/users/Sdas0000/gists{/gist_id}","starred_url":"https://api.github.com/users/Sdas0000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Sdas0000/subscriptions","organizations_url":"https://api.github.com/users/Sdas0000/orgs","repos_url":"https://api.github.com/users/Sdas0000/repos","events_url":"https://api.github.com/users/Sdas0000/events{/privacy}","received_events_url":"https://api.github.com/users/Sdas0000/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-13T22:44:26Z","updated_at":"2023-12-13T22:44:26Z","author_association":"NONE","body":"Thanks Nick, we bounced our nodes to sync doc count  with master ( source ) , now we found that replication for same databases stopped replicating  once again, we have 300 databases , out of 6 /7 databases stopped replicating again on the same nodes. Anything we need to check at database/ shards level to see if there is any issue with databases. we have not yet deployed your recommended config changes , we will apply the changes and observe for few days  and let you know ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1854812953/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1856595045","html_url":"https://github.com/apache/couchdb/pull/4921#issuecomment-1856595045","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4921","id":1856595045,"node_id":"IC_kwDOAAMmUc5uqWRl","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-14T21:09:39Z","updated_at":"2023-12-14T21:09:39Z","author_association":"CONTRIBUTOR","body":"Need to add tests still","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1856595045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1857775756","html_url":"https://github.com/apache/couchdb/issues/4922#issuecomment-1857775756","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4922","id":1857775756,"node_id":"IC_kwDOAAMmUc5uu2iM","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T12:02:14Z","updated_at":"2023-12-15T12:02:14Z","author_association":"MEMBER","body":"The Erlang [regex syntax](https://www.erlang.org/doc/man/re.html#sect7) can be a little unusual. In this case, I think the issue is that, as described in [Square Brackets and Character Classes](https://www.erlang.org/doc/man/re.html#square-brackets-and-character-classes), you need to set `UTF mode` to get the behaviour you expect.\r\n\r\nChanging the query to:\r\n\r\n```json\r\n{\r\n   \"selector\": {\r\n      \"lastname\": {\r\n         \"$regex\": \"(*UTF8)(?i)^m[ü]t\"\r\n      }\r\n   }\r\n}\r\n```\r\n\r\nshould give you the correct result.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1857775756/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1857778115","html_url":"https://github.com/apache/couchdb/issues/4922#issuecomment-1857778115","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4922","id":1857778115,"node_id":"IC_kwDOAAMmUc5uu3HD","user":{"login":"muety","id":8978843,"node_id":"MDQ6VXNlcjg5Nzg4NDM=","avatar_url":"https://avatars.githubusercontent.com/u/8978843?v=4","gravatar_id":"","url":"https://api.github.com/users/muety","html_url":"https://github.com/muety","followers_url":"https://api.github.com/users/muety/followers","following_url":"https://api.github.com/users/muety/following{/other_user}","gists_url":"https://api.github.com/users/muety/gists{/gist_id}","starred_url":"https://api.github.com/users/muety/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/muety/subscriptions","organizations_url":"https://api.github.com/users/muety/orgs","repos_url":"https://api.github.com/users/muety/repos","events_url":"https://api.github.com/users/muety/events{/privacy}","received_events_url":"https://api.github.com/users/muety/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T12:04:08Z","updated_at":"2023-12-15T12:04:08Z","author_association":"NONE","body":"Awesome, thanks a lot :+1: ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1857778115/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1857788700","html_url":"https://github.com/apache/couchdb/issues/4922#issuecomment-1857788700","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4922","id":1857788700,"node_id":"IC_kwDOAAMmUc5uu5sc","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T12:12:59Z","updated_at":"2023-12-15T12:12:59Z","author_association":"CONTRIBUTOR","body":"> The Erlang [regex syntax](https://www.erlang.org/doc/man/re.html#sect7) can be a little unusual. In this case, I think the issue is that, as described in [Square Brackets and Character Classes](https://www.erlang.org/doc/man/re.html#square-brackets-and-character-classes), you need to set `UTF mode` to get the behaviour you expect.\r\n\r\nIs this mentioned in the docs?\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1857788700/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1857817628","html_url":"https://github.com/apache/couchdb/issues/4922#issuecomment-1857817628","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4922","id":1857817628,"node_id":"IC_kwDOAAMmUc5uvAwc","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-15T12:37:05Z","updated_at":"2023-12-15T12:37:05Z","author_association":"MEMBER","body":"the docs layout isn't great but we do link to the Erlang syntax for reference in https://docs.couchdb.org/en/stable/api/database/find.html#condition-operators.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1857817628/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1858747387","html_url":"https://github.com/apache/couchdb/issues/3887#issuecomment-1858747387","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3887","id":1858747387,"node_id":"IC_kwDOAAMmUc5uyjv7","user":{"login":"ajithcnambiar","id":7530033,"node_id":"MDQ6VXNlcjc1MzAwMzM=","avatar_url":"https://avatars.githubusercontent.com/u/7530033?v=4","gravatar_id":"","url":"https://api.github.com/users/ajithcnambiar","html_url":"https://github.com/ajithcnambiar","followers_url":"https://api.github.com/users/ajithcnambiar/followers","following_url":"https://api.github.com/users/ajithcnambiar/following{/other_user}","gists_url":"https://api.github.com/users/ajithcnambiar/gists{/gist_id}","starred_url":"https://api.github.com/users/ajithcnambiar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajithcnambiar/subscriptions","organizations_url":"https://api.github.com/users/ajithcnambiar/orgs","repos_url":"https://api.github.com/users/ajithcnambiar/repos","events_url":"https://api.github.com/users/ajithcnambiar/events{/privacy}","received_events_url":"https://api.github.com/users/ajithcnambiar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-16T07:19:19Z","updated_at":"2023-12-16T07:19:19Z","author_association":"NONE","body":"The replication works well in the IPv6 cluster with [CouchDB 3.3.3](https://hub.docker.com/layers/library/couchdb/3.3.3/images/sha256-cf27045a93f5d1eabf758e3d01b21e5cce109ac2f1061189d74f7c8b8dd043da) Thanks again!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1858747387/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1858748063","html_url":"https://github.com/apache/couchdb/issues/3887#issuecomment-1858748063","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3887","id":1858748063,"node_id":"IC_kwDOAAMmUc5uyj6f","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-16T07:22:49Z","updated_at":"2023-12-16T07:22:49Z","author_association":"CONTRIBUTOR","body":"Cheers, @ajithcnambiar!\r\n\r\nI'll close the issue then.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1858748063/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1862877136","html_url":"https://github.com/apache/couchdb/issues/4926#issuecomment-1862877136","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4926","id":1862877136,"node_id":"IC_kwDOAAMmUc5vCT_Q","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-19T14:36:59Z","updated_at":"2023-12-19T14:36:59Z","author_association":"CONTRIBUTOR","body":"Hey,\r\n\r\naccording to [this](https://docs.docker.com/engine/reference/commandline/stats/), I would say that the output of this command is the memory usage of the container, not from couchdb.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1862877136/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1862945795","html_url":"https://github.com/apache/couchdb/issues/4901#issuecomment-1862945795","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4901","id":1862945795,"node_id":"IC_kwDOAAMmUc5vCkwD","user":{"login":"sergey-safarov","id":2562241,"node_id":"MDQ6VXNlcjI1NjIyNDE=","avatar_url":"https://avatars.githubusercontent.com/u/2562241?v=4","gravatar_id":"","url":"https://api.github.com/users/sergey-safarov","html_url":"https://github.com/sergey-safarov","followers_url":"https://api.github.com/users/sergey-safarov/followers","following_url":"https://api.github.com/users/sergey-safarov/following{/other_user}","gists_url":"https://api.github.com/users/sergey-safarov/gists{/gist_id}","starred_url":"https://api.github.com/users/sergey-safarov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergey-safarov/subscriptions","organizations_url":"https://api.github.com/users/sergey-safarov/orgs","repos_url":"https://api.github.com/users/sergey-safarov/repos","events_url":"https://api.github.com/users/sergey-safarov/events{/privacy}","received_events_url":"https://api.github.com/users/sergey-safarov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-19T15:07:12Z","updated_at":"2023-12-19T15:07:12Z","author_association":"NONE","body":"Hello @nickva \r\nDev started database refactoring. Now we shrinking CouchDB size and I think now we cannot reproduce this error.\r\nI will close ticket now. If some time we can stable reproduce issue, then will reopen.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1862945795/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1862989845","html_url":"https://github.com/apache/couchdb/issues/4926#issuecomment-1862989845","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4926","id":1862989845,"node_id":"IC_kwDOAAMmUc5vCvgV","user":{"login":"BhasherBEL","id":45831883,"node_id":"MDQ6VXNlcjQ1ODMxODgz","avatar_url":"https://avatars.githubusercontent.com/u/45831883?v=4","gravatar_id":"","url":"https://api.github.com/users/BhasherBEL","html_url":"https://github.com/BhasherBEL","followers_url":"https://api.github.com/users/BhasherBEL/followers","following_url":"https://api.github.com/users/BhasherBEL/following{/other_user}","gists_url":"https://api.github.com/users/BhasherBEL/gists{/gist_id}","starred_url":"https://api.github.com/users/BhasherBEL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BhasherBEL/subscriptions","organizations_url":"https://api.github.com/users/BhasherBEL/orgs","repos_url":"https://api.github.com/users/BhasherBEL/repos","events_url":"https://api.github.com/users/BhasherBEL/events{/privacy}","received_events_url":"https://api.github.com/users/BhasherBEL/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-19T15:32:35Z","updated_at":"2023-12-19T15:34:10Z","author_association":"NONE","body":"Indeed, but it's the official CouchDB image, that only run CouchDB. In such cases, is there a way to extract the usage of CouchDB specifically, inside the CouchDB container ?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1862989845/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1863928098","html_url":"https://github.com/apache/couchdb/issues/4926#issuecomment-1863928098","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4926","id":1863928098,"node_id":"IC_kwDOAAMmUc5vGUki","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-20T06:33:50Z","updated_at":"2023-12-20T06:34:09Z","author_association":"CONTRIBUTOR","body":"> Indeed, but it's the official CouchDB image, that only run CouchDB.\r\n\r\nIt is provided for convience for the user.\r\n\r\n> In such cases, is there a way to extract the usage of CouchDB specifically, inside the CouchDB container ?\r\n\r\nI don't know what you mean. What are you trying to achive?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1863928098/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1868263563","html_url":"https://github.com/apache/couchdb/issues/602#issuecomment-1868263563","issue_url":"https://api.github.com/repos/apache/couchdb/issues/602","id":1868263563,"node_id":"IC_kwDOAAMmUc5vW3CL","user":{"login":"kripper","id":1479804,"node_id":"MDQ6VXNlcjE0Nzk4MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/1479804?v=4","gravatar_id":"","url":"https://api.github.com/users/kripper","html_url":"https://github.com/kripper","followers_url":"https://api.github.com/users/kripper/followers","following_url":"https://api.github.com/users/kripper/following{/other_user}","gists_url":"https://api.github.com/users/kripper/gists{/gist_id}","starred_url":"https://api.github.com/users/kripper/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kripper/subscriptions","organizations_url":"https://api.github.com/users/kripper/orgs","repos_url":"https://api.github.com/users/kripper/repos","events_url":"https://api.github.com/users/kripper/events{/privacy}","received_events_url":"https://api.github.com/users/kripper/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-23T10:27:37Z","updated_at":"2023-12-23T10:37:24Z","author_association":"NONE","body":"We had a 2 nodes cluster.\r\nOne node died, so we added a new node to the cluster and renamed the node references in the shards.\r\nCouchDB synchronized the shards to the new node, but the logs are full of `Bad security object in <<mydb>>` messages and the db permissions are wrong on the new node.\r\nAny idea why security objects / permissions are not sync'ing correctly in this scenario?\r\n\r\nCopying the `/_security` JSON from the old node to the new node (via GET + PUT) seems to have fixed the problem.\r\n\r\nAre we doing something wrong here?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1868263563/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1869639139","html_url":"https://github.com/apache/couchdb/issues/4930#issuecomment-1869639139","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4930","id":1869639139,"node_id":"IC_kwDOAAMmUc5vcG3j","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-26T16:10:10Z","updated_at":"2023-12-26T16:10:10Z","author_association":"CONTRIBUTOR","body":"I think the relevant part of your error logs is:\r\n\r\n> Reason: tried: '/opt/homebrew/opt/openssl@3/lib/libcrypto.3.dylib' (no such file), '/System/Volumes/Preboot/Cryptexes/OS/opt/homebrew/opt/openssl@3/lib/libcrypto.3.dylib' (no such file), '/opt/homebrew/opt/openssl@3/lib/libcrypto.3.dylib' (no such file), '/usr/lib/libcrypto.3.dylib' (no such file, not in dyld cache)'\"\r\nOpenSSL might not be installed on this system.\r\n\r\nPlease make sure you have OpenSSL installed. You can read more about that dependency [here](https://www.erlang.org/doc/man/crypto_app#dependencies).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1869639139/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1870325044","html_url":"https://github.com/apache/couchdb/issues/4931#issuecomment-1870325044","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4931","id":1870325044,"node_id":"IC_kwDOAAMmUc5veuU0","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-27T13:51:00Z","updated_at":"2023-12-27T13:51:00Z","author_association":"CONTRIBUTOR","body":"Default values are not documented separately in the docs. You can look for the defaults in the `default.ini` and `local.ini` file. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1870325044/reactions","total_count":1,"+1":0,"-1":1,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1872537109","html_url":"https://github.com/apache/couchdb/pull/4932#issuecomment-1872537109","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4932","id":1872537109,"node_id":"IC_kwDOAAMmUc5vnKYV","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-30T14:22:44Z","updated_at":"2023-12-30T14:22:44Z","author_association":"CONTRIBUTOR","body":"Closing, test was successful.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1872537109/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1872608862","html_url":"https://github.com/apache/couchdb/pull/4933#issuecomment-1872608862","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4933","id":1872608862,"node_id":"IC_kwDOAAMmUc5vnb5e","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-30T21:17:02Z","updated_at":"2023-12-30T21:17:02Z","author_association":"CONTRIBUTOR","body":"Getting this python-black error, which I can’t reproduce locally. Should I merge it anyway or do you have any tips?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1872608862/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1872909961","html_url":"https://github.com/apache/couchdb/pull/4933#issuecomment-1872909961","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4933","id":1872909961,"node_id":"IC_kwDOAAMmUc5volaJ","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-31T10:03:43Z","updated_at":"2023-12-31T10:03:43Z","author_association":"CONTRIBUTOR","body":"**REMINDER**\r\n\r\n`erlfmt` IS NOT `python-black`.\r\n`erlfmt` IS NOT `python-black`.\r\n`erlfmt` IS NOT `python-black`.\r\n`erlfmt` IS NOT `python-black`.\r\n\r\nThx, @jaydoane 😉 🙄","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1872909961/reactions","total_count":1,"+1":0,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1874851773","html_url":"https://github.com/apache/couchdb/issues/4939#issuecomment-1874851773","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4939","id":1874851773,"node_id":"IC_kwDOAAMmUc5vv_e9","user":{"login":"sklassen","id":6997477,"node_id":"MDQ6VXNlcjY5OTc0Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/6997477?v=4","gravatar_id":"","url":"https://api.github.com/users/sklassen","html_url":"https://github.com/sklassen","followers_url":"https://api.github.com/users/sklassen/followers","following_url":"https://api.github.com/users/sklassen/following{/other_user}","gists_url":"https://api.github.com/users/sklassen/gists{/gist_id}","starred_url":"https://api.github.com/users/sklassen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sklassen/subscriptions","organizations_url":"https://api.github.com/users/sklassen/orgs","repos_url":"https://api.github.com/users/sklassen/repos","events_url":"https://api.github.com/users/sklassen/events{/privacy}","received_events_url":"https://api.github.com/users/sklassen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-03T05:03:09Z","updated_at":"2024-01-03T05:03:09Z","author_association":"CONTRIBUTOR","body":"execute `sudo snap revert` that should restore your previous snap. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1874851773/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1874858720","html_url":"https://github.com/apache/couchdb/issues/4939#issuecomment-1874858720","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4939","id":1874858720,"node_id":"IC_kwDOAAMmUc5vwBLg","user":{"login":"ParkSeungwon","id":11606527,"node_id":"MDQ6VXNlcjExNjA2NTI3","avatar_url":"https://avatars.githubusercontent.com/u/11606527?v=4","gravatar_id":"","url":"https://api.github.com/users/ParkSeungwon","html_url":"https://github.com/ParkSeungwon","followers_url":"https://api.github.com/users/ParkSeungwon/followers","following_url":"https://api.github.com/users/ParkSeungwon/following{/other_user}","gists_url":"https://api.github.com/users/ParkSeungwon/gists{/gist_id}","starred_url":"https://api.github.com/users/ParkSeungwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ParkSeungwon/subscriptions","organizations_url":"https://api.github.com/users/ParkSeungwon/orgs","repos_url":"https://api.github.com/users/ParkSeungwon/repos","events_url":"https://api.github.com/users/ParkSeungwon/events{/privacy}","received_events_url":"https://api.github.com/users/ParkSeungwon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-03T05:17:03Z","updated_at":"2024-01-03T05:17:03Z","author_association":"NONE","body":"Thanks... Chat gpt guided me wrong way. It said there is no way to use local machine data to revert back. I can Only use snap repository, so I already reverted to 3.1.1. then 'sudo snap revert' will go back to 3.3.3.. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1874858720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1874859444","html_url":"https://github.com/apache/couchdb/issues/4939#issuecomment-1874859444","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4939","id":1874859444,"node_id":"IC_kwDOAAMmUc5vwBW0","user":{"login":"ParkSeungwon","id":11606527,"node_id":"MDQ6VXNlcjExNjA2NTI3","avatar_url":"https://avatars.githubusercontent.com/u/11606527?v=4","gravatar_id":"","url":"https://api.github.com/users/ParkSeungwon","html_url":"https://github.com/ParkSeungwon","followers_url":"https://api.github.com/users/ParkSeungwon/followers","following_url":"https://api.github.com/users/ParkSeungwon/following{/other_user}","gists_url":"https://api.github.com/users/ParkSeungwon/gists{/gist_id}","starred_url":"https://api.github.com/users/ParkSeungwon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ParkSeungwon/subscriptions","organizations_url":"https://api.github.com/users/ParkSeungwon/orgs","repos_url":"https://api.github.com/users/ParkSeungwon/repos","events_url":"https://api.github.com/users/ParkSeungwon/events{/privacy}","received_events_url":"https://api.github.com/users/ParkSeungwon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-03T05:18:10Z","updated_at":"2024-01-03T05:18:10Z","author_association":"NONE","body":"after rebooting, it works fine with 3.1.1. thanks...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1874859444/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1875139509","html_url":"https://github.com/apache/couchdb/issues/4939#issuecomment-1875139509","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4939","id":1875139509,"node_id":"IC_kwDOAAMmUc5vxFu1","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-03T10:23:35Z","updated_at":"2024-01-03T10:23:36Z","author_association":"CONTRIBUTOR","body":"I’m updating the tracks at snapcraft to only allow minor updates automatically.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1875139509/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876059778","html_url":"https://github.com/apache/couchdb/pull/4935#issuecomment-1876059778","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4935","id":1876059778,"node_id":"IC_kwDOAAMmUc5v0maC","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-03T22:31:24Z","updated_at":"2024-01-03T22:32:39Z","author_association":"MEMBER","body":"Before we get too deep into this I'd like to see us tidy up what we currently have. Specifically;\r\n\r\nmove code defaults to priv config files:\r\n\r\nLike `stats_descriptions.cfg`, for each application create a file called `config_defaults.cfg`. This file could look like;\r\n\r\n```\r\nsrc/couch/priv/config_defaults.cfg:\r\n\r\n#{\r\n  max_dbs_open => #{\r\n    default => 500,\r\n    description => <<\"Maximum number of .couch files to open at once. ...\">>\r\n  }\r\n}\r\n```\r\n\r\nThese files would _replace_ the commented out items in `default.ini`. An endpoint could be added to return this data (but not allow them to be modified).\r\n\r\n`config:get/2` would be enhanced to retrieve the default from these config files (if present, `undefined` if not) and all uses of `config:get/3` would be removed, so that the only copy of the default value for a given config item is in the `config_defaults.cfg`.\r\n\r\nThis means `default.ini` is empty except for things like `database_dir` with an actual install-specific value (whether from dev/run or a package install. Arguably it could be eliminated entirely and all of those settings could be in `local.ini`.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876059778/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876066721","html_url":"https://github.com/apache/couchdb/pull/4943#issuecomment-1876066721","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4943","id":1876066721,"node_id":"IC_kwDOAAMmUc5v0oGh","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-03T22:38:45Z","updated_at":"2024-01-03T22:38:45Z","author_association":"CONTRIBUTOR","body":"Superseded by #4944.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876066721/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876068980","html_url":"https://github.com/apache/couchdb/pull/4944#issuecomment-1876068980","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4944","id":1876068980,"node_id":"IC_kwDOAAMmUc5v0op0","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-03T22:41:20Z","updated_at":"2024-01-03T22:41:20Z","author_association":"CONTRIBUTOR","body":"Works on Windows too.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876068980/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876720675","html_url":"https://github.com/apache/couchdb/issues/4945#issuecomment-1876720675","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4945","id":1876720675,"node_id":"IC_kwDOAAMmUc5v3Hwj","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-04T08:49:16Z","updated_at":"2024-01-04T08:49:16Z","author_association":"CONTRIBUTOR","body":"Hi,\r\n\r\n> However, with 3.3.3 a cookie is required (installation documentation: \"sudo snap set couchdb admin={password} setcookie={cookie}\"), since the old configuration does not have a cookie, couchdb stops with \"Monster detected ohno!, aborting startup.\"\r\n\r\nThe cookie value with this message is \"monster\", which isn't allowed anymore. Can you look into your `vm.args` file and change it to another value and try to restart your server?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876720675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876744832","html_url":"https://github.com/apache/couchdb/issues/4945#issuecomment-1876744832","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4945","id":1876744832,"node_id":"IC_kwDOAAMmUc5v3NqA","user":{"login":"SteffenBrinckmann","id":39419674,"node_id":"MDQ6VXNlcjM5NDE5Njc0","avatar_url":"https://avatars.githubusercontent.com/u/39419674?v=4","gravatar_id":"","url":"https://api.github.com/users/SteffenBrinckmann","html_url":"https://github.com/SteffenBrinckmann","followers_url":"https://api.github.com/users/SteffenBrinckmann/followers","following_url":"https://api.github.com/users/SteffenBrinckmann/following{/other_user}","gists_url":"https://api.github.com/users/SteffenBrinckmann/gists{/gist_id}","starred_url":"https://api.github.com/users/SteffenBrinckmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SteffenBrinckmann/subscriptions","organizations_url":"https://api.github.com/users/SteffenBrinckmann/orgs","repos_url":"https://api.github.com/users/SteffenBrinckmann/repos","events_url":"https://api.github.com/users/SteffenBrinckmann/events{/privacy}","received_events_url":"https://api.github.com/users/SteffenBrinckmann/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-04T09:07:57Z","updated_at":"2024-01-04T09:07:57Z","author_association":"NONE","body":"Hey,\r\nI changed it to a custom value. But then I get \"initialize_nodelist(line 110) fails to initialize\" which I tried to explain in the issue.\r\nTo verify: the user is expected to change vm.args and then it should work?\r\nWhy is the documentation stating something else (it should be set with \"snap set ...\"?\r\nBest, Steffen\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876744832/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876753673","html_url":"https://github.com/apache/couchdb/issues/4945#issuecomment-1876753673","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4945","id":1876753673,"node_id":"IC_kwDOAAMmUc5v3P0J","user":{"login":"sklassen","id":6997477,"node_id":"MDQ6VXNlcjY5OTc0Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/6997477?v=4","gravatar_id":"","url":"https://api.github.com/users/sklassen","html_url":"https://github.com/sklassen","followers_url":"https://api.github.com/users/sklassen/followers","following_url":"https://api.github.com/users/sklassen/following{/other_user}","gists_url":"https://api.github.com/users/sklassen/gists{/gist_id}","starred_url":"https://api.github.com/users/sklassen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sklassen/subscriptions","organizations_url":"https://api.github.com/users/sklassen/orgs","repos_url":"https://api.github.com/users/sklassen/repos","events_url":"https://api.github.com/users/sklassen/events{/privacy}","received_events_url":"https://api.github.com/users/sklassen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-04T09:14:18Z","updated_at":"2024-01-04T09:14:18Z","author_association":"CONTRIBUTOR","body":"The snap hook should be found here. \r\n\r\n```\r\nls -l /snap/couchdb/current/snap/hooks/configure \r\n-rwxr-xr-x 1 root root 1672 Nov 17 18:05 /snap/couchdb/current/snap/hooks/configure\r\n```\r\n\r\nYou can try this to see if the script is working for you\r\n\r\n```\r\n$ cd /var/snap/couchdb/current/etc\r\n$ grep setcookie vm.args \r\n-setcookie dOAAd8fWUua3Ca8cmaSdGU3gAn35gPH0z7Xmi4GLx4Q8E9Os\r\n$ sudo snap set couchdb  setcookie=`echo $(dd if=/dev/random bs=1 count=38 status=none | base64 | tr -cd '[:alnum:]')`\r\n$ grep setcookie vm.args \r\n-setcookie ySKMODxwg8qeY6OmtaTVe7LfFtSaQAZ4Z0UQVIXlIDtRu3E\r\n```\r\nBut you can also edit the file by hand and restart the snap.\r\n\r\n`initialize_nodelist(line 110) fails to initialize` sounds like a different issue.  What else is in the logs?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876753673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876810605","html_url":"https://github.com/apache/couchdb/issues/4945#issuecomment-1876810605","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4945","id":1876810605,"node_id":"IC_kwDOAAMmUc5v3dtt","user":{"login":"SteffenBrinckmann","id":39419674,"node_id":"MDQ6VXNlcjM5NDE5Njc0","avatar_url":"https://avatars.githubusercontent.com/u/39419674?v=4","gravatar_id":"","url":"https://api.github.com/users/SteffenBrinckmann","html_url":"https://github.com/SteffenBrinckmann","followers_url":"https://api.github.com/users/SteffenBrinckmann/followers","following_url":"https://api.github.com/users/SteffenBrinckmann/following{/other_user}","gists_url":"https://api.github.com/users/SteffenBrinckmann/gists{/gist_id}","starred_url":"https://api.github.com/users/SteffenBrinckmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SteffenBrinckmann/subscriptions","organizations_url":"https://api.github.com/users/SteffenBrinckmann/orgs","repos_url":"https://api.github.com/users/SteffenBrinckmann/repos","events_url":"https://api.github.com/users/SteffenBrinckmann/events{/privacy}","received_events_url":"https://api.github.com/users/SteffenBrinckmann/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-04T09:55:06Z","updated_at":"2024-01-04T09:55:41Z","author_association":"NONE","body":"Hey,\r\nWhen I run it:\r\n```\r\n$ ls -l /snap/couchdb/current/snap/hooks/configure \r\nls: cannot access '/snap/couchdb/current/snap/hooks/configure': No such file or directory\r\n```\r\nThat might be the reason why 'sudo snap set' does not work.\r\n\r\nManual setting:\r\n```\r\n$  grep setcookie vm.args \r\n-setcookie UNX4319uTTWLyhyEl6WC0H2v492WFO5kGZAYzsh8cj1WIBvMU8\r\n$ sudo snap restart couchdb\r\n$ curl http://127.0.0.1:5984/\r\ncurl: (7) Failed to connect to 127.0.0.1 port 5984 after 0 ms: Connection refused\r\n```\r\nalso does not work.\r\n\r\nHere the log\r\n```\r\n$ tail -n 20 /var/log/syslog\r\nJan  4 10:51:57 abcde kernel: [ 7945.270124] audit: type=1400 audit(1704361917.930:6492): apparmor=\"DENIED\" operation=\"open\" profile=\"snap.couchdb.server\" name=\"/sys/fs/cgroup/cgroup.controllers\" pid=322552 comm=\"beam.smp\" requested_mask=\"r\" denied_mask=\"r\" fsuid=0 ouid=0\r\nJan  4 10:51:57 abcde kernel: [ 7945.271858] audit: type=1400 audit(1704361917.934:6493): apparmor=\"DENIED\" operation=\"open\" profile=\"snap.couchdb.server\" name=\"/sys/fs/cgroup/cgroup.controllers\" pid=322552 comm=\"beam.smp\" requested_mask=\"r\" denied_mask=\"r\" fsuid=0 ouid=0\r\nJan  4 10:51:58 abcde couchdb.server[322552]: [info] 2024-01-04T09:51:58.429844Z couchdb@127.0.0.1 <0.254.0> -------- Preflight check: Checking For Monsters\r\nJan  4 10:51:58 abcde couchdb.server[322552]: [info] 2024-01-04T09:51:58.429920Z couchdb@127.0.0.1 <0.254.0> -------- Preflight check: Asserting Admin Account\r\nJan  4 10:51:58 abcde couchdb.server[322552]: [info] 2024-01-04T09:51:58.432461Z couchdb@127.0.0.1 <0.254.0> -------- Apache CouchDB 3.3.3 is starting.\r\nJan  4 10:51:58 abcde couchdb.server[322552]: [info] 2024-01-04T09:51:58.432512Z couchdb@127.0.0.1 <0.255.0> -------- Starting couch_sup\r\nJan  4 10:51:58 abcde couchdb.server[322552]: [info] 2024-01-04T09:51:58.469990Z couchdb@127.0.0.1 <0.254.0> -------- Apache CouchDB has started. Time to relax.\r\nJan  4 10:51:58 abcde couchdb.server[322552]: [notice] 2024-01-04T09:51:58.474650Z couchdb@127.0.0.1 <0.377.0> -------- rexi_server : started servers\r\nJan  4 10:51:58 abcde couchdb.server[322552]: [notice] 2024-01-04T09:51:58.475527Z couchdb@127.0.0.1 <0.381.0> -------- rexi_buffer : started servers\r\nJan  4 10:51:58 abcde couchdb.server[322552]: [warning] 2024-01-04T09:51:58.495393Z couchdb@127.0.0.1 <0.389.0> -------- creating missing database: _nodes\r\nJan  4 10:51:58 abcde couchdb.server[322552]: [info] 2024-01-04T09:51:58.495437Z couchdb@127.0.0.1 <0.390.0> -------- open_result error {not_found,no_db_file} for _nodes\r\nJan  4 10:51:58 abcde couchdb.server[322552]: [info] 2024-01-04T09:51:58.496611Z couchdb@127.0.0.1 <0.394.0> -------- open_result error {not_found,no_db_file} for _nodes\r\nJan  4 10:51:58 abcde couchdb.server[322552]: [error] 2024-01-04T09:51:58.496863Z couchdb@127.0.0.1 <0.387.0> -------- Supervisor mem3_sup had child mem3_nodes started with mem3_nodes:start_link() at undefined exit with reason no case clause matching {not_found,no_db_file} at mem3_util:ensure_exists/1(line:344) <= mem3_nodes:initialize_nodelist/0(line:110) <= mem3_nodes:init/1(line:55) <= gen_server:init_it/2(line:423) <= gen_server:init_it/6(line:390) <= proc_lib:init_p_do_apply/3(line:226) in context start_error\r\nJan  4 10:51:58 abcde couchdb.server[322552]: [error] 2024-01-04T09:51:58.497016Z couchdb@127.0.0.1 <0.387.0> -------- Supervisor mem3_sup had child mem3_nodes started with mem3_nodes:start_link() at undefined exit with reason no case clause matching {not_found,no_db_file} at mem3_util:ensure_exists/1(line:344) <= mem3_nodes:initialize_nodelist/0(line:110) <= mem3_nodes:init/1(line:55) <= gen_server:init_it/2(line:423) <= gen_server:init_it/6(line:390) <= proc_lib:init_p_do_apply/3(line:226) in context start_error\r\nJan  4 10:51:58 abcde couchdb.server[322552]: [error] 2024-01-04T09:51:58.497147Z couchdb@127.0.0.1 <0.389.0> -------- CRASH REPORT Process  (<0.389.0>) with 0 neighbors crashed with reason: no case clause matching {not_found,no_db_file} at mem3_util:ensure_exists/1(line:344) <= mem3_nodes:initialize_nodelist/0(line:110) <= mem3_nodes:init/1(line:55) <= gen_server:init_it/2(line:423) <= gen_server:init_it/6(line:390) <= proc_lib:init_p_do_apply/3(line:226); initial_call: {mem3_nodes,init,['Argument__1']}, ancestors: [mem3_sup,<0.386.0>], message_queue_len: 0, links: [<0.387.0>], dictionary: [{io_priority,{system,<<\"_nodes\">>}}], trap_exit: false, status: running, heap_size: 987, stack_size: 29, reductions: 48397\r\nJan  4 10:51:58 abcde couchdb.server[322552]: [error] 2024-01-04T09:51:58.497251Z couchdb@127.0.0.1 <0.389.0> -------- CRASH REPORT Process  (<0.389.0>) with 0 neighbors crashed with reason: no case clause matching {not_found,no_db_file} at mem3_util:ensure_exists/1(line:344) <= mem3_nodes:initialize_nodelist/0(line:110) <= mem3_nodes:init/1(line:55) <= gen_server:init_it/2(line:423) <= gen_server:init_it/6(line:390) <= proc_lib:init_p_do_apply/3(line:226); initial_call: {mem3_nodes,init,['Argument__1']}, ancestors: [mem3_sup,<0.386.0>], message_queue_len: 0, links: [<0.387.0>], dictionary: [{io_priority,{system,<<\"_nodes\">>}}], trap_exit: false, status: running, heap_size: 987, stack_size: 29, reductions: 48397\r\nJan  4 10:51:58 abcde couchdb.server[322552]: [error] 2024-01-04T09:51:58.497387Z couchdb@127.0.0.1 <0.385.0> -------- CRASH REPORT Process  (<0.385.0>) with 0 neighbors exited with reason: {{shutdown,{failed_to_start_child,mem3_nodes,{{case_clause,{not_found,no_db_file}},[{mem3_util,ensure_exists,1,[{file,\"src/mem3_util.erl\"},{line,344}]},{mem3_nodes,initialize_nodelist,0,[{file,\"src/mem3_nodes.erl\"},{line,110}]},{mem3_nodes,init,1,[{file,\"src/mem3_nodes.erl\"},{line,55}]},{gen_server,init_it,2,[{file,\"gen_server.erl\"},{line,423}]},{gen_server,init_it,6,[{file,\"gen_server.erl\"},{line,390}]},{proc_lib,init_p_do_apply,3,[{file,\"proc_lib.erl\"},{line,226}]}]}}},{mem3_app,start,[normal,...]}} at application_master:init/4(line:142) <= proc_lib:init_p_do_apply/3(line:226); initial_call: {application_master,init,['Argument__1','Argument__2',...]}, ancestors: [<0.384.0>], message_queue_len: 1, links: [<0.384.0>,<0.16.0>], dictionary: [], trap_exit: true, status: running, heap_size: 987, stack_size: 29, reductions: 205\r\nJan  4 10:51:58 abcde couchdb.server[322552]: [error] 2024-01-04T09:51:58.497624Z couchdb@127.0.0.1 <0.385.0> -------- CRASH REPORT Process  (<0.385.0>) with 0 neighbors exited with reason: {{shutdown,{failed_to_start_child,mem3_nodes,{{case_clause,{not_found,no_db_file}},[{mem3_util,ensure_exists,1,[{file,\"src/mem3_util.erl\"},{line,344}]},{mem3_nodes,initialize_nodelist,0,[{file,\"src/mem3_nodes.erl\"},{line,110}]},{mem3_nodes,init,1,[{file,\"src/mem3_nodes.erl\"},{line,55}]},{gen_server,init_it,2,[{file,\"gen_server.erl\"},{line,423}]},{gen_server,init_it,6,[{file,\"gen_server.erl\"},{line,390}]},{proc_lib,init_p_do_apply,3,[{file,\"proc_lib.erl\"},{line,226}]}]}}},{mem3_app,start,[normal,...]}} at application_master:init/4(line:142) <= proc_lib:init_p_do_apply/3(line:226); initial_call: {application_master,init,['Argument__1','Argument__2',...]}, ancestors: [<0.384.0>], message_queue_len: 1, links: [<0.384.0>,<0.16.0>], dictionary: [], trap_exit: true, status: running, heap_size: 987, stack_size: 29, reductions: 205\r\nJan  4 10:51:58 abcde couchdb.server[322552]: [info] 2024-01-04T09:51:58.497814Z couchdb@127.0.0.1 <0.16.0> -------- Application mem3 exited with reason: {{shutdown,{failed_to_start_child,mem3_nodes,{{case_clause,{not_found,no_db_file}},[{mem3_util,ensure_exists,1,[{file,\"src/mem3_util.erl\"},{line,344}]},{mem3_nodes,initialize_nodelist,0,[{file,\"src/mem3_nodes.erl\"},{line,110}]},{mem3_nodes,init,1,[{file,\"src/mem3_nodes.erl\"},{line,55}]},{gen_server,init_it,2,[{file,\"gen_server.erl\"},{line,423}]},{gen_server,init_it,6,[{file,\"gen_server.erl\"},{line,390}]},{proc_lib,init_p_do_apply,3,[{file,\"proc_lib.erl\"},{line,226}]}]}}},{mem3_app,start,[normal,...]}}\r\nJan  4 10:51:58 abcde couchdb.server[322552]: [info] 2024-01-04T09:51:58.497919Z couchdb@127.0.0.1 <0.16.0> -------- Application mem3 exited with reason: {{shutdown,{failed_to_start_child,mem3_nodes,{{case_clause,{not_found,no_db_file}},[{mem3_util,ensure_exists,1,[{file,\"src/mem3_util.erl\"},{line,344}]},{mem3_nodes,initialize_nodelist,0,[{file,\"src/mem3_nodes.erl\"},{line,110}]},{mem3_nodes,init,1,[{file,\"src/mem3_nodes.erl\"},{line,55}]},{gen_server,init_it,2,[{file,\"gen_server.erl\"},{line,423}]},{gen_server,init_it,6,[{file,\"gen_server.erl\"},{line,390}]},{proc_lib,init_p_do_apply,3,[{file,\"proc_lib.erl\"},{line,226}]}]}}},{mem3_app,start,[normal,...]}}\r\n```\r\n\r\nThanks for your help!\r\nBest, SB\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876810605/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876820590","html_url":"https://github.com/apache/couchdb/issues/4945#issuecomment-1876820590","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4945","id":1876820590,"node_id":"IC_kwDOAAMmUc5v3gJu","user":{"login":"SteffenBrinckmann","id":39419674,"node_id":"MDQ6VXNlcjM5NDE5Njc0","avatar_url":"https://avatars.githubusercontent.com/u/39419674?v=4","gravatar_id":"","url":"https://api.github.com/users/SteffenBrinckmann","html_url":"https://github.com/SteffenBrinckmann","followers_url":"https://api.github.com/users/SteffenBrinckmann/followers","following_url":"https://api.github.com/users/SteffenBrinckmann/following{/other_user}","gists_url":"https://api.github.com/users/SteffenBrinckmann/gists{/gist_id}","starred_url":"https://api.github.com/users/SteffenBrinckmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SteffenBrinckmann/subscriptions","organizations_url":"https://api.github.com/users/SteffenBrinckmann/orgs","repos_url":"https://api.github.com/users/SteffenBrinckmann/repos","events_url":"https://api.github.com/users/SteffenBrinckmann/events{/privacy}","received_events_url":"https://api.github.com/users/SteffenBrinckmann/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-04T10:01:41Z","updated_at":"2024-01-04T10:01:41Z","author_association":"NONE","body":"For additional information\r\n```\r\n$ snap info couchdb\r\nname:      couchdb\r\nsummary:   RESTful document oriented database - Apache CouchDB has started. Time to relax.\r\npublisher: Apache CouchDB\r\nstore-url: https://snapcraft.io/couchdb\r\nlicense:   unset\r\ndescription: |\r\n  Apache CouchDB ™ lets you access your data where you need it. The Couch Replication Protocol is [...]                                                                                                                                \r\n  https://github.com/apache/couchdb-pkg/blob/main/README-SNAP.md                                                                                                                                                                                             \r\ncommands:                                                                                                                                                                                                                                                    \r\n  - couchdb                                                                                                                                                                                                                                                  \r\n  - couchdb.couchjs                                                                                                                                                                                                                                          \r\n  - couchdb.remsh                                                                                                                                                                                                                                            \r\nservices:                                                                                                                                                                                                                                                    \r\n  couchdb.server: simple, enabled, active                                                                                                                                                                                                                    \r\nsnap-id:      i06N6KdQXS4HwhSkymgGClpopBOojRAt\r\ntracking:     latest/stable\r\nrefresh-date: today at 08:43 CET\r\nchannels:\r\n  latest/stable:    3.3.3 2024-01-02 (15) 47MB -\r\n  latest/candidate: 3.3.3 2024-01-02 (15) 47MB -\r\n  latest/beta:      ↑                          \r\n  latest/edge:      ↑                          \r\n  2.x/stable:       2.3.1 2020-03-18  (5) 46MB -\r\n  2.x/candidate:    ↑                          \r\n  2.x/beta:         ↑                          \r\n  2.x/edge:         ↑                          \r\ninstalled:          3.3.3            (15) 47MB -\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876820590/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876858036","html_url":"https://github.com/apache/couchdb/issues/4945#issuecomment-1876858036","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4945","id":1876858036,"node_id":"IC_kwDOAAMmUc5v3pS0","user":{"login":"sklassen","id":6997477,"node_id":"MDQ6VXNlcjY5OTc0Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/6997477?v=4","gravatar_id":"","url":"https://api.github.com/users/sklassen","html_url":"https://github.com/sklassen","followers_url":"https://api.github.com/users/sklassen/followers","following_url":"https://api.github.com/users/sklassen/following{/other_user}","gists_url":"https://api.github.com/users/sklassen/gists{/gist_id}","starred_url":"https://api.github.com/users/sklassen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sklassen/subscriptions","organizations_url":"https://api.github.com/users/sklassen/orgs","repos_url":"https://api.github.com/users/sklassen/repos","events_url":"https://api.github.com/users/sklassen/events{/privacy}","received_events_url":"https://api.github.com/users/sklassen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-04T10:27:22Z","updated_at":"2024-01-04T10:27:49Z","author_association":"CONTRIBUTOR","body":"Okay, those hooks are missing. You'll need to change by hand for the moment. \r\n\r\ncd /var/snap/couchdb/current/etc\r\n\r\nedit local.ini\r\n\r\nEnsure that you have this stanza\r\n\r\n```\r\n[couchdb]\r\ndatabase_dir = /var/snap/couchdb/common/data\r\nview_index_dir = /var/snap/couchdb/common/data\r\n.\r\n.\r\n```\r\n\r\nthen snap restart and check the logs again.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876858036/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876887506","html_url":"https://github.com/apache/couchdb/issues/4945#issuecomment-1876887506","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4945","id":1876887506,"node_id":"IC_kwDOAAMmUc5v3wfS","user":{"login":"SteffenBrinckmann","id":39419674,"node_id":"MDQ6VXNlcjM5NDE5Njc0","avatar_url":"https://avatars.githubusercontent.com/u/39419674?v=4","gravatar_id":"","url":"https://api.github.com/users/SteffenBrinckmann","html_url":"https://github.com/SteffenBrinckmann","followers_url":"https://api.github.com/users/SteffenBrinckmann/followers","following_url":"https://api.github.com/users/SteffenBrinckmann/following{/other_user}","gists_url":"https://api.github.com/users/SteffenBrinckmann/gists{/gist_id}","starred_url":"https://api.github.com/users/SteffenBrinckmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SteffenBrinckmann/subscriptions","organizations_url":"https://api.github.com/users/SteffenBrinckmann/orgs","repos_url":"https://api.github.com/users/SteffenBrinckmann/repos","events_url":"https://api.github.com/users/SteffenBrinckmann/events{/privacy}","received_events_url":"https://api.github.com/users/SteffenBrinckmann/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-04T10:48:04Z","updated_at":"2024-01-04T10:48:04Z","author_association":"NONE","body":"That fixes the issue for me\r\n```\r\n$ curl http://127.0.0.1:5984/\r\n{\"couchdb\":\"Welcome\",\"version\":\"3.3.3\",\"git_sha\":....\r\n```\r\nThank you!\r\n\r\nHow will  this issue continue: will there be a fix to do things automatically or should the user do things manually?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876887506/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876889269","html_url":"https://github.com/apache/couchdb/issues/4945#issuecomment-1876889269","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4945","id":1876889269,"node_id":"IC_kwDOAAMmUc5v3w61","user":{"login":"sklassen","id":6997477,"node_id":"MDQ6VXNlcjY5OTc0Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/6997477?v=4","gravatar_id":"","url":"https://api.github.com/users/sklassen","html_url":"https://github.com/sklassen","followers_url":"https://api.github.com/users/sklassen/followers","following_url":"https://api.github.com/users/sklassen/following{/other_user}","gists_url":"https://api.github.com/users/sklassen/gists{/gist_id}","starred_url":"https://api.github.com/users/sklassen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sklassen/subscriptions","organizations_url":"https://api.github.com/users/sklassen/orgs","repos_url":"https://api.github.com/users/sklassen/repos","events_url":"https://api.github.com/users/sklassen/events{/privacy}","received_events_url":"https://api.github.com/users/sklassen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-04T10:49:26Z","updated_at":"2024-01-04T10:49:26Z","author_association":"CONTRIBUTOR","body":"Good. The next snap revision will include the hooks. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876889269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876995084","html_url":"https://github.com/apache/couchdb/issues/4945#issuecomment-1876995084","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4945","id":1876995084,"node_id":"IC_kwDOAAMmUc5v4KwM","user":{"login":"SteffenBrinckmann","id":39419674,"node_id":"MDQ6VXNlcjM5NDE5Njc0","avatar_url":"https://avatars.githubusercontent.com/u/39419674?v=4","gravatar_id":"","url":"https://api.github.com/users/SteffenBrinckmann","html_url":"https://github.com/SteffenBrinckmann","followers_url":"https://api.github.com/users/SteffenBrinckmann/followers","following_url":"https://api.github.com/users/SteffenBrinckmann/following{/other_user}","gists_url":"https://api.github.com/users/SteffenBrinckmann/gists{/gist_id}","starred_url":"https://api.github.com/users/SteffenBrinckmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SteffenBrinckmann/subscriptions","organizations_url":"https://api.github.com/users/SteffenBrinckmann/orgs","repos_url":"https://api.github.com/users/SteffenBrinckmann/repos","events_url":"https://api.github.com/users/SteffenBrinckmann/events{/privacy}","received_events_url":"https://api.github.com/users/SteffenBrinckmann/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-04T12:10:17Z","updated_at":"2024-01-04T12:10:17Z","author_association":"NONE","body":"Great","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876995084/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876999617","html_url":"https://github.com/apache/couchdb/issues/4945#issuecomment-1876999617","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4945","id":1876999617,"node_id":"IC_kwDOAAMmUc5v4L3B","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-04T12:13:53Z","updated_at":"2024-01-04T12:13:53Z","author_association":"CONTRIBUTOR","body":"Recreated and uploaded the snap packages!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1876999617/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1877098921","html_url":"https://github.com/apache/couchdb/issues/4945#issuecomment-1877098921","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4945","id":1877098921,"node_id":"IC_kwDOAAMmUc5v4kGp","user":{"login":"SteffenBrinckmann","id":39419674,"node_id":"MDQ6VXNlcjM5NDE5Njc0","avatar_url":"https://avatars.githubusercontent.com/u/39419674?v=4","gravatar_id":"","url":"https://api.github.com/users/SteffenBrinckmann","html_url":"https://github.com/SteffenBrinckmann","followers_url":"https://api.github.com/users/SteffenBrinckmann/followers","following_url":"https://api.github.com/users/SteffenBrinckmann/following{/other_user}","gists_url":"https://api.github.com/users/SteffenBrinckmann/gists{/gist_id}","starred_url":"https://api.github.com/users/SteffenBrinckmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SteffenBrinckmann/subscriptions","organizations_url":"https://api.github.com/users/SteffenBrinckmann/orgs","repos_url":"https://api.github.com/users/SteffenBrinckmann/repos","events_url":"https://api.github.com/users/SteffenBrinckmann/events{/privacy}","received_events_url":"https://api.github.com/users/SteffenBrinckmann/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-04T13:30:36Z","updated_at":"2024-01-04T13:30:36Z","author_association":"NONE","body":"Thanks! The new snap works like a charm.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1877098921/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]