[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1530381043","html_url":"https://github.com/apache/couchdb/issues/2603#issuecomment-1530381043","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2603","id":1530381043,"node_id":"IC_kwDOAAMmUc5bN8Lz","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-01T21:58:40Z","updated_at":"2023-05-02T02:28:29Z","author_association":"CONTRIBUTOR","body":"With some help in couchdb slack `#dev` channel https://couchdb.slack.com/archives/C01TBE2J197/p1682970913981959 we figured out it's because of how replacement is done on local.ini: https://github.com/apache/couchdb-docker/blob/main/3.3.2/docker-entrypoint.sh#L68-L69","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1530381043/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1532241313","html_url":"https://github.com/apache/couchdb/issues/4510#issuecomment-1532241313","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4510","id":1532241313,"node_id":"IC_kwDOAAMmUc5bVCWh","user":{"login":"leanne63","id":7043045,"node_id":"MDQ6VXNlcjcwNDMwNDU=","avatar_url":"https://avatars.githubusercontent.com/u/7043045?v=4","gravatar_id":"","url":"https://api.github.com/users/leanne63","html_url":"https://github.com/leanne63","followers_url":"https://api.github.com/users/leanne63/followers","following_url":"https://api.github.com/users/leanne63/following{/other_user}","gists_url":"https://api.github.com/users/leanne63/gists{/gist_id}","starred_url":"https://api.github.com/users/leanne63/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leanne63/subscriptions","organizations_url":"https://api.github.com/users/leanne63/orgs","repos_url":"https://api.github.com/users/leanne63/repos","events_url":"https://api.github.com/users/leanne63/events{/privacy}","received_events_url":"https://api.github.com/users/leanne63/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-02T22:36:10Z","updated_at":"2023-05-02T22:39:35Z","author_association":"NONE","body":"database dir nuked, @janl ! Sorry for the delay!\r\n\r\nWhat's next? Should I try again?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1532241313/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1533074176","html_url":"https://github.com/apache/couchdb/issues/1079#issuecomment-1533074176","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1079","id":1533074176,"node_id":"IC_kwDOAAMmUc5bYNsA","user":{"login":"Severinsp","id":105063342,"node_id":"U_kgDOBkMjrg","avatar_url":"https://avatars.githubusercontent.com/u/105063342?v=4","gravatar_id":"","url":"https://api.github.com/users/Severinsp","html_url":"https://github.com/Severinsp","followers_url":"https://api.github.com/users/Severinsp/followers","following_url":"https://api.github.com/users/Severinsp/following{/other_user}","gists_url":"https://api.github.com/users/Severinsp/gists{/gist_id}","starred_url":"https://api.github.com/users/Severinsp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Severinsp/subscriptions","organizations_url":"https://api.github.com/users/Severinsp/orgs","repos_url":"https://api.github.com/users/Severinsp/repos","events_url":"https://api.github.com/users/Severinsp/events{/privacy}","received_events_url":"https://api.github.com/users/Severinsp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-03T13:55:18Z","updated_at":"2023-05-03T13:55:18Z","author_association":"NONE","body":"i have  the same problem, but it dosen't login . I already installed version 3.0.0","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1533074176/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1534932030","html_url":"https://github.com/apache/couchdb/pull/4570#issuecomment-1534932030","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4570","id":1534932030,"node_id":"IC_kwDOAAMmUc5bfTQ-","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-04T14:57:17Z","updated_at":"2023-05-04T14:57:17Z","author_association":"CONTRIBUTOR","body":"xxhash Excellent find!!! \r\n\r\nJust for awareness I also found\r\n\r\n- https://github.com/farhadi/xxh3 - NIF written in rust\r\n- https://github.com/pierreis/erlang-xxhash - NIF written in C","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1534932030/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1535133183","html_url":"https://github.com/apache/couchdb/pull/4570#issuecomment-1535133183","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4570","id":1535133183,"node_id":"IC_kwDOAAMmUc5bgEX_","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-04T17:18:03Z","updated_at":"2023-05-05T05:06:48Z","author_association":"CONTRIBUTOR","body":"Thanks, @iilyak!\r\n\r\nI looked at xxh3 but since we don't have rust in our build chain, didn't want to bring it in just for xxh3_128. The C one doesn't use dirty schedulers and doesn't implement the 128 bit variant which is the one we need.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1535133183/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1536238444","html_url":"https://github.com/apache/couchdb/issues/2106#issuecomment-1536238444","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2106","id":1536238444,"node_id":"IC_kwDOAAMmUc5bkSNs","user":{"login":"douglasawh","id":21109706,"node_id":"MDQ6VXNlcjIxMTA5NzA2","avatar_url":"https://avatars.githubusercontent.com/u/21109706?v=4","gravatar_id":"","url":"https://api.github.com/users/douglasawh","html_url":"https://github.com/douglasawh","followers_url":"https://api.github.com/users/douglasawh/followers","following_url":"https://api.github.com/users/douglasawh/following{/other_user}","gists_url":"https://api.github.com/users/douglasawh/gists{/gist_id}","starred_url":"https://api.github.com/users/douglasawh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/douglasawh/subscriptions","organizations_url":"https://api.github.com/users/douglasawh/orgs","repos_url":"https://api.github.com/users/douglasawh/repos","events_url":"https://api.github.com/users/douglasawh/events{/privacy}","received_events_url":"https://api.github.com/users/douglasawh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-05T13:08:23Z","updated_at":"2023-05-05T13:08:23Z","author_association":"NONE","body":"Any updates on this?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1536238444/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1536884877","html_url":"https://github.com/apache/couchdb/pull/4576#issuecomment-1536884877","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4576","id":1536884877,"node_id":"IC_kwDOAAMmUc5bmwCN","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-05T23:07:52Z","updated_at":"2023-05-05T23:07:52Z","author_association":"CONTRIBUTOR","body":"@chewbranca good observation it does couple couch_file to md5, but it's already coupled as we're verifying md5 checksums in there. This was one case were we pretended we could pass in an external checksum but we still assumed it had to be md5 and verified it as such. After this PR we can keep the detail hidden inside couch_file basically.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1536884877/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1537157277","html_url":"https://github.com/apache/couchdb/issues/4510#issuecomment-1537157277","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4510","id":1537157277,"node_id":"IC_kwDOAAMmUc5bnyid","user":{"login":"leanne63","id":7043045,"node_id":"MDQ6VXNlcjcwNDMwNDU=","avatar_url":"https://avatars.githubusercontent.com/u/7043045?v=4","gravatar_id":"","url":"https://api.github.com/users/leanne63","html_url":"https://github.com/leanne63","followers_url":"https://api.github.com/users/leanne63/followers","following_url":"https://api.github.com/users/leanne63/following{/other_user}","gists_url":"https://api.github.com/users/leanne63/gists{/gist_id}","starred_url":"https://api.github.com/users/leanne63/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leanne63/subscriptions","organizations_url":"https://api.github.com/users/leanne63/orgs","repos_url":"https://api.github.com/users/leanne63/repos","events_url":"https://api.github.com/users/leanne63/events{/privacy}","received_events_url":"https://api.github.com/users/leanne63/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-06T14:46:42Z","updated_at":"2023-05-06T14:46:42Z","author_association":"NONE","body":"Okay, I nuked the app AND the contents of `~/Library/Application\\ Support/CouchDB2/` and started from scratch.\r\n\r\nI split out the log file into sections based on action, and have attached the files here:\r\n\r\n[CouchDB2_uponLogin.log](https://github.com/apache/couchdb/files/11412599/CouchDB2_uponLogin.log)\r\n[CouchDB2_uponVerification.log](https://github.com/apache/couchdb/files/11412600/CouchDB2_uponVerification.log)\r\n[CouchDB2_afterLogoutAndClose.log](https://github.com/apache/couchdb/files/11412598/CouchDB2_afterLogoutAndClose.log)\r\n\r\nItems of note:  \r\n* The `_users` database wasn't created\r\n* The missing `_nodes` and `_dbs` databases *were* created\r\n* The *verify* process passed everything (all related lines say `ok`)\r\n\r\nSo, at this point it appears that I need only `curl` to add the `_users` database, and it should work fine...\r\n\r\nLet me know if you'd like me to try anything else...\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1537157277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1537342334","html_url":"https://github.com/apache/couchdb/pull/4578#issuecomment-1537342334","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4578","id":1537342334,"node_id":"IC_kwDOAAMmUc5boft-","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-07T07:21:47Z","updated_at":"2023-05-07T07:21:47Z","author_association":"CONTRIBUTOR","body":"Instead of having `verify/extract_digest` do we want to use `verify/extract_checksum` to make it consistent?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1537342334/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1537468382","html_url":"https://github.com/apache/couchdb/pull/4578#issuecomment-1537468382","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4578","id":1537468382,"node_id":"IC_kwDOAAMmUc5bo-fe","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-07T15:25:41Z","updated_at":"2023-05-07T16:55:18Z","author_association":"CONTRIBUTOR","body":"@big-r81 good idea, updated it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1537468382/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1537501462","html_url":"https://github.com/apache/couchdb/pull/4578#issuecomment-1537501462","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4578","id":1537501462,"node_id":"IC_kwDOAAMmUc5bpGkW","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-07T17:39:21Z","updated_at":"2023-05-07T17:39:21Z","author_association":"CONTRIBUTOR","body":"We should probably make it configurable and enable a mode where we verify xxh checksums but don't write them, to allow an intermediate release users can downgrade to after writting xxh becomes the default.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1537501462/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1537653384","html_url":"https://github.com/apache/couchdb/issues/4580#issuecomment-1537653384","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4580","id":1537653384,"node_id":"IC_kwDOAAMmUc5bprqI","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-08T02:30:54Z","updated_at":"2023-05-08T02:31:45Z","author_association":"CONTRIBUTOR","body":"Thanks for reaching out @joaohf and for giving a it a try to build CouchDB with a deterministic option. We could probably even make that a configure option or even the default.\r\n\r\nGood find about .d .o files we do not need to install those with the release. It's an omission on our part.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1537653384/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1538322376","html_url":"https://github.com/apache/couchdb/issues/4466#issuecomment-1538322376","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4466","id":1538322376,"node_id":"IC_kwDOAAMmUc5bsO_I","user":{"login":"doctor-claw","id":54720201,"node_id":"MDQ6VXNlcjU0NzIwMjAx","avatar_url":"https://avatars.githubusercontent.com/u/54720201?v=4","gravatar_id":"","url":"https://api.github.com/users/doctor-claw","html_url":"https://github.com/doctor-claw","followers_url":"https://api.github.com/users/doctor-claw/followers","following_url":"https://api.github.com/users/doctor-claw/following{/other_user}","gists_url":"https://api.github.com/users/doctor-claw/gists{/gist_id}","starred_url":"https://api.github.com/users/doctor-claw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/doctor-claw/subscriptions","organizations_url":"https://api.github.com/users/doctor-claw/orgs","repos_url":"https://api.github.com/users/doctor-claw/repos","events_url":"https://api.github.com/users/doctor-claw/events{/privacy}","received_events_url":"https://api.github.com/users/doctor-claw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-08T13:02:06Z","updated_at":"2023-05-08T13:03:35Z","author_association":"NONE","body":"I can confirm I'm seeing the same behaviour with CouchDB 3.3.1 on Windows 10 Pro:\r\n\r\n```\r\n[notice] 2023-05-08T12:57:54.149000Z couchdb@localhost <0.7107.0> 2265febc59 localhost:5984 127.0.0.1 admin GET /verifytestdb 404 ok 8\r\n[notice] 2023-05-08T12:57:54.149000Z couchdb@localhost <0.6838.0> be15be928d localhost:5984 127.0.0.1 admin GET /verifytestdb_replicate 404 ok 7\r\n[error] 2023-05-08T12:57:54.154000Z couchdb@localhost <0.6838.0> 0568597d13 Request to create N=3 DB but only 1 node(s)\r\n[notice] 2023-05-08T12:57:54.166000Z couchdb@localhost <0.6838.0> 0568597d13 localhost:5984 127.0.0.1 admin PUT /verifytestdb 201 ok 13\r\n[notice] 2023-05-08T12:57:54.173000Z couchdb@localhost <0.7107.0> 27ec6347f0 localhost:5984 127.0.0.1 admin PUT /verifytestdb/test_doc_1 201 ok 4\r\n[notice] 2023-05-08T12:57:54.179000Z couchdb@localhost <0.7107.0> 3b427cb631 localhost:5984 127.0.0.1 admin PUT /verifytestdb/test_doc_1 201 ok 4\r\n[notice] 2023-05-08T12:57:54.186000Z couchdb@localhost <0.7107.0> 18c801eca1 localhost:5984 127.0.0.1 admin DELETE /verifytestdb/test_doc_1?rev=2-d588d3e93ee155c5afffdf0247a2c5ef 200 ok 4\r\n[notice] 2023-05-08T12:57:54.195000Z couchdb@localhost <0.6789.0> 2244ddd6a0 localhost:5984 127.0.0.1 admin PUT /verifytestdb/test_doc_30 201 ok 5\r\n[notice] 2023-05-08T12:57:54.195000Z couchdb@localhost <0.6786.0> 3666a1e388 localhost:5984 127.0.0.1 admin PUT /verifytestdb/test_doc_20 201 ok 5\r\n[notice] 2023-05-08T12:57:54.195000Z couchdb@localhost <0.7107.0> 9eecc42e7a localhost:5984 127.0.0.1 admin PUT /verifytestdb/test_doc_10 201 ok 6\r\n[notice] 2023-05-08T12:57:54.208000Z couchdb@localhost <0.6786.0> a56c5be681 localhost:5984 127.0.0.1 admin PUT /verifytestdb/_design/view_check 201 ok 10\r\n[info] 2023-05-08T12:57:54.215000Z couchdb@localhost <0.9569.0> -------- Starting index update for db: shards/00000000-7fffffff/verifytestdb.1683550674 idx: _design/view_check\r\n[info] 2023-05-08T12:57:54.219000Z couchdb@localhost <0.9583.0> -------- Starting index update for db: shards/80000000-ffffffff/verifytestdb.1683550674 idx: _design/view_check\r\n[info] 2023-05-08T12:57:54.219000Z couchdb@localhost <0.9569.0> -------- Index update finished for db: shards/00000000-7fffffff/verifytestdb.1683550674 idx: _design/view_check\r\n[info] 2023-05-08T12:57:54.222000Z couchdb@localhost <0.9583.0> -------- Index update finished for db: shards/80000000-ffffffff/verifytestdb.1683550674 idx: _design/view_check\r\n[notice] 2023-05-08T12:57:54.223000Z couchdb@localhost <0.6786.0> 29253cbf65 localhost:5984 127.0.0.1 admin GET /verifytestdb/_design/view_check/_view/testview 200 ok 11\r\n[notice] 2023-05-08T12:57:54.229000Z couchdb@localhost <0.461.0> -------- couch_replicator_scheduler: Job {\"e472081da9cacdefb968f5a0be0f7e52\",\"+create_target\"} started as <0.9600.0>\r\n[notice] 2023-05-08T12:57:57.757000Z couchdb@localhost <0.9600.0> -------- Retrying GET request to http://0.0.0.0:5984/verifytestdb/ in 0.25 seconds due to error {conn_failed,{error,eaddrnotavail}}\r\n[notice] 2023-05-08T12:57:58.271000Z couchdb@localhost <0.9600.0> -------- Retrying GET request to http://0.0.0.0:5984/verifytestdb/ in 0.5 seconds due to error sel_conn_closed\r\n[notice] 2023-05-08T12:57:59.289000Z couchdb@localhost <0.9600.0> -------- Retrying GET request to http://0.0.0.0:5984/verifytestdb/ in 1.0 seconds due to error {conn_failed,{error,eaddrnotavail}}\r\n[notice] 2023-05-08T12:58:01.302000Z couchdb@localhost <0.9600.0> -------- Retrying GET request to http://0.0.0.0:5984/verifytestdb/ in 2.0 seconds due to error {conn_failed,{error,eaddrnotavail}}\r\n[notice] 2023-05-08T12:58:05.315000Z couchdb@localhost <0.9600.0> -------- Retrying GET request to http://0.0.0.0:5984/verifytestdb/ in 4.0 seconds due to error {conn_failed,{error,eaddrnotavail}}\r\n[error] 2023-05-08T12:58:05.316000Z couchdb@localhost <0.9600.0> -------- Replicator, request GET to \"http://0.0.0.0:5984/verifytestdb/\" failed due to error {error,{conn_failed,{error,eaddrnotavail}}}\r\n[error] 2023-05-08T12:58:05.316000Z couchdb@localhost <0.9600.0> -------- exit:{http_request_failed,\"GET\",\"http://0.0.0.0:5984/verifytestdb/\",{error,{error,{conn_failed,{error,eaddrnotavail}}}}}: Replication e472081da9cacdefb968f5a0be0f7e52+create_target failed to start \"http://0.0.0.0:5984/verifytestdb/\" -> \"http://0.0.0.0:5984/verifytestdb_replicate/\" doc null:null stack:[{couch_replicator_api_wrap,db_open,3,[{file,\"src/couch_replicator_api_wrap.erl\"},{line,122}]},{couch_replicator_scheduler_job,init_state,1,[{file,\"src/couch_replicator_scheduler_job.erl\"},{line,634}]}]\r\n[error] 2023-05-08T12:58:05.317000Z couchdb@localhost <0.461.0> -------- couch_replicator_scheduler : Transient job {\"e472081da9cacdefb968f5a0be0f7e52\",\"+create_target\"} failed, removing. Error: <<\"{http_request_failed,\\\"GET\\\",\\\"http://0.0.0.0:5984/verifytestdb/\\\",\\n                     {error,{error,{conn_failed,{error,eaddrnotavail}}}}}\">>\r\n[notice] 2023-05-08T12:58:05.317000Z couchdb@localhost <0.6786.0> 41aaab8679 localhost:5984 127.0.0.1 admin POST /_replicate 500 ok 11089\r\n[notice] 2023-05-08T12:58:05.332000Z couchdb@localhost <0.6786.0> 126d5450c6 localhost:5984 127.0.0.1 admin DELETE /verifytestdb_replicate 404 ok 0\r\n[notice] 2023-05-08T12:58:05.337000Z couchdb@localhost <0.7107.0> 3bfb599f94 localhost:5984 127.0.0.1 admin DELETE /verifytestdb 200 ok 5\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1538322376/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1539935931","html_url":"https://github.com/apache/couchdb/pull/4574#issuecomment-1539935931","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4574","id":1539935931,"node_id":"IC_kwDOAAMmUc5byY67","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-09T10:43:58Z","updated_at":"2023-05-09T10:43:58Z","author_association":"MEMBER","body":"closes https://github.com/apache/couchdb/issues/4566","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1539935931/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1540577732","html_url":"https://github.com/apache/couchdb/pull/4569#issuecomment-1540577732","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4569","id":1540577732,"node_id":"IC_kwDOAAMmUc5b01nE","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-09T17:25:51Z","updated_at":"2023-05-09T17:25:51Z","author_association":"CONTRIBUTOR","body":"Please do not merge this now, I would like to do some refactoring (move the process dictionary function under `mango_execution_stats`) per @chewbranca's recommendations.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1540577732/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1542147595","html_url":"https://github.com/apache/couchdb/issues/4590#issuecomment-1542147595","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4590","id":1542147595,"node_id":"IC_kwDOAAMmUc5b604L","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-10T12:44:43Z","updated_at":"2023-05-10T12:44:43Z","author_association":"MEMBER","body":"This is the expected behaviour with the default Helm chart values. \r\n\r\nIt occurs because each when deploying the helm chart, the admin password is typically specified in plaintext. Each CouchDB node (pod) then hashes the admin password independently on first use, overwriting the plaintext password internally.\r\n\r\nCouchDB's cookie authentication relies on the password hash being the same on each database node, which it is not in this case.\r\n\r\nYou have a few options:\r\n\r\n1. In the Helm chart values, set the admin hash explicitly (see https://sleeplessbeastie.eu/2020/03/13/how-to-generate-password-hash-for-couchdb-administrator/) for how to generate this.\r\n1. Use basic auth only for the admin user. That is, create normal CouchDB users for interactive use.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1542147595/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1542386990","html_url":"https://github.com/apache/couchdb/pull/4569#issuecomment-1542386990","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4569","id":1542386990,"node_id":"IC_kwDOAAMmUc5b7vUu","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-10T15:12:16Z","updated_at":"2023-05-10T15:12:16Z","author_association":"CONTRIBUTOR","body":"OK -- the planned changes are there.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1542386990/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1542428911","html_url":"https://github.com/apache/couchdb/pull/4589#issuecomment-1542428911","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4589","id":1542428911,"node_id":"IC_kwDOAAMmUc5b75jv","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-10T15:43:28Z","updated_at":"2023-05-10T15:43:28Z","author_association":"MEMBER","body":"noting that the `$text` operator in mango is constrained to only be capable of phrase queries (the query you supply is unilaterally enclosed in double quotes) but this affects dreyfus / clouseau also.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1542428911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1542442557","html_url":"https://github.com/apache/couchdb/pull/4591#issuecomment-1542442557","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4591","id":1542442557,"node_id":"IC_kwDOAAMmUc5b7849","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-10T15:53:43Z","updated_at":"2023-05-10T15:53:43Z","author_association":"CONTRIBUTOR","body":"There is also a version in https://github.com/apache/couchdb/blob/main/version.mk","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1542442557/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1542558956","html_url":"https://github.com/apache/couchdb/pull/4592#issuecomment-1542558956","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4592","id":1542558956,"node_id":"IC_kwDOAAMmUc5b8ZTs","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-10T17:24:09Z","updated_at":"2023-05-10T17:24:09Z","author_association":"CONTRIBUTOR","body":"Isn’t 3.3.2 a sub-set of main?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1542558956/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1542580340","html_url":"https://github.com/apache/couchdb/pull/4592#issuecomment-1542580340","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4592","id":1542580340,"node_id":"IC_kwDOAAMmUc5b8eh0","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-10T17:43:03Z","updated_at":"2023-05-10T17:43:03Z","author_association":"CONTRIBUTOR","body":"Closing in favor of https://github.com/apache/couchdb/pull/4593","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1542580340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1542583916","html_url":"https://github.com/apache/couchdb/pull/4592#issuecomment-1542583916","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4592","id":1542583916,"node_id":"IC_kwDOAAMmUc5b8fZs","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-10T17:46:19Z","updated_at":"2023-05-10T17:46:19Z","author_association":"CONTRIBUTOR","body":"@big-r81 you're right, normally we go from main -> 3.3.x but some changes we haven't been making to main and only made them to 3.3.2, some whatnew release notes and the version bump at least so this just bring those into main, so we should try to keep them in sync if possible (at least version-wise main is certainly closer to 3.3.2 in features than 3.3.1).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1542583916/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1542647218","html_url":"https://github.com/apache/couchdb/pull/4355#issuecomment-1542647218","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4355","id":1542647218,"node_id":"IC_kwDOAAMmUc5b8u2y","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-10T18:43:56Z","updated_at":"2023-05-10T18:43:56Z","author_association":"CONTRIBUTOR","body":"This commit was on 3.3.x but it never merged into main. When merged a few bits we forgot from 3.3.x into main https://github.com/apache/couchdb/pull/4593 we brought this change in.\r\n\r\nShould we close this PR?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1542647218/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1543199613","html_url":"https://github.com/apache/couchdb/pull/4554#issuecomment-1543199613","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4554","id":1543199613,"node_id":"IC_kwDOAAMmUc5b-1t9","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-11T02:03:13Z","updated_at":"2023-05-11T02:03:13Z","author_association":"CONTRIBUTOR","body":"This change was replaced for #4569 hence I am now closing it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1543199613/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1543664882","html_url":"https://github.com/apache/couchdb/pull/4551#issuecomment-1543664882","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4551","id":1543664882,"node_id":"IC_kwDOAAMmUc5cAnTy","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-11T09:33:42Z","updated_at":"2023-05-11T09:33:42Z","author_association":"CONTRIBUTOR","body":"@jiahuili430 what was the reason for closing this PR?  I think I know but I am curious.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1543664882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1544261072","html_url":"https://github.com/apache/couchdb/issues/4597#issuecomment-1544261072","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4597","id":1544261072,"node_id":"IC_kwDOAAMmUc5cC43Q","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-11T16:00:39Z","updated_at":"2023-05-11T16:00:39Z","author_association":"CONTRIBUTOR","body":"@pavlov2000uk good find, I don't think weatherreport was fixed to work with the TLS distribution yet\r\n\r\n(Also hopefully those are not production credentials the password hashes, secret and coookie values, if so please consider editing them out and rotate your credentials).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1544261072/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1544271738","html_url":"https://github.com/apache/couchdb/issues/4597#issuecomment-1544271738","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4597","id":1544271738,"node_id":"IC_kwDOAAMmUc5cC7d6","user":{"login":"pavlov2000uk","id":8982726,"node_id":"MDQ6VXNlcjg5ODI3MjY=","avatar_url":"https://avatars.githubusercontent.com/u/8982726?v=4","gravatar_id":"","url":"https://api.github.com/users/pavlov2000uk","html_url":"https://github.com/pavlov2000uk","followers_url":"https://api.github.com/users/pavlov2000uk/followers","following_url":"https://api.github.com/users/pavlov2000uk/following{/other_user}","gists_url":"https://api.github.com/users/pavlov2000uk/gists{/gist_id}","starred_url":"https://api.github.com/users/pavlov2000uk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavlov2000uk/subscriptions","organizations_url":"https://api.github.com/users/pavlov2000uk/orgs","repos_url":"https://api.github.com/users/pavlov2000uk/repos","events_url":"https://api.github.com/users/pavlov2000uk/events{/privacy}","received_events_url":"https://api.github.com/users/pavlov2000uk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-11T16:06:36Z","updated_at":"2023-05-11T16:06:36Z","author_association":"NONE","body":"Thank you. Test values everywhere .... all form my lab.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1544271738/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1544278655","html_url":"https://github.com/apache/couchdb/issues/4597#issuecomment-1544278655","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4597","id":1544278655,"node_id":"IC_kwDOAAMmUc5cC9J_","user":{"login":"pavlov2000uk","id":8982726,"node_id":"MDQ6VXNlcjg5ODI3MjY=","avatar_url":"https://avatars.githubusercontent.com/u/8982726?v=4","gravatar_id":"","url":"https://api.github.com/users/pavlov2000uk","html_url":"https://github.com/pavlov2000uk","followers_url":"https://api.github.com/users/pavlov2000uk/followers","following_url":"https://api.github.com/users/pavlov2000uk/following{/other_user}","gists_url":"https://api.github.com/users/pavlov2000uk/gists{/gist_id}","starred_url":"https://api.github.com/users/pavlov2000uk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavlov2000uk/subscriptions","organizations_url":"https://api.github.com/users/pavlov2000uk/orgs","repos_url":"https://api.github.com/users/pavlov2000uk/repos","events_url":"https://api.github.com/users/pavlov2000uk/events{/privacy}","received_events_url":"https://api.github.com/users/pavlov2000uk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-11T16:10:47Z","updated_at":"2023-05-11T16:10:47Z","author_association":"NONE","body":"If the team is already aware of the issue, by any chance maybe some ETA can be shared? ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1544278655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1544670610","html_url":"https://github.com/apache/couchdb/issues/4597#issuecomment-1544670610","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4597","id":1544670610,"node_id":"IC_kwDOAAMmUc5cEc2S","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-11T20:58:25Z","updated_at":"2023-05-11T20:58:34Z","author_association":"CONTRIBUTOR","body":"I imagine weatherreport would need something similar to what remsh has already for TLS conf:\r\n\r\nhttps://github.com/apache/couchdb/blob/main/rel/overlay/bin/remsh#L130-L134\r\n\r\nNot sure on the timeline of the fix. I personally don't use weatherreport much so don't know much about its internals.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1544670610/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1544676904","html_url":"https://github.com/apache/couchdb/issues/4521#issuecomment-1544676904","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4521","id":1544676904,"node_id":"IC_kwDOAAMmUc5cEeYo","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-11T21:03:05Z","updated_at":"2023-05-11T21:03:05Z","author_association":"CONTRIBUTOR","body":"I haven't recently seen these failure on s390x. After the KVM switchover, s390x is usually the 2nd fastest CI worker we have now, too. Closing for now. I am sure race conditions in that tests are real but may not be related to s390x specifically.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1544676904/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1545425916","html_url":"https://github.com/apache/couchdb/issues/4590#issuecomment-1545425916","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4590","id":1545425916,"node_id":"IC_kwDOAAMmUc5cHVP8","user":{"login":"aeytom","id":1958251,"node_id":"MDQ6VXNlcjE5NTgyNTE=","avatar_url":"https://avatars.githubusercontent.com/u/1958251?v=4","gravatar_id":"","url":"https://api.github.com/users/aeytom","html_url":"https://github.com/aeytom","followers_url":"https://api.github.com/users/aeytom/followers","following_url":"https://api.github.com/users/aeytom/following{/other_user}","gists_url":"https://api.github.com/users/aeytom/gists{/gist_id}","starred_url":"https://api.github.com/users/aeytom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aeytom/subscriptions","organizations_url":"https://api.github.com/users/aeytom/orgs","repos_url":"https://api.github.com/users/aeytom/repos","events_url":"https://api.github.com/users/aeytom/events{/privacy}","received_events_url":"https://api.github.com/users/aeytom/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-12T09:07:47Z","updated_at":"2023-05-12T09:07:47Z","author_association":"NONE","body":"Thank you for your answer and solution options. \r\n\r\nI will try opton one.\r\nDid you why is not the [`chttpd_auth.secret`](https://docs.couchdb.org/en/stable/config/auth.html#chttpd_auth/secret) is used as auth base?\r\n\r\n```\r\nThe secret token is used for Proxy Authentication and for Cookie Authentication.\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1545425916/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1545605625","html_url":"https://github.com/apache/couchdb/issues/4590#issuecomment-1545605625","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4590","id":1545605625,"node_id":"IC_kwDOAAMmUc5cIBH5","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-12T11:36:21Z","updated_at":"2023-05-12T11:36:21Z","author_association":"MEMBER","body":"@aeytom you can see the implementation at https://github.com/apache/couchdb/blob/85e1fa7913b5a564c1731ad86fbba294a9d9a16c/src/couch/src/couch_httpd_auth.erl#L363. As I understand it, [chttpd_auth.secret](https://docs.couchdb.org/en/stable/config/auth.html#chttpd_auth/secret) is used, but is combined with the salt from the user's password hash which, in this case, varies by node.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1545605625/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1545834042","html_url":"https://github.com/apache/couchdb/pull/4551#issuecomment-1545834042","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4551","id":1545834042,"node_id":"IC_kwDOAAMmUc5cI446","user":{"login":"jiahuili430","id":54631519,"node_id":"MDQ6VXNlcjU0NjMxNTE5","avatar_url":"https://avatars.githubusercontent.com/u/54631519?v=4","gravatar_id":"","url":"https://api.github.com/users/jiahuili430","html_url":"https://github.com/jiahuili430","followers_url":"https://api.github.com/users/jiahuili430/followers","following_url":"https://api.github.com/users/jiahuili430/following{/other_user}","gists_url":"https://api.github.com/users/jiahuili430/gists{/gist_id}","starred_url":"https://api.github.com/users/jiahuili430/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiahuili430/subscriptions","organizations_url":"https://api.github.com/users/jiahuili430/orgs","repos_url":"https://api.github.com/users/jiahuili430/repos","events_url":"https://api.github.com/users/jiahuili430/events{/privacy}","received_events_url":"https://api.github.com/users/jiahuili430/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-12T14:27:31Z","updated_at":"2023-05-12T14:27:31Z","author_association":"CONTRIBUTOR","body":"> @jiahuili430 what was the reason for closing this PR? I think I know but I am curious.\r\n\r\nNick and Bob have a better solution to replace the md5-related code, so I closed this one.\r\n- Use xxHash: https://github.com/apache/couchdb/pull/4570\r\n- Remove Content-MD5 header support: https://github.com/apache/couchdb/pull/4574","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1545834042/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1546701143","html_url":"https://github.com/apache/couchdb/pull/4578#issuecomment-1546701143","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4578","id":1546701143,"node_id":"IC_kwDOAAMmUc5cMMlX","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-13T16:08:10Z","updated_at":"2023-05-13T16:08:10Z","author_association":"CONTRIBUTOR","body":"Benchmarking this on small documents I don't see much of a difference, other operations (file reads, etc) probably dominate. On larger documents it is more noticeable (~30% faster reads for 128KB docs).\r\n\r\n`write_xxhash_checksums = false`\r\n\r\n```\r\n(node1@127.0.0.1)3> fabric_bench:go(#{doc_size=>large, docs=>25000}).\r\n *** Parameters\r\n * batch_size       : 1000\r\n * doc_size         : large\r\n * docs             : 25000\r\n * individual_docs  : 1000\r\n * n                : default\r\n * q                : default\r\n\r\n *** Environment\r\n * Nodes        : 1\r\n * Bench ver.   : 1\r\n * N            : 1\r\n * Q            : 2\r\n * OS           : unix/darwin\r\n * Couch ver.   : 3.3.1-9b8435d\r\n * Couch git sha: 9b8435d\r\n * VM details   : Erlang/OTP 24 [erts-12.3.2.11] [source] [64-bit] [smp:12:12] [ds:12:12:16] [async-threads:1] [jit]\r\n\r\n *** Inserting 25000 docs\r\n * Add 25000 docs, ok:25/accepted:0       (Hz):     230\r\n * Get random doc 25000X                  (Hz):     770\r\n * All docs                               (Hz):  110000\r\n * All docs w/ include_docs               (Hz):    1300\r\n * Changes                                (Hz):   53000\r\n * Single doc updates 1000X               (Hz):      20\r\n * Time to run all benchmarks            (sec):     194\r\n```\r\n\r\n`write_xxhash_checksums = true`\r\n```\r\n(node1@127.0.0.1)3> fabric_bench:go(#{doc_size=>large, docs=>25000}).\r\n *** Parameters\r\n * batch_size       : 1000\r\n * doc_size         : large\r\n * docs             : 25000\r\n * individual_docs  : 1000\r\n * n                : default\r\n * q                : default\r\n\r\n *** Environment\r\n * Nodes        : 1\r\n * Bench ver.   : 1\r\n * N            : 1\r\n * Q            : 2\r\n * OS           : unix/darwin\r\n * Couch ver.   : 3.3.1-9b8435d\r\n * Couch git sha: 9b8435d\r\n * VM details   : Erlang/OTP 24 [erts-12.3.2.11] [source] [64-bit] [smp:12:12] [ds:12:12:16] [async-threads:1] [jit]\r\n\r\n *** Inserting 25000 docs\r\n * Add 25000 docs, ok:25/accepted:0       (Hz):     240\r\n * Get random doc 25000X                  (Hz):    1100\r\n * All docs                               (Hz):  120000\r\n * All docs w/ include_docs               (Hz):    1300\r\n * Changes                                (Hz):   51000\r\n * Single doc updates 1000X               (Hz):      20\r\n * Time to run all benchmarks            (sec):     180\r\nok\r\n```\r\n\r\nScript used for benchmark: https://gist.github.com/nickva/cf8fb11edecc389daa608bf4e7ae3a36","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1546701143/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1548052822","html_url":"https://github.com/apache/couchdb/issues/3660#issuecomment-1548052822","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3660","id":1548052822,"node_id":"IC_kwDOAAMmUc5cRWlW","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-15T15:10:53Z","updated_at":"2023-05-15T15:10:53Z","author_association":"CONTRIBUTOR","body":"With the later OS variants and a new KVM based s390x CI instances all tests now pass the s390x is part of the regular full CI run.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1548052822/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1548259476","html_url":"https://github.com/apache/couchdb/issues/2570#issuecomment-1548259476","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2570","id":1548259476,"node_id":"IC_kwDOAAMmUc5cSJCU","user":{"login":"ronnievsmith","id":12751611,"node_id":"MDQ6VXNlcjEyNzUxNjEx","avatar_url":"https://avatars.githubusercontent.com/u/12751611?v=4","gravatar_id":"","url":"https://api.github.com/users/ronnievsmith","html_url":"https://github.com/ronnievsmith","followers_url":"https://api.github.com/users/ronnievsmith/followers","following_url":"https://api.github.com/users/ronnievsmith/following{/other_user}","gists_url":"https://api.github.com/users/ronnievsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/ronnievsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ronnievsmith/subscriptions","organizations_url":"https://api.github.com/users/ronnievsmith/orgs","repos_url":"https://api.github.com/users/ronnievsmith/repos","events_url":"https://api.github.com/users/ronnievsmith/events{/privacy}","received_events_url":"https://api.github.com/users/ronnievsmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-15T17:26:37Z","updated_at":"2023-05-15T17:26:37Z","author_association":"NONE","body":"CORS Issue here too. Chrome Browser Version 113.0.5672.93 (Official Build) (64-bit)\r\n\r\n**Is it possible to configure CouchDB to respond to an HTTP OPTIONS request with a status 200 / response.ok true?**\r\n\r\nJavaScript Fetch API. CouchDB server fails \"blocked by CORS policy: Response to preflight request doesn't pass access control check: It does not have HTTP ok status.\"\r\n\r\nI have tried using 127.0.0.1, localhost, a domain name, with and without https. Configuration below. \r\n```\r\n[chttpd]\r\nenable_cors = true\r\n[cors]\r\norigins = *\r\ncredentials = true\r\nmethods = GET, POST, PUT, DELETE, OPTIONS, HEAD, TRACE, PATCH\r\nheaders = accept, authorization, content-type, origin, referer, cache-control, x-requested-with, X-Couch-Id, X-Couch-Rev\r\n```\r\nJavaScript fetch options:\r\n```\r\n{\r\n  \"headers\": {\r\n    \"Content-Type\": \"application/json\",\r\n    \"method\": \"GET\",\r\n    \"credentials\": \"include\",\r\n    \"mode\": \"cors\"\r\n  }\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1548259476/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1548482493","html_url":"https://github.com/apache/couchdb/issues/2570#issuecomment-1548482493","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2570","id":1548482493,"node_id":"IC_kwDOAAMmUc5cS_e9","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-15T19:52:39Z","updated_at":"2023-05-15T19:52:39Z","author_association":"CONTRIBUTOR","body":"Does this help? https://stackoverflow.com/questions/30161843/cors-error-in-pouchdb-with-cors-enabled-in-couchdb#comments-30210932","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1548482493/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1548484746","html_url":"https://github.com/apache/couchdb/issues/2570#issuecomment-1548484746","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2570","id":1548484746,"node_id":"IC_kwDOAAMmUc5cTACK","user":{"login":"ronnievsmith","id":12751611,"node_id":"MDQ6VXNlcjEyNzUxNjEx","avatar_url":"https://avatars.githubusercontent.com/u/12751611?v=4","gravatar_id":"","url":"https://api.github.com/users/ronnievsmith","html_url":"https://github.com/ronnievsmith","followers_url":"https://api.github.com/users/ronnievsmith/followers","following_url":"https://api.github.com/users/ronnievsmith/following{/other_user}","gists_url":"https://api.github.com/users/ronnievsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/ronnievsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ronnievsmith/subscriptions","organizations_url":"https://api.github.com/users/ronnievsmith/orgs","repos_url":"https://api.github.com/users/ronnievsmith/repos","events_url":"https://api.github.com/users/ronnievsmith/events{/privacy}","received_events_url":"https://api.github.com/users/ronnievsmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-15T19:54:30Z","updated_at":"2023-05-15T19:54:30Z","author_association":"NONE","body":"No. I'm simply trying to do basic authentication to CouchDB.\r\n\r\n**After more testing, the CORS issue surfaces only when I add the 'credentials': 'include' header. ...?**","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1548484746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1549153081","html_url":"https://github.com/apache/couchdb/issues/2570#issuecomment-1549153081","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2570","id":1549153081,"node_id":"IC_kwDOAAMmUc5cVjM5","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-16T07:36:24Z","updated_at":"2023-05-16T07:36:24Z","author_association":"MEMBER","body":"CORS does not allow * origins and credentials use at the same time\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1549153081/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1550059844","html_url":"https://github.com/apache/couchdb/issues/2570#issuecomment-1550059844","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2570","id":1550059844,"node_id":"IC_kwDOAAMmUc5cZAlE","user":{"login":"benel","id":597307,"node_id":"MDQ6VXNlcjU5NzMwNw==","avatar_url":"https://avatars.githubusercontent.com/u/597307?v=4","gravatar_id":"","url":"https://api.github.com/users/benel","html_url":"https://github.com/benel","followers_url":"https://api.github.com/users/benel/followers","following_url":"https://api.github.com/users/benel/following{/other_user}","gists_url":"https://api.github.com/users/benel/gists{/gist_id}","starred_url":"https://api.github.com/users/benel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benel/subscriptions","organizations_url":"https://api.github.com/users/benel/orgs","repos_url":"https://api.github.com/users/benel/repos","events_url":"https://api.github.com/users/benel/events{/privacy}","received_events_url":"https://api.github.com/users/benel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-16T17:11:02Z","updated_at":"2023-05-16T17:11:02Z","author_association":"NONE","body":"Please check also: https://stackoverflow.com/questions/50914196/cors-requests-with-preflight-on-couchdb/50914749#50914749","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1550059844/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1550102998","html_url":"https://github.com/apache/couchdb/issues/2570#issuecomment-1550102998","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2570","id":1550102998,"node_id":"IC_kwDOAAMmUc5cZLHW","user":{"login":"ronnievsmith","id":12751611,"node_id":"MDQ6VXNlcjEyNzUxNjEx","avatar_url":"https://avatars.githubusercontent.com/u/12751611?v=4","gravatar_id":"","url":"https://api.github.com/users/ronnievsmith","html_url":"https://github.com/ronnievsmith","followers_url":"https://api.github.com/users/ronnievsmith/followers","following_url":"https://api.github.com/users/ronnievsmith/following{/other_user}","gists_url":"https://api.github.com/users/ronnievsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/ronnievsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ronnievsmith/subscriptions","organizations_url":"https://api.github.com/users/ronnievsmith/orgs","repos_url":"https://api.github.com/users/ronnievsmith/repos","events_url":"https://api.github.com/users/ronnievsmith/events{/privacy}","received_events_url":"https://api.github.com/users/ronnievsmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-16T17:42:28Z","updated_at":"2023-05-16T17:42:28Z","author_association":"NONE","body":"I can't make a call to CouchDB with basic authentication whatsoever. I just tried adding the `if-match` to cors headers. Once you add `credentials:include` CORS fails. I'm going to try and sniff the HTTP from Fauxton to see what their requests look like.\r\n\r\nSeems like a simple working example of a client-side HTTP fetch could be included in the documentation.\r\n\r\nMaybe CouchDB is not supposed to respond directly to web browsers? 3 days on this and at some point I suppose I'll have to move on to another DB alltogether.\r\n```\r\n{\r\n  \"headers\": {\r\n    \"Authorization\": \"Basic W29iamVjdCBIVE1MSW5wdXRFbGVtZW50XTpbb2JqZWN0IEhUTUxJbnB1dEVsZW1lbnRd\",\r\n    \"credentials\": \"include\"\r\n  }\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1550102998/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1550593024","html_url":"https://github.com/apache/couchdb/pull/4604#issuecomment-1550593024","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4604","id":1550593024,"node_id":"IC_kwDOAAMmUc5cbCwA","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-17T02:21:54Z","updated_at":"2023-05-17T02:21:54Z","author_association":"MEMBER","body":"@nickva do we need to handle Windows path separators here as well?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1550593024/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1551202606","html_url":"https://github.com/apache/couchdb/pull/4604#issuecomment-1551202606","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4604","id":1551202606,"node_id":"IC_kwDOAAMmUc5cdXku","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-17T11:15:23Z","updated_at":"2023-05-17T11:15:23Z","author_association":"CONTRIBUTOR","body":"The PR in its current form does not remove any old code (i.e. no replace) and the new function is not used anywhere.  Is this still a draft?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1551202606/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1551320600","html_url":"https://github.com/apache/couchdb/pull/4604#issuecomment-1551320600","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4604","id":1551320600,"node_id":"IC_kwDOAAMmUc5cd0YY","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-17T12:40:21Z","updated_at":"2023-05-17T12:40:38Z","author_association":"CONTRIBUTOR","body":"There are other places in the codebase which use `filename:basename/1`.  `mem3` application depend on `couch` app. Most of the things depend on `couch`. I would suggest to place this function in `couch_util`.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1551320600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1552073263","html_url":"https://github.com/apache/couchdb/pull/4604#issuecomment-1552073263","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4604","id":1552073263,"node_id":"IC_kwDOAAMmUc5cgsIv","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-17T20:56:00Z","updated_at":"2023-05-17T20:56:00Z","author_association":"CONTRIBUTOR","body":"> @nickva do we need to handle Windows path separators here as well?\r\n\r\nGood point, @willholley. I had noticed in other parts of the code we don't handle Windows paths as just use `/` and expect Windows to handle that format as well. Since I had updated the PR to do a simpler check like and fall back to the previous method if that fails.\r\n\r\n> I would suggest to place this function in couch_util.\r\n\r\n@iilyak I started doing it that way but then in the latest version, opted to just specialize the function to handle timestamp specifically, so then mem3 seemed like a good place for it. If those other places are hotspots seen in profiling we can optimize those too if needed.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1552073263/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1552079498","html_url":"https://github.com/apache/couchdb/pull/4604#issuecomment-1552079498","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4604","id":1552079498,"node_id":"IC_kwDOAAMmUc5cgtqK","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-17T21:01:50Z","updated_at":"2023-05-17T21:01:50Z","author_association":"CONTRIBUTOR","body":"@davisp Inspired by your `drop_dot_couch_ext/1` function from while back though we could do something similar here. That proved to be the fastest approach:\r\n\r\nhttps://github.com/apache/couchdb/blob/6b4cbaa72ab766e0a08c592971fb86be99a7d182/src/couch/src/couch_util.erl#L385-L394\r\n\r\nThe slight complication is we don't know the exact extension binary, we just expect it to be a 10 digit integer, so we use the `binary_to_integer` BIF to test it. That seems speedy enough.\r\n\r\nWe tried a few approaches like matching all the 10 digits separately but the BIF seems to a tiny bit faster and is a bit shorter overall.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1552079498/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1554197964","html_url":"https://github.com/apache/couchdb/pull/4575#issuecomment-1554197964","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4575","id":1554197964,"node_id":"IC_kwDOAAMmUc5coy3M","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T08:03:09Z","updated_at":"2023-05-19T08:03:09Z","author_association":"MEMBER","body":"I agree with nick. The value of `--generate-tls-dev-cert` is to demonstrate how to correctly set up a couchdb cluster with TLS for the erlang distribution protocol as much as possible. So the nodes should mutually authenticate each other. The nodes will need a certificate each (with their erlang node name as the Common Name attribute), etc. The only difference between what we do here and a real setup should be the node certificates and the CA that signed them.\r\n\r\nI've also suggested elsewhere to move the logic from configure to dev/run as we only know the number of nodes at dev/run time. With that done it will be possible to automatically add the correct arguments to `vm.args` for each node, like we currently do to add the individual node names.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1554197964/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1555960175","html_url":"https://github.com/apache/couchdb/pull/4581#issuecomment-1555960175","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4581","id":1555960175,"node_id":"IC_kwDOAAMmUc5cvhFv","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T17:45:59Z","updated_at":"2023-05-20T17:45:59Z","author_association":"CONTRIBUTOR","body":"Minor nit: the title should say \"OTP 26 _compatibility_\".","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1555960175/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1555961696","html_url":"https://github.com/apache/couchdb/pull/4581#issuecomment-1555961696","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4581","id":1555961696,"node_id":"IC_kwDOAAMmUc5cvhdg","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T17:55:36Z","updated_at":"2023-05-20T17:55:36Z","author_association":"CONTRIBUTOR","body":"> Minor nit: the title should say \"OTP 26 _compatibility_\".\r\n\r\nOops, fixed!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1555961696/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1557284008","html_url":"https://github.com/apache/couchdb/issues/4523#issuecomment-1557284008","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4523","id":1557284008,"node_id":"IC_kwDOAAMmUc5c0kSo","user":{"login":"manurajsingh","id":65969563,"node_id":"MDQ6VXNlcjY1OTY5NTYz","avatar_url":"https://avatars.githubusercontent.com/u/65969563?v=4","gravatar_id":"","url":"https://api.github.com/users/manurajsingh","html_url":"https://github.com/manurajsingh","followers_url":"https://api.github.com/users/manurajsingh/followers","following_url":"https://api.github.com/users/manurajsingh/following{/other_user}","gists_url":"https://api.github.com/users/manurajsingh/gists{/gist_id}","starred_url":"https://api.github.com/users/manurajsingh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manurajsingh/subscriptions","organizations_url":"https://api.github.com/users/manurajsingh/orgs","repos_url":"https://api.github.com/users/manurajsingh/repos","events_url":"https://api.github.com/users/manurajsingh/events{/privacy}","received_events_url":"https://api.github.com/users/manurajsingh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-22T14:05:48Z","updated_at":"2023-05-22T14:05:48Z","author_association":"NONE","body":"That helped thank you.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1557284008/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1557329524","html_url":"https://github.com/apache/couchdb/issues/4611#issuecomment-1557329524","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4611","id":1557329524,"node_id":"IC_kwDOAAMmUc5c0vZ0","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-22T14:32:17Z","updated_at":"2023-05-22T14:32:17Z","author_association":"CONTRIBUTOR","body":"The error indicates the JS engine request is timing out after 5 seconds during document updates. Your database probably has some design documents with [VDUs](https://docs.couchdb.org/en/stable/ddocs/ddocs.html#validate-document-update-functions). \r\n\r\nIf you have large documents you could try increasing that timeout:\r\n ```\r\n[couchdb] os_process_timeout = 5000\r\n```\r\nMake it 15000 (15 sec), for instance.\r\n\r\nIf you're doing a lot of  concurrent updates, you may want to increase your JS engine limit to something higher than the default 100:\r\n```\r\n[query_server_config]\r\nos_process_limit = 100\r\n```\r\n\r\nMake it 250 and see if it help. \r\n\r\nThere is also a good chance that your VDU JS code is crashing or has a loop that's running too long or something like that. Look in the log to see if you notice any stack traces or exceptions.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1557329524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1557354150","html_url":"https://github.com/apache/couchdb/issues/4611#issuecomment-1557354150","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4611","id":1557354150,"node_id":"IC_kwDOAAMmUc5c01am","user":{"login":"manurajsingh","id":65969563,"node_id":"MDQ6VXNlcjY1OTY5NTYz","avatar_url":"https://avatars.githubusercontent.com/u/65969563?v=4","gravatar_id":"","url":"https://api.github.com/users/manurajsingh","html_url":"https://github.com/manurajsingh","followers_url":"https://api.github.com/users/manurajsingh/followers","following_url":"https://api.github.com/users/manurajsingh/following{/other_user}","gists_url":"https://api.github.com/users/manurajsingh/gists{/gist_id}","starred_url":"https://api.github.com/users/manurajsingh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manurajsingh/subscriptions","organizations_url":"https://api.github.com/users/manurajsingh/orgs","repos_url":"https://api.github.com/users/manurajsingh/repos","events_url":"https://api.github.com/users/manurajsingh/events{/privacy}","received_events_url":"https://api.github.com/users/manurajsingh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-22T14:47:07Z","updated_at":"2023-05-22T14:47:30Z","author_association":"NONE","body":"Thanks for the quick response Nick\r\n\r\nI will apply your suggested changes. But note that my databases are currently empty.\r\n\r\n I will update you soon.\r\n\r\nContext\r\nI was creating empty databases via REST Calls and then creating a view.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1557354150/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1557356070","html_url":"https://github.com/apache/couchdb/issues/4611#issuecomment-1557356070","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4611","id":1557356070,"node_id":"IC_kwDOAAMmUc5c014m","user":{"login":"manurajsingh","id":65969563,"node_id":"MDQ6VXNlcjY1OTY5NTYz","avatar_url":"https://avatars.githubusercontent.com/u/65969563?v=4","gravatar_id":"","url":"https://api.github.com/users/manurajsingh","html_url":"https://github.com/manurajsingh","followers_url":"https://api.github.com/users/manurajsingh/followers","following_url":"https://api.github.com/users/manurajsingh/following{/other_user}","gists_url":"https://api.github.com/users/manurajsingh/gists{/gist_id}","starred_url":"https://api.github.com/users/manurajsingh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manurajsingh/subscriptions","organizations_url":"https://api.github.com/users/manurajsingh/orgs","repos_url":"https://api.github.com/users/manurajsingh/repos","events_url":"https://api.github.com/users/manurajsingh/events{/privacy}","received_events_url":"https://api.github.com/users/manurajsingh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-22T14:48:21Z","updated_at":"2023-05-22T14:48:21Z","author_association":"NONE","body":"[couchdb.zip](https://github.com/apache/couchdb/files/11532287/couchdb.zip)\r\n\r\nAttached Logs.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1557356070/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1557398269","html_url":"https://github.com/apache/couchdb/issues/4611#issuecomment-1557398269","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4611","id":1557398269,"node_id":"IC_kwDOAAMmUc5c1AL9","user":{"login":"manurajsingh","id":65969563,"node_id":"MDQ6VXNlcjY1OTY5NTYz","avatar_url":"https://avatars.githubusercontent.com/u/65969563?v=4","gravatar_id":"","url":"https://api.github.com/users/manurajsingh","html_url":"https://github.com/manurajsingh","followers_url":"https://api.github.com/users/manurajsingh/followers","following_url":"https://api.github.com/users/manurajsingh/following{/other_user}","gists_url":"https://api.github.com/users/manurajsingh/gists{/gist_id}","starred_url":"https://api.github.com/users/manurajsingh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manurajsingh/subscriptions","organizations_url":"https://api.github.com/users/manurajsingh/orgs","repos_url":"https://api.github.com/users/manurajsingh/repos","events_url":"https://api.github.com/users/manurajsingh/events{/privacy}","received_events_url":"https://api.github.com/users/manurajsingh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-22T15:10:26Z","updated_at":"2023-05-22T15:10:26Z","author_association":"NONE","body":"I am closing this Nick.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1557398269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1557398671","html_url":"https://github.com/apache/couchdb/issues/4611#issuecomment-1557398671","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4611","id":1557398671,"node_id":"IC_kwDOAAMmUc5c1ASP","user":{"login":"manurajsingh","id":65969563,"node_id":"MDQ6VXNlcjY1OTY5NTYz","avatar_url":"https://avatars.githubusercontent.com/u/65969563?v=4","gravatar_id":"","url":"https://api.github.com/users/manurajsingh","html_url":"https://github.com/manurajsingh","followers_url":"https://api.github.com/users/manurajsingh/followers","following_url":"https://api.github.com/users/manurajsingh/following{/other_user}","gists_url":"https://api.github.com/users/manurajsingh/gists{/gist_id}","starred_url":"https://api.github.com/users/manurajsingh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manurajsingh/subscriptions","organizations_url":"https://api.github.com/users/manurajsingh/orgs","repos_url":"https://api.github.com/users/manurajsingh/repos","events_url":"https://api.github.com/users/manurajsingh/events{/privacy}","received_events_url":"https://api.github.com/users/manurajsingh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-22T15:10:39Z","updated_at":"2023-05-22T15:10:39Z","author_association":"NONE","body":"Thanks.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1557398671/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1557399252","html_url":"https://github.com/apache/couchdb/issues/4612#issuecomment-1557399252","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4612","id":1557399252,"node_id":"IC_kwDOAAMmUc5c1AbU","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-22T15:10:58Z","updated_at":"2023-05-22T15:10:58Z","author_association":"MEMBER","body":"note that the function strings are cached (by load_validation_funs in couch_doc), but we send them to couchjs on every doc update, so we don't get any benefit from JIT and we're bloating the message we send to validate_doc_update over stdio.\r\n\r\nsee if we can do better here.\r\n\r\nrelated PR https://github.com/apache/couchdb/pull/1898 which proposes another way to do VDU's without javascript at all.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1557399252/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1558434589","html_url":"https://github.com/apache/couchdb/pull/4613#issuecomment-1558434589","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4613","id":1558434589,"node_id":"IC_kwDOAAMmUc5c49Md","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-23T03:02:09Z","updated_at":"2023-05-23T03:02:09Z","author_association":"CONTRIBUTOR","body":"I'll merge this PR to avoid it needing another rebase + CI run wait as I have another smaller PR pending if that merged before this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1558434589/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1558461570","html_url":"https://github.com/apache/couchdb/pull/4614#issuecomment-1558461570","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4614","id":1558461570,"node_id":"IC_kwDOAAMmUc5c5DyC","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-23T03:34:25Z","updated_at":"2023-05-23T03:34:25Z","author_association":"CONTRIBUTOR","body":"`{median,0.667},` very nice!\r\n\r\nEven P90 6 vs 81 msec on my machine is quite nice.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1558461570/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1558640481","html_url":"https://github.com/apache/couchdb/pull/4614#issuecomment-1558640481","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4614","id":1558640481,"node_id":"IC_kwDOAAMmUc5c5vdh","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-23T06:52:51Z","updated_at":"2023-05-23T06:52:51Z","author_association":"MEMBER","body":"why didn't we use native units for T0 and T1 and then convert_time_unit at the end?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1558640481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1559502725","html_url":"https://github.com/apache/couchdb/pull/4614#issuecomment-1559502725","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4614","id":1559502725,"node_id":"IC_kwDOAAMmUc5c9B-F","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-23T14:19:13Z","updated_at":"2023-05-23T14:19:13Z","author_association":"CONTRIBUTOR","body":"@rnewson `erlang:convert_time_unit/3` would have yielded an integer number milliseconds and we would have lost the sub-millisecond precision. However an improvement could be to collect the data in native, compute the dt (still in native), convert to nanoseconds (as integer) then divide by 1e6 to yield a millisecond floating point value.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1559502725/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1559505849","html_url":"https://github.com/apache/couchdb/pull/4614#issuecomment-1559505849","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4614","id":1559505849,"node_id":"IC_kwDOAAMmUc5c9Cu5","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-23T14:20:17Z","updated_at":"2023-05-23T14:20:17Z","author_association":"MEMBER","body":"A comment in the code to that effect would help, and maybe prevent a future \"fix\" that would break that.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1559505849/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1559509200","html_url":"https://github.com/apache/couchdb/pull/4614#issuecomment-1559509200","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4614","id":1559509200,"node_id":"IC_kwDOAAMmUc5c9DjQ","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-23T14:21:26Z","updated_at":"2023-05-23T14:21:26Z","author_association":"MEMBER","body":"rather, update the comment to say \"fractional milliseconds\" not \"fractional microseconds\"","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1559509200/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1559522931","html_url":"https://github.com/apache/couchdb/pull/4614#issuecomment-1559522931","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4614","id":1559522931,"node_id":"IC_kwDOAAMmUc5c9G5z","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-23T14:26:12Z","updated_at":"2023-05-23T14:26:12Z","author_association":"CONTRIBUTOR","body":"Good idea","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1559522931/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1559669453","html_url":"https://github.com/apache/couchdb/pull/4614#issuecomment-1559669453","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4614","id":1559669453,"node_id":"IC_kwDOAAMmUc5c9qrN","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-23T15:28:54Z","updated_at":"2023-05-23T15:28:54Z","author_association":"CONTRIBUTOR","body":"Improved it a bit in https://github.com/apache/couchdb/pull/4616","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1559669453/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1562050436","html_url":"https://github.com/apache/couchdb/pull/3901#issuecomment-1562050436","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3901","id":1562050436,"node_id":"IC_kwDOAAMmUc5dGv-E","user":{"login":"xrobau","id":457798,"node_id":"MDQ6VXNlcjQ1Nzc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/457798?v=4","gravatar_id":"","url":"https://api.github.com/users/xrobau","html_url":"https://github.com/xrobau","followers_url":"https://api.github.com/users/xrobau/followers","following_url":"https://api.github.com/users/xrobau/following{/other_user}","gists_url":"https://api.github.com/users/xrobau/gists{/gist_id}","starred_url":"https://api.github.com/users/xrobau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xrobau/subscriptions","organizations_url":"https://api.github.com/users/xrobau/orgs","repos_url":"https://api.github.com/users/xrobau/repos","events_url":"https://api.github.com/users/xrobau/events{/privacy}","received_events_url":"https://api.github.com/users/xrobau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-24T23:27:38Z","updated_at":"2023-05-24T23:56:15Z","author_association":"CONTRIBUTOR","body":"This has just appeared on the latest 3.3.0 build (3.3.2, actually) from when we upgraded from 3.2.2-2~jammy.\r\n\r\nUnfortunately, this caused ALL the client replicators to abort with an error:\r\n\r\n````\r\n  \"state\": \"crashing\",\r\n  \"info\": {\r\n    \"error\": \"instance_start_time on source database has changed since last checkpoint.\"\r\n  },\r\n````\r\nAs 3.2.2-2 returned zero, and 3.3.2 returns the correct time, I'm not really sure how to fix this without triggering a complete re-replication. which in a database with several hundred million entries is an annoyingly complex and slow process.\r\n\r\nEdit: If anyone ended up here by googling the error, to temporarily work around it roll back to 3.2.2-2, using the command `apt install couch=3.2.2-2~jammy` and follow the bug #4621 \r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1562050436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1562067161","html_url":"https://github.com/apache/couchdb/pull/3901#issuecomment-1562067161","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3901","id":1562067161,"node_id":"IC_kwDOAAMmUc5dG0DZ","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-24T23:46:56Z","updated_at":"2023-05-24T23:46:56Z","author_association":"CONTRIBUTOR","body":"We might want to add a special case for comparing to <<\"0\">> and a non-zero and let that \"pass\" as a valid comparison, handling cases where a cluster is upgraded...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1562067161/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1562079877","html_url":"https://github.com/apache/couchdb/pull/4622#issuecomment-1562079877","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4622","id":1562079877,"node_id":"IC_kwDOAAMmUc5dG3KF","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-25T00:06:57Z","updated_at":"2023-05-25T00:08:42Z","author_association":"CONTRIBUTOR","body":"Some quick and dirty benchmarking\r\n\r\nTL;DR: \r\n   - 3x faster than SM 1.8.5\r\n   - 4x faster than SM 91\r\n   - 6x reduced memory usage per couchjs process (5MB vs 30MB).\r\n\r\nNeeds more benchmarking but so far looks decent. And the lower resource consumption should be a benefit running in the new fedramp kube environment.\r\n\r\n**Setup Details**\r\n\r\nMacOS Intel, Erlang 24, ./dev/run -n1\r\n\r\nBenchmark script: https://gist.github.com/nickva/c0cbf6a556cc2dc7dd6ee79f504f5f84.\r\n  -  20 concurrent workers create a db and:\r\n     * Insert 100 docs, 10 ddoc(views) and query the views\r\n     * Repeat that 3 times in a row\r\n     \r\nResults measured by the zsh `time` command  as `% time ./stampede_dbs_ddocs_vdus.py ...`. CPU usage is reported for the client not the couchjs process or Erlang VM. Some example of resource usage is provided below as btop screenshots.\r\n     \r\n**QuickJS**\r\n\r\n```\r\n./stampede_dbs_ddocs_vdus.py -x 10 -n 100 -w 20 -t 3  1.10s user 0.22s system 7% cpu 18.754 total\r\n./stampede_dbs_ddocs_vdus.py -x 10 -n 100 -w 20 -t 3  1.05s user 0.21s system 6% cpu 18.438 total\r\n./stampede_dbs_ddocs_vdus.py -x 10 -n 100 -w 20 -t 3  1.06s user 0.21s system 6% cpu 18.591 total\r\n./stampede_dbs_ddocs_vdus.py -x 10 -n 100 -w 20 -t 3  1.06s user 0.20s system 6% cpu 18.279 total\r\n./stampede_dbs_ddocs_vdus.py -x 10 -n 100 -w 20 -t 3  1.09s user 0.22s system 6% cpu 18.822 total\r\n```\r\n\r\nMemory usage 5MB-7MB RSS per couchjs process (based on btop output)\r\n\r\n**Spidermonkey 1.8.5**\r\n\r\n```\r\n./stampede_dbs_ddocs_vdus.py -x 10 -n 100 -w 20 -t 3  1.33s user 0.25s system 2% cpu 1:06.80 total\r\n./stampede_dbs_ddocs_vdus.py -x 10 -n 100 -w 20 -t 3  1.31s user 0.24s system 2% cpu 1:05.80 total\r\n./stampede_dbs_ddocs_vdus.py -x 10 -n 100 -w 20 -t 3  1.32s user 0.24s system 2% cpu 1:04.34 total\r\n./stampede_dbs_ddocs_vdus.py -x 10 -n 100 -w 20 -t 3  1.31s user 0.23s system 2% cpu 1:03.00 total\r\n./stampede_dbs_ddocs_vdus.py -x 10 -n 100 -w 20 -t 3  1.34s user 0.25s system 2% cpu 1:13.93 total\r\n```\r\n\r\n**Spidermonkey 91**\r\n\r\n```\r\n./stampede_dbs_ddocs_vdus.py -x 10 -n 100 -w 20 -t 3  1.11s user 0.21s system 1% cpu 1:31.13 total\r\n./stampede_dbs_ddocs_vdus.py -x 10 -n 100 -w 20 -t 3  1.09s user 0.20s system 1% cpu 1:24.22 total\r\n./stampede_dbs_ddocs_vdus.py -x 10 -n 100 -w 20 -t 3  1.10s user 0.21s system 1% cpu 1:35.53 total\r\n./stampede_dbs_ddocs_vdus.py -x 10 -n 100 -w 20 -t 3  1.06s user 0.20s system 1% cpu 1:20.57 total\r\n./stampede_dbs_ddocs_vdus.py -x 10 -n 100 -w 20 -t 3  1.07s user 0.20s system 1% cpu 1:22.06 total\r\n```\r\n\r\nMemory usage 30-32MB RSS per couchjs process (based on btop output)\r\n\r\n\r\nRuntime metrics capture (also quick and dirty courtesy of btop):\r\n\r\n<img width=\"1052\" alt=\"file1\" src=\"https://github.com/apache/couchdb/assets/211822/aad22ad0-3e96-4aa8-a840-aa8e44288a16\">\r\n<img width=\"1059\" alt=\"file2\" src=\"https://github.com/apache/couchdb/assets/211822/e9736666-5fee-4ade-b8bb-e8c1f22969b5\">\r\n\r\nThe CPU usage graph is quite telling I think.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1562079877/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1562204329","html_url":"https://github.com/apache/couchdb/issues/1422#issuecomment-1562204329","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1422","id":1562204329,"node_id":"IC_kwDOAAMmUc5dHVip","user":{"login":"xrobau","id":457798,"node_id":"MDQ6VXNlcjQ1Nzc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/457798?v=4","gravatar_id":"","url":"https://api.github.com/users/xrobau","html_url":"https://github.com/xrobau","followers_url":"https://api.github.com/users/xrobau/followers","following_url":"https://api.github.com/users/xrobau/following{/other_user}","gists_url":"https://api.github.com/users/xrobau/gists{/gist_id}","starred_url":"https://api.github.com/users/xrobau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xrobau/subscriptions","organizations_url":"https://api.github.com/users/xrobau/orgs","repos_url":"https://api.github.com/users/xrobau/repos","events_url":"https://api.github.com/users/xrobau/events{/privacy}","received_events_url":"https://api.github.com/users/xrobau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-25T03:27:03Z","updated_at":"2023-05-25T03:27:03Z","author_association":"CONTRIBUTOR","body":"## Minor update, 2 years later\r\n\r\nFor those that are chasing issues with this no longer returning 0 in 3.3.0 and higher, and as this issue is high in the google search results, this changed from 'always return zero' to returning the correct utime [in 3.3.0](https://docs.couchdb.org/en/stable/whatsnew/3.3.html), specifically in PR #3901 - however, as far as I'm aware the advice above is still correct - this is only used for replication and should not be consumed by anything external.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1562204329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1562226626","html_url":"https://github.com/apache/couchdb/issues/4621#issuecomment-1562226626","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4621","id":1562226626,"node_id":"IC_kwDOAAMmUc5dHa_C","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-25T04:00:57Z","updated_at":"2023-05-25T04:00:57Z","author_association":"CONTRIBUTOR","body":"I had tried it out locally with a toggle switching between emitting 0 or the timestamp as instance start time:\r\n\r\n```diff\r\ndiff --git a/src/fabric/src/fabric_db_info.erl b/src/fabric/src/fabric_db_info.erl\r\nindex 5461404c5..950509cb8 100644\r\n--- a/src/fabric/src/fabric_db_info.erl\r\n+++ b/src/fabric/src/fabric_db_info.erl\r\n@@ -19,7 +19,11 @@\r\n\r\n go(DbName) ->\r\n     Shards = mem3:shards(DbName),\r\n-    CreationTime = mem3:shard_creation_time(DbName),\r\n+    %CreationTime = mem3:shard_creation_time(DbName),\r\n+    CreationTime = case config:get_boolean(\"chttpd\", \"instance_start_time_zero\", false) of\r\n+        true -> <<\"0\">>;\r\n+        false -> mem3:shard_creation_time(DbName)\r\n+    end,\r\n     Workers = fabric_util:submit_jobs(Shards, get_db_info, []),\r\n     RexiMon = fabric_util:create_monitors(Shards),\r\n     Fun = fun handle_message/3,\r\n```\r\n\r\nI noticed replications crashed, with lots of logging noise, but did not reset (rewind change feeds to 0). On restart they resumed from their checkpoints and continued on from there.\r\n\r\n> This caused the replication worker to correctly assume that something had broken and refused to continue. \r\n\r\nReplication jobs will crash but they should eventually restart and continue where they left off. It's still messy and noisy so I made a PR to reduce the log noise and avoid the crash: https://github.com/apache/couchdb/pull/4623","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1562226626/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1562474853","html_url":"https://github.com/apache/couchdb/pull/3901#issuecomment-1562474853","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3901","id":1562474853,"node_id":"IC_kwDOAAMmUc5dIXll","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-25T08:11:52Z","updated_at":"2023-05-25T08:11:52Z","author_association":"MEMBER","body":"instance_start_time changing only causes the replication job to exit. When it's restarted it will look for replication checkpoint docs as usual. In this circumstance they will exist, so replication resumes from there.\r\n\r\nThe \"normal\" (i.e, couchdb 1.0) reason for instance_start_time to change is the database was closed and reopened (or, more extremely, was deleted and re-created). So it is only a mechanism to ensure replication includes everything, it's not a reset.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1562474853/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1562488098","html_url":"https://github.com/apache/couchdb/pull/4622#issuecomment-1562488098","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4622","id":1562488098,"node_id":"IC_kwDOAAMmUc5dIa0i","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-25T08:21:46Z","updated_at":"2023-05-25T08:21:46Z","author_association":"MEMBER","body":"This looks to be a great improvement on several fronts. I think we should go all in on this. maybe optional for a release or two and then fully switch? once we can assume an embedded JS engine we can boost a number of areas (like VDU's).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1562488098/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1563035167","html_url":"https://github.com/apache/couchdb/pull/3901#issuecomment-1563035167","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3901","id":1563035167,"node_id":"IC_kwDOAAMmUc5dKgYf","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-25T14:43:15Z","updated_at":"2023-05-25T14:43:15Z","author_association":"CONTRIBUTOR","body":"Agree with @rnewson and verified that it doesn't reset the replication in https://github.com/apache/couchdb/issues/4621\r\n\r\nDuring cluster upgrades from 3.2 to 3.3 it does make a bit mess in the logs so I created a PR to reduce that part. Basically to accept 0 as a valid timestamp and not crash and restart.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1563035167/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1563127467","html_url":"https://github.com/apache/couchdb/issues/4624#issuecomment-1563127467","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4624","id":1563127467,"node_id":"IC_kwDOAAMmUc5dK26r","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-25T15:43:21Z","updated_at":"2023-05-25T15:43:21Z","author_association":"CONTRIBUTOR","body":"Thanks for the detailed report @jcoglan. Would you be able to share few more logs starting a bit before the first error include a bit more after the ones showed if they have any stack function names and line numbers.\r\n\r\nDo you see anywhere in the logs the string `not in any target ranges` or `not_in_target_ranges`. That would indicate that the initial split didn't go well and during the second one we're just seeing the effects of that.\r\n\r\nIn remsh what does the `config:get(\"mem3\").` return?\r\n\r\nIf possible share the full _dbs document `curl $URL/_node/_local/_dbs/some_db` it should have shard ranges and also the change records from the first split in it.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1563127467/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1563370554","html_url":"https://github.com/apache/couchdb/pull/4623#issuecomment-1563370554","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4623","id":1563370554,"node_id":"IC_kwDOAAMmUc5dLyQ6","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-25T18:58:13Z","updated_at":"2023-05-25T18:58:13Z","author_association":"CONTRIBUTOR","body":"@big-r81 good idea, I thought it looked a bit smaller and better with shorter variables it's not a lot better. Reverted back to original names. Also added a comment indicated what is happening with the `<<\"0\">>` check there and why we're doing it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1563370554/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1563410808","html_url":"https://github.com/apache/couchdb/issues/4621#issuecomment-1563410808","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4621","id":1563410808,"node_id":"IC_kwDOAAMmUc5dL8F4","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-25T19:34:08Z","updated_at":"2023-05-25T19:34:08Z","author_association":"CONTRIBUTOR","body":"@xrobau this PR should make the job not restart on update and keep the logs a bit cleaner during that time https://github.com/apache/couchdb/pull/4623\r\n\r\nHowever if you don't mind having an extra few hundreds lines of crashes in the logs, don't have to worry about waiting for a new release. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1563410808/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1563495430","html_url":"https://github.com/apache/couchdb/issues/4624#issuecomment-1563495430","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4624","id":1563495430,"node_id":"IC_kwDOAAMmUc5dMQwG","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-25T20:55:11Z","updated_at":"2023-05-26T05:26:48Z","author_association":"CONTRIBUTOR","body":"I wonder if this happened: after the first split (to Q=16), we ran the internal replicator to top off changes from source to the targets. When doing so we also pushed purges to the new targets, however, in the internal replicator we didn't pick them by the hash function of target range, but copied them as is. So  splitting `S->T1|T2` both `T1` and `T2` might have gotten purge_info with `DocID=\"a\"`, even though the hashing would have put it only on `T1`.\r\n\r\nhttps://github.com/apache/couchdb/blob/c75c31d38c51c4b2c6c2c59103c204b2294c6895/src/mem3/src/mem3_rep.erl#L317-L344\r\n\r\nOn next split `16 -> 32` we start by doing the initial copy in https://github.com/apache/couchdb/blob/c75c31d38c51c4b2c6c2c59103c204b2294c6895/src/couch/src/couch_db_split.erl#L340-L344 and when we get to purge infos we do the right thing and pick a target according to the hash function, however we now find out that some purge infos do not belong to any of the targets. So, if `T2 -> T21|T22` is the split configuration and purge info for `DocID=\"a\"` doesn't belong to `T2` to start with we'd get that exception we got above in the issue report.\r\n\r\nTo confirm this theory, the first step would be to double-check that the actual document IDs are on the shards they are supposed to be in. That is, we'd assert that the `Q=16` document placement looks sane. Then, do the same for each purge info and here we should find that some purge infos do no belong on those shards.\r\n\r\nIf this is the cause of the issue we saw above, then we could delete the extra purge info copies on the target shards then set `[mem3] replicate_purges = false` to prevent internal replicator to replicate purges. We should then make sure the purges have been processed before shard splitting starts.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1563495430/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1564538007","html_url":"https://github.com/apache/couchdb/pull/4625#issuecomment-1564538007","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4625","id":1564538007,"node_id":"IC_kwDOAAMmUc5dQPSX","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-26T15:09:29Z","updated_at":"2023-05-26T15:09:29Z","author_association":"MEMBER","body":"I make additional requests to source and target (once each at job start time) with a custom verify_fun. I do this as it's hard to get the db/docid/user context from the real calls but also to avoid disturbing existing code for something informational.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1564538007/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1564543147","html_url":"https://github.com/apache/couchdb/pull/4625#issuecomment-1564543147","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4625","id":1564543147,"node_id":"IC_kwDOAAMmUc5dQQir","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-26T15:13:37Z","updated_at":"2023-05-26T15:13:37Z","author_association":"MEMBER","body":"needs a tweak, I was so focused on the bad cases I forgot the good ones, need to add cacertfile :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1564543147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1565262678","html_url":"https://github.com/apache/couchdb/issues/4624#issuecomment-1565262678","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4624","id":1565262678,"node_id":"IC_kwDOAAMmUc5dTANW","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-27T08:07:16Z","updated_at":"2023-05-27T08:07:16Z","author_association":"CONTRIBUTOR","body":"This PR should fix the issue https://github.com/apache/couchdb/pull/4626","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1565262678/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1565392992","html_url":"https://github.com/apache/couchdb/pull/4388#issuecomment-1565392992","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4388","id":1565392992,"node_id":"IC_kwDOAAMmUc5dTgBg","user":{"login":"OlekMazur","id":19613255,"node_id":"MDQ6VXNlcjE5NjEzMjU1","avatar_url":"https://avatars.githubusercontent.com/u/19613255?v=4","gravatar_id":"","url":"https://api.github.com/users/OlekMazur","html_url":"https://github.com/OlekMazur","followers_url":"https://api.github.com/users/OlekMazur/followers","following_url":"https://api.github.com/users/OlekMazur/following{/other_user}","gists_url":"https://api.github.com/users/OlekMazur/gists{/gist_id}","starred_url":"https://api.github.com/users/OlekMazur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OlekMazur/subscriptions","organizations_url":"https://api.github.com/users/OlekMazur/orgs","repos_url":"https://api.github.com/users/OlekMazur/repos","events_url":"https://api.github.com/users/OlekMazur/events{/privacy}","received_events_url":"https://api.github.com/users/OlekMazur/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-27T12:30:35Z","updated_at":"2023-05-27T12:30:35Z","author_association":"NONE","body":"Hi,\r\n\r\nI have a problem configuring couchdb at Fedora 38 which seems related to recon 2.5.3:\r\n```\r\nUpdating recon from {git,\"https://github.com/apache/couchdb-recon.git\",\r\n                         {tag,\"2.5.3\"}}\r\nerror: pathspec '2.5.3' did not match any file(s) known to git\r\nERROR: sh(git checkout -q 2.5.3)\r\nfailed with return code 1 and the following output:\r\nerror: pathspec '2.5.3' did not match any file(s) known to git\r\n```\r\n\r\nhttps://github.com/apache/couchdb-recon/tree/2.5.3 shows \"This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\"\r\n\r\nBut when I switched remote \"origin\" url in src/recon/.git/config from https://github.com/apache/couchdb-recon.git to https://github.com/ferd/recon.git , configure script succeeded.\r\n\r\nLooks like you can't checkout 2.5.3 out of apache/couchdb-recon.git repo (?)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1565392992/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1565487397","html_url":"https://github.com/apache/couchdb/pull/4388#issuecomment-1565487397","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4388","id":1565487397,"node_id":"IC_kwDOAAMmUc5dT3El","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-27T15:15:17Z","updated_at":"2023-05-27T15:15:17Z","author_association":"CONTRIBUTOR","body":"Hi Aleksander,\r\n\r\nI think might have forgotten to push the upstream master changes to our couchdb main clone and the changes were only on the tag. In that case the change appeared only on the tag (release), maybe that would have been the issue. I just updated couchdb main and tried making a new clone of couchdb and ran configure it seems to have correctly fetched the latest recon.\r\n\r\n```\r\nUpdating recon from {git,\"https://github.com/apache/couchdb-recon.git\",  {tag,\"2.5.3\"}}\r\n```\r\n\r\nSee if you give it another try if it would work?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1565487397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1565537151","html_url":"https://github.com/apache/couchdb/pull/4388#issuecomment-1565537151","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4388","id":1565537151,"node_id":"IC_kwDOAAMmUc5dUDN_","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-27T15:49:12Z","updated_at":"2023-05-27T15:49:12Z","author_association":"CONTRIBUTOR","body":"@nickva \r\n\r\nDidn’t we use upstream directly?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1565537151/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1565550762","html_url":"https://github.com/apache/couchdb/pull/4388#issuecomment-1565550762","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4388","id":1565550762,"node_id":"IC_kwDOAAMmUc5dUGiq","user":{"login":"OlekMazur","id":19613255,"node_id":"MDQ6VXNlcjE5NjEzMjU1","avatar_url":"https://avatars.githubusercontent.com/u/19613255?v=4","gravatar_id":"","url":"https://api.github.com/users/OlekMazur","html_url":"https://github.com/OlekMazur","followers_url":"https://api.github.com/users/OlekMazur/followers","following_url":"https://api.github.com/users/OlekMazur/following{/other_user}","gists_url":"https://api.github.com/users/OlekMazur/gists{/gist_id}","starred_url":"https://api.github.com/users/OlekMazur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OlekMazur/subscriptions","organizations_url":"https://api.github.com/users/OlekMazur/orgs","repos_url":"https://api.github.com/users/OlekMazur/repos","events_url":"https://api.github.com/users/OlekMazur/events{/privacy}","received_events_url":"https://api.github.com/users/OlekMazur/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-27T16:01:09Z","updated_at":"2023-05-27T16:01:09Z","author_association":"NONE","body":"The warning at https://github.com/apache/couchdb-recon/tree/2.5.3 I mentioned before disappeared, and after deleting src/recon the ./configure script was able to pull it automatically, so the problem is gone. Thanks.\r\n```\r\n==> couchdb (get-deps)\r\nPulling recon from {git,\"https://github.com/apache/couchdb-recon.git\",\r\n                        {tag,\"2.5.3\"}}\r\nKlonowanie do „recon”...\r\n==> recon (get-deps)\r\n==> couchdb (update-deps)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1565550762/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1565558444","html_url":"https://github.com/apache/couchdb/pull/4388#issuecomment-1565558444","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4388","id":1565558444,"node_id":"IC_kwDOAAMmUc5dUIas","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-27T16:08:16Z","updated_at":"2023-05-27T16:08:16Z","author_association":"CONTRIBUTOR","body":"@big-r81 not entirely sure, we were able to do the clone and run CI all this time (which builds a full release off of main) and we obviously ran ./configure --dev on main many times before. In some environments git may complain more if the tagged commits are also on a branch somewhere, perhaps...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1565558444/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1568431673","html_url":"https://github.com/apache/couchdb/pull/4626#issuecomment-1568431673","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4626","id":1568431673,"node_id":"IC_kwDOAAMmUc5dfF45","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-30T13:24:28Z","updated_at":"2023-05-30T13:24:28Z","author_association":"MEMBER","body":"we have deployed this on the cluster where we found the issue and are attempting a new set of shard splitting. We’ll report back!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1568431673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1568442663","html_url":"https://github.com/apache/couchdb/pull/4626#issuecomment-1568442663","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4626","id":1568442663,"node_id":"IC_kwDOAAMmUc5dfIkn","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-30T13:31:11Z","updated_at":"2023-05-30T13:31:11Z","author_association":"CONTRIBUTOR","body":"Thank you, @janl ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1568442663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1568954666","html_url":"https://github.com/apache/couchdb/pull/4626#issuecomment-1568954666","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4626","id":1568954666,"node_id":"IC_kwDOAAMmUc5dhFkq","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-30T19:20:43Z","updated_at":"2023-05-30T19:20:43Z","author_association":"MEMBER","body":"this works in practice, we got the log warnings about out of range entries but successful splitting going to 32 shards","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1568954666/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1569253706","html_url":"https://github.com/apache/couchdb/pull/4622#issuecomment-1569253706","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4622","id":1569253706,"node_id":"IC_kwDOAAMmUc5diOlK","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-30T23:09:03Z","updated_at":"2023-05-30T23:09:03Z","author_association":"CONTRIBUTOR","body":"Switching pull request to use the branch off the Apache CouchDB main since otherwise Jenkinsfile updates don't have an effect. Closing in favor of https://github.com/apache/couchdb/pull/4627","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1569253706/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1569309483","html_url":"https://github.com/apache/couchdb/pull/4627#issuecomment-1569309483","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4627","id":1569309483,"node_id":"IC_kwDOAAMmUc5dicMr","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-31T00:14:36Z","updated_at":"2023-05-31T00:14:36Z","author_association":"CONTRIBUTOR","body":"<img width=\"778\" alt=\"Screen Shot 2023-05-30 at 8 13 16 PM\" src=\"https://github.com/apache/couchdb/assets/211822/2eedb2f9-e49f-4536-984a-ff1e93607294\">\r\n\r\nAdded QuickJS CI job variants which test each Erlang version alongside Spidermonkey. All have nouveau enabled as well.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1569309483/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1570156769","html_url":"https://github.com/apache/couchdb/pull/4628#issuecomment-1570156769","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4628","id":1570156769,"node_id":"IC_kwDOAAMmUc5dlrDh","user":{"login":"ecerulm","id":58676,"node_id":"MDQ6VXNlcjU4Njc2","avatar_url":"https://avatars.githubusercontent.com/u/58676?v=4","gravatar_id":"","url":"https://api.github.com/users/ecerulm","html_url":"https://github.com/ecerulm","followers_url":"https://api.github.com/users/ecerulm/followers","following_url":"https://api.github.com/users/ecerulm/following{/other_user}","gists_url":"https://api.github.com/users/ecerulm/gists{/gist_id}","starred_url":"https://api.github.com/users/ecerulm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ecerulm/subscriptions","organizations_url":"https://api.github.com/users/ecerulm/orgs","repos_url":"https://api.github.com/users/ecerulm/repos","events_url":"https://api.github.com/users/ecerulm/events{/privacy}","received_events_url":"https://api.github.com/users/ecerulm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-31T12:37:32Z","updated_at":"2023-05-31T12:41:11Z","author_association":"CONTRIBUTOR","body":"Since  apparently both PUT and POST work , should both be mentioned in the [1.5.14](https://docs.couchdb.com/en/latest/api/ddoc/render.html#db-design-ddoc-update-func-docid)?  Maybe indicating which one is preferred over the other (if any). [User Guides > Design Documents > 3.1.5 Update Functions](https://docs.couchdb.org/en/stable/ddocs/ddocs.html#update-functions) hint that both `POST` and `PUT` are supported when it says: \r\n\r\n> You can provide any other values needed by the update handler function via the POST/PUT entity body or query string parameters of the request. \r\n\r\nBut it both are supported I guess both should be explicitly mentioned at [1.5.14](https://docs.couchdb.com/en/latest/api/ddoc/render.html#db-design-ddoc-update-func-docid). \r\n\r\n ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1570156769/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1570534987","html_url":"https://github.com/apache/couchdb/pull/4627#issuecomment-1570534987","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4627","id":1570534987,"node_id":"IC_kwDOAAMmUc5dnHZL","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-31T16:18:13Z","updated_at":"2023-05-31T16:18:13Z","author_association":"MEMBER","body":"looks really good. what would a NIF look like? I mentioned elsewhere that [rustler](https://github.com/rusterlium/rustler) would be a nice way to do that safely. I think you said 100% NIF is conditional on dropping _list/_show support?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1570534987/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1570576011","html_url":"https://github.com/apache/couchdb/pull/4627#issuecomment-1570576011","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4627","id":1570576011,"node_id":"IC_kwDOAAMmUc5dnRaL","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-31T16:48:44Z","updated_at":"2023-05-31T16:48:44Z","author_association":"CONTRIBUTOR","body":"A NIF would be easier to do if we didn't have the getRow/sendRow sub-protocol for list/show, where we have to call back into Erlang, wait for a row, then return back to Javascript. As a driver it's just simpler to do with print and readline.\r\n\r\nEven then, it might still make sense to retain external driver vs NIF duality, as it is possible to apply more restrictive isolation policies (seccomp, apparmor, selinux, etc) to the OS process. With all the `main.js` compiled in as bytecode to a C array, the OS process can even be blocked from opening files: it only gets to talk to outside via standard-in/out file descriptors it received on startup. That would be one of the tradeoffs - more isolation but lower speed.\r\n\r\nRustler might improve the situation if there was a Rust-only JS engine which doesn't wrap a C or C++ one. Then, we could have a NIF and feel like we're not making as much of a safety vs speed tradeoff.  I've been keeping an eye on https://github.com/Starlight-JS/Starlight and https://github.com/boa-dev/boa. Boa one looks more promising.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1570576011/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1570605716","html_url":"https://github.com/apache/couchdb/pull/4628#issuecomment-1570605716","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4628","id":1570605716,"node_id":"IC_kwDOAAMmUc5dnYqU","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-31T17:10:15Z","updated_at":"2023-05-31T17:10:15Z","author_association":"CONTRIBUTOR","body":"@ecerulm thank you for your contribution. I think in the example PUT would make more sense since we have a document ID passed in. But you're also right that it seems POST is allowed. The updater handler gets a request object and method is part of so it can choose what to do with it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1570605716/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1570635767","html_url":"https://github.com/apache/couchdb/pull/4627#issuecomment-1570635767","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4627","id":1570635767,"node_id":"IC_kwDOAAMmUc5dnf_3","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-31T17:34:14Z","updated_at":"2023-05-31T17:34:14Z","author_association":"MEMBER","body":"fair enough.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1570635767/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1570723680","html_url":"https://github.com/apache/couchdb/pull/4628#issuecomment-1570723680","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4628","id":1570723680,"node_id":"IC_kwDOAAMmUc5dn1dg","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-31T18:36:54Z","updated_at":"2023-05-31T18:36:54Z","author_association":"CONTRIBUTOR","body":"@nickva should we only allow PUT like in #4449?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1570723680/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1570801221","html_url":"https://github.com/apache/couchdb/pull/4628#issuecomment-1570801221","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4628","id":1570801221,"node_id":"IC_kwDOAAMmUc5doIZF","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-31T19:21:07Z","updated_at":"2023-05-31T19:21:59Z","author_association":"CONTRIBUTOR","body":"I was wondering about it too, @big-r81. I think it may be a compatibility issue if someone was POST.\r\n\r\nIt seems in general it's a free-for-all kind of an endpoint the _update handler js code gets to decide what to do by inspecting the `method`. So users may come in with a POST and a doc_id and then the _update handler may decide to do something different than if they issued a PUT request?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1570801221/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1570805507","html_url":"https://github.com/apache/couchdb/pull/4628#issuecomment-1570805507","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4628","id":1570805507,"node_id":"IC_kwDOAAMmUc5doJcD","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-31T19:22:53Z","updated_at":"2023-05-31T19:22:53Z","author_association":"CONTRIBUTOR","body":"But perhaps we should document the behavior of if we change it, deprecate it make so gated with a feature so it won't break current 3.x users.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1570805507/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1571420310","html_url":"https://github.com/apache/couchdb/pull/4628#issuecomment-1571420310","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4628","id":1571420310,"node_id":"IC_kwDOAAMmUc5dqfiW","user":{"login":"ecerulm","id":58676,"node_id":"MDQ6VXNlcjU4Njc2","avatar_url":"https://avatars.githubusercontent.com/u/58676?v=4","gravatar_id":"","url":"https://api.github.com/users/ecerulm","html_url":"https://github.com/ecerulm","followers_url":"https://api.github.com/users/ecerulm/followers","following_url":"https://api.github.com/users/ecerulm/following{/other_user}","gists_url":"https://api.github.com/users/ecerulm/gists{/gist_id}","starred_url":"https://api.github.com/users/ecerulm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ecerulm/subscriptions","organizations_url":"https://api.github.com/users/ecerulm/orgs","repos_url":"https://api.github.com/users/ecerulm/repos","events_url":"https://api.github.com/users/ecerulm/events{/privacy}","received_events_url":"https://api.github.com/users/ecerulm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-01T06:15:42Z","updated_at":"2023-06-01T06:15:42Z","author_association":"CONTRIBUTOR","body":"Since this PR is closed, I created a https://github.com/apache/couchdb/issues/4631 asking for a documentation change to document the `POST /{db}/_design/{ddoc}/_update/{func}/{docid}`.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1571420310/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1571432062","html_url":"https://github.com/apache/couchdb/pull/4628#issuecomment-1571432062","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4628","id":1571432062,"node_id":"IC_kwDOAAMmUc5dqiZ-","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-01T06:26:48Z","updated_at":"2023-06-01T06:26:48Z","author_association":"CONTRIBUTOR","body":"Thank you, @ecerulm ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1571432062/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1576372399","html_url":"https://github.com/apache/couchdb/issues/4369#issuecomment-1576372399","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4369","id":1576372399,"node_id":"IC_kwDOAAMmUc5d9Yiv","user":{"login":"viveksc1994","id":10026278,"node_id":"MDQ6VXNlcjEwMDI2Mjc4","avatar_url":"https://avatars.githubusercontent.com/u/10026278?v=4","gravatar_id":"","url":"https://api.github.com/users/viveksc1994","html_url":"https://github.com/viveksc1994","followers_url":"https://api.github.com/users/viveksc1994/followers","following_url":"https://api.github.com/users/viveksc1994/following{/other_user}","gists_url":"https://api.github.com/users/viveksc1994/gists{/gist_id}","starred_url":"https://api.github.com/users/viveksc1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viveksc1994/subscriptions","organizations_url":"https://api.github.com/users/viveksc1994/orgs","repos_url":"https://api.github.com/users/viveksc1994/repos","events_url":"https://api.github.com/users/viveksc1994/events{/privacy}","received_events_url":"https://api.github.com/users/viveksc1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-05T08:39:57Z","updated_at":"2023-06-05T08:46:40Z","author_association":"NONE","body":"Also, facing the issue with v3.3.2\r\n\r\nHere is my setup in Couchdb\r\n```\r\n[dreyfus]\r\nname = clouseau@127.0.0.1\r\nlimit = 25\r\nlimit_partitions = 2000\r\nmax_limit = 1000\r\nmax_limit_partitions = 2000\r\nretry_limit = 5\r\n```\r\n\r\nClouseau service is running\r\n![image](https://github.com/apache/couchdb/assets/10026278/32389e29-ac51-4d6b-a281-96ed054825c2)\r\n\r\nNot showing feature - 'search' \r\n![image](https://github.com/apache/couchdb/assets/10026278/a0b2451a-89b1-4a7c-bfbc-6c8f0f6e44dc)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1576372399/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]