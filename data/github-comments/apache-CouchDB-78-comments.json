[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/558380252","html_url":"https://github.com/apache/couchdb/pull/2331#issuecomment-558380252","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2331","id":558380252,"node_id":"MDEyOklzc3VlQ29tbWVudDU1ODM4MDI1Mg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-25T23:03:17Z","updated_at":"2019-11-25T23:03:17Z","author_association":"CONTRIBUTOR","body":"@jaydoane nice works, small and easy to understand!\r\n\r\nMade a few comments in-line. \r\n\r\nWas also wondering if you thought about building it more as a library, such that it would plug into to another application's supervisor with something like:\r\n\r\n```\r\ncouch_expiring_cache:start_link(Name, Options) when is_atom(Name) ->\r\n    gen_server:start_link({local, Name}, ...) -> ets:new(Name, [named_table, ...]).\r\n```\r\n\r\nThen we wouldn't need a way to disable or enable the whole application and it would be started only as needed. What do you think? If you'd rather keep it as is, that'll work just. Just thought to explore another option.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/558380252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/558660909","html_url":"https://github.com/apache/couchdb/pull/2333#issuecomment-558660909","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2333","id":558660909,"node_id":"MDEyOklzc3VlQ29tbWVudDU1ODY2MDkwOQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-26T14:43:42Z","updated_at":"2019-11-26T14:43:42Z","author_association":"CONTRIBUTOR","body":"```\r\nPartitionCrudTest\r\n  * test GET to partition returns 400 (196.1ms)\r\n```\r\n\r\nWithout the fix fails as expected:\r\n\r\n```\r\nPartitionCrudTest\r\n  * test GET to partition returns 400 (201.5ms)\r\n\r\n  1) test GET to partition returns 400 (PartitionCrudTest)\r\n     test/elixir/test/partition_crud_test.exs:98\r\n     Assertion with == failed\r\n     code:  assert resp.status_code() == 400\r\n     left:  404\r\n     right: 400\r\n     stacktrace:\r\n       test/elixir/test/partition_crud_test.exs:103: (test)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/558660909/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/559111218","html_url":"https://github.com/apache/couchdb/issues/1875#issuecomment-559111218","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1875","id":559111218,"node_id":"MDEyOklzc3VlQ29tbWVudDU1OTExMTIxOA==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-27T14:31:22Z","updated_at":"2019-11-27T14:31:22Z","author_association":"CONTRIBUTOR","body":"I want to give some update before thanksgiving day about this ticket. Recently, I used a lot of time to work for window platform. Every time I am almost about to send to email to community to get support, I got some progress. I plan to still take two days to try the last approach, and then decide how to proceed for windows platform.\r\n- a. using guide in https://developer.mozilla.org/en-US/docs/Mozilla/Projects/SpiderMonkey/Build_Documentation, spidermonkey 60 can be built, but the default is 32 bit. 32 bit library is not for 64bit couchjs. I will get link issue.\r\n- b. same as approach a, I used `../configure --host=x86_64-pc-mingw32 --target=x86_64-pc-mingw32 --enable-debug` to setup 64bit environment.  There is error when comping js/src/Unified_cpp_js_src19.cpp.\r\n```\r\nUnified_cpp_js_src19.cpp\r\nC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\shared\\stralign.h(120): warning C4090: 'argument': different '__unaligned' qualifiers\r\nc:/mozjs/mozjs-60.1.1pre3/js/src/jit/ProcessExecutableMemory.cpp(65): fatal error C1189: #error:  \"Unsupported architecture\"\r\nmozmake[3]: *** [c:/mozjs/mozjs-60.1.1pre3/config/rules.mk:1049: Unified_cpp_js_src19.obj] Error 2\r\n```\r\n- c. later on, I found one repository https://github.com/mozilla/gecko-dev. I made it work and compile `mozjs-72a1.lib`. When compiling couchjs using this library, we can pass compile, and there is 64bit-32bit issue when linking them together. Because there are interface change, it is not surprise that I got some `undefined symbols` error.\r\n- d. this week, I found another repository https://github.com/servo/mozjs. I made it almost work and my thought is that it can build spidermonkey version6x with 64bit. The error I got in case b was resolved. Most of files can be compiled today. I am working on `Cannot open include file corecrt.h` error.  \r\n\r\nI found that `configure --disable-jemalloc --disable-js-shell --disable-tests --disable-shared-js --build-backends=RecursiveMake --enable-posix-nspr-emulati\r\non --with-visual-studio-version=2017 --enable-debug --disable-optimize --enable-gczeal --target=x86_64-pc-mingw32 --host=x86_64-pc-mingw32` was used in approach d, this can be used for approach b.\r\n\r\nSo let me check whether I can get around using approach d and enhanced approach b in coming days. \r\ncc @denib @janl @davisp @kocolosk @wohali ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/559111218/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/559548559","html_url":"https://github.com/apache/couchdb/issues/1600#issuecomment-559548559","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1600","id":559548559,"node_id":"MDEyOklzc3VlQ29tbWVudDU1OTU0ODU1OQ==","user":{"login":"olivenvrac","id":31409996,"node_id":"MDQ6VXNlcjMxNDA5OTk2","avatar_url":"https://avatars.githubusercontent.com/u/31409996?v=4","gravatar_id":"","url":"https://api.github.com/users/olivenvrac","html_url":"https://github.com/olivenvrac","followers_url":"https://api.github.com/users/olivenvrac/followers","following_url":"https://api.github.com/users/olivenvrac/following{/other_user}","gists_url":"https://api.github.com/users/olivenvrac/gists{/gist_id}","starred_url":"https://api.github.com/users/olivenvrac/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/olivenvrac/subscriptions","organizations_url":"https://api.github.com/users/olivenvrac/orgs","repos_url":"https://api.github.com/users/olivenvrac/repos","events_url":"https://api.github.com/users/olivenvrac/events{/privacy}","received_events_url":"https://api.github.com/users/olivenvrac/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-28T16:12:43Z","updated_at":"2019-11-28T16:12:43Z","author_association":"NONE","body":"hello\r\nI'v got the same issue on a CouchDB single node with 3 VCPU Intel(R) Xeon(R) CPU E7- 4830  @ 2.13GHz and 4 Go ram\r\ncouchdb \"2.3.0\"\r\nRed Hat Enterprise Linux Server release 7.2 (Maipo)\r\n\r\nWe have an mobile application with 150 users wich use CouchDB and embed a PouchDB database with http synchronisation in longpulling mode with the couchdb instance\r\nThere is approximatively 100 simultanous synchronisation with the cookies authentification. \r\ndata reside on a disk cached by a sanshare connection with a lot of cache memory \r\n\r\nerrors :\r\n[<<\"chttpd:catch_error/3 L356\">>,<<\"chttpd:handle_req_after_auth/2 L322\">>,<<\"chttpd:process_request/1 L303\">>,<<\"chttpd:handle_request_int/1 L243\">>,<<\"mochiweb_http:headers/6 L128\">>,<<\"proc_lib:init_p_do_apply/3 L247\">>]\r\n[<<\"chttpd:catch_error/3 L356\">>,<<\"chttpd:handle_req_after_auth/2 L322\">>,<<\"chttpd:process_request/1 L303\">>,<<\"chttpd:handle_request_int/1 L243\">>,<<\"mochiweb_http:headers/6 L128\">>,<<\"proc_lib:init_p_do_apply/3 L247\">>]\r\n[<<\"chttpd:catch_error/3 L356\">>,<<\"chttpd:handle_req_after_auth/2 L322\">>,<<\"chttpd:process_request/1 L303\">>,<<\"chttpd:handle_request_int/1 L243\">>,<<\"mochiweb_http:headers/6 L128\">>,<<\"proc_lib:init_p_do_apply/3 L247\">>]\r\n[<<\"chttpd:catch_error/3 L356\">>,<<\"chttpd:handle_req_after_auth/2 L322\">>,<<\"chttpd:process_request/1 L303\">>,<<\"chttpd:handle_request_int/1 L243\">>,<<\"mochiweb_http:headers/6 L128\">>,<<\"proc_lib:init_p_do_apply/3 L247\">>]\r\n[<<\"chttpd:catch_error/3 L356\">>,<<\"chttpd:handle_req_after_auth/2 L322\">>,<<\"chttpd:process_request/1 L303\">>,<<\"chttpd:handle_request_int/1 L243\">>,<<\"mochiweb_http:headers/6 L128\">>,<<\"proc_lib:init_p_do_apply/3 L247\">>]\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/559548559/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/559850759","html_url":"https://github.com/apache/couchdb/issues/2334#issuecomment-559850759","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2334","id":559850759,"node_id":"MDEyOklzc3VlQ29tbWVudDU1OTg1MDc1OQ==","user":{"login":"pavellzubkov","id":18612709,"node_id":"MDQ6VXNlcjE4NjEyNzA5","avatar_url":"https://avatars.githubusercontent.com/u/18612709?v=4","gravatar_id":"","url":"https://api.github.com/users/pavellzubkov","html_url":"https://github.com/pavellzubkov","followers_url":"https://api.github.com/users/pavellzubkov/followers","following_url":"https://api.github.com/users/pavellzubkov/following{/other_user}","gists_url":"https://api.github.com/users/pavellzubkov/gists{/gist_id}","starred_url":"https://api.github.com/users/pavellzubkov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavellzubkov/subscriptions","organizations_url":"https://api.github.com/users/pavellzubkov/orgs","repos_url":"https://api.github.com/users/pavellzubkov/repos","events_url":"https://api.github.com/users/pavellzubkov/events{/privacy}","received_events_url":"https://api.github.com/users/pavellzubkov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-29T17:27:19Z","updated_at":"2019-11-29T17:27:19Z","author_association":"NONE","body":"may be couchdb server on rpi + nodejs on rpi + nano library? nodejs app store data to couchdb then couchdb replicate to main server when network is available.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/559850759/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/560049205","html_url":"https://github.com/apache/couchdb/issues/1875#issuecomment-560049205","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1875","id":560049205,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MDA0OTIwNQ==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-01T03:41:59Z","updated_at":"2019-12-01T03:41:59Z","author_association":"CONTRIBUTOR","body":"I built out spidermonkey 60 64bit for windows now. It is using enhanced approach b. The problem mentioned in above approach d was resolved. However, it will not build `mozjs-60.lib`.\r\n\r\nI wrote up one guide in PR https://github.com/apache/couchdb-glazier/pull/11\r\n\r\n@denib @janl @davisp @kocolosk @wohali","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/560049205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/560257594","html_url":"https://github.com/apache/couchdb/pull/2331#issuecomment-560257594","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2331","id":560257594,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MDI1NzU5NA==","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-02T06:49:04Z","updated_at":"2019-12-02T06:49:04Z","author_association":"CONTRIBUTOR","body":"> Was also wondering if you thought about building it more as a library, such that it would plug into to another application's supervisor something like:\r\n```\r\ncouch_expiring_cache:start_link(Name, Options) when is_atom(Name) ->\r\n    gen_server:start_link({local, Name}, ...) -> ets:new(Name, [named_table, ...]).\r\n```\r\n@nickva this is an interesting idea, and I hadn't considered adding the cache to an existing supervisor tree, as your snippet seems to imply. I'm guessing that `Options` could be a map containing optional overrides for period, jitter, and batch size. I think this would also imply a subtle change to the data model, where each `Name` gets its own gen_server on each node, and\r\n```\r\n(?EXPIRING_CACHE, ?EXP, ExpiresTS, Name, Key) := ()\r\nwould become\r\n(?EXPIRING_CACHE, ?EXP, Name, ExpiresTS, Key) := ()\r\n```\r\nThe main drawback I could think of with such an approach is that unexpired entries of abandoned/changed `Name`s. would never be cleared without some explicit garbage collection mechanism. Alternately, it could use a system like `couch_jobs`, and explicitly manage names, but that adds complexity.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/560257594/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/560345959","html_url":"https://github.com/apache/couchdb/issues/2188#issuecomment-560345959","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2188","id":560345959,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MDM0NTk1OQ==","user":{"login":"Kenzku","id":1387249,"node_id":"MDQ6VXNlcjEzODcyNDk=","avatar_url":"https://avatars.githubusercontent.com/u/1387249?v=4","gravatar_id":"","url":"https://api.github.com/users/Kenzku","html_url":"https://github.com/Kenzku","followers_url":"https://api.github.com/users/Kenzku/followers","following_url":"https://api.github.com/users/Kenzku/following{/other_user}","gists_url":"https://api.github.com/users/Kenzku/gists{/gist_id}","starred_url":"https://api.github.com/users/Kenzku/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kenzku/subscriptions","organizations_url":"https://api.github.com/users/Kenzku/orgs","repos_url":"https://api.github.com/users/Kenzku/repos","events_url":"https://api.github.com/users/Kenzku/events{/privacy}","received_events_url":"https://api.github.com/users/Kenzku/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-02T11:00:00Z","updated_at":"2019-12-02T11:00:00Z","author_association":"NONE","body":"@iilyak \r\n\r\n> I am not sure it is a good idea to allow equal signs\r\n\r\nI have some enterprise customers coming back and asking why `=` sign or some special characters are not allow in the encoded/unencoded values","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/560345959/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/560362182","html_url":"https://github.com/apache/couchdb/pull/2338#issuecomment-560362182","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2338","id":560362182,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MDM2MjE4Mg==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-02T11:47:06Z","updated_at":"2019-12-02T11:47:06Z","author_association":"MEMBER","body":"This change would break backwards compatibility for a cleaner API (no query params from now on for POST). Do you think that would be acceptable? If no, can you suggest me a way to have it backwards compatible?\r\n\r\nThis was my attempt at backwards compatibility (that did not work and does not look very elegant):\r\n```\r\nmrargs_to_list(Rec) ->\r\n        Fields = record_info(fields, mrargs),\r\n        [_Tag| Values] = tuple_to_list(Rec),\r\n        lists:zip(Fields, Values).\r\n\r\nlist_to_mrargs(Inlist) ->\r\n    Fields = record_info(fields, mrargs),\r\n    [Tag| Values] = tuple_to_list(#mrargs{}),\r\n    Defaults = lists:zip(Fields, Values),\r\n    L = lists:map(fun ({K,V}) -> proplists:get_value(K, Inlist, V) end, Defaults),\r\n    list_to_tuple([Tag|L]).\r\n\r\n\r\ndesign_doc_post_view(Req, Props, Db, DDoc, ViewName, Keys) ->\r\n    QueryArgs = couch_mrview_http:parse_params(Req, Keys),\r\n    BodyList = couch_mrview_http:parse_body(Props, Keys),\r\n%%    Args = list_to_mrargs(\r\n%%        lists:keymerge(1,\r\n%%            lists:sort(mrargs_to_list(QueryArgs)),\r\n%%            lists:sort(mrargs_to_list(BodyList))\r\n%%        )\r\n%%    ),\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/560362182/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/560362357","html_url":"https://github.com/apache/couchdb/pull/2338#issuecomment-560362357","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2338","id":560362357,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MDM2MjM1Nw==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-02T11:47:35Z","updated_at":"2019-12-02T11:47:35Z","author_association":"MEMBER","body":"Once the production part is in a somewhat acceptable state, I’ll proceed with writing tests and the doc changes.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/560362357/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/560447220","html_url":"https://github.com/apache/couchdb/pull/2338#issuecomment-560447220","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2338","id":560447220,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MDQ0NzIyMA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-02T15:32:44Z","updated_at":"2019-12-02T15:32:44Z","author_association":"MEMBER","body":"@bessbd Thanks for the PR! The general idea here is fine but its not going to be acceptable to drop the query string parameters. Reading through this I think the best approach would be to add an option in `couch_mrview_http:parse_params/4` that disables reseting the group/group_level properties in the provided `#mrargs{}` record and then you'd just call that function twice. First for the body then the query string parameters (so that query string parameters override the body to maintain the current behavior).\r\n\r\nLet me know if you need any pointers on that approach or find any issues with it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/560447220/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/560449984","html_url":"https://github.com/apache/couchdb/pull/2338#issuecomment-560449984","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2338","id":560449984,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MDQ0OTk4NA==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-02T15:39:10Z","updated_at":"2019-12-02T15:39:10Z","author_association":"MEMBER","body":"> @bessbd Thanks for the PR! The general idea here is fine but its not going to be acceptable to drop the query string parameters. Reading through this I think the best approach would be to add an option in `couch_mrview_http:parse_params/4` that disables reseting the group/group_level properties in the provided `#mrargs{}` record and then you'd just call that function twice. First for the body then the query string parameters (so that query string parameters override the body to maintain the current behavior).\r\n> \r\n> Let me know if you need any pointers on that approach or find any issues with it.\r\n\r\nThank you for the review and the suggestion, @davisp ! I think I'll have a commit pushed for that in about 24 hours.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/560449984/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/560528012","html_url":"https://github.com/apache/couchdb/issues/2334#issuecomment-560528012","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2334","id":560528012,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MDUyODAxMg==","user":{"login":"natcohen","id":7813574,"node_id":"MDQ6VXNlcjc4MTM1NzQ=","avatar_url":"https://avatars.githubusercontent.com/u/7813574?v=4","gravatar_id":"","url":"https://api.github.com/users/natcohen","html_url":"https://github.com/natcohen","followers_url":"https://api.github.com/users/natcohen/followers","following_url":"https://api.github.com/users/natcohen/following{/other_user}","gists_url":"https://api.github.com/users/natcohen/gists{/gist_id}","starred_url":"https://api.github.com/users/natcohen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/natcohen/subscriptions","organizations_url":"https://api.github.com/users/natcohen/orgs","repos_url":"https://api.github.com/users/natcohen/repos","events_url":"https://api.github.com/users/natcohen/events{/privacy}","received_events_url":"https://api.github.com/users/natcohen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-02T18:47:06Z","updated_at":"2019-12-02T18:47:06Z","author_association":"NONE","body":"@aaamitsingh Post your questions on stackoverflow, this is used to track bugs!\r\n\r\nTo answer your question, PouchDB can be used on the server using Node.js","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/560528012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561156912","html_url":"https://github.com/apache/couchdb/pull/2170#issuecomment-561156912","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2170","id":561156912,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MTE1NjkxMg==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-03T13:01:36Z","updated_at":"2019-12-03T13:01:36Z","author_association":"CONTRIBUTOR","body":"Thanks Paul @davisp for your comments. It is really pleasure to move forward.\r\n\r\nI believe that it is great idea to introduce switch option to select between 1.8.5 and 6.0. I vote still to leave support of 1.8.5 for some time, especially considering there are multiple variants in windows platform to support. Thanks for your branch https://github.com/apache/couchdb/compare/sm60-davisp?expand=1. I added two additional commits today to introduce javascript for spidermonkey 60 support.\r\n\r\nAlso, I took some time to address the issue of the require() functionality and object sealing. Now we don’t need to comment out any lines for them.\r\n\r\ncc @janl ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561156912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561319731","html_url":"https://github.com/apache/couchdb/pull/2338#issuecomment-561319731","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2338","id":561319731,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MTMxOTczMQ==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-03T19:27:54Z","updated_at":"2019-12-03T19:27:54Z","author_association":"MEMBER","body":"Thank you for the review, @davisp ! I'll push the commits for those changes you've requested soon.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561319731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561319860","html_url":"https://github.com/apache/couchdb/pull/2338#issuecomment-561319860","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2338","id":561319860,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MTMxOTg2MA==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-03T19:28:15Z","updated_at":"2019-12-03T19:28:15Z","author_association":"MEMBER","body":"Doc PR: https://github.com/apache/couchdb-documentation/pull/459","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561319860/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561321176","html_url":"https://github.com/apache/couchdb/pull/2324#issuecomment-561321176","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2324","id":561321176,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MTMyMTE3Ng==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-03T19:31:42Z","updated_at":"2019-12-03T19:31:42Z","author_association":"MEMBER","body":"@kocolosk @davisp Thank you for the reviews! I've added details to upgrade logs and fixed a small upgrade bug, added a commit right after upgrade to make sure we have new sig in header on disk. Will to merge once travis allows and then add a note to upgrade docs on views 1.x incompatibility.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561321176/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561392005","html_url":"https://github.com/apache/couchdb/issues/2191#issuecomment-561392005","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2191","id":561392005,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MTM5MjAwNQ==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-03T22:46:26Z","updated_at":"2019-12-03T22:46:58Z","author_association":"MEMBER","body":"on `admin_only`, the fun one is the `_users` db. Users can currently update their own user doc, and we assert this in tests. In my PR (above), I'm updating tests to match the new default, but this one seems non-obvious to me. Do we want to require that all writes to `_users` must be with admin creds or do we want to continue with the unique property of per-doc authorization?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561392005/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561549705","html_url":"https://github.com/apache/couchdb/pull/2338#issuecomment-561549705","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2338","id":561549705,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MTU0OTcwNQ==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-04T09:19:27Z","updated_at":"2019-12-04T09:19:27Z","author_association":"MEMBER","body":"@davisp : I think I've addressed all review comments on this change. Can you please do a next / final pass?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561549705/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561613745","html_url":"https://github.com/apache/couchdb/pull/2336#issuecomment-561613745","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2336","id":561613745,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MTYxMzc0NQ==","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-04T12:00:41Z","updated_at":"2019-12-04T12:00:41Z","author_association":"MEMBER","body":"Thinking ahead to the 3.x release, Is there any documentation update needed to go with this? \r\n\r\nIt looks as though there is a new option under `httpd.enabled` - does that mean it's now possible to disable HTTP and enable HTTPS only?\r\n\r\nAre we still maintaining the distinct `[chttpd]` and `[httpd]` config sections? Perhaps there's an opportunity to sanitize those for 3.x as the split seems a bit redundant if 5986 is gone.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561613745/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561807326","html_url":"https://github.com/apache/couchdb/pull/2336#issuecomment-561807326","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2336","id":561807326,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MTgwNzMyNg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-04T19:41:09Z","updated_at":"2019-12-04T19:41:09Z","author_association":"MEMBER","body":"@rnewson @willholley we need to remove `couchup` and the documentation for it per #2324 and this PR, unless `couchup` can be rewritten to work with the new `_node` interface soon enough - which it might be. But if we're going to say 1.x -> 3.x is forbidden, then we should just say that and drop `couchup` entirely.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561807326/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561807613","html_url":"https://github.com/apache/couchdb/pull/2338#issuecomment-561807613","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2338","id":561807613,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MTgwNzYxMw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-04T19:41:52Z","updated_at":"2019-12-04T19:41:52Z","author_association":"MEMBER","body":"I restarted the failed worker on Travis. If that comes back green let me know and I'll merge this for you.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561807613/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561877993","html_url":"https://github.com/apache/couchdb/pull/2338#issuecomment-561877993","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2338","id":561877993,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MTg3Nzk5Mw==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-04T22:56:08Z","updated_at":"2019-12-04T22:56:08Z","author_association":"MEMBER","body":"Thank you for the approval and the retrigger, @davisp ! It seems the build failed again with an unrelated issue. What do you think I should do so that this change could be merged?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561877993/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561882718","html_url":"https://github.com/apache/couchdb/pull/2170#issuecomment-561882718","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2170","id":561882718,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MTg4MjcxOA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-04T23:08:53Z","updated_at":"2019-12-04T23:08:53Z","author_association":"MEMBER","body":"@jiangphcn I ran out of time today but this is on my agenda for tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561882718/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561933653","html_url":"https://github.com/apache/couchdb/pull/2170#issuecomment-561933653","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2170","id":561933653,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MTkzMzY1Mw==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-05T02:08:42Z","updated_at":"2019-12-05T02:08:42Z","author_association":"CONTRIBUTOR","body":"@wohali that's fine. it is great that you can take time to look into the codes and documentation.\r\n\r\nIn general, the change happened in this PR. From this PR, you can easily see the change to support spidermonkey 60. Paul @davisp created another branch to introduce switch option to select which version of spidermonkey to build, 1.8.5 or 6.0, or others in the future. Perhaps, we can use this branch to create another PR in favor of current PR for merge. But anyway, the main logic  are the same.\r\n\r\nFor Windows support, now I can compile spidermonkey 60 and Couchjs and run it. However, it needs Visual Studio 2015 or later versions. This also implied impact to other C/C++ based libraries and need more test. Also there is need to update supported Windows version for CouchDB, etc. Because we still have spidermonkey 1.8.5 support. This allows us to keep intact in Couchdb 3.0 for Windows. How about stating that spidermonkey 6.0 in Windows in CouchDB 3.0 is technology preview? We can improve it over time and give official support in CouchDB 3.x.  \r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/561933653/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/562077107","html_url":"https://github.com/apache/couchdb/issues/2341#issuecomment-562077107","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2341","id":562077107,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MjA3NzEwNw==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-05T10:50:34Z","updated_at":"2019-12-05T10:50:34Z","author_association":"MEMBER","body":"FlexSearch looks pretty cool. It wouldn't be possible to use that with CouchDB for a few reasons but the main issue is because FlexSearch is designed for nodejs and browser environments.\r\n\r\nA good use-case might be to combine it with PouchDB. That could probably fit your use case.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/562077107/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/562120741","html_url":"https://github.com/apache/couchdb/pull/2338#issuecomment-562120741","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2338","id":562120741,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MjEyMDc0MQ==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-05T13:05:15Z","updated_at":"2019-12-05T13:05:15Z","author_association":"MEMBER","body":"Thank you for the merge, @garrensmith !","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/562120741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/562275046","html_url":"https://github.com/apache/couchdb/pull/2331#issuecomment-562275046","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2331","id":562275046,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MjI3NTA0Ng==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-05T19:20:54Z","updated_at":"2019-12-05T19:20:54Z","author_association":"CONTRIBUTOR","body":"@jaydoane I was thinking it would be like having N expiring caches, one for each application that needs it. Each would have its own timeouts, etc. Presumably the expiring cache for OAuth2 vs some other auth mechanism could need different expiry and stale timeouts. The model would then look like:\r\n\r\n```\r\n(?EXPIRING_CACHE, Name, ?PK, Key) := (Val, StaleTS, ExpireTS)\r\n(?EXPIRING_CACHE, Name, ?EXP, ExpireTS, Key) := ()\r\n```\r\n\r\nSo there would be one for OAuth2 with something like `Name = oauth2_xcache`. If there another auth library application it would have `Name = otherlib_xcache`. Each application would then be in charge of starting its own expiry cache child in its supervisor, cleaning up stale entries, updating entries, etc.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/562275046/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/562283396","html_url":"https://github.com/apache/couchdb/pull/2331#issuecomment-562283396","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2331","id":562283396,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MjI4MzM5Ng==","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-05T19:38:07Z","updated_at":"2019-12-07T23:46:44Z","author_association":"CONTRIBUTOR","body":"```\r\n(?EXPIRING_CACHE, Name, ?PK, Key) := (Val, StaleTS, ExpireTS)\r\n(?EXPIRING_CACHE, Name, ?EXP, ExpireTS, Key) := ()\r\n```\r\n@nickva I think the main issue with this schema is that if application `Name` is retired, or changes its name while there are still unexpired cache entries, those entries will remain as garbage indefinitely in FDB without a way to get cleaned up. We could of course create a registry for cache names similar to how job types are registered, but that adds complexity. Not sure if there's a simpler way to do it, or whether it's even a real concern. I suppose we could just create a `cleanup` function that should be called (manually) when a `Name` is retired/changed?\r\n\r\nEDIT: It occurs to me that it's possible to clear all keys under the `(?EXPIRING_CACHE)` prefix, which is sort of the \"nuclear option\" for key cleanup, but since this is just a cache, it seems like a relatively benign way to ensure any garbage from abandoned `Name`s gets cleared. In short, I agree that overall this change is a substantial improvement, and an update is in the works!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/562283396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/562388541","html_url":"https://github.com/apache/couchdb/issues/1297#issuecomment-562388541","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1297","id":562388541,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MjM4ODU0MQ==","user":{"login":"koogordo","id":32753040,"node_id":"MDQ6VXNlcjMyNzUzMDQw","avatar_url":"https://avatars.githubusercontent.com/u/32753040?v=4","gravatar_id":"","url":"https://api.github.com/users/koogordo","html_url":"https://github.com/koogordo","followers_url":"https://api.github.com/users/koogordo/followers","following_url":"https://api.github.com/users/koogordo/following{/other_user}","gists_url":"https://api.github.com/users/koogordo/gists{/gist_id}","starred_url":"https://api.github.com/users/koogordo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/koogordo/subscriptions","organizations_url":"https://api.github.com/users/koogordo/orgs","repos_url":"https://api.github.com/users/koogordo/repos","events_url":"https://api.github.com/users/koogordo/events{/privacy}","received_events_url":"https://api.github.com/users/koogordo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-06T01:11:06Z","updated_at":"2019-12-06T01:11:06Z","author_association":"NONE","body":"@wohali do you have any suggestions for this problem when I know that my Azure VM has 8 cores and 8GB of RAM and the view building is still producing the \"request could not be processed in a reasonable amount of time\" error?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/562388541/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/562414523","html_url":"https://github.com/apache/couchdb/issues/2221#issuecomment-562414523","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2221","id":562414523,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MjQxNDUyMw==","user":{"login":"dbashyal","id":833986,"node_id":"MDQ6VXNlcjgzMzk4Ng==","avatar_url":"https://avatars.githubusercontent.com/u/833986?v=4","gravatar_id":"","url":"https://api.github.com/users/dbashyal","html_url":"https://github.com/dbashyal","followers_url":"https://api.github.com/users/dbashyal/followers","following_url":"https://api.github.com/users/dbashyal/following{/other_user}","gists_url":"https://api.github.com/users/dbashyal/gists{/gist_id}","starred_url":"https://api.github.com/users/dbashyal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbashyal/subscriptions","organizations_url":"https://api.github.com/users/dbashyal/orgs","repos_url":"https://api.github.com/users/dbashyal/repos","events_url":"https://api.github.com/users/dbashyal/events{/privacy}","received_events_url":"https://api.github.com/users/dbashyal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-06T03:13:42Z","updated_at":"2019-12-06T03:13:42Z","author_association":"NONE","body":"> This console warning is not an error or an actual problem — Chrome is just spreading the word about this new standard to increase developer adoption.\r\n> \r\n> The release date for a fix is 02/04/2020 per: https://www.chromium.org/updates/same-site\r\n> \r\n> I solved the same problem by adding in the response header\r\n> \r\n> response.setHeader(\"Set-Cookie\", \"HttpOnly;Secure;SameSite=Strict\");\r\n> \r\n> SameSite prevents the browser from sending the cookie along with cross-site requests. The main goal is to mitigate the risk of cross-origin information leakage. It also provides some protection against cross-site request forgery attacks. Possible values for the flag are Lax or Strict.\r\n> \r\n> Please refer to this before applying any option.\r\n> \r\n> Hope this helps you.\r\n\r\n@ImATechnophile You missed link - https://stackoverflow.com/a/58320564/534525","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/562414523/reactions","total_count":12,"+1":12,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/562585354","html_url":"https://github.com/apache/couchdb/pull/2343#issuecomment-562585354","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2343","id":562585354,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MjU4NTM1NA==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-06T14:09:33Z","updated_at":"2019-12-06T14:09:33Z","author_association":"MEMBER","body":"Link to the doc PR: https://github.com/apache/couchdb-documentation/pull/462","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/562585354/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/562734914","html_url":"https://github.com/apache/couchdb/pull/2343#issuecomment-562734914","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2343","id":562734914,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MjczNDkxNA==","user":{"login":"bessbd","id":9086834,"node_id":"MDQ6VXNlcjkwODY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/9086834?v=4","gravatar_id":"","url":"https://api.github.com/users/bessbd","html_url":"https://github.com/bessbd","followers_url":"https://api.github.com/users/bessbd/followers","following_url":"https://api.github.com/users/bessbd/following{/other_user}","gists_url":"https://api.github.com/users/bessbd/gists{/gist_id}","starred_url":"https://api.github.com/users/bessbd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bessbd/subscriptions","organizations_url":"https://api.github.com/users/bessbd/orgs","repos_url":"https://api.github.com/users/bessbd/repos","events_url":"https://api.github.com/users/bessbd/events{/privacy}","received_events_url":"https://api.github.com/users/bessbd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-06T20:58:58Z","updated_at":"2019-12-06T20:58:58Z","author_association":"MEMBER","body":"Thank you for the review @davisp ! I'll push commits for the changes you've requested soon.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/562734914/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/562739588","html_url":"https://github.com/apache/couchdb/pull/2343#issuecomment-562739588","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2343","id":562739588,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MjczOTU4OA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-06T21:15:16Z","updated_at":"2019-12-06T21:15:16Z","author_association":"MEMBER","body":"Go ahead and squash those fixup commits and then we'll wait for CI to come back.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/562739588/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/563957936","html_url":"https://github.com/apache/couchdb/issues/2350#issuecomment-563957936","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2350","id":563957936,"node_id":"MDEyOklzc3VlQ29tbWVudDU2Mzk1NzkzNg==","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-10T09:59:52Z","updated_at":"2019-12-10T09:59:52Z","author_association":"MEMBER","body":"cc @eiri ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/563957936/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564013001","html_url":"https://github.com/apache/couchdb/issues/2350#issuecomment-564013001","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2350","id":564013001,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDAxMzAwMQ==","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-10T12:35:05Z","updated_at":"2019-12-10T12:35:05Z","author_association":"MEMBER","body":"looking at the code, I don't think #2287 is related. It seems that the case clause [here](https://github.com/apache/couchdb-fabric/blob/master/src/fabric_db_info.erl#L29) needs to handle `{timeout, {WorkersDict, _, _}}` though I'm not sure where that gets generated.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564013001/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564014801","html_url":"https://github.com/apache/couchdb/issues/2350#issuecomment-564014801","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2350","id":564014801,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDAxNDgwMQ==","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-10T12:40:13Z","updated_at":"2019-12-10T12:40:13Z","author_association":"MEMBER","body":"okay - I think I see now. It looks like a straightforward bug that the case clause doesn't match the accumulator when a `timeout` is sent. This looks to be a trivial but long-standing bug.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564014801/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564316066","html_url":"https://github.com/apache/couchdb/pull/2331#issuecomment-564316066","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2331","id":564316066,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDMxNjA2Ng==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-11T00:04:44Z","updated_at":"2019-12-11T00:04:44Z","author_association":"CONTRIBUTOR","body":"@jaydoane Looks great. See a few minor notes.\r\n\r\n\r\nTo run tests I had to add it to the subdirs in rebar:\r\n\r\n```\r\n--- a/rebar.config.script\r\n+++ b/rebar.config.script\r\n@@ -92,6 +92,7 @@ SubDirs = [\r\n     \"src/fabric\",\r\n     \"src/couch_jobs\",\r\n+    \"src/couch_expiring_cache\",\r\n```\r\n\r\nOtherwise tests ran and passed.\r\n\r\nCreated an expiring cache manually and saw that entries were being returned as fresh, stale, expired then cleaned up and returned as non_found.\r\n\r\n```\r\n couch_expiring_cache:insert(<<\"auth-decision\">>, <<\"a\">>, <<\"x\">>, erlang:system_time(millisecond) + 6000, erlang:system_time(millisecond) + 10000), couch_expiring_cache:lookup(<<\"auth-decision\">>, <<\"a\">>).\r\n{fresh,<<\"x\">>}\r\n(node1@127.0.0.1)79> couch_expiring_cache:lookup(<<\"auth-decision\">>, <<\"a\">>).                        {fresh,<<\"x\">>}                                                                                  couch_expiring_cache:lookup(<<\"auth-decision\">>, <<\"a\">>).\r\n{fresh,<<\"x\">>}\r\n(node1@127.0.0.1)81> couch_expiring_cache:lookup(<<\"auth-decision\">>, <<\"a\">>).\r\n{fresh,<<\"x\">>}\r\n(node1@127.0.0.1)89> couch_expiring_cache:lookup(<<\"auth-decision\">>, <<\"a\">>).\r\n{stale,<<\"x\">>}\r\n(node1@127.0.0.1)90> couch_expiring_cache:lookup(<<\"auth-decision\">>, <<\"a\">>).\r\n{stale,<<\"x\">>}\r\n(node1@127.0.0.1)91> couch_expiring_cache:lookup(<<\"auth-decision\">>, <<\"a\">>).\r\n{stale,<<\"x\">>}\r\n(node1@127.0.0.1)92> couch_expiring_cache:lookup(<<\"auth-decision\">>, <<\"a\">>).\r\n{stale,<<\"x\">>}\r\n(node1@127.0.0.1)93> couch_expiring_cache:lookup(<<\"auth-decision\">>, <<\"a\">>).\r\n{stale,<<\"x\">>}\r\n(node1@127.0.0.1)94> couch_expiring_cache:lookup(<<\"auth-decision\">>, <<\"a\">>).\r\n{stale,<<\"x\">>}\r\n(node1@127.0.0.1)103> couch_expiring_cache:lookup(<<\"auth-decision\">>, <<\"a\">>).\r\n{stale,<<\"x\">>}\r\n(node1@127.0.0.1)104> couch_expiring_cache:lookup(<<\"auth-decision\">>, <<\"a\">>).\r\n{stale,<<\"x\">>}\r\n(node1@127.0.0.1)105> couch_expiring_cache:lookup(<<\"auth-decision\">>, <<\"a\">>).\r\nexpired\r\n(node1@127.0.0.1)106> couch_expiring_cache:lookup(<<\"auth-decision\">>, <<\"a\">>).\r\nexpired\r\n(node1@127.0.0.1)107> couch_expiring_cache:lookup(<<\"auth-decision\">>, <<\"a\">>).\r\nnot_found\r\n(node1@127.0.0.1)109> couch_expiring_cache:lookup(<<\"auth-decision\">>, <<\"a\">>).\r\nnot_found\r\n```\r\nNice work!\r\n\r\n+1 (after the minor fixes from the comments)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564316066/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564614599","html_url":"https://github.com/apache/couchdb/issues/1269#issuecomment-564614599","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1269","id":564614599,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDYxNDU5OQ==","user":{"login":"dsebastien","id":89887,"node_id":"MDQ6VXNlcjg5ODg3","avatar_url":"https://avatars.githubusercontent.com/u/89887?v=4","gravatar_id":"","url":"https://api.github.com/users/dsebastien","html_url":"https://github.com/dsebastien","followers_url":"https://api.github.com/users/dsebastien/followers","following_url":"https://api.github.com/users/dsebastien/following{/other_user}","gists_url":"https://api.github.com/users/dsebastien/gists{/gist_id}","starred_url":"https://api.github.com/users/dsebastien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dsebastien/subscriptions","organizations_url":"https://api.github.com/users/dsebastien/orgs","repos_url":"https://api.github.com/users/dsebastien/repos","events_url":"https://api.github.com/users/dsebastien/events{/privacy}","received_events_url":"https://api.github.com/users/dsebastien/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-11T16:08:10Z","updated_at":"2019-12-11T16:08:10Z","author_association":"NONE","body":"I'm curious about the status of this feature.\r\nIn my current project we're using CouchDB as the main data store and are starting to look at search scenarios. FTS would clearly help us.\r\n\r\nIs there anything I/we can do to help this move forward?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564614599/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564628099","html_url":"https://github.com/apache/couchdb/issues/1269#issuecomment-564628099","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1269","id":564628099,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDYyODA5OQ==","user":{"login":"lucidNTR","id":1176068,"node_id":"MDQ6VXNlcjExNzYwNjg=","avatar_url":"https://avatars.githubusercontent.com/u/1176068?v=4","gravatar_id":"","url":"https://api.github.com/users/lucidNTR","html_url":"https://github.com/lucidNTR","followers_url":"https://api.github.com/users/lucidNTR/followers","following_url":"https://api.github.com/users/lucidNTR/following{/other_user}","gists_url":"https://api.github.com/users/lucidNTR/gists{/gist_id}","starred_url":"https://api.github.com/users/lucidNTR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucidNTR/subscriptions","organizations_url":"https://api.github.com/users/lucidNTR/orgs","repos_url":"https://api.github.com/users/lucidNTR/repos","events_url":"https://api.github.com/users/lucidNTR/events{/privacy}","received_events_url":"https://api.github.com/users/lucidNTR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-11T16:37:02Z","updated_at":"2019-12-11T16:37:02Z","author_association":"NONE","body":"@dsebastien as far as i understood @wohali last month it will be part of couchdb 3.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564628099/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564641379","html_url":"https://github.com/apache/couchdb/pull/2352#issuecomment-564641379","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2352","id":564641379,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDY0MTM3OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-11T17:08:37Z","updated_at":"2019-12-11T17:08:37Z","author_association":"MEMBER","body":"@willholley @janl has slapped my hand fiercely in the past for using bashisms like this.\r\n\r\nCan you consider rewriting it not to require bash? Note that line 1 **explicitly** is `#!/bin/sh` to highlight this choice.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564641379/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564642741","html_url":"https://github.com/apache/couchdb/pull/2352#issuecomment-564642741","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2352","id":564642741,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDY0Mjc0MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-11T17:12:02Z","updated_at":"2019-12-11T17:12:02Z","author_association":"MEMBER","body":"Output of `checkbashisms (1)`:\r\n\r\n```\r\npossible bashism in rel/overlay/bin/remsh line 32 (alternative test command ([[ foo ]] should be [ foo ])):\r\nif [[ $ERL_FLAGS =~ $kCOOKIE_REGEX ]]; then\r\npossible bashism in rel/overlay/bin/remsh line 33 ($BASH_SOMETHING):\r\n  COOKIE=\"${BASH_REMATCH[1]}\"\r\npossible bashism in rel/overlay/bin/remsh line 33 (bash arrays, ${name[0|*|@]}):\r\n  COOKIE=\"${BASH_REMATCH[1]}\"\r\n```\r\n\r\nand I can't recall if your line 38 is a bashism or not.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564642741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564658393","html_url":"https://github.com/apache/couchdb/issues/1269#issuecomment-564658393","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1269","id":564658393,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDY1ODM5Mw==","user":{"login":"dsebastien","id":89887,"node_id":"MDQ6VXNlcjg5ODg3","avatar_url":"https://avatars.githubusercontent.com/u/89887?v=4","gravatar_id":"","url":"https://api.github.com/users/dsebastien","html_url":"https://github.com/dsebastien","followers_url":"https://api.github.com/users/dsebastien/followers","following_url":"https://api.github.com/users/dsebastien/following{/other_user}","gists_url":"https://api.github.com/users/dsebastien/gists{/gist_id}","starred_url":"https://api.github.com/users/dsebastien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dsebastien/subscriptions","organizations_url":"https://api.github.com/users/dsebastien/orgs","repos_url":"https://api.github.com/users/dsebastien/repos","events_url":"https://api.github.com/users/dsebastien/events{/privacy}","received_events_url":"https://api.github.com/users/dsebastien/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-11T17:51:11Z","updated_at":"2019-12-11T17:51:40Z","author_association":"NONE","body":"@lucidNTR Indeed, i just saw the details through this recent talk: https://www.youtube.com/watch?v=SjXyVZZFkBg. Apparently Couch v3 will be released soon! :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564658393/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564674322","html_url":"https://github.com/apache/couchdb/pull/2354#issuecomment-564674322","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2354","id":564674322,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDY3NDMyMg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-11T18:31:18Z","updated_at":"2019-12-11T18:31:18Z","author_association":"CONTRIBUTOR","body":"```\r\n$ make eunit apps=couch suites=couch_multidb_changes\r\n==> couch (compile)\r\nCompiling priv/couch_js/http.c\r\nCompiling priv/couch_js/main.c\r\nCompiling priv/couch_js/utf8.c\r\nCompiling priv/couch_js/util.c\r\n==> rel (compile)\r\n==> asf-master (compile)\r\n==> asf-master (setup_eunit)\r\n==> couch (eunit)\r\n======================== EUnit ========================\r\nmodule 'couch_multidb_changes'\r\n  couch_multidb_changes:407: t_handle_call_change...[0.001 s] ok\r\n  couch_multidb_changes:417: t_handle_call_change_filter_design_docs...ok\r\n  couch_multidb_changes:428: t_handle_call_checkpoint_new...ok\r\n  couch_multidb_changes:438: t_handle_call_checkpoint_existing...[0.001 s] ok\r\n  couch_multidb_changes:449: t_handle_info_created...[0.004 s] ok\r\n  couch_multidb_changes:459: t_handle_info_deleted...ok\r\n  couch_multidb_changes:468: t_handle_info_updated...ok\r\n  couch_multidb_changes:478: t_handle_info_other_event...[0.001 s] ok\r\n  couch_multidb_changes:488: t_handle_info_created_other_db...ok\r\n  couch_multidb_changes:496: t_handle_info_scanner_exit_normal...ok\r\n  couch_multidb_changes:505: t_handle_info_scanner_crashed...ok\r\n  couch_multidb_changes:512: t_handle_info_event_server_exited...ok\r\n  couch_multidb_changes:519: t_handle_info_unknown_pid_exited...ok\r\n  couch_multidb_changes:530: t_handle_info_change_feed_exited...ok\r\n  couch_multidb_changes:549: t_handle_info_change_feed_exited_and_need_rescan...[0.001 s] ok\r\n  couch_multidb_changes:568: t_spawn_changes_reader...ok\r\n  couch_multidb_changes:587: t_changes_reader_cb_change...ok\r\n  couch_multidb_changes:599: t_changes_reader_cb_stop...[0.003 s] ok\r\n  couch_multidb_changes:612: t_changes_reader_cb_other...ok\r\n  couch_multidb_changes:616: t_handle_call_resume_scan_no_chfeed_no_ets_entry...ok\r\n  couch_multidb_changes:640: t_handle_call_resume_scan_chfeed_no_ets_entry...ok\r\n  couch_multidb_changes:653: t_handle_call_resume_scan_chfeed_ets_entry...ok\r\n  couch_multidb_changes:667: t_handle_call_resume_scan_no_chfeed_ets_entry...ok\r\n  couch_multidb_changes:690: t_start_link...ok\r\n  couch_multidb_changes:707: t_start_link_no_ddocs...ok\r\n  couch_multidb_changes:723: t_misc_gen_server_callbacks...ok\r\nApplication crypto was left running!\r\n  couch_multidb_changes:744: t_find_shard...[0.092 s] ok\r\n[os_mon] cpu supervisor port (cpu_sup): Erlang has closed\r\n  couch_multidb_changes:753: t_shard_not_found...[0.001 s] ok\r\n[os_mon] cpu supervisor port (cpu_sup): Erlang has closed\r\n  couch_multidb_changes:759: t_pass_local...[0.021 s] ok\r\n[os_mon] cpu supervisor port (cpu_sup): Erlang has closed\r\n  couch_multidb_changes:774: t_fail_local...[0.021 s] ok\r\n[os_mon] cpu supervisor port (cpu_sup): Erlang has closed\r\n  [done in 13.940 s]\r\n=======================================================\r\n  All 30 tests passed.\r\n==> rel (eunit)\r\n==> asf-master (eunit)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564674322/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564782239","html_url":"https://github.com/apache/couchdb/pull/2352#issuecomment-564782239","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2352","id":564782239,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDc4MjIzOQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-11T23:39:09Z","updated_at":"2019-12-11T23:39:09Z","author_association":"MEMBER","body":"note: i haven't been able to test it, just did a static code review.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564782239/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564816138","html_url":"https://github.com/apache/couchdb/pull/2345#issuecomment-564816138","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2345","id":564816138,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDgxNjEzOA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-12T02:02:30Z","updated_at":"2019-12-12T02:02:30Z","author_association":"MEMBER","body":"Hi @jiangphcn , this is a big PR and it's taking me a bit of time to work through.\r\n\r\nWhile I'm doing that, I went and had a look for pre-built versions of SM60. \r\n\r\nlibmozjs-60 is available pre-built only on:\r\n* Debian buster (10.x) and newer.\r\n* Ubuntu disco (19.04) and newer - but no LTS releases past bionic (18.04LTS) exist yet.\r\n\r\n@willholley so far I cannot find libmozjs60 precompiled for _any_ version of RHEL/CentOS, is this true?\r\n\r\nThis probably means that for the rest of our binary build matrix, we'll have to start building libmozjs60 and distributing it ourselves, as we do today for the ancient 1.8.5 library. That means building it for:\r\n* Debian stretch (9.x)\r\n* Ubuntu xenial (16.04LTS)\r\n* Ubuntu bionic (18.04LTS)\r\n* CentOS 7\r\n* CentOS 8\r\n* Windows 64-bit\r\n\r\nI'm intentionally excluding CentOS 6 from that list because it will go End-Of-Life on November 2020; people stuck on it can live with 1.8.5 a little longer, I think. 😉 \r\n\r\nThe alternative is that we only ship our binaries with 60 in them only for Debian buster, and maybe Windows (tech preview), then add in the other platforms over time, as packages materialise (or if we decide to pick up the slack). Perhaps we know someone over at RH/CentOS who can get a mozjs60 package released for CentOS 8 at the very least...\r\n\r\nThe good news is that the Docker container can probably be moved from stretch to buster fairly easily (there was a single bug outstanding against ppc64le, which may actually be a qemu bug) so our Docker users can enjoy the new support with this release.\r\n\r\nWhat do you think?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564816138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564821029","html_url":"https://github.com/apache/couchdb/pull/2345#issuecomment-564821029","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2345","id":564821029,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDgyMTAyOQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-12T02:24:27Z","updated_at":"2019-12-12T02:24:27Z","author_association":"MEMBER","body":"@tilgovi In the past you've helped with checking out things like sandbox quality / escape mechanisms on JavaScript. Would you be able to review if things have changed with this SM60 PR?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564821029/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564821549","html_url":"https://github.com/apache/couchdb/pull/2345#issuecomment-564821549","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2345","id":564821549,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDgyMTU0OQ==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-12T02:26:56Z","updated_at":"2019-12-12T02:26:56Z","author_association":"CONTRIBUTOR","body":"Hi @wohali, thanks indeed for taking time to review this PR.\r\n\r\nRegarding pre-built version of SM60, again, thanks for thoughtful consideration for its distribution. Yes, there are limited pre-built versions for libmozjs-60. For the rest of them you mentioned, we or   the users need to built them and then use spidermonkey 60 based codes. \r\n\r\nFor now, I am able to build for Debian stretch and Windows 64-bit.  Because we have switch to use between 1.8.5 and 6.0 and still want to set 1.8.5 as default, I think that we can move forward step by step. As you suggested, we can ship some library (such as Debian stretch, buster, Ubuntu disco, Windows 64 bit), and ship them on request later.\r\n\r\nAlso, we can publish step I come up with to help user to build by themselves for the platforms they need.\r\n\r\nThanks,\r\nPeng Hui","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564821549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564824072","html_url":"https://github.com/apache/couchdb/pull/2345#issuecomment-564824072","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2345","id":564824072,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDgyNDA3Mg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-12T02:38:43Z","updated_at":"2019-12-12T02:38:43Z","author_association":"MEMBER","body":"@jiangphcn Sounds like we agree on this.\r\n\r\nI will review the code more closely tomorrow; I want to understand how sandboxing is affected by the move to SM60, and I want to get some more hands-on time with the code.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564824072/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564831961","html_url":"https://github.com/apache/couchdb/pull/2345#issuecomment-564831961","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2345","id":564831961,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDgzMTk2MQ==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-12T03:19:08Z","updated_at":"2019-12-12T03:19:08Z","author_association":"CONTRIBUTOR","body":"Sure, thanks @wohali ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564831961/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564912133","html_url":"https://github.com/apache/couchdb/issues/2243#issuecomment-564912133","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2243","id":564912133,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDkxMjEzMw==","user":{"login":"pavellzubkov","id":18612709,"node_id":"MDQ6VXNlcjE4NjEyNzA5","avatar_url":"https://avatars.githubusercontent.com/u/18612709?v=4","gravatar_id":"","url":"https://api.github.com/users/pavellzubkov","html_url":"https://github.com/pavellzubkov","followers_url":"https://api.github.com/users/pavellzubkov/followers","following_url":"https://api.github.com/users/pavellzubkov/following{/other_user}","gists_url":"https://api.github.com/users/pavellzubkov/gists{/gist_id}","starred_url":"https://api.github.com/users/pavellzubkov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavellzubkov/subscriptions","organizations_url":"https://api.github.com/users/pavellzubkov/orgs","repos_url":"https://api.github.com/users/pavellzubkov/repos","events_url":"https://api.github.com/users/pavellzubkov/events{/privacy}","received_events_url":"https://api.github.com/users/pavellzubkov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-12T08:56:55Z","updated_at":"2019-12-12T08:56:55Z","author_association":"NONE","body":"same problem... very nasty bug...(","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564912133/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564916712","html_url":"https://github.com/apache/couchdb/issues/2210#issuecomment-564916712","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2210","id":564916712,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDkxNjcxMg==","user":{"login":"lostnet","id":1422781,"node_id":"MDQ6VXNlcjE0MjI3ODE=","avatar_url":"https://avatars.githubusercontent.com/u/1422781?v=4","gravatar_id":"","url":"https://api.github.com/users/lostnet","html_url":"https://github.com/lostnet","followers_url":"https://api.github.com/users/lostnet/followers","following_url":"https://api.github.com/users/lostnet/following{/other_user}","gists_url":"https://api.github.com/users/lostnet/gists{/gist_id}","starred_url":"https://api.github.com/users/lostnet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lostnet/subscriptions","organizations_url":"https://api.github.com/users/lostnet/orgs","repos_url":"https://api.github.com/users/lostnet/repos","events_url":"https://api.github.com/users/lostnet/events{/privacy}","received_events_url":"https://api.github.com/users/lostnet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-12T09:10:04Z","updated_at":"2019-12-12T09:10:04Z","author_association":"CONTRIBUTOR","body":"Due to [find not supporting attachments](https://github.com/apache/couchdb/issues/1974) I don't see a simple alternative to fixing all_docs to not have a hardcoded per record timeout. I have put together an example of making it conditional on whether attachments are in use, but never hardcoded as an example of the pattern I think is necessary to not cause timeouts that can't be worked around on older hardware, larger docs and attachments, etc:\r\n\r\n```\r\ndiff --git a/src/fabric/src/fabric_view_all_docs.erl b/src/fabric/src/fabric_view_all_docs.erl\r\nindex 07cd1b180..6319f5bd2 100644\r\n--- a/src/fabric/src/fabric_view_all_docs.erl\r\n+++ b/src/fabric/src/fabric_view_all_docs.erl\r\n@@ -119,8 +119,14 @@ go(DbName, Options, QueryArgs, Callback, Acc0) ->\r\n         Callback({error, timeout}, Acc0)\r\n     end.\r\n \r\n+msg_timeout(DocOpts) ->\r\n+\tcase lists:member(attachments, DocOpts) of\r\n+\t\tfalse -> fabric_util:request_timeout();\r\n+\t\t_ -> fabric_util:attachments_timeout()\r\n+\tend.\r\n+\r\n go(DbName, _Options, Workers, QueryArgs, Callback, Acc0) ->\r\n-    #mrargs{limit = Limit, skip = Skip, update_seq = UpdateSeq} = QueryArgs,\r\n+    #mrargs{limit = Limit, skip = Skip, update_seq = UpdateSeq, doc_options = DocOpts} = QueryArgs,\r\n     State = #collector{\r\n         db_name = DbName,\r\n         query_args = QueryArgs,\r\n@@ -132,7 +138,7 @@ go(DbName, _Options, Workers, QueryArgs, Callback, Acc0) ->\r\n         update_seq = case UpdateSeq of true -> []; false -> nil end\r\n     },\r\n     case rexi_utils:recv(Workers, #shard.ref, fun handle_message/3,\r\n-        State, fabric_util:view_timeout(QueryArgs), 5000) of\r\n+        State, fabric_util:view_timeout(QueryArgs), msg_timeout(DocOpts)) of\r\n     {ok, NewState} ->\r\n         {ok, NewState#collector.user_acc};\r\n     {timeout, NewState} ->\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564916712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564989582","html_url":"https://github.com/apache/couchdb/pull/2352#issuecomment-564989582","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2352","id":564989582,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDk4OTU4Mg==","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-12T12:37:14Z","updated_at":"2019-12-12T12:37:14Z","author_association":"MEMBER","body":"thanks for the feedback @wohali. The latest changes only scrub `-name` and `-setcookie` from `ERL_FLAGS`.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/564989582/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565067748","html_url":"https://github.com/apache/couchdb/pull/2293#issuecomment-565067748","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2293","id":565067748,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTA2Nzc0OA==","user":{"login":"adrienverge","id":5244945,"node_id":"MDQ6VXNlcjUyNDQ5NDU=","avatar_url":"https://avatars.githubusercontent.com/u/5244945?v=4","gravatar_id":"","url":"https://api.github.com/users/adrienverge","html_url":"https://github.com/adrienverge","followers_url":"https://api.github.com/users/adrienverge/followers","following_url":"https://api.github.com/users/adrienverge/following{/other_user}","gists_url":"https://api.github.com/users/adrienverge/gists{/gist_id}","starred_url":"https://api.github.com/users/adrienverge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adrienverge/subscriptions","organizations_url":"https://api.github.com/users/adrienverge/orgs","repos_url":"https://api.github.com/users/adrienverge/repos","events_url":"https://api.github.com/users/adrienverge/events{/privacy}","received_events_url":"https://api.github.com/users/adrienverge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-12T15:57:37Z","updated_at":"2019-12-12T15:57:37Z","author_association":"CONTRIBUTOR","body":"Hello team, what you think of this simple (yet useful) change?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565067748/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565078825","html_url":"https://github.com/apache/couchdb/pull/2293#issuecomment-565078825","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2293","id":565078825,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTA3ODgyNQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-12T16:24:18Z","updated_at":"2019-12-12T16:24:18Z","author_association":"MEMBER","body":"@adrienverge Are you sure this works correctly when specifying no list? My read of the source code suggests that it won't:\r\n\r\nhttps://github.com/apache/couchdb-config/blob/master/src/config_app.erl#L30-L48\r\n\r\nand:\r\n\r\n```\r\n$ erl -a b\r\nErlang/OTP 21 [erts-10.2.4] [source] [64-bit] [smp:2:2] [ds:2:2:10] [async-threads:1]\r\n\r\nEshell V10.2.4  (abort with ^G)\r\n1> init:get_argument(a).\r\n{ok,[[\"b\"]]}\r\n2>\r\nUser switch command\r\n --> q\r\n$ erl -a\r\nErlang/OTP 21 [erts-10.2.4] [source] [64-bit] [smp:2:2] [ds:2:2:10] [async-threads:1]\r\n\r\nEshell V10.2.4  (abort with ^G)\r\n1> init:get_argument(a).\r\n{ok,[[]]}\r\n2>\r\nUser switch command\r\n --> q\r\n$ erl\r\nErlang/OTP 21 [erts-10.2.4] [source] [64-bit] [smp:2:2] [ds:2:2:10] [async-threads:1]\r\n\r\nEshell V10.2.4  (abort with ^G)\r\n1> init:get_argument(a).\r\nerror\r\n2>\r\nUser switch command\r\n --> q\r\n```\r\n\r\nBecause an empty list returns success, I think this overrides the default order. Can you confirm?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565078825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565102983","html_url":"https://github.com/apache/couchdb/pull/2293#issuecomment-565102983","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2293","id":565102983,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTEwMjk4Mw==","user":{"login":"adrienverge","id":5244945,"node_id":"MDQ6VXNlcjUyNDQ5NDU=","avatar_url":"https://avatars.githubusercontent.com/u/5244945?v=4","gravatar_id":"","url":"https://api.github.com/users/adrienverge","html_url":"https://github.com/adrienverge","followers_url":"https://api.github.com/users/adrienverge/followers","following_url":"https://api.github.com/users/adrienverge/following{/other_user}","gists_url":"https://api.github.com/users/adrienverge/gists{/gist_id}","starred_url":"https://api.github.com/users/adrienverge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adrienverge/subscriptions","organizations_url":"https://api.github.com/users/adrienverge/orgs","repos_url":"https://api.github.com/users/adrienverge/repos","events_url":"https://api.github.com/users/adrienverge/events{/privacy}","received_events_url":"https://api.github.com/users/adrienverge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-12T17:23:07Z","updated_at":"2019-12-12T19:21:11Z","author_association":"CONTRIBUTOR","body":"@wohali thanks for your answer, and valuable feedback.\r\n\r\nI've updated the pull request to avoid even passing `-couch_ini` if the env var is unset, so that the command-line args really stay the same in the default case. I've also updated the commit message accordingly.\r\n```diff\r\n@@ -31,10 +31,10 @@ export COUCHDB_QUERY_SERVER_COFFEESCRIPT=\"{{prefix}}/bin/couchjs {{prefix}}/shar\r\n export COUCHDB_FAUXTON_DOCROOT={{fauxton_root}}\r\n \r\n ARGS_FILE=\"${COUCHDB_ARGS_FILE:-$ROOTDIR/etc/vm.args}\"\r\n-INI_FILES=${COUCHDB_INI_FILES:-}\r\n+[ -n \"${COUCHDB_INI_FILES:-}\" ] && INI_ARGS=\"-couch_ini $COUCHDB_INI_FILES\"\r\n SYSCONFIG_FILE=\"${COUCHDB_SYSCONFIG_FILE:-$ROOTDIR/releases/$APP_VSN/sys.config}\"\r\n \r\n exec \"$BINDIR/erlexec\" -boot \"$ROOTDIR/releases/$APP_VSN/couchdb\" \\\r\n      -args_file \"${ARGS_FILE}\" \\\r\n-     -couch_ini ${INI_FILES} \\\r\n+     ${INI_ARGS:-} \\\r\n      -config \"${SYSCONFIG_FILE}\" \"$@\"\r\n```\r\n\r\nI've tested it. Do you think it's OK?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565102983/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565220467","html_url":"https://github.com/apache/couchdb/pull/2293#issuecomment-565220467","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2293","id":565220467,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTIyMDQ2Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-12T22:44:38Z","updated_at":"2019-12-12T22:44:38Z","author_association":"MEMBER","body":"+1. We need passing tests (ugh) and I'm happy to merge this as the final step in making all of those CLI parameters overrideable.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565220467/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565326018","html_url":"https://github.com/apache/couchdb/pull/2293#issuecomment-565326018","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2293","id":565326018,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTMyNjAxOA==","user":{"login":"adrienverge","id":5244945,"node_id":"MDQ6VXNlcjUyNDQ5NDU=","avatar_url":"https://avatars.githubusercontent.com/u/5244945?v=4","gravatar_id":"","url":"https://api.github.com/users/adrienverge","html_url":"https://github.com/adrienverge","followers_url":"https://api.github.com/users/adrienverge/followers","following_url":"https://api.github.com/users/adrienverge/following{/other_user}","gists_url":"https://api.github.com/users/adrienverge/gists{/gist_id}","starred_url":"https://api.github.com/users/adrienverge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adrienverge/subscriptions","organizations_url":"https://api.github.com/users/adrienverge/orgs","repos_url":"https://api.github.com/users/adrienverge/repos","events_url":"https://api.github.com/users/adrienverge/events{/privacy}","received_events_url":"https://api.github.com/users/adrienverge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-13T06:59:07Z","updated_at":"2019-12-13T06:59:07Z","author_association":"CONTRIBUTOR","body":"> We need passing tests (ugh)\r\n\r\nSure. This is like the 12th time I push-force to have them run again; I'll keep doing it until they pass.\r\n\r\nThanks!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565326018/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565409823","html_url":"https://github.com/apache/couchdb/pull/2357#issuecomment-565409823","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2357","id":565409823,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTQwOTgyMw==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-13T11:34:59Z","updated_at":"2019-12-13T11:34:59Z","author_association":"MEMBER","body":"@willholley this seems to break the tests.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565409823/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565603871","html_url":"https://github.com/apache/couchdb/pull/2345#issuecomment-565603871","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2345","id":565603871,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTYwMzg3MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-13T20:50:10Z","updated_at":"2019-12-13T20:50:10Z","author_association":"MEMBER","body":"@jiangphcn on Debian Buster, I did the following:\r\n\r\n```\r\nsudo apt install libmozjs-60-0 libmozjs-60-dev\r\ngit clone https://github.com/apache/couchdb\r\ncd couchdb\r\ngit checkout sm60-davisp\r\n./configure --spidermonkey-version 60 -c\r\nmake couch\r\n```\r\n\r\nThis results in the following warnings at build time:\r\n```\r\nCompiling priv/couch_js/60/http.cpp\r\nCompiling priv/couch_js/60/main.cpp\r\nIn file included from /usr/include/time.h:29,\r\n                 from /usr/include/pthread.h:24,\r\n                 from /usr/include/x86_64-linux-gnu/c++/8/bits/gthr-default.h:35,\r\n                 from /usr/include/x86_64-linux-gnu/c++/8/bits/gthr.h:148,\r\n                 from /usr/include/c++/8/ext/atomicity.h:35,\r\n                 from /usr/include/c++/8/bits/basic_string.h:39,\r\n                 from /usr/include/c++/8/string:52,\r\n                 from /usr/include/c++/8/stdexcept:39,\r\n                 from /usr/include/c++/8/array:39,\r\n                 from /usr/include/mozjs-60/mozilla/Span.h:32,\r\n                 from /usr/include/mozjs-60/mozilla/Range.h:12,\r\n                 from /usr/include/mozjs-60/jsapi.h:15,\r\n                 from priv/couch_js/60/main.cpp:23:\r\n/usr/include/mozjs-60/js/Proxy.h: In static member function 'static size_t js::BaseProxyHandler::offsetOfFamily()':\r\n/usr/include/mozjs-60/js/Proxy.h:212:25: warning: offsetof within non-standard-layout type 'js::BaseProxyHandler' is conditionally-supported [-Winvalid-offsetof]\r\n         return offsetof(BaseProxyHandler, mFamily);\r\n                         ^\r\npriv/couch_js/60/main.cpp: In function 'bool req_ctor(JSContext*, unsigned int, JS::Value*)':\r\npriv/couch_js/60/main.cpp:90:32: warning: too many arguments for format [-Wformat-extra-args]\r\n         JS_ReportErrorUTF8(cx, \"Failed to create CouchHTTP instance.\\n\", NULL);\r\n                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nCompiling priv/couch_js/60/utf8.cpp\r\nIn file included from /usr/include/strings.h:23,\r\n                 from /usr/include/string.h:431,\r\n                 from /usr/include/c++/8/cstring:42,\r\n                 from /usr/include/mozjs-60/mozilla/Span.h:33,\r\n                 from /usr/include/mozjs-60/mozilla/Range.h:12,\r\n                 from /usr/include/mozjs-60/jsapi.h:15,\r\n                 from priv/couch_js/60/utf8.cpp:13:\r\n/usr/include/mozjs-60/js/Proxy.h: In static member function 'static size_t js::BaseProxyHandler::offsetOfFamily()':\r\n/usr/include/mozjs-60/js/Proxy.h:212:25: warning: offsetof within non-standard-layout type 'js::BaseProxyHandler' is conditionally-supported [-Winvalid-offsetof]\r\n         return offsetof(BaseProxyHandler, mFamily);\r\n                         ^\r\n```\r\n\r\nDo you see these as well?\r\n\r\nI do see that `make javascript` passes, which is good. Next step for me is to read the code a bit more closely. @davisp if you're able to describe the changes you're making to the upstream JS libraries that'd be most useful.\r\n\r\nI have asked @tilgovi to look at the sandboxing for this code and SM60. He says he hopes to have time this weekend for a code review.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565603871/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565626657","html_url":"https://github.com/apache/couchdb/pull/2360#issuecomment-565626657","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2360","id":565626657,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTYyNjY1Nw==","user":{"login":"ksnavely","id":1530988,"node_id":"MDQ6VXNlcjE1MzA5ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1530988?v=4","gravatar_id":"","url":"https://api.github.com/users/ksnavely","html_url":"https://github.com/ksnavely","followers_url":"https://api.github.com/users/ksnavely/followers","following_url":"https://api.github.com/users/ksnavely/following{/other_user}","gists_url":"https://api.github.com/users/ksnavely/gists{/gist_id}","starred_url":"https://api.github.com/users/ksnavely/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ksnavely/subscriptions","organizations_url":"https://api.github.com/users/ksnavely/orgs","repos_url":"https://api.github.com/users/ksnavely/repos","events_url":"https://api.github.com/users/ksnavely/events{/privacy}","received_events_url":"https://api.github.com/users/ksnavely/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-13T22:08:08Z","updated_at":"2019-12-13T22:08:08Z","author_association":"CONTRIBUTOR","body":"FWIW 1 of the 12 nodes of this cluster was down for maintenance during testing.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565626657/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565686925","html_url":"https://github.com/apache/couchdb/pull/2362#issuecomment-565686925","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2362","id":565686925,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTY4NjkyNQ==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-14T05:53:51Z","updated_at":"2019-12-14T05:53:51Z","author_association":"MEMBER","body":"Is it all the tests failing consistently or some of the tests failing consistently? I would prefer we rather ignore specific tests until we have a consistent set of elixir tests. We can then try and make the other ones more consistent. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565686925/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565687378","html_url":"https://github.com/apache/couchdb/pull/2362#issuecomment-565687378","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2362","id":565687378,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTY4NzM3OA==","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-14T06:02:26Z","updated_at":"2019-12-14T06:02:26Z","author_association":"CONTRIBUTOR","body":"> Is it all the tests failing consistently or some of the tests failing consistently? I would prefer we rather ignore specific tests until we have a consistent set of elixir tests. We can then try and make the other ones more consistent.\r\n\r\nI've only been keeping an eye on the builds for the last few days, but there are _many_ tests that fail occasionally, and a small handful that tend to fail more regularly. I think it will be a long and painful exercise to selectively ignore the worst offenders, since right now making _any_ change on master often requires days worth of build restarts.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565687378/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565694853","html_url":"https://github.com/apache/couchdb/pull/2345#issuecomment-565694853","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2345","id":565694853,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTY5NDg1Mw==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-14T08:17:21Z","updated_at":"2019-12-14T08:17:21Z","author_association":"CONTRIBUTOR","body":"Thanks Joan @wohali. I only saw two of them before.\r\n\r\n```\r\nIn file included from priv/couch_js/main.cpp:26:\r\nIn file included from /usr/local/include/mozjs-60/js/Wrapper.h:12:\r\n/usr/local/include/mozjs-60/js/Proxy.h:212:16: warning: offset of on non-standard-layout type 'js::BaseProxyHandler' [-Winvalid-offsetof]\r\n        return offsetof(BaseProxyHandler, mFamily);\r\n\r\nIn file included from priv/couch_js/utf8.cpp:16:\r\nIn file included from /usr/local/include/mozjs-60/js/Wrapper.h:12:\r\n/usr/local/include/mozjs-60/js/Proxy.h:212:16: warning: offset of on non-standard-layout type 'js::BaseProxyHandler' [-Winvalid-offsetof]\r\n        return offsetof(BaseProxyHandler, mFamily);\r\n                       ^\r\n```\r\nAbove looks to be related to spidermonkey so I leave them for now.\r\n\r\nHowever, I addressed the second one in your list using f6830c9.\r\n\r\nAlso, thank you for involving more people on this PR. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565694853/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565735417","html_url":"https://github.com/apache/couchdb/pull/2362#issuecomment-565735417","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2362","id":565735417,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTczNTQxNw==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-14T17:15:21Z","updated_at":"2019-12-14T17:15:21Z","author_association":"MEMBER","body":"I'm +1 on this and, for me, the criteria to restore it is when it has parity with the javascript test suite, which would be removed from `make check` in the same commit as elixir test is added.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565735417/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565756818","html_url":"https://github.com/apache/couchdb/pull/2362#issuecomment-565756818","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2362","id":565756818,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTc1NjgxOA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-14T21:58:20Z","updated_at":"2019-12-14T21:58:20Z","author_association":"CONTRIBUTOR","body":"For EUnit tests we have up to 3 retries for individual apps when one fails. There are retries but EUnit tests usually end up passing.\r\n\r\nWould it be easy to do that for Elixir tests as well? Ideally we'd do it per test case, but per-suite or app might work as well.\r\n\r\nAnother observation is that Elixir tests run with 3 couch nodes, while Javascript tests with only one. On one hand it is a more realistic integration test, on the other, perhaps the extra two nodes is too much for Travis CI environment to handle and we can use one node there as well.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565756818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565760473","html_url":"https://github.com/apache/couchdb/pull/2362#issuecomment-565760473","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2362","id":565760473,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTc2MDQ3Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-14T22:58:11Z","updated_at":"2019-12-14T22:58:11Z","author_association":"MEMBER","body":"@nickva if you are willing to put up a 3x PR we can try it.\r\n\r\nTravis is no longer the target; this is failing repeatedly on our new Jenkins setup (which is still in alpha, until Infra gets our GitHub hooks setup.) The Jenkins nodes are in the IBM Cloud.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565760473/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565791317","html_url":"https://github.com/apache/couchdb/pull/2363#issuecomment-565791317","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2363","id":565791317,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTc5MTMxNw==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-15T09:15:28Z","updated_at":"2019-12-15T09:15:28Z","author_association":"MEMBER","body":"Tests passed first time on Travis 🎉 ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565791317/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565791384","html_url":"https://github.com/apache/couchdb/pull/2362#issuecomment-565791384","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2362","id":565791384,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTc5MTM4NA==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-15T09:16:35Z","updated_at":"2019-12-15T09:16:35Z","author_association":"MEMBER","body":"https://github.com/apache/couchdb/pull/2363 Changes the elixir tests to run with `n =1`. I would like to merge that in first before we resort to pulling the tests out completely","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565791384/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565838727","html_url":"https://github.com/apache/couchdb/pull/2363#issuecomment-565838727","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2363","id":565838727,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTgzODcyNw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-15T19:25:38Z","updated_at":"2019-12-15T19:25:38Z","author_association":"MEMBER","body":"@garrensmith temporary, or permanent change?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565838727/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565840986","html_url":"https://github.com/apache/couchdb/pull/2363#issuecomment-565840986","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2363","id":565840986,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTg0MDk4Ng==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-15T19:53:59Z","updated_at":"2019-12-15T19:53:59Z","author_association":"MEMBER","body":"This would be permanent\n\n\n________________________________\nFrom: Joan Touzet <notifications@github.com>\nSent: Sunday, December 15, 2019 9:25 PM\nTo: apache/couchdb\nCc: garren smith; Mention\nSubject: Re: [apache/couchdb] Switch make elixir to use n = 1 (#2363)\n\n\n@garrensmith<https://github.com/garrensmith> temporary, or permanent change?\n\n—\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub<https://github.com/apache/couchdb/pull/2363?email_source=notifications&email_token=AABL2AXOGJJOEZDNSKFD4C3QY2ADHA5CNFSM4J27CAYKYY3PNVWWK3TUL52HS4DFVREXG43VMVBW63LNMVXHJKTDN5WW2ZLOORPWSZGOEG5AHBY#issuecomment-565838727>, or unsubscribe<https://github.com/notifications/unsubscribe-auth/AABL2AQS4W3WAB5Q5ZZAECLQY2ADHANCNFSM4J27CAYA>.\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565840986/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565935790","html_url":"https://github.com/apache/couchdb/issues/1302#issuecomment-565935790","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1302","id":565935790,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTkzNTc5MA==","user":{"login":"snapo","id":6347922,"node_id":"MDQ6VXNlcjYzNDc5MjI=","avatar_url":"https://avatars.githubusercontent.com/u/6347922?v=4","gravatar_id":"","url":"https://api.github.com/users/snapo","html_url":"https://github.com/snapo","followers_url":"https://api.github.com/users/snapo/followers","following_url":"https://api.github.com/users/snapo/following{/other_user}","gists_url":"https://api.github.com/users/snapo/gists{/gist_id}","starred_url":"https://api.github.com/users/snapo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snapo/subscriptions","organizations_url":"https://api.github.com/users/snapo/orgs","repos_url":"https://api.github.com/users/snapo/repos","events_url":"https://api.github.com/users/snapo/events{/privacy}","received_events_url":"https://api.github.com/users/snapo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-16T07:19:33Z","updated_at":"2019-12-16T07:19:33Z","author_association":"NONE","body":"Hi,\r\nAdditional alerts from 8 other vendors:\r\nhttps://www.virustotal.com/gui/file/eee9c44c29c2be011f1f1e43bb8c3fca888cb81053022ec5a0060035de16d848/detection\r\n\r\nBest regards","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565935790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565948390","html_url":"https://github.com/apache/couchdb/pull/2357#issuecomment-565948390","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2357","id":565948390,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTk0ODM5MA==","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-16T08:01:10Z","updated_at":"2019-12-16T08:01:10Z","author_association":"MEMBER","body":"@garrensmith oops - should be okay now. I think this may still be needed in addition #2363 given the python-based Mango tests have always run with n=1 iirc.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565948390/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565977587","html_url":"https://github.com/apache/couchdb/issues/2191#issuecomment-565977587","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2191","id":565977587,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTk3NzU4Nw==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-16T09:28:15Z","updated_at":"2019-12-16T16:36:31Z","author_association":"MEMBER","body":"> Do we want to require that all writes to `_users` must be with admin creds or do we want to continue with the unique property of per-doc authorization?\r\n\r\nIn light of a “closed by default” security paradigm, I don’t see that the self-sign-up feature is something that should be on by default, but those who rely on this, should be able to opt into the old behaviour.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/565977587/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566122592","html_url":"https://github.com/apache/couchdb/pull/2363#issuecomment-566122592","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2363","id":566122592,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjEyMjU5Mg==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-16T15:58:15Z","updated_at":"2019-12-16T15:58:15Z","author_association":"MEMBER","body":"+1\r\n\r\nuntil we rewrite the tests to be specifically n>1 compatible, we should keep it as one.\r\n\r\ngoing to n=3 without rewriting the tests was aspirational at best","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566122592/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566139568","html_url":"https://github.com/apache/couchdb/issues/2191#issuecomment-566139568","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2191","id":566139568,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjEzOTU2OA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-16T16:37:30Z","updated_at":"2019-12-16T16:37:30Z","author_association":"MEMBER","body":"sorry, left out the conclusion in my last comment:\r\n\r\nI think just doing `admin_only` `_users` will be fine, folks will be able to disable it.\r\n\r\nits not great that they won't be able to disable it JUST for `_users`, but I can live with that if it means that all we do here is a config defaults change and no new code.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566139568/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566140433","html_url":"https://github.com/apache/couchdb/pull/2363#issuecomment-566140433","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2363","id":566140433,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjE0MDQzMw==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-16T16:39:26Z","updated_at":"2019-12-16T16:39:26Z","author_association":"MEMBER","body":"If the next release after 3.0 is with FDB, I don't think there would be much to gain by rewriting the tests to be n = 3.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566140433/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566142434","html_url":"https://github.com/apache/couchdb/pull/2358#issuecomment-566142434","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2358","id":566142434,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjE0MjQzNA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-16T16:44:15Z","updated_at":"2019-12-16T16:44:15Z","author_association":"MEMBER","body":"Also, I've tested this on the following Erlang versions:\r\n\r\n* 18.3.4.9\r\n* 19.3.6.8\r\n* 20.3.8.15\r\n* 21.2.2","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566142434/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566155201","html_url":"https://github.com/apache/couchdb/pull/2363#issuecomment-566155201","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2363","id":566155201,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjE1NTIwMQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-16T17:15:12Z","updated_at":"2019-12-16T17:15:12Z","author_association":"MEMBER","body":"there will absolutely be a 3.x chain for a while in parallel with 4.0; whether 3.1 predates or postdates 4.0 is anyone's guess at this point.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566155201/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566198101","html_url":"https://github.com/apache/couchdb/pull/2345#issuecomment-566198101","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2345","id":566198101,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjE5ODEwMQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-16T19:06:40Z","updated_at":"2019-12-16T19:06:40Z","author_association":"MEMBER","body":"I'll compile and run `make javascript` on both 1.8.5 and 60 and report back.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566198101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566232556","html_url":"https://github.com/apache/couchdb/pull/2366#issuecomment-566232556","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2366","id":566232556,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjIzMjU1Ng==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-16T20:37:13Z","updated_at":"2019-12-16T20:37:13Z","author_association":"MEMBER","body":"@eiri The pause if 5s, but during `make check` it ends up being run 60 times apparently.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566232556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566343259","html_url":"https://github.com/apache/couchdb/pull/2345#issuecomment-566343259","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2345","id":566343259,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjM0MzI1OQ==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-17T01:51:37Z","updated_at":"2019-12-17T01:51:37Z","author_association":"CONTRIBUTOR","body":"thanks @davisp. The javascript layout for spidermonkey 1.8.5 and 60 can be seen from https://github.com/apache/couchdb/pull/2345/files#diff-a28dc96b01dfdd66c40acdcc4704ea16R44. In general, there are 3 files to be changed in 1.8.5 for 60. They are not missing. I will try to see whether we can unify them today. Of course,  esprima.js and escodegen.js are only for spidermonkey 60.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566343259/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566426417","html_url":"https://github.com/apache/couchdb/pull/2293#issuecomment-566426417","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2293","id":566426417,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjQyNjQxNw==","user":{"login":"adrienverge","id":5244945,"node_id":"MDQ6VXNlcjUyNDQ5NDU=","avatar_url":"https://avatars.githubusercontent.com/u/5244945?v=4","gravatar_id":"","url":"https://api.github.com/users/adrienverge","html_url":"https://github.com/adrienverge","followers_url":"https://api.github.com/users/adrienverge/followers","following_url":"https://api.github.com/users/adrienverge/following{/other_user}","gists_url":"https://api.github.com/users/adrienverge/gists{/gist_id}","starred_url":"https://api.github.com/users/adrienverge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adrienverge/subscriptions","organizations_url":"https://api.github.com/users/adrienverge/orgs","repos_url":"https://api.github.com/users/adrienverge/repos","events_url":"https://api.github.com/users/adrienverge/events{/privacy}","received_events_url":"https://api.github.com/users/adrienverge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-17T07:54:56Z","updated_at":"2019-12-17T07:54:56Z","author_association":"CONTRIBUTOR","body":"Hi, all tests pass now :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566426417/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566436311","html_url":"https://github.com/apache/couchdb/pull/2362#issuecomment-566436311","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2362","id":566436311,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjQzNjMxMQ==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-17T08:26:15Z","updated_at":"2019-12-17T08:26:15Z","author_association":"MEMBER","body":"Closing because of #2363 ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566436311/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566513781","html_url":"https://github.com/apache/couchdb/pull/2345#issuecomment-566513781","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2345","id":566513781,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjUxMzc4MQ==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-17T12:05:38Z","updated_at":"2019-12-17T12:05:38Z","author_association":"CONTRIBUTOR","body":"hey Paul, @davisp I think that I addressed all existing comments from your side. Would you please take another look at them when getting time? The left is esprima.js and escodegen.js.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566513781/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566602209","html_url":"https://github.com/apache/couchdb/issues/1741#issuecomment-566602209","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1741","id":566602209,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjYwMjIwOQ==","user":{"login":"baptistedonaux","id":3277332,"node_id":"MDQ6VXNlcjMyNzczMzI=","avatar_url":"https://avatars.githubusercontent.com/u/3277332?v=4","gravatar_id":"","url":"https://api.github.com/users/baptistedonaux","html_url":"https://github.com/baptistedonaux","followers_url":"https://api.github.com/users/baptistedonaux/followers","following_url":"https://api.github.com/users/baptistedonaux/following{/other_user}","gists_url":"https://api.github.com/users/baptistedonaux/gists{/gist_id}","starred_url":"https://api.github.com/users/baptistedonaux/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baptistedonaux/subscriptions","organizations_url":"https://api.github.com/users/baptistedonaux/orgs","repos_url":"https://api.github.com/users/baptistedonaux/repos","events_url":"https://api.github.com/users/baptistedonaux/events{/privacy}","received_events_url":"https://api.github.com/users/baptistedonaux/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-17T15:52:58Z","updated_at":"2019-12-17T17:01:28Z","author_association":"NONE","body":"I have the same issue. This issue seems appears when few data into `_users` database have data with wrong scheme. An easy way to reproduce, it's to insert a user with minimum data (you can try to except `password` field) and constat.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566602209/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566683187","html_url":"https://github.com/apache/couchdb/pull/2370#issuecomment-566683187","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2370","id":566683187,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjY4MzE4Nw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-17T18:13:32Z","updated_at":"2019-12-17T18:13:32Z","author_association":"MEMBER","body":"These changes aren't useful so abandoning it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566683187/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566685473","html_url":"https://github.com/apache/couchdb/issues/2344#issuecomment-566685473","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2344","id":566685473,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjY4NTQ3Mw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-17T18:19:18Z","updated_at":"2019-12-17T18:19:18Z","author_association":"MEMBER","body":"That's my same read. Something with NFS has caused that `./data/shards/a0000000-bfffffff/_users.1570022815.couch` shard to become corrupted. Theoretically we could silence this warning but that strikes me as super not good as it'd cover up similar instances of data loss.\r\n\r\nThe quick fix would be to move that file aside and let internal replication rebuild it. Also if its not huge and doesn't contain sensitive data, it would be useful for us if it could be shared to try and get an idea of exactly how it might have been truncated.\r\n\r\nAlthough, running CouchDB on NFS is thoroughly discouraged so any investigation would mostly be only out of curiosity. I doubt we'd end up proposing any actual changes to the storage layer after an investigation.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566685473/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566686845","html_url":"https://github.com/apache/couchdb/issues/2348#issuecomment-566686845","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2348","id":566686845,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjY4Njg0NQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-17T18:22:31Z","updated_at":"2019-12-17T18:22:31Z","author_association":"MEMBER","body":"Can you verify that the design document signature has not changed before and after the PUT request? You could show this with something like:\r\n\r\n* `GET /dbname/_design/docid/_info`\r\n* `PUT /dbname/_design/docid`\r\n* `GET /dbnae/_design/docid/_info`\r\n\r\nThe `view_index.signature` should remain the same before and after. If it does, then also check to see if there are any errors in the logs around that time. Perhaps something crashes in an odd way that triggers the rebuild.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566686845/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566690257","html_url":"https://github.com/apache/couchdb/issues/2329#issuecomment-566690257","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2329","id":566690257,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjY5MDI1Nw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-17T18:30:47Z","updated_at":"2019-12-17T18:30:47Z","author_association":"MEMBER","body":"We're not trying to actively load balance here so it wouldn't make sense to add a parameter to disable anything. What ends up happening is that when we wait for quorum we essentially pick a random representative which may have references to attachments on a remote node.\r\n\r\nHowever, we could add some smarts in `fabric_doc_open` that could prefer to use a reply from the local node if it's part of the quorum response. It'd not be a non-trivial change as there's a bit of subtlety in that logic around what gets included as the quorum representative.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566690257/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566694685","html_url":"https://github.com/apache/couchdb/issues/2364#issuecomment-566694685","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2364","id":566694685,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjY5NDY4NQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-17T18:42:48Z","updated_at":"2019-12-17T18:42:48Z","author_association":"MEMBER","body":"Can you run `ldd bin/couchjs` to see what it thinks its linked to? If `libmozjs185.so.1.0` is in `/usr/local/lib` you may have to update `/etc/ld.so.conf` and run `ldconfig` to get those shared libraries updated.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566694685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566695451","html_url":"https://github.com/apache/couchdb/issues/2365#issuecomment-566695451","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2365","id":566695451,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjY5NTQ1MQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-17T18:44:51Z","updated_at":"2019-12-17T18:44:51Z","author_association":"MEMBER","body":"Would it be possible to enable core dumps for the beam.smp process? Erlang in general is designed to bail pretty hard if it encounters any error conditions and relies on being run under a service supervisor like upstart or runit.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566695451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566697019","html_url":"https://github.com/apache/couchdb/issues/2320#issuecomment-566697019","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2320","id":566697019,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjY5NzAxOQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-17T18:48:45Z","updated_at":"2019-12-17T18:48:45Z","author_association":"MEMBER","body":"This is an effect of quorum writes in a cluster. What happens during a clustered write is that the updates are sent to all nodes in the cluster and the responses are then collected and returned.\r\n\r\nIn your case what is happening is that you have two concurrent writes that are then distributed to all shard copies. Say you want to write both Rev1 and Rev2 concurrently. Depending on timing, those may arrive at nodes in different orders. I.e., node1 might see Rev1 first, while node2 might see `Rev2` first. In that case both updates will be accepted and the result would then be a conflict written on both nodes.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566697019/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566700644","html_url":"https://github.com/apache/couchdb/issues/2307#issuecomment-566700644","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2307","id":566700644,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjcwMDY0NA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-17T18:58:11Z","updated_at":"2019-12-17T18:58:11Z","author_association":"MEMBER","body":"Are you by chance storing your data directories on an NFS mount? There was a similar report recently that is similar to this.\r\n\r\nThe file `./data/shards/60000000-7fffffff/pt_2018_reports.1553264630.couch` appears to have been corrupted somehow. The easiest fix would be to move that file aside to something like `./data/shards/60000000-7fffffff/pt_2018_reports.1553264630.couch.old` and then let internal replication recreate it (which should happen automatically).\r\n\r\nIf you are using NFS then the long term fix would be to move your data directories to a locally mounted file system. NFS fakes POSIX compliance in ways that break the requirements for CouchDB.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566700644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566707179","html_url":"https://github.com/apache/couchdb/pull/2359#issuecomment-566707179","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2359","id":566707179,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjcwNzE3OQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-17T19:14:46Z","updated_at":"2019-12-17T19:14:46Z","author_association":"MEMBER","body":"I'm on board with this other than making it conditional. I'd remove the toggle and just run it regardless as it seems like good hygiene for those of us that skip around between major versions fairly often.\r\n\r\nThough that also assumes that its not super expensive though it doesn't look like it would be.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566707179/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566710386","html_url":"https://github.com/apache/couchdb/pull/2359#issuecomment-566710386","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2359","id":566710386,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjcxMDM4Ng==","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-17T19:23:04Z","updated_at":"2019-12-17T19:23:04Z","author_association":"CONTRIBUTOR","body":"@davisp I originally _did_ write it without the conditional, but became concerned about forcing a potentially expensive`find` (which I've since improved on by adding `-type dir`) on everyone each time it was run. Maybe more worrisome though, I'm not sure `find` is available on Windows, so it seemed best to make it optional, but figured adding it to `make dev` would probably hit most use cases. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566710386/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566711594","html_url":"https://github.com/apache/couchdb/issues/2303#issuecomment-566711594","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2303","id":566711594,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjcxMTU5NA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-17T19:25:54Z","updated_at":"2019-12-17T19:25:54Z","author_association":"MEMBER","body":"Hiya,\r\n\r\nAs long as you're paying attention to the HTTP status codes that CouchDB is sending you, you'll not lose any document updates. All that this metric is counting is when you've not gotten a quorum write for some identical reason across all replica responses.\r\n\r\nFor instance, you would see these errors if you attempted to update a document and it returned a `409 Conflict` response. You might also get them if a couple of your nodes are under load and not managing to keep internal replication up to date faster than your write load. In this case you would be seeing `202 Accepted` HTTP status codes indicating that a document was accepted by at least one node but not with an entire quorum. This means the document has been fsync'ed to disk and internal replication will eventually ensure that all `N` copies exist in the cluster.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566711594/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566712611","html_url":"https://github.com/apache/couchdb/issues/2294#issuecomment-566712611","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2294","id":566712611,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjcxMjYxMQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-17T19:28:15Z","updated_at":"2019-12-17T19:28:15Z","author_association":"MEMBER","body":"You mention the REST API as different from what you're using to make requests which has me confused.\r\n\r\nIf you want to ensure that a view response includes a write the easiest method is to add the `?w=3` request parameter so that you know it exists on all nodes before attempting the view read. A view response starts once all shard ranges have returned a response which means if a third copy has yet to fsync a document write its more likely to be the fastest response and included as part of the view output.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566712611/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566715538","html_url":"https://github.com/apache/couchdb/pull/2359#issuecomment-566715538","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2359","id":566715538,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjcxNTUzOA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-17T19:35:15Z","updated_at":"2019-12-17T19:35:15Z","author_association":"MEMBER","body":"Windows uses the `configure.ps1` command thingamajig so that shouldn't be an issue (cc @wohali). For the expensiveness I'm not overly concerned. But if you like then only adding it to `--dev` seems fine. I don't really see it useful as a standalone option cause I don't think it'd be an issue often enough to really get into muscle memory.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566715538/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566725649","html_url":"https://github.com/apache/couchdb/pull/2359#issuecomment-566725649","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2359","id":566725649,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NjcyNTY0OQ==","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-12-17T20:00:52Z","updated_at":"2019-12-17T20:00:52Z","author_association":"CONTRIBUTOR","body":"Great, let's make it non-optional since it's simpler.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/566725649/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]