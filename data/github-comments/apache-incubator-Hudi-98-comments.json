[{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755838339","html_url":"https://github.com/apache/hudi/issues/2409#issuecomment-755838339","issue_url":"https://api.github.com/repos/apache/hudi/issues/2409","id":755838339,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTgzODMzOQ==","user":{"login":"wosow","id":34565079,"node_id":"MDQ6VXNlcjM0NTY1MDc5","avatar_url":"https://avatars.githubusercontent.com/u/34565079?v=4","gravatar_id":"","url":"https://api.github.com/users/wosow","html_url":"https://github.com/wosow","followers_url":"https://api.github.com/users/wosow/followers","following_url":"https://api.github.com/users/wosow/following{/other_user}","gists_url":"https://api.github.com/users/wosow/gists{/gist_id}","starred_url":"https://api.github.com/users/wosow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wosow/subscriptions","organizations_url":"https://api.github.com/users/wosow/orgs","repos_url":"https://api.github.com/users/wosow/repos","events_url":"https://api.github.com/users/wosow/events{/privacy}","received_events_url":"https://api.github.com/users/wosow/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T02:14:44Z","updated_at":"2021-01-07T02:14:44Z","author_association":"NONE","body":"> can you copy the contents of hoodie.properties of the dataset here ?\r\nhoodie.properties as follows:\r\n[hoodie.zip](https://github.com/apache/hudi/files/5779109/hoodie.zip)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755838339/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755846060","html_url":"https://github.com/apache/hudi/issues/2100#issuecomment-755846060","issue_url":"https://api.github.com/repos/apache/hudi/issues/2100","id":755846060,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTg0NjA2MA==","user":{"login":"cdmikechen","id":12069428,"node_id":"MDQ6VXNlcjEyMDY5NDI4","avatar_url":"https://avatars.githubusercontent.com/u/12069428?v=4","gravatar_id":"","url":"https://api.github.com/users/cdmikechen","html_url":"https://github.com/cdmikechen","followers_url":"https://api.github.com/users/cdmikechen/followers","following_url":"https://api.github.com/users/cdmikechen/following{/other_user}","gists_url":"https://api.github.com/users/cdmikechen/gists{/gist_id}","starred_url":"https://api.github.com/users/cdmikechen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdmikechen/subscriptions","organizations_url":"https://api.github.com/users/cdmikechen/orgs","repos_url":"https://api.github.com/users/cdmikechen/repos","events_url":"https://api.github.com/users/cdmikechen/events{/privacy}","received_events_url":"https://api.github.com/users/cdmikechen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T02:40:18Z","updated_at":"2021-01-07T02:40:18Z","author_association":"CONTRIBUTOR","body":"@vinothchandar Yes! I deployed the timeline server separately on its own and let multiple hudi services use this timeline server.\r\n\r\nI used an unified timeline server to obtain hudi metadata and hudi task timeline on some customized services in dev and test environments. \r\nAt the same time, when the spark service is deployed in k8s environment, there will be some host problems when using the built-in timeline server under specific circumstances. So that I had to deploy the timeline server separately.\r\nAnother reason is that I'm considering doing some work about hudi-ui this year. I feel that the independent timeline service may be helpful in identifying hudi tables in a cluster.\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755846060/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755857098","html_url":"https://github.com/apache/hudi/pull/2413#issuecomment-755857098","issue_url":"https://api.github.com/repos/apache/hudi/issues/2413","id":755857098,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTg1NzA5OA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T03:20:59Z","updated_at":"2021-01-07T03:20:59Z","author_association":"MEMBER","body":"Yes. Correct. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755857098/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755870995","html_url":"https://github.com/apache/hudi/issues/2409#issuecomment-755870995","issue_url":"https://api.github.com/repos/apache/hudi/issues/2409","id":755870995,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTg3MDk5NQ==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T04:10:48Z","updated_at":"2021-01-07T04:10:48Z","author_association":"CONTRIBUTOR","body":"It is indeed a MOR table.Can you check your driver logs. You might find some exceptions around registering _rt table. You can look for logs around the log message \r\n\r\n\"Trying to sync hoodie table \"\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755870995/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755871276","html_url":"https://github.com/apache/hudi/issues/2406#issuecomment-755871276","issue_url":"https://api.github.com/repos/apache/hudi/issues/2406","id":755871276,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTg3MTI3Ng==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T04:11:52Z","updated_at":"2021-01-07T04:11:52Z","author_association":"CONTRIBUTOR","body":"No worries. Should be fine to keep this open","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755871276/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755878176","html_url":"https://github.com/apache/hudi/pull/2410#issuecomment-755878176","issue_url":"https://api.github.com/repos/apache/hudi/issues/2410","id":755878176,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTg3ODE3Ng==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T04:36:54Z","updated_at":"2021-01-07T04:36:54Z","author_association":"CONTRIBUTOR","body":"I agree with this operation so as not to block work progress. However, I always feel that in terms of project layout, if we treat writing or reading (or call it query) equally, it will be clearer. Currently, we clearly define the \"client\" as a writing client. On the query side, just use the ability of an external engine. However, if we hope to introduce a native java query client and a native Python query client in the future, how will we consider their location? Also, if you consider introducing file-level APIs. How to state more clearly and intuitively: `common`, `client`, `write`, `query`(`read`), `engine`...?\r\n\r\nI always think that introducing query-side things into common is not elegant enough. Although Hudi is just a library, we can also regard it as a \"service\" in the future. For any service, `Input` and `Output` are clear and equivalent.\r\n\r\nOf course, we can discuss these in-depth in the future. For now, let us merge it and complete the work.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755878176/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755879362","html_url":"https://github.com/apache/hudi/pull/2111#issuecomment-755879362","issue_url":"https://api.github.com/repos/apache/hudi/issues/2111","id":755879362,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTg3OTM2Mg==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T04:40:41Z","updated_at":"2021-01-07T04:40:41Z","author_association":"CONTRIBUTOR","body":"@vinothchandar : I have updated the patch as requested. Mid way in fixing tests(fixed some and ensured that both old and new code path works as expected though). But in the mean time, if you can review source code, would appreciate. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755879362/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755894869","html_url":"https://github.com/apache/hudi/issues/2409#issuecomment-755894869","issue_url":"https://api.github.com/repos/apache/hudi/issues/2409","id":755894869,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTg5NDg2OQ==","user":{"login":"wosow","id":34565079,"node_id":"MDQ6VXNlcjM0NTY1MDc5","avatar_url":"https://avatars.githubusercontent.com/u/34565079?v=4","gravatar_id":"","url":"https://api.github.com/users/wosow","html_url":"https://github.com/wosow","followers_url":"https://api.github.com/users/wosow/followers","following_url":"https://api.github.com/users/wosow/following{/other_user}","gists_url":"https://api.github.com/users/wosow/gists{/gist_id}","starred_url":"https://api.github.com/users/wosow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wosow/subscriptions","organizations_url":"https://api.github.com/users/wosow/orgs","repos_url":"https://api.github.com/users/wosow/repos","events_url":"https://api.github.com/users/wosow/events{/privacy}","received_events_url":"https://api.github.com/users/wosow/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T05:32:25Z","updated_at":"2021-01-07T05:35:27Z","author_association":"NONE","body":"> It is indeed a MOR table.Can you check your driver logs. You might find some exceptions around registering _rt table. You can look for logs around the log message\r\n> \r\n> \"Trying to sync hoodie table \"\r\n\r\nerror as follows:\r\nthere is no sql about  creating _rt table , only _ro table\r\n```\r\n----------------------------------------------------------------------------------------------------------------------------------------------\r\n21/01/07 13:23:05 INFO ContextCleaner: Cleaned accumulator 371\r\n21/01/07 13:23:05 INFO ContextCleaner: Cleaned accumulator 337\r\n21/01/07 13:23:05 INFO ContextCleaner: Cleaned accumulator 404\r\n21/01/07 13:23:05 INFO BlockManagerInfo: Removed broadcast_16_piece0 on bigdatadev03:18850 in memory (size: 73.0 KB, free: 2.5 GB)\r\n21/01/07 13:23:05 INFO BlockManagerInfo: Removed broadcast_16_piece0 on bigdatadev02:6815 in memory (size: 73.0 KB, free: 3.5 GB)\r\n21/01/07 13:23:05 INFO ContextCleaner: Cleaned accumulator 333\r\n21/01/07 13:23:05 INFO ContextCleaner: Cleaned accumulator 418\r\n21/01/07 13:23:05 INFO ContextCleaner: Cleaned accumulator 385\r\n21/01/07 13:23:05 INFO ContextCleaner: Cleaned accumulator 410\r\n21/01/07 13:23:08 INFO Datastore: The class \"org.apache.hadoop.hive.metastore.model.MFieldSchema\" is tagged as \"embedded-only\" so does not have its own datastore table.\r\n21/01/07 13:23:08 INFO Datastore: The class \"org.apache.hadoop.hive.metastore.model.MOrder\" is tagged as \"embedded-only\" so does not have its own datastore table.\r\n21/01/07 13:23:10 INFO Datastore: The class \"org.apache.hadoop.hive.metastore.model.MFieldSchema\" is tagged as \"embedded-only\" so does not have its own datastore table.\r\n21/01/07 13:23:10 INFO Datastore: The class \"org.apache.hadoop.hive.metastore.model.MOrder\" is tagged as \"embedded-only\" so does not have its own datastore table.\r\n21/01/07 13:23:10 INFO Query: Reading in results for query \"org.datanucleus.store.rdbms.query.SQLQuery@0\" since the connection used is closing\r\n21/01/07 13:23:10 INFO MetaStoreDirectSql: Using direct SQL, underlying DB is MYSQL\r\n21/01/07 13:23:10 INFO ObjectStore: Initialized ObjectStore\r\n21/01/07 13:23:11 INFO HiveMetaStore: Added admin role in metastore\r\n21/01/07 13:23:11 INFO HiveMetaStore: Added public role in metastore\r\n21/01/07 13:23:11 INFO HiveMetaStore: No user is added in admin role, since config is empty\r\n21/01/07 13:23:11 INFO HiveMetaStore: 0: get_all_databases\r\n21/01/07 13:23:11 INFO audit: ugi=root\tip=unknown-ip-addr\tcmd=get_all_databases\t\r\n21/01/07 13:23:11 INFO HiveMetaStore: 0: get_functions: db=default pat=*\r\n21/01/07 13:23:11 INFO audit: ugi=root\tip=unknown-ip-addr\tcmd=get_functions: db=default pat=*\t\r\n21/01/07 13:23:11 INFO Datastore: The class \"org.apache.hadoop.hive.metastore.model.MResourceUri\" is tagged as \"embedded-only\" so does not have its own datastore table.\r\n21/01/07 13:23:11 INFO HiveMetaStore: 0: get_functions: db=dw pat=*\r\n21/01/07 13:23:11 INFO audit: ugi=root\tip=unknown-ip-addr\tcmd=get_functions: db=dw pat=*\t\r\n21/01/07 13:23:11 INFO HiveSyncTool: Trying to sync hoodie table api_trade_ro with base path /data/stream/mor/api_trade of type MERGE_ON_READ\r\n21/01/07 13:23:11 INFO HiveMetaStore: 0: get_table : db=ads tbl=api_trade_ro\r\n21/01/07 13:23:11 INFO audit: ugi=root\tip=unknown-ip-addr\tcmd=get_table : db=ads tbl=api_trade_ro\t\r\n21/01/07 13:23:11 INFO HoodieHiveClient: Found the last compaction commit as Option{val=null}\r\n21/01/07 13:23:11 INFO HoodieHiveClient: Found the last delta commit Option{val=[20210107132154__deltacommit__COMPLETED]}\r\n21/01/07 13:23:12 INFO HoodieHiveClient: Reading schema from /data/stream/mor/api_trade/dt=2021-01/350a9a01-538c-4a7e-8c17-09d2cdc85073-0_0-20-85_20210107132154.parquet\r\n21/01/07 13:23:12 INFO HiveSyncTool: Hive table api_trade_ro is not found. Creating it\r\n21/01/07 13:23:12 INFO HoodieHiveClient: Creating table with CREATE EXTERNAL TABLE  IF NOT EXISTS `ads`.`api_trade_ro`( `_hoodie_commit_time` string, `_hoodie_commit_seqno` string, `_hoodie_record_key` string, `_hoodie_partition_path` string, `_hoodie_file_name` string, `topic` string, `kafka_partition` string, `kafka_timestamp` string, `kafka_offset` string, `current_time` string, `kafka_key` string, `kafka_value` string,  `modified` string, `created` string, `batch_time` string) PARTITIONED BY (`dt` string) ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' STORED AS INPUTFORMAT 'org.apache.hudi.hadoop.HoodieParquetInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat' LOCATION '/data/stream/mor/api_trade'\r\n21/01/07 13:23:12 INFO HoodieHiveClient: Executing SQL CREATE EXTERNAL TABLE  IF NOT EXISTS `ads`.`api_trade_ro`( `_hoodie_commit_time` string, `_hoodie_commit_seqno` string, `_hoodie_record_key` string, `_hoodie_partition_path` string, `_hoodie_file_name` string, `topic` string, `kafka_partition` string, `kafka_timestamp` string, `kafka_offset` string, `current_time` string, `kafka_key` string, `kafka_value` string,  `modified` string, `created` string, `batch_time` string) PARTITIONED BY (`dt` string) ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' STORED AS INPUTFORMAT 'org.apache.hudi.hadoop.HoodieParquetInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat' LOCATION '/data/stream/mor/api_trade'\r\n21/01/07 13:24:09 INFO HiveSyncTool: Schema sync complete. Syncing partitions for api_trade_ro\r\n21/01/07 13:24:09 INFO HiveSyncTool: Last commit time synced was found to be null\r\n21/01/07 13:24:09 INFO HoodieHiveClient: Last commit time synced is not known, listing all partitions in /data/stream/mor/api_trade,FS :DFS[DFSClient[clientName=DFSClient_NONMAPREDUCE_-398057260_1, ugi=root (auth:SIMPLE)]]\r\n21/01/07 13:24:09 INFO HiveSyncTool: Storage partitions scan complete. Found 1\r\n21/01/07 13:24:09 INFO HiveMetaStore: 0: get_partitions : db=ads tbl=api_trade_ro\r\n21/01/07 13:24:09 INFO audit: ugi=root\tip=unknown-ip-addr\tcmd=get_partitions : db=ads tbl=api_trade_ro\t\r\n21/01/07 13:24:10 INFO HiveSyncTool: New Partitions [dt=2021-01]\r\n21/01/07 13:24:10 INFO HoodieHiveClient: Adding partitions 1 to table api_trade_ro\r\n21/01/07 13:24:10 INFO HoodieHiveClient: Executing SQL ALTER TABLE `ads`.`api_trade_ro` ADD IF NOT EXISTS   PARTITION (`dt`='2021-01') LOCATION '/data/stream/mor/api_trade/dt=2021-01' \r\n21/01/07 13:24:33 INFO HiveSyncTool: Changed Partitions []\r\n21/01/07 13:24:33 INFO HoodieHiveClient: No partitions to change for api_trade_ro\r\n21/01/07 13:24:33 INFO HiveMetaStore: 0: get_table : db=ads tbl=api_trade_ro\r\n21/01/07 13:24:33 INFO audit: ugi=root\tip=unknown-ip-addr\tcmd=get_table : db=ads tbl=api_trade_ro\t\r\n21/01/07 13:24:33 ERROR HiveSyncTool: Got runtime exception when hive syncing\r\norg.apache.hudi.hive.HoodieHiveSyncException: Failed to get update last commit time synced to 20210107132154\r\n\tat org.apache.hudi.hive.HoodieHiveClient.updateLastCommitTimeSynced(HoodieHiveClient.java:658)\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncHoodieTable(HiveSyncTool.java:128)\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncHoodieTable(HiveSyncTool.java:91)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.syncHive(HoodieSparkSqlWriter.scala:229)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.checkWriteStatus(HoodieSparkSqlWriter.scala:279)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.write(HoodieSparkSqlWriter.scala:184)\r\n\tat org.apache.hudi.DefaultSource.createRelation(DefaultSource.scala:91)\r\n\tat org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:45)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:86)\r\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:131)\r\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:127)\r\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:155)\r\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\r\n\tat org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)\r\n\tat org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)\r\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:80)\r\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:80)\r\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:676)\r\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:676)\r\n\tat org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1.apply(SQLExecution.scala:78)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:125)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:73)\r\n\tat org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:676)\r\n\tat org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:285)\r\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:271)\r\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:229)\r\n\tat com.chin.dmp.stream.mor.ApiTradeStream$$anonfun$1.apply(ApiTradeStream.scala:196)\r\n\tat com.chin.dmp.stream.mor.ApiTradeStream$$anonfun$1.apply(ApiTradeStream.scala:163)\r\n\tat org.apache.spark.sql.execution.streaming.sources.ForeachBatchSink.addBatch(ForeachBatchSink.scala:35)\r\n\tat org.apache.spark.sql.execution.streaming.MicroBatchExecution$$anonfun$org$apache$spark$sql$execution$streaming$MicroBatchExecution$$runBatch$5$$anonfun$apply$17.apply(MicroBatchExecution.scala:537)\r\n\tat org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1.apply(SQLExecution.scala:78)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:125)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:73)\r\n\tat org.apache.spark.sql.execution.streaming.MicroBatchExecution$$anonfun$org$apache$spark$sql$execution$streaming$MicroBatchExecution$$runBatch$5.apply(MicroBatchExecution.scala:535)\r\n\tat org.apache.spark.sql.execution.streaming.ProgressReporter$class.reportTimeTaken(ProgressReporter.scala:351)\r\n\tat org.apache.spark.sql.execution.streaming.StreamExecution.reportTimeTaken(StreamExecution.scala:58)\r\n\tat org.apache.spark.sql.execution.streaming.MicroBatchExecution.org$apache$spark$sql$execution$streaming$MicroBatchExecution$$runBatch(MicroBatchExecution.scala:534)\r\n\tat org.apache.spark.sql.execution.streaming.MicroBatchExecution$$anonfun$runActivatedStream$1$$anonfun$apply$mcZ$sp$1.apply$mcV$sp(MicroBatchExecution.scala:198)\r\n\tat org.apache.spark.sql.execution.streaming.MicroBatchExecution$$anonfun$runActivatedStream$1$$anonfun$apply$mcZ$sp$1.apply(MicroBatchExecution.scala:166)\r\n\tat org.apache.spark.sql.execution.streaming.MicroBatchExecution$$anonfun$runActivatedStream$1$$anonfun$apply$mcZ$sp$1.apply(MicroBatchExecution.scala:166)\r\n\tat org.apache.spark.sql.execution.streaming.ProgressReporter$class.reportTimeTaken(ProgressReporter.scala:351)\r\n\tat org.apache.spark.sql.execution.streaming.StreamExecution.reportTimeTaken(StreamExecution.scala:58)\r\n\tat org.apache.spark.sql.execution.streaming.MicroBatchExecution$$anonfun$runActivatedStream$1.apply$mcZ$sp(MicroBatchExecution.scala:166)\r\n\tat org.apache.spark.sql.execution.streaming.ProcessingTimeExecutor.execute(TriggerExecutor.scala:56)\r\n\tat org.apache.spark.sql.execution.streaming.MicroBatchExecution.runActivatedStream(MicroBatchExecution.scala:160)\r\n\tat org.apache.spark.sql.execution.streaming.StreamExecution.org$apache$spark$sql$execution$streaming$StreamExecution$$runStream(StreamExecution.scala:281)\r\n\tat org.apache.spark.sql.execution.streaming.StreamExecution$$anon$1.run(StreamExecution.scala:193)\r\nCaused by: NoSuchObjectException(message:ads.api_trade_ro table not found)\r\n\tat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.get_table_core(HiveMetaStore.java:1808)\r\n\tat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.get_table(HiveMetaStore.java:1778)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:107)\r\n\tat com.sun.proxy.$Proxy41.get_table(Unknown Source)\r\n\tat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.getTable(HiveMetaStoreClient.java:1208)\r\n\tat org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.getTable(SessionHiveMetaStoreClient.java:131)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:156)\r\n\tat com.sun.proxy.$Proxy42.getTable(Unknown Source)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.updateLastCommitTimeSynced(HoodieHiveClient.java:654)\r\n\t... 48 more\r\n21/01/07 13:24:33 INFO HiveMetaStore: 0: Shutting down the object store...\r\n21/01/07 13:24:33 INFO audit: ugi=root\tip=unknown-ip-addr\tcmd=Shutting down the object store...\t\r\n21/01/07 13:24:33 INFO HiveMetaStore: 0: Metastore shutdown complete.\r\n21/01/07 13:24:33 INFO audit: ugi=root\tip=unknown-ip-addr\tcmd=Metastore shutdown complete.\t\r\n21/01/07 13:24:33 INFO DefaultSource: Constructing hoodie (as parquet) data source with options :Map(hoodie.datasource.write.insert.drop.duplicates -> false, hoodie.datasource.hive_sync.database -> ads, hoodie.insert.shuffle.parallelism -> 10, path -> /data/stream/mor/api_trade, hoodie.datasource.write.precombine.field -> modified, hoodie.datasource.hive_sync.partition_fields -> dt, hoodie.datasource.write.payload.class -> org.apache.hudi.common.model.OverwriteWithLatestAvroPayload, hoodie.datasource.hive_sync.partition_extractor_class -> org.apache.hudi.hive.MultiPartKeysValueExtractor, hoodie.datasource.write.streaming.retry.interval.ms -> 2000, hoodie.datasource.hive_sync.table -> api_trade, hoodie.index.type -> GLOBAL_BLOOM, hoodie.datasource.write.streaming.ignore.failed.batch -> true, hoodie.datasource.write.operation -> upsert, hoodie.datasource.hive_sync.enable -> true, hoodie.datasource.write.recordkey.field -> id, hoodie.table.name -> api_trade, hoodie.datasource.hive_sync.jdbcurl -> jdbc:hive2://0.0.0.0:10000, hoodie.datasource.write.table.type -> MERGE_ON_READ, hoodie.datasource.write.hive_style_partitioning -> true, hoodie.datasource.query.type -> snapshot, hoodie.bloom.index.update.partition.path -\r\n----------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755894869/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755922887","html_url":"https://github.com/apache/hudi/pull/2413#issuecomment-755922887","issue_url":"https://api.github.com/repos/apache/hudi/issues/2413","id":755922887,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTkyMjg4Nw==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T06:48:11Z","updated_at":"2021-01-07T06:48:11Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2413?src=pr&el=h1) Report\n> Merging [#2413](https://codecov.io/gh/apache/hudi/pull/2413?src=pr&el=desc) (f9992fd) into [master](https://codecov.io/gh/apache/hudi/commit/698694a1571cdcc9848fc79aa34c8cbbf9662bc4?el=desc) (698694a) will **decrease** coverage by `40.19%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2413/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2413?src=pr&el=tree)\n\n```diff\n@@              Coverage Diff              @@\n##             master    #2413       +/-   ##\n=============================================\n- Coverage     50.23%   10.04%   -40.20%     \n+ Complexity     2985       48     -2937     \n=============================================\n  Files           410       52      -358     \n  Lines         18398     1852    -16546     \n  Branches       1884      223     -1661     \n=============================================\n- Hits           9242      186     -9056     \n+ Misses         8398     1653     -6745     \n+ Partials        758       13      -745     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `10.04% <ø> (-59.62%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2413?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...va/org/apache/hudi/utilities/IdentitySplitter.java](https://codecov.io/gh/apache/hudi/pull/2413/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0lkZW50aXR5U3BsaXR0ZXIuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-2.00%)` | |\n| [...va/org/apache/hudi/utilities/schema/SchemaSet.java](https://codecov.io/gh/apache/hudi/pull/2413/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFTZXQuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-3.00%)` | |\n| [...a/org/apache/hudi/utilities/sources/RowSource.java](https://codecov.io/gh/apache/hudi/pull/2413/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUm93U291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [.../org/apache/hudi/utilities/sources/AvroSource.java](https://codecov.io/gh/apache/hudi/pull/2413/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQXZyb1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [.../org/apache/hudi/utilities/sources/JsonSource.java](https://codecov.io/gh/apache/hudi/pull/2413/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvblNvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [...rg/apache/hudi/utilities/sources/CsvDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2413/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQ3N2REZTU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-10.00%)` | |\n| [...g/apache/hudi/utilities/sources/JsonDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2413/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkRGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [...apache/hudi/utilities/sources/JsonKafkaSource.java](https://codecov.io/gh/apache/hudi/pull/2413/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkthZmthU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-6.00%)` | |\n| [...pache/hudi/utilities/sources/ParquetDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2413/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUGFycXVldERGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-5.00%)` | |\n| [...lities/schema/SchemaProviderWithPostProcessor.java](https://codecov.io/gh/apache/hudi/pull/2413/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFQcm92aWRlcldpdGhQb3N0UHJvY2Vzc29yLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| ... and [387 more](https://codecov.io/gh/apache/hudi/pull/2413/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755922887/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755936804","html_url":"https://github.com/apache/hudi/pull/2410#issuecomment-755936804","issue_url":"https://api.github.com/repos/apache/hudi/issues/2410","id":755936804,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTkzNjgwNA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T07:22:42Z","updated_at":"2021-01-07T07:22:42Z","author_association":"MEMBER","body":"@yanghua I agree with you mostly. lets rethink our structure more holsitically. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755936804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755937041","html_url":"https://github.com/apache/hudi/pull/2410#issuecomment-755937041","issue_url":"https://api.github.com/repos/apache/hudi/issues/2410","id":755937041,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTkzNzA0MQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T07:23:15Z","updated_at":"2021-01-07T07:23:15Z","author_association":"MEMBER","body":"@umehrot2 should we first merge this and do the actual fixes on top as a separarte PR? if so, please feel free to land this","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755937041/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755953071","html_url":"https://github.com/apache/hudi/pull/1938#issuecomment-755953071","issue_url":"https://api.github.com/repos/apache/hudi/issues/1938","id":755953071,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTk1MzA3MQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T08:00:44Z","updated_at":"2021-01-07T08:00:44Z","author_association":"MEMBER","body":"@garyli1019 any hopes for this PR to be completed in the next day or so? :) ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755953071/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755955479","html_url":"https://github.com/apache/hudi/pull/1938#issuecomment-755955479","issue_url":"https://api.github.com/repos/apache/hudi/issues/1938","id":755955479,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTk1NTQ3OQ==","user":{"login":"garyli1019","id":23007841,"node_id":"MDQ6VXNlcjIzMDA3ODQx","avatar_url":"https://avatars.githubusercontent.com/u/23007841?v=4","gravatar_id":"","url":"https://api.github.com/users/garyli1019","html_url":"https://github.com/garyli1019","followers_url":"https://api.github.com/users/garyli1019/followers","following_url":"https://api.github.com/users/garyli1019/following{/other_user}","gists_url":"https://api.github.com/users/garyli1019/gists{/gist_id}","starred_url":"https://api.github.com/users/garyli1019/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garyli1019/subscriptions","organizations_url":"https://api.github.com/users/garyli1019/orgs","repos_url":"https://api.github.com/users/garyli1019/repos","events_url":"https://api.github.com/users/garyli1019/events{/privacy}","received_events_url":"https://api.github.com/users/garyli1019/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T08:05:55Z","updated_at":"2021-01-07T08:05:55Z","author_association":"MEMBER","body":"> @garyli1019 any hopes for this PR to be completed in the next day or so? :)\r\n\r\n@vinothchandar The current version should work with the newer version commit file, but I haven't added the option to merge with the parquet file as we discussed in the meeting. Would you do a round of review? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755955479/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755962801","html_url":"https://github.com/apache/hudi/pull/1938#issuecomment-755962801","issue_url":"https://api.github.com/repos/apache/hudi/issues/1938","id":755962801,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTk2MjgwMQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T08:22:09Z","updated_at":"2021-01-07T08:22:09Z","author_association":"MEMBER","body":"Sounds good. Will do a review, morning time PST. \r\nCould you please check why CI is unhappy","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755962801/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755963403","html_url":"https://github.com/apache/hudi/pull/1938#issuecomment-755963403","issue_url":"https://api.github.com/repos/apache/hudi/issues/1938","id":755963403,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTk2MzQwMw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T08:23:28Z","updated_at":"2021-01-07T08:23:28Z","author_association":"MEMBER","body":"```\r\n[INFO] \r\n[ERROR] Failures: \r\n[ERROR]   TestMORDataSource.testCount:309 expected: <142> but was: <138>\r\n```\r\nseems related?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/755963403/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756127108","html_url":"https://github.com/apache/hudi/pull/2111#issuecomment-756127108","issue_url":"https://api.github.com/repos/apache/hudi/issues/2111","id":756127108,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NjEyNzEwOA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T13:48:50Z","updated_at":"2021-01-07T13:48:50Z","author_association":"CONTRIBUTOR","body":"@vinothchandar : have fixed tests as well. you are good to review. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756127108/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756173953","html_url":"https://github.com/apache/hudi/pull/1938#issuecomment-756173953","issue_url":"https://api.github.com/repos/apache/hudi/issues/1938","id":756173953,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NjE3Mzk1Mw==","user":{"login":"garyli1019","id":23007841,"node_id":"MDQ6VXNlcjIzMDA3ODQx","avatar_url":"https://avatars.githubusercontent.com/u/23007841?v=4","gravatar_id":"","url":"https://api.github.com/users/garyli1019","html_url":"https://github.com/garyli1019","followers_url":"https://api.github.com/users/garyli1019/followers","following_url":"https://api.github.com/users/garyli1019/following{/other_user}","gists_url":"https://api.github.com/users/garyli1019/gists{/gist_id}","starred_url":"https://api.github.com/users/garyli1019/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garyli1019/subscriptions","organizations_url":"https://api.github.com/users/garyli1019/orgs","repos_url":"https://api.github.com/users/garyli1019/repos","events_url":"https://api.github.com/users/garyli1019/events{/privacy}","received_events_url":"https://api.github.com/users/garyli1019/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T15:08:58Z","updated_at":"2021-01-07T15:08:58Z","author_association":"MEMBER","body":"> ```\r\n> [INFO] \r\n> [ERROR] Failures: \r\n> [ERROR]   TestMORDataSource.testCount:309 expected: <142> but was: <138>\r\n> ```\r\n> \r\n> seems related?\r\n\r\nhmm, the test was passed in my local. The last time when we were working on the MOR data source, we saw the same thing happened that Travis and local are producing different results. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756173953/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756177087","html_url":"https://github.com/apache/hudi/pull/2415#issuecomment-756177087","issue_url":"https://api.github.com/repos/apache/hudi/issues/2415","id":756177087,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NjE3NzA4Nw==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T15:13:57Z","updated_at":"2021-01-07T15:13:57Z","author_association":"CONTRIBUTOR","body":"@wangxianghu Tiger brother, please help to review, thanks.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756177087/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756264377","html_url":"https://github.com/apache/hudi/pull/1938#issuecomment-756264377","issue_url":"https://api.github.com/repos/apache/hudi/issues/1938","id":756264377,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NjI2NDM3Nw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T17:32:54Z","updated_at":"2021-01-07T17:32:54Z","author_association":"MEMBER","body":">hmm, the test was passed in my local. \r\n\r\ntypically, if the test depends on some aspect of the data generated, then it can pass locally and fail in CI, because the random number seed used for data generation is different. Otherwise, it should pass. esp for checking counts etc. I have not seen it being flaky for other reasons.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756264377/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756289589","html_url":"https://github.com/apache/hudi/issues/2408#issuecomment-756289589","issue_url":"https://api.github.com/repos/apache/hudi/issues/2408","id":756289589,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NjI4OTU4OQ==","user":{"login":"jtmzheng","id":3466206,"node_id":"MDQ6VXNlcjM0NjYyMDY=","avatar_url":"https://avatars.githubusercontent.com/u/3466206?v=4","gravatar_id":"","url":"https://api.github.com/users/jtmzheng","html_url":"https://github.com/jtmzheng","followers_url":"https://api.github.com/users/jtmzheng/followers","following_url":"https://api.github.com/users/jtmzheng/following{/other_user}","gists_url":"https://api.github.com/users/jtmzheng/gists{/gist_id}","starred_url":"https://api.github.com/users/jtmzheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtmzheng/subscriptions","organizations_url":"https://api.github.com/users/jtmzheng/orgs","repos_url":"https://api.github.com/users/jtmzheng/repos","events_url":"https://api.github.com/users/jtmzheng/events{/privacy}","received_events_url":"https://api.github.com/users/jtmzheng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T18:17:02Z","updated_at":"2021-01-07T18:17:02Z","author_association":"NONE","body":"Thank you, I have also tried setting `hoodie.write.buffer.limit.bytes` as per https://github.com/apache/hudi/issues/1491#issuecomment-610626104 but it still OOMs in same way (this config seems undocumented and defaults to 4*1024*1024 bytes, not sure the rationale on changing it to 131072 as per that comment)","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756289589/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756403172","html_url":"https://github.com/apache/hudi/issues/2416#issuecomment-756403172","issue_url":"https://api.github.com/repos/apache/hudi/issues/2416","id":756403172,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NjQwMzE3Mg==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T21:42:35Z","updated_at":"2021-01-07T21:42:35Z","author_association":"MEMBER","body":"We will have 0.7.0 out next week.  Is there a specific feature you are looking for?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756403172/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756485939","html_url":"https://github.com/apache/hudi/issues/2338#issuecomment-756485939","issue_url":"https://api.github.com/repos/apache/hudi/issues/2338","id":756485939,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NjQ4NTkzOQ==","user":{"login":"so-lazy","id":56884416,"node_id":"MDQ6VXNlcjU2ODg0NDE2","avatar_url":"https://avatars.githubusercontent.com/u/56884416?v=4","gravatar_id":"","url":"https://api.github.com/users/so-lazy","html_url":"https://github.com/so-lazy","followers_url":"https://api.github.com/users/so-lazy/followers","following_url":"https://api.github.com/users/so-lazy/following{/other_user}","gists_url":"https://api.github.com/users/so-lazy/gists{/gist_id}","starred_url":"https://api.github.com/users/so-lazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/so-lazy/subscriptions","organizations_url":"https://api.github.com/users/so-lazy/orgs","repos_url":"https://api.github.com/users/so-lazy/repos","events_url":"https://api.github.com/users/so-lazy/events{/privacy}","received_events_url":"https://api.github.com/users/so-lazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-08T01:19:13Z","updated_at":"2021-01-08T01:19:13Z","author_association":"NONE","body":"> @so-lazy : I think the hive table may not be a hudi table. can you show the output of the following hive command ?\r\n> \r\n> desc formatted table\r\n> \r\n> Also, can you please attach the listing of .hoodie folder ?\r\n> \r\n> Thanks,\r\n> Balaji.V\r\n\r\n@bvaradar Here are my table desc and .hoodie folder, thanks so much.\r\n[desc table.txt](https://github.com/apache/hudi/files/5784674/desc.table.txt)\r\n[hoodie.tar.gz](https://github.com/apache/hudi/files/5784676/hoodie.tar.gz)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756485939/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756515101","html_url":"https://github.com/apache/hudi/pull/2111#issuecomment-756515101","issue_url":"https://api.github.com/repos/apache/hudi/issues/2111","id":756515101,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NjUxNTEwMQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-08T02:54:39Z","updated_at":"2021-01-08T02:54:39Z","author_association":"MEMBER","body":"@nsivabalan can you please check the tests?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756515101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756519212","html_url":"https://github.com/apache/hudi/pull/2111#issuecomment-756519212","issue_url":"https://api.github.com/repos/apache/hudi/issues/2111","id":756519212,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NjUxOTIxMg==","user":{"login":"SteNicholas","id":10048174,"node_id":"MDQ6VXNlcjEwMDQ4MTc0","avatar_url":"https://avatars.githubusercontent.com/u/10048174?v=4","gravatar_id":"","url":"https://api.github.com/users/SteNicholas","html_url":"https://github.com/SteNicholas","followers_url":"https://api.github.com/users/SteNicholas/followers","following_url":"https://api.github.com/users/SteNicholas/following{/other_user}","gists_url":"https://api.github.com/users/SteNicholas/gists{/gist_id}","starred_url":"https://api.github.com/users/SteNicholas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SteNicholas/subscriptions","organizations_url":"https://api.github.com/users/SteNicholas/orgs","repos_url":"https://api.github.com/users/SteNicholas/repos","events_url":"https://api.github.com/users/SteNicholas/events{/privacy}","received_events_url":"https://api.github.com/users/SteNicholas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-08T03:10:38Z","updated_at":"2021-01-08T03:10:38Z","author_association":"MEMBER","body":"@vinothchandar I didn't think the changes of @nsivabalan add different IOHandle to `HoodieMergeHandle`. We should add `HoodieInsertHandle` inherited from `HoodieIOHandle` to cover this case.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756519212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756532045","html_url":"https://github.com/apache/hudi/pull/2417#issuecomment-756532045","issue_url":"https://api.github.com/repos/apache/hudi/issues/2417","id":756532045,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NjUzMjA0NQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-08T04:01:10Z","updated_at":"2021-01-11T03:53:58Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2417?src=pr&el=h1) Report\n> Merging [#2417](https://codecov.io/gh/apache/hudi/pull/2417?src=pr&el=desc) (03336c2) into [master](https://codecov.io/gh/apache/hudi/commit/368c1a8f5c36d06ed49706b4afde4a83073a9011?el=desc) (368c1a8) will **increase** coverage by `0.23%`.\n> The diff coverage is `56.33%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2417/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2417?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2417      +/-   ##\n============================================\n+ Coverage     50.53%   50.76%   +0.23%     \n- Complexity     3032     3062      +30     \n============================================\n  Files           417      419       +2     \n  Lines         18727    18777      +50     \n  Branches       1917     1918       +1     \n============================================\n+ Hits           9463     9532      +69     \n+ Misses         8489     8470      -19     \n  Partials        775      775              \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `37.26% <0.00%> (-0.02%)` | `0.00 <0.00> (ø)` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `52.06% <55.00%> (+0.44%)` | `0.00 <13.00> (ø)` | |\n| hudiflink | `10.20% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.06% <66.66%> (+0.05%)` | `0.00 <0.00> (ø)` | |\n| hudisparkdatasource | `66.07% <ø> (-0.05%)` | `0.00 <ø> (ø)` | |\n| hudisync | `48.61% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `66.84% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.43% <100.00%> (+0.01%)` | `0.00 <1.00> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2417?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [.../org/apache/hudi/cli/commands/MetadataCommand.java](https://codecov.io/gh/apache/hudi/pull/2417/diff?src=pr&el=tree#diff-aHVkaS1jbGkvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY2xpL2NvbW1hbmRzL01ldGFkYXRhQ29tbWFuZC5qYXZh) | `1.11% <0.00%> (-0.02%)` | `1.00 <0.00> (ø)` | |\n| [...pache/hudi/common/config/HoodieMetadataConfig.java](https://codecov.io/gh/apache/hudi/pull/2417/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2NvbmZpZy9Ib29kaWVNZXRhZGF0YUNvbmZpZy5qYXZh) | `0.00% <ø> (ø)` | `0.00 <0.00> (ø)` | |\n| [...c/main/java/org/apache/hudi/common/fs/FSUtils.java](https://codecov.io/gh/apache/hudi/pull/2417/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2ZzL0ZTVXRpbHMuamF2YQ==) | `52.38% <0.00%> (+6.66%)` | `61.00 <0.00> (+6.00)` | |\n| [.../hudi/common/table/view/FileSystemViewManager.java](https://codecov.io/gh/apache/hudi/pull/2417/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL3ZpZXcvRmlsZVN5c3RlbVZpZXdNYW5hZ2VyLmphdmE=) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (ø)` | |\n| [...va/org/apache/hudi/metadata/BaseTableMetadata.java](https://codecov.io/gh/apache/hudi/pull/2417/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvbWV0YWRhdGEvQmFzZVRhYmxlTWV0YWRhdGEuamF2YQ==) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (ø)` | |\n| [...pache/hudi/metadata/HoodieBackedTableMetadata.java](https://codecov.io/gh/apache/hudi/pull/2417/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvbWV0YWRhdGEvSG9vZGllQmFja2VkVGFibGVNZXRhZGF0YS5qYXZh) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (ø)` | |\n| [...he/hudi/metadata/HoodieMetadataFileSystemView.java](https://codecov.io/gh/apache/hudi/pull/2417/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvbWV0YWRhdGEvSG9vZGllTWV0YWRhdGFGaWxlU3lzdGVtVmlldy5qYXZh) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (ø)` | |\n| [.../org/apache/hudi/metadata/HoodieTableMetadata.java](https://codecov.io/gh/apache/hudi/pull/2417/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvbWV0YWRhdGEvSG9vZGllVGFibGVNZXRhZGF0YS5qYXZh) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (ø)` | |\n| [...i/hadoop/utils/HoodieRealtimeInputFormatUtils.java](https://codecov.io/gh/apache/hudi/pull/2417/diff?src=pr&el=tree#diff-aHVkaS1oYWRvb3AtbXIvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaGFkb29wL3V0aWxzL0hvb2RpZVJlYWx0aW1lSW5wdXRGb3JtYXRVdGlscy5qYXZh) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (ø)` | |\n| [...e/hudi/common/engine/LocalTaskContextSupplier.java](https://codecov.io/gh/apache/hudi/pull/2417/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2VuZ2luZS9Mb2NhbFRhc2tDb250ZXh0U3VwcGxpZXIuamF2YQ==) | `20.00% <20.00%> (ø)` | `1.00 <1.00> (?)` | |\n| ... and [16 more](https://codecov.io/gh/apache/hudi/pull/2417/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756532045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756542561","html_url":"https://github.com/apache/hudi/pull/2418#issuecomment-756542561","issue_url":"https://api.github.com/repos/apache/hudi/issues/2418","id":756542561,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NjU0MjU2MQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-08T04:43:07Z","updated_at":"2021-01-08T05:27:36Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2418?src=pr&el=h1) Report\n> Merging [#2418](https://codecov.io/gh/apache/hudi/pull/2418?src=pr&el=desc) (e391e86) into [master](https://codecov.io/gh/apache/hudi/commit/b593f1062931a4d017ae8bd7dd42e47a8873a39f?el=desc) (b593f10) will **decrease** coverage by `0.07%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2418/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2418?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2418      +/-   ##\n============================================\n- Coverage     50.27%   50.19%   -0.08%     \n- Complexity     2990     2991       +1     \n============================================\n  Files           410      415       +5     \n  Lines         18406    18439      +33     \n  Branches       1885     1885              \n============================================\n+ Hits           9253     9256       +3     \n- Misses         8395     8425      +30     \n  Partials        758      758              \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `37.28% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `51.74% <ø> (-0.15%)` | `0.00 <ø> (ø)` | |\n| hudiflink | `10.20% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.35% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisparkdatasource | `62.81% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisync | `48.61% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `65.30% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.65% <ø> (ø)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2418?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...apache/hudi/common/engine/HoodieEngineContext.java](https://codecov.io/gh/apache/hudi/pull/2418/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2VuZ2luZS9Ib29kaWVFbmdpbmVDb250ZXh0LmphdmE=) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (?%)` | |\n| [.../org/apache/hudi/common/engine/EngineProperty.java](https://codecov.io/gh/apache/hudi/pull/2418/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2VuZ2luZS9FbmdpbmVQcm9wZXJ0eS5qYXZh) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (?%)` | |\n| [...java/org/apache/hudi/common/engine/EngineType.java](https://codecov.io/gh/apache/hudi/pull/2418/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2VuZ2luZS9FbmdpbmVUeXBlLmphdmE=) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (?%)` | |\n| [...g/apache/hudi/common/function/FunctionWrapper.java](https://codecov.io/gh/apache/hudi/pull/2418/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2Z1bmN0aW9uL0Z1bmN0aW9uV3JhcHBlci5qYXZh) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (?%)` | |\n| [...apache/hudi/common/engine/TaskContextSupplier.java](https://codecov.io/gh/apache/hudi/pull/2418/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2VuZ2luZS9UYXNrQ29udGV4dFN1cHBsaWVyLmphdmE=) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (?%)` | |\n| [...ache/hudi/common/fs/inline/InMemoryFileSystem.java](https://codecov.io/gh/apache/hudi/pull/2418/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2ZzL2lubGluZS9Jbk1lbW9yeUZpbGVTeXN0ZW0uamF2YQ==) | `89.65% <0.00%> (+10.34%)` | `16.00% <0.00%> (+1.00%)` | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756542561/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756578166","html_url":"https://github.com/apache/hudi/issues/2414#issuecomment-756578166","issue_url":"https://api.github.com/repos/apache/hudi/issues/2414","id":756578166,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NjU3ODE2Ng==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-08T06:34:24Z","updated_at":"2021-01-08T06:34:24Z","author_association":"CONTRIBUTOR","body":"Answer provided : https://apache-hudi.slack.com/archives/C4D716NPQ/p1609922670490200?thread_ts=1609360627.455000&cid=C4D716NPQ\r\n\r\nRegarding your first question, Bulk_Insert mode simply honors the number of parallelism you have provided and uses it to create separate files.  Please look at https://cwiki.apache.org/confluence/display/HUDI/FAQ#FAQ-Whatperformance/ingestlatencycanIexpectforHudiwriting If you want file sizing to be taken care of, use INSERT mode for the first commit. Regarding your second question, the reason is that with sorting inside a partition (Note : this is spark partition), what happens is that if the records within a spark partition falls under different hive partition, then they end up as separate file. With global sort mode though, each spark partition is likely to see records from the same hive partition. The  spark step name might be misleading, It could be the index lookup time. Try global sort mode with insert and then run upsert to observe upsert time","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756578166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756781554","html_url":"https://github.com/apache/hudi/pull/1938#issuecomment-756781554","issue_url":"https://api.github.com/repos/apache/hudi/issues/1938","id":756781554,"node_id":"MDEyOklzc3VlQ29tbWVudDc1Njc4MTU1NA==","user":{"login":"garyli1019","id":23007841,"node_id":"MDQ6VXNlcjIzMDA3ODQx","avatar_url":"https://avatars.githubusercontent.com/u/23007841?v=4","gravatar_id":"","url":"https://api.github.com/users/garyli1019","html_url":"https://github.com/garyli1019","followers_url":"https://api.github.com/users/garyli1019/followers","following_url":"https://api.github.com/users/garyli1019/following{/other_user}","gists_url":"https://api.github.com/users/garyli1019/gists{/gist_id}","starred_url":"https://api.github.com/users/garyli1019/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garyli1019/subscriptions","organizations_url":"https://api.github.com/users/garyli1019/orgs","repos_url":"https://api.github.com/users/garyli1019/repos","events_url":"https://api.github.com/users/garyli1019/events{/privacy}","received_events_url":"https://api.github.com/users/garyli1019/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-08T14:24:45Z","updated_at":"2021-01-08T14:24:45Z","author_association":"MEMBER","body":"Thanks, will update this PR before Friday night PST.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756781554/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756818455","html_url":"https://github.com/apache/hudi/issues/2416#issuecomment-756818455","issue_url":"https://api.github.com/repos/apache/hudi/issues/2416","id":756818455,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NjgxODQ1NQ==","user":{"login":"Rap70r","id":22181358,"node_id":"MDQ6VXNlcjIyMTgxMzU4","avatar_url":"https://avatars.githubusercontent.com/u/22181358?v=4","gravatar_id":"","url":"https://api.github.com/users/Rap70r","html_url":"https://github.com/Rap70r","followers_url":"https://api.github.com/users/Rap70r/followers","following_url":"https://api.github.com/users/Rap70r/following{/other_user}","gists_url":"https://api.github.com/users/Rap70r/gists{/gist_id}","starred_url":"https://api.github.com/users/Rap70r/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Rap70r/subscriptions","organizations_url":"https://api.github.com/users/Rap70r/orgs","repos_url":"https://api.github.com/users/Rap70r/repos","events_url":"https://api.github.com/users/Rap70r/events{/privacy}","received_events_url":"https://api.github.com/users/Rap70r/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-08T15:32:18Z","updated_at":"2021-01-08T15:32:18Z","author_association":"NONE","body":"Hello vinothchandar,\r\n\r\nThank you for getting back to me. Yes, I would like to use Hudi with EMR 6.2.0 and Spark 3.0.\r\n\r\nThank you","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756818455/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756825549","html_url":"https://github.com/apache/hudi/pull/2415#issuecomment-756825549","issue_url":"https://api.github.com/repos/apache/hudi/issues/2415","id":756825549,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NjgyNTU0OQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-08T15:44:56Z","updated_at":"2021-01-08T16:28:03Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2415?src=pr&el=h1) Report\n> Merging [#2415](https://codecov.io/gh/apache/hudi/pull/2415?src=pr&el=desc) (1dd00dd) into [master](https://codecov.io/gh/apache/hudi/commit/5ff8e88d58c2a6efa1046716e11dca0d61cdf872?el=desc) (5ff8e88) will **decrease** coverage by `0.07%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2415/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2415?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2415      +/-   ##\n============================================\n- Coverage     50.28%   50.20%   -0.08%     \n  Complexity     2991     2991              \n============================================\n  Files           410      415       +5     \n  Lines         18406    18439      +33     \n  Branches       1885     1885              \n============================================\n+ Hits           9256     9258       +2     \n- Misses         8392     8424      +32     \n+ Partials        758      757       -1     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `37.28% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `51.76% <ø> (-0.16%)` | `0.00 <ø> (ø)` | |\n| hudiflink | `10.20% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.35% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisparkdatasource | `62.81% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisync | `48.61% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `65.30% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.65% <ø> (ø)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2415?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...apache/hudi/common/engine/TaskContextSupplier.java](https://codecov.io/gh/apache/hudi/pull/2415/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2VuZ2luZS9UYXNrQ29udGV4dFN1cHBsaWVyLmphdmE=) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (?%)` | |\n| [...java/org/apache/hudi/common/engine/EngineType.java](https://codecov.io/gh/apache/hudi/pull/2415/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2VuZ2luZS9FbmdpbmVUeXBlLmphdmE=) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (?%)` | |\n| [.../org/apache/hudi/common/engine/EngineProperty.java](https://codecov.io/gh/apache/hudi/pull/2415/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2VuZ2luZS9FbmdpbmVQcm9wZXJ0eS5qYXZh) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (?%)` | |\n| [...apache/hudi/common/engine/HoodieEngineContext.java](https://codecov.io/gh/apache/hudi/pull/2415/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2VuZ2luZS9Ib29kaWVFbmdpbmVDb250ZXh0LmphdmE=) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (?%)` | |\n| [...g/apache/hudi/common/function/FunctionWrapper.java](https://codecov.io/gh/apache/hudi/pull/2415/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2Z1bmN0aW9uL0Z1bmN0aW9uV3JhcHBlci5qYXZh) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (?%)` | |\n| [...e/hudi/common/table/log/HoodieLogFormatWriter.java](https://codecov.io/gh/apache/hudi/pull/2415/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9Ib29kaWVMb2dGb3JtYXRXcml0ZXIuamF2YQ==) | `79.68% <0.00%> (+1.56%)` | `26.00% <0.00%> (ø%)` | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756825549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756830958","html_url":"https://github.com/apache/hudi/pull/2418#issuecomment-756830958","issue_url":"https://api.github.com/repos/apache/hudi/issues/2418","id":756830958,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NjgzMDk1OA==","user":{"login":"lw309637554","id":8501994,"node_id":"MDQ6VXNlcjg1MDE5OTQ=","avatar_url":"https://avatars.githubusercontent.com/u/8501994?v=4","gravatar_id":"","url":"https://api.github.com/users/lw309637554","html_url":"https://github.com/lw309637554","followers_url":"https://api.github.com/users/lw309637554/followers","following_url":"https://api.github.com/users/lw309637554/following{/other_user}","gists_url":"https://api.github.com/users/lw309637554/gists{/gist_id}","starred_url":"https://api.github.com/users/lw309637554/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lw309637554/subscriptions","organizations_url":"https://api.github.com/users/lw309637554/orgs","repos_url":"https://api.github.com/users/lw309637554/repos","events_url":"https://api.github.com/users/lw309637554/events{/privacy}","received_events_url":"https://api.github.com/users/lw309637554/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-08T15:53:54Z","updated_at":"2021-01-08T15:59:53Z","author_association":"CONTRIBUTOR","body":"@satishkotha just two minor comments","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756830958/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756960638","html_url":"https://github.com/apache/hudi/pull/2420#issuecomment-756960638","issue_url":"https://api.github.com/repos/apache/hudi/issues/2420","id":756960638,"node_id":"MDEyOklzc3VlQ29tbWVudDc1Njk2MDYzOA==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-08T19:50:23Z","updated_at":"2021-01-08T19:50:23Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2420?src=pr&el=h1) Report\n> Merging [#2420](https://codecov.io/gh/apache/hudi/pull/2420?src=pr&el=desc) (fb35a0f) into [master](https://codecov.io/gh/apache/hudi/commit/5ff8e88d58c2a6efa1046716e11dca0d61cdf872?el=desc) (5ff8e88) will **decrease** coverage by `40.24%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2420/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2420?src=pr&el=tree)\n\n```diff\n@@              Coverage Diff              @@\n##             master    #2420       +/-   ##\n=============================================\n- Coverage     50.28%   10.04%   -40.25%     \n+ Complexity     2991       48     -2943     \n=============================================\n  Files           410       52      -358     \n  Lines         18406     1852    -16554     \n  Branches       1885      223     -1662     \n=============================================\n- Hits           9256      186     -9070     \n+ Misses         8392     1653     -6739     \n+ Partials        758       13      -745     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `10.04% <ø> (-59.62%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2420?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...va/org/apache/hudi/utilities/IdentitySplitter.java](https://codecov.io/gh/apache/hudi/pull/2420/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0lkZW50aXR5U3BsaXR0ZXIuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-2.00%)` | |\n| [...va/org/apache/hudi/utilities/schema/SchemaSet.java](https://codecov.io/gh/apache/hudi/pull/2420/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFTZXQuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-3.00%)` | |\n| [...a/org/apache/hudi/utilities/sources/RowSource.java](https://codecov.io/gh/apache/hudi/pull/2420/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUm93U291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [.../org/apache/hudi/utilities/sources/AvroSource.java](https://codecov.io/gh/apache/hudi/pull/2420/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQXZyb1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [.../org/apache/hudi/utilities/sources/JsonSource.java](https://codecov.io/gh/apache/hudi/pull/2420/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvblNvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [...rg/apache/hudi/utilities/sources/CsvDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2420/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQ3N2REZTU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-10.00%)` | |\n| [...g/apache/hudi/utilities/sources/JsonDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2420/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkRGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [...apache/hudi/utilities/sources/JsonKafkaSource.java](https://codecov.io/gh/apache/hudi/pull/2420/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkthZmthU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-6.00%)` | |\n| [...pache/hudi/utilities/sources/ParquetDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2420/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUGFycXVldERGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-5.00%)` | |\n| [...lities/schema/SchemaProviderWithPostProcessor.java](https://codecov.io/gh/apache/hudi/pull/2420/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFQcm92aWRlcldpdGhQb3N0UHJvY2Vzc29yLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| ... and [387 more](https://codecov.io/gh/apache/hudi/pull/2420/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756960638/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756969267","html_url":"https://github.com/apache/hudi/pull/2069#issuecomment-756969267","issue_url":"https://api.github.com/repos/apache/hudi/issues/2069","id":756969267,"node_id":"MDEyOklzc3VlQ29tbWVudDc1Njk2OTI2Nw==","user":{"login":"prashanthvg89","id":8704802,"node_id":"MDQ6VXNlcjg3MDQ4MDI=","avatar_url":"https://avatars.githubusercontent.com/u/8704802?v=4","gravatar_id":"","url":"https://api.github.com/users/prashanthvg89","html_url":"https://github.com/prashanthvg89","followers_url":"https://api.github.com/users/prashanthvg89/followers","following_url":"https://api.github.com/users/prashanthvg89/following{/other_user}","gists_url":"https://api.github.com/users/prashanthvg89/gists{/gist_id}","starred_url":"https://api.github.com/users/prashanthvg89/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prashanthvg89/subscriptions","organizations_url":"https://api.github.com/users/prashanthvg89/orgs","repos_url":"https://api.github.com/users/prashanthvg89/repos","events_url":"https://api.github.com/users/prashanthvg89/events{/privacy}","received_events_url":"https://api.github.com/users/prashanthvg89/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-08T20:09:33Z","updated_at":"2021-01-08T20:09:33Z","author_association":"NONE","body":"I saw this failure in Spark streaming job writing to Hudi. Is this still being worked on and is there an ETA for this?\r\n\r\nHudi version: 0.6.0\r\nSpark version: 2.4.0\r\nEMR version: 5.29.0\r\nHudi storage type: Copy-On-Write\r\nNumber of partitions specified using partition path field: 100\r\nNumber of Hudi records currently: 463 million\r\n\r\nCaused by: org.apache.hudi.exception.HoodieIOException: Cannot instantiate an ExternalSpillableMap\r\n        at org.apache.hudi.io.HoodieMergeHandle.init(HoodieMergeHandle.java:155)\r\n        at org.apache.hudi.io.HoodieMergeHandle.<init>(HoodieMergeHandle.java:75)\r\n        at org.apache.hudi.table.action.commit.CommitActionExecutor.getUpdateHandle(CommitActionExecutor.java:101)\r\n        at org.apache.hudi.table.action.commit.CommitActionExecutor.handleUpdate(CommitActionExecutor.java:72)\r\n        at org.apache.hudi.table.action.commit.BaseCommitActionExecutor.handleUpsertPartition(BaseCommitActionExecutor.java:257)\r\n        ... 30 more\r\nCaused by: java.io.IOException: Too many open files\r\n        at java.io.UnixFileSystem.createFileExclusively(Native Method)\r\n        at java.io.File.createNewFile(File.java:1014)\r\n        at org.apache.hudi.common.util.collection.DiskBasedMap.initFile(DiskBasedMap.java:115)\r\n        at org.apache.hudi.common.util.collection.DiskBasedMap.<init>(DiskBasedMap.java:81)\r\n        at org.apache.hudi.common.util.collection.ExternalSpillableMap.<init>(ExternalSpillableMap.java:86)\r\n        at org.apache.hudi.io.HoodieMergeHandle.init(HoodieMergeHandle.java:152)\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/756969267/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757035695","html_url":"https://github.com/apache/hudi/issues/2409#issuecomment-757035695","issue_url":"https://api.github.com/repos/apache/hudi/issues/2409","id":757035695,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzAzNTY5NQ==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-08T22:46:31Z","updated_at":"2021-01-08T22:46:31Z","author_association":"CONTRIBUTOR","body":"@wosow : The _rt table syncing happens after _ro table and I see an HiveMetaStore exception when updating commit time in the _ro table saying that the table does not exist. This is weird as in the few log messages above, I can see that the _ro table is registered. Somehow _ro table is not visible to HiveMetaStoreClient. I think it is likely that HiveServer and HiveMetastore are not setup correctly and there could be more than one HiveMetastore involded (one probably local ) instance.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757035695/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757038688","html_url":"https://github.com/apache/hudi/pull/2422#issuecomment-757038688","issue_url":"https://api.github.com/repos/apache/hudi/issues/2422","id":757038688,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzAzODY4OA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-08T22:56:54Z","updated_at":"2021-01-08T22:56:54Z","author_association":"MEMBER","body":"cc @prashantwason @satishkotha  kindly take a quick pass.\r\n\r\nI still have to - add tests, handle the existing deletion code in archival.\r\nbut the algorithm is there in the PR.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757038688/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757056595","html_url":"https://github.com/apache/hudi/pull/2422#issuecomment-757056595","issue_url":"https://api.github.com/repos/apache/hudi/issues/2422","id":757056595,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzA1NjU5NQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T00:09:22Z","updated_at":"2021-01-09T00:09:22Z","author_association":"MEMBER","body":"We should probably keep the archival code as a defense, with a `log.warn()`","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757056595/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757058068","html_url":"https://github.com/apache/hudi/pull/2422#issuecomment-757058068","issue_url":"https://api.github.com/repos/apache/hudi/issues/2422","id":757058068,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzA1ODA2OA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T00:15:38Z","updated_at":"2021-01-09T00:15:38Z","author_association":"MEMBER","body":"@satishkotha is driving this to completion. @prashantwason you might want to chime in on the algorithm part and let us know if you see red flags, when you get a chance. \r\n\r\nMuch appreciated folks!","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757058068/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757090817","html_url":"https://github.com/apache/hudi/pull/2379#issuecomment-757090817","issue_url":"https://api.github.com/repos/apache/hudi/issues/2379","id":757090817,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzA5MDgxNw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T03:59:52Z","updated_at":"2021-01-09T03:59:52Z","author_association":"MEMBER","body":"@n3nash can you shepherd this and land ?  @satishkotha is helping out with the other PR.\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757090817/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757097457","html_url":"https://github.com/apache/hudi/pull/1938#issuecomment-757097457","issue_url":"https://api.github.com/repos/apache/hudi/issues/1938","id":757097457,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzA5NzQ1Nw==","user":{"login":"garyli1019","id":23007841,"node_id":"MDQ6VXNlcjIzMDA3ODQx","avatar_url":"https://avatars.githubusercontent.com/u/23007841?v=4","gravatar_id":"","url":"https://api.github.com/users/garyli1019","html_url":"https://github.com/garyli1019","followers_url":"https://api.github.com/users/garyli1019/followers","following_url":"https://api.github.com/users/garyli1019/following{/other_user}","gists_url":"https://api.github.com/users/garyli1019/gists{/gist_id}","starred_url":"https://api.github.com/users/garyli1019/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garyli1019/subscriptions","organizations_url":"https://api.github.com/users/garyli1019/orgs","repos_url":"https://api.github.com/users/garyli1019/repos","events_url":"https://api.github.com/users/garyli1019/events{/privacy}","received_events_url":"https://api.github.com/users/garyli1019/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T05:03:56Z","updated_at":"2021-01-09T05:03:56Z","author_association":"MEMBER","body":"@vinothchandar addressed comments. You are right, the inconsistency was caused by the test data generator. The CI was happy after I changed from `generateUpdates` to `generateUniqueUpdates`.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757097457/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757100778","html_url":"https://github.com/apache/hudi/pull/2419#issuecomment-757100778","issue_url":"https://api.github.com/repos/apache/hudi/issues/2419","id":757100778,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzEwMDc3OA==","user":{"login":"wangxianghu","id":49835526,"node_id":"MDQ6VXNlcjQ5ODM1NTI2","avatar_url":"https://avatars.githubusercontent.com/u/49835526?v=4","gravatar_id":"","url":"https://api.github.com/users/wangxianghu","html_url":"https://github.com/wangxianghu","followers_url":"https://api.github.com/users/wangxianghu/followers","following_url":"https://api.github.com/users/wangxianghu/following{/other_user}","gists_url":"https://api.github.com/users/wangxianghu/gists{/gist_id}","starred_url":"https://api.github.com/users/wangxianghu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangxianghu/subscriptions","organizations_url":"https://api.github.com/users/wangxianghu/orgs","repos_url":"https://api.github.com/users/wangxianghu/repos","events_url":"https://api.github.com/users/wangxianghu/events{/privacy}","received_events_url":"https://api.github.com/users/wangxianghu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T05:38:24Z","updated_at":"2021-01-09T05:38:24Z","author_association":"CONTRIBUTOR","body":"Hi @loukey-lj thanks for your contribution\r\nplease check why ci failed ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757100778/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757103037","html_url":"https://github.com/apache/hudi/pull/1938#issuecomment-757103037","issue_url":"https://api.github.com/repos/apache/hudi/issues/1938","id":757103037,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzEwMzAzNw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T06:04:24Z","updated_at":"2021-01-09T06:04:24Z","author_association":"MEMBER","body":"Thanks @garyli1019 ! You are awesome. \r\n Will take a pass, after CI is happy. and land,\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757103037/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757110216","html_url":"https://github.com/apache/hudi/pull/2422#issuecomment-757110216","issue_url":"https://api.github.com/repos/apache/hudi/issues/2422","id":757110216,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzExMDIxNg==","user":{"login":"satishkotha","id":2992755,"node_id":"MDQ6VXNlcjI5OTI3NTU=","avatar_url":"https://avatars.githubusercontent.com/u/2992755?v=4","gravatar_id":"","url":"https://api.github.com/users/satishkotha","html_url":"https://github.com/satishkotha","followers_url":"https://api.github.com/users/satishkotha/followers","following_url":"https://api.github.com/users/satishkotha/following{/other_user}","gists_url":"https://api.github.com/users/satishkotha/gists{/gist_id}","starred_url":"https://api.github.com/users/satishkotha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/satishkotha/subscriptions","organizations_url":"https://api.github.com/users/satishkotha/orgs","repos_url":"https://api.github.com/users/satishkotha/repos","events_url":"https://api.github.com/users/satishkotha/events{/privacy}","received_events_url":"https://api.github.com/users/satishkotha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T07:25:03Z","updated_at":"2021-01-09T07:25:03Z","author_association":"MEMBER","body":"> @satishkotha is driving this to completion. @prashantwason you might want to chime in on the algorithm part and let us know if you see red flags, when you get a chance.\r\n> \r\n> Much appreciated folks!\r\n\r\n@vinothchandar I updated the diff and added basic unit tests. PTAL. I havent change archival code yet. I plan to get to that tomorrow. But, that is not super important for correctness. When you get a chance, please try rfc-15 e2e tests with this code. (or if you can share script/commands, I can run it)","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757110216/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757112911","html_url":"https://github.com/apache/hudi/pull/2421#issuecomment-757112911","issue_url":"https://api.github.com/repos/apache/hudi/issues/2421","id":757112911,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzExMjkxMQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T07:54:21Z","updated_at":"2021-01-11T19:39:50Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2421?src=pr&el=h1) Report\n> Merging [#2421](https://codecov.io/gh/apache/hudi/pull/2421?src=pr&el=desc) (c2647c3) into [master](https://codecov.io/gh/apache/hudi/commit/c151147819abb6b4c418138d9b401f374fc021a0?el=desc) (c151147) will **decrease** coverage by `0.35%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2421/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2421?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff             @@\n##             master   #2421      +/-   ##\n===========================================\n- Coverage     10.04%   9.68%   -0.36%     \n  Complexity       48      48              \n===========================================\n  Files            52      53       +1     \n  Lines          1852    1930      +78     \n  Branches        223     230       +7     \n===========================================\n+ Hits            186     187       +1     \n- Misses         1653    1730      +77     \n  Partials         13      13              \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `9.68% <ø> (-0.36%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2421?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...in/java/org/apache/hudi/utilities/UtilHelpers.java](https://codecov.io/gh/apache/hudi/pull/2421/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL1V0aWxIZWxwZXJzLmphdmE=) | `34.10% <0.00%> (-1.44%)` | `11.00% <0.00%> (ø%)` | |\n| [...apache/hudi/utilities/deltastreamer/DeltaSync.java](https://codecov.io/gh/apache/hudi/pull/2421/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvRGVsdGFTeW5jLmphdmE=) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (ø%)` | |\n| [...org/apache/hudi/utilities/HoodieClusteringJob.java](https://codecov.io/gh/apache/hudi/pull/2421/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0hvb2RpZUNsdXN0ZXJpbmdKb2IuamF2YQ==) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (?%)` | |\n| [.../apache/hudi/utilities/HoodieSnapshotExporter.java](https://codecov.io/gh/apache/hudi/pull/2421/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0hvb2RpZVNuYXBzaG90RXhwb3J0ZXIuamF2YQ==) | `83.62% <0.00%> (+0.14%)` | `28.00% <0.00%> (ø%)` | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757112911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757120127","html_url":"https://github.com/apache/hudi/pull/2069#issuecomment-757120127","issue_url":"https://api.github.com/repos/apache/hudi/issues/2069","id":757120127,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzEyMDEyNw==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T09:07:11Z","updated_at":"2021-01-09T09:07:11Z","author_association":"CONTRIBUTOR","body":"@prashantwason : Please go ahead and take over this PR to fit in 0.7 timeline. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757120127/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757125096","html_url":"https://github.com/apache/hudi/issues/2338#issuecomment-757125096","issue_url":"https://api.github.com/repos/apache/hudi/issues/2338","id":757125096,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzEyNTA5Ng==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T09:53:35Z","updated_at":"2021-01-09T09:53:58Z","author_association":"CONTRIBUTOR","body":"@so-lazy : \r\n\r\nwhen you query through spark datasource (not just single file), are you able to see unique record ?\r\n\r\nval df = spark.read.format(\"hudi\").load(\"hdfs://hadoop01:9000/hudi/cars/carsdata/inf_car_bin/*\")\r\n....\r\n\r\nAlso, Are you passing the config (spark.sql.hive.convertMetastoreParquet=false) when you are launching spark ? https://hudi.apache.org/docs/querying_data.html#spark-sql. \r\n\r\nAlso, I see you have space around \"=\" sign (set spark.sql.hive.convertMetastoreParquet = false;)   Try removing it. Please also enable INFO logging and run the select group by query and attach them if the problem persists.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757125096/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757129226","html_url":"https://github.com/apache/hudi/pull/2422#issuecomment-757129226","issue_url":"https://api.github.com/repos/apache/hudi/issues/2422","id":757129226,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzEyOTIyNg==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T10:30:30Z","updated_at":"2021-01-10T00:05:29Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2422?src=pr&el=h1) Report\n> Merging [#2422](https://codecov.io/gh/apache/hudi/pull/2422?src=pr&el=desc) (df5ef96) into [master](https://codecov.io/gh/apache/hudi/commit/17df517b812c9a37dd64014f0d5c35a3cfac0c4e?el=desc) (17df517) will **decrease** coverage by `40.14%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2422/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2422?src=pr&el=tree)\n\n```diff\n@@              Coverage Diff              @@\n##             master    #2422       +/-   ##\n=============================================\n- Coverage     50.19%   10.04%   -40.15%     \n+ Complexity     2990       48     -2942     \n=============================================\n  Files           415       52      -363     \n  Lines         18439     1852    -16587     \n  Branches       1885      223     -1662     \n=============================================\n- Hits           9255      186     -9069     \n+ Misses         8427     1653     -6774     \n+ Partials        757       13      -744     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `10.04% <ø> (-59.62%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2422?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...va/org/apache/hudi/utilities/IdentitySplitter.java](https://codecov.io/gh/apache/hudi/pull/2422/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0lkZW50aXR5U3BsaXR0ZXIuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-2.00%)` | |\n| [...va/org/apache/hudi/utilities/schema/SchemaSet.java](https://codecov.io/gh/apache/hudi/pull/2422/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFTZXQuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-3.00%)` | |\n| [...a/org/apache/hudi/utilities/sources/RowSource.java](https://codecov.io/gh/apache/hudi/pull/2422/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUm93U291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [.../org/apache/hudi/utilities/sources/AvroSource.java](https://codecov.io/gh/apache/hudi/pull/2422/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQXZyb1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [.../org/apache/hudi/utilities/sources/JsonSource.java](https://codecov.io/gh/apache/hudi/pull/2422/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvblNvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [...rg/apache/hudi/utilities/sources/CsvDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2422/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQ3N2REZTU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-10.00%)` | |\n| [...g/apache/hudi/utilities/sources/JsonDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2422/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkRGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [...apache/hudi/utilities/sources/JsonKafkaSource.java](https://codecov.io/gh/apache/hudi/pull/2422/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkthZmthU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-6.00%)` | |\n| [...pache/hudi/utilities/sources/ParquetDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2422/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUGFycXVldERGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-5.00%)` | |\n| [...lities/schema/SchemaProviderWithPostProcessor.java](https://codecov.io/gh/apache/hudi/pull/2422/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFQcm92aWRlcldpdGhQb3N0UHJvY2Vzc29yLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| ... and [384 more](https://codecov.io/gh/apache/hudi/pull/2422/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757129226/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757328040","html_url":"https://github.com/apache/hudi/pull/2422#issuecomment-757328040","issue_url":"https://api.github.com/repos/apache/hudi/issues/2422","id":757328040,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzMyODA0MA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T16:07:55Z","updated_at":"2021-01-09T16:07:55Z","author_association":"MEMBER","body":"Thanks for this @satishkotha . Will take a pass on this shortly\r\n\r\ncc @nsivabalan  who has some integ-test runs with clustering. We can probably run with both this and metadata table enabled and certify this. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757328040/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757328474","html_url":"https://github.com/apache/hudi/pull/2379#issuecomment-757328474","issue_url":"https://api.github.com/repos/apache/hudi/issues/2379","id":757328474,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzMyODQ3NA==","user":{"login":"lw309637554","id":8501994,"node_id":"MDQ6VXNlcjg1MDE5OTQ=","avatar_url":"https://avatars.githubusercontent.com/u/8501994?v=4","gravatar_id":"","url":"https://api.github.com/users/lw309637554","html_url":"https://github.com/lw309637554","followers_url":"https://api.github.com/users/lw309637554/followers","following_url":"https://api.github.com/users/lw309637554/following{/other_user}","gists_url":"https://api.github.com/users/lw309637554/gists{/gist_id}","starred_url":"https://api.github.com/users/lw309637554/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lw309637554/subscriptions","organizations_url":"https://api.github.com/users/lw309637554/orgs","repos_url":"https://api.github.com/users/lw309637554/repos","events_url":"https://api.github.com/users/lw309637554/events{/privacy}","received_events_url":"https://api.github.com/users/lw309637554/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T16:11:28Z","updated_at":"2021-01-09T16:11:39Z","author_association":"CONTRIBUTOR","body":"> @lw309637554 Left a couple of comments, can land after that.\r\n\r\n@n3nash Have resolved and reply the comments, Thanks.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757328474/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757349244","html_url":"https://github.com/apache/hudi/pull/2422#issuecomment-757349244","issue_url":"https://api.github.com/repos/apache/hudi/issues/2422","id":757349244,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzM0OTI0NA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T18:39:28Z","updated_at":"2021-01-09T18:39:28Z","author_association":"MEMBER","body":"@nsivabalan I am still doing a deep review; but  I think this is good for testing.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757349244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757356013","html_url":"https://github.com/apache/hudi/issues/2423#issuecomment-757356013","issue_url":"https://api.github.com/repos/apache/hudi/issues/2423","id":757356013,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzM1NjAxMw==","user":{"login":"sam-wmt","id":67726885,"node_id":"MDQ6VXNlcjY3NzI2ODg1","avatar_url":"https://avatars.githubusercontent.com/u/67726885?v=4","gravatar_id":"","url":"https://api.github.com/users/sam-wmt","html_url":"https://github.com/sam-wmt","followers_url":"https://api.github.com/users/sam-wmt/followers","following_url":"https://api.github.com/users/sam-wmt/following{/other_user}","gists_url":"https://api.github.com/users/sam-wmt/gists{/gist_id}","starred_url":"https://api.github.com/users/sam-wmt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sam-wmt/subscriptions","organizations_url":"https://api.github.com/users/sam-wmt/orgs","repos_url":"https://api.github.com/users/sam-wmt/repos","events_url":"https://api.github.com/users/sam-wmt/events{/privacy}","received_events_url":"https://api.github.com/users/sam-wmt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T19:33:28Z","updated_at":"2021-01-09T19:33:28Z","author_association":"NONE","body":"<img width=\"748\" alt=\"Screen Shot 2021-01-09 at 2 32 48 PM\" src=\"https://user-images.githubusercontent.com/67726885/104107035-9774aa00-5287-11eb-9f8d-a43214fe1266.png\">\r\nAdding screenshot of operation type stats for 1 day of the workload.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757356013/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757357033","html_url":"https://github.com/apache/hudi/pull/2422#issuecomment-757357033","issue_url":"https://api.github.com/repos/apache/hudi/issues/2422","id":757357033,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzM1NzAzMw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T19:40:40Z","updated_at":"2021-01-09T19:40:40Z","author_association":"MEMBER","body":"@satishkotha  This looks good and also much cleaner. \r\n\r\nOnly thing to do IMO is to make sure we don't throw an error when archival fails to delete the replaced file groups later.\r\n\r\n```\r\n boolean deleteSuccess = deleteReplacedFileGroups(context, hoodieInstant);\r\n        if (!deleteSuccess) {\r\n          // throw error and stop archival if deleting replaced file groups failed.\r\n          throw new HoodieCommitException(\"Unable to delete file(s) for \" + hoodieInstant.getFileName());\r\n        }\r\n```\r\n\r\nI think we can can that code, if you are comfortable with this. Or just `log.WARN` instead of exception for now, with a follow on 0.8.0 JIRA to do that. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757357033/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757376967","html_url":"https://github.com/apache/hudi/pull/1938#issuecomment-757376967","issue_url":"https://api.github.com/repos/apache/hudi/issues/1938","id":757376967,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzM3Njk2Nw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T22:28:55Z","updated_at":"2021-01-09T22:28:55Z","author_association":"MEMBER","body":"@garyli1019 looks like the spark3 build broke\r\n\r\n```\r\n mcist -DskipITs -Dscala-2.12 -Dspark3\r\n```\r\n\r\nleads to. \r\n\r\n```\r\n[INFO] /Users/vs/Code/hudi/hudi-spark-datasource/hudi-spark/src/main/java:-1: info: compiling\r\n[INFO] /Users/vs/Code/hudi/hudi-spark-datasource/hudi-spark/src/main/scala:-1: info: compiling\r\n[INFO] Compiling 20 source files to /Users/vs/Code/hudi/hudi-spark-datasource/hudi-spark/target/classes at 1610229821451\r\n[ERROR] /Users/vs/Code/hudi/hudi-spark-datasource/hudi-spark/src/main/scala/org/apache/hudi/MergeOnReadIncrementalRelation.scala:143: error: object SparkHadoopUtil in package deploy cannot be accessed in package org.apache.spark.deploy\r\n[ERROR]     SparkHadoopUtil.get.addCredentials(jobConf)\r\n[ERROR]     ^\r\n[ERROR] one error found\r\n```\r\n\r\nFYI. I will try to fix this ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757376967/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757383826","html_url":"https://github.com/apache/hudi/pull/2422#issuecomment-757383826","issue_url":"https://api.github.com/repos/apache/hudi/issues/2422","id":757383826,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzM4MzgyNg==","user":{"login":"satishkotha","id":2992755,"node_id":"MDQ6VXNlcjI5OTI3NTU=","avatar_url":"https://avatars.githubusercontent.com/u/2992755?v=4","gravatar_id":"","url":"https://api.github.com/users/satishkotha","html_url":"https://github.com/satishkotha","followers_url":"https://api.github.com/users/satishkotha/followers","following_url":"https://api.github.com/users/satishkotha/following{/other_user}","gists_url":"https://api.github.com/users/satishkotha/gists{/gist_id}","starred_url":"https://api.github.com/users/satishkotha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/satishkotha/subscriptions","organizations_url":"https://api.github.com/users/satishkotha/orgs","repos_url":"https://api.github.com/users/satishkotha/repos","events_url":"https://api.github.com/users/satishkotha/events{/privacy}","received_events_url":"https://api.github.com/users/satishkotha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T23:32:14Z","updated_at":"2021-01-09T23:32:14Z","author_association":"MEMBER","body":"> @satishkotha This looks good and also much cleaner.\r\n> \r\n> Only thing to do IMO is to make sure we don't throw an error when archival fails to delete the replaced file groups later.\r\n> \r\n> ```\r\n>  boolean deleteSuccess = deleteReplacedFileGroups(context, hoodieInstant);\r\n>         if (!deleteSuccess) {\r\n>           // throw error and stop archival if deleting replaced file groups failed.\r\n>           throw new HoodieCommitException(\"Unable to delete file(s) for \" + hoodieInstant.getFileName());\r\n>         }\r\n> ```\r\n> \r\n> I think we can can that code, if you are comfortable with this. Or just `log.WARN` instead of exception for now, with a follow on 0.8.0 JIRA to do that.\r\n\r\n@vinothchandar Changed to log.warn and created HUDI-1518.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757383826/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757384616","html_url":"https://github.com/apache/hudi/pull/2422#issuecomment-757384616","issue_url":"https://api.github.com/repos/apache/hudi/issues/2422","id":757384616,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzM4NDYxNg==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T23:41:24Z","updated_at":"2021-01-09T23:41:24Z","author_association":"MEMBER","body":"Do you think this PR is ready to land after CI passes? @satishkotha \r\n\r\nOn finding more places to change. May be just find usages of `HoodieTimeline.DELTA_COMMIT_ACTION` ? and see if anything needs more needs to be done? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757384616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757385601","html_url":"https://github.com/apache/hudi/pull/2422#issuecomment-757385601","issue_url":"https://api.github.com/repos/apache/hudi/issues/2422","id":757385601,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzM4NTYwMQ==","user":{"login":"satishkotha","id":2992755,"node_id":"MDQ6VXNlcjI5OTI3NTU=","avatar_url":"https://avatars.githubusercontent.com/u/2992755?v=4","gravatar_id":"","url":"https://api.github.com/users/satishkotha","html_url":"https://github.com/satishkotha","followers_url":"https://api.github.com/users/satishkotha/followers","following_url":"https://api.github.com/users/satishkotha/following{/other_user}","gists_url":"https://api.github.com/users/satishkotha/gists{/gist_id}","starred_url":"https://api.github.com/users/satishkotha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/satishkotha/subscriptions","organizations_url":"https://api.github.com/users/satishkotha/orgs","repos_url":"https://api.github.com/users/satishkotha/repos","events_url":"https://api.github.com/users/satishkotha/events{/privacy}","received_events_url":"https://api.github.com/users/satishkotha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T23:51:45Z","updated_at":"2021-01-09T23:51:45Z","author_association":"MEMBER","body":"> Do you think this PR is ready to land after CI passes? @satishkotha\r\n> \r\n> On finding more places to change. May be just find usages of `HoodieTimeline.DELTA_COMMIT_ACTION` ? and see if anything needs more needs to be done?\r\n\r\nYes, can be merged after CI passes.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757385601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757396445","html_url":"https://github.com/apache/hudi/pull/2379#issuecomment-757396445","issue_url":"https://api.github.com/repos/apache/hudi/issues/2379","id":757396445,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzM5NjQ0NQ==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T01:29:00Z","updated_at":"2021-01-10T01:29:00Z","author_association":"CONTRIBUTOR","body":"@lw309637554 Thanks for promptly responding to the comments. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757396445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757402997","html_url":"https://github.com/apache/hudi/pull/2424#issuecomment-757402997","issue_url":"https://api.github.com/repos/apache/hudi/issues/2424","id":757402997,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzQwMjk5Nw==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T02:41:39Z","updated_at":"2021-01-10T02:41:39Z","author_association":"CONTRIBUTOR","body":"@prashantwason can you review this ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757402997/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757403445","html_url":"https://github.com/apache/hudi/pull/2424#issuecomment-757403445","issue_url":"https://api.github.com/repos/apache/hudi/issues/2424","id":757403445,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzQwMzQ0NQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T02:47:02Z","updated_at":"2021-01-14T02:39:31Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2424?src=pr&el=h1) Report\n> Merging [#2424](https://codecov.io/gh/apache/hudi/pull/2424?src=pr&el=desc) (a5d028a) into [master](https://codecov.io/gh/apache/hudi/commit/368c1a8f5c36d06ed49706b4afde4a83073a9011?el=desc) (368c1a8) will **increase** coverage by `0.18%`.\n> The diff coverage is `69.23%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2424/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2424?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2424      +/-   ##\n============================================\n+ Coverage     50.53%   50.71%   +0.18%     \n- Complexity     3032     3060      +28     \n============================================\n  Files           417      419       +2     \n  Lines         18727    18796      +69     \n  Branches       1917     1922       +5     \n============================================\n+ Hits           9463     9533      +70     \n+ Misses         8489     8486       -3     \n- Partials        775      777       +2     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `37.26% <ø> (-0.02%)` | `0.00 <ø> (ø)` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `51.99% <75.00%> (+0.37%)` | `0.00 <3.00> (ø)` | |\n| hudiflink | `10.20% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.06% <0.00%> (+0.05%)` | `0.00 <0.00> (ø)` | |\n| hudisparkdatasource | `65.90% <ø> (-0.22%)` | `0.00 <ø> (ø)` | |\n| hudisync | `48.61% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `66.84% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.43% <ø> (+0.01%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2424?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...hadoop/realtime/RealtimeCompactedRecordReader.java](https://codecov.io/gh/apache/hudi/pull/2424/diff?src=pr&el=tree#diff-aHVkaS1oYWRvb3AtbXIvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaGFkb29wL3JlYWx0aW1lL1JlYWx0aW1lQ29tcGFjdGVkUmVjb3JkUmVhZGVyLmphdmE=) | `72.72% <0.00%> (ø)` | `12.00 <0.00> (ø)` | |\n| [...ain/java/org/apache/hudi/avro/HoodieAvroUtils.java](https://codecov.io/gh/apache/hudi/pull/2424/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvYXZyby9Ib29kaWVBdnJvVXRpbHMuamF2YQ==) | `56.09% <75.00%> (-1.19%)` | `37.00 <3.00> (-4.00)` | |\n| [...n/scala/org/apache/hudi/HoodieSparkSqlWriter.scala](https://codecov.io/gh/apache/hudi/pull/2424/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL0hvb2RpZVNwYXJrU3FsV3JpdGVyLnNjYWxh) | `48.75% <0.00%> (-0.71%)` | `0.00% <0.00%> (ø%)` | |\n| [...g/apache/hudi/MergeOnReadIncrementalRelation.scala](https://codecov.io/gh/apache/hudi/pull/2424/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL01lcmdlT25SZWFkSW5jcmVtZW50YWxSZWxhdGlvbi5zY2FsYQ==) | `82.20% <0.00%> (-0.30%)` | `21.00% <0.00%> (ø%)` | |\n| [.../org/apache/hudi/cli/commands/MetadataCommand.java](https://codecov.io/gh/apache/hudi/pull/2424/diff?src=pr&el=tree#diff-aHVkaS1jbGkvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY2xpL2NvbW1hbmRzL01ldGFkYXRhQ29tbWFuZC5qYXZh) | `1.11% <0.00%> (-0.02%)` | `1.00% <0.00%> (ø%)` | |\n| [...va/org/apache/hudi/metadata/BaseTableMetadata.java](https://codecov.io/gh/apache/hudi/pull/2424/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvbWV0YWRhdGEvQmFzZVRhYmxlTWV0YWRhdGEuamF2YQ==) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (ø%)` | |\n| [.../org/apache/hudi/metadata/HoodieTableMetadata.java](https://codecov.io/gh/apache/hudi/pull/2424/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvbWV0YWRhdGEvSG9vZGllVGFibGVNZXRhZGF0YS5qYXZh) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (ø%)` | |\n| [.../apache/hudi/metadata/HoodieTableMetadataUtil.java](https://codecov.io/gh/apache/hudi/pull/2424/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvbWV0YWRhdGEvSG9vZGllVGFibGVNZXRhZGF0YVV0aWwuamF2YQ==) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (ø%)` | |\n| [...pache/hudi/common/config/HoodieMetadataConfig.java](https://codecov.io/gh/apache/hudi/pull/2424/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2NvbmZpZy9Ib29kaWVNZXRhZGF0YUNvbmZpZy5qYXZh) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (ø%)` | |\n| [...pache/hudi/metadata/HoodieBackedTableMetadata.java](https://codecov.io/gh/apache/hudi/pull/2424/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvbWV0YWRhdGEvSG9vZGllQmFja2VkVGFibGVNZXRhZGF0YS5qYXZh) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (ø%)` | |\n| ... and [18 more](https://codecov.io/gh/apache/hudi/pull/2424/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757403445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757404344","html_url":"https://github.com/apache/hudi/pull/1938#issuecomment-757404344","issue_url":"https://api.github.com/repos/apache/hudi/issues/1938","id":757404344,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzQwNDM0NA==","user":{"login":"garyli1019","id":23007841,"node_id":"MDQ6VXNlcjIzMDA3ODQx","avatar_url":"https://avatars.githubusercontent.com/u/23007841?v=4","gravatar_id":"","url":"https://api.github.com/users/garyli1019","html_url":"https://github.com/garyli1019","followers_url":"https://api.github.com/users/garyli1019/followers","following_url":"https://api.github.com/users/garyli1019/following{/other_user}","gists_url":"https://api.github.com/users/garyli1019/gists{/gist_id}","starred_url":"https://api.github.com/users/garyli1019/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garyli1019/subscriptions","organizations_url":"https://api.github.com/users/garyli1019/orgs","repos_url":"https://api.github.com/users/garyli1019/repos","events_url":"https://api.github.com/users/garyli1019/events{/privacy}","received_events_url":"https://api.github.com/users/garyli1019/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T02:57:10Z","updated_at":"2021-01-10T02:57:10Z","author_association":"MEMBER","body":"#2425 will fix the build","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757404344/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757404557","html_url":"https://github.com/apache/hudi/pull/2425#issuecomment-757404557","issue_url":"https://api.github.com/repos/apache/hudi/issues/2425","id":757404557,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzQwNDU1Nw==","user":{"login":"garyli1019","id":23007841,"node_id":"MDQ6VXNlcjIzMDA3ODQx","avatar_url":"https://avatars.githubusercontent.com/u/23007841?v=4","gravatar_id":"","url":"https://api.github.com/users/garyli1019","html_url":"https://github.com/garyli1019","followers_url":"https://api.github.com/users/garyli1019/followers","following_url":"https://api.github.com/users/garyli1019/following{/other_user}","gists_url":"https://api.github.com/users/garyli1019/gists{/gist_id}","starred_url":"https://api.github.com/users/garyli1019/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garyli1019/subscriptions","organizations_url":"https://api.github.com/users/garyli1019/orgs","repos_url":"https://api.github.com/users/garyli1019/repos","events_url":"https://api.github.com/users/garyli1019/events{/privacy}","received_events_url":"https://api.github.com/users/garyli1019/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T02:59:42Z","updated_at":"2021-01-10T02:59:42Z","author_association":"MEMBER","body":"@vinothchandar This PR will fix the Spark 3 build. This `SparkHadoopUtil` is unnecessary and we removed it from MOR snapshot relation too.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757404557/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757404921","html_url":"https://github.com/apache/hudi/pull/2425#issuecomment-757404921","issue_url":"https://api.github.com/repos/apache/hudi/issues/2425","id":757404921,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzQwNDkyMQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T03:02:41Z","updated_at":"2021-01-10T03:51:54Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2425?src=pr&el=h1) Report\n> Merging [#2425](https://codecov.io/gh/apache/hudi/pull/2425?src=pr&el=desc) (5ff3061) into [master](https://codecov.io/gh/apache/hudi/commit/368c1a8f5c36d06ed49706b4afde4a83073a9011?el=desc) (368c1a8) will **increase** coverage by `0.00%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2425/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2425?src=pr&el=tree)\n\n```diff\n@@            Coverage Diff            @@\n##             master    #2425   +/-   ##\n=========================================\n  Coverage     50.53%   50.53%           \n  Complexity     3032     3032           \n=========================================\n  Files           417      417           \n  Lines         18727    18725    -2     \n  Branches       1917     1917           \n=========================================\n  Hits           9463     9463           \n+ Misses         8489     8488    -1     \n+ Partials        775      774    -1     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `37.28% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `51.63% <ø> (+0.02%)` | `0.00 <ø> (ø)` | |\n| hudiflink | `10.20% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisparkdatasource | `66.07% <ø> (-0.05%)` | `0.00 <ø> (ø)` | |\n| hudisync | `48.61% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `66.84% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.41% <ø> (ø)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2425?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...g/apache/hudi/MergeOnReadIncrementalRelation.scala](https://codecov.io/gh/apache/hudi/pull/2425/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL01lcmdlT25SZWFkSW5jcmVtZW50YWxSZWxhdGlvbi5zY2FsYQ==) | `82.20% <ø> (-0.30%)` | `21.00 <0.00> (ø)` | |\n| [...e/hudi/common/table/log/HoodieLogFormatWriter.java](https://codecov.io/gh/apache/hudi/pull/2425/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9Ib29kaWVMb2dGb3JtYXRXcml0ZXIuamF2YQ==) | `79.68% <0.00%> (+1.56%)` | `26.00% <0.00%> (ø%)` | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757404921/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757419558","html_url":"https://github.com/apache/hudi/pull/2196#issuecomment-757419558","issue_url":"https://api.github.com/repos/apache/hudi/issues/2196","id":757419558,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzQxOTU1OA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T05:25:43Z","updated_at":"2021-01-10T05:25:43Z","author_association":"MEMBER","body":"@lw309637554 @n3nash @satishkotha \r\n\r\nI have been trying to test master branch and the following change to make `Overwrite` be a INSERT_OVERWRITE_TABLE, adds complexity IMO - esp given interplay with newer features like table metadata. \r\n\r\nWhat's the rationale behind this? Just to make the operation faster over the previous fs.delete() based approach? I mean, ultimately someone needs to do these deletes no.\r\n\r\n\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757419558/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757432014","html_url":"https://github.com/apache/hudi/pull/2417#issuecomment-757432014","issue_url":"https://api.github.com/repos/apache/hudi/issues/2417","id":757432014,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzQzMjAxNA==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T07:33:32Z","updated_at":"2021-01-10T07:33:32Z","author_association":"CONTRIBUTOR","body":"@vinothchandar @umehrot2 Added a test class, can you ptal ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757432014/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757443274","html_url":"https://github.com/apache/hudi/pull/2426#issuecomment-757443274","issue_url":"https://api.github.com/repos/apache/hudi/issues/2426","id":757443274,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzQ0MzI3NA==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T09:14:38Z","updated_at":"2021-01-22T03:02:52Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2426?src=pr&el=h1) Report\n> Merging [#2426](https://codecov.io/gh/apache/hudi/pull/2426?src=pr&el=desc) (9cb1268) into [master](https://codecov.io/gh/apache/hudi/commit/e926c1a45ca95fa1911f6f88a0577554f2797760?el=desc) (e926c1a) will **decrease** coverage by `0.20%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2426/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2426?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2426      +/-   ##\n============================================\n- Coverage     50.73%   50.52%   -0.21%     \n+ Complexity     3064     3032      -32     \n============================================\n  Files           419      417       -2     \n  Lines         18797    18725      -72     \n  Branches       1922     1917       -5     \n============================================\n- Hits           9536     9461      -75     \n- Misses         8485     8489       +4     \n+ Partials        776      775       -1     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `37.28% <ø> (+0.01%)` | `0.00 <ø> (ø)` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `51.61% <ø> (-0.41%)` | `0.00 <ø> (ø)` | |\n| hudiflink | `10.20% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.00% <ø> (-0.06%)` | `0.00 <ø> (ø)` | |\n| hudisparkdatasource | `66.07% <ø> (+0.16%)` | `0.00 <ø> (ø)` | |\n| hudisync | `48.61% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `66.84% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.41% <ø> (-0.02%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2426?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...apache/hudi/common/engine/TaskContextSupplier.java](https://codecov.io/gh/apache/hudi/pull/2426/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2VuZ2luZS9UYXNrQ29udGV4dFN1cHBsaWVyLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [...e/hudi/metadata/FileSystemBackedTableMetadata.java](https://codecov.io/gh/apache/hudi/pull/2426/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvbWV0YWRhdGEvRmlsZVN5c3RlbUJhY2tlZFRhYmxlTWV0YWRhdGEuamF2YQ==) | `0.00% <0.00%> (-94.60%)` | `0.00% <0.00%> (-13.00%)` | |\n| [...apache/hudi/common/engine/HoodieEngineContext.java](https://codecov.io/gh/apache/hudi/pull/2426/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2VuZ2luZS9Ib29kaWVFbmdpbmVDb250ZXh0LmphdmE=) | `0.00% <0.00%> (-66.67%)` | `0.00% <0.00%> (-1.00%)` | |\n| [...g/apache/hudi/common/function/FunctionWrapper.java](https://codecov.io/gh/apache/hudi/pull/2426/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2Z1bmN0aW9uL0Z1bmN0aW9uV3JhcHBlci5qYXZh) | `0.00% <0.00%> (-10.53%)` | `0.00% <0.00%> (-2.00%)` | |\n| [...ache/hudi/common/fs/inline/InMemoryFileSystem.java](https://codecov.io/gh/apache/hudi/pull/2426/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2ZzL2lubGluZS9Jbk1lbW9yeUZpbGVTeXN0ZW0uamF2YQ==) | `79.31% <0.00%> (-10.35%)` | `15.00% <0.00%> (-1.00%)` | |\n| [...c/main/java/org/apache/hudi/common/fs/FSUtils.java](https://codecov.io/gh/apache/hudi/pull/2426/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2ZzL0ZTVXRpbHMuamF2YQ==) | `45.71% <0.00%> (-6.18%)` | `55.00% <0.00%> (-6.00%)` | |\n| [...pache/hudi/common/table/HoodieTableMetaClient.java](https://codecov.io/gh/apache/hudi/pull/2426/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL0hvb2RpZVRhYmxlTWV0YUNsaWVudC5qYXZh) | `68.96% <0.00%> (-1.73%)` | `43.00% <0.00%> (-2.00%)` | |\n| [...i/common/table/timeline/TimelineMetadataUtils.java](https://codecov.io/gh/apache/hudi/pull/2426/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL3RpbWVsaW5lL1RpbWVsaW5lTWV0YWRhdGFVdGlscy5qYXZh) | `71.69% <0.00%> (-1.03%)` | `17.00% <0.00%> (ø%)` | |\n| [...rg/apache/hudi/hadoop/HoodieROTablePathFilter.java](https://codecov.io/gh/apache/hudi/pull/2426/diff?src=pr&el=tree#diff-aHVkaS1oYWRvb3AtbXIvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaGFkb29wL0hvb2RpZVJPVGFibGVQYXRoRmlsdGVyLmphdmE=) | `63.15% <0.00%> (-0.48%)` | `12.00% <0.00%> (ø%)` | |\n| [...ava/org/apache/hudi/common/HoodieRollbackStat.java](https://codecov.io/gh/apache/hudi/pull/2426/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL0hvb2RpZVJvbGxiYWNrU3RhdC5qYXZh) | `31.25% <0.00%> (-0.33%)` | `5.00% <0.00%> (-1.00%)` | |\n| ... and [15 more](https://codecov.io/gh/apache/hudi/pull/2426/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757443274/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757470948","html_url":"https://github.com/apache/hudi/pull/2427#issuecomment-757470948","issue_url":"https://api.github.com/repos/apache/hudi/issues/2427","id":757470948,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzQ3MDk0OA==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T12:48:52Z","updated_at":"2021-01-10T13:02:41Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2427?src=pr&el=h1) Report\n> Merging [#2427](https://codecov.io/gh/apache/hudi/pull/2427?src=pr&el=desc) (00e919f) into [master](https://codecov.io/gh/apache/hudi/commit/23e93d05c02775b0c518a2da160810b23bb4bca4?el=desc) (23e93d0) will **decrease** coverage by `0.00%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2427/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2427?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2427      +/-   ##\n============================================\n- Coverage     50.54%   50.53%   -0.01%     \n+ Complexity     3033     3032       -1     \n============================================\n  Files           417      417              \n  Lines         18725    18725              \n  Branches       1917     1917              \n============================================\n- Hits           9464     9463       -1     \n  Misses         8488     8488              \n- Partials        773      774       +1     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `37.28% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `51.63% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiflink | `10.20% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisparkdatasource | `66.07% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisync | `48.61% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `66.84% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.41% <ø> (-0.06%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2427?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...apache/hudi/utilities/deltastreamer/DeltaSync.java](https://codecov.io/gh/apache/hudi/pull/2427/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvRGVsdGFTeW5jLmphdmE=) | `70.50% <0.00%> (-0.36%)` | `50.00% <0.00%> (-1.00%)` | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757470948/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757473127","html_url":"https://github.com/apache/hudi/pull/2196#issuecomment-757473127","issue_url":"https://api.github.com/repos/apache/hudi/issues/2196","id":757473127,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzQ3MzEyNw==","user":{"login":"lw309637554","id":8501994,"node_id":"MDQ6VXNlcjg1MDE5OTQ=","avatar_url":"https://avatars.githubusercontent.com/u/8501994?v=4","gravatar_id":"","url":"https://api.github.com/users/lw309637554","html_url":"https://github.com/lw309637554","followers_url":"https://api.github.com/users/lw309637554/followers","following_url":"https://api.github.com/users/lw309637554/following{/other_user}","gists_url":"https://api.github.com/users/lw309637554/gists{/gist_id}","starred_url":"https://api.github.com/users/lw309637554/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lw309637554/subscriptions","organizations_url":"https://api.github.com/users/lw309637554/orgs","repos_url":"https://api.github.com/users/lw309637554/repos","events_url":"https://api.github.com/users/lw309637554/events{/privacy}","received_events_url":"https://api.github.com/users/lw309637554/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T13:04:28Z","updated_at":"2021-01-10T13:04:28Z","author_association":"CONTRIBUTOR","body":"> @lw309637554 @n3nash @satishkotha\r\n> \r\n> I have been trying to test master branch and the following change to make `Overwrite` be a INSERT_OVERWRITE_TABLE, adds complexity IMO - esp given interplay with newer features like table metadata.\r\n> \r\n> What's the rationale behind this? Just to make the operation faster over the previous fs.delete() based approach? I mean, ultimately someone needs to do these deletes no.\r\n\r\n@vinothchandar  Hello,\r\nthe original intention of this function is that, users can be able to recover accidentally deleted when using INSERT_OVERWRITE_TABLE, if the replace file have not been cleaned. The old fs.delete needs to retrieve data from the data source , it is complex.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757473127/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757498877","html_url":"https://github.com/apache/hudi/pull/2196#issuecomment-757498877","issue_url":"https://api.github.com/repos/apache/hudi/issues/2196","id":757498877,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzQ5ODg3Nw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T15:58:09Z","updated_at":"2021-01-10T16:00:25Z","author_association":"MEMBER","body":"@lw309637554 sounds good. but I think we should have made this configurable and make the old behavior the default. `spark.write...mode(\"overwrite\")` is a very common operation, and I'd prefer to not have this dependent on such new feature. Do you have cycles to do this in the next few hours?  Please let me know. @n3nash can you drive this otherwise? \r\n\r\ngeneral rule of thumb: new features should be guarded by a flag, turned off by default, until deemed stable after release. :) lets please uphold this. Happy to discuss more if needed. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757498877/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757504672","html_url":"https://github.com/apache/hudi/pull/2196#issuecomment-757504672","issue_url":"https://api.github.com/repos/apache/hudi/issues/2196","id":757504672,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzUwNDY3Mg==","user":{"login":"lw309637554","id":8501994,"node_id":"MDQ6VXNlcjg1MDE5OTQ=","avatar_url":"https://avatars.githubusercontent.com/u/8501994?v=4","gravatar_id":"","url":"https://api.github.com/users/lw309637554","html_url":"https://github.com/lw309637554","followers_url":"https://api.github.com/users/lw309637554/followers","following_url":"https://api.github.com/users/lw309637554/following{/other_user}","gists_url":"https://api.github.com/users/lw309637554/gists{/gist_id}","starred_url":"https://api.github.com/users/lw309637554/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lw309637554/subscriptions","organizations_url":"https://api.github.com/users/lw309637554/orgs","repos_url":"https://api.github.com/users/lw309637554/repos","events_url":"https://api.github.com/users/lw309637554/events{/privacy}","received_events_url":"https://api.github.com/users/lw309637554/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T16:37:16Z","updated_at":"2021-01-10T17:31:03Z","author_association":"CONTRIBUTOR","body":"> @lw309637554 sounds good. but I think we should have made this configurable and make the old behavior the default. `spark.write...mode(\"overwrite\")` is a very common operation, and I'd prefer to not have this dependent on such new feature. Do you have cycles to do this in the next few hours? Please let me know. @n3nash can you drive this otherwise?\r\n> \r\n> general rule of thumb: new features should be guarded by a flag, turned off by default, until deemed stable after release. :) lets please uphold this. Happy to discuss more if needed.\r\n\r\n@vinothchandar okay, i can add the configure now. Will land it in https://github.com/apache/hudi/pull/2428  cc @n3nash ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757504672/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757513436","html_url":"https://github.com/apache/hudi/pull/2428#issuecomment-757513436","issue_url":"https://api.github.com/repos/apache/hudi/issues/2428","id":757513436,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzUxMzQzNg==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T17:35:19Z","updated_at":"2021-01-11T04:51:21Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2428?src=pr&el=h1) Report\n> Merging [#2428](https://codecov.io/gh/apache/hudi/pull/2428?src=pr&el=desc) (02ef4dc) into [master](https://codecov.io/gh/apache/hudi/commit/23e93d05c02775b0c518a2da160810b23bb4bca4?el=desc) (23e93d0) will **decrease** coverage by `0.01%`.\n> The diff coverage is `0.00%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2428/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2428?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2428      +/-   ##\n============================================\n- Coverage     50.54%   50.52%   -0.02%     \n+ Complexity     3033     3032       -1     \n============================================\n  Files           417      417              \n  Lines         18725    18727       +2     \n  Branches       1917     1917              \n============================================\n- Hits           9464     9462       -2     \n- Misses         8488     8491       +3     \n- Partials        773      774       +1     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `37.28% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `51.63% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiflink | `10.20% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisparkdatasource | `65.90% <0.00%> (-0.17%)` | `0.00 <0.00> (ø)` | |\n| hudisync | `48.61% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `66.84% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.41% <ø> (-0.06%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2428?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...n/scala/org/apache/hudi/HoodieSparkSqlWriter.scala](https://codecov.io/gh/apache/hudi/pull/2428/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL0hvb2RpZVNwYXJrU3FsV3JpdGVyLnNjYWxh) | `48.75% <0.00%> (-0.71%)` | `0.00 <0.00> (ø)` | |\n| [...apache/hudi/utilities/deltastreamer/DeltaSync.java](https://codecov.io/gh/apache/hudi/pull/2428/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvRGVsdGFTeW5jLmphdmE=) | `70.50% <0.00%> (-0.36%)` | `50.00% <0.00%> (-1.00%)` | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757513436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757531637","html_url":"https://github.com/apache/hudi/pull/1938#issuecomment-757531637","issue_url":"https://api.github.com/repos/apache/hudi/issues/1938","id":757531637,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzUzMTYzNw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T19:40:24Z","updated_at":"2021-01-10T19:40:35Z","author_association":"MEMBER","body":"Seems like this test is flaky. :(  @garyli1019 \r\n\r\n```\r\n[INFO] \r\n[ERROR] Failures: \r\n[ERROR]   TestMORDataSource.testCount:310 expected: <152> but was: <2>\r\n```\r\n\r\nhttps://api.travis-ci.com/v3/job/470167079/log.txt","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757531637/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757532170","html_url":"https://github.com/apache/hudi/pull/2424#issuecomment-757532170","issue_url":"https://api.github.com/repos/apache/hudi/issues/2424","id":757532170,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzUzMjE3MA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T19:43:53Z","updated_at":"2021-01-10T19:43:53Z","author_association":"MEMBER","body":"@n3nash please keep tagging PRs intended as release blockers with the right label","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757532170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757532306","html_url":"https://github.com/apache/hudi/pull/2424#issuecomment-757532306","issue_url":"https://api.github.com/repos/apache/hudi/issues/2424","id":757532306,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzUzMjMwNg==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T19:44:38Z","updated_at":"2021-01-10T19:44:38Z","author_association":"MEMBER","body":"@n3nash what is the commit being reverted?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757532306/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757540328","html_url":"https://github.com/apache/hudi/issues/2429#issuecomment-757540328","issue_url":"https://api.github.com/repos/apache/hudi/issues/2429","id":757540328,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzU0MDMyOA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T20:39:16Z","updated_at":"2021-01-10T20:39:16Z","author_association":"MEMBER","body":"Just bumping up `sc.hadoopConfiguration.setInt(\"fs.s3a.connection.maximum\", 100)` makes the job go forward more rounds of writing. There is some kind of leak somewhere. \r\n\r\ncc @prashantwason ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757540328/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757542288","html_url":"https://github.com/apache/hudi/pull/2417#issuecomment-757542288","issue_url":"https://api.github.com/repos/apache/hudi/issues/2417","id":757542288,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzU0MjI4OA==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T20:52:50Z","updated_at":"2021-01-10T20:52:50Z","author_association":"CONTRIBUTOR","body":"@vinothchandar Addressed comments, moved `HoodieJavaEngineContext` to hudi-common and remove `HoodieLocalEngineContext`","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757542288/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757542553","html_url":"https://github.com/apache/hudi/pull/2417#issuecomment-757542553","issue_url":"https://api.github.com/repos/apache/hudi/issues/2417","id":757542553,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzU0MjU1Mw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T20:54:30Z","updated_at":"2021-01-10T20:54:37Z","author_association":"MEMBER","body":"> moved HoodieJavaEngineContext to hudi-common and remove HoodieLocalEngineContext\r\n\r\nLet's not do this. Please revert back. We discussed this before and chose to deliberately keep `HoodieJavaEngineContext` untouched. Every other engine context lives with its client. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757542553/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757545756","html_url":"https://github.com/apache/hudi/issues/2429#issuecomment-757545756","issue_url":"https://api.github.com/repos/apache/hudi/issues/2429","id":757545756,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzU0NTc1Ng==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T21:19:21Z","updated_at":"2021-01-10T21:19:21Z","author_association":"MEMBER","body":"@nsivabalan can you please add the stacktrace you saw?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757545756/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757551994","html_url":"https://github.com/apache/hudi/pull/2421#issuecomment-757551994","issue_url":"https://api.github.com/repos/apache/hudi/issues/2421","id":757551994,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzU1MTk5NA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T22:05:46Z","updated_at":"2021-01-10T22:05:46Z","author_association":"CONTRIBUTOR","body":"@vinothchandar : you are good to review the patch. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757551994/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757552669","html_url":"https://github.com/apache/hudi/issues/2429#issuecomment-757552669","issue_url":"https://api.github.com/repos/apache/hudi/issues/2429","id":757552669,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzU1MjY2OQ==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T22:11:40Z","updated_at":"2021-01-10T22:11:40Z","author_association":"CONTRIBUTOR","body":"sure. \r\nI ran a long running test-suite job in cluster. w/o metadata listing enabled, things were good. But w/ metadata enabled, ran into too many open files problems after 20 iterations(each iteration has inserts, updates, deletes, spark datasource read) \r\n\r\n```\r\n21/01/10 06:42:04 WARN TaskSetManager: Lost task 0.0 in stage 3909.0 (TID 455057, agent6922-abc.com, executor 1): java.io.UncheckedIOException: java.net.SocketException: Too many open files\r\n        at org.apache.hudi.integ.testsuite.generator.DeltaGenerator.lambda$writeRecords$5e8e5895$1(DeltaGenerator.java:123)\r\n        at org.apache.spark.api.java.JavaRDDLike$$anonfun$fn$4$1.apply(JavaRDDLike.scala:153)\r\n        at org.apache.spark.api.java.JavaRDDLike$$anonfun$fn$4$1.apply(JavaRDDLike.scala:153)\r\n        at org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:801)\r\n        at org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:801)\r\n        at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n        at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\r\n        at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\r\n        at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n        at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\r\n        at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\r\n        at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n        at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\r\n        at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\r\n        at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\r\n        at org.apache.spark.scheduler.Task.run(Task.scala:123)\r\n        at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)\r\n        at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)\r\n        at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n               at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n        at java.lang.Thread.run(Thread.java:748)\r\nCaused by: java.net.SocketException: Too many open files\r\n        at sun.nio.ch.Net.socket0(Native Method)\r\n        at sun.nio.ch.Net.socket(Net.java:411)\r\n        at sun.nio.ch.Net.socket(Net.java:404)\r\n        at sun.nio.ch.SocketChannelImpl.<init>(SocketChannelImpl.java:105)\r\n        at sun.nio.ch.SelectorProviderImpl.openSocketChannel(SelectorProviderImpl.java:60)\r\n        at java.nio.channels.SocketChannel.open(SocketChannel.java:145)\r\n        at org.apache.hadoop.net.StandardSocketFactory.createSocket(StandardSocketFactory.java:62)\r\n        at org.apache.hadoop.hdfs.DFSOutputStream.createSocketForPipeline(DFSOutputStream.java:1531)\r\n        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.createBlockOutputStream(DFSOutputStream.java:1309)\r\n        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.nextBlockOutputStream(DFSOutputStream.java:1262)\r\n        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.run(DFSOutputStream.java:448)\r\n\r\n21/01/10 06:42:05 WARN TaskSetManager: Lost task 3.0 in stage 3911.0 (TID 455068, agent6922-abc.com, executor 1): java.io.FileNotFoundException: /opt/hudi/shared/yarn/cache/data/nm/usercache/sivabala/appcache/application_1609962097310_747119/blockmgr-7f5d0680-3597-426f-8a2b-29f7411e130b/0c/temp_shuffle_a70e65a8-3e98-4d5a-a714-ef3c44c2fe4e (Too many open files)\r\n        at java.io.FileOutputStream.open0(Native Method)\r\n        at java.io.FileOutputStream.open(FileOutputStream.java:270)\r\n        at java.io.FileOutputStream.<init>(FileOutputStream.java:213)\r\n        at org.apache.spark.storage.DiskBlockObjectWriter.initialize(DiskBlockObjectWriter.scala:103)\r\n        at org.apache.spark.storage.DiskBlockObjectWriter.open(DiskBlockObjectWriter.scala:116)\r\n        at org.apache.spark.storage.DiskBlockObjectWriter.write(DiskBlockObjectWriter.scala:237)\r\n        at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:151)\r\n            at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)\r\n        at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)\r\n        at org.apache.spark.scheduler.Task.run(Task.scala:123)\r\n        at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)\r\n        at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)\r\n        at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n        at java.lang.Thread.run(Thread.java:748)\r\n\r\n21/01/10 06:42:05 WARN TaskSetManager: Lost task 1.0 in stage 3911.0 (TID 455066, agent6922-abc.com, executor 1): java.io.FileNotFoundException: /opt/hudi/shared/yarn/cache/data/nm/usercache/sivabala/appcache/application_1609962097310_747119/blockmgr-7f5d0680-3597-426f-8a2b-29f7411e130b/03/temp_shuffle_f362ca47-2b91-457a-b3ca-33570de418bd (Too many open files)\r\n        at java.io.FileOutputStream.open0(Native Method)\r\n        at java.io.FileOutputStream.open(FileOutputStream.java:270)\r\n        at java.io.FileOutputStream.<init>(FileOutputStream.java:213)\r\n        at org.apache.spark.storage.DiskBlockObjectWriter.initialize(DiskBlockObjectWriter.scala:103)\r\n        at org.apache.spark.storage.DiskBlockObjectWriter.open(DiskBlockObjectWriter.scala:116)\r\n        at org.apache.spark.storage.DiskBlockObjectWriter.write(DiskBlockObjectWriter.scala:237)\r\n        at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:151)\r\n        at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)\r\n        at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)\r\n        at org.apache.spark.scheduler.Task.run(Task.scala:123)\r\n        at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)\r\n        at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)\r\n        at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n        at java.lang.Thread.run(Thread.java:748)\r\n\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757552669/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757573470","html_url":"https://github.com/apache/hudi/pull/2417#issuecomment-757573470","issue_url":"https://api.github.com/repos/apache/hudi/issues/2417","id":757573470,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzU3MzQ3MA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-11T00:38:31Z","updated_at":"2021-01-11T00:38:31Z","author_association":"MEMBER","body":"@n3nash please drop me a ping once the CI is happy","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757573470/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757588401","html_url":"https://github.com/apache/hudi/pull/1938#issuecomment-757588401","issue_url":"https://api.github.com/repos/apache/hudi/issues/1938","id":757588401,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzU4ODQwMQ==","user":{"login":"garyli1019","id":23007841,"node_id":"MDQ6VXNlcjIzMDA3ODQx","avatar_url":"https://avatars.githubusercontent.com/u/23007841?v=4","gravatar_id":"","url":"https://api.github.com/users/garyli1019","html_url":"https://github.com/garyli1019","followers_url":"https://api.github.com/users/garyli1019/followers","following_url":"https://api.github.com/users/garyli1019/following{/other_user}","gists_url":"https://api.github.com/users/garyli1019/gists{/gist_id}","starred_url":"https://api.github.com/users/garyli1019/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garyli1019/subscriptions","organizations_url":"https://api.github.com/users/garyli1019/orgs","repos_url":"https://api.github.com/users/garyli1019/repos","events_url":"https://api.github.com/users/garyli1019/events{/privacy}","received_events_url":"https://api.github.com/users/garyli1019/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-11T02:01:24Z","updated_at":"2021-01-11T06:15:57Z","author_association":"MEMBER","body":"> Seems like this test is flaky. :( @garyli1019\r\n> \r\n> ```\r\n> [INFO] \r\n> [ERROR] Failures: \r\n> [ERROR]   TestMORDataSource.testCount:310 expected: <152> but was: <2>\r\n> ```\r\n> \r\n> https://api.travis-ci.com/v3/job/470167079/log.txt\r\n\r\n@vinothchandar This was the compaction consistency question I mentioned in the sync meeting. There are actually 2 new insert records suppose to be here, but we triggered inline compaction that compacted 150 records. Also possible that the compaction was triggered earlier. Might be fixed by #2428 ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757588401/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757736411","html_url":"https://github.com/apache/hudi/pull/2430#issuecomment-757736411","issue_url":"https://api.github.com/repos/apache/hudi/issues/2430","id":757736411,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzczNjQxMQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-11T08:46:53Z","updated_at":"2021-01-25T08:51:36Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2430?src=pr&el=h1) Report\n> Merging [#2430](https://codecov.io/gh/apache/hudi/pull/2430?src=pr&el=desc) (2c4fa32) into [master](https://codecov.io/gh/apache/hudi/commit/c4afd179c1983a382b8a5197d800b0f5dba254de?el=desc) (c4afd17) will **increase** coverage by `0.09%`.\n> The diff coverage is `46.03%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2430/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2430?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2430      +/-   ##\n============================================\n+ Coverage     50.18%   50.27%   +0.09%     \n- Complexity     3050     3119      +69     \n============================================\n  Files           419      430      +11     \n  Lines         18931    19561     +630     \n  Branches       1948     2003      +55     \n============================================\n+ Hits           9500     9835     +335     \n- Misses         8656     8923     +267     \n- Partials        775      803      +28     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `37.21% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `51.51% <44.44%> (+0.02%)` | `0.00 <6.00> (ø)` | |\n| hudiflink | `32.96% <46.05%> (+32.96%)` | `0.00 <64.00> (ø)` | |\n| hudihadoopmr | `33.16% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisparkdatasource | `65.85% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisync | `48.61% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `66.49% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.43% <ø> (ø)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2430?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [.../apache/hudi/operator/InstantGenerateOperator.java](https://codecov.io/gh/apache/hudi/pull/2430/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9vcGVyYXRvci9JbnN0YW50R2VuZXJhdGVPcGVyYXRvci5qYXZh) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (ø)` | |\n| [...pache/hudi/operator/KeyedWriteProcessFunction.java](https://codecov.io/gh/apache/hudi/pull/2430/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9vcGVyYXRvci9LZXllZFdyaXRlUHJvY2Vzc0Z1bmN0aW9uLmphdmE=) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (ø)` | |\n| [.../org/apache/hudi/operator/StreamWriteOperator.java](https://codecov.io/gh/apache/hudi/pull/2430/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9vcGVyYXRvci9TdHJlYW1Xcml0ZU9wZXJhdG9yLmphdmE=) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (?)` | |\n| [...ache/hudi/operator/StreamWriteOperatorFactory.java](https://codecov.io/gh/apache/hudi/pull/2430/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9vcGVyYXRvci9TdHJlYW1Xcml0ZU9wZXJhdG9yRmFjdG9yeS5qYXZh) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (?)` | |\n| [...in/java/org/apache/hudi/schema/SchemaProvider.java](https://codecov.io/gh/apache/hudi/pull/2430/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zY2hlbWEvU2NoZW1hUHJvdmlkZXIuamF2YQ==) | `50.00% <ø> (+50.00%)` | `1.00 <0.00> (+1.00)` | |\n| [...src/main/java/org/apache/hudi/sink/CommitSink.java](https://codecov.io/gh/apache/hudi/pull/2430/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL0NvbW1pdFNpbmsuamF2YQ==) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (ø)` | |\n| [...di/source/JsonStringToHoodieRecordMapFunction.java](https://codecov.io/gh/apache/hudi/pull/2430/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zb3VyY2UvSnNvblN0cmluZ1RvSG9vZGllUmVjb3JkTWFwRnVuY3Rpb24uamF2YQ==) | `0.00% <ø> (ø)` | `0.00 <0.00> (ø)` | |\n| [.../org/apache/hudi/streamer/FlinkStreamerConfig.java](https://codecov.io/gh/apache/hudi/pull/2430/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zdHJlYW1lci9GbGlua1N0cmVhbWVyQ29uZmlnLmphdmE=) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (?)` | |\n| [.../org/apache/hudi/streamer/HoodieFlinkStreamer.java](https://codecov.io/gh/apache/hudi/pull/2430/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zdHJlYW1lci9Ib29kaWVGbGlua1N0cmVhbWVyLmphdmE=) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (?)` | |\n| [...rg/apache/hudi/streamer/HoodieFlinkStreamerV2.java](https://codecov.io/gh/apache/hudi/pull/2430/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zdHJlYW1lci9Ib29kaWVGbGlua1N0cmVhbWVyVjIuamF2YQ==) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (?)` | |\n| ... and [25 more](https://codecov.io/gh/apache/hudi/pull/2430/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757736411/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757929313","html_url":"https://github.com/apache/hudi/pull/2431#issuecomment-757929313","issue_url":"https://api.github.com/repos/apache/hudi/issues/2431","id":757929313,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzkyOTMxMw==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-11T12:45:47Z","updated_at":"2021-02-05T03:54:43Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2431?src=pr&el=h1) Report\n> Merging [#2431](https://codecov.io/gh/apache/hudi/pull/2431?src=pr&el=desc) (e0ac169) into [master](https://codecov.io/gh/apache/hudi/commit/4a5683d54a3910e1c860f26b291e1e99931b5949?el=desc) (4a5683d) will **increase** coverage by `0.02%`.\n> The diff coverage is `90.00%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2431/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2431?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2431      +/-   ##\n============================================\n+ Coverage     50.69%   50.71%   +0.02%     \n+ Complexity     3132     3131       -1     \n============================================\n  Files           430      430              \n  Lines         19596    19602       +6     \n  Branches       2007     2008       +1     \n============================================\n+ Hits           9934     9941       +7     \n+ Misses         8853     8850       -3     \n- Partials        809      811       +2     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `37.21% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `51.43% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiflink | `36.30% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.16% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisparkdatasource | `69.73% <90.00%> (+0.26%)` | `0.00 <0.00> (ø)` | |\n| hudisync | `48.61% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `66.49% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.46% <ø> (-0.06%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2431?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...src/main/scala/org/apache/hudi/DefaultSource.scala](https://codecov.io/gh/apache/hudi/pull/2431/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL0RlZmF1bHRTb3VyY2Uuc2NhbGE=) | `88.23% <90.00%> (-0.48%)` | `15.00 <0.00> (ø)` | |\n| [...apache/hudi/utilities/deltastreamer/DeltaSync.java](https://codecov.io/gh/apache/hudi/pull/2431/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvRGVsdGFTeW5jLmphdmE=) | `70.50% <0.00%> (-0.36%)` | `50.00% <0.00%> (-1.00%)` | |\n| [...n/scala/org/apache/hudi/HoodieSparkSqlWriter.scala](https://codecov.io/gh/apache/hudi/pull/2431/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL0hvb2RpZVNwYXJrU3FsV3JpdGVyLnNjYWxh) | `49.82% <0.00%> (+1.06%)` | `0.00% <0.00%> (ø%)` | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/757929313/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758098600","html_url":"https://github.com/apache/hudi/pull/2421#issuecomment-758098600","issue_url":"https://api.github.com/repos/apache/hudi/issues/2421","id":758098600,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODA5ODYwMA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-11T17:19:29Z","updated_at":"2021-01-11T17:19:29Z","author_association":"MEMBER","body":"@nsivabalan pushed some small fixes. Please land once CI passes","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758098600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758154222","html_url":"https://github.com/apache/hudi/pull/2424#issuecomment-758154222","issue_url":"https://api.github.com/repos/apache/hudi/issues/2424","id":758154222,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODE1NDIyMg==","user":{"login":"pratyakshsharma","id":30863489,"node_id":"MDQ6VXNlcjMwODYzNDg5","avatar_url":"https://avatars.githubusercontent.com/u/30863489?v=4","gravatar_id":"","url":"https://api.github.com/users/pratyakshsharma","html_url":"https://github.com/pratyakshsharma","followers_url":"https://api.github.com/users/pratyakshsharma/followers","following_url":"https://api.github.com/users/pratyakshsharma/following{/other_user}","gists_url":"https://api.github.com/users/pratyakshsharma/gists{/gist_id}","starred_url":"https://api.github.com/users/pratyakshsharma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pratyakshsharma/subscriptions","organizations_url":"https://api.github.com/users/pratyakshsharma/orgs","repos_url":"https://api.github.com/users/pratyakshsharma/repos","events_url":"https://api.github.com/users/pratyakshsharma/events{/privacy}","received_events_url":"https://api.github.com/users/pratyakshsharma/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-11T18:57:07Z","updated_at":"2021-01-11T18:57:07Z","author_association":"CONTRIBUTOR","body":"> @n3nash what is the commit being reverted?\r\n\r\nhttps://github.com/apache/hudi/commit/6d7ca2cf7e441ad19d32d7a25739e454f39ed253","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758154222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758162231","html_url":"https://github.com/apache/hudi/pull/2424#issuecomment-758162231","issue_url":"https://api.github.com/repos/apache/hudi/issues/2424","id":758162231,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODE2MjIzMQ==","user":{"login":"pratyakshsharma","id":30863489,"node_id":"MDQ6VXNlcjMwODYzNDg5","avatar_url":"https://avatars.githubusercontent.com/u/30863489?v=4","gravatar_id":"","url":"https://api.github.com/users/pratyakshsharma","html_url":"https://github.com/pratyakshsharma","followers_url":"https://api.github.com/users/pratyakshsharma/followers","following_url":"https://api.github.com/users/pratyakshsharma/following{/other_user}","gists_url":"https://api.github.com/users/pratyakshsharma/gists{/gist_id}","starred_url":"https://api.github.com/users/pratyakshsharma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pratyakshsharma/subscriptions","organizations_url":"https://api.github.com/users/pratyakshsharma/orgs","repos_url":"https://api.github.com/users/pratyakshsharma/repos","events_url":"https://api.github.com/users/pratyakshsharma/events{/privacy}","received_events_url":"https://api.github.com/users/pratyakshsharma/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-11T19:11:07Z","updated_at":"2021-01-11T19:11:07Z","author_association":"CONTRIBUTOR","body":"@n3nash Just a high level thought before going through the changes thoroughly. How about keeping the old changes also and introduce a config `setDefaultValueWithSchemaEvolutionByDeletingFields` to support schema evolutions in case of deletion of a field? By default we can keep it as false to avoid the degradation as pointed out by @prashantwason . Thoughts?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758162231/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758169722","html_url":"https://github.com/apache/hudi/issues/2346#issuecomment-758169722","issue_url":"https://api.github.com/repos/apache/hudi/issues/2346","id":758169722,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODE2OTcyMg==","user":{"login":"satishkotha","id":2992755,"node_id":"MDQ6VXNlcjI5OTI3NTU=","avatar_url":"https://avatars.githubusercontent.com/u/2992755?v=4","gravatar_id":"","url":"https://api.github.com/users/satishkotha","html_url":"https://github.com/satishkotha","followers_url":"https://api.github.com/users/satishkotha/followers","following_url":"https://api.github.com/users/satishkotha/following{/other_user}","gists_url":"https://api.github.com/users/satishkotha/gists{/gist_id}","starred_url":"https://api.github.com/users/satishkotha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/satishkotha/subscriptions","organizations_url":"https://api.github.com/users/satishkotha/orgs","repos_url":"https://api.github.com/users/satishkotha/repos","events_url":"https://api.github.com/users/satishkotha/events{/privacy}","received_events_url":"https://api.github.com/users/satishkotha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-11T19:24:52Z","updated_at":"2021-01-11T19:24:52Z","author_association":"MEMBER","body":"@sumihehe Did you get a chance to look at above? It'll  be helpful if you can provide more information.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758169722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758320870","html_url":"https://github.com/apache/hudi/issues/2408#issuecomment-758320870","issue_url":"https://api.github.com/repos/apache/hudi/issues/2408","id":758320870,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODMyMDg3MA==","user":{"login":"umehrot2","id":8647012,"node_id":"MDQ6VXNlcjg2NDcwMTI=","avatar_url":"https://avatars.githubusercontent.com/u/8647012?v=4","gravatar_id":"","url":"https://api.github.com/users/umehrot2","html_url":"https://github.com/umehrot2","followers_url":"https://api.github.com/users/umehrot2/followers","following_url":"https://api.github.com/users/umehrot2/following{/other_user}","gists_url":"https://api.github.com/users/umehrot2/gists{/gist_id}","starred_url":"https://api.github.com/users/umehrot2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/umehrot2/subscriptions","organizations_url":"https://api.github.com/users/umehrot2/orgs","repos_url":"https://api.github.com/users/umehrot2/repos","events_url":"https://api.github.com/users/umehrot2/events{/privacy}","received_events_url":"https://api.github.com/users/umehrot2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-12T00:54:28Z","updated_at":"2021-01-12T00:54:28Z","author_association":"CONTRIBUTOR","body":"I took a deeper look at this. For you this seems to be happening in the archival code path:\r\n```\r\n at org.apache.hudi.table.HoodieTimelineArchiveLog.writeToFile(HoodieTimelineArchiveLog.java:309)\r\n at org.apache.hudi.table.HoodieTimelineArchiveLog.archive(HoodieTimelineArchiveLog.java:282)\r\n at org.apache.hudi.table.HoodieTimelineArchiveLog.archiveIfRequired(HoodieTimelineArchiveLog.java:133)\r\n at org.apache.hudi.client.HoodieWriteClient.postCommit(HoodieWriteClient.java:381)\r\n```\r\n\r\nIn `HoodieTimelineArchiveLog` where it needs to write log files with commit record, similar to how log files are written for MOR tables. However, in this code I notice a couple of issues:\r\n- The default maximum log block size of 256 MB defined [here](https://github.com/apache/hudi/blob/master/hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieStorageConfig.java#L51), is not utilized for this class and is only used for the MOR log blocks writing case. As a result, there is no real control over the block size that it can end up writing which can potentially overflow `ByteArrayOutputStream` whose maximum size is `Integer.MAX_VALE - 8`. That is what seems to be happening in this scenario here because of an integer overflow following that code path inside `ByteArrayOutputStream`. So we need to use the maximum block size concept here as well.\r\n- In addition I see a bug in code [here](https://github.com/apache/hudi/blob/master/hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/HoodieTimelineArchiveLog.java#L302) where even after flushing out the records into a file after a batch size of 10 (default) it is not clearing the list and just goes on accumulating the records. This seems logically wrong as well (duplication), apart from the fact that it would keep increasing the log file blocks size it is writing. \r\n\r\nI will open a jira for this issue to track this.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758320870/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758321313","html_url":"https://github.com/apache/hudi/issues/2408#issuecomment-758321313","issue_url":"https://api.github.com/repos/apache/hudi/issues/2408","id":758321313,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODMyMTMxMw==","user":{"login":"umehrot2","id":8647012,"node_id":"MDQ6VXNlcjg2NDcwMTI=","avatar_url":"https://avatars.githubusercontent.com/u/8647012?v=4","gravatar_id":"","url":"https://api.github.com/users/umehrot2","html_url":"https://github.com/umehrot2","followers_url":"https://api.github.com/users/umehrot2/followers","following_url":"https://api.github.com/users/umehrot2/following{/other_user}","gists_url":"https://api.github.com/users/umehrot2/gists{/gist_id}","starred_url":"https://api.github.com/users/umehrot2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/umehrot2/subscriptions","organizations_url":"https://api.github.com/users/umehrot2/orgs","repos_url":"https://api.github.com/users/umehrot2/repos","events_url":"https://api.github.com/users/umehrot2/events{/privacy}","received_events_url":"https://api.github.com/users/umehrot2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-12T00:55:43Z","updated_at":"2021-01-12T00:55:43Z","author_association":"CONTRIBUTOR","body":"For now, I would suggest to archive at smaller intervals. May be try out something like:\r\n- `hoodie.keep.max.commits`: 10\r\n- `hoodie.keep.min.commits`: 10","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758321313/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758321935","html_url":"https://github.com/apache/hudi/pull/2433#issuecomment-758321935","issue_url":"https://api.github.com/repos/apache/hudi/issues/2433","id":758321935,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODMyMTkzNQ==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-12T00:57:35Z","updated_at":"2021-01-12T00:57:35Z","author_association":"CONTRIBUTOR","body":"@loukey-lj thanks for your contribution! Can you please:\r\n\r\n1) Fix the Travis issue? It's red now;\r\n2) Update the RFC-13 and describe your optimization.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758321935/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758327239","html_url":"https://github.com/apache/hudi/pull/2433#issuecomment-758327239","issue_url":"https://api.github.com/repos/apache/hudi/issues/2433","id":758327239,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODMyNzIzOQ==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-12T01:12:31Z","updated_at":"2021-01-12T01:12:31Z","author_association":"CONTRIBUTOR","body":"@danny0405 wdyt about this optimization?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758327239/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758337679","html_url":"https://github.com/apache/hudi/pull/2418#issuecomment-758337679","issue_url":"https://api.github.com/repos/apache/hudi/issues/2418","id":758337679,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODMzNzY3OQ==","user":{"login":"lw309637554","id":8501994,"node_id":"MDQ6VXNlcjg1MDE5OTQ=","avatar_url":"https://avatars.githubusercontent.com/u/8501994?v=4","gravatar_id":"","url":"https://api.github.com/users/lw309637554","html_url":"https://github.com/lw309637554","followers_url":"https://api.github.com/users/lw309637554/followers","following_url":"https://api.github.com/users/lw309637554/following{/other_user}","gists_url":"https://api.github.com/users/lw309637554/gists{/gist_id}","starred_url":"https://api.github.com/users/lw309637554/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lw309637554/subscriptions","organizations_url":"https://api.github.com/users/lw309637554/orgs","repos_url":"https://api.github.com/users/lw309637554/repos","events_url":"https://api.github.com/users/lw309637554/events{/privacy}","received_events_url":"https://api.github.com/users/lw309637554/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-12T01:42:12Z","updated_at":"2021-01-12T01:42:12Z","author_association":"CONTRIBUTOR","body":"LGTM ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758337679/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758360941","html_url":"https://github.com/apache/hudi/issues/2408#issuecomment-758360941","issue_url":"https://api.github.com/repos/apache/hudi/issues/2408","id":758360941,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODM2MDk0MQ==","user":{"login":"jtmzheng","id":3466206,"node_id":"MDQ6VXNlcjM0NjYyMDY=","avatar_url":"https://avatars.githubusercontent.com/u/3466206?v=4","gravatar_id":"","url":"https://api.github.com/users/jtmzheng","html_url":"https://github.com/jtmzheng","followers_url":"https://api.github.com/users/jtmzheng/followers","following_url":"https://api.github.com/users/jtmzheng/following{/other_user}","gists_url":"https://api.github.com/users/jtmzheng/gists{/gist_id}","starred_url":"https://api.github.com/users/jtmzheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtmzheng/subscriptions","organizations_url":"https://api.github.com/users/jtmzheng/orgs","repos_url":"https://api.github.com/users/jtmzheng/repos","events_url":"https://api.github.com/users/jtmzheng/events{/privacy}","received_events_url":"https://api.github.com/users/jtmzheng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-12T02:55:15Z","updated_at":"2021-01-12T02:55:15Z","author_association":"NONE","body":"Thanks Udit! I'd tried setting `hoodie.commits.archival.batch` to 5 earlier today after going through the source code - that got my application back and running again. \r\n\r\nThe first bug definitely seems like the root cause, after turning on more verbose logging I found several 300mb commit files being loaded in for archival before the crash (re: the second bug https://github.com/apache/hudi/blob/e3d3677b7e7899705b624925666317f0c074f7c7/hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/HoodieTimelineArchiveLog.java#L353 clears the list, which isn't the most intuitive). It seems like these large commit files were generated when I set `hoodie.cleaner.commits.retained` to 1.\r\n\r\nWhat is the trade-off in lowering `hoodie.keep.max.commits` and `hoodie.keep.min.commits`? I couldn't find much good documentation on the archival process/configs.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758360941/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758372866","html_url":"https://github.com/apache/hudi/pull/2433#issuecomment-758372866","issue_url":"https://api.github.com/repos/apache/hudi/issues/2433","id":758372866,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODM3Mjg2Ng==","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-12T03:34:16Z","updated_at":"2021-01-12T03:34:16Z","author_association":"CONTRIBUTOR","body":"The file check of each task is useless because even if a task of the source has no data for some time interval, the checkpoint still can trigger normally. So all task checkpoint successfully does not mean there is data. (I have solved this in mu #step1 PR though)\r\n\r\nThere is no need to checkpoint the write status in KeyedWriteProcessOperator, because we can not start a new instant if the last instant failes, the more proper/simple way is to retry the commit actions several times and trigger failover if still fails.\r\n\r\nBTW, IMO, we should finish RFC-24 first as fast as possible, it sloves many bugs and has many improvements. After that i would add a compatible pipeline and this PR can apply there, and i can help to review.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758372866/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758403084","html_url":"https://github.com/apache/hudi/issues/2432#issuecomment-758403084","issue_url":"https://api.github.com/repos/apache/hudi/issues/2432","id":758403084,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODQwMzA4NA==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-12T05:03:29Z","updated_at":"2021-01-12T05:03:29Z","author_association":"CONTRIBUTOR","body":"@quitozang : Binding to port 0 should ensure that OS assigns a random free port. I am not sure why you are seeing the error. You can workaround by setting hoodie.embed.timeline.server.port to a designated port between (a number between 1025 and 65535) ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758403084/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758433327","html_url":"https://github.com/apache/hudi/issues/2423#issuecomment-758433327","issue_url":"https://api.github.com/repos/apache/hudi/issues/2423","id":758433327,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODQzMzMyNw==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-12T06:20:02Z","updated_at":"2021-01-12T06:20:24Z","author_association":"CONTRIBUTOR","body":"Hudi does not synchronize on partition path creation. Instead, each executor task which is about to write to a parquet file ensures the directory path exists by issuing fs.mkdirs call. Added : https://issues.apache.org/jira/browse/HUDI-1523\r\n\r\nIf mkdirs is a costly API, Can you try this patch. It tradesoff mkdirs call with getFileStatus() -\r\n```\r\ndiff --git a/hudi-client/src/main/java/org/apache/hudi/io/HoodieWriteHandle.java b/hudi-client/src/main/java/org/apache/hudi/io/HoodieWriteHandle.java\r\nindex d148b1b8..11b3cb49 100644\r\n--- a/hudi-client/src/main/java/org/apache/hudi/io/HoodieWriteHandle.java\r\n+++ b/hudi-client/src/main/java/org/apache/hudi/io/HoodieWriteHandle.java\r\n@@ -105,7 +105,9 @@ public abstract class HoodieWriteHandle<T extends HoodieRecordPayload> extends H\r\n   public Path makeNewPath(String partitionPath) {\r\n     Path path = FSUtils.getPartitionPath(config.getBasePath(), partitionPath);\r\n     try {\r\n-      fs.mkdirs(path); // create a new partition as needed.\r\n+      if (!fs.exists(path)) {\r\n+        fs.mkdirs(path); // create a new partition as needed.\r\n+      }\r\n     } catch (IOException e) {\r\n       throw new HoodieIOException(\"Failed to make dir \" + path, e);\r\n     }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758433327/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758449461","html_url":"https://github.com/apache/hudi/pull/2424#issuecomment-758449461","issue_url":"https://api.github.com/repos/apache/hudi/issues/2424","id":758449461,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODQ0OTQ2MQ==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-12T06:56:59Z","updated_at":"2021-01-12T06:56:59Z","author_association":"CONTRIBUTOR","body":"@pratyakshsharma Do you have a use-case of deleting fields ? What is the reason for supporting deleting fields. Has deleting fields case been tested for all types of cases such as upserts ? Generally, the parquet-avro reader will throw an exception right now when a smaller schema (schema for which a field has been deleted) is used to read a parquet file written with a larger schema. Have you tested this scenario ? \r\nIf not, I suggest we revert this particular change and think of a more holistic way to support deletion of fields from schema. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758449461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758461542","html_url":"https://github.com/apache/hudi/pull/2424#issuecomment-758461542","issue_url":"https://api.github.com/repos/apache/hudi/issues/2424","id":758461542,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODQ2MTU0Mg==","user":{"login":"pratyakshsharma","id":30863489,"node_id":"MDQ6VXNlcjMwODYzNDg5","avatar_url":"https://avatars.githubusercontent.com/u/30863489?v=4","gravatar_id":"","url":"https://api.github.com/users/pratyakshsharma","html_url":"https://github.com/pratyakshsharma","followers_url":"https://api.github.com/users/pratyakshsharma/followers","following_url":"https://api.github.com/users/pratyakshsharma/following{/other_user}","gists_url":"https://api.github.com/users/pratyakshsharma/gists{/gist_id}","starred_url":"https://api.github.com/users/pratyakshsharma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pratyakshsharma/subscriptions","organizations_url":"https://api.github.com/users/pratyakshsharma/orgs","repos_url":"https://api.github.com/users/pratyakshsharma/repos","events_url":"https://api.github.com/users/pratyakshsharma/events{/privacy}","received_events_url":"https://api.github.com/users/pratyakshsharma/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-12T07:22:56Z","updated_at":"2021-01-12T07:22:56Z","author_association":"CONTRIBUTOR","body":"@n3nash In my previous org, we were dealing with a similar scenario where fields were getting deleted from few tables in production. Yeah parquet-avro reader will throw exception in the scenario you mentioned. We were actually using schema-registry to create and store an uber schema so that every field is present in the final schema before actually writing to parquet files. We created the uber schema at the start of DeltaStreamer, and used the same for the ingestion. \r\n\r\nI guess all this is beyond the scope of this PR. We can initiate a separate discussion to support deletion of fields from schema.  :) ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758461542/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758474842","html_url":"https://github.com/apache/hudi/pull/2433#issuecomment-758474842","issue_url":"https://api.github.com/repos/apache/hudi/issues/2433","id":758474842,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODQ3NDg0Mg==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-12T07:50:52Z","updated_at":"2021-01-12T07:52:12Z","author_association":"CONTRIBUTOR","body":"> The file check of each task is useless because even if a task of the source has no data for some time interval, the checkpoint still can trigger normally. So all task checkpoint successfully does not mean there is data. (I have solved this in mu #step1 PR though)\r\n\r\nThat's true. We could remove the file check logic. While the implementation of multiple parallelisms is reasonable.\r\n\r\n> There is no need to checkpoint the write status in KeyedWriteProcessOperator, because we can not start a new instant if the last instant failes, the more proper/simple way is to retry the commit actions several times and trigger failover if still fails.\r\n\r\nSounds reasonable, agree.\r\n\r\n> BTW, IMO, we should finish RFC-24 first as fast as possible, it sloves many bugs and has many improvements. After that i would add a compatible pipeline and this PR can apply there, and i can help to review.\r\n\r\nI personally think that a better form of community participation is:\r\n\r\n1) Control the granularity of changes;\r\n2) Each submission is a complete function point, so that the working behavior of the code does not change;\r\n\r\nI actually want to know if you have the idea of the compatible version of `OperatorCoordinator`. What is the design? Will it be better than the current one? Will it be better than this PR design?\r\n\r\nAll this is opaque.\r\n\r\nYour Step 1 is a large-scale refactoring, and the merged code will make this client immediately unavailable. It is currently in a critical period before the release of 0.7 (if we do not have the energy to merge step 2, 3 in the short term?). Why can't we optimize it step by step?\r\n\r\nIn fact, the first and second step you need to optimize is File Assigner. SF Express has already implemented it and is ready to provide PR. In fact, we improve on the existing basis, and risks and changes are controllable, right? I think that in the end, we provide a more \"elegant implementation\" of OperatorCoordinator for the higher version, which is the correct order.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758474842/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758475039","html_url":"https://github.com/apache/hudi/pull/2424#issuecomment-758475039","issue_url":"https://api.github.com/repos/apache/hudi/issues/2424","id":758475039,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODQ3NTAzOQ==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-12T07:51:13Z","updated_at":"2021-01-12T07:56:42Z","author_association":"CONTRIBUTOR","body":"@pratyakshsharma in that case, can you review this PR ? @prashantwason Had missed to push some local changes, can you take another pass, I think it should address all your comments. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758475039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758486505","html_url":"https://github.com/apache/hudi/pull/2433#issuecomment-758486505","issue_url":"https://api.github.com/repos/apache/hudi/issues/2433","id":758486505,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODQ4NjUwNQ==","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-12T08:14:56Z","updated_at":"2021-01-12T08:14:56Z","author_association":"CONTRIBUTOR","body":"> That's true. We could remove the file check logic. While the implementation of multiple parallelisms is reasonable.\r\n\r\nDon't think so, the implementation relies on the checkpoint to start a instant, it does not work if the checkpoint data buffer is huge.\r\n\r\n> I actually want to know if you have the idea of the compatible version of OperatorCoordinator. What is the design?\r\n\r\nAlready updated the RFC-24 WIKI, at least from the design, it is more reasonable.\r\n\r\n> Your Step 1 is a large-scale refactoring\r\n\r\nI have no choice, because the original code is far away from production ready, in order to make it robust enough, i have to make big changes, and i already split it into 4 step, if you have no time to review, i would ask others to help, thanks though ~\r\n\r\n>  It is currently in a critical period before the release of 0.7\r\n\r\nI don't think this PR or mine can be merged in the release 0.7, release 0.7 is already in RC, all the refactoring should be done before 0.8 is released, so at least, we do not break the compatibility of the release version. Yes, there may be some time that the lower version does not work, but the final release is ok.\r\n\r\n> In fact, the first and second step you need to optimize is File Assigner. SF Express has already implemented it and is ready to provide PR. \r\n\r\nMaybe they have a PR, but IMO, the PR does not have high code quality, there are no test frameworks even. No one can tell if the code works correctly or suitable for big data set.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/758486505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]