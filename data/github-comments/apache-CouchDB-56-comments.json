[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424025902","html_url":"https://github.com/apache/couchdb/issues/1621#issuecomment-424025902","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1621","id":424025902,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDAyNTkwMg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-24T15:53:43Z","updated_at":"2018-09-24T15:53:43Z","author_association":"MEMBER","body":"Also, just to confirm: have you deleted any documents in this database? What is the full output of `GET /{dbname}/`? So-called \"document tombstones\" might be taking up a lot of space, too; depending on how the documents were deleted, they may actually still contain the prior document data.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424025902/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424286146","html_url":"https://github.com/apache/couchdb/issues/1621#issuecomment-424286146","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1621","id":424286146,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDI4NjE0Ng==","user":{"login":"adrienverge","id":5244945,"node_id":"MDQ6VXNlcjUyNDQ5NDU=","avatar_url":"https://avatars.githubusercontent.com/u/5244945?v=4","gravatar_id":"","url":"https://api.github.com/users/adrienverge","html_url":"https://github.com/adrienverge","followers_url":"https://api.github.com/users/adrienverge/followers","following_url":"https://api.github.com/users/adrienverge/following{/other_user}","gists_url":"https://api.github.com/users/adrienverge/gists{/gist_id}","starred_url":"https://api.github.com/users/adrienverge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adrienverge/subscriptions","organizations_url":"https://api.github.com/users/adrienverge/orgs","repos_url":"https://api.github.com/users/adrienverge/repos","events_url":"https://api.github.com/users/adrienverge/events{/privacy}","received_events_url":"https://api.github.com/users/adrienverge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-25T10:15:56Z","updated_at":"2018-09-25T14:13:20Z","author_association":"CONTRIBUTOR","body":"Hi @nickva @wohali, thank you for answering.\r\n\r\n@wohali what you ask is in my first post, see `curl localhost:5984/demo`→`full-output.json` and `\"doc_del_count\": 0`. No documents were deleted.\r\n\r\n@nickva thanks a lot for the detailed explanation: it was hard to find technical info on where do these strange files come from. In our servers:\r\n- 79% (around 4000000 docs) are like `_local/002b9f5977bdb93052d1134208d7458d`,\r\n- 20% (around 1000000 docs) are like `_local/shard-sync-0hbIroIo7GAdeFZTS--0Fw-JTBmB5z2AIBLtN3dFM_ryQ`,\r\n- 0.8% (around 40000 docs) are like `_local/Jqbpr4ZvrEGCtSLLtWcpHw==` (these ones come from [PouchDB](https://github.com/pouchdb/pouchdb)).\r\n\r\n1. For the `_local/002b9f5977bdb93052d1134208d7458d` type, can we safely delete old ones? Is there a risk of breaking CouchDB by \"corrupting\" ongoing replications?\r\n\r\n2. Is there a way to delete the (plentyful) `_local/shard-sync-0hbIroI...`? Is it safe? Attempts to `curl -X DELETE` them return `{\"error\":\"not_found\",\"reason\":\"missing\"}`.\r\n\r\n3. We don't do live replications. Is it normal that `_local/shard-sync-0hbIroI...` checkpoints stay here for months? Is it a bug? something we're doing wrong? or a misunderstanding from us?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424286146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424434230","html_url":"https://github.com/apache/couchdb/issues/1579#issuecomment-424434230","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1579","id":424434230,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDQzNDIzMA==","user":{"login":"regner","id":815037,"node_id":"MDQ6VXNlcjgxNTAzNw==","avatar_url":"https://avatars.githubusercontent.com/u/815037?v=4","gravatar_id":"","url":"https://api.github.com/users/regner","html_url":"https://github.com/regner","followers_url":"https://api.github.com/users/regner/followers","following_url":"https://api.github.com/users/regner/following{/other_user}","gists_url":"https://api.github.com/users/regner/gists{/gist_id}","starred_url":"https://api.github.com/users/regner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/regner/subscriptions","organizations_url":"https://api.github.com/users/regner/orgs","repos_url":"https://api.github.com/users/regner/repos","events_url":"https://api.github.com/users/regner/events{/privacy}","received_events_url":"https://api.github.com/users/regner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-25T17:36:24Z","updated_at":"2018-09-25T17:38:45Z","author_association":"NONE","body":"This is happening for us as well. We have roughly 400 GB of DB files and this hits us pretty hard as some of the DBs see a lot of changes.\r\n\r\n![image](https://user-images.githubusercontent.com/815037/46031941-26595a80-c0af-11e8-81bc-82816eac8169.png)\r\n\r\nOur DB disk before the upgrade was hovering just below 60%. You can see the daily compaction (we have compaction restricted to off hours) take the disk space down a bit every day as it goes up. then on the night of September 6th we deployed CouchDB 2.2 and compaction just kinda stops happening. Disk space usage grew at a fairly steady pace and our alerts triggered at 85%.\r\n\r\nAfter a bunch of reviewing our configs, testing different configs, we were unable to get auto compaction to work. On the 23rd we ran a script that grabbed every DB, compared the disk size to data size, and then we manually compacted (using the _compact endpoint) the worst 1k DBs. This gave us back about 22% of our disk, but is not a long term solution.\r\n\r\nOn one of our other DB servers that sees a lot of activity the _global_changes DB grew to about 85 GB in size. We manually triggered the compaction and it compacted down to 1 GB.\r\n\r\nWe have been playing with a bunch of different values to see if something else works, but here are some of our current config settings:\r\n\r\n```\r\n[compaction_daemon]\r\ncheck_interval = 3600\r\nmin_file_size = 131072 (most our DBs are 500 MB in size)\r\n\r\n[compactions]\r\n_default = [{db_fragmentation, \"40%\"}, {view_fragmentation, \"30%\"}, {from, \"03:00\"}, {to, \"09:00\"}]\r\n```\r\n\r\nWe did confirm CouchDB is reading the compactions settings correctly and that the compaction daemon is running.\r\n\r\nWe do configure CouchDB to store all data on the /srv mount, but there are no symlinks.\r\n\r\nIf there is any other information you need or that we can provide let us know. :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424434230/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424444967","html_url":"https://github.com/apache/couchdb/issues/1624#issuecomment-424444967","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1624","id":424444967,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDQ0NDk2Nw==","user":{"login":"alenl","id":35038,"node_id":"MDQ6VXNlcjM1MDM4","avatar_url":"https://avatars.githubusercontent.com/u/35038?v=4","gravatar_id":"","url":"https://api.github.com/users/alenl","html_url":"https://github.com/alenl","followers_url":"https://api.github.com/users/alenl/followers","following_url":"https://api.github.com/users/alenl/following{/other_user}","gists_url":"https://api.github.com/users/alenl/gists{/gist_id}","starred_url":"https://api.github.com/users/alenl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alenl/subscriptions","organizations_url":"https://api.github.com/users/alenl/orgs","repos_url":"https://api.github.com/users/alenl/repos","events_url":"https://api.github.com/users/alenl/events{/privacy}","received_events_url":"https://api.github.com/users/alenl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-25T18:07:46Z","updated_at":"2018-09-25T18:07:46Z","author_association":"NONE","body":"_From @popojargo on September 25, 2018 16:54_\n\nWhen you delete a config option in Fauxton, we call the  DELETE /_config/{section}/{key}. This should be moved to https://github.com/apache/couchdb as it concerns the API behavior\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424444967/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424452016","html_url":"https://github.com/apache/couchdb/issues/1621#issuecomment-424452016","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1621","id":424452016,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDQ1MjAxNg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-25T18:29:29Z","updated_at":"2018-09-25T18:29:29Z","author_association":"CONTRIBUTOR","body":"@adrienverge \r\n\r\n1. If the replications are finished and not expected to be resumed anymore or if you don't mind them reprocessing the _changes feed when they are resumed, you can delete the `_local/<id>` ones.\r\n\r\n2. It's a bit concerning that there are 1M _local/shard-sync-<id> documents. Those are created by the internal replicator which synchronizes shard copies in a cluster. Say a document write with w=2 updates the shard copy on node1 and node2 only. Then internal replicator will notice and eventually replicate the update to node3 as well. \r\n\r\nThe reason you can't delete them is because internal replication works on individual shards and so deleting those via the clustered interface won't always work. You can still delete them with via the local port `:5986/shards.../`. But it would be good to figure out why there are so many to start with.\r\n\r\nWonder if any of these happen in your case:\r\n\r\n * Cluster membership changes so that nodes are added and removed constantly\r\n\r\n * Cluster node names change?\r\n\r\n* Any individual shard manipulation taking place, say another tool opens, creates, encrypts, moves shard files around? This might include operating on shards via the local (:5986) interface\r\n\r\n * Rapid creation / deletion of databases?\r\n\r\n(cc: @davisp What do you think ^, this is an odd occurrence. What could cause so many shard sync checkpoints)\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424452016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424478164","html_url":"https://github.com/apache/couchdb/issues/1624#issuecomment-424478164","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1624","id":424478164,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDQ3ODE2NA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-25T19:50:41Z","updated_at":"2018-09-25T19:50:41Z","author_association":"MEMBER","body":"This is actually a duplicate of #777.\r\n\r\nTo fix this requires a complete rewrite of the config system, which is being pondered in #1595.\r\n\r\nThere is absolutely _not_ agreement within the team about any of the proposals in #1595 yet, so fixing this is way down the line.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424478164/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424511962","html_url":"https://github.com/apache/couchdb/pull/1405#issuecomment-424511962","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1405","id":424511962,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDUxMTk2Mg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-25T21:43:46Z","updated_at":"2018-09-25T21:43:46Z","author_association":"CONTRIBUTOR","body":"https://github.com/mochi/mochiweb/pull/204 <- mochiweb Erlang 21 compatibility fix","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424511962/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424667461","html_url":"https://github.com/apache/couchdb/issues/1618#issuecomment-424667461","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1618","id":424667461,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDY2NzQ2MQ==","user":{"login":"strelok1010","id":42271054,"node_id":"MDQ6VXNlcjQyMjcxMDU0","avatar_url":"https://avatars.githubusercontent.com/u/42271054?v=4","gravatar_id":"","url":"https://api.github.com/users/strelok1010","html_url":"https://github.com/strelok1010","followers_url":"https://api.github.com/users/strelok1010/followers","following_url":"https://api.github.com/users/strelok1010/following{/other_user}","gists_url":"https://api.github.com/users/strelok1010/gists{/gist_id}","starred_url":"https://api.github.com/users/strelok1010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/strelok1010/subscriptions","organizations_url":"https://api.github.com/users/strelok1010/orgs","repos_url":"https://api.github.com/users/strelok1010/repos","events_url":"https://api.github.com/users/strelok1010/events{/privacy}","received_events_url":"https://api.github.com/users/strelok1010/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-26T10:33:56Z","updated_at":"2018-09-26T10:33:56Z","author_association":"NONE","body":"I will try, after tell you :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424667461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424767155","html_url":"https://github.com/apache/couchdb/issues/1626#issuecomment-424767155","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1626","id":424767155,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDc2NzE1NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-26T15:49:52Z","updated_at":"2018-09-26T15:49:52Z","author_association":"MEMBER","body":"This isn't a CouchDB bug, but we can offer some support anyway.\r\n\r\nCouchDB for RHEL/CentOS and Debian/Ubuntu builds its own couchjs package. You can try applying all of the patches we apply for that.\r\n\r\nSee: https://github.com/apache/couchdb-pkg/tree/master/js\r\n\r\nspecifically the `README` file in that directory + the patches as well.\r\n\r\nLet us know how you get on!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424767155/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424770231","html_url":"https://github.com/apache/couchdb/issues/991#issuecomment-424770231","issue_url":"https://api.github.com/repos/apache/couchdb/issues/991","id":424770231,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDc3MDIzMQ==","user":{"login":"judsonp44","id":15368417,"node_id":"MDQ6VXNlcjE1MzY4NDE3","avatar_url":"https://avatars.githubusercontent.com/u/15368417?v=4","gravatar_id":"","url":"https://api.github.com/users/judsonp44","html_url":"https://github.com/judsonp44","followers_url":"https://api.github.com/users/judsonp44/followers","following_url":"https://api.github.com/users/judsonp44/following{/other_user}","gists_url":"https://api.github.com/users/judsonp44/gists{/gist_id}","starred_url":"https://api.github.com/users/judsonp44/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/judsonp44/subscriptions","organizations_url":"https://api.github.com/users/judsonp44/orgs","repos_url":"https://api.github.com/users/judsonp44/repos","events_url":"https://api.github.com/users/judsonp44/events{/privacy}","received_events_url":"https://api.github.com/users/judsonp44/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-26T15:57:21Z","updated_at":"2018-09-26T15:57:21Z","author_association":"NONE","body":"The last comment (Nov 20, 2017) says \"we will fix this in the next release\" but I see the issue is now closed. Was there a decision made after that last comment to not fix this? As far as I can tell this is still and issue as of the 2.2 release.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424770231/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424792416","html_url":"https://github.com/apache/couchdb/issues/1623#issuecomment-424792416","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1623","id":424792416,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDc5MjQxNg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-26T16:57:55Z","updated_at":"2018-09-26T16:57:55Z","author_association":"MEMBER","body":"@kipkuch Hi there, I can't reproduce this on my Win 7 Professional SP1 laptop.\r\n\r\nDid you previously have another version of CouchDB installed first? Did you completely remove that version if so?\r\n\r\nDid you install CouchDB to a path **without** spaces, such as `C:\\CouchDB`? The installer warns that CouchDB won't work right if you install to a path with spaces such as `C:\\Program Files\\CouchDB`.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424792416/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424793656","html_url":"https://github.com/apache/couchdb/pull/1627#issuecomment-424793656","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1627","id":424793656,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDc5MzY1Ng==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-26T17:01:37Z","updated_at":"2018-09-26T17:30:04Z","author_association":"CONTRIBUTOR","body":"Hmm, this is not as simple. EUnit tests are failing in chttpd because per-node rexi servers are started up asynchronously after the rexi app supervisor has already finished. So making cluster requests immediately after mem3 and rexi have started could fail. \r\n\r\nIn the tests, though it is assumed as soon as all the apps start requests should succeed immediately. \r\n\r\nI think we'd probably want to start server in the server_mon (and buffer_mon) in the init callback to avoid this asynchronicity in general. This would work because the supervisors (`*_sup`) come before monitors (`*_mon`).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424793656/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424794824","html_url":"https://github.com/apache/couchdb/pull/1627#issuecomment-424794824","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1627","id":424794824,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDc5NDgyNA==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-26T17:05:15Z","updated_at":"2018-09-26T17:05:15Z","author_association":"MEMBER","body":"@nickva _or_ we could have `server_per_node = false` in eunit's `config.ini`","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424794824/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424795084","html_url":"https://github.com/apache/couchdb/issues/991#issuecomment-424795084","issue_url":"https://api.github.com/repos/apache/couchdb/issues/991","id":424795084,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDc5NTA4NA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-26T17:05:56Z","updated_at":"2018-09-26T17:08:51Z","author_association":"MEMBER","body":"@judsonp44 Dave closed the issue because 1.x installers are no longer supported.\r\n\r\n2.x has a fix for running the `couchjs` interpreter in a directory with spaces, but there are other issues that still cause issues on Windows when installing CouchDB to a path with spaces.\r\n\r\nGiven how constrained we are on supporting the Windows version, we don't have any plans to retrofit support throughout CouchDB for paths with spaces this at this time, which is why this issue remains closed.\r\n\r\nThere is a very clear warning in the installer that you would have had to have clicked past to install CouchDB into the wrong path.... ;)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424795084/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424802064","html_url":"https://github.com/apache/couchdb/pull/1627#issuecomment-424802064","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1627","id":424802064,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDgwMjA2NA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-26T17:27:22Z","updated_at":"2018-09-26T17:27:22Z","author_association":"CONTRIBUTOR","body":"@eiri I thought about it and it seems we should just start the service such that after the application finished starting it would be ready to receive requests right away (Made a separate commit for that). This restores the timing behavior from before (since rexi_server was started and ready to go after rexi app finished startup) and should make the service as a whole available a bit quicker after startup.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424802064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424810946","html_url":"https://github.com/apache/couchdb/pull/1627#issuecomment-424810946","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1627","id":424810946,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDgxMDk0Ng==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-26T17:55:26Z","updated_at":"2018-09-26T17:55:26Z","author_association":"MEMBER","body":"@nickva my reasoning is that we are making a config change which we are \"super confident\" about and adding to it a new functional change to make it work. This kind of muddies the message, if you see what I'm saying.\r\n\r\nI'm looking at that `start_servers` in init and it _seems_ to me it should work fine, but been right from vacation I feel rusty and in general wary about sync calls in init. On the other hand Travis just came out green, so I have nothing to say against it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424810946/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424845555","html_url":"https://github.com/apache/couchdb/pull/1620#issuecomment-424845555","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1620","id":424845555,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDg0NTU1NQ==","user":{"login":"ermouth","id":1540047,"node_id":"MDQ6VXNlcjE1NDAwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/1540047?v=4","gravatar_id":"","url":"https://api.github.com/users/ermouth","html_url":"https://github.com/ermouth","followers_url":"https://api.github.com/users/ermouth/followers","following_url":"https://api.github.com/users/ermouth/following{/other_user}","gists_url":"https://api.github.com/users/ermouth/gists{/gist_id}","starred_url":"https://api.github.com/users/ermouth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ermouth/subscriptions","organizations_url":"https://api.github.com/users/ermouth/orgs","repos_url":"https://api.github.com/users/ermouth/repos","events_url":"https://api.github.com/users/ermouth/events{/privacy}","received_events_url":"https://api.github.com/users/ermouth/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-26T19:45:45Z","updated_at":"2018-09-26T19:45:45Z","author_association":"CONTRIBUTOR","body":"@wohali since no +1 so far, may be I could answer questions, if any? Since js rewrites was initially my patch refactored by @kxepal, I doubt there’s a lot of devs knowing internals.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424845555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424862279","html_url":"https://github.com/apache/couchdb/pull/1620#issuecomment-424862279","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1620","id":424862279,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDg2MjI3OQ==","user":{"login":"kxepal","id":785983,"node_id":"MDQ6VXNlcjc4NTk4Mw==","avatar_url":"https://avatars.githubusercontent.com/u/785983?v=4","gravatar_id":"","url":"https://api.github.com/users/kxepal","html_url":"https://github.com/kxepal","followers_url":"https://api.github.com/users/kxepal/followers","following_url":"https://api.github.com/users/kxepal/following{/other_user}","gists_url":"https://api.github.com/users/kxepal/gists{/gist_id}","starred_url":"https://api.github.com/users/kxepal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kxepal/subscriptions","organizations_url":"https://api.github.com/users/kxepal/orgs","repos_url":"https://api.github.com/users/kxepal/repos","events_url":"https://api.github.com/users/kxepal/events{/privacy}","received_events_url":"https://api.github.com/users/kxepal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-26T20:40:40Z","updated_at":"2018-09-26T20:40:40Z","author_association":"MEMBER","body":"Oh, btw, do we have any tests for js rewrites? Would be nice to cover that case for future changes.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424862279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424866669","html_url":"https://github.com/apache/couchdb/pull/1620#issuecomment-424866669","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1620","id":424866669,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDg2NjY2OQ==","user":{"login":"ermouth","id":1540047,"node_id":"MDQ6VXNlcjE1NDAwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/1540047?v=4","gravatar_id":"","url":"https://api.github.com/users/ermouth","html_url":"https://github.com/ermouth","followers_url":"https://api.github.com/users/ermouth/followers","following_url":"https://api.github.com/users/ermouth/following{/other_user}","gists_url":"https://api.github.com/users/ermouth/gists{/gist_id}","starred_url":"https://api.github.com/users/ermouth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ermouth/subscriptions","organizations_url":"https://api.github.com/users/ermouth/orgs","repos_url":"https://api.github.com/users/ermouth/repos","events_url":"https://api.github.com/users/ermouth/events{/privacy}","received_events_url":"https://api.github.com/users/ermouth/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-26T20:55:33Z","updated_at":"2018-09-26T20:55:33Z","author_association":"CONTRIBUTOR","body":"@kxepal Thanks 😁\r\n\r\n> Though I forgot reasons to do erlang:get(mochiweb_request_body)\r\n\r\nBecause rewrites should be fast, as fast as possible. So we better not stream body into newly born request (which is also hackish btw), but replace body using internal Mochiweb thread dict entry. \r\n\r\nPerf is also the only reason why `.info` and `.form` fields are removed from request object here.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424866669/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424870160","html_url":"https://github.com/apache/couchdb/pull/1620#issuecomment-424870160","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1620","id":424870160,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDg3MDE2MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-26T21:07:52Z","updated_at":"2018-09-26T21:07:52Z","author_association":"MEMBER","body":"@ermouth if tests are possible, that'd be great, otherwise this might break again (esp. if others are not familiar with the code).\r\n\r\nOtherwise I'll rebase this later tonight.\r\n\r\n@kxepal nice to see you, and thanks!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424870160/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424876593","html_url":"https://github.com/apache/couchdb/pull/1620#issuecomment-424876593","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1620","id":424876593,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDg3NjU5Mw==","user":{"login":"ermouth","id":1540047,"node_id":"MDQ6VXNlcjE1NDAwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/1540047?v=4","gravatar_id":"","url":"https://api.github.com/users/ermouth","html_url":"https://github.com/ermouth","followers_url":"https://api.github.com/users/ermouth/followers","following_url":"https://api.github.com/users/ermouth/following{/other_user}","gists_url":"https://api.github.com/users/ermouth/gists{/gist_id}","starred_url":"https://api.github.com/users/ermouth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ermouth/subscriptions","organizations_url":"https://api.github.com/users/ermouth/orgs","repos_url":"https://api.github.com/users/ermouth/repos","events_url":"https://api.github.com/users/ermouth/events{/privacy}","received_events_url":"https://api.github.com/users/ermouth/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-26T21:31:11Z","updated_at":"2018-09-26T21:31:11Z","author_association":"CONTRIBUTOR","body":"@wohali it’s tested now, but not by CouchDB tests. \r\n\r\nThere are some tests in CouchDB as well, https://github.com/apache/couchdb/blob/master/test/javascript/tests/rewrite_js.js, but they definitely not cover some cases. \r\n\r\nIf above link is correct, I could expand coverage, but one question: how to run those tests locally?\r\n\r\nAlso, when do you plan 2.3?\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424876593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424889313","html_url":"https://github.com/apache/couchdb/pull/1620#issuecomment-424889313","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1620","id":424889313,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDg4OTMxMw==","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-26T22:24:23Z","updated_at":"2018-09-26T22:24:23Z","author_association":"CONTRIBUTOR","body":"@ermouth I just wanted to mention in passing that several folks are working on [porting the existing JS tests to Elixir](https://github.com/apache/couchdb/tree/elixir-suite/test/elixir). So if you are having trouble running the JS test, it might be simpler to just port it (rather than add to something that will shortly be replaced anyway), depending on your inclination to work in Elixir.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424889313/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424902245","html_url":"https://github.com/apache/couchdb/pull/1620#issuecomment-424902245","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1620","id":424902245,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDkwMjI0NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-26T23:21:42Z","updated_at":"2018-09-26T23:21:42Z","author_association":"MEMBER","body":"@ermouth @jaydoane I don't think anyone has ported rewrite_js.js to Elixir yet, so if @ermouth wants to add new tests to that now, I don't think they'll get lost in The Great Rewrite. :)\r\n\r\n@ermouth `make javascript` should run the JS test suite locally.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424902245/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424904277","html_url":"https://github.com/apache/couchdb/pull/1620#issuecomment-424904277","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1620","id":424904277,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDkwNDI3Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-26T23:33:35Z","updated_at":"2018-09-26T23:33:35Z","author_association":"MEMBER","body":"@ermouth you asked when 2.3.0 releases - when this list is done:\r\n\r\nhttps://github.com/apache/couchdb/milestone/4\r\n\r\nFeel free to fix one or more if you have time.\r\n\r\nAfter that's fixed and the CI runs are green, I update the release notes and start the release process. :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/424904277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425014344","html_url":"https://github.com/apache/couchdb/issues/1623#issuecomment-425014344","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1623","id":425014344,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTAxNDM0NA==","user":{"login":"kipkuch","id":6717572,"node_id":"MDQ6VXNlcjY3MTc1NzI=","avatar_url":"https://avatars.githubusercontent.com/u/6717572?v=4","gravatar_id":"","url":"https://api.github.com/users/kipkuch","html_url":"https://github.com/kipkuch","followers_url":"https://api.github.com/users/kipkuch/followers","following_url":"https://api.github.com/users/kipkuch/following{/other_user}","gists_url":"https://api.github.com/users/kipkuch/gists{/gist_id}","starred_url":"https://api.github.com/users/kipkuch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kipkuch/subscriptions","organizations_url":"https://api.github.com/users/kipkuch/orgs","repos_url":"https://api.github.com/users/kipkuch/repos","events_url":"https://api.github.com/users/kipkuch/events{/privacy}","received_events_url":"https://api.github.com/users/kipkuch/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-27T08:58:51Z","updated_at":"2018-09-27T08:58:51Z","author_association":"NONE","body":"Hi,\r\nCouchDB was installed to the default path C:\\CouchDB & There was no previous installation.\r\n\r\nI have managed to resolve the problem so this request can be closed.\r\n\r\nI uninstalled MySQL Server (v5.6) & related tools (workbench, etc) on the same machine and that did the trick.\r\n\r\nThe reason I suspected MySQL as a potential conflict is that soon after CouchDB installation, the MySQL Service would report errors sporadically.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425014344/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425015812","html_url":"https://github.com/apache/couchdb/pull/1470#issuecomment-425015812","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1470","id":425015812,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTAxNTgxMg==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-27T09:03:22Z","updated_at":"2018-09-27T09:03:22Z","author_association":"MEMBER","body":"@davisp ping? do you want me to change anything else here?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425015812/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425033368","html_url":"https://github.com/apache/couchdb/issues/1621#issuecomment-425033368","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1621","id":425033368,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTAzMzM2OA==","user":{"login":"adrienverge","id":5244945,"node_id":"MDQ6VXNlcjUyNDQ5NDU=","avatar_url":"https://avatars.githubusercontent.com/u/5244945?v=4","gravatar_id":"","url":"https://api.github.com/users/adrienverge","html_url":"https://github.com/adrienverge","followers_url":"https://api.github.com/users/adrienverge/followers","following_url":"https://api.github.com/users/adrienverge/following{/other_user}","gists_url":"https://api.github.com/users/adrienverge/gists{/gist_id}","starred_url":"https://api.github.com/users/adrienverge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adrienverge/subscriptions","organizations_url":"https://api.github.com/users/adrienverge/orgs","repos_url":"https://api.github.com/users/adrienverge/repos","events_url":"https://api.github.com/users/adrienverge/events{/privacy}","received_events_url":"https://api.github.com/users/adrienverge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-27T10:01:58Z","updated_at":"2018-09-27T10:01:58Z","author_association":"CONTRIBUTOR","body":"Hi @nickva, thanks for following up.\r\n\r\nTo answer your questions:\r\n\\- Cluster don't change (always the same 3 nodes); nodes names (or IPs) don't change (more generally, we don't touch `vm.args` nor `/_membership` nor `/_nodes` nor `:5986` at all.\r\n\\- No other tool or process that touch `/var/lib/couchdb` (except us when debugging, but only rarely and in read-only: `du`, `df`, `scp`...)\r\n\\- Databases are not rapidly created (around 250 new DBs per day), and never deleted.\r\n\r\n**Here is more info on the shard-sync issue:**\r\nWe've set up a new cluster, and replicated from the (dying) old one. Three nodes, `q=8`, `n=3`.\r\nFor a database chosen at random, there are **32** `_local/shard-sync` docs on first node \r\n([download them all here](https://github.com/apache/couchdb/files/2423565/local_docs.json.txt)), among which some look redundant (same `source_node` and `target_node`, but different UUIDs). Example:\r\n\r\n```json\r\n{\r\n  \"_id\": \"_local/shard-sync-1MHFZMU82CR6nTRw6IB5ig-MAqWsRU1KdFyVAmQyHUkqg\",\r\n  \"seq\": 68,\r\n  \"target_uuid\": \"147ecd8ddf1ba86c3e8d7117587141b1\",\r\n  \"history\": {\r\n    \"couchdb@node1.com\": [\r\n      {\r\n        \"target_node\": \"couchdb@node2.com\",\r\n        \"target_uuid\": \"147ecd8ddf1ba86c3e8d7117587141b1\",\r\n        \"target_seq\": 70,\r\n        \"source_node\": \"couchdb@node1.com\",\r\n        \"source_uuid\": \"4ceab4f79e99ef3929a3f3e7bb9ea8f5\",\r\n        \"source_seq\": 68,\r\n        \"timestamp\": \"2018-09-27T07:34:01.554723Z\"\r\n      }\r\n    ]\r\n  }\r\n},\r\n{\r\n  \"_id\": \"_local/shard-sync-6Fr1fwkrRyD7NMmRmXXCmQ-E-HElyKWVluvtMH9BuGyNA\",\r\n  \"seq\": 73,\r\n  \"target_uuid\": \"2d5e533605c004d673c338e796130b9d\",\r\n  \"history\": {\r\n    \"couchdb@node1.com\": [\r\n      {\r\n        \"target_node\": \"couchdb@node2.com\",\r\n        \"target_uuid\": \"2d5e533605c004d673c338e796130b9d\",\r\n        \"target_seq\": 75,\r\n        \"source_node\": \"couchdb@node1.com\",\r\n        \"source_uuid\": \"7c44291538e9f88de564b13642122f12\",\r\n        \"source_seq\": 73,\r\n        \"timestamp\": \"2018-09-27T07:34:00.978796Z\"\r\n      }\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\nIs it normal that there are 32 of them? Is it normal that some look very similar?\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425033368/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425054494","html_url":"https://github.com/apache/couchdb/issues/1603#issuecomment-425054494","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1603","id":425054494,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTA1NDQ5NA==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-27T11:22:39Z","updated_at":"2018-09-27T11:22:39Z","author_association":"MEMBER","body":"Hey @janl, sorry for the response delay, I'm just back from vacation (been in Germany, ftw!)\r\n\r\nThe fabric bit is fine, we don't count rows when walking locals' btree, it's kind of expensive and ~meaningless, so we just pass `null` there and account for that in fabric.\r\n\r\nThe `_design_docs`, on the other hand, is just a filter over `_all_docs` iirc, so it should work the same. I'll take a look at that, it might be that we don't apply according filter on `total_rows` or something similar.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425054494/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425059128","html_url":"https://github.com/apache/couchdb/pull/1601#issuecomment-425059128","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1601","id":425059128,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTA1OTEyOA==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-27T11:42:19Z","updated_at":"2018-09-27T11:42:19Z","author_association":"MEMBER","body":"This is a great fix, but why did you did it in CamelCase? This is so strange to see javaism in erlang's stack trace...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425059128/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425078256","html_url":"https://github.com/apache/couchdb/pull/1470#issuecomment-425078256","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1470","id":425078256,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTA3ODI1Ng==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-27T12:50:07Z","updated_at":"2018-09-27T12:50:07Z","author_association":"MEMBER","body":"Sorry I missed this. I'll not be able to get to it until Monday.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425078256/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425221278","html_url":"https://github.com/apache/couchdb/pull/1601#issuecomment-425221278","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1601","id":425221278,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTIyMTI3OA==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-27T19:52:50Z","updated_at":"2018-09-27T19:52:50Z","author_association":"CONTRIBUTOR","body":"@eiri: Would this work https://github.com/apache/couchdb/pull/1630 or you prefer a string `\"initial_file_path\"`?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425221278/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425239648","html_url":"https://github.com/apache/couchdb/pull/1601#issuecomment-425239648","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1601","id":425239648,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTIzOTY0OA==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-27T20:54:06Z","updated_at":"2018-09-27T20:54:06Z","author_association":"MEMBER","body":"@iilyak Personally I prefer atoms for both `initial_file_path` and `state` just so it's consistent with the rest of stack trace.\r\n\r\nBut to be clear I didn't try to twist your arm here, it's obviously a question of personal preferences, I was just was surprised when I was walking through commits happened while I was away.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425239648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425255860","html_url":"https://github.com/apache/couchdb/issues/1051#issuecomment-425255860","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1051","id":425255860,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTI1NTg2MA==","user":{"login":"dynamite-ready","id":1124008,"node_id":"MDQ6VXNlcjExMjQwMDg=","avatar_url":"https://avatars.githubusercontent.com/u/1124008?v=4","gravatar_id":"","url":"https://api.github.com/users/dynamite-ready","html_url":"https://github.com/dynamite-ready","followers_url":"https://api.github.com/users/dynamite-ready/followers","following_url":"https://api.github.com/users/dynamite-ready/following{/other_user}","gists_url":"https://api.github.com/users/dynamite-ready/gists{/gist_id}","starred_url":"https://api.github.com/users/dynamite-ready/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dynamite-ready/subscriptions","organizations_url":"https://api.github.com/users/dynamite-ready/orgs","repos_url":"https://api.github.com/users/dynamite-ready/repos","events_url":"https://api.github.com/users/dynamite-ready/events{/privacy}","received_events_url":"https://api.github.com/users/dynamite-ready/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-27T21:56:18Z","updated_at":"2018-09-27T22:09:13Z","author_association":"NONE","body":"I'm not entirely sure if this is directly related to this issue, but I suspect it is, and possibly a few others.\r\nThis code - https://github.com/apache/couchdb/blob/deba7575a1a67fe06850959e99af3e0e9c704443/src/couch/include/couch_erl_functions.hrl#L32:\r\n\r\n```\r\ntrue -> throw({forbidden, <<\"Only admins may delete other user docs.\">>})\r\n```\r\n\r\nWill throw an `unknown_error` to the log, and return a `500` status code to the frontend.\r\n\r\nIf instead, I do:\r\n\r\n```\r\ntrue -> {[{ <<\"forbidden\">>, <<\"Only admins may delete other user docs.\">> }]}\r\n```\r\n\r\nThen no error appears in the log, but a `403` is returned to the frontend, along with the contents of the second element in the tuple.\r\n\r\nThis appears to match the clause in the case statement found here - https://github.com/apache/couchdb/blob/master/src/couch/src/couch_query_servers.erl#L379\r\n\r\nMight this be related?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425255860/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425280664","html_url":"https://github.com/apache/couchdb/issues/1621#issuecomment-425280664","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1621","id":425280664,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTI4MDY2NA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-28T00:11:22Z","updated_at":"2018-09-28T00:11:22Z","author_association":"CONTRIBUTOR","body":"32 seems normal, I would have expected maybe 48 ( 3 pairs, that is 6 * 8 shards = 48) but I didn't look too much into the internal replication algorithm. \r\n\r\nBut overall that's much's less than the 1000000 as I think I misunderstood that it was that many shard-sync checkpoints in a single db (!) from the pervious discussion.\r\n\r\nDon't delete _local/shard-sync-* docs, as that will mess up with the internal replicator between cluster nodes.\r\n\r\nBut if you there are a lot of _local/<id> ones, you can delete those if the replications have finished and don't expect those to be resumed (or if they resume they'd reprocess their changes feed). And use_checkpoints = false option might be something useful for your use case (it would avoid modifying that source db with _local/<id> for each replication from it).\r\n\r\nTo reduce the size other options could be to try a better compression algorithm than the default snappy one (say deflate_6). \r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425280664/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425387711","html_url":"https://github.com/apache/couchdb/pull/1601#issuecomment-425387711","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1601","id":425387711,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTM4NzcxMQ==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-28T10:02:47Z","updated_at":"2018-09-28T10:02:47Z","author_association":"CONTRIBUTOR","body":"@eiri: Here is an extract from [`gen_server` documentation] (http://erlang.org/doc/man/gen_server.html#Module:format_status-2)\r\n\r\n> the recommended form for the Status value is [{data, [{\"State\", Term}]}], where Term provides relevant details of the gen_server state. Following this recommendation is not required, but it makes the callback module status consistent with the rest of the sys:get_status/1,2 return value.\r\n\r\nI remember being inspired by the [following example from OTP](https://github.com/erlang/otp/blob/d6285b0a347b9489ce939511ee9a979acd868f71/lib/os_mon/src/disksup.erl#L201)\r\n```\r\nformat_status(_Opt, [_PDict, #state{os = OS, threshold = Threshold,\r\n\t\t\t\t    timeout = Timeout,\r\n\t\t\t\t    diskdata = DiskData}]) ->\r\n    [{data, [{\"OS\", OS},\r\n\t     {\"Timeout\", Timeout},\r\n\t     {\"Threshold\", Threshold},\r\n             {\"DiskData\", DiskData}]}].\r\n```\r\n\r\nThe use of the function in otp is inconsistent:\r\n\r\n- [wx_object.erl](https://github.com/erlang/otp/blob/d6285b0a347b9489ce939511ee9a979acd868f71/lib/wx/src/wx_object.erl#L693)\r\n```\r\nSpecific = [{data, [{\"State\", State}]}],\r\n[{header, Header},\r\n     {data, [{\"Status\", SysState},\r\n\t     {\"Parent\", Parent},\r\n\t     {\"Logged events\", Log}]} |\r\nSpecfic]. \r\n```\r\n- [httpd_request_handler.erl](https://github.com/erlang/otp/blob/d6285b0a347b9489ce939511ee9a979acd868f71/lib/inets/src/http_server/httpd_request_handler.erl#L331)\r\n```\r\n[{data, [{\"StateData\", State}]}]; \r\n```\r\n- [supervisor.erl](https://github.com/erlang/otp/blob/d6285b0a347b9489ce939511ee9a979acd868f71/lib/stdlib/src/supervisor.erl#L1429)\r\n```\r\n[{data, [{\"State\", State}]},\r\n {supervisor, [{\"Callback\", State#state.module}]}]\r\n```\r\n- [memsup](https://github.com/erlang/otp/blob/1d5d8a8c5c7cc8f0e011bb121ef21787ece2be58/lib/os_mon/src/memsup.erl#L672:L675)\r\n```\r\n[{data, [{\"Timeout\", Timeout}]},\r\n {items, {\"Memory Usage\", [\r\n      {\"Allocated\", Allocated},\r\n      {\"Total\", Total}]}},\r\n {items, {\"Worst Memory User\", WorstMemFormat}}].\r\n```\r\n- [ssh_connection_handler.erl](https://github.com/erlang/otp/blob/c1def1f61f74ac6e8e0703d01d0819d142c11de5/lib/ssh/src/ssh_connection_handler.erl#L1589)\r\n```\r\n[{data, [{\"State\", [{foo, 1}, {bar, 2}]}]}].\r\n```\r\n\r\nMy guess is it might have to do with the way how observer or SASL uses this data. Since we are not using either we should be able to use any format we want.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425387711/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425416530","html_url":"https://github.com/apache/couchdb/pull/1601#issuecomment-425416530","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1601","id":425416530,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTQxNjUzMA==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-28T12:14:29Z","updated_at":"2018-09-28T12:14:29Z","author_association":"MEMBER","body":"Huh. I haven't seen this `gen_server` doc's snippet, thank you for pointing out.\r\n\r\nTo be honest I feel very confused on what OTP folks are doing here in source code, mixing strings, atoms, camelcase and capitalized spaced. Dunno, maybe it just me.\r\n\r\nAnyway, I take my complaints back, since you are following worded OTP recommendation here let's keep it this way, sorry about whole confusion.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425416530/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425510887","html_url":"https://github.com/apache/couchdb/pull/1630#issuecomment-425510887","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1630","id":425510887,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTUxMDg4Nw==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-28T17:35:18Z","updated_at":"2018-09-28T17:35:18Z","author_association":"CONTRIBUTOR","body":"Closing it as per discussion in https://github.com/apache/couchdb/pull/1601#issuecomment-425416530","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425510887/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425526731","html_url":"https://github.com/apache/couchdb/pull/1627#issuecomment-425526731","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1627","id":425526731,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTUyNjczMQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-28T18:30:42Z","updated_at":"2018-09-28T18:30:42Z","author_association":"CONTRIBUTOR","body":"@eiri we are making it work like rexi_server worked previously, _without_ the change to start the server we are actually changing the current behavior by introducing an asynchronous start.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425526731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425550141","html_url":"https://github.com/apache/couchdb/pull/1627#issuecomment-425550141","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1627","id":425550141,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTU1MDE0MQ==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-28T20:02:34Z","updated_at":"2018-09-28T20:02:34Z","author_association":"MEMBER","body":"This is not how I see it. I see it as \"We are switching to `server_per_node` _and_ making it synchronous, but justifying it by saying that's it was working fine by starting things asynchronously before, so that's ok.\" I mean it's not a config change if you are also changing the code. But this is a moot point anyway. \r\n\r\nI run a couple of tests with artificial timeouts in `rexi_server` and `rexi_buffer` inits and apart from expected `noproc` noise from `mem3_sync` on restart it work fine, so I'm good with this change.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425550141/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425625638","html_url":"https://github.com/apache/couchdb/issues/1621#issuecomment-425625638","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1621","id":425625638,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTYyNTYzOA==","user":{"login":"adrienverge","id":5244945,"node_id":"MDQ6VXNlcjUyNDQ5NDU=","avatar_url":"https://avatars.githubusercontent.com/u/5244945?v=4","gravatar_id":"","url":"https://api.github.com/users/adrienverge","html_url":"https://github.com/adrienverge","followers_url":"https://api.github.com/users/adrienverge/followers","following_url":"https://api.github.com/users/adrienverge/following{/other_user}","gists_url":"https://api.github.com/users/adrienverge/gists{/gist_id}","starred_url":"https://api.github.com/users/adrienverge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adrienverge/subscriptions","organizations_url":"https://api.github.com/users/adrienverge/orgs","repos_url":"https://api.github.com/users/adrienverge/repos","events_url":"https://api.github.com/users/adrienverge/events{/privacy}","received_events_url":"https://api.github.com/users/adrienverge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-29T08:00:20Z","updated_at":"2018-09-29T08:00:20Z","author_association":"CONTRIBUTOR","body":"Hi @nickva,\r\n\r\nI apologize for the misunderstanding, I meant 1000000 docs for the whole node (\"in our servers\"). I'm glad to hear 32-48 `_local/shard-sync` docs are normal.\r\n\r\nWe started using `use_checkpoints = false` and deleted all other local docs.\r\n\r\nUnfortunately CouchDB disk usage still keeps growing (by multiple dozens of GB, while the size after a fresh restoration is 5 GB) even on a cluster we don't touch (no connection at all). We are still investigating it, but it may be because:\r\n- shard files (`db.1520354435.couch`) constantly keep growing (by ~kB), even if there are no requests done on them,\r\n- compaction doesn't seem to happen on all shard files. This could be related to `min_file_size` or #1579 or #1383 or #1097.\r\n\r\nSo in the meantime I'll close this issue. Once again, thank you for your detailed explanations that help us understand and debug this problem further!\r\n\r\nPS: By the way, we're stuck on 2.1.2 (because 2.2 has #1550, will be fixed in 2.3), but 2.2 has many performance improvements. It would be great to have a 2.2.1 (with the fix) while waiting for 2.3! :)\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425625638/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425664301","html_url":"https://github.com/apache/couchdb/issues/1621#issuecomment-425664301","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1621","id":425664301,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTY2NDMwMQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-29T18:02:19Z","updated_at":"2018-09-29T18:02:19Z","author_association":"MEMBER","body":"@adrienverge The list of issues for 2.3.0 to be released is very small. We expect release within a month or so, hopefully sooner. I don't think a 2.2.1 is coming, sorry about that. I am also sorry that you can't use the workaround in 2.2.0 to restore the prior replicator functionality - any reason why not?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425664301/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425664332","html_url":"https://github.com/apache/couchdb/issues/1621#issuecomment-425664332","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1621","id":425664332,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTY2NDMzMg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-29T18:02:48Z","updated_at":"2018-09-29T18:02:48Z","author_association":"MEMBER","body":"Here's the 2.3.0 issue list. https://github.com/apache/couchdb/issues?q=is%3Aopen+is%3Aissue+milestone%3A2.3.0","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425664332/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425934014","html_url":"https://github.com/apache/couchdb/issues/1632#issuecomment-425934014","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1632","id":425934014,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTkzNDAxNA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-01T14:44:18Z","updated_at":"2018-10-01T14:44:27Z","author_association":"CONTRIBUTOR","body":"Oops, my bad, I am sorry. It was probably this commit:\r\n\r\nhttps://github.com/apache/couchdb/commit/fbb5588e2d023eb1bcf97cf9e44d483de2b2a62d\r\n\r\nShould we make it python3 or revert it?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425934014/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425939413","html_url":"https://github.com/apache/couchdb/issues/1632#issuecomment-425939413","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1632","id":425939413,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTkzOTQxMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-01T14:58:46Z","updated_at":"2018-10-01T14:58:46Z","author_association":"MEMBER","body":"@nickva \r\n\r\nThe naughty thing that I had to do was, in the CentOS 6 Docker image, I installed python3 to /usr/local/bin/python and placed /usr/local/bin ahead of /usr/bin in the path. This is because CentOS 6 has Python 2.6, which is too old for some of the things we're doing in our code already...and I took great pains to ensure that all of the Python scripts we run in `make check` and `make release` and `make dist` work without change in both python 2 and python 3.\r\n\r\nWhat I'd do is run `2to3` on all 4 scripts, and apply any changes it requests, then change it to `python3`. That'll be better for the future, when the distros decide to remove python 2.7 anyway. The error we're getting on Jenkins for CentOS6 for Python 3 is:\r\n\r\n```python\r\nmake[1]: Entering directory `/tmp/tmp.ILBeu2AdWN/apache-couchdb-2.2.0-fbb5588'\r\nTraceback (most recent call last):\r\n  File \"dev/run\", line 592, in <module>\r\n    main()\r\n  File \"dev/run\", line 80, in main\r\n    ctx = setup()\r\n  File \"dev/run\", line 94, in setup\r\n    setup_configs(ctx)\r\n  File \"dev/run\", line 65, in wrapper\r\n    res = func(*args, **kwargs)\r\n  File \"dev/run\", line 203, in setup_configs\r\n    write_config(ctx, node, env)\r\n  File \"dev/run\", line 239, in write_config\r\n    content = hack_default_ini(ctx, node, content)\r\n  File \"dev/run\", line 289, in hack_default_ini\r\n    flags=re.MULTILINE)\r\nTypeError: sub() got an unexpected keyword argument 'flags'\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425939413/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425950893","html_url":"https://github.com/apache/couchdb/pull/1602#issuecomment-425950893","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1602","id":425950893,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTk1MDg5Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-01T15:29:20Z","updated_at":"2018-10-01T15:29:20Z","author_association":"MEMBER","body":"@janl How is `httpsd` enabled in this new world? Previously that would have been:\r\n\r\n```\r\n[daemons]\r\nhttpsd = {chttpd, start_link, [https]}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/425950893/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426023755","html_url":"https://github.com/apache/couchdb/issues/1634#issuecomment-426023755","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1634","id":426023755,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjAyMzc1NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-01T19:00:03Z","updated_at":"2018-10-01T19:00:03Z","author_association":"MEMBER","body":"There is an example in this closed issue of a working docker-compose.yml file:\r\n\r\nhttps://github.com/apache/couchdb-docker/issues/74\r\n\r\nCouchDB does not officially support docker-compose.\r\n\r\nHowever, there is a contributed [Helm chart](https://github.com/helm/charts/tree/master/incubator/couchdb) for Kubernetes that is maintained and supported by members of the CouchDB team.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426023755/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426025804","html_url":"https://github.com/apache/couchdb/issues/1634#issuecomment-426025804","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1634","id":426025804,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjAyNTgwNA==","user":{"login":"JohnOllhorn","id":28832014,"node_id":"MDQ6VXNlcjI4ODMyMDE0","avatar_url":"https://avatars.githubusercontent.com/u/28832014?v=4","gravatar_id":"","url":"https://api.github.com/users/JohnOllhorn","html_url":"https://github.com/JohnOllhorn","followers_url":"https://api.github.com/users/JohnOllhorn/followers","following_url":"https://api.github.com/users/JohnOllhorn/following{/other_user}","gists_url":"https://api.github.com/users/JohnOllhorn/gists{/gist_id}","starred_url":"https://api.github.com/users/JohnOllhorn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JohnOllhorn/subscriptions","organizations_url":"https://api.github.com/users/JohnOllhorn/orgs","repos_url":"https://api.github.com/users/JohnOllhorn/repos","events_url":"https://api.github.com/users/JohnOllhorn/events{/privacy}","received_events_url":"https://api.github.com/users/JohnOllhorn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-01T19:06:14Z","updated_at":"2018-10-01T19:06:14Z","author_association":"NONE","body":"It's really weak and disappointing. It must be in your interest to support Docker.\r\nMy only option is to migrate to MongoDB.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426025804/reactions","total_count":1,"+1":0,"-1":1,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426030555","html_url":"https://github.com/apache/couchdb/issues/1634#issuecomment-426030555","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1634","id":426030555,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjAzMDU1NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-01T19:21:27Z","updated_at":"2018-10-01T19:21:27Z","author_association":"MEMBER","body":"@JohnOllhorn The person in that ticket seems happy with that solution - why not try it?\r\n\r\nUse what works best for you. We are a volunteer project here. Our volunteers who do cluster things prefer to use Kubernetes, and they are very successful with it. Why not give it a try?\r\n\r\nOur feelings won't be hurt if you switch to MongoDB.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426030555/reactions","total_count":4,"+1":4,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426294219","html_url":"https://github.com/apache/couchdb/pull/1615#issuecomment-426294219","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1615","id":426294219,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjI5NDIxOQ==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-02T14:26:04Z","updated_at":"2018-10-02T14:26:04Z","author_association":"MEMBER","body":"This is merged into the partitions branch.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426294219/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426302320","html_url":"https://github.com/apache/couchdb/pull/1619#issuecomment-426302320","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1619","id":426302320,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjMwMjMyMA==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-02T14:47:47Z","updated_at":"2018-10-02T14:48:11Z","author_association":"MEMBER","body":"I'm -0 on this. It doesn't properly fix the problem we introduced when we taught the replicator to acquire session cookies if the user has changed the session timeout parameter.\r\n\r\nA better fix is for expired cookies to return a 401 rather than silently fall back to the next auth handler. Since that is a profoundly backward incompatible change it would need to be opt-in.\r\n\r\nThe replicator would do `POST /_session?hard_expire=true` to acquire a session cookie.\r\n\r\nThe server, when presented with an expired cookie returned by that method will throw an unauthorized error, which in turn forces the replicator to acquire a fresh one.\r\n\r\nThis should be done in addition to a periodic refresh ahead of the expiration to avoid stalling replication progress during the refresh.\r\n\r\nI also note that the session cookie response header tells us exactly when it expires, and this value, not a hardcoded 550 should be used to determine when to pre-emptively refresh.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426302320/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426305108","html_url":"https://github.com/apache/couchdb/pull/1619#issuecomment-426305108","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1619","id":426305108,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjMwNTEwOA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-02T14:54:35Z","updated_at":"2018-10-02T14:54:35Z","author_association":"CONTRIBUTOR","body":"Good points. Yeah a hard cookie expire would be an ideal solution. And I had also forgotten about the expired header which would still be better than this solution. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426305108/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426317032","html_url":"https://github.com/apache/couchdb/pull/1619#issuecomment-426317032","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1619","id":426317032,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjMxNzAzMg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-02T15:25:42Z","updated_at":"2018-10-03T05:32:01Z","author_association":"CONTRIBUTOR","body":"Hmm cookies only get an expiration header if allow_persistent is enabled and it's not by default. \r\n\r\n```\r\n$curl -c /tmp/cdb.cookies -H 'Content-Type: application/x-www-form-urlencoded' -v -XPOST $DB/_session -d 'name=adm&password=pass'\r\n```\r\n\r\n```\r\n rpc:multicall(config, set, [\"couch_httpd_auth\", \"allow_persistent_cookies\", \"true\"]).\r\n```\r\n\r\n```\r\n* upload completely sent off: 22 out of 22 bytes\r\n< HTTP/1.1 200 OK\r\n< Cache-Control: must-revalidate\r\n< Content-Length: 44\r\n< Content-Type: application/json\r\n< Date: Tue, 02 Oct 2018 15:22:26 GMT\r\n< Server: CouchDB/2.2.0-581c2fa6a (Erlang OTP/20)\r\n* Added cookie AuthSession=\"YWRtOjVCQjM4RDMyOnYWLJijs4Uc5Aaj84GjZtLsNz9X\" for domain 127.0.0.1, path /, expire 0\r\n< Set-Cookie: AuthSession=YWRtOjVCQjM4RDMyOnYWLJijs4Uc5Aaj84GjZtLsNz9X; Version=1; Path=/; HttpOnly\r\n<\r\n{\"ok\":true,\"name\":\"adm\",\"roles\":[\"_admin\"]}\r\n```\r\n\r\n```\r\n rpc:multicall(config, set, [\"couch_httpd_auth\", \"allow_persistent_cookies\", \"true\"]).\r\n```\r\n\r\n```\r\n* upload completely sent off: 22 out of 22 bytes\r\n< HTTP/1.1 200 OK\r\n< Cache-Control: must-revalidate\r\n< Content-Length: 44\r\n< Content-Type: application/json\r\n< Date: Tue, 02 Oct 2018 15:23:46 GMT\r\n< Server: CouchDB/2.2.0-581c2fa6a (Erlang OTP/20)\r\n* Added cookie AuthSession=\"YWRtOjVCQjM4RDgyOr7-XxqhgZhHnfWQWY365LpeytTU\" for domain 127.0.0.1, path /, expire 1538494426\r\n< Set-Cookie: AuthSession=YWRtOjVCQjM4RDgyOr7-XxqhgZhHnfWQWY365LpeytTU; Version=1; Expires=Tue, 02-Oct-2018 15:33:46 GMT; Max-Age=600; Path=/; HttpOnly\r\n<\r\n{\"ok\":true,\"name\":\"adm\",\"roles\":[\"_admin\"]}\r\n```\r\n\r\nHmm maybe allow_persistent should be true by default...?\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426317032/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426337601","html_url":"https://github.com/apache/couchdb/pull/1620#issuecomment-426337601","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1620","id":426337601,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjMzNzYwMQ==","user":{"login":"ermouth","id":1540047,"node_id":"MDQ6VXNlcjE1NDAwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/1540047?v=4","gravatar_id":"","url":"https://api.github.com/users/ermouth","html_url":"https://github.com/ermouth","followers_url":"https://api.github.com/users/ermouth/followers","following_url":"https://api.github.com/users/ermouth/following{/other_user}","gists_url":"https://api.github.com/users/ermouth/gists{/gist_id}","starred_url":"https://api.github.com/users/ermouth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ermouth/subscriptions","organizations_url":"https://api.github.com/users/ermouth/orgs","repos_url":"https://api.github.com/users/ermouth/repos","events_url":"https://api.github.com/users/ermouth/events{/privacy}","received_events_url":"https://api.github.com/users/ermouth/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-02T16:21:22Z","updated_at":"2018-10-02T16:21:22Z","author_association":"CONTRIBUTOR","body":"@wohali I added small test, but see failed CI. What should I do with this? Seems CI fails on smth completely unrelated to rewrites.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426337601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426345421","html_url":"https://github.com/apache/couchdb/pull/1620#issuecomment-426345421","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1620","id":426345421,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjM0NTQyMQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-02T16:43:02Z","updated_at":"2018-10-02T16:43:02Z","author_association":"MEMBER","body":"@ermouth thanks, I'll just update the branch to master's latest and re-run them. Test suite can be a bit touchy sometimes, it's an endless battle to keep it green all the time.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426345421/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426364080","html_url":"https://github.com/apache/couchdb/pull/1620#issuecomment-426364080","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1620","id":426364080,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjM2NDA4MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-02T17:37:29Z","updated_at":"2018-10-02T17:37:29Z","author_association":"MEMBER","body":"@ermouth Thanks for the patch!!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426364080/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426399744","html_url":"https://github.com/apache/couchdb/pull/1631#issuecomment-426399744","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1631","id":426399744,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjM5OTc0NA==","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-02T19:26:08Z","updated_at":"2018-10-02T19:26:08Z","author_association":"CONTRIBUTOR","body":"LGTM\r\n```\r\n$ make eunit skip_deps+=couch_epi apps=couch_replicator suites=couch_replicator_docs tests=update_replicator_doc_with_bad_vdu_test_\r\n    Running test function(s):\r\n      couch_replicator_docs:update_replicator_doc_with_bad_vdu_test_/0\r\n======================== EUnit ========================\r\ncouch_replicator_docs:820: t_vdu_does_not_crash_on_save...[0.057 s] ok\r\n=======================================================\r\n  Test passed.\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426399744/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426681587","html_url":"https://github.com/apache/couchdb/issues/1621#issuecomment-426681587","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1621","id":426681587,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjY4MTU4Nw==","user":{"login":"H--o-l","id":10905922,"node_id":"MDQ6VXNlcjEwOTA1OTIy","avatar_url":"https://avatars.githubusercontent.com/u/10905922?v=4","gravatar_id":"","url":"https://api.github.com/users/H--o-l","html_url":"https://github.com/H--o-l","followers_url":"https://api.github.com/users/H--o-l/followers","following_url":"https://api.github.com/users/H--o-l/following{/other_user}","gists_url":"https://api.github.com/users/H--o-l/gists{/gist_id}","starred_url":"https://api.github.com/users/H--o-l/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/H--o-l/subscriptions","organizations_url":"https://api.github.com/users/H--o-l/orgs","repos_url":"https://api.github.com/users/H--o-l/repos","events_url":"https://api.github.com/users/H--o-l/events{/privacy}","received_events_url":"https://api.github.com/users/H--o-l/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-03T15:31:19Z","updated_at":"2018-10-03T16:43:35Z","author_association":"NONE","body":"Hi !\r\n\r\nI'm working with @adrienverge and I continue to investigate the \"black matter\" issue.\r\n\r\nAs @adrienverge said, shard files (`db.1520354435.couch`) constantly keep growing (by several kB per day), even though there are no requests done to them.\r\nThis is a problem because we have *many* small, untouched databases.\r\n\r\nCompaction helps to free space on a regular basis, but it takes a bunch of cpu time.\r\nSo we would like to understand what is happening in our `.couch` files.\r\n\r\nIn a node of our cluster we monitored output of `strings /var/lib/couchd/shards/xxx/db.1520354435.couch`.\r\nIn one night, it had ~800 new rows like this one:\r\n```\r\nkv_nodel\r\n?_local/shard-sync-VNaRvSQnMLpUSzV8iZvcow-IOHL5NIdglwNQCT0DL_V0Ah\r\nseqa}\t],\r\ntarget_uuid\r\n cef8fe0a2eac1f0f7af0d5e0c56fbbd8\t7\r\nhistoryh\r\n@;couchdb@node1l\r\n142-216\r\n-$!7\r\nsource\r\nx2a65d174d772861e4cd085e9e347729-\r\n$\ttimestamp!7|\r\n2018-10-02T22:21:13.181557Zjjjj\t~Jd\r\nTgKo_QqiB9XPEFr08HvUC2Q\r\n98-214\r\nM/Uf|e0dc03c296d3847efd92e964053e5f1b\t7\r\nP15:23:01.533200Zjjjjj\r\nkp_nodel\r\n?_local/shard-sync-IOHL5NIdglwNQCT0DL_V0A-gKo_QqiB9XPEFr08HvUC2Qh\r\n-IOHLFj\r\n\tdb_headera\r\n\tsize_infob\r\nnilb\r\n cef8fe0a2eac1f0f7af0d5e0c56fbbd8l\r\n<couchdb@node2a\r\n```\r\n\r\nAs we have ~34k dbs, multiplied by 8 shards by node, it quickly sum up and takes a lot of space and a lot of compaction time, which sometimes ends up saturating our disks and CPU.\r\n\r\nCan you advise us ?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426681587/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426731113","html_url":"https://github.com/apache/couchdb/issues/1621#issuecomment-426731113","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1621","id":426731113,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjczMTExMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-03T17:45:48Z","updated_at":"2018-10-03T17:45:48Z","author_association":"MEMBER","body":"@H--o-l that's not useful for us.\r\n\r\nCan you look instead at: `https://your-host-name:5984/dbname/_local_docs`? You should be able to diff this, then pull the specific documents out for us to look at.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426731113/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426731433","html_url":"https://github.com/apache/couchdb/pull/1637#issuecomment-426731433","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1637","id":426731433,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjczMTQzMw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-03T17:46:44Z","updated_at":"2018-10-03T17:46:44Z","author_association":"CONTRIBUTOR","body":"EUnit already logs to files:\r\n\r\n```\r\nmake eunit apps=mem3\r\n```\r\n\r\n```\r\n$ cat ./src/mem3/.eunit/couch.log\r\n\r\n...\r\n\r\n[error] 2018-10-03T17:42:57.280138Z nonode@nohost <0.137.0> -------- Db was deleted while getting security object. DbName: <<\"NoExistDb2\">>\r\n[info] 2018-10-03T17:42:57.282706Z nonode@nohost <0.33.0> -------- Application fabric exited with reason: stopped\r\n[info] 2018-10-03T17:42:57.283289Z nonode@nohost <0.33.0> -------- Application mem3 exited with reason: stopped\r\n[info] 2018-10-03T17:42:57.283683Z nonode@nohost <0.33.0> -------- Application rexi exited with reason: stopped\r\n...\r\n```\r\n\r\nLog level and other parameters can be configured in: ```./rel/files/eunit.ini```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426731433/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426732513","html_url":"https://github.com/apache/couchdb/pull/1639#issuecomment-426732513","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1639","id":426732513,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjczMjUxMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-03T17:49:58Z","updated_at":"2018-10-03T17:49:58Z","author_association":"MEMBER","body":"@nickva I *think* this will work, but it will break Jenkins in other ways (not every Docker image has python3 installed right now). In fact, it'll turn everything in Jenkins red other than CentOS 6 I expect (and maybe Ubuntu 18.04? Not sure...) That's on me, I am happy to shift us entirely over to python3.\r\n\r\nIt may also break developers' environments if they don't have python3 installed. You'll want at the very least to update these other places:\r\n\r\n* `README-DEV.rst`\r\n* `apache/couchdb-ci:bin/*-dependencies.sh` (make sure Python 3 gets installed everywhere)\r\n\r\nIf you can do both of the above then it'll be a snap for me to rebuild the Docker images for Jenkins and re-push them to Docker Hub. (In fact, it's a single command.)\r\n\r\nPlease and thank you! :D","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426732513/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426745902","html_url":"https://github.com/apache/couchdb/issues/1621#issuecomment-426745902","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1621","id":426745902,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjc0NTkwMg==","user":{"login":"H--o-l","id":10905922,"node_id":"MDQ6VXNlcjEwOTA1OTIy","avatar_url":"https://avatars.githubusercontent.com/u/10905922?v=4","gravatar_id":"","url":"https://api.github.com/users/H--o-l","html_url":"https://github.com/H--o-l","followers_url":"https://api.github.com/users/H--o-l/followers","following_url":"https://api.github.com/users/H--o-l/following{/other_user}","gists_url":"https://api.github.com/users/H--o-l/gists{/gist_id}","starred_url":"https://api.github.com/users/H--o-l/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/H--o-l/subscriptions","organizations_url":"https://api.github.com/users/H--o-l/orgs","repos_url":"https://api.github.com/users/H--o-l/repos","events_url":"https://api.github.com/users/H--o-l/events{/privacy}","received_events_url":"https://api.github.com/users/H--o-l/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-03T18:28:32Z","updated_at":"2018-10-04T09:12:35Z","author_association":"NONE","body":"@wohali Thanks for looking at it.\r\n\r\nFor the example above, those are documents that seems to be impacted:\r\n```json\r\n{\r\n  \"id\": \"_local/shard-sync-VNaRvSQnMLpUSzV8iZvcow-IOHL5NIdglwNQCT0DL_V0A\",\r\n  \"key\": \"_local/shard-sync-VNaRvSQnMLpUSzV8iZvcow-IOHL5NIdglwNQCT0DL_V0A\",\r\n  \"value\": {\r\n    \"rev\": \"0-1\"\r\n  },\r\n  \"doc\": {\r\n    \"seq\": 125,\r\n    \"target_uuid\": \"cef8fe0a2eac1f0f7af0d5e0c56fbbd8\",\r\n    \"history\": {\r\n      \"couchdb@node1\": [\r\n        {\r\n          \"target_node\": \"couchdb@node2\",\r\n          \"target_uuid\": \"cef8fe0a2eac1f0f7af0d5e0c56fbbd8\",\r\n          \"target_seq\": 127,\r\n          \"source_node\": \"couchdb@node1\",\r\n          \"source_uuid\": \"2a65d174d772861e4cd085e9e3477298\",\r\n          \"source_seq\": 125,\r\n          \"timestamp\": \"2018-10-02T22:21:13.181557Z\"\r\n        }\r\n      ]\r\n    }\r\n  }\r\n}\r\n```\r\n```json\r\n{\r\n  \"id\": \"_local/shard-sync-IOHL5NIdglwNQCT0DL_V0A-gKo_QqiB9XPEFr08HvUC2Q\",\r\n  \"key\": \"_local/shard-sync-IOHL5NIdglwNQCT0DL_V0A-gKo_QqiB9XPEFr08HvUC2Q\",\r\n  \"value\": {\r\n    \"rev\": \"0-1\"\r\n  },\r\n  \"doc\": {\r\n    \"seq\": 125,\r\n    \"target_uuid\": \"e0dc03c296d3847efd92e964053e5f1b\",\r\n    \"history\": {\r\n      \"couchdb@node2\": [\r\n        {\r\n          \"target_node\": \"couchdb@node3\",\r\n          \"target_uuid\": \"e0dc03c296d3847efd92e964053e5f1b\",\r\n          \"target_seq\": 127,\r\n          \"source_node\": \"couchdb@node2\",\r\n          \"source_uuid\": \"cef8fe0a2eac1f0f7af0d5e0c56fbbd8\",\r\n          \"source_seq\": 125,\r\n          \"timestamp\": \"2018-10-02T15:23:00.382192Z\"\r\n        }\r\n      ]\r\n    }\r\n  }\r\n}\r\n```\r\nSadly I can't give you a diff before/after, those are the documents in there actual state.\r\n\r\nBy the way, it's seems that restarting couchdb service on our three nodes have a impact on the \"black matter\", as it increase it (we observe from 8Go of shards to 12Go of shards 1h after service restart, and nothing else happening on the machines).\r\n\r\nDoes that seems possible ?\r\n\r\nThanks again for your help !\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426745902/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426746377","html_url":"https://github.com/apache/couchdb/pull/1637#issuecomment-426746377","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1637","id":426746377,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjc0NjM3Nw==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-03T18:29:47Z","updated_at":"2018-10-03T18:29:47Z","author_association":"CONTRIBUTOR","body":"The default log level for `./rel/files/eunit.ini` is `none`. In order to debug eunit the one have to \r\n- update the config file\r\n- know which application the test is located to look for log file\r\n\r\nThis PR adds ability to use env variables to enable logging which is easier compared to editing the file. \r\nI am happy to close the PR since it is a bit redundant feature. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426746377/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426753058","html_url":"https://github.com/apache/couchdb/pull/1639#issuecomment-426753058","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1639","id":426753058,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjc1MzA1OA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-03T18:46:44Z","updated_at":"2018-10-03T18:46:44Z","author_association":"CONTRIBUTOR","body":"Will do, good idea.\r\n\r\nAlso we run mango with python2.7 currently. Let's see if that can run with python3 as well.\r\n\r\nWill make it a separate commit","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426753058/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426778007","html_url":"https://github.com/apache/couchdb/pull/1639#issuecomment-426778007","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1639","id":426778007,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjc3ODAwNw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-03T19:55:38Z","updated_at":"2018-10-03T19:55:38Z","author_association":"CONTRIBUTOR","body":"Updated with a commit to run mango test with Python 3","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426778007/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426781590","html_url":"https://github.com/apache/couchdb/pull/1637#issuecomment-426781590","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1637","id":426781590,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjc4MTU5MA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-03T20:05:44Z","updated_at":"2018-10-03T20:05:44Z","author_association":"CONTRIBUTOR","body":"> The default log level for ./rel/files/eunit.ini is none.\r\n\r\nIn the recent master I see it has\r\n\r\n```\r\n[log]\r\n; log to a file to save our terminals from log spam\r\nwriter = file\r\nfile = couch.log\r\nlevel = info\r\n```\r\n\r\nAnd most crashes would be caught at level `error` anyway.\r\n\r\nIn the test run above, I didn't tweak or modify the .ini file and it logged progress well enough. Do you have something locally which attempts to modify the file before running tests?\r\n\r\n> know which application the test is located to look for log file\r\n\r\nThat part is kind of annoying, agree. I would be nice to have one single file to look at and not have to fish through .eunit folders.\r\n\r\n@eiri already approved and I'm +0.5 on it. If you think it's helpful go ahead and merge it","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426781590/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426784556","html_url":"https://github.com/apache/couchdb/pull/1639#issuecomment-426784556","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1639","id":426784556,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjc4NDU1Ng==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-03T20:13:50Z","updated_at":"2018-10-03T20:13:50Z","author_association":"CONTRIBUTOR","body":"PR to couchdb-ci https://github.com/apache/couchdb-ci/pull/8\r\n\r\nI saw failures in the Travis CI with it as you predicted.\r\n\r\nWonder if it is better to just revert the change on master for now, as latest Fedora is less critical to support than existing  platforms? And then return to it later, post 2.3? I'll follow your guidance since you'd know a lot more about the scope of issues involved.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426784556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426784748","html_url":"https://github.com/apache/couchdb/pull/1637#issuecomment-426784748","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1637","id":426784748,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjc4NDc0OA==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-03T20:14:22Z","updated_at":"2018-10-03T20:14:22Z","author_association":"MEMBER","body":"> It would be nice to have one single file to look at and not have to fish through .eunit folders.\r\n\r\nBasically this is why I also +0.5 on this change, which gives it a whole +1 😉 \r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426784748/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426971937","html_url":"https://github.com/apache/couchdb/pull/1637#issuecomment-426971937","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1637","id":426971937,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjk3MTkzNw==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-04T10:47:00Z","updated_at":"2018-10-04T10:47:00Z","author_association":"CONTRIBUTOR","body":"Closing it as redundant. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/426971937/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/427010226","html_url":"https://github.com/apache/couchdb/pull/1640#issuecomment-427010226","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1640","id":427010226,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNzAxMDIyNg==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-04T13:03:39Z","updated_at":"2018-10-04T13:03:39Z","author_association":"CONTRIBUTOR","body":"There is another place where monitored_by is used:\r\n- https://github.com/apache/couchdb/blob/master/src/couch/test/couchdb_views_tests.erl#L526\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/427010226/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/427028744","html_url":"https://github.com/apache/couchdb/pull/1640#issuecomment-427028744","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1640","id":427028744,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNzAyODc0NA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-04T13:56:59Z","updated_at":"2018-10-04T13:56:59Z","author_association":"MEMBER","body":"+1 after some squerging","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/427028744/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/427031532","html_url":"https://github.com/apache/couchdb/pull/1640#issuecomment-427031532","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1640","id":427031532,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNzAzMTUzMg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-04T14:04:40Z","updated_at":"2018-10-04T14:04:40Z","author_association":"CONTRIBUTOR","body":"@iilyak good catch! \r\n\r\n@davisp good idea, will do some squerging","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/427031532/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280565649","html_url":"https://github.com/apache/couchdb/issues/4211#issuecomment-1280565649","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4211","id":1280565649,"node_id":"MDEyOklzc3VlQ29tbWVudDEyODA1NjU2NDk=","user":{"login":"krishvoor","id":14876995,"node_id":"MDQ6VXNlcjE0ODc2OTk1","avatar_url":"https://avatars.githubusercontent.com/u/14876995?v=4","gravatar_id":"","url":"https://api.github.com/users/krishvoor","html_url":"https://github.com/krishvoor","followers_url":"https://api.github.com/users/krishvoor/followers","following_url":"https://api.github.com/users/krishvoor/following{/other_user}","gists_url":"https://api.github.com/users/krishvoor/gists{/gist_id}","starred_url":"https://api.github.com/users/krishvoor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/krishvoor/subscriptions","organizations_url":"https://api.github.com/users/krishvoor/orgs","repos_url":"https://api.github.com/users/krishvoor/repos","events_url":"https://api.github.com/users/krishvoor/events{/privacy}","received_events_url":"https://api.github.com/users/krishvoor/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-06T17:47:48Z","updated_at":"2018-10-06T17:47:48Z","author_association":"NONE","body":"We are also experiencing slowness whilst running CouchDB inside a Docker Instance, especially on a blockchain network where couchdb is leveraged. FWIW, here's the reference https://jira.hyperledger.org/browse/FAB-12023 , any recommendations/settings that you would recommend as such ?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280565649/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/427740281","html_url":"https://github.com/apache/couchdb/issues/1645#issuecomment-427740281","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1645","id":427740281,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNzc0MDI4MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-08T07:18:14Z","updated_at":"2018-10-08T07:18:14Z","author_association":"MEMBER","body":"Sorry, the CouchDB team no longer support CouchDB 1.x. If you can reproduce the problem with CouchDB 2.2.0, we'll have a look.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/427740281/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/427754625","html_url":"https://github.com/apache/couchdb/issues/1018#issuecomment-427754625","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1018","id":427754625,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNzc1NDYyNQ==","user":{"login":"dravenk","id":14295318,"node_id":"MDQ6VXNlcjE0Mjk1MzE4","avatar_url":"https://avatars.githubusercontent.com/u/14295318?v=4","gravatar_id":"","url":"https://api.github.com/users/dravenk","html_url":"https://github.com/dravenk","followers_url":"https://api.github.com/users/dravenk/followers","following_url":"https://api.github.com/users/dravenk/following{/other_user}","gists_url":"https://api.github.com/users/dravenk/gists{/gist_id}","starred_url":"https://api.github.com/users/dravenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dravenk/subscriptions","organizations_url":"https://api.github.com/users/dravenk/orgs","repos_url":"https://api.github.com/users/dravenk/repos","events_url":"https://api.github.com/users/dravenk/events{/privacy}","received_events_url":"https://api.github.com/users/dravenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-08T08:22:53Z","updated_at":"2019-12-27T02:59:35Z","author_association":"NONE","body":"~~delete~~","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/427754625/reactions","total_count":3,"+1":0,"-1":3,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/427788372","html_url":"https://github.com/apache/couchdb/issues/1644#issuecomment-427788372","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1644","id":427788372,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNzc4ODM3Mg==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-08T10:38:40Z","updated_at":"2018-10-08T10:38:40Z","author_association":"CONTRIBUTOR","body":"The problem is [here](https://github.com/apache/couchdb/blob/master/src/couch/src/couch_db.erl#L1741). We only match the suffix of the database and don't check validity of the prefix. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/427788372/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/427804738","html_url":"https://github.com/apache/couchdb/pull/1647#issuecomment-427804738","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1647","id":427804738,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNzgwNDczOA==","user":{"login":"lazedo","id":770988,"node_id":"MDQ6VXNlcjc3MDk4OA==","avatar_url":"https://avatars.githubusercontent.com/u/770988?v=4","gravatar_id":"","url":"https://api.github.com/users/lazedo","html_url":"https://github.com/lazedo","followers_url":"https://api.github.com/users/lazedo/followers","following_url":"https://api.github.com/users/lazedo/following{/other_user}","gists_url":"https://api.github.com/users/lazedo/gists{/gist_id}","starred_url":"https://api.github.com/users/lazedo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lazedo/subscriptions","organizations_url":"https://api.github.com/users/lazedo/orgs","repos_url":"https://api.github.com/users/lazedo/repos","events_url":"https://api.github.com/users/lazedo/events{/privacy}","received_events_url":"https://api.github.com/users/lazedo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-08T11:50:20Z","updated_at":"2018-10-08T11:50:20Z","author_association":"CONTRIBUTOR","body":"hello,\r\n\r\ni just want to make sure that this doesn't break our current usage.\r\nwe create DBs with names like this `account%2F85%2Fea%2F6075c6c1e266f8512e2233541bdb-201807`\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/427804738/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/427817810","html_url":"https://github.com/apache/couchdb/pull/1647#issuecomment-427817810","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1647","id":427817810,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNzgxNzgxMA==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-08T12:42:57Z","updated_at":"2018-10-08T12:42:57Z","author_association":"CONTRIBUTOR","body":"@lazedo \r\n\r\nIt would still work:\r\n```\r\n(node1@127.0.0.1)3> couch_db:validate_dbname(\"account/85/ea/6075c6c1e266f8512e2233541bdb-201807\").\r\nok\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/427817810/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/427980458","html_url":"https://github.com/apache/couchdb/issues/1540#issuecomment-427980458","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1540","id":427980458,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNzk4MDQ1OA==","user":{"login":"cluxter","id":6885295,"node_id":"MDQ6VXNlcjY4ODUyOTU=","avatar_url":"https://avatars.githubusercontent.com/u/6885295?v=4","gravatar_id":"","url":"https://api.github.com/users/cluxter","html_url":"https://github.com/cluxter","followers_url":"https://api.github.com/users/cluxter/followers","following_url":"https://api.github.com/users/cluxter/following{/other_user}","gists_url":"https://api.github.com/users/cluxter/gists{/gist_id}","starred_url":"https://api.github.com/users/cluxter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cluxter/subscriptions","organizations_url":"https://api.github.com/users/cluxter/orgs","repos_url":"https://api.github.com/users/cluxter/repos","events_url":"https://api.github.com/users/cluxter/events{/privacy}","received_events_url":"https://api.github.com/users/cluxter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-08T21:11:04Z","updated_at":"2018-10-08T21:11:04Z","author_association":"NONE","body":"**In an ideal situation, I would like to be able to**:\r\n1) **upload attachments of unlimited size**, ie. only limited by the file system, not by the CouchDB storage system (so nothing like this: https://github.com/apache/couchdb/pull/1253 )\r\n2) **have a smooth replication of these attachments between the CouchDB instances**, ie. huge attachments replications won't clog up CouchDB in any way (which doesn't mean the replication wouldn't be slowed down, obviously; we don't have unlimited bandwidth).\r\n\r\n**This desire implies that**:\r\n1) **being able to store huge attachments in a database is not seen as bad practice**. I'm certain some people will come up and say \"Hey, ending up storing files of thousands of gigabytes in a database is silly, this means that your storage design is wrong, go fix that now instead of using CouchDB as a file system\". Well, in 10 or 15 years, files of hundreds of gigabytes might be normal for some activities and I would like CouchDB to be able to scale by design, not because of the hardware available through time. The idea here is _not_ to use CouchDB as a file system, but being able to have a place in which _all_ data of a software system could fit. I don't like the idea that I have to use one storage system for small files (CouchDB) and one other storage system for big files, especially when the size limit of the files is arbitrary and depends on the bandwidth/CPU available (or some vague notion). Basically putting a maximum size limit on attachments means that we don't want to deal with this issue and that we let it for another system to fix it. Or worse: we make people believe that they can use attachments but... not really actually.\r\n2) **we need a strong resilient and reliable replication system which can operate under bad conditions**. This would align on the strong resiliency CouchDB already offers with regards to unexpected shutdowns. My instinct tells me that a P2P system similar to Kazaa/eMule/Bittorrent (I'm looking at the multi-sources P2P paradigm, not the protocols per se) would be ideal because it's fast, efficient and resilient. But maybe this is not well suited for CouchDB. Or maybe we are using this already (not what I understood so far though). I'm pretty sure this would require _a lot_ of work, but I would at least like to know that it's somewhere on the long term road-map.\r\n\r\nNow **this is a personal vision** of what CouchDB should look like but maybe this is not shared by many other people. Or maybe it is. Please don't hesitate to (respectfully and constructively) criticize my views and argument on them, I'm eager to learn more about why this should or should not be done.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/427980458/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/427991875","html_url":"https://github.com/apache/couchdb/issues/1540#issuecomment-427991875","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1540","id":427991875,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNzk5MTg3NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-08T21:55:22Z","updated_at":"2018-10-08T21:55:22Z","author_association":"MEMBER","body":"@cluxter Right now, large attachments (>16MB of attachments per JSON document) aren't a first order design scenario for CouchDB internal storage or so-called \"internal replication\" between nodes in a cluster. That needs to be resolved before thinking about any sort of \"external\" replication enhancements that specifically address large files.\r\n\r\nThe people who get to make that decision are the people who actually develop CouchDB. If you're an Erlang developer and think you have the chops to tackle this, we'd love to see your patches.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/427991875/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280565658","html_url":"https://github.com/apache/couchdb/issues/4211#issuecomment-1280565658","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4211","id":1280565658,"node_id":"MDEyOklzc3VlQ29tbWVudDEyODA1NjU2NTg=","user":{"login":"denyeart","id":20165681,"node_id":"MDQ6VXNlcjIwMTY1Njgx","avatar_url":"https://avatars.githubusercontent.com/u/20165681?v=4","gravatar_id":"","url":"https://api.github.com/users/denyeart","html_url":"https://github.com/denyeart","followers_url":"https://api.github.com/users/denyeart/followers","following_url":"https://api.github.com/users/denyeart/following{/other_user}","gists_url":"https://api.github.com/users/denyeart/gists{/gist_id}","starred_url":"https://api.github.com/users/denyeart/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/denyeart/subscriptions","organizations_url":"https://api.github.com/users/denyeart/orgs","repos_url":"https://api.github.com/users/denyeart/repos","events_url":"https://api.github.com/users/denyeart/events{/privacy}","received_events_url":"https://api.github.com/users/denyeart/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-09T02:52:00Z","updated_at":"2018-10-09T02:53:46Z","author_association":"NONE","body":"@wohali @harsha544 \r\nWe resolved our performance issue of CouchDB docker container slow startup by moving permission statements from docker-entrypoint.sh to Dockerfile.in so that they are baked into the image rather executed at container startup. For details see https://github.com/hyperledger/fabric-baseimage/commit/ec6800afe059075f8c4a07a4308304be2bb6a48b.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280565658/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280565670","html_url":"https://github.com/apache/couchdb/issues/4211#issuecomment-1280565670","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4211","id":1280565670,"node_id":"MDEyOklzc3VlQ29tbWVudDEyODA1NjU2NzA=","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-09T04:17:17Z","updated_at":"2018-10-09T04:17:17Z","author_association":"MEMBER","body":"@denyeart Thanks, though I see you reverted from 2.2.0 to 2.1.1, which could have a huge impact too.\r\n\r\nWould you consider a PR against apache/couchdb-docker with this change?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280565670/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280565676","html_url":"https://github.com/apache/couchdb/issues/4211#issuecomment-1280565676","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4211","id":1280565676,"node_id":"MDEyOklzc3VlQ29tbWVudDEyODA1NjU2NzY=","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-09T04:27:37Z","updated_at":"2018-10-09T04:27:37Z","author_association":"MEMBER","body":"also @kocolosk see above","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280565676/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/428365182","html_url":"https://github.com/apache/couchdb/pull/1647#issuecomment-428365182","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1647","id":428365182,"node_id":"MDEyOklzc3VlQ29tbWVudDQyODM2NTE4Mg==","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-09T21:50:16Z","updated_at":"2018-10-09T21:50:42Z","author_association":"CONTRIBUTOR","body":"```\r\nmake eunit apps=couch tests=validate_dbname_fail_test_,validate_dbname_success_test_,is_systemdb_test_\r\n...\r\n=======================================================\r\n  All 144 tests passed.\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/428365182/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280565683","html_url":"https://github.com/apache/couchdb/issues/4211#issuecomment-1280565683","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4211","id":1280565683,"node_id":"MDEyOklzc3VlQ29tbWVudDEyODA1NjU2ODM=","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-09T22:16:16Z","updated_at":"2018-10-09T22:16:54Z","author_association":"MEMBER","body":"So that change goes directly against the comment\r\n\r\n> we need to set the permissions here because docker mounts volumes as root\r\n\r\nWas that comment just incorrect? It's been hanging around the codebase approximately forever - I tracked it back to apache/couchdb-docker@80b3bb4137.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280565683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280565692","html_url":"https://github.com/apache/couchdb/issues/4211#issuecomment-1280565692","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4211","id":1280565692,"node_id":"MDEyOklzc3VlQ29tbWVudDEyODA1NjU2OTI=","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-10T03:25:01Z","updated_at":"2018-10-10T03:25:01Z","author_association":"MEMBER","body":"I experimented a bit more with this and I suspect we're carrying around some dead weight. The `chown` commands don't do anything on a modern Docker engine as far as I can tell - everything is already owned by user `couchdb`. The `chmod` commands do have an effect but honestly I'm wondering if these are even necessary:\r\n\r\n- Switch `/opt/couchdb/data` from 755 to 770\r\n- Switch the .ini files from 644 to 664\r\n- Switch the config directories from 755 to 775\r\n\r\nI don't know what standard we used to come up with these settings but e.g. the `docker.ini` file that we create in `docker-entrypoint.sh` has 644 permissions so we're not even internally consistent.\r\n\r\nI don't have a proper test matrix of Docker engine versions etc. to see if there was a point in time at which these settings were needed. I've also not tried Windows or anything else exotic.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280565692/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280565704","html_url":"https://github.com/apache/couchdb/issues/4211#issuecomment-1280565704","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4211","id":1280565704,"node_id":"MDEyOklzc3VlQ29tbWVudDEyODA1NjU3MDQ=","user":{"login":"denyeart","id":20165681,"node_id":"MDQ6VXNlcjIwMTY1Njgx","avatar_url":"https://avatars.githubusercontent.com/u/20165681?v=4","gravatar_id":"","url":"https://api.github.com/users/denyeart","html_url":"https://github.com/denyeart","followers_url":"https://api.github.com/users/denyeart/followers","following_url":"https://api.github.com/users/denyeart/following{/other_user}","gists_url":"https://api.github.com/users/denyeart/gists{/gist_id}","starred_url":"https://api.github.com/users/denyeart/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/denyeart/subscriptions","organizations_url":"https://api.github.com/users/denyeart/orgs","repos_url":"https://api.github.com/users/denyeart/repos","events_url":"https://api.github.com/users/denyeart/events{/privacy}","received_events_url":"https://api.github.com/users/denyeart/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-10T04:22:10Z","updated_at":"2018-10-10T04:22:10Z","author_association":"NONE","body":"Thanks for looking into it @kocolosk .  We were unsure how many of the grant statements were actually needed so just followed the precedent from the CouchDB docker-entrypoint.sh. We were quite surprised how long the grant statements took during container startup.  On good hardware it seems to delay container startup by 5 seconds and on poor hardware it could delay over a minute. This delay is completely gone for us after moving the grants to Dockerfile.\r\n\r\n@wohali we are not experts in this space so I'm hesitant to make the contribution. Plus it sounds like CouchDB needs to identify exactly which grant statements are in fact needed. Could you spawn a separate issue for your experts to look into it?\r\n\r\nBTW, we are only moving to 2.1.1 since that is the release that we have system tested the most with our application.  We will indeed move up to 2.2.0 after some more testing on it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280565704/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/428541583","html_url":"https://github.com/apache/couchdb/pull/1605#issuecomment-428541583","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1605","id":428541583,"node_id":"MDEyOklzc3VlQ29tbWVudDQyODU0MTU4Mw==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-10T11:47:42Z","updated_at":"2018-10-10T11:47:42Z","author_association":"CONTRIBUTOR","body":"How we can hide this feature behind a feature flag, so we can stabilize it?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/428541583/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/428913178","html_url":"https://github.com/apache/couchdb/issues/1618#issuecomment-428913178","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1618","id":428913178,"node_id":"MDEyOklzc3VlQ29tbWVudDQyODkxMzE3OA==","user":{"login":"strelok1010","id":42271054,"node_id":"MDQ6VXNlcjQyMjcxMDU0","avatar_url":"https://avatars.githubusercontent.com/u/42271054?v=4","gravatar_id":"","url":"https://api.github.com/users/strelok1010","html_url":"https://github.com/strelok1010","followers_url":"https://api.github.com/users/strelok1010/followers","following_url":"https://api.github.com/users/strelok1010/following{/other_user}","gists_url":"https://api.github.com/users/strelok1010/gists{/gist_id}","starred_url":"https://api.github.com/users/strelok1010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/strelok1010/subscriptions","organizations_url":"https://api.github.com/users/strelok1010/orgs","repos_url":"https://api.github.com/users/strelok1010/repos","events_url":"https://api.github.com/users/strelok1010/events{/privacy}","received_events_url":"https://api.github.com/users/strelok1010/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-11T11:01:41Z","updated_at":"2018-10-11T11:11:20Z","author_association":"NONE","body":"I have changed the reduction from \"_sum\" to \"_count\" and the problem persists.\r\nI have also tried to eliminate the reduction, why?\r\n\r\n{\"error\":\"error\",\"reason\":\"timeout\"}","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/428913178/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/429020070","html_url":"https://github.com/apache/couchdb/pull/1650#issuecomment-429020070","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1650","id":429020070,"node_id":"MDEyOklzc3VlQ29tbWVudDQyOTAyMDA3MA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-11T16:19:12Z","updated_at":"2018-10-11T16:19:12Z","author_association":"MEMBER","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/429020070/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/429035967","html_url":"https://github.com/apache/couchdb/pull/1650#issuecomment-429035967","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1650","id":429035967,"node_id":"MDEyOklzc3VlQ29tbWVudDQyOTAzNTk2Nw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-11T17:00:25Z","updated_at":"2018-10-11T17:00:25Z","author_association":"CONTRIBUTOR","body":" chttpd_db_bulk_get_test eunit failure","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/429035967/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/429038852","html_url":"https://github.com/apache/couchdb/issues/1651#issuecomment-429038852","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1651","id":429038852,"node_id":"MDEyOklzc3VlQ29tbWVudDQyOTAzODg1Mg==","user":{"login":"emlaver","id":10552966,"node_id":"MDQ6VXNlcjEwNTUyOTY2","avatar_url":"https://avatars.githubusercontent.com/u/10552966?v=4","gravatar_id":"","url":"https://api.github.com/users/emlaver","html_url":"https://github.com/emlaver","followers_url":"https://api.github.com/users/emlaver/followers","following_url":"https://api.github.com/users/emlaver/following{/other_user}","gists_url":"https://api.github.com/users/emlaver/gists{/gist_id}","starred_url":"https://api.github.com/users/emlaver/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/emlaver/subscriptions","organizations_url":"https://api.github.com/users/emlaver/orgs","repos_url":"https://api.github.com/users/emlaver/repos","events_url":"https://api.github.com/users/emlaver/events{/privacy}","received_events_url":"https://api.github.com/users/emlaver/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-11T17:08:15Z","updated_at":"2018-10-11T17:08:15Z","author_association":"NONE","body":"@rnewson FYI","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/429038852/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280565712","html_url":"https://github.com/apache/couchdb/issues/4211#issuecomment-1280565712","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4211","id":1280565712,"node_id":"MDEyOklzc3VlQ29tbWVudDEyODA1NjU3MTI=","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-11T18:27:56Z","updated_at":"2018-10-11T18:27:56Z","author_association":"MEMBER","body":"This is the wrong place to have this discussion, as the issue being discussed is slow startup times for Docker.\r\n\r\nMoving this discussion to https://github.com/apache/couchdb-docker/issues/109","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280565712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/429197301","html_url":"https://github.com/apache/couchdb/pull/1649#issuecomment-429197301","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1649","id":429197301,"node_id":"MDEyOklzc3VlQ29tbWVudDQyOTE5NzMwMQ==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-12T04:00:41Z","updated_at":"2018-10-12T04:00:41Z","author_association":"CONTRIBUTOR","body":"Hey @tonysun83 I split this counter into 3.\r\n\r\n```\r\n{[couchdb, document_purges, total], [\r\n    {type, counter},\r\n    {desc, <<\"number of total document purge operations\">>}\r\n]}.\r\n{[couchdb, document_purges, success], [\r\n    {type, counter},\r\n    {desc, <<\"number of successful document purge operations\">>}\r\n]}.\r\n{[couchdb, document_purges, failure], [\r\n    {type, counter},\r\n    {desc, <<\"number of failed document purge operations\">>}\r\n]}.\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/429197301/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/429201569","html_url":"https://github.com/apache/couchdb/pull/1649#issuecomment-429201569","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1649","id":429201569,"node_id":"MDEyOklzc3VlQ29tbWVudDQyOTIwMTU2OQ==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-12T04:35:56Z","updated_at":"2018-10-12T04:35:56Z","author_association":"CONTRIBUTOR","body":"+1 after squerge","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/429201569/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/429956345","html_url":"https://github.com/apache/couchdb/issues/1653#issuecomment-429956345","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1653","id":429956345,"node_id":"MDEyOklzc3VlQ29tbWVudDQyOTk1NjM0NQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-15T18:08:30Z","updated_at":"2018-10-15T18:08:30Z","author_association":"MEMBER","body":"How are you measuring request time? And what numbers are you getting with and without indexing/inserting?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/429956345/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/430047024","html_url":"https://github.com/apache/couchdb/pull/1629#issuecomment-430047024","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1629","id":430047024,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMDA0NzAyNA==","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-15T23:19:26Z","updated_at":"2018-10-15T23:19:26Z","author_association":"CONTRIBUTOR","body":"Comparing\r\n```\r\n$ make eunit skip_tests+=couch_epep apps=couch suites=couchdb_db_tests\r\nmodule 'couchdb_db_tests'\r\n  Checking clustered db API\r\n    DB deletion\r\n      couchdb_db_tests:53: should_close_deleted_db...[0.029 s] ok\r\n      couchdb_db_tests:68: should_kill_caller_from_load_validation_funs_for_deleted_db...[0.033 s] ok\r\n=======================================================\r\n  2 tests passed.\r\n```\r\nwith\r\n```\r\n$ make eunit skip_tests+=couch_epep apps=ddoc_cache suites=ddoc_cache_open_test\r\nmodule 'ddoc_cache_open_test'\r\n  ddoc_cache_open_test: check_open_error_test_...ok\r\n  ddoc_cache_open_test: check_open_error_test_...[0.012 s] ok\r\n  ddoc_cache_open_test: check_open_error_test_...[0.015 s] ok\r\n  ddoc_cache_open_test: check_open_error_test_...ok\r\n=======================================================\r\n  All 4 tests passed.\r\n```\r\nI know it requires more boiler plate to accomplish, but I much prefer to see the actual names of the tests being run with the couchdb_db_tests module. Just seeing 4 identical lines of `ddoc_cache_open_test: check_open_error_test_` isn't as useful, IMO.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/430047024/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/430141685","html_url":"https://github.com/apache/couchdb/issues/1653#issuecomment-430141685","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1653","id":430141685,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMDE0MTY4NQ==","user":{"login":"jasons316","id":44164832,"node_id":"MDQ6VXNlcjQ0MTY0ODMy","avatar_url":"https://avatars.githubusercontent.com/u/44164832?v=4","gravatar_id":"","url":"https://api.github.com/users/jasons316","html_url":"https://github.com/jasons316","followers_url":"https://api.github.com/users/jasons316/followers","following_url":"https://api.github.com/users/jasons316/following{/other_user}","gists_url":"https://api.github.com/users/jasons316/gists{/gist_id}","starred_url":"https://api.github.com/users/jasons316/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasons316/subscriptions","organizations_url":"https://api.github.com/users/jasons316/orgs","repos_url":"https://api.github.com/users/jasons316/repos","events_url":"https://api.github.com/users/jasons316/events{/privacy}","received_events_url":"https://api.github.com/users/jasons316/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-16T08:06:42Z","updated_at":"2018-10-16T08:06:42Z","author_association":"NONE","body":"We haven't run any metrics on request time as yet. We are purely going off load times for our front end website. We run an ecommerce site, and the product pages pull the product data directly from CouchDB. When indexing or data insertion is occurring, the pages load very slowly. When there are no active tasks in CouchDB, they load near instantly.\r\n\r\nThe problem is highlighted moreso when running a search on the site. Searches return multiple products, so pulling the data for these takes a long time when CouchDB is indexing.\r\n\r\nHappy to run some metrics if anyone can advise the best way to do this.\r\n\r\nThanks.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/430141685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/430142985","html_url":"https://github.com/apache/couchdb/pull/1655#issuecomment-430142985","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1655","id":430142985,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMDE0Mjk4NQ==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-16T08:11:09Z","updated_at":"2018-10-16T08:11:09Z","author_association":"MEMBER","body":"the simpler version is to use config:get_integer","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/430142985/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/430149024","html_url":"https://github.com/apache/couchdb/issues/1418#issuecomment-430149024","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1418","id":430149024,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMDE0OTAyNA==","user":{"login":"bravier","id":3956758,"node_id":"MDQ6VXNlcjM5NTY3NTg=","avatar_url":"https://avatars.githubusercontent.com/u/3956758?v=4","gravatar_id":"","url":"https://api.github.com/users/bravier","html_url":"https://github.com/bravier","followers_url":"https://api.github.com/users/bravier/followers","following_url":"https://api.github.com/users/bravier/following{/other_user}","gists_url":"https://api.github.com/users/bravier/gists{/gist_id}","starred_url":"https://api.github.com/users/bravier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bravier/subscriptions","organizations_url":"https://api.github.com/users/bravier/orgs","repos_url":"https://api.github.com/users/bravier/repos","events_url":"https://api.github.com/users/bravier/events{/privacy}","received_events_url":"https://api.github.com/users/bravier/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-16T08:30:22Z","updated_at":"2018-10-16T08:41:03Z","author_association":"NONE","body":"Hello,\r\n\r\nWe are facing a similar issue as the one described by @ondra-novak on the `_users` database.\r\n\r\n## Steps to reproduce\r\nLet `A` and `B` be 2 CouchDB servers.\r\n\r\n- Create the `_users` database _(if it does not exist yet)_\r\n  _Request_\r\n  ```shell\r\n  curl -X PUT http://$A:5984/_users\r\n  ```\r\n  _Response_\r\n  ```json\r\n  {\r\n    \"ok\": true\r\n  }\r\n  ```\r\n- Create a user document\r\n  _Request_\r\n  ```shell\r\n  curl -X PUT http://$A:5984/_users/org.couchdb.user:email@example.com -d '{\"name\": \"email@example.com\", \"type\": \"user\", \"roles\": [], \"password\": \"password\"}'\r\n  ```\r\n  _Response_\r\n  ```json\r\n  {\r\n    \"ok\": true,\r\n    \"id\": \"org.couchdb.user:email@example.com\",\r\n    \"rev\": \"1-19fa61446d76bcb9131a1b65c03b4c1c\"\r\n  }\r\n  ```\r\n- Replicate `_users` from `A` to `B`\r\n  _Request_\r\n  ```shell\r\n  curl -X POST http://$A:5984/_replicate \\\r\n   -d '{\"source\":\"http://$A:5984/_users\",\"target\":\"http://$B:5984/_users\",\"create_target\":true}' \\\r\n   -H \"Content-Type: application/json\"\r\n  ```\r\n  _Response_\r\n  ```json\r\n  {\r\n    \"ok\": true,\r\n    \"session_id\": \"...\",\r\n    \"...\"\r\n  }\r\n- Delete the user document from `A`\r\n  _Request_\r\n  ```shell\r\n  curl -X DELETE http://$A:5984/_users/org.couchdb.user:email@example.com?rev=1-19fa61446d76bcb9131a1b65c03b4c1c\r\n  ```\r\n  _Response_\r\n  ```json\r\n  {\r\n    \"ok\": true,\r\n    \"id\": \"org.couchdb.user:email@example.com\",\r\n    \"rev\": \"2-43b4189bc429587a529beba79a037cad\"\r\n  }\r\n  ```\r\n- Replicate `_users` from `A` to `B` once again\r\n  _Request_\r\n  ```shell\r\n  curl -X POST http://$A:5984/_replicate \\\r\n   -d '{\"source\":\"http://$A:5984/_users\",\"target\":\"http://$B:5984/_users\",\"create_target\":true}' \\\r\n   -H \"Content-Type: application/json\"\r\n  ```\r\n  _Response_\r\n  ```json\r\n  {\r\n    \"ok\": true,\r\n    \"session_id\": \"...\",\r\n    \"...\"\r\n  }\r\n- Re-create the same user document again on `A`\r\n  _Request_\r\n  ```shell\r\n  curl -X PUT http://$A:5984/_users/org.couchdb.user:email@example.com -d '{\"name\": \"email@example.com\", \"type\": \"user\", \"roles\": [], \"password\": \"password\"}'\r\n  ```\r\n  _Response_\r\n  ```json\r\n  {\r\n    \"ok\": true,\r\n    \"id\": \"org.couchdb.user:email@example.com\",\r\n    \"rev\": \"3-1a2c0e3876f314e08d80b1d236481a2d\"\r\n  }\r\n  ```\r\n- Replicate `_users` from `A` to `B`\r\n  _Request_\r\n  ```shell\r\n  curl -X POST http://$A:5984/_replicate \\\r\n   -d '{\"source\":\"http://$A:5984/_users\",\"target\":\"http://$B:5984/_users\",\"create_target\":true}' \\\r\n   -H \"Content-Type: application/json\"\r\n  ```\r\n  _Response_\r\n  ```json\r\n  {\r\n    \"ok\": true,\r\n    \"session_id\": \"...\",\r\n    \"...\"\r\n  }\r\n  ```\r\n  \r\n## Expected behavior\r\nThe user document might be replicated from `A` to `B` and the number of documents on `A/_users` and `B/_users` might be equal to 2 (`_design/_auth` document + our user).\r\n  \r\n## Current behavior\r\nThe document is not replicated and the number of documents on `A/_users` is equal to 2 but the number of documents on `B/_users` is equal to 1 (`_design/_auth` only).\r\n\r\n## Environment\r\n- Server `A`\r\n  - OS: Fedora 28\r\n  - CouchDB: 2.1.2\r\n- Server `B`\r\n  - OS: CentOS 7.5.1804\r\n  - CouchDB: 2.1.2\r\n\r\nThis issue is quite impacting for us as it silently breaks replication and can lead to data loss.\r\n\r\nThanks in advance for helping us on this bug.\r\n\r\nDo not hesitate to ask me for more infos if needed.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/430149024/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/430196425","html_url":"https://github.com/apache/couchdb/pull/1655#issuecomment-430196425","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1655","id":430196425,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMDE5NjQyNQ==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-10-16T11:07:59Z","updated_at":"2018-10-16T11:07:59Z","author_association":"CONTRIBUTOR","body":"@rnewson Updated to use config:get_integer","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/430196425/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]