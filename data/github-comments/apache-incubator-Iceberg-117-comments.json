[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940713820","html_url":"https://github.com/apache/iceberg/issues/3278#issuecomment-940713820","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3278","id":940713820,"node_id":"IC_kwDOCW7NX844Eidc","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T06:46:02Z","updated_at":"2021-10-12T06:46:02Z","author_association":"MEMBER","body":"Handled document update for 'UPDATE' SQL as well about subqueries.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940713820/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940755890","html_url":"https://github.com/apache/iceberg/pull/3279#issuecomment-940755890","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3279","id":940755890,"node_id":"IC_kwDOCW7NX844Esuy","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T07:51:05Z","updated_at":"2021-10-12T07:51:05Z","author_association":"MEMBER","body":"cc: @jackye1995 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940755890/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940816196","html_url":"https://github.com/apache/iceberg/pull/3099#issuecomment-940816196","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3099","id":940816196,"node_id":"IC_kwDOCW7NX844E7dE","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T09:06:59Z","updated_at":"2021-10-12T09:06:59Z","author_association":"CONTRIBUTOR","body":"@szehon-ho: This version is fine by me. Let's wait a little bit for the others to chime in, in case they have any more concerns. If there is no objections till next Monday, I will merge then, as I will be OOO at the end of this week. Please ping me if I forget to push.\r\n\r\nThanks, Peter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940816196/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940817717","html_url":"https://github.com/apache/iceberg/pull/3155#issuecomment-940817717","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3155","id":940817717,"node_id":"IC_kwDOCW7NX844E701","user":{"login":"szlta","id":40628386,"node_id":"MDQ6VXNlcjQwNjI4Mzg2","avatar_url":"https://avatars.githubusercontent.com/u/40628386?v=4","gravatar_id":"","url":"https://api.github.com/users/szlta","html_url":"https://github.com/szlta","followers_url":"https://api.github.com/users/szlta/followers","following_url":"https://api.github.com/users/szlta/following{/other_user}","gists_url":"https://api.github.com/users/szlta/gists{/gist_id}","starred_url":"https://api.github.com/users/szlta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szlta/subscriptions","organizations_url":"https://api.github.com/users/szlta/orgs","repos_url":"https://api.github.com/users/szlta/repos","events_url":"https://api.github.com/users/szlta/events{/privacy}","received_events_url":"https://api.github.com/users/szlta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T09:08:45Z","updated_at":"2021-10-12T09:08:45Z","author_association":"CONTRIBUTOR","body":"LGTM, @pvary can you please take a look too?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940817717/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940819990","html_url":"https://github.com/apache/iceberg/pull/3155#issuecomment-940819990","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3155","id":940819990,"node_id":"IC_kwDOCW7NX844E8YW","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T09:11:22Z","updated_at":"2021-10-12T09:11:22Z","author_association":"CONTRIBUTOR","body":"Renamed the PR title, and commit message to match the contents.\r\nThanks for the fix @omarsmak and @szlta for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940819990/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940834664","html_url":"https://github.com/apache/iceberg/pull/2841#issuecomment-940834664","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2841","id":940834664,"node_id":"IC_kwDOCW7NX844E_9o","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T09:29:33Z","updated_at":"2021-10-12T09:29:33Z","author_association":"COLLABORATOR","body":"@rdblue @jackye1995 Any other comment on this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940834664/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940883849","html_url":"https://github.com/apache/iceberg/pull/3258#issuecomment-940883849","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3258","id":940883849,"node_id":"IC_kwDOCW7NX844FL-J","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T10:35:23Z","updated_at":"2021-10-12T10:35:23Z","author_association":"CONTRIBUTOR","body":"@rdblue @stevenzwu I'm just thinking that the original intention of this validation is trying to prevent to commit the invalid manifests which contain not exists files location to iceberg table. I think the purpose of this validation needs to be confirmed with @openinx. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940883849/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940944552","html_url":"https://github.com/apache/iceberg/pull/3248#issuecomment-940944552","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3248","id":940944552,"node_id":"IC_kwDOCW7NX844Fayo","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T11:58:34Z","updated_at":"2021-10-12T11:58:34Z","author_association":"MEMBER","body":"Thanks @szlta for the contribution !  The PR almost looks good to me overall, just left several comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940944552/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940990282","html_url":"https://github.com/apache/iceberg/pull/3186#issuecomment-940990282","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3186","id":940990282,"node_id":"IC_kwDOCW7NX844Fl9K","user":{"login":"rice668","id":6520673,"node_id":"MDQ6VXNlcjY1MjA2NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6520673?v=4","gravatar_id":"","url":"https://api.github.com/users/rice668","html_url":"https://github.com/rice668","followers_url":"https://api.github.com/users/rice668/followers","following_url":"https://api.github.com/users/rice668/following{/other_user}","gists_url":"https://api.github.com/users/rice668/gists{/gist_id}","starred_url":"https://api.github.com/users/rice668/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rice668/subscriptions","organizations_url":"https://api.github.com/users/rice668/orgs","repos_url":"https://api.github.com/users/rice668/repos","events_url":"https://api.github.com/users/rice668/events{/privacy}","received_events_url":"https://api.github.com/users/rice668/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T13:00:46Z","updated_at":"2021-10-12T13:04:56Z","author_association":"CONTRIBUTOR","body":"I did an end to end test for this change. And spark sql can show the correct value. @rdblue @openinx  Any other comments ?\r\n\r\n```\r\nCREATE TABLE table13 (col struct<field:string>)\r\nUSING iceberg\r\nPARTITIONED BY (col.field)\r\nTBLPROPERTIES ('write.format.default'='orc')\r\n\r\ninsert into table13 select named_struct('col1','20211012');\r\n\r\nselect * from table13;\r\n```\r\n\r\n![image](https://user-images.githubusercontent.com/6520673/136961003-06a117d2-a3dc-4540-9c20-354808afd1ea.png)\r\n\r\n![image](https://user-images.githubusercontent.com/6520673/136960906-1a245b71-5a00-443a-aa9f-4bf55303b3bf.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/940990282/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941000106","html_url":"https://github.com/apache/iceberg/pull/3258#issuecomment-941000106","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3258","id":941000106,"node_id":"IC_kwDOCW7NX844FoWq","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T13:12:16Z","updated_at":"2021-10-12T13:12:38Z","author_association":"MEMBER","body":"Thanks all for pinging me ! Let's provide more original background for this [validation](https://github.com/apache/iceberg/blob/e20088449daec9ed431754044b520b3ac5fa3eaa/flink/src/main/java/org/apache/iceberg/flink/sink/IcebergFilesCommitter.java#L286):  it was added for validating the existence of data files that were referenced from the pos-delete files introduced in the current TXN which is planning to commit but have not committed yet.\r\n\r\nAfter I read the implementation of the `validateDataFilesExist` method,  I think I misunderstood the meaning of it before, because I thought it could validate the existence of data files that was planing to commit in the current TXN. While the real meaning is:  validate the existence of the data files after going through the history committed txn and ensuring that NO other OVERWRITE/REPLACE TXN has deleted the required data files. \r\n\r\nAbout the broken unit test [testValidateDataFileExist](https://github.com/apache/iceberg/blob/8104769f81ba79338fd3c94d5bd9267f22d31ed7/flink/src/test/java/org/apache/iceberg/flink/sink/TestIcebergFilesCommitter.java#L720) by this PR,  I think it is addressing the case that will never happen in the real CDC user case, because its steps are following: \r\n\r\n* Step.1 :  Start a txn.1 to insert a row `<1, 'aaa'>`, which produces a `data-file1`; \r\n* Step.2 : Start a txn.2 to replace the whole iceberg table with a newly produced row `<2, 'bbb'>`,  it will remove the old data file `data-file-1` and add a new data file `data-file2`;\r\n* Step.3 :  Start a txn.3 to commit a row delta txn , which includes a pos-delete to delete the old row `<1, 'aaa'>`.\r\n\r\nThe key point is:  in the real flink CDC user case,  we won't produce any pos-deletes in a new txn to delete a row coming from an older txn, we just produce pos-deletes to delete a row that comes from the same txn as the pos-delete ( as @rdblue said, `Because position deletes will only reference data files being added to the table, there is no possibility that those files are concurrently deleted` ).  In summary,  the unit test is trying to address a case that will never happen in the real user case,  so I would like to remove this unit test in this PR. \r\n\r\nThanks all for the patient work !\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941000106/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941003776","html_url":"https://github.com/apache/iceberg/pull/3250#issuecomment-941003776","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3250","id":941003776,"node_id":"IC_kwDOCW7NX844FpQA","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T13:16:26Z","updated_at":"2021-10-12T13:16:26Z","author_association":"MEMBER","body":"Thanks @pvary for the work,  I plan to check this again once we got the dependency PR #3248 merged !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941003776/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941021391","html_url":"https://github.com/apache/iceberg/pull/3162#issuecomment-941021391","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3162","id":941021391,"node_id":"IC_kwDOCW7NX844FtjP","user":{"login":"omarsmak","id":1190920,"node_id":"MDQ6VXNlcjExOTA5MjA=","avatar_url":"https://avatars.githubusercontent.com/u/1190920?v=4","gravatar_id":"","url":"https://api.github.com/users/omarsmak","html_url":"https://github.com/omarsmak","followers_url":"https://api.github.com/users/omarsmak/followers","following_url":"https://api.github.com/users/omarsmak/following{/other_user}","gists_url":"https://api.github.com/users/omarsmak/gists{/gist_id}","starred_url":"https://api.github.com/users/omarsmak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omarsmak/subscriptions","organizations_url":"https://api.github.com/users/omarsmak/orgs","repos_url":"https://api.github.com/users/omarsmak/repos","events_url":"https://api.github.com/users/omarsmak/events{/privacy}","received_events_url":"https://api.github.com/users/omarsmak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T13:37:34Z","updated_at":"2021-10-12T13:37:34Z","author_association":"MEMBER","body":"@rdblue CI now looks green.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941021391/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941086428","html_url":"https://github.com/apache/iceberg/pull/3162#issuecomment-941086428","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3162","id":941086428,"node_id":"IC_kwDOCW7NX844F9bc","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T14:51:21Z","updated_at":"2021-10-12T14:51:21Z","author_association":"CONTRIBUTOR","body":"Thanks, @omarsmak!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941086428/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941094431","html_url":"https://github.com/apache/iceberg/pull/3256#issuecomment-941094431","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3256","id":941094431,"node_id":"IC_kwDOCW7NX844F_Yf","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T15:00:03Z","updated_at":"2021-10-12T15:32:10Z","author_association":"CONTRIBUTOR","body":"> My original thought in #3237 was that we can define the rule that the shared code can continue to live, and any code that cannot build againt all versions should then be refactored to different version modules.\r\n\r\nI think that compiling against different versions of Spark is beginning to be a significant risk due to changes across versions. That's only going to get worse when we start adding flags for Scala version as well and continue to add more extensions that touch Spark internals. I don't think it's a good idea to try to refactor common classes out unless they don't have a compile dependency on Spark. And in that case, we can more them to core like the `Writer` classes.\r\n\r\n> . . . The intention is again to minimize duplicated code by minimizing the number of version folders.\r\n\r\nI think we're actually better off the other way. What we have now does some pretty crazy things to deal with multiple Spark versions and I think we'll end up with cleaner code if we just duplicate it. This is one of the reasons why I think we want these build changes.\r\n\r\n> In #3237 I had another scalaVersion system property to allow setting a flexible Scala version. Do you think that is something worth adding?\r\n\r\nYes, but as a follow-up. This is just a PR to put a basic structure in place and we will continue to improve it in future commits.\r\n\r\n> What would be the naming scheme for modules after v3.0?\r\n\r\nWe don't need to decide this now, since this doesn't introduce new modules yet. I'd like to focus on getting this in with minimal changes since it's already so large!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941094431/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941163858","html_url":"https://github.com/apache/iceberg/pull/3132#issuecomment-941163858","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3132","id":941163858,"node_id":"IC_kwDOCW7NX844GQVS","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T16:16:52Z","updated_at":"2021-10-12T16:16:52Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @RussellSpitzer @jackye1995 @rdblue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941163858/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941180930","html_url":"https://github.com/apache/iceberg/pull/3256#issuecomment-941180930","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3256","id":941180930,"node_id":"IC_kwDOCW7NX844GUgC","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T16:37:42Z","updated_at":"2021-10-12T16:37:42Z","author_association":"CONTRIBUTOR","body":"We should probably wait with merging any other Spark related PRs before this is in.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941180930/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941206246","html_url":"https://github.com/apache/iceberg/issues/3228#issuecomment-941206246","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3228","id":941206246,"node_id":"IC_kwDOCW7NX844Garm","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T17:10:36Z","updated_at":"2021-10-12T17:10:36Z","author_association":"CONTRIBUTOR","body":"@jun-he shall I work on this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941206246/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941215358","html_url":"https://github.com/apache/iceberg/pull/3256#issuecomment-941215358","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3256","id":941215358,"node_id":"IC_kwDOCW7NX844Gc5-","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T17:22:47Z","updated_at":"2021-10-12T17:22:47Z","author_association":"CONTRIBUTOR","body":"Yeah, looks like since we're moving files around this hits commit conflicts really quickly. We should try to get consensus around the file moves and structure as soon as possible and then get this in. That's partly why I wanted to make this first commit do as little as possible. We can add more refactoring later, but it's easiest to do this as multiple focused commits with only one big file move!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941215358/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941220294","html_url":"https://github.com/apache/iceberg/pull/3258#issuecomment-941220294","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3258","id":941220294,"node_id":"IC_kwDOCW7NX844GeHG","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T17:29:22Z","updated_at":"2021-10-12T17:29:22Z","author_association":"CONTRIBUTOR","body":"Thank you for the review, @openinx! I'll remove the unit test and fix up this PR so tests are passing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941220294/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941232976","html_url":"https://github.com/apache/iceberg/issues/3283#issuecomment-941232976","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3283","id":941232976,"node_id":"IC_kwDOCW7NX844GhNQ","user":{"login":"fjetter","id":8629629,"node_id":"MDQ6VXNlcjg2Mjk2Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/8629629?v=4","gravatar_id":"","url":"https://api.github.com/users/fjetter","html_url":"https://github.com/fjetter","followers_url":"https://api.github.com/users/fjetter/followers","following_url":"https://api.github.com/users/fjetter/following{/other_user}","gists_url":"https://api.github.com/users/fjetter/gists{/gist_id}","starred_url":"https://api.github.com/users/fjetter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjetter/subscriptions","organizations_url":"https://api.github.com/users/fjetter/orgs","repos_url":"https://api.github.com/users/fjetter/repos","events_url":"https://api.github.com/users/fjetter/events{/privacy}","received_events_url":"https://api.github.com/users/fjetter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T17:46:17Z","updated_at":"2021-10-12T17:46:17Z","author_association":"NONE","body":"I created a short jupyter notebook (download the notebook + `conda install dask jupyterlab pyarrow` and you're good to go) about how the dask API currently reads/writes a parquet dataset. The notebook generates random data and roundtrips to a parquet dataset.\r\nThe API is basically two module level functions `to_parquet` and `from_parquet` with a lot of arguments. Some of the arguments are for the query planning while others are for the compute engine, storage, etc. Behind the scenes we're disentangling things.\r\n\r\nAn easy iceberg integration could simply be to provide `iceberg` as an engine instead of `pyarrow` and add some more keywords like `snapshot_id`, etc. _Formally_ that's incorrect but it would be an easy way for us to patch things in :)\r\n\r\nThe `dask.DataFrame` object itself exposes high level aggregation and shaping methods but, for instance, you can also access individual files/splits/tasks (whatever your terminology is). There is also a `DaskDataframe.describe` method but that would currently actually load all data and calculate statistics. We do want to improve our API (also for simple stuff like `len`/ count) such that this accesses metadata instead of payload data but that's actually quite a bit of work and will still take a while.\r\n\r\nhttps://docs.dask.org/en/latest/generated/dask.dataframe.read_parquet.html#dask.dataframe.read_parquet\r\nhttps://docs.dask.org/en/latest/generated/dask.dataframe.to_parquet.html#dask.dataframe.to_parquet\r\n\r\nhttps://gist.github.com/fjetter/86d009f9365dbd4864aa13946f69b758","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941232976/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941239952","html_url":"https://github.com/apache/iceberg/pull/3284#issuecomment-941239952","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3284","id":941239952,"node_id":"IC_kwDOCW7NX844Gi6Q","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T17:55:14Z","updated_at":"2021-10-12T17:56:27Z","author_association":"CONTRIBUTOR","body":"This is in reference to https://github.com/apache/iceberg/pull/3273, but the base implementation also does this and thus we should likely add this to the spec.\r\n\r\n**Note** - Marking this as a draft as we might want to also call out that 0 indicates we should skip the file entirely (though that's perhaps overkill). Also, marking as draft as I'm open to formatting this differently.\r\n\r\ncc @RussellSpitzer @szehon-ho @aokolnychyi @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941239952/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941253107","html_url":"https://github.com/apache/iceberg/pull/3275#issuecomment-941253107","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3275","id":941253107,"node_id":"IC_kwDOCW7NX844GmHz","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T18:11:47Z","updated_at":"2021-10-12T18:11:47Z","author_association":"CONTRIBUTOR","body":"@jackye1995 . thanks for the review. Made the fixes based on the comments. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941253107/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941461364","html_url":"https://github.com/apache/iceberg/pull/3275#issuecomment-941461364","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3275","id":941461364,"node_id":"IC_kwDOCW7NX844HY90","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T20:22:35Z","updated_at":"2021-10-12T20:22:35Z","author_association":"CONTRIBUTOR","body":" Thanks @jackye1995. Addressed the comments except the metadata properties comment. Let me know if we need to have two separate given how the method signature has metadata.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941461364/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941471929","html_url":"https://github.com/apache/iceberg/pull/3231#issuecomment-941471929","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3231","id":941471929,"node_id":"IC_kwDOCW7NX844Hbi5","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T20:25:55Z","updated_at":"2021-10-12T20:25:55Z","author_association":"CONTRIBUTOR","body":"Did a comparison against my internal impl, mostly look correct to me. Will take another look after all the remaining methods are implemented.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941471929/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941477137","html_url":"https://github.com/apache/iceberg/pull/3099#issuecomment-941477137","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3099","id":941477137,"node_id":"IC_kwDOCW7NX844Hc0R","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T20:26:57Z","updated_at":"2021-10-12T20:26:57Z","author_association":"COLLABORATOR","body":"Thanks a lot Peter for following up.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941477137/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941599054","html_url":"https://github.com/apache/iceberg/issues/3238#issuecomment-941599054","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3238","id":941599054,"node_id":"IC_kwDOCW7NX844H6lO","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T21:31:38Z","updated_at":"2021-10-12T21:31:38Z","author_association":"COLLABORATOR","body":"Update the issue with python label and milestone.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941599054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941722011","html_url":"https://github.com/apache/iceberg/issues/3282#issuecomment-941722011","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3282","id":941722011,"node_id":"IC_kwDOCW7NX844IYmb","user":{"login":"cabhishek","id":146449,"node_id":"MDQ6VXNlcjE0NjQ0OQ==","avatar_url":"https://avatars.githubusercontent.com/u/146449?v=4","gravatar_id":"","url":"https://api.github.com/users/cabhishek","html_url":"https://github.com/cabhishek","followers_url":"https://api.github.com/users/cabhishek/followers","following_url":"https://api.github.com/users/cabhishek/following{/other_user}","gists_url":"https://api.github.com/users/cabhishek/gists{/gist_id}","starred_url":"https://api.github.com/users/cabhishek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cabhishek/subscriptions","organizations_url":"https://api.github.com/users/cabhishek/orgs","repos_url":"https://api.github.com/users/cabhishek/repos","events_url":"https://api.github.com/users/cabhishek/events{/privacy}","received_events_url":"https://api.github.com/users/cabhishek/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-12T23:03:15Z","updated_at":"2021-10-12T23:03:15Z","author_association":"CONTRIBUTOR","body":"@danielcweeks I'll look into setting this up","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941722011/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941826001","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-941826001","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":941826001,"node_id":"IC_kwDOCW7NX844Ix_R","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-13T01:31:37Z","updated_at":"2021-10-13T01:31:37Z","author_association":"CONTRIBUTOR","body":"I agree with @pvary that it would be better if Spark supported the same SQL syntax for time travel queries as Hive and Impala, especially if the syntax in question is the SQL standard. I understand the difficulty of getting the support into Spark itself. Is it not possible to implement the support using SQL extensions in Iceberg?\r\n\r\nOrthogonal to that, I think that metadata tables are conceptually different from snapshots, so while I think something like `<catalog>.<database>.<table>.history` or `<catalog>.<database>.<table>.snapshots` have a certain naturalness, `<catalog>.<database>.<table>.snapshot_id_<id>` is a different kind of beast than the metadata tables, and using the same syntax for the snapshots is lumping two different kinds of things into the same category. Pardon my ignorance, but does the code for table identifiers limit us to using `.` for delimiting the name? Is it possible to use `@` for time travel, as @pvary suggests? (I expect we'd need something like `@snapshot(<id>)` and `@time(<timestamp>)` to distinguish the two different ways of specifying time travel.)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941826001/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941856547","html_url":"https://github.com/apache/iceberg/pull/3287#issuecomment-941856547","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3287","id":941856547,"node_id":"IC_kwDOCW7NX844I5cj","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-13T02:26:48Z","updated_at":"2021-10-13T02:26:48Z","author_association":"COLLABORATOR","body":"Do we have some benchmark that could show the benefit? Since we will have actions to convert the equality deletes and rewrite the position delete, so just curious about the performance improvement.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941856547/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941858423","html_url":"https://github.com/apache/iceberg/pull/3287#issuecomment-941858423","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3287","id":941858423,"node_id":"IC_kwDOCW7NX844I553","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-13T02:31:44Z","updated_at":"2021-10-13T02:31:44Z","author_association":"CONTRIBUTOR","body":"> Do we have some benchmark that could show the benefit? Since we will have actions to convert the equality deletes and rewrite the position delete, so just curious about the performance improvement.\r\n\r\nWill add benchmark soon.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941858423/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941911100","html_url":"https://github.com/apache/iceberg/pull/3279#issuecomment-941911100","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3279","id":941911100,"node_id":"IC_kwDOCW7NX844JGw8","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-13T04:29:37Z","updated_at":"2021-10-13T04:29:37Z","author_association":"MEMBER","body":"@jackye1995 : Can you please have a look at it again? I have updated as per your suggestions. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941911100/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941962715","html_url":"https://github.com/apache/iceberg/pull/3249#issuecomment-941962715","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3249","id":941962715,"node_id":"IC_kwDOCW7NX844JTXb","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-13T06:25:00Z","updated_at":"2021-10-13T07:07:41Z","author_association":"CONTRIBUTOR","body":"Hi @rdblue, please take a look again, thanks a lot. Also update benchmark results:\r\n```\r\nBenchmark                                                                 Mode  Cnt  Score   Error  Units\r\nVectorizedReadFlatParquetDataBenchmark.readDatesIcebergVectorized5k         ss    5  1.320  0.045   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDatesSparkVectorized5k           ss    5  1.348  0.044   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDecimalsIcebergVectorized5k      ss    5  8.095  0.308   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDecimalsSparkVectorized5k        ss    5  8.013  0.412   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDoublesIcebergVectorized5k       ss    5  2.697  0.113   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDoublesSparkVectorized5k         ss    5  2.224  0.071   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readFloatsIcebergVectorized5k        ss    5  2.135  0.030   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readFloatsSparkVectorized5k          ss    5  2.233  0.765   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readIntegersIcebergVectorized5k      ss    5  2.223  0.043   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readIntegersSparkVectorized5k        ss    5  2.479  0.096   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readLongsIcebergVectorized5k         ss    5  2.640  0.041   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readLongsSparkVectorized5k           ss    5  2.498  0.116   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readStringsIcebergVectorized5k       ss    5  4.043  0.486   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readStringsSparkVectorized5k         ss    5  3.809  0.163   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readTimestampsIcebergVectorized5k    ss    5  1.504  0.298   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readTimestampsSparkVectorized5k      ss    5  1.856  0.295   s/op\r\n```\r\n\r\n```\r\nBenchmark                                                                        Mode  Cnt  Score   Error  Units\r\nVectorizedReadParquetDecimalBenchmark.readDecimalsIcebergVectorized5k              ss    5  7.822  0.441   s/op\r\nVectorizedReadParquetDecimalBenchmark.readDecimalsSparkVectorized5k                ss    5  7.916  0.908   s/op\r\nVectorizedReadParquetDecimalBenchmark.readIntBackedDecimalsIcebergVectorized5k     ss    5  1.655  0.130   s/op\r\nVectorizedReadParquetDecimalBenchmark.readIntBackedDecimalsSparkVectorized5k       ss    5  1.539  0.104   s/op\r\nVectorizedReadParquetDecimalBenchmark.readLongBackedDecimalsIcebergVectorized5k    ss    5  3.468  0.471   s/op\r\nVectorizedReadParquetDecimalBenchmark.readLongBackedDecimalsSparkVectorized5k      ss    5  3.256  0.587   s/op\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/941962715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942073978","html_url":"https://github.com/apache/iceberg/issues/3289#issuecomment-942073978","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3289","id":942073978,"node_id":"IC_kwDOCW7NX844Juh6","user":{"login":"harshm-dev","id":57615655,"node_id":"MDQ6VXNlcjU3NjE1NjU1","avatar_url":"https://avatars.githubusercontent.com/u/57615655?v=4","gravatar_id":"","url":"https://api.github.com/users/harshm-dev","html_url":"https://github.com/harshm-dev","followers_url":"https://api.github.com/users/harshm-dev/followers","following_url":"https://api.github.com/users/harshm-dev/following{/other_user}","gists_url":"https://api.github.com/users/harshm-dev/gists{/gist_id}","starred_url":"https://api.github.com/users/harshm-dev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/harshm-dev/subscriptions","organizations_url":"https://api.github.com/users/harshm-dev/orgs","repos_url":"https://api.github.com/users/harshm-dev/repos","events_url":"https://api.github.com/users/harshm-dev/events{/privacy}","received_events_url":"https://api.github.com/users/harshm-dev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-13T08:47:19Z","updated_at":"2021-10-13T08:47:19Z","author_association":"CONTRIBUTOR","body":"Please label it with \"nessie\".\r\nI'm willing to make the code change, so you may assign this to me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942073978/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942096294","html_url":"https://github.com/apache/iceberg/issues/3289#issuecomment-942096294","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3289","id":942096294,"node_id":"IC_kwDOCW7NX844Jz-m","user":{"login":"omarsmak","id":1190920,"node_id":"MDQ6VXNlcjExOTA5MjA=","avatar_url":"https://avatars.githubusercontent.com/u/1190920?v=4","gravatar_id":"","url":"https://api.github.com/users/omarsmak","html_url":"https://github.com/omarsmak","followers_url":"https://api.github.com/users/omarsmak/followers","following_url":"https://api.github.com/users/omarsmak/following{/other_user}","gists_url":"https://api.github.com/users/omarsmak/gists{/gist_id}","starred_url":"https://api.github.com/users/omarsmak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omarsmak/subscriptions","organizations_url":"https://api.github.com/users/omarsmak/orgs","repos_url":"https://api.github.com/users/omarsmak/repos","events_url":"https://api.github.com/users/omarsmak/events{/privacy}","received_events_url":"https://api.github.com/users/omarsmak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-13T09:13:24Z","updated_at":"2021-10-13T09:13:24Z","author_association":"MEMBER","body":"@harshm-dev I don't think makes sense, if we add a `nessie` type, then we will need to add a type for every custom catalog exists in iceberg (e.g: `GlueCatalog`).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942096294/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942099440","html_url":"https://github.com/apache/iceberg/issues/3289#issuecomment-942099440","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3289","id":942099440,"node_id":"IC_kwDOCW7NX844J0vw","user":{"login":"harshm-dev","id":57615655,"node_id":"MDQ6VXNlcjU3NjE1NjU1","avatar_url":"https://avatars.githubusercontent.com/u/57615655?v=4","gravatar_id":"","url":"https://api.github.com/users/harshm-dev","html_url":"https://github.com/harshm-dev","followers_url":"https://api.github.com/users/harshm-dev/followers","following_url":"https://api.github.com/users/harshm-dev/following{/other_user}","gists_url":"https://api.github.com/users/harshm-dev/gists{/gist_id}","starred_url":"https://api.github.com/users/harshm-dev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/harshm-dev/subscriptions","organizations_url":"https://api.github.com/users/harshm-dev/orgs","repos_url":"https://api.github.com/users/harshm-dev/repos","events_url":"https://api.github.com/users/harshm-dev/events{/privacy}","received_events_url":"https://api.github.com/users/harshm-dev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-13T09:17:10Z","updated_at":"2021-10-13T09:17:10Z","author_association":"CONTRIBUTOR","body":"In my view, the types that can be supported from within iceberg project may not be considered `custom`. \r\n\r\nNessieCatalog implementation is already part of the iceberg code, so why not expose it as a known type?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942099440/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942106736","html_url":"https://github.com/apache/iceberg/issues/3289#issuecomment-942106736","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3289","id":942106736,"node_id":"IC_kwDOCW7NX844J2hw","user":{"login":"omarsmak","id":1190920,"node_id":"MDQ6VXNlcjExOTA5MjA=","avatar_url":"https://avatars.githubusercontent.com/u/1190920?v=4","gravatar_id":"","url":"https://api.github.com/users/omarsmak","html_url":"https://github.com/omarsmak","followers_url":"https://api.github.com/users/omarsmak/followers","following_url":"https://api.github.com/users/omarsmak/following{/other_user}","gists_url":"https://api.github.com/users/omarsmak/gists{/gist_id}","starred_url":"https://api.github.com/users/omarsmak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omarsmak/subscriptions","organizations_url":"https://api.github.com/users/omarsmak/orgs","repos_url":"https://api.github.com/users/omarsmak/repos","events_url":"https://api.github.com/users/omarsmak/events{/privacy}","received_events_url":"https://api.github.com/users/omarsmak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-13T09:26:10Z","updated_at":"2021-10-13T09:26:37Z","author_association":"MEMBER","body":"Totally valid point and I do agree with you about this. However, `hive` and `hadoop` catalogs are deeply integrated in iceberg core and thus, introducing the type was necessary (also for some core functionalities to distinguish between both). \r\nIf we opt to introduce types for custom catalogs, IMHO this shouldn't be only for `nessie` but should be for every custom catalog lives in iceberg codebase. \r\n@rdblue any thoughts on this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942106736/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942426046","html_url":"https://github.com/apache/iceberg/pull/3274#issuecomment-942426046","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3274","id":942426046,"node_id":"IC_kwDOCW7NX844LEe-","user":{"login":"chengarlic","id":83967270,"node_id":"MDQ6VXNlcjgzOTY3Mjcw","avatar_url":"https://avatars.githubusercontent.com/u/83967270?v=4","gravatar_id":"","url":"https://api.github.com/users/chengarlic","html_url":"https://github.com/chengarlic","followers_url":"https://api.github.com/users/chengarlic/followers","following_url":"https://api.github.com/users/chengarlic/following{/other_user}","gists_url":"https://api.github.com/users/chengarlic/gists{/gist_id}","starred_url":"https://api.github.com/users/chengarlic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chengarlic/subscriptions","organizations_url":"https://api.github.com/users/chengarlic/orgs","repos_url":"https://api.github.com/users/chengarlic/repos","events_url":"https://api.github.com/users/chengarlic/events{/privacy}","received_events_url":"https://api.github.com/users/chengarlic/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-13T15:34:17Z","updated_at":"2021-10-13T15:34:17Z","author_association":"NONE","body":"@nssalian Thanks for submitting this change. @miR172 from our team has also started working on refactoring our code #3177 to apply on top of existing JdbcImpl  based on the comments on that draft PR. It would be great if we can coordinate and split the work effectively. I would like to avoid duplicate work and waste of engineering efforts. Is it ok for us to send you a meeting so we can sync up on each end?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942426046/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942435075","html_url":"https://github.com/apache/iceberg/pull/3274#issuecomment-942435075","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3274","id":942435075,"node_id":"IC_kwDOCW7NX844LGsD","user":{"login":"miR172","id":5323771,"node_id":"MDQ6VXNlcjUzMjM3NzE=","avatar_url":"https://avatars.githubusercontent.com/u/5323771?v=4","gravatar_id":"","url":"https://api.github.com/users/miR172","html_url":"https://github.com/miR172","followers_url":"https://api.github.com/users/miR172/followers","following_url":"https://api.github.com/users/miR172/following{/other_user}","gists_url":"https://api.github.com/users/miR172/gists{/gist_id}","starred_url":"https://api.github.com/users/miR172/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/miR172/subscriptions","organizations_url":"https://api.github.com/users/miR172/orgs","repos_url":"https://api.github.com/users/miR172/repos","events_url":"https://api.github.com/users/miR172/events{/privacy}","received_events_url":"https://api.github.com/users/miR172/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-13T15:43:36Z","updated_at":"2021-10-13T15:43:36Z","author_association":"NONE","body":"@chengarlic I got connected with @nssalian on Slack. We will discuss how to split the work. Thank you!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942435075/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942440481","html_url":"https://github.com/apache/iceberg/pull/3274#issuecomment-942440481","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3274","id":942440481,"node_id":"IC_kwDOCW7NX844LIAh","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-13T15:49:22Z","updated_at":"2021-10-13T15:49:22Z","author_association":"CONTRIBUTOR","body":"Thanks @miR172 and @chengarlic . Yeah, there will be a few items to cover to get this rolled out. Listed out a few in the earlier comment. If the namespace table PR gets committed, we can proceed with the subsequent ones and split the work.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942440481/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942606395","html_url":"https://github.com/apache/iceberg/pull/3177#issuecomment-942606395","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3177","id":942606395,"node_id":"IC_kwDOCW7NX844Lwg7","user":{"login":"miR172","id":5323771,"node_id":"MDQ6VXNlcjUzMjM3NzE=","avatar_url":"https://avatars.githubusercontent.com/u/5323771?v=4","gravatar_id":"","url":"https://api.github.com/users/miR172","html_url":"https://github.com/miR172","followers_url":"https://api.github.com/users/miR172/followers","following_url":"https://api.github.com/users/miR172/following{/other_user}","gists_url":"https://api.github.com/users/miR172/gists{/gist_id}","starred_url":"https://api.github.com/users/miR172/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/miR172/subscriptions","organizations_url":"https://api.github.com/users/miR172/orgs","repos_url":"https://api.github.com/users/miR172/repos","events_url":"https://api.github.com/users/miR172/events{/privacy}","received_events_url":"https://api.github.com/users/miR172/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-13T18:38:43Z","updated_at":"2021-10-13T18:50:26Z","author_association":"NONE","body":"@nssalian is working on splitting sql tables #3275.\r\nFollowed that change I would address the following based on the code here:\r\n\r\n1. Create an interface for JdbcCatalog to use a database. This allows implementations to use different SQL dialects and advanced jdbc-driver wrapper (like Jooq, or Spanner). \r\n2. The existing plain text queries will be packed into a default impl because it requires no extra dependency. \r\n\r\nI've created #3291 \r\n@jackye1995 @rdblue  Please comment. If this sounds reasonable I'll open this PR (make it non-draft) with another code change. All jooq and S3 code will be removed out.\r\n\r\nAfter that, we can work on splitting work #3274 for the default impl.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942606395/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942606758","html_url":"https://github.com/apache/iceberg/pull/3284#issuecomment-942606758","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3284","id":942606758,"node_id":"IC_kwDOCW7NX844Lwmm","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-13T18:39:14Z","updated_at":"2021-10-13T18:39:14Z","author_association":"CONTRIBUTOR","body":"> Looks good to me, only style thing is I am not sure if we need the example here as it gets a bit wordy (and might be a bit too specific to a spark-operation, for a generic spec)\r\n\r\nI thought that too. One thing that exists is number marks that drop to a sentence with further detail, where necessary. Like `[1]`.\r\n\r\nHere's an example: https://github.com/apache/iceberg/blob/86350db9507d6b0d19643beae25de0a758b6d3cb/site/docs/spec.md#L397-L403\r\n\r\nHowever, I agree this one reads very particular to this case.\r\n\r\nMy desire was to indicate that `-1` shouldn't be common, under normal situations. Though I'm not sure how true that is or if it matters.\r\n\r\nWill update to be more generic for now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942606758/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942612084","html_url":"https://github.com/apache/iceberg/pull/3177#issuecomment-942612084","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3177","id":942612084,"node_id":"IC_kwDOCW7NX844Lx50","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-13T18:45:41Z","updated_at":"2021-10-13T18:45:41Z","author_association":"CONTRIBUTOR","body":"Nit in your comment: @miR172 the PR for the sql table is https://github.com/apache/iceberg/pull/3275. \r\nhttps://github.com/apache/iceberg/pull/3274 is all the changes we need but need to be split.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942612084/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942618976","html_url":"https://github.com/apache/iceberg/issues/3285#issuecomment-942618976","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3285","id":942618976,"node_id":"IC_kwDOCW7NX844Lzlg","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-13T18:54:42Z","updated_at":"2021-10-13T18:54:42Z","author_association":"CONTRIBUTOR","body":"Can I work on this @jackye1995 ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942618976/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942794969","html_url":"https://github.com/apache/iceberg/issues/2962#issuecomment-942794969","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2962","id":942794969,"node_id":"IC_kwDOCW7NX844MejZ","user":{"login":"edgarRd","id":266670,"node_id":"MDQ6VXNlcjI2NjY3MA==","avatar_url":"https://avatars.githubusercontent.com/u/266670?v=4","gravatar_id":"","url":"https://api.github.com/users/edgarRd","html_url":"https://github.com/edgarRd","followers_url":"https://api.github.com/users/edgarRd/followers","following_url":"https://api.github.com/users/edgarRd/following{/other_user}","gists_url":"https://api.github.com/users/edgarRd/gists{/gist_id}","starred_url":"https://api.github.com/users/edgarRd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edgarRd/subscriptions","organizations_url":"https://api.github.com/users/edgarRd/orgs","repos_url":"https://api.github.com/users/edgarRd/repos","events_url":"https://api.github.com/users/edgarRd/events{/privacy}","received_events_url":"https://api.github.com/users/edgarRd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-13T23:27:26Z","updated_at":"2021-10-13T23:27:26Z","author_association":"CONTRIBUTOR","body":"We're having this issue too, specifically when trying to read imported/migrated tables in parquet to Iceberg. I also can confirm that downgrading the version of Parquet from 1.12.0 back to 1.11.0 while still on Iceberg 0.12.0 works as a workaround.\r\n\r\nWhat's the recommended path forward for this?\r\n\r\nThanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942794969/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942881540","html_url":"https://github.com/apache/iceberg/pull/3250#issuecomment-942881540","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3250","id":942881540,"node_id":"IC_kwDOCW7NX844MzsE","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-14T02:08:42Z","updated_at":"2021-10-14T02:08:42Z","author_association":"MEMBER","body":"@pvary we've just got the https://github.com/apache/iceberg/pull/3248 merged now, I think it's time to rebase this PR and take another round review now, thanks !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942881540/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942919077","html_url":"https://github.com/apache/iceberg/pull/3292#issuecomment-942919077","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3292","id":942919077,"node_id":"IC_kwDOCW7NX844M82l","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-14T03:44:57Z","updated_at":"2021-10-14T03:44:57Z","author_association":"MEMBER","body":"@jackye1995 + @rdblue - If you would like to take a look","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/942919077/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943008781","html_url":"https://github.com/apache/iceberg/pull/3288#issuecomment-943008781","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3288","id":943008781,"node_id":"IC_kwDOCW7NX844NSwN","user":{"login":"xingbowu","id":12458911,"node_id":"MDQ6VXNlcjEyNDU4OTEx","avatar_url":"https://avatars.githubusercontent.com/u/12458911?v=4","gravatar_id":"","url":"https://api.github.com/users/xingbowu","html_url":"https://github.com/xingbowu","followers_url":"https://api.github.com/users/xingbowu/followers","following_url":"https://api.github.com/users/xingbowu/following{/other_user}","gists_url":"https://api.github.com/users/xingbowu/gists{/gist_id}","starred_url":"https://api.github.com/users/xingbowu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xingbowu/subscriptions","organizations_url":"https://api.github.com/users/xingbowu/orgs","repos_url":"https://api.github.com/users/xingbowu/repos","events_url":"https://api.github.com/users/xingbowu/events{/privacy}","received_events_url":"https://api.github.com/users/xingbowu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-14T06:27:40Z","updated_at":"2021-10-14T06:27:40Z","author_association":"CONTRIBUTOR","body":"Thanks @openinx for taking time on it, addressed above comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943008781/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943101432","html_url":"https://github.com/apache/iceberg/pull/3279#issuecomment-943101432","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3279","id":943101432,"node_id":"IC_kwDOCW7NX844NpX4","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-14T07:47:54Z","updated_at":"2021-10-14T07:47:54Z","author_association":"MEMBER","body":"cc: @openinx , @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943101432/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943140733","html_url":"https://github.com/apache/iceberg/issues/3289#issuecomment-943140733","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3289","id":943140733,"node_id":"IC_kwDOCW7NX844Ny99","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-14T08:38:21Z","updated_at":"2021-10-14T08:38:21Z","author_association":"CONTRIBUTOR","body":"I agree with @omarsmak's comment here. Using `spark.sql.catalog.catalog-name.catalog-impl` achieves the same thing and gives more flexibility for new catalogs. The docs even state that when `spark.sql.catalog.catalog-name.catalog-impl` is set, then `type` is ignored.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943140733/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943176314","html_url":"https://github.com/apache/iceberg/pull/3257#issuecomment-943176314","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3257","id":943176314,"node_id":"IC_kwDOCW7NX844N7p6","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-14T09:22:44Z","updated_at":"2021-10-14T09:22:44Z","author_association":"MEMBER","body":"@rdblue Sorry for the late reply. Yes, this one changes the relationship between Nessie and Iceberg metadata.\r\n\r\nTL;DR the changes shall ensure that changes against the same table on different branches can later be merged together without having duplicate column-IDs or partition-IDs or the like.\r\n\r\nYou're right, initially (in the \"early Nessie days\"), every Nessie commit held a pointer to the table-metadata. This works fine until you reference the same table on different branches and perform e.g. schema changes (think: ALTER TABLE ADD COLUMN) on both branches, which leads to duplicate column-ids (in other words: same column id used for different columns), which then can lead to data corruption when branches get merged.\r\n\r\nSo the initial approach in this PR was to maintain table-metadata across all branches and \"just\" reference the snapshot-ID from in Nessie commits, which led to other issues (not explaining it here further, but schema changes became an issue again).\r\n\r\nThe current approach is more like the initial approach: have the pointer to table-metadata in Nessie commits but track state that's important across all Nessie branches (e.g. last-column-ID) globally. It's currently implemented via additional functionality in TableMetadata to retrieve the \"global state\" (last-column-ID, last-used-partition-ID, last-assigned-sequence-ID) as an object that's opaque to Nessie plus functionality to update a TableMetadata using that \"global state\".\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943176314/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943268321","html_url":"https://github.com/apache/iceberg/issues/3115#issuecomment-943268321","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3115","id":943268321,"node_id":"IC_kwDOCW7NX844OSHh","user":{"login":"henry-on-the-internet","id":73651440,"node_id":"MDQ6VXNlcjczNjUxNDQw","avatar_url":"https://avatars.githubusercontent.com/u/73651440?v=4","gravatar_id":"","url":"https://api.github.com/users/henry-on-the-internet","html_url":"https://github.com/henry-on-the-internet","followers_url":"https://api.github.com/users/henry-on-the-internet/followers","following_url":"https://api.github.com/users/henry-on-the-internet/following{/other_user}","gists_url":"https://api.github.com/users/henry-on-the-internet/gists{/gist_id}","starred_url":"https://api.github.com/users/henry-on-the-internet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henry-on-the-internet/subscriptions","organizations_url":"https://api.github.com/users/henry-on-the-internet/orgs","repos_url":"https://api.github.com/users/henry-on-the-internet/repos","events_url":"https://api.github.com/users/henry-on-the-internet/events{/privacy}","received_events_url":"https://api.github.com/users/henry-on-the-internet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-14T11:28:48Z","updated_at":"2021-10-14T11:28:48Z","author_association":"NONE","body":"Is it assigned?\r\nIf not, may I try this one?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943268321/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943344282","html_url":"https://github.com/apache/iceberg/pull/3250#issuecomment-943344282","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3250","id":943344282,"node_id":"IC_kwDOCW7NX844Okqa","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-14T13:14:08Z","updated_at":"2021-10-14T13:14:08Z","author_association":"CONTRIBUTOR","body":"@openinx: Rebased, and rerun the flaky test (TestFlinkTableSink#testReplacePartitions). Now we have a clean run.\r\nCould you please review?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943344282/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943524788","html_url":"https://github.com/apache/iceberg/issues/2384#issuecomment-943524788","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2384","id":943524788,"node_id":"IC_kwDOCW7NX844PQu0","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-14T16:33:29Z","updated_at":"2021-10-14T16:33:29Z","author_association":"CONTRIBUTOR","body":"Seems to fail more frequent on recent CI runs","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943524788/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943534064","html_url":"https://github.com/apache/iceberg/pull/3248#issuecomment-943534064","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3248","id":943534064,"node_id":"IC_kwDOCW7NX844PS_w","user":{"login":"szlta","id":40628386,"node_id":"MDQ6VXNlcjQwNjI4Mzg2","avatar_url":"https://avatars.githubusercontent.com/u/40628386?v=4","gravatar_id":"","url":"https://api.github.com/users/szlta","html_url":"https://github.com/szlta","followers_url":"https://api.github.com/users/szlta/followers","following_url":"https://api.github.com/users/szlta/following{/other_user}","gists_url":"https://api.github.com/users/szlta/gists{/gist_id}","starred_url":"https://api.github.com/users/szlta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szlta/subscriptions","organizations_url":"https://api.github.com/users/szlta/orgs","repos_url":"https://api.github.com/users/szlta/repos","events_url":"https://api.github.com/users/szlta/events{/privacy}","received_events_url":"https://api.github.com/users/szlta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-14T16:45:26Z","updated_at":"2021-10-14T16:45:26Z","author_association":"CONTRIBUTOR","body":"Thanks for the thorough review @openinx!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943534064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943594243","html_url":"https://github.com/apache/iceberg/issues/3289#issuecomment-943594243","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3289","id":943594243,"node_id":"IC_kwDOCW7NX844PhsD","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-14T18:03:35Z","updated_at":"2021-10-14T18:03:35Z","author_association":"CONTRIBUTOR","body":"I agree that if we add types then we will probably need to do it for other catalogs as well. I don't really see a downside there. It would probably make sense to add `glue` and other types as we build them. The question for me is maintainability over time, but I think that should be okay and isn't something I worry about too much.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943594243/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943612753","html_url":"https://github.com/apache/iceberg/pull/3284#issuecomment-943612753","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3284","id":943612753,"node_id":"IC_kwDOCW7NX844PmNR","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-14T18:28:44Z","updated_at":"2021-10-14T18:28:44Z","author_association":"CONTRIBUTOR","body":"@rdblue are you ok with this minor update to the spec? It reflects current behavior, even in the base classes (mentioned above).\r\n\r\nI had considered adding a footnote that this is a rare occurrence (i.e. it shouldn't be common or something people expect during normal operations), but seemed possibly too much information for the spec.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943612753/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943775244","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-943775244","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":943775244,"node_id":"IC_kwDOCW7NX844QN4M","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-14T22:10:02Z","updated_at":"2021-10-14T22:10:02Z","author_association":"CONTRIBUTOR","body":"@huaxingao was kind enough to look into supporting the AS OF syntax in Spark.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943775244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943839398","html_url":"https://github.com/apache/iceberg/pull/3287#issuecomment-943839398","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3287","id":943839398,"node_id":"IC_kwDOCW7NX844Qdim","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-14T23:32:58Z","updated_at":"2021-10-14T23:32:58Z","author_association":"CONTRIBUTOR","body":"Thank you, @flyrain! Let me start looking today.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943839398/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943845848","html_url":"https://github.com/apache/iceberg/issues/3254#issuecomment-943845848","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3254","id":943845848,"node_id":"IC_kwDOCW7NX844QfHY","user":{"login":"karuppayya","id":5082742,"node_id":"MDQ6VXNlcjUwODI3NDI=","avatar_url":"https://avatars.githubusercontent.com/u/5082742?v=4","gravatar_id":"","url":"https://api.github.com/users/karuppayya","html_url":"https://github.com/karuppayya","followers_url":"https://api.github.com/users/karuppayya/followers","following_url":"https://api.github.com/users/karuppayya/following{/other_user}","gists_url":"https://api.github.com/users/karuppayya/gists{/gist_id}","starred_url":"https://api.github.com/users/karuppayya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karuppayya/subscriptions","organizations_url":"https://api.github.com/users/karuppayya/orgs","repos_url":"https://api.github.com/users/karuppayya/repos","events_url":"https://api.github.com/users/karuppayya/events{/privacy}","received_events_url":"https://api.github.com/users/karuppayya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-14T23:51:23Z","updated_at":"2021-10-14T23:51:23Z","author_association":"CONTRIBUTOR","body":"@snazy\r\nInternally, we use `ServiceLoader` approach to add new procedures. If adding procedures is a common use case, I can create a PR for this change.\r\n\r\ncc: @aokolnychyi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943845848/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943915695","html_url":"https://github.com/apache/iceberg/issues/3115#issuecomment-943915695","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3115","id":943915695,"node_id":"IC_kwDOCW7NX844QwKv","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T01:48:06Z","updated_at":"2021-10-15T01:48:06Z","author_association":"MEMBER","body":"Of course, just assigned to you @narrator0120 !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/943915695/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944006889","html_url":"https://github.com/apache/iceberg/pull/3287#issuecomment-944006889","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3287","id":944006889,"node_id":"IC_kwDOCW7NX844RGbp","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T05:08:06Z","updated_at":"2021-10-15T05:24:56Z","author_association":"CONTRIBUTOR","body":"Not related to this PR but a quick question. Why do we do an extra call to read the footer again while computing the offset to start position map in `ReadConf`? Why can't we simply reuse the row groups info we already read earlier?\r\n\r\nAny ideas, @chenjunjiedada @flyrain?\r\n\r\nEdit:\r\n\r\nWhy do we even need that map? It seems we only use it fill out the array of start row positions?\r\nCan't we just fill `startRowPositions` in `ReadConf` directly?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944006889/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944017316","html_url":"https://github.com/apache/iceberg/pull/3287#issuecomment-944017316","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3287","id":944017316,"node_id":"IC_kwDOCW7NX844RI-k","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T05:38:11Z","updated_at":"2021-10-15T05:38:11Z","author_association":"CONTRIBUTOR","body":"Okay, I went through the vectorized reader path to refresh my memory. I'll take a look at the PR itself with fresh eyes tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944017316/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944106217","html_url":"https://github.com/apache/iceberg/pull/3287#issuecomment-944106217","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3287","id":944106217,"node_id":"IC_kwDOCW7NX844Rerp","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T08:31:05Z","updated_at":"2021-10-15T08:31:05Z","author_association":"COLLABORATOR","body":"> Not related to this PR but a quick question. Why do we do an extra call to read the footer again while computing the offset to start position map in `ReadConf`? Why can't we simply reuse the row groups info we already read earlier?\r\n> \r\n> Any ideas, @chenjunjiedada @flyrain?\r\n> \r\n> Edit:\r\n> \r\n> Why do we even need that map? It seems we only use it fill out the array of start row positions? Can't we just fill `startRowPositions` in `ReadConf` directly?\r\n\r\n`new Reader(files, options)` may filter out some row groups, so we need to use full row groups info.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944106217/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944110130","html_url":"https://github.com/apache/iceberg/issues/3254#issuecomment-944110130","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3254","id":944110130,"node_id":"IC_kwDOCW7NX844Rfoy","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T08:37:06Z","updated_at":"2021-10-15T08:37:06Z","author_association":"MEMBER","body":"@karuppayya @aokolnychyi that would be awesome!\r\n\r\nOur use case is to add some procedures that apply only to the `NessieCatalog`. So we would need the `config` passed to `getProcedureBuilders()` and only provide (return) the Nessie specific procedures, if the catalog is a NessieCatalog.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944110130/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944199331","html_url":"https://github.com/apache/iceberg/pull/3250#issuecomment-944199331","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3250","id":944199331,"node_id":"IC_kwDOCW7NX844R1aj","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T10:44:52Z","updated_at":"2021-10-15T10:44:52Z","author_association":"CONTRIBUTOR","body":"> Thanks for the update, @pvary ! I left several comments which I think we need to address.\r\n\r\nThanks for the review @openinx!\r\nAddressed your comments. I am not sure I understand your suggestions correctly in one case. Could you please check that out?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944199331/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944350741","html_url":"https://github.com/apache/iceberg/issues/2040#issuecomment-944350741","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2040","id":944350741,"node_id":"IC_kwDOCW7NX844SaYV","user":{"login":"kirandk","id":22387059,"node_id":"MDQ6VXNlcjIyMzg3MDU5","avatar_url":"https://avatars.githubusercontent.com/u/22387059?v=4","gravatar_id":"","url":"https://api.github.com/users/kirandk","html_url":"https://github.com/kirandk","followers_url":"https://api.github.com/users/kirandk/followers","following_url":"https://api.github.com/users/kirandk/following{/other_user}","gists_url":"https://api.github.com/users/kirandk/gists{/gist_id}","starred_url":"https://api.github.com/users/kirandk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kirandk/subscriptions","organizations_url":"https://api.github.com/users/kirandk/orgs","repos_url":"https://api.github.com/users/kirandk/repos","events_url":"https://api.github.com/users/kirandk/events{/privacy}","received_events_url":"https://api.github.com/users/kirandk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T14:33:17Z","updated_at":"2021-10-15T14:33:17Z","author_association":"NONE","body":"I have the issue even in Spark 3.2.0 (same code as in posted in original https://gist.github.com/mehtaashish23/7fccdd8df620cf9fe34dd146441126a9)\r\n\r\nAny workaround/alternate?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944350741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944369231","html_url":"https://github.com/apache/iceberg/issues/3295#issuecomment-944369231","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3295","id":944369231,"node_id":"IC_kwDOCW7NX844Se5P","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T14:58:05Z","updated_at":"2021-10-15T14:58:05Z","author_association":"MEMBER","body":"Short answer, yes. An Iceberg table created correctly, can be read by any framework (spark, flink, presto/trino ....).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944369231/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944370786","html_url":"https://github.com/apache/iceberg/issues/3290#issuecomment-944370786","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3290","id":944370786,"node_id":"IC_kwDOCW7NX844SfRi","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T14:59:49Z","updated_at":"2021-10-15T14:59:49Z","author_association":"MEMBER","body":"This is not possible as Iceberg only operates through Snapshots ie, it always makes changes by adding a new snapshot. You could expire snapshots after every write which would effectively disable time travel but this would be manual. \r\n\r\nMaybe someone else has a better idea ...","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944370786/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944371639","html_url":"https://github.com/apache/iceberg/issues/2040#issuecomment-944371639","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2040","id":944371639,"node_id":"IC_kwDOCW7NX844Sfe3","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T15:00:51Z","updated_at":"2021-10-15T15:00:51Z","author_association":"CONTRIBUTOR","body":"The work-around for this is to write the expected columns into the table. I think it's reasonable for Spark to require that a data frame has the expected number of columns.\r\n\r\nCan you be more specific about what behavior changed? It looks like the same behavior in 3.0 and 3.2. I would expect a difference between 3.x and 2.x because Spark didn't do any validation in 2.x.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944371639/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944398727","html_url":"https://github.com/apache/iceberg/pull/1508#issuecomment-944398727","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1508","id":944398727,"node_id":"IC_kwDOCW7NX844SmGH","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T15:36:20Z","updated_at":"2021-10-15T15:36:20Z","author_association":"CONTRIBUTOR","body":"@wypoon, since #3269 is under discussion and it may take a while for us to decide how to pass the information for Spark 3, how about removing those portions here and getting the rest of this commit in?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944398727/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944406748","html_url":"https://github.com/apache/iceberg/pull/3287#issuecomment-944406748","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3287","id":944406748,"node_id":"IC_kwDOCW7NX844SoDc","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T15:47:34Z","updated_at":"2021-10-15T15:47:34Z","author_association":"CONTRIBUTOR","body":"Okay, I see we are using empty options in that call. I assume it is because of the range metadata filter we are setting.\r\nThanks for confirming, @chenjunjiedada!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944406748/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944435262","html_url":"https://github.com/apache/iceberg/pull/3252#issuecomment-944435262","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3252","id":944435262,"node_id":"IC_kwDOCW7NX844SvA-","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T16:28:54Z","updated_at":"2021-10-15T16:28:54Z","author_association":"CONTRIBUTOR","body":"Looks good! I'll merge when tests are passing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944435262/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944439811","html_url":"https://github.com/apache/iceberg/pull/3275#issuecomment-944439811","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3275","id":944439811,"node_id":"IC_kwDOCW7NX844SwID","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T16:35:57Z","updated_at":"2021-10-15T16:35:57Z","author_association":"CONTRIBUTOR","body":"@jackye1995 @rdblue , please have a look when you get a chance. Let me know if I can add/augment anything in the PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944439811/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944449881","html_url":"https://github.com/apache/iceberg/pull/1508#issuecomment-944449881","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1508","id":944449881,"node_id":"IC_kwDOCW7NX844SylZ","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T16:52:44Z","updated_at":"2021-10-15T16:52:44Z","author_association":"CONTRIBUTOR","body":"> @wypoon, since #3269 is under discussion and it may take a while for us to decide how to pass the information for Spark 3, how about removing those portions here and getting the rest of this commit in?\r\n\r\nOk, let me rebase on master, and remove the Spark 3 part of the change. This PR has been open for a very long time, and I'd like to get it in. Half a loaf is better than none.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944449881/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944617852","html_url":"https://github.com/apache/iceberg/pull/3256#issuecomment-944617852","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3256","id":944617852,"node_id":"IC_kwDOCW7NX844Tbl8","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T19:46:03Z","updated_at":"2021-10-15T19:46:03Z","author_association":"CONTRIBUTOR","body":"Yeah, removing the common module is a good next step. Or just leaving it and moving on to a build for Spark 3.2.\r\n\r\nWe should also decide how we want to handle 3.1. I'm leaning toward creating a module for it so we can possibly backport support for metadata columns, remove some of the reflection code, and eventually support a newer version of Scala.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944617852/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944620075","html_url":"https://github.com/apache/iceberg/pull/3256#issuecomment-944620075","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3256","id":944620075,"node_id":"IC_kwDOCW7NX844TcIr","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T19:50:01Z","updated_at":"2021-10-15T19:50:01Z","author_association":"CONTRIBUTOR","body":"A separate 3.1 sounds reasonable to me. It will follow the new naming, right? With the Spark and Scala versions in it?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944620075/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944620442","html_url":"https://github.com/apache/iceberg/pull/3256#issuecomment-944620442","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3256","id":944620442,"node_id":"IC_kwDOCW7NX844TcOa","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T19:50:35Z","updated_at":"2021-10-15T19:50:35Z","author_association":"CONTRIBUTOR","body":"Yes, I think it should follow new naming conventions so that we can add Scala version to it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944620442/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944645344","html_url":"https://github.com/apache/iceberg/pull/3252#issuecomment-944645344","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3252","id":944645344,"node_id":"IC_kwDOCW7NX844TiTg","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T20:37:37Z","updated_at":"2021-10-15T20:37:37Z","author_association":"CONTRIBUTOR","body":"Thanks, @samredai! Merged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944645344/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944651916","html_url":"https://github.com/apache/iceberg/pull/3256#issuecomment-944651916","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3256","id":944651916,"node_id":"IC_kwDOCW7NX844Tj6M","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T20:51:25Z","updated_at":"2021-10-15T20:51:25Z","author_association":"CONTRIBUTOR","body":"Merged! Thanks for the reviews, @jackye1995 and @aokolnychyi!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944651916/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944689663","html_url":"https://github.com/apache/iceberg/pull/2841#issuecomment-944689663","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2841","id":944689663,"node_id":"IC_kwDOCW7NX844TtH_","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T21:29:42Z","updated_at":"2021-10-15T21:29:42Z","author_association":"CONTRIBUTOR","body":"I went through the design doc so I have the full context. I'd like to take a look as well before this goes in.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944689663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944796663","html_url":"https://github.com/apache/iceberg/pull/2841#issuecomment-944796663","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2841","id":944796663,"node_id":"IC_kwDOCW7NX844UHP3","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-15T23:04:25Z","updated_at":"2021-10-15T23:04:25Z","author_association":"CONTRIBUTOR","body":"Any other thoughts, @RussellSpitzer @rdblue @jackye1995?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/944796663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945022430","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-945022430","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":945022430,"node_id":"IC_kwDOCW7NX844U-Xe","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-16T23:48:25Z","updated_at":"2021-10-16T23:48:25Z","author_association":"CONTRIBUTOR","body":"> @huaxingao was kind enough to look into supporting the AS OF syntax in Spark.\r\n\r\n@aokolnychyi @huaxingao do you mean in the Spark project or in the Iceberg project in spark3-extensions?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945022430/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945023260","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-945023260","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":945023260,"node_id":"IC_kwDOCW7NX844U-kc","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-16T23:58:30Z","updated_at":"2021-10-16T23:58:30Z","author_association":"CONTRIBUTOR","body":"As for the suggestion to use `@` for time travel, it seems that `@` is not a valid character in a table identifier in Spark SQL. (Otherwise, we would get the `<table>@...` as the table name in `SparkCatalog` and we could split that there and extract the snapshot id/timestamp and load the table.)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945023260/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945032955","html_url":"https://github.com/apache/iceberg/issues/3091#issuecomment-945032955","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3091","id":945032955,"node_id":"IC_kwDOCW7NX844VA77","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-17T01:32:41Z","updated_at":"2021-10-17T01:32:41Z","author_association":"CONTRIBUTOR","body":"This can be closed as the actual problematic test is resolved. We should make an issue for the test that was closed though so leaving this up until I do that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945032955/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945142067","html_url":"https://github.com/apache/iceberg/issues/3297#issuecomment-945142067","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3297","id":945142067,"node_id":"IC_kwDOCW7NX844Vbkz","user":{"login":"KnightChess","id":20125927,"node_id":"MDQ6VXNlcjIwMTI1OTI3","avatar_url":"https://avatars.githubusercontent.com/u/20125927?v=4","gravatar_id":"","url":"https://api.github.com/users/KnightChess","html_url":"https://github.com/KnightChess","followers_url":"https://api.github.com/users/KnightChess/followers","following_url":"https://api.github.com/users/KnightChess/following{/other_user}","gists_url":"https://api.github.com/users/KnightChess/gists{/gist_id}","starred_url":"https://api.github.com/users/KnightChess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KnightChess/subscriptions","organizations_url":"https://api.github.com/users/KnightChess/orgs","repos_url":"https://api.github.com/users/KnightChess/repos","events_url":"https://api.github.com/users/KnightChess/events{/privacy}","received_events_url":"https://api.github.com/users/KnightChess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-17T15:09:11Z","updated_at":"2021-10-17T15:09:11Z","author_association":"CONTRIBUTOR","body":"I will try to implement it.\r\nhave some ideas and questions.\r\n- for result, I think support datatime will more valuable, I need know the time the snapshot was generated.\r\n- for args, table is required, but I do not understand what the snapshot used for, I think return all snapshotId is enough.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945142067/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945143804","html_url":"https://github.com/apache/iceberg/issues/3297#issuecomment-945143804","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3297","id":945143804,"node_id":"IC_kwDOCW7NX844Vb_8","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-17T15:20:28Z","updated_at":"2021-10-17T15:20:46Z","author_association":"MEMBER","body":"I was considering you could pass an arg to get ancestors of another snapshot that is not current. For example if you rolled back","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945143804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945148419","html_url":"https://github.com/apache/iceberg/issues/3297#issuecomment-945148419","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3297","id":945148419,"node_id":"IC_kwDOCW7NX844VdID","user":{"login":"KnightChess","id":20125927,"node_id":"MDQ6VXNlcjIwMTI1OTI3","avatar_url":"https://avatars.githubusercontent.com/u/20125927?v=4","gravatar_id":"","url":"https://api.github.com/users/KnightChess","html_url":"https://github.com/KnightChess","followers_url":"https://api.github.com/users/KnightChess/followers","following_url":"https://api.github.com/users/KnightChess/following{/other_user}","gists_url":"https://api.github.com/users/KnightChess/gists{/gist_id}","starred_url":"https://api.github.com/users/KnightChess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KnightChess/subscriptions","organizations_url":"https://api.github.com/users/KnightChess/orgs","repos_url":"https://api.github.com/users/KnightChess/repos","events_url":"https://api.github.com/users/KnightChess/events{/privacy}","received_events_url":"https://api.github.com/users/KnightChess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-17T15:48:57Z","updated_at":"2021-10-17T15:48:57Z","author_association":"CONTRIBUTOR","body":"> I was considering you could pass an arg to get ancestors of another snapshot that is not current. For example if you rolled back\r\n\r\noh, its mean all snapshots find the target id slowly, but pass an arg, the ancestors will be find quickly? I don't know much about rollback for the metadata, but it does not affect the realization of this function. I will confirm the mechanism later.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945148419/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945150115","html_url":"https://github.com/apache/iceberg/issues/3297#issuecomment-945150115","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3297","id":945150115,"node_id":"IC_kwDOCW7NX844Vdij","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-17T15:59:34Z","updated_at":"2021-10-17T15:59:51Z","author_association":"MEMBER","body":"More like - \r\nSays I have snapshots\r\n```\r\nA -> B - > C -> (D)\r\n```\r\nI then roll back to B and add C' and D'\r\n\r\nSo i have the following live snapshots\r\n```\r\nA -> B - > C -> D\r\n      \\ -> C' -> (D')\r\n```\r\n           \r\nNow I want to know the ancestors of \"D\".\r\n\r\n\r\nBasically the default behavior of AcnestorsOf would give you the ancestors of the table's current snapshot, but you can pass in an arguement to get ancestors of another snapshot in the current history, or in a divergent one you rolled back from","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945150115/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945177433","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-945177433","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":945177433,"node_id":"IC_kwDOCW7NX844VkNZ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-17T19:04:56Z","updated_at":"2021-10-17T19:04:56Z","author_association":"CONTRIBUTOR","body":"Yeah, the problem with using `@` is that it must be quoted. And because Spark and Trino use different characters to quote identifiers, there is confusion for users who often don't know about identifier quoting at all.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945177433/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945181511","html_url":"https://github.com/apache/iceberg/issues/2962#issuecomment-945181511","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2962","id":945181511,"node_id":"IC_kwDOCW7NX844VlNH","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-17T19:31:28Z","updated_at":"2021-10-17T19:35:02Z","author_association":"CONTRIBUTOR","body":"@edgarRd From my investigation, the issue seems to have come up from upgrading Parquet version 1.11.0 -> 1.11.1 (which is where the map key_value type change occurred).\r\n\r\nSince you're importing tables, can you run parquet-cli meta on the files that are imported and see what parquet version they are? Or try upgrading to Parquet 1.11.1 and see if the issue occurs (using Iceberg 0.12.0 should be fine). I believe the issue will occur for you with these imported tables when using Parquet 1.11.1 based on what you're saying (I'm assuming they were likely written with Parquet <= 1.11.0).\r\n\r\nWe are looking into the issue further, but I don't believe Iceberg 0.12.0 is the issue. The issue seems to stem from going from Iceberg 0.9.1 or lower to Iceberg 0.10.0 or higher (where the parquet upgrade from 1.11.0 -> 1.11.1 occurred).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945181511/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945182192","html_url":"https://github.com/apache/iceberg/pull/1508#issuecomment-945182192","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1508","id":945182192,"node_id":"IC_kwDOCW7NX844VlXw","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-17T19:35:42Z","updated_at":"2021-10-17T19:35:42Z","author_association":"CONTRIBUTOR","body":"Rebased on master. This was more painful than expected.\r\nI'll proceed now with removal of the Spark 3 part of the change.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945182192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945183135","html_url":"https://github.com/apache/iceberg/pull/3300#issuecomment-945183135","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3300","id":945183135,"node_id":"IC_kwDOCW7NX844Vlmf","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-17T19:42:17Z","updated_at":"2021-10-17T19:42:17Z","author_association":"CONTRIBUTOR","body":"Spark tests are running because this also pulled Spark jobs into spark-ci.yml.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945183135/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945187148","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-945187148","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":945187148,"node_id":"IC_kwDOCW7NX844VmlM","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-17T20:10:13Z","updated_at":"2021-10-17T20:10:13Z","author_association":"CONTRIBUTOR","body":"@wypoon \r\n> do you mean in the Spark project or in the Iceberg project in spark3-extensions?\r\n\r\nI am communicating with the Spark folks to see if I can add AS OF syntax in Spark project. Still waiting for their reply.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945187148/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945211499","html_url":"https://github.com/apache/iceberg/pull/1508#issuecomment-945211499","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1508","id":945211499,"node_id":"IC_kwDOCW7NX844Vshr","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-17T23:08:00Z","updated_at":"2021-10-17T23:08:00Z","author_association":"CONTRIBUTOR","body":"@rdblue I have rebased on master, and removed the spark3 part of the change. I also updated the PR description.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945211499/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945531745","html_url":"https://github.com/apache/iceberg/pull/3204#issuecomment-945531745","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3204","id":945531745,"node_id":"IC_kwDOCW7NX844W6th","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T08:33:19Z","updated_at":"2021-10-18T08:33:19Z","author_association":"CONTRIBUTOR","body":"@rdblue @openinx Could you help take a look again?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945531745/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945532234","html_url":"https://github.com/apache/iceberg/pull/3095#issuecomment-945532234","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3095","id":945532234,"node_id":"IC_kwDOCW7NX844W61K","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T08:33:58Z","updated_at":"2021-10-18T08:33:58Z","author_association":"CONTRIBUTOR","body":"@openinx Could you help take a look again?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945532234/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945599697","html_url":"https://github.com/apache/iceberg/pull/3301#issuecomment-945599697","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3301","id":945599697,"node_id":"IC_kwDOCW7NX844XLTR","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T09:52:11Z","updated_at":"2021-10-18T09:52:11Z","author_association":"CONTRIBUTOR","body":"Hi @rdblue @RussellSpitzer @aokolnychyi @openinx could you help review this? thanks a lot.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945599697/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945641324","html_url":"https://github.com/apache/iceberg/issues/2914#issuecomment-945641324","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2914","id":945641324,"node_id":"IC_kwDOCW7NX844XVds","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T10:47:24Z","updated_at":"2021-10-18T10:47:24Z","author_association":"MEMBER","body":"Closed via https://github.com/apache/iceberg/pull/3250.  Now we've successfully addressed the ORC delete writers issues that troubles us a lot before. Thanks @pvary for the great work ! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945641324/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945646349","html_url":"https://github.com/apache/iceberg/pull/3250#issuecomment-945646349","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3250","id":945646349,"node_id":"IC_kwDOCW7NX844XWsN","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T10:55:18Z","updated_at":"2021-10-18T10:55:18Z","author_association":"CONTRIBUTOR","body":"Thanks for the review and the merge @openinx!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945646349/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945676023","html_url":"https://github.com/apache/iceberg/pull/3099#issuecomment-945676023","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3099","id":945676023,"node_id":"IC_kwDOCW7NX844Xd73","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-18T11:35:22Z","updated_at":"2021-10-18T11:35:22Z","author_association":"CONTRIBUTOR","body":"Merged.\r\nThanks for the PR @szehon-ho!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/945676023/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]