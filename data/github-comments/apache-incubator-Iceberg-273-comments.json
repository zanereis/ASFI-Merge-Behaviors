[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680366779","html_url":"https://github.com/apache/iceberg/issues/8268#issuecomment-1680366779","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8268","id":1680366779,"node_id":"IC_kwDOCW7NX85kKFy7","user":{"login":"wangyinsheng","id":13392313,"node_id":"MDQ6VXNlcjEzMzkyMzEz","avatar_url":"https://avatars.githubusercontent.com/u/13392313?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyinsheng","html_url":"https://github.com/wangyinsheng","followers_url":"https://api.github.com/users/wangyinsheng/followers","following_url":"https://api.github.com/users/wangyinsheng/following{/other_user}","gists_url":"https://api.github.com/users/wangyinsheng/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyinsheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyinsheng/subscriptions","organizations_url":"https://api.github.com/users/wangyinsheng/orgs","repos_url":"https://api.github.com/users/wangyinsheng/repos","events_url":"https://api.github.com/users/wangyinsheng/events{/privacy}","received_events_url":"https://api.github.com/users/wangyinsheng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T10:38:21Z","updated_at":"2023-08-16T10:38:21Z","author_association":"CONTRIBUTOR","body":"> How will you resolve conflicts if any?\r\n\r\nThe simplest way is abort the rebase. I haven't thought it clearly. Maybe there is more strategies. I raise this issue to discuss it","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680366779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680368750","html_url":"https://github.com/apache/iceberg/issues/8333#issuecomment-1680368750","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8333","id":1680368750,"node_id":"IC_kwDOCW7NX85kKGRu","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T10:40:00Z","updated_at":"2023-08-16T10:40:00Z","author_association":"CONTRIBUTOR","body":"can you please share the schema of the Parquet file and of the Iceberg table? It seems that there's a schema mismatch","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680368750/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680400541","html_url":"https://github.com/apache/iceberg/issues/8331#issuecomment-1680400541","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8331","id":1680400541,"node_id":"IC_kwDOCW7NX85kKOCd","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T11:04:31Z","updated_at":"2023-08-16T11:04:31Z","author_association":"MEMBER","body":"Register table does not create a new commit as far as I know. You are looking at the last commit to the tableÂ Sent from my iPhoneOn Aug 16, 2023, at 4:10 AM, Harsh Maheshwari ***@***.***> wrote:ï»¿\r\nApache Iceberg version\r\n1.3.1 (latest release)\r\nQuery engine\r\nSpark\r\nPlease describe the bug ðŸž\r\nSteps to repro:\r\n\r\n\r\nMigrate a table with existing snapshots on to the NessieCatalog using registerTable(..)\r\n\r\n\r\nThe commit message is configured against the commit type of the current snapshot\r\n\r\n\r\nIceberg append against db.migration_table\r\nAuthored by: xx 2 minutes ago\r\n\r\nProperties:\r\napplication-type: iceberg\r\niceberg.operation: append\r\n\r\nhttps://github.com/apache/iceberg/blob/c1fc55022557653cfeb6125c1d51bf8ab12c8f96/nessie/src/main/java/org/apache/iceberg/nessie/NessieIcebergClient.java#L475C15-L475C28\r\nThe ask of this ticket is for a better commit message and iceberg.operation, which clearly identifies that it's a table registration activity.\r\n\r\nâ€”Reply to this email directly, view it on GitHub, or unsubscribe.You are receiving this because you are subscribed to this thread.Message ID: ***@***.***>","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680400541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680403721","html_url":"https://github.com/apache/iceberg/pull/8001#issuecomment-1680403721","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8001","id":1680403721,"node_id":"IC_kwDOCW7NX85kKO0J","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T11:07:08Z","updated_at":"2023-08-16T11:07:08Z","author_association":"MEMBER","body":"There will always be conflicts, that's why we retry. The number of commit retires should be increased here","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680403721/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680416867","html_url":"https://github.com/apache/iceberg/issues/8333#issuecomment-1680416867","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8333","id":1680416867,"node_id":"IC_kwDOCW7NX85kKSBj","user":{"login":"chandu-1101","id":138012432,"node_id":"U_kgDOCDnnEA","avatar_url":"https://avatars.githubusercontent.com/u/138012432?v=4","gravatar_id":"","url":"https://api.github.com/users/chandu-1101","html_url":"https://github.com/chandu-1101","followers_url":"https://api.github.com/users/chandu-1101/followers","following_url":"https://api.github.com/users/chandu-1101/following{/other_user}","gists_url":"https://api.github.com/users/chandu-1101/gists{/gist_id}","starred_url":"https://api.github.com/users/chandu-1101/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chandu-1101/subscriptions","organizations_url":"https://api.github.com/users/chandu-1101/orgs","repos_url":"https://api.github.com/users/chandu-1101/repos","events_url":"https://api.github.com/users/chandu-1101/events{/privacy}","received_events_url":"https://api.github.com/users/chandu-1101/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T11:17:47Z","updated_at":"2023-08-16T11:17:47Z","author_association":"NONE","body":"Hi,\r\n\r\nThe input to the iceberg is json (when the exception happened). Below is the schema from .metadata folder of iceberg\r\n\r\nThe schema that was applied onto the json file when creating dataframe is also attached. \r\n\r\n[parquet-schema.txt](https://github.com/apache/iceberg/files/12358666/parquet-schema.txt)\r\n\r\n[iceberg-schema.txt](https://github.com/apache/iceberg/files/12358679/iceberg-schema.txt)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680416867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680470847","html_url":"https://github.com/apache/iceberg/issues/8331#issuecomment-1680470847","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8331","id":1680470847,"node_id":"IC_kwDOCW7NX85kKfM_","user":{"login":"harshm-dev","id":57615655,"node_id":"MDQ6VXNlcjU3NjE1NjU1","avatar_url":"https://avatars.githubusercontent.com/u/57615655?v=4","gravatar_id":"","url":"https://api.github.com/users/harshm-dev","html_url":"https://github.com/harshm-dev","followers_url":"https://api.github.com/users/harshm-dev/followers","following_url":"https://api.github.com/users/harshm-dev/following{/other_user}","gists_url":"https://api.github.com/users/harshm-dev/gists{/gist_id}","starred_url":"https://api.github.com/users/harshm-dev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/harshm-dev/subscriptions","organizations_url":"https://api.github.com/users/harshm-dev/orgs","repos_url":"https://api.github.com/users/harshm-dev/repos","events_url":"https://api.github.com/users/harshm-dev/events{/privacy}","received_events_url":"https://api.github.com/users/harshm-dev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T11:58:42Z","updated_at":"2023-08-16T11:58:42Z","author_association":"CONTRIBUTOR","body":"Thanks for the response. \r\n\r\nThis is my read -\r\n- [BaseMetastoreCatalog:registerTable](https://github.com/apache/iceberg/blob/c1fc55022557653cfeb6125c1d51bf8ab12c8f96/core/src/main/java/org/apache/iceberg/BaseMetastoreCatalog.java#L87) invokes TO.commit\r\n- [NessieTableOperations:commitTable](https://github.com/apache/iceberg/blob/c1fc55022557653cfeb6125c1d51bf8ab12c8f96/nessie/src/main/java/org/apache/iceberg/nessie/NessieTableOperations.java#L139C7-L139C13  ) calls commitTable on the NessieIcebergClient\r\n- [NessieIcebergClient:commitTable](https://github.com/apache/iceberg/blob/c1fc55022557653cfeb6125c1d51bf8ab12c8f96/nessie/src/main/java/org/apache/iceberg/nessie/NessieIcebergClient.java#L479) finally tries to commit into Nessie.\r\n\r\nIMO we should be able to distinguish between the register and snapshot update cases by checking if the base metadata is present, and update the messages respectively.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680470847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680488908","html_url":"https://github.com/apache/iceberg/pull/8001#issuecomment-1680488908","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8001","id":1680488908,"node_id":"IC_kwDOCW7NX85kKjnM","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T12:11:08Z","updated_at":"2023-08-16T12:11:08Z","author_association":"CONTRIBUTOR","body":"We have increased the retried times to the same value as `max-concurrent-file-group-rewrites`. The problem is those retrying threads conflict with each other. Even if one thread wins in one-round conflicts, others are still conflicts.  Free ones will be filled shortly due to exponential retry.  All threads are in retrying, and most of them fail in the end. The following shows 54 commits failed by conflicts.\r\n\r\n<img width=\"514\" alt=\"image\" src=\"https://github.com/apache/iceberg/assets/12733256/7d7dfbb1-9a5f-404b-8005-3bdb63addf1c\">\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680488908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680546021","html_url":"https://github.com/apache/iceberg/pull/8001#issuecomment-1680546021","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8001","id":1680546021,"node_id":"IC_kwDOCW7NX85kKxjl","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T12:50:31Z","updated_at":"2023-08-16T12:53:35Z","author_association":"MEMBER","body":"You need to increase it to the max number of concurrent operations ( which doesn't necessarily mean number of concurrent rewrites) + a few . If we are looking for a good longer term solution we need to use a rest catalog or modify hive table operations so that we don't write the metadata.json until the lock is acquired which is possible if inherit snapshot id is enabled","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680546021/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680563361","html_url":"https://github.com/apache/iceberg/pull/8332#issuecomment-1680563361","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8332","id":1680563361,"node_id":"IC_kwDOCW7NX85kK1yh","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T13:01:59Z","updated_at":"2023-08-16T13:01:59Z","author_association":"CONTRIBUTOR","body":"thanks @dongjoon-hyun ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680563361/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680594040","html_url":"https://github.com/apache/iceberg/pull/8299#issuecomment-1680594040","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8299","id":1680594040,"node_id":"IC_kwDOCW7NX85kK9R4","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T13:20:15Z","updated_at":"2023-08-16T13:20:15Z","author_association":"CONTRIBUTOR","body":"I kind of like option 2) where we would essentially have `PARQUET_COMPRESSION_DEFAULT` and `PARQUET_COMPRESSION_DEFAULT_SINCE_1_4_0`, indicating that the newer default should be used on new tables since Iceberg 1.4.0 (or any other name that basically indicates that this is the new default for new tables).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680594040/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680595005","html_url":"https://github.com/apache/iceberg/issues/8333#issuecomment-1680595005","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8333","id":1680595005,"node_id":"IC_kwDOCW7NX85kK9g9","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T13:20:49Z","updated_at":"2023-08-16T13:20:58Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer any idea what would cause this? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680595005/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680649961","html_url":"https://github.com/apache/iceberg/pull/8164#issuecomment-1680649961","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8164","id":1680649961,"node_id":"IC_kwDOCW7NX85kLK7p","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T13:50:15Z","updated_at":"2023-08-16T13:50:15Z","author_association":"COLLABORATOR","body":"@aokolnychyi , Do we need to backport https://github.com/apache/iceberg/pull/7646 as well or https://github.com/apache/iceberg/pull/7637 can work independently?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680649961/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680772133","html_url":"https://github.com/apache/iceberg/pull/8113#issuecomment-1680772133","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8113","id":1680772133,"node_id":"IC_kwDOCW7NX85kLowl","user":{"login":"deniskuzZ","id":2761528,"node_id":"MDQ6VXNlcjI3NjE1Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/2761528?v=4","gravatar_id":"","url":"https://api.github.com/users/deniskuzZ","html_url":"https://github.com/deniskuzZ","followers_url":"https://api.github.com/users/deniskuzZ/followers","following_url":"https://api.github.com/users/deniskuzZ/following{/other_user}","gists_url":"https://api.github.com/users/deniskuzZ/gists{/gist_id}","starred_url":"https://api.github.com/users/deniskuzZ/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deniskuzZ/subscriptions","organizations_url":"https://api.github.com/users/deniskuzZ/orgs","repos_url":"https://api.github.com/users/deniskuzZ/repos","events_url":"https://api.github.com/users/deniskuzZ/events{/privacy}","received_events_url":"https://api.github.com/users/deniskuzZ/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T14:55:44Z","updated_at":"2023-08-16T15:08:49Z","author_association":"MEMBER","body":"[HIVE-16614](https://issues.apache.org/jira/browse/HIVE-16614): Support \"set local time zone\" statement \r\n\r\nconfig: _**hive.local.time.zone**_ default is LOCAL\r\nWhen set to LOCAL or not specified, the system default time-zone will be used instead.\r\n\r\n**example:**\r\nset hive.local.time.zone=Europe/London;\r\n````\r\nZoneId timeZone = SessionState.get() == null ? \r\n    new HiveConf().getLocalTimeZone() :\r\n    SessionState.get().getConf().getLocalTimeZone();\r\n\r\npublic ZoneId getLocalTimeZone() {\r\n  String timeZoneStr = getVar(ConfVars.HIVE_LOCAL_TIME_ZONE);\r\n  return TimestampTZUtil.parseTimeZone(timeZoneStr);\r\n}\r\n\r\npublic static ZoneId parseTimeZone(String timeZoneStr) {\r\n    if (timeZoneStr == null || timeZoneStr.trim().isEmpty() ||\r\n        timeZoneStr.trim().toLowerCase().equals(\"local\")) {\r\n      // default\r\n      return ZoneId.systemDefault();\r\n    }\r\n    try {\r\n      return ZoneId.of(timeZoneStr);\r\n    } catch (DateTimeException e1) {\r\n      // default\r\n      throw new RuntimeException(\"Invalid time zone displacement value\", e1);\r\n    }\r\n  }\r\n````","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680772133/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680829914","html_url":"https://github.com/apache/iceberg/pull/8122#issuecomment-1680829914","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8122","id":1680829914,"node_id":"IC_kwDOCW7NX85kL23a","user":{"login":"zeroshade","id":555095,"node_id":"MDQ6VXNlcjU1NTA5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/555095?v=4","gravatar_id":"","url":"https://api.github.com/users/zeroshade","html_url":"https://github.com/zeroshade","followers_url":"https://api.github.com/users/zeroshade/followers","following_url":"https://api.github.com/users/zeroshade/following{/other_user}","gists_url":"https://api.github.com/users/zeroshade/gists{/gist_id}","starred_url":"https://api.github.com/users/zeroshade/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zeroshade/subscriptions","organizations_url":"https://api.github.com/users/zeroshade/orgs","repos_url":"https://api.github.com/users/zeroshade/repos","events_url":"https://api.github.com/users/zeroshade/events{/privacy}","received_events_url":"https://api.github.com/users/zeroshade/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T15:28:54Z","updated_at":"2023-08-16T15:28:54Z","author_association":"MEMBER","body":"Closing this PR in favor of it having been merged / added to github.com/apache/iceberg-go","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680829914/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680852185","html_url":"https://github.com/apache/iceberg/issues/8335#issuecomment-1680852185","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8335","id":1680852185,"node_id":"IC_kwDOCW7NX85kL8TZ","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T15:42:31Z","updated_at":"2023-08-16T15:42:31Z","author_association":"MEMBER","body":"You are hitting a driver side oom there. So you'll want to increase the driver memory not the executor memory. You can tell because the OOM is killing the shell and not the executors.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680852185/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680854506","html_url":"https://github.com/apache/iceberg/issues/8331#issuecomment-1680854506","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8331","id":1680854506,"node_id":"IC_kwDOCW7NX85kL83q","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T15:44:05Z","updated_at":"2023-08-16T15:44:05Z","author_association":"MEMBER","body":"Ah so this is specifically for Nessie metadata, got it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680854506/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680857580","html_url":"https://github.com/apache/iceberg/issues/8322#issuecomment-1680857580","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8322","id":1680857580,"node_id":"IC_kwDOCW7NX85kL9ns","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T15:46:04Z","updated_at":"2023-08-16T15:46:04Z","author_association":"MEMBER","body":"I think one of the issues here is that Add_files doesn't use FileIO to actually list files. It uses HadoopFS so we would need the hadoop libs. Now that we have \"listPrefix\" support though we can potentially remove that dependency if a FileIO is configured with prefix support. We have the same issue in RemoveOrphans cc: @anuragmantri ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680857580/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680859244","html_url":"https://github.com/apache/iceberg/issues/8318#issuecomment-1680859244","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8318","id":1680859244,"node_id":"IC_kwDOCW7NX85kL-Bs","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T15:47:08Z","updated_at":"2023-08-16T15:47:08Z","author_association":"MEMBER","body":"Pull requests are welcome :) If you would like to add in an ORC Rolling File Writer I think that would be appreciated. I don't know of many ORC users so I think that's why we haven't seen it added yet. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680859244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680870475","html_url":"https://github.com/apache/iceberg/issues/8298#issuecomment-1680870475","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8298","id":1680870475,"node_id":"IC_kwDOCW7NX85kMAxL","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T15:54:22Z","updated_at":"2023-08-16T15:54:22Z","author_association":"MEMBER","body":"If it does exist we expect it to throw an exception which should get converted to an Iceberg Already Exists Exception, but that should get rethrown as a spark NamesapceAlreadyExistsException which spark should ignore.\r\n\r\n\r\nThis Code Should throw a Hive Exception which should be rethrown as an Iceberg Exception\r\nhttps://github.com/apache/iceberg/blob/79c88a1775c4e2019fff00de7520826388158424/hive-metastore/src/main/java/org/apache/iceberg/hive/HiveCatalog.java#L289-L293\r\n\r\nThis Code in the Spark implementation should then catch the Iceberg Exception and Rethrow as a Spark Exception\r\nhttps://github.com/apache/iceberg/blob/7406098ee7fdb2c9b4cd5060afbb39e5e5b3f7f3/spark/v3.2/spark/src/main/java/org/apache/iceberg/spark/SparkCatalog.java#L398-L400\r\n\r\n\r\nI don't see either of those bits in your stack trace. Are we missing some lines? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680870475/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680875724","html_url":"https://github.com/apache/iceberg/issues/8277#issuecomment-1680875724","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8277","id":1680875724,"node_id":"IC_kwDOCW7NX85kMCDM","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T15:57:45Z","updated_at":"2023-08-16T15:57:45Z","author_association":"MEMBER","body":"Derby will be broken because it can't handle multithreaded access so you need either a full embedded metastore like in our tests, or a remote metastore. Or you can test with Hadoop catalog","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680875724/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680877561","html_url":"https://github.com/apache/iceberg/issues/8258#issuecomment-1680877561","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8258","id":1680877561,"node_id":"IC_kwDOCW7NX85kMCf5","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T15:58:59Z","updated_at":"2023-08-16T15:58:59Z","author_association":"MEMBER","body":"@szehon-ho This is the proposal we were talking about, if you could check it out I would appreciate it. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1680877561/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681046383","html_url":"https://github.com/apache/iceberg/pull/7782#issuecomment-1681046383","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7782","id":1681046383,"node_id":"IC_kwDOCW7NX85kMrtv","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T17:55:11Z","updated_at":"2023-08-16T17:55:11Z","author_association":"CONTRIBUTOR","body":"Thanks, @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681046383/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681048443","html_url":"https://github.com/apache/iceberg/issues/8130#issuecomment-1681048443","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8130","id":1681048443,"node_id":"IC_kwDOCW7NX85kMsN7","user":{"login":"chennurchaitanya","id":24554112,"node_id":"MDQ6VXNlcjI0NTU0MTEy","avatar_url":"https://avatars.githubusercontent.com/u/24554112?v=4","gravatar_id":"","url":"https://api.github.com/users/chennurchaitanya","html_url":"https://github.com/chennurchaitanya","followers_url":"https://api.github.com/users/chennurchaitanya/followers","following_url":"https://api.github.com/users/chennurchaitanya/following{/other_user}","gists_url":"https://api.github.com/users/chennurchaitanya/gists{/gist_id}","starred_url":"https://api.github.com/users/chennurchaitanya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chennurchaitanya/subscriptions","organizations_url":"https://api.github.com/users/chennurchaitanya/orgs","repos_url":"https://api.github.com/users/chennurchaitanya/repos","events_url":"https://api.github.com/users/chennurchaitanya/events{/privacy}","received_events_url":"https://api.github.com/users/chennurchaitanya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T17:56:55Z","updated_at":"2023-08-16T17:56:55Z","author_association":"NONE","body":"Thanks russell, i have enabled parallel deletes and it improved the performance.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681048443/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681152456","html_url":"https://github.com/apache/iceberg/pull/8260#issuecomment-1681152456","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8260","id":1681152456,"node_id":"IC_kwDOCW7NX85kNFnI","user":{"login":"mohitgargk","id":1259955,"node_id":"MDQ6VXNlcjEyNTk5NTU=","avatar_url":"https://avatars.githubusercontent.com/u/1259955?v=4","gravatar_id":"","url":"https://api.github.com/users/mohitgargk","html_url":"https://github.com/mohitgargk","followers_url":"https://api.github.com/users/mohitgargk/followers","following_url":"https://api.github.com/users/mohitgargk/following{/other_user}","gists_url":"https://api.github.com/users/mohitgargk/gists{/gist_id}","starred_url":"https://api.github.com/users/mohitgargk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mohitgargk/subscriptions","organizations_url":"https://api.github.com/users/mohitgargk/orgs","repos_url":"https://api.github.com/users/mohitgargk/repos","events_url":"https://api.github.com/users/mohitgargk/events{/privacy}","received_events_url":"https://api.github.com/users/mohitgargk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T19:22:02Z","updated_at":"2023-08-16T19:22:02Z","author_association":"NONE","body":"> Do we have a design doc for this feature?\r\n\r\nShould be ready by this week. Will provide link in this thread.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681152456/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681188555","html_url":"https://github.com/apache/iceberg/issues/8258#issuecomment-1681188555","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8258","id":1681188555,"node_id":"IC_kwDOCW7NX85kNObL","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T19:53:26Z","updated_at":"2023-08-16T19:53:50Z","author_association":"COLLABORATOR","body":"Yea I left some initial comments yesterday, plan to take another pass.  The idea is promising.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681188555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681212947","html_url":"https://github.com/apache/iceberg/issues/8295#issuecomment-1681212947","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8295","id":1681212947,"node_id":"IC_kwDOCW7NX85kNUYT","user":{"login":"MehulBatra","id":66407733,"node_id":"MDQ6VXNlcjY2NDA3NzMz","avatar_url":"https://avatars.githubusercontent.com/u/66407733?v=4","gravatar_id":"","url":"https://api.github.com/users/MehulBatra","html_url":"https://github.com/MehulBatra","followers_url":"https://api.github.com/users/MehulBatra/followers","following_url":"https://api.github.com/users/MehulBatra/following{/other_user}","gists_url":"https://api.github.com/users/MehulBatra/gists{/gist_id}","starred_url":"https://api.github.com/users/MehulBatra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MehulBatra/subscriptions","organizations_url":"https://api.github.com/users/MehulBatra/orgs","repos_url":"https://api.github.com/users/MehulBatra/repos","events_url":"https://api.github.com/users/MehulBatra/events{/privacy}","received_events_url":"https://api.github.com/users/MehulBatra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T20:14:59Z","updated_at":"2023-08-16T20:14:59Z","author_association":"CONTRIBUTOR","body":"I can start working on this as I have some bandwidth","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681212947/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681216688","html_url":"https://github.com/apache/iceberg/issues/8282#issuecomment-1681216688","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8282","id":1681216688,"node_id":"IC_kwDOCW7NX85kNVSw","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T20:18:18Z","updated_at":"2023-08-16T20:18:18Z","author_association":"CONTRIBUTOR","body":"Thanks @onerishabh again for fixing this","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681216688/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681220116","html_url":"https://github.com/apache/iceberg/issues/8295#issuecomment-1681220116","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8295","id":1681220116,"node_id":"IC_kwDOCW7NX85kNWIU","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T20:21:23Z","updated_at":"2023-08-16T20:21:23Z","author_association":"CONTRIBUTOR","body":"@karthikmurali60 I missed your ping here, sorry about that. You're more than welcome to work on it.\r\n\r\n@MehulBatra WDYT of https://github.com/apache/iceberg/issues/8294 or https://github.com/apache/iceberg/issues/8273.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681220116/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681224235","html_url":"https://github.com/apache/iceberg/issues/8294#issuecomment-1681224235","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8294","id":1681224235,"node_id":"IC_kwDOCW7NX85kNXIr","user":{"login":"MehulBatra","id":66407733,"node_id":"MDQ6VXNlcjY2NDA3NzMz","avatar_url":"https://avatars.githubusercontent.com/u/66407733?v=4","gravatar_id":"","url":"https://api.github.com/users/MehulBatra","html_url":"https://github.com/MehulBatra","followers_url":"https://api.github.com/users/MehulBatra/followers","following_url":"https://api.github.com/users/MehulBatra/following{/other_user}","gists_url":"https://api.github.com/users/MehulBatra/gists{/gist_id}","starred_url":"https://api.github.com/users/MehulBatra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MehulBatra/subscriptions","organizations_url":"https://api.github.com/users/MehulBatra/orgs","repos_url":"https://api.github.com/users/MehulBatra/repos","events_url":"https://api.github.com/users/MehulBatra/events{/privacy}","received_events_url":"https://api.github.com/users/MehulBatra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T20:25:02Z","updated_at":"2023-08-16T20:25:02Z","author_association":"CONTRIBUTOR","body":"I can take this up","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681224235/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681243385","html_url":"https://github.com/apache/iceberg/issues/8294#issuecomment-1681243385","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8294","id":1681243385,"node_id":"IC_kwDOCW7NX85kNbz5","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T20:41:26Z","updated_at":"2023-08-16T20:41:26Z","author_association":"CONTRIBUTOR","body":"Awesome, I've assigned the issue, thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681243385/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681325056","html_url":"https://github.com/apache/iceberg/pull/8341#issuecomment-1681325056","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8341","id":1681325056,"node_id":"IC_kwDOCW7NX85kNvwA","user":{"login":"dacort","id":1512,"node_id":"MDQ6VXNlcjE1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1512?v=4","gravatar_id":"","url":"https://api.github.com/users/dacort","html_url":"https://github.com/dacort","followers_url":"https://api.github.com/users/dacort/followers","following_url":"https://api.github.com/users/dacort/following{/other_user}","gists_url":"https://api.github.com/users/dacort/gists{/gist_id}","starred_url":"https://api.github.com/users/dacort/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dacort/subscriptions","organizations_url":"https://api.github.com/users/dacort/orgs","repos_url":"https://api.github.com/users/dacort/repos","events_url":"https://api.github.com/users/dacort/events{/privacy}","received_events_url":"https://api.github.com/users/dacort/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T22:00:17Z","updated_at":"2023-08-16T22:00:17Z","author_association":"CONTRIBUTOR","body":"Squashed!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681325056/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681364926","html_url":"https://github.com/apache/iceberg/pull/8336#issuecomment-1681364926","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8336","id":1681364926,"node_id":"IC_kwDOCW7NX85kN5e-","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T22:47:36Z","updated_at":"2023-08-16T22:47:36Z","author_association":"CONTRIBUTOR","body":"cc @RussellSpitzer @szehon-ho @flyrain @nastra ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681364926/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681366771","html_url":"https://github.com/apache/iceberg/issues/8339#issuecomment-1681366771","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8339","id":1681366771,"node_id":"IC_kwDOCW7NX85kN57z","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T22:49:36Z","updated_at":"2023-08-16T22:50:00Z","author_association":"COLLABORATOR","body":"Yea that may be a problem , if partition spec changes.  \r\n\r\nI wonder if you can just move the files location (currently delete/add manually, as unfortunately relative paths is not there yet).  Basically whether you can keep them in the table, in cold storage location?  Probably the best is if your file system support cold storage migration automatically, like S3 glacier?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681366771/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681377828","html_url":"https://github.com/apache/iceberg/pull/7782#issuecomment-1681377828","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7782","id":1681377828,"node_id":"IC_kwDOCW7NX85kN8ok","user":{"login":"pdames","id":833518,"node_id":"MDQ6VXNlcjgzMzUxOA==","avatar_url":"https://avatars.githubusercontent.com/u/833518?v=4","gravatar_id":"","url":"https://api.github.com/users/pdames","html_url":"https://github.com/pdames","followers_url":"https://api.github.com/users/pdames/followers","following_url":"https://api.github.com/users/pdames/following{/other_user}","gists_url":"https://api.github.com/users/pdames/gists{/gist_id}","starred_url":"https://api.github.com/users/pdames/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pdames/subscriptions","organizations_url":"https://api.github.com/users/pdames/orgs","repos_url":"https://api.github.com/users/pdames/repos","events_url":"https://api.github.com/users/pdames/events{/privacy}","received_events_url":"https://api.github.com/users/pdames/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T23:03:48Z","updated_at":"2023-08-16T23:18:41Z","author_association":"NONE","body":"@Fokko and @rdblue - unfortunately, this has broken our in-progress integration of PyIceberg with Ray on the [Iceberg Branch of DeltaCAT](https://github.com/ray-project/deltacat/tree/iceberg) due to https://github.com/ray-project/ray/issues/37019. Happy to work on both sides to find a path forward, but seems like we'll need to pin to a prior commit of PyIceberg for continued Ray 2.X interoperability in the mean time.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681377828/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":1,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681384341","html_url":"https://github.com/apache/iceberg/issues/8339#issuecomment-1681384341","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8339","id":1681384341,"node_id":"IC_kwDOCW7NX85kN-OV","user":{"login":"matternc","id":11986058,"node_id":"MDQ6VXNlcjExOTg2MDU4","avatar_url":"https://avatars.githubusercontent.com/u/11986058?v=4","gravatar_id":"","url":"https://api.github.com/users/matternc","html_url":"https://github.com/matternc","followers_url":"https://api.github.com/users/matternc/followers","following_url":"https://api.github.com/users/matternc/following{/other_user}","gists_url":"https://api.github.com/users/matternc/gists{/gist_id}","starred_url":"https://api.github.com/users/matternc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matternc/subscriptions","organizations_url":"https://api.github.com/users/matternc/orgs","repos_url":"https://api.github.com/users/matternc/repos","events_url":"https://api.github.com/users/matternc/events{/privacy}","received_events_url":"https://api.github.com/users/matternc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T23:13:18Z","updated_at":"2023-08-16T23:13:18Z","author_association":"NONE","body":"That is what i was afraid of. I am assuming there currently isn't any way to export the metadata about a set of files and bring those along when you re-import the data files?\r\n\r\nUnfortunently the \"hot\" storage and the cold storage are two separate entities :'(. To make things even more complicated we have multiple independent clusters that sometimes need to transfer data between each other. So we would be adding data files to an iceberg table that wasn't even originally responsible for generating them.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681384341/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681413388","html_url":"https://github.com/apache/iceberg/pull/7910#issuecomment-1681413388","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7910","id":1681413388,"node_id":"IC_kwDOCW7NX85kOFUM","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-16T23:59:15Z","updated_at":"2023-08-16T23:59:15Z","author_association":"CONTRIBUTOR","body":"I should have some time to review this week. Sorry for the delay!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681413388/reactions","total_count":3,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":1,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681420406","html_url":"https://github.com/apache/iceberg/issues/8339#issuecomment-1681420406","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8339","id":1681420406,"node_id":"IC_kwDOCW7NX85kOHB2","user":{"login":"matternc","id":11986058,"node_id":"MDQ6VXNlcjExOTg2MDU4","avatar_url":"https://avatars.githubusercontent.com/u/11986058?v=4","gravatar_id":"","url":"https://api.github.com/users/matternc","html_url":"https://github.com/matternc","followers_url":"https://api.github.com/users/matternc/followers","following_url":"https://api.github.com/users/matternc/following{/other_user}","gists_url":"https://api.github.com/users/matternc/gists{/gist_id}","starred_url":"https://api.github.com/users/matternc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matternc/subscriptions","organizations_url":"https://api.github.com/users/matternc/orgs","repos_url":"https://api.github.com/users/matternc/repos","events_url":"https://api.github.com/users/matternc/events{/privacy}","received_events_url":"https://api.github.com/users/matternc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T00:09:02Z","updated_at":"2023-08-17T00:09:02Z","author_association":"NONE","body":"#7557 might actually solve my problem assuming it could be extended to the add_files API. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681420406/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681431973","html_url":"https://github.com/apache/iceberg/issues/7557#issuecomment-1681431973","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7557","id":1681431973,"node_id":"IC_kwDOCW7NX85kOJ2l","user":{"login":"matternc","id":11986058,"node_id":"MDQ6VXNlcjExOTg2MDU4","avatar_url":"https://avatars.githubusercontent.com/u/11986058?v=4","gravatar_id":"","url":"https://api.github.com/users/matternc","html_url":"https://github.com/matternc","followers_url":"https://api.github.com/users/matternc/followers","following_url":"https://api.github.com/users/matternc/following{/other_user}","gists_url":"https://api.github.com/users/matternc/gists{/gist_id}","starred_url":"https://api.github.com/users/matternc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matternc/subscriptions","organizations_url":"https://api.github.com/users/matternc/orgs","repos_url":"https://api.github.com/users/matternc/repos","events_url":"https://api.github.com/users/matternc/events{/privacy}","received_events_url":"https://api.github.com/users/matternc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T00:25:54Z","updated_at":"2023-08-17T00:26:33Z","author_association":"NONE","body":"Do you see this as less about Partition evolution and more about being able to rewrite data into a more optimal partition spec. Like in your example maybe your default partition is using days, but on one specific day your data was exceptionally chatty resulting in suboptimal query performance. So being able to rewrite these chatty days into hours could result in a more optimal partition setup.\r\n\r\nIf so, would it make sense for users to be able to add a partition spec to a table without altering/evolving the existing default. Maybe this already exists?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681431973/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681432275","html_url":"https://github.com/apache/iceberg/pull/8289#issuecomment-1681432275","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8289","id":1681432275,"node_id":"IC_kwDOCW7NX85kOJ7T","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T00:26:23Z","updated_at":"2023-08-17T00:26:23Z","author_association":"COLLABORATOR","body":"Merged, thanks @dramaticlly @aokolnychyi for review.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681432275/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681482877","html_url":"https://github.com/apache/iceberg/pull/8313#issuecomment-1681482877","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8313","id":1681482877,"node_id":"IC_kwDOCW7NX85kOWR9","user":{"login":"jerqi","id":8159038,"node_id":"MDQ6VXNlcjgxNTkwMzg=","avatar_url":"https://avatars.githubusercontent.com/u/8159038?v=4","gravatar_id":"","url":"https://api.github.com/users/jerqi","html_url":"https://github.com/jerqi","followers_url":"https://api.github.com/users/jerqi/followers","following_url":"https://api.github.com/users/jerqi/following{/other_user}","gists_url":"https://api.github.com/users/jerqi/gists{/gist_id}","starred_url":"https://api.github.com/users/jerqi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerqi/subscriptions","organizations_url":"https://api.github.com/users/jerqi/orgs","repos_url":"https://api.github.com/users/jerqi/repos","events_url":"https://api.github.com/users/jerqi/events{/privacy}","received_events_url":"https://api.github.com/users/jerqi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T01:41:53Z","updated_at":"2023-08-17T01:48:08Z","author_association":"CONTRIBUTOR","body":"> > Do we also have to cover other places that use `SparkFileWriterFactory`? For instance, `SparkPositionDeltaWrite`?\r\n> \r\n> Thanks for you review, my mistake. I will add the modification of the code and add the ut.\r\n\r\n@aokolnychyi I have addressed the comments. Could you take another look if you have time?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681482877/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681499924","html_url":"https://github.com/apache/iceberg/pull/8001#issuecomment-1681499924","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8001","id":1681499924,"node_id":"IC_kwDOCW7NX85kOacU","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T02:03:42Z","updated_at":"2023-08-17T02:03:42Z","author_association":"CONTRIBUTOR","body":"Thanks, @RussellSpitzer.\r\n\r\n> If we are looking for a good longer term solution we need to use a rest catalog or modify hive table operations so that we don't write the metadata.json until the lock is acquired which is possible if inherit snapshot id is enabled\r\n\r\nCould you explain a bit more about why need to enable inherit snapshot id? Does that's meaning we don't need to rewrite the Manifest when retrying?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681499924/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681505620","html_url":"https://github.com/apache/iceberg/issues/7557#issuecomment-1681505620","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7557","id":1681505620,"node_id":"IC_kwDOCW7NX85kOb1U","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T02:12:36Z","updated_at":"2023-08-17T02:12:36Z","author_association":"MEMBER","body":"Note that @dpaani Has a PR for this.\n#7585\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681505620/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681508314","html_url":"https://github.com/apache/iceberg/pull/8001#issuecomment-1681508314","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8001","id":1681508314,"node_id":"IC_kwDOCW7NX85kOcfa","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T02:16:13Z","updated_at":"2023-08-17T02:16:13Z","author_association":"MEMBER","body":"> \n> Could you explain a bit more about why need to enable inherit snapshot id? Does that's meaning we don't need to rewrite the Manifest when retrying?\n\nYep, if you inherit snapshot id then you don't need to rewrite manifests. You only need to rewrite metadata.json. Without inheriting snapshot ID every manifest must be rewritten as well as metadata.json since the snapshotId being assigned needs to be added to every manifest row. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681508314/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681528301","html_url":"https://github.com/apache/iceberg/pull/8001#issuecomment-1681528301","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8001","id":1681528301,"node_id":"IC_kwDOCW7NX85kOhXt","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T02:45:31Z","updated_at":"2023-08-17T02:45:31Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer appreciate your answer. I will try to dig into it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681528301/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681532350","html_url":"https://github.com/apache/iceberg/issues/1533#issuecomment-1681532350","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1533","id":1681532350,"node_id":"IC_kwDOCW7NX85kOiW-","user":{"login":"madeirak","id":23215922,"node_id":"MDQ6VXNlcjIzMjE1OTIy","avatar_url":"https://avatars.githubusercontent.com/u/23215922?v=4","gravatar_id":"","url":"https://api.github.com/users/madeirak","html_url":"https://github.com/madeirak","followers_url":"https://api.github.com/users/madeirak/followers","following_url":"https://api.github.com/users/madeirak/following{/other_user}","gists_url":"https://api.github.com/users/madeirak/gists{/gist_id}","starred_url":"https://api.github.com/users/madeirak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/madeirak/subscriptions","organizations_url":"https://api.github.com/users/madeirak/orgs","repos_url":"https://api.github.com/users/madeirak/repos","events_url":"https://api.github.com/users/madeirak/events{/privacy}","received_events_url":"https://api.github.com/users/madeirak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T02:51:50Z","updated_at":"2023-08-17T02:51:50Z","author_association":"NONE","body":"> @tangchenyang I am still having this issue. I could only get iceberg to work with hadoop not with Hive and S3 using spark.\r\n\r\nI encountered the same problem today, Spark has the problem with parsing 'db_name.table_name' ,Invalid Object Exception occurred , and the issue has been resolved due to the database named 'db_ name' does not exist, you need to create this database first","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681532350/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681553825","html_url":"https://github.com/apache/iceberg/pull/6799#issuecomment-1681553825","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6799","id":1681553825,"node_id":"IC_kwDOCW7NX85kOnmh","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T03:25:44Z","updated_at":"2023-08-17T03:25:44Z","author_association":"CONTRIBUTOR","body":"@nastra can you please look at this again? I have rebased it on master as of some time yesterday. It is, as far as I know, equivalent to the state when you approved it, except that I have also updated Spark 3.4 and Flink 1.17. If you prefer, I can remove the changes from Spark 3.3 and Flink 1.16, but I kept them as they were there from before (those were then the latest Spark and Flink versions).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681553825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681630103","html_url":"https://github.com/apache/iceberg/pull/8328#issuecomment-1681630103","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8328","id":1681630103,"node_id":"IC_kwDOCW7NX85kO6OX","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T05:19:34Z","updated_at":"2023-08-17T05:19:34Z","author_association":"CONTRIBUTOR","body":"@kengtin just to confirm that you have done `git diff` and see no diffs related to this change after back port, right?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681630103/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681691053","html_url":"https://github.com/apache/iceberg/pull/8344#issuecomment-1681691053","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8344","id":1681691053,"node_id":"IC_kwDOCW7NX85kPJGt","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T06:30:29Z","updated_at":"2023-08-17T06:30:43Z","author_association":"CONTRIBUTOR","body":"@karthikmurali60 Do we just want to show the identifier, or something more useful, similar to PyArrow:\r\n\r\nPyArrow example:\r\n![image](https://github.com/apache/iceberg/assets/1134248/e23c97ef-5408-48c4-abf1-e725ebdaa3bc)\r\n\r\nI can imagine seeing the schema, partition columns, snapshot information might be useful. I would be hesitant to show actual data, since that would require us to query manifests, or maybe even datafiles.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681691053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681793030","html_url":"https://github.com/apache/iceberg/issues/8335#issuecomment-1681793030","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8335","id":1681793030,"node_id":"IC_kwDOCW7NX85kPiAG","user":{"login":"chandu-1101","id":138012432,"node_id":"U_kgDOCDnnEA","avatar_url":"https://avatars.githubusercontent.com/u/138012432?v=4","gravatar_id":"","url":"https://api.github.com/users/chandu-1101","html_url":"https://github.com/chandu-1101","followers_url":"https://api.github.com/users/chandu-1101/followers","following_url":"https://api.github.com/users/chandu-1101/following{/other_user}","gists_url":"https://api.github.com/users/chandu-1101/gists{/gist_id}","starred_url":"https://api.github.com/users/chandu-1101/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chandu-1101/subscriptions","organizations_url":"https://api.github.com/users/chandu-1101/orgs","repos_url":"https://api.github.com/users/chandu-1101/repos","events_url":"https://api.github.com/users/chandu-1101/events{/privacy}","received_events_url":"https://api.github.com/users/chandu-1101/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T07:39:37Z","updated_at":"2023-08-17T07:39:37Z","author_association":"NONE","body":"Thank you it fixed the issue","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681793030/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681814454","html_url":"https://github.com/apache/iceberg/issues/8333#issuecomment-1681814454","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8333","id":1681814454,"node_id":"IC_kwDOCW7NX85kPnO2","user":{"login":"chandu-1101","id":138012432,"node_id":"U_kgDOCDnnEA","avatar_url":"https://avatars.githubusercontent.com/u/138012432?v=4","gravatar_id":"","url":"https://api.github.com/users/chandu-1101","html_url":"https://github.com/chandu-1101","followers_url":"https://api.github.com/users/chandu-1101/followers","following_url":"https://api.github.com/users/chandu-1101/following{/other_user}","gists_url":"https://api.github.com/users/chandu-1101/gists{/gist_id}","starred_url":"https://api.github.com/users/chandu-1101/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chandu-1101/subscriptions","organizations_url":"https://api.github.com/users/chandu-1101/orgs","repos_url":"https://api.github.com/users/chandu-1101/repos","events_url":"https://api.github.com/users/chandu-1101/events{/privacy}","received_events_url":"https://api.github.com/users/chandu-1101/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T07:56:09Z","updated_at":"2023-08-17T07:56:09Z","author_association":"NONE","body":"Any update? I get the exception still.. \r\n\r\n```\r\nscala>     val _cdcDf =sess.sql(\"\"\" select *\r\n     |                              from cdc c1\r\n     |                              where cdc_pk in (\r\n     |                                                 select max(cdc_pk)\r\n     |                                                 from cdc c2\r\n     |                                                 where _id.oid is not null\r\n     |                                                   and _id.oid !=''\r\n     |                                                   and c2.__created_date_=c1.__created_date_\r\n     |                                                 group by _id.oid)  \"\"\")\r\n_cdcDf: org.apache.spark.sql.DataFrame = [cdc_pk: string, cdc_oid: string ... 174 more fields]\r\n\r\nscala>     _cdcDf.registerTempTable(\"_cdc\")\r\n\r\nscala>  sess.sql(\"\"\" MERGE INTO x11  t\r\n     |                 using (\r\n     |                         select *\r\n     |                         from _cdc )u\r\n     |                 on t._id.oid = u._id.oid\r\n     |                   when matched then update set *\r\n     |                   when not matched then insert * \"\"\")\r\n23/08/17 07:00:37 WARN HiveConf: HiveConf of name hive.server2.thrift.url does not exist\r\n23/08/17 07:12:45 WARN TaskSetManager: Lost task 0.0 in stage 6.0 (TID 1764) (ip-172-25-26-76.prod.x.local executor 8): java.lang.ClassCastException: org.apache.spark.unsafe.types.UTF8String cannot be cast to java.lang.Long\r\n\tat scala.runtime.BoxesRunTime.unboxToLong(BoxesRunTime.java:107)\r\n\tat org.apache.spark.sql.catalyst.expressions.BaseGenericInternalRow.getLong(rows.scala:42)\r\n\tat org.apache.spark.sql.catalyst.expressions.BaseGenericInternalRow.getLong$(rows.scala:42)\r\n\tat org.apache.spark.sql.catalyst.expressions.GenericInternalRow.getLong(rows.scala:195)\r\n\tat org.apache.spark.sql.catalyst.expressions.JoinedRow.getLong(JoinedRow.scala:95)\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificUnsafeProjection.writeFields_32_62$(Unknown Source)\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificUnsafeProjection.apply(Unknown Source)\r\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.addMetadataColumnsIfNeeded(FileScanRDD.scala:291)\r\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.next(FileScanRDD.scala:318)\r\n\tat scala.collection.Iterator$$anon$10.next(Iterator.scala:461)\r\n\tat scala.collection.Iterator$$anon$10.next(Iterator.scala:461)\r\n\tat scala.collection.Iterator$$anon$10.next(Iterator.scala:461)\r\n\tat scala.collection.Iterator$$anon$10.next(Iterator.scala:461)\r\n\tat org.apache.spark.shuffle.sort.UnsafeShuffleWriter.write(UnsafeShuffleWriter.java:184)\r\n\tat org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)\r\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)\r\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:52)\r\n\tat org.apache.spark.scheduler.Task.run(Task.scala:138)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:548)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1516)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:551)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:750)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681814454/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681919398","html_url":"https://github.com/apache/iceberg/pull/8202#issuecomment-1681919398","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8202","id":1681919398,"node_id":"IC_kwDOCW7NX85kQA2m","user":{"login":"simhadri-g","id":26441677,"node_id":"MDQ6VXNlcjI2NDQxNjc3","avatar_url":"https://avatars.githubusercontent.com/u/26441677?v=4","gravatar_id":"","url":"https://api.github.com/users/simhadri-g","html_url":"https://github.com/simhadri-g","followers_url":"https://api.github.com/users/simhadri-g/followers","following_url":"https://api.github.com/users/simhadri-g/following{/other_user}","gists_url":"https://api.github.com/users/simhadri-g/gists{/gist_id}","starred_url":"https://api.github.com/users/simhadri-g/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simhadri-g/subscriptions","organizations_url":"https://api.github.com/users/simhadri-g/orgs","repos_url":"https://api.github.com/users/simhadri-g/repos","events_url":"https://api.github.com/users/simhadri-g/events{/privacy}","received_events_url":"https://api.github.com/users/simhadri-g/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T09:11:16Z","updated_at":"2023-08-17T09:11:16Z","author_association":"MEMBER","body":"Thanks for the review :) \r\nI will update the PR and get back.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681919398/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681928667","html_url":"https://github.com/apache/iceberg/issues/8126#issuecomment-1681928667","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8126","id":1681928667,"node_id":"IC_kwDOCW7NX85kQDHb","user":{"login":"chengxianglibra","id":6206813,"node_id":"MDQ6VXNlcjYyMDY4MTM=","avatar_url":"https://avatars.githubusercontent.com/u/6206813?v=4","gravatar_id":"","url":"https://api.github.com/users/chengxianglibra","html_url":"https://github.com/chengxianglibra","followers_url":"https://api.github.com/users/chengxianglibra/followers","following_url":"https://api.github.com/users/chengxianglibra/following{/other_user}","gists_url":"https://api.github.com/users/chengxianglibra/gists{/gist_id}","starred_url":"https://api.github.com/users/chengxianglibra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chengxianglibra/subscriptions","organizations_url":"https://api.github.com/users/chengxianglibra/orgs","repos_url":"https://api.github.com/users/chengxianglibra/repos","events_url":"https://api.github.com/users/chengxianglibra/events{/privacy}","received_events_url":"https://api.github.com/users/chengxianglibra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T09:17:34Z","updated_at":"2023-08-17T09:18:14Z","author_association":"NONE","body":"@aokolnychyi It seems this bug is introduced by [#7646](https://github.com/apache/iceberg/pull/7646). RewriteRowLevelIcebergCommand::buildMergingOutput would transform attribute nullable property from `true` to `false` if attribute is not in outputs, and in RewriteMergeIntoTable::buildReplaceDataPlan, #7646 update the following code\r\n`val matchedOutputs = matchedActions.map(actionOutput(_, metadataAttrs)) :+ readAttrs`\r\nto\r\n`val matchedOutputs = matchedActions.map(matchedActionOutput(_, metadataAttrs))`\r\nWhen outputs is empty and the remaining row after deletion has null value(such as the previous test case), all attributes nullable property is set to `false`, spark generated code does not check nullable of field value, which finally lead to this NPE.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681928667/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681958355","html_url":"https://github.com/apache/iceberg/pull/8202#issuecomment-1681958355","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8202","id":1681958355,"node_id":"IC_kwDOCW7NX85kQKXT","user":{"login":"simhadri-g","id":26441677,"node_id":"MDQ6VXNlcjI2NDQxNjc3","avatar_url":"https://avatars.githubusercontent.com/u/26441677?v=4","gravatar_id":"","url":"https://api.github.com/users/simhadri-g","html_url":"https://github.com/simhadri-g","followers_url":"https://api.github.com/users/simhadri-g/followers","following_url":"https://api.github.com/users/simhadri-g/following{/other_user}","gists_url":"https://api.github.com/users/simhadri-g/gists{/gist_id}","starred_url":"https://api.github.com/users/simhadri-g/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simhadri-g/subscriptions","organizations_url":"https://api.github.com/users/simhadri-g/orgs","repos_url":"https://api.github.com/users/simhadri-g/repos","events_url":"https://api.github.com/users/simhadri-g/events{/privacy}","received_events_url":"https://api.github.com/users/simhadri-g/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T09:38:07Z","updated_at":"2023-08-17T09:38:07Z","author_association":"MEMBER","body":"@nastra , I have updated the PR and moved the iceberg-docs(https://github.com/apache/iceberg-docs/pull/269) changes to the main repo.\r\n\r\nPlease have a look when you are free. \r\n\r\nThanks again for the review! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1681958355/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1682105532","html_url":"https://github.com/apache/iceberg/issues/8333#issuecomment-1682105532","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8333","id":1682105532,"node_id":"IC_kwDOCW7NX85kQuS8","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T11:15:56Z","updated_at":"2023-08-17T11:15:56Z","author_association":"MEMBER","body":"I would have guessed the same thing , schema mismatch. I would double check the schema produced by the two data frames being merged. Don't look at the underlying files. So in this case the spark schema produced by the source df and the table schema. Confirming those match would be the next step I think. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1682105532/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1682106023","html_url":"https://github.com/apache/iceberg/pull/8325#issuecomment-1682106023","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8325","id":1682106023,"node_id":"IC_kwDOCW7NX85kQuan","user":{"login":"zinking","id":118241,"node_id":"MDQ6VXNlcjExODI0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/118241?v=4","gravatar_id":"","url":"https://api.github.com/users/zinking","html_url":"https://github.com/zinking","followers_url":"https://api.github.com/users/zinking/followers","following_url":"https://api.github.com/users/zinking/following{/other_user}","gists_url":"https://api.github.com/users/zinking/gists{/gist_id}","starred_url":"https://api.github.com/users/zinking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zinking/subscriptions","organizations_url":"https://api.github.com/users/zinking/orgs","repos_url":"https://api.github.com/users/zinking/repos","events_url":"https://api.github.com/users/zinking/events{/privacy}","received_events_url":"https://api.github.com/users/zinking/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T11:16:20Z","updated_at":"2023-08-17T11:16:20Z","author_association":"CONTRIBUTOR","body":"I'm not sure, for me I would do this in two actions. remove the old column, then add the new column. \r\nalthough the name is same but columnId would be different. \r\ndoes it work","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1682106023/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1682149541","html_url":"https://github.com/apache/iceberg/pull/8260#issuecomment-1682149541","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8260","id":1682149541,"node_id":"IC_kwDOCW7NX85kQ5Cl","user":{"login":"zinking","id":118241,"node_id":"MDQ6VXNlcjExODI0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/118241?v=4","gravatar_id":"","url":"https://api.github.com/users/zinking","html_url":"https://github.com/zinking","followers_url":"https://api.github.com/users/zinking/followers","following_url":"https://api.github.com/users/zinking/following{/other_user}","gists_url":"https://api.github.com/users/zinking/gists{/gist_id}","starred_url":"https://api.github.com/users/zinking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zinking/subscriptions","organizations_url":"https://api.github.com/users/zinking/orgs","repos_url":"https://api.github.com/users/zinking/repos","events_url":"https://api.github.com/users/zinking/events{/privacy}","received_events_url":"https://api.github.com/users/zinking/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T11:51:20Z","updated_at":"2023-08-17T11:51:20Z","author_association":"CONTRIBUTOR","body":"does it handle the case where we pointed the data directory somewhere else ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1682149541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1682311802","html_url":"https://github.com/apache/iceberg/pull/8325#issuecomment-1682311802","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8325","id":1682311802,"node_id":"IC_kwDOCW7NX85kRgp6","user":{"login":"CodingCat","id":678008,"node_id":"MDQ6VXNlcjY3ODAwOA==","avatar_url":"https://avatars.githubusercontent.com/u/678008?v=4","gravatar_id":"","url":"https://api.github.com/users/CodingCat","html_url":"https://github.com/CodingCat","followers_url":"https://api.github.com/users/CodingCat/followers","following_url":"https://api.github.com/users/CodingCat/following{/other_user}","gists_url":"https://api.github.com/users/CodingCat/gists{/gist_id}","starred_url":"https://api.github.com/users/CodingCat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodingCat/subscriptions","organizations_url":"https://api.github.com/users/CodingCat/orgs","repos_url":"https://api.github.com/users/CodingCat/repos","events_url":"https://api.github.com/users/CodingCat/events{/privacy}","received_events_url":"https://api.github.com/users/CodingCat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T13:42:55Z","updated_at":"2023-08-17T13:42:55Z","author_association":"CONTRIBUTOR","body":"> I'm not sure, for me I would do this in two actions. remove the old column, then add the new column. \n> \n> although the name is same but columnId would be different. \n> \n> does it work\n\nit won't work I think, remove and add will only make the column as the last column in the schema , but I want to move the column to a certain place . Additionally it leaves the table in the risk of a partially updated schema if the job failed after delete and before add\n\nyou can remove + add in a single transaction and then move in the other one, but still it has the problem of the partially updated schema ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1682311802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1682321924","html_url":"https://github.com/apache/iceberg/pull/8299#issuecomment-1682321924","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8299","id":1682321924,"node_id":"IC_kwDOCW7NX85kRjIE","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T13:48:52Z","updated_at":"2023-08-17T13:48:52Z","author_association":"COLLABORATOR","body":"Thanks, makes sense to me, added new constant PARQUET_COMPRESSION_DEFAULT_SINCE_1_4_0","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1682321924/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1682420025","html_url":"https://github.com/apache/iceberg/issues/2093#issuecomment-1682420025","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2093","id":1682420025,"node_id":"IC_kwDOCW7NX85kR7E5","user":{"login":"XBaith","id":54210725,"node_id":"MDQ6VXNlcjU0MjEwNzI1","avatar_url":"https://avatars.githubusercontent.com/u/54210725?v=4","gravatar_id":"","url":"https://api.github.com/users/XBaith","html_url":"https://github.com/XBaith","followers_url":"https://api.github.com/users/XBaith/followers","following_url":"https://api.github.com/users/XBaith/following{/other_user}","gists_url":"https://api.github.com/users/XBaith/gists{/gist_id}","starred_url":"https://api.github.com/users/XBaith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XBaith/subscriptions","organizations_url":"https://api.github.com/users/XBaith/orgs","repos_url":"https://api.github.com/users/XBaith/repos","events_url":"https://api.github.com/users/XBaith/events{/privacy}","received_events_url":"https://api.github.com/users/XBaith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T14:47:47Z","updated_at":"2023-08-17T14:47:47Z","author_association":"NONE","body":"Hi @qphien , I have this similar requirement now: partition expiration deletion, have you got the solution now?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1682420025/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1682555313","html_url":"https://github.com/apache/iceberg/pull/8330#issuecomment-1682555313","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8330","id":1682555313,"node_id":"IC_kwDOCW7NX85kScGx","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T16:06:10Z","updated_at":"2023-08-17T16:06:10Z","author_association":"CONTRIBUTOR","body":"Merging this for the upcoming 0.5.0 release ðŸš€ ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1682555313/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1682556190","html_url":"https://github.com/apache/iceberg/pull/8332#issuecomment-1682556190","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8332","id":1682556190,"node_id":"IC_kwDOCW7NX85kScUe","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T16:06:32Z","updated_at":"2023-08-17T16:06:32Z","author_association":"MEMBER","body":"Thank you, @Fokko and @nastra .","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1682556190/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1682684482","html_url":"https://github.com/apache/iceberg/pull/8328#issuecomment-1682684482","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8328","id":1682684482,"node_id":"IC_kwDOCW7NX85kS7pC","user":{"login":"kengtin","id":6764990,"node_id":"MDQ6VXNlcjY3NjQ5OTA=","avatar_url":"https://avatars.githubusercontent.com/u/6764990?v=4","gravatar_id":"","url":"https://api.github.com/users/kengtin","html_url":"https://github.com/kengtin","followers_url":"https://api.github.com/users/kengtin/followers","following_url":"https://api.github.com/users/kengtin/following{/other_user}","gists_url":"https://api.github.com/users/kengtin/gists{/gist_id}","starred_url":"https://api.github.com/users/kengtin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kengtin/subscriptions","organizations_url":"https://api.github.com/users/kengtin/orgs","repos_url":"https://api.github.com/users/kengtin/repos","events_url":"https://api.github.com/users/kengtin/events{/privacy}","received_events_url":"https://api.github.com/users/kengtin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T17:27:23Z","updated_at":"2023-08-17T17:27:23Z","author_association":"CONTRIBUTOR","body":"Yes @stevenzwu I verified no differences via (added to the description too):\r\n```\r\ngit diff --no-index  flink/v1.16/flink/src/main/java/org/apache/iceberg/flink/ flink/v1.15/flink/src/main/java/org/apache/iceberg/flink/\r\ngit diff --no-index  flink/v1.16/flink/src/main/java/org/apache/iceberg/flink/ flink/v1.17/flink/src/main/java/org/apache/iceberg/flink/```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1682684482/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1682734303","html_url":"https://github.com/apache/iceberg/pull/8346#issuecomment-1682734303","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8346","id":1682734303,"node_id":"IC_kwDOCW7NX85kTHzf","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T18:04:06Z","updated_at":"2023-08-17T18:04:06Z","author_association":"CONTRIBUTOR","body":"cc @RussellSpitzer @szehon-ho @flyrain @nastra @advancedxy ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1682734303/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683095257","html_url":"https://github.com/apache/iceberg/pull/8341#issuecomment-1683095257","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8341","id":1683095257,"node_id":"IC_kwDOCW7NX85kUf7Z","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-17T23:12:43Z","updated_at":"2023-08-17T23:12:43Z","author_association":"CONTRIBUTOR","body":"Thanks, @dacort!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683095257/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683139432","html_url":"https://github.com/apache/iceberg/issues/6871#issuecomment-1683139432","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6871","id":1683139432,"node_id":"IC_kwDOCW7NX85kUqto","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-08-18T00:10:06Z","updated_at":"2023-08-18T00:10:06Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683139432/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683254461","html_url":"https://github.com/apache/iceberg/pull/8154#issuecomment-1683254461","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8154","id":1683254461,"node_id":"IC_kwDOCW7NX85kVGy9","user":{"login":"gegef2009","id":5651777,"node_id":"MDQ6VXNlcjU2NTE3Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5651777?v=4","gravatar_id":"","url":"https://api.github.com/users/gegef2009","html_url":"https://github.com/gegef2009","followers_url":"https://api.github.com/users/gegef2009/followers","following_url":"https://api.github.com/users/gegef2009/following{/other_user}","gists_url":"https://api.github.com/users/gegef2009/gists{/gist_id}","starred_url":"https://api.github.com/users/gegef2009/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gegef2009/subscriptions","organizations_url":"https://api.github.com/users/gegef2009/orgs","repos_url":"https://api.github.com/users/gegef2009/repos","events_url":"https://api.github.com/users/gegef2009/events{/privacy}","received_events_url":"https://api.github.com/users/gegef2009/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-18T02:39:09Z","updated_at":"2023-08-18T02:39:09Z","author_association":"CONTRIBUTOR","body":"hi @nastra  I added a spotlessApply","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683254461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683435824","html_url":"https://github.com/apache/iceberg/issues/8333#issuecomment-1683435824","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8333","id":1683435824,"node_id":"IC_kwDOCW7NX85kVzEw","user":{"login":"chandu-1101","id":138012432,"node_id":"U_kgDOCDnnEA","avatar_url":"https://avatars.githubusercontent.com/u/138012432?v=4","gravatar_id":"","url":"https://api.github.com/users/chandu-1101","html_url":"https://github.com/chandu-1101","followers_url":"https://api.github.com/users/chandu-1101/followers","following_url":"https://api.github.com/users/chandu-1101/following{/other_user}","gists_url":"https://api.github.com/users/chandu-1101/gists{/gist_id}","starred_url":"https://api.github.com/users/chandu-1101/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chandu-1101/subscriptions","organizations_url":"https://api.github.com/users/chandu-1101/orgs","repos_url":"https://api.github.com/users/chandu-1101/repos","events_url":"https://api.github.com/users/chandu-1101/events{/privacy}","received_events_url":"https://api.github.com/users/chandu-1101/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-18T06:49:53Z","updated_at":"2023-08-18T08:52:02Z","author_association":"NONE","body":"I am trying to understand the schema issue. \r\n\r\nWe first generate parquet files from Mongo. we prepare the dataframe on these parquet files, get schema, and give it to the dataframe created over CDC -`.json` files. So essentially it's the same schema with CDC, parquet.  The same schema used to generate parquet , which was inturn used to write to iceberg was used to write cdc to iceberg\r\n\r\nI reran the test, got the schema from the Iceberg and Parquet files. I couldn't find a reference to `long` in the schema files-- exception was `Caused by: java.lang.ClassCastException: org.apache.spark.unsafe.types.UTF8String cannot be cast to java.lang.Long.`\r\n\r\nThe merge ran for some 30min ~377 tasks/ ~900 tasks ran successfully.  Given that it ran for a while, can it still be a schema issue? I am trying to understand.\r\n\r\n[iceberg-schema.txt](https://github.com/apache/iceberg/files/12376279/iceberg-schema.txt)\r\n\r\n[snapshot-schema.txt](https://github.com/apache/iceberg/files/12376286/snapshot-schema.txt) --Generated from the dataframe over the set of input partitioned parquet files. \r\n[cdc-schema.txt](https://github.com/apache/iceberg/files/12377427/cdc-schema.txt)\r\n\r\n\r\n\r\nI suspect a bad row in the JSON. and tried to remove it as follows. But this also didn't work. \r\n\r\n```\r\n    val cdcDf = sess.read .schema(snapshotDf.schema) .option(\"mode\",\"PERMISSIVE\") .option(\"dateformat\",\"yyyy-MM-dd\") .option(\"badRecordsPath\",\"s3://bucket/inputs2/bad-records/\").json(\"s3://bucket/inputs2/x11-partitioned/\")\r\n    cdcDf.createOrReplaceTempView(\"cdc\")\r\n\r\n    sess.sql(\"\"\" MERGE INTO x11 t \r\n                using ( \r\n                        select * \r\n                        from cdc )u \r\n                on t._id.oid = u._id.oid \r\n                  when matched then update set * \r\n                  when not matched then insert * \"\"\")\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683435824/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683508854","html_url":"https://github.com/apache/iceberg/issues/8333#issuecomment-1683508854","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8333","id":1683508854,"node_id":"IC_kwDOCW7NX85kWE52","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-18T07:48:46Z","updated_at":"2023-08-18T07:48:46Z","author_association":"CONTRIBUTOR","body":"As @RussellSpitzer mentioned above, I would try and look at the schema produced by the data frames","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683508854/reactions","total_count":4,"+1":0,"-1":4,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683571377","html_url":"https://github.com/apache/iceberg/issues/8347#issuecomment-1683571377","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8347","id":1683571377,"node_id":"IC_kwDOCW7NX85kWUKx","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-18T08:41:21Z","updated_at":"2023-08-18T08:41:21Z","author_association":"CONTRIBUTOR","body":"For glue you could try and specify the [client.credentials-provider](https://github.com/apache/iceberg/blob/master/aws/src/main/java/org/apache/iceberg/aws/AwsClientProperties.java#L52). However, I see that you specified a bunch of S3-related **table properties**, which is wrong. Those aren't used in any way.\r\n\r\nYou need to pass them when creating the catalog, meaning that you need to set **catalog properties** instead of **table properties**. See https://iceberg.apache.org/docs/latest/flink-configuration/#catalog-configuration.\r\n\r\nGiven that you want to use `S3FileIO`, you'd set only the ones that exist in https://github.com/apache/iceberg/blob/master/aws/src/main/java/org/apache/iceberg/aws/s3/S3FileIOProperties.java#L43. In your case that would most likely be `s3.access-key-id` / `s3.secret-access-key` / `s3.path-style-access` / `s3.endpoint`.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683571377/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683689147","html_url":"https://github.com/apache/iceberg/pull/8154#issuecomment-1683689147","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8154","id":1683689147,"node_id":"IC_kwDOCW7NX85kWw67","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-18T10:13:55Z","updated_at":"2023-08-18T10:13:55Z","author_association":"CONTRIBUTOR","body":"Thanks @gegef2009 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683689147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683714428","html_url":"https://github.com/apache/iceberg/issues/8333#issuecomment-1683714428","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8333","id":1683714428,"node_id":"IC_kwDOCW7NX85kW3F8","user":{"login":"chandu-1101","id":138012432,"node_id":"U_kgDOCDnnEA","avatar_url":"https://avatars.githubusercontent.com/u/138012432?v=4","gravatar_id":"","url":"https://api.github.com/users/chandu-1101","html_url":"https://github.com/chandu-1101","followers_url":"https://api.github.com/users/chandu-1101/followers","following_url":"https://api.github.com/users/chandu-1101/following{/other_user}","gists_url":"https://api.github.com/users/chandu-1101/gists{/gist_id}","starred_url":"https://api.github.com/users/chandu-1101/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chandu-1101/subscriptions","organizations_url":"https://api.github.com/users/chandu-1101/orgs","repos_url":"https://api.github.com/users/chandu-1101/repos","events_url":"https://api.github.com/users/chandu-1101/events{/privacy}","received_events_url":"https://api.github.com/users/chandu-1101/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-18T10:36:29Z","updated_at":"2023-08-18T10:36:29Z","author_association":"NONE","body":"I checked the schemas and there is no datatype called long in it. The schemas match perfectly. The same were also shared previously. \r\n\r\nTo narrow down the issue i tried the below and see that the issue comes in when there is `update` in the sql statement. Even if I try to update only 1 string column i still get the `ClassCastException`\r\n\r\nIf i change the merge query to the below then all is good. I tried this by running with out the limit. Stil it worked good. The schemas of the `select .. limit 100` match with the schema of `x11`.\r\n\r\n```\r\nsess.sql(\"\"\" MERGE INTO x11  t \r\n                 using ( select * from cdc limit 100)  u \r\n                 on t.cdc_oid = u.cdc_oid \r\n\r\n                   when not matched then insert * \"\"\")\r\n```\r\n\r\nBut if i change the same to below\r\n\r\n```\r\nsess.sql(\"\"\" MERGE INTO x11 t \r\n                 using ( select * from cdc limit 100)  u \r\n                 on t.cdc_oid = u.cdc_oid\r\n                   when matched then update set t.cdc_pk = '' \r\n                   when not matched then insert * \"\"\")\r\n\r\n```\r\n\r\nThen the merge fails with an exception (`Caused by: java.lang.ClassCastException: org.apache.spark.unsafe.types.UTF8String cannot be cast to java.lang.Long`)\r\n\r\n\r\nWhen i compare the schemas of `cdc_oid` for both x11 and cdc they are both string-s. \r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683714428/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683725234","html_url":"https://github.com/apache/iceberg/issues/7137#issuecomment-1683725234","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7137","id":1683725234,"node_id":"IC_kwDOCW7NX85kW5uy","user":{"login":"marvin-roesch","id":4181659,"node_id":"MDQ6VXNlcjQxODE2NTk=","avatar_url":"https://avatars.githubusercontent.com/u/4181659?v=4","gravatar_id":"","url":"https://api.github.com/users/marvin-roesch","html_url":"https://github.com/marvin-roesch","followers_url":"https://api.github.com/users/marvin-roesch/followers","following_url":"https://api.github.com/users/marvin-roesch/following{/other_user}","gists_url":"https://api.github.com/users/marvin-roesch/gists{/gist_id}","starred_url":"https://api.github.com/users/marvin-roesch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marvin-roesch/subscriptions","organizations_url":"https://api.github.com/users/marvin-roesch/orgs","repos_url":"https://api.github.com/users/marvin-roesch/repos","events_url":"https://api.github.com/users/marvin-roesch/events{/privacy}","received_events_url":"https://api.github.com/users/marvin-roesch/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-18T10:45:34Z","updated_at":"2023-08-18T10:45:34Z","author_association":"NONE","body":"I can confirm that we are experiencing the same issue when inserting records into an Iceberg table using Trino. A commit might fail and will leave the metadata for the table in a bad state, resulting in any subsequent actions to fail as well.\r\n\r\nUsing Trino version 422.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683725234/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683818892","html_url":"https://github.com/apache/iceberg/pull/8227#issuecomment-1683818892","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8227","id":1683818892,"node_id":"IC_kwDOCW7NX85kXQmM","user":{"login":"tomtongue","id":43331405,"node_id":"MDQ6VXNlcjQzMzMxNDA1","avatar_url":"https://avatars.githubusercontent.com/u/43331405?v=4","gravatar_id":"","url":"https://api.github.com/users/tomtongue","html_url":"https://github.com/tomtongue","followers_url":"https://api.github.com/users/tomtongue/followers","following_url":"https://api.github.com/users/tomtongue/following{/other_user}","gists_url":"https://api.github.com/users/tomtongue/gists{/gist_id}","starred_url":"https://api.github.com/users/tomtongue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomtongue/subscriptions","organizations_url":"https://api.github.com/users/tomtongue/orgs","repos_url":"https://api.github.com/users/tomtongue/repos","events_url":"https://api.github.com/users/tomtongue/events{/privacy}","received_events_url":"https://api.github.com/users/tomtongue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-18T12:03:12Z","updated_at":"2023-08-18T12:03:12Z","author_association":"CONTRIBUTOR","body":"Thanks for the review again! I updated as follows:\r\n* Changing the method name to `backupTableName` (remove `with`)\r\n* Updating the logic of `dropBackup` and `backupTableName`\r\n* Adding the `backup_table_name` parameter description to the `spark-procedure.md`\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683818892/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683937329","html_url":"https://github.com/apache/iceberg/pull/8113#issuecomment-1683937329","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8113","id":1683937329,"node_id":"IC_kwDOCW7NX85kXtgx","user":{"login":"SourabhBadhya","id":42867455,"node_id":"MDQ6VXNlcjQyODY3NDU1","avatar_url":"https://avatars.githubusercontent.com/u/42867455?v=4","gravatar_id":"","url":"https://api.github.com/users/SourabhBadhya","html_url":"https://github.com/SourabhBadhya","followers_url":"https://api.github.com/users/SourabhBadhya/followers","following_url":"https://api.github.com/users/SourabhBadhya/following{/other_user}","gists_url":"https://api.github.com/users/SourabhBadhya/gists{/gist_id}","starred_url":"https://api.github.com/users/SourabhBadhya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SourabhBadhya/subscriptions","organizations_url":"https://api.github.com/users/SourabhBadhya/orgs","repos_url":"https://api.github.com/users/SourabhBadhya/repos","events_url":"https://api.github.com/users/SourabhBadhya/events{/privacy}","received_events_url":"https://api.github.com/users/SourabhBadhya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-18T13:39:29Z","updated_at":"2023-08-18T13:39:29Z","author_association":"CONTRIBUTOR","body":"@rdblue @Fokko Can you please check again and review. From @deniskuzZ comment (thanks Denys for the information), we can see that by default the session timezone used by Hive is the JVM timezone.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683937329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683966161","html_url":"https://github.com/apache/iceberg/issues/8268#issuecomment-1683966161","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8268","id":1683966161,"node_id":"IC_kwDOCW7NX85kX0jR","user":{"login":"manuzhang","id":1191767,"node_id":"MDQ6VXNlcjExOTE3Njc=","avatar_url":"https://avatars.githubusercontent.com/u/1191767?v=4","gravatar_id":"","url":"https://api.github.com/users/manuzhang","html_url":"https://github.com/manuzhang","followers_url":"https://api.github.com/users/manuzhang/followers","following_url":"https://api.github.com/users/manuzhang/following{/other_user}","gists_url":"https://api.github.com/users/manuzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/manuzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manuzhang/subscriptions","organizations_url":"https://api.github.com/users/manuzhang/orgs","repos_url":"https://api.github.com/users/manuzhang/repos","events_url":"https://api.github.com/users/manuzhang/events{/privacy}","received_events_url":"https://api.github.com/users/manuzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-18T14:00:41Z","updated_at":"2023-08-18T14:00:41Z","author_association":"COLLABORATOR","body":"I suggest you to discuss this on dev list for wider audience.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1683966161/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1684045633","html_url":"https://github.com/apache/iceberg/issues/8175#issuecomment-1684045633","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8175","id":1684045633,"node_id":"IC_kwDOCW7NX85kYH9B","user":{"login":"lksvenoy-r7","id":46895578,"node_id":"MDQ6VXNlcjQ2ODk1NTc4","avatar_url":"https://avatars.githubusercontent.com/u/46895578?v=4","gravatar_id":"","url":"https://api.github.com/users/lksvenoy-r7","html_url":"https://github.com/lksvenoy-r7","followers_url":"https://api.github.com/users/lksvenoy-r7/followers","following_url":"https://api.github.com/users/lksvenoy-r7/following{/other_user}","gists_url":"https://api.github.com/users/lksvenoy-r7/gists{/gist_id}","starred_url":"https://api.github.com/users/lksvenoy-r7/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lksvenoy-r7/subscriptions","organizations_url":"https://api.github.com/users/lksvenoy-r7/orgs","repos_url":"https://api.github.com/users/lksvenoy-r7/repos","events_url":"https://api.github.com/users/lksvenoy-r7/events{/privacy}","received_events_url":"https://api.github.com/users/lksvenoy-r7/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-18T14:58:48Z","updated_at":"2023-08-18T14:58:48Z","author_association":"NONE","body":"Oh interesting, thank you @ConeyLiu. I asked in Slack and was told it wasn't possible, so was asked to create a feature request. If this is indeed possible then this isn't a problem of course.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1684045633/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1684175422","html_url":"https://github.com/apache/iceberg/pull/8340#issuecomment-1684175422","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8340","id":1684175422,"node_id":"IC_kwDOCW7NX85kYno-","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-18T16:44:37Z","updated_at":"2023-08-18T16:44:37Z","author_association":"CONTRIBUTOR","body":"@rdblue @nastra @jackye1995 can you help review the change for JDBC bug fix #8321 ?  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1684175422/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1684175657","html_url":"https://github.com/apache/iceberg/issues/8338#issuecomment-1684175657","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8338","id":1684175657,"node_id":"IC_kwDOCW7NX85kYnsp","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-18T16:44:52Z","updated_at":"2023-08-18T16:44:52Z","author_association":"CONTRIBUTOR","body":"Could you please share the full stack trace on when the error happens and the action that you're running when it happens? Also an overview of the `xyz.files` would be helpful","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1684175657/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1684331772","html_url":"https://github.com/apache/iceberg/pull/8202#issuecomment-1684331772","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8202","id":1684331772,"node_id":"IC_kwDOCW7NX85kZNz8","user":{"login":"simhadri-g","id":26441677,"node_id":"MDQ6VXNlcjI2NDQxNjc3","avatar_url":"https://avatars.githubusercontent.com/u/26441677?v=4","gravatar_id":"","url":"https://api.github.com/users/simhadri-g","html_url":"https://github.com/simhadri-g","followers_url":"https://api.github.com/users/simhadri-g/followers","following_url":"https://api.github.com/users/simhadri-g/following{/other_user}","gists_url":"https://api.github.com/users/simhadri-g/gists{/gist_id}","starred_url":"https://api.github.com/users/simhadri-g/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simhadri-g/subscriptions","organizations_url":"https://api.github.com/users/simhadri-g/orgs","repos_url":"https://api.github.com/users/simhadri-g/repos","events_url":"https://api.github.com/users/simhadri-g/events{/privacy}","received_events_url":"https://api.github.com/users/simhadri-g/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-18T19:10:03Z","updated_at":"2023-08-18T19:10:03Z","author_association":"MEMBER","body":"thanks @nastra for the review! :) \r\n\r\n@findepi Could you please have a look as well? \r\nThanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1684331772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1684492115","html_url":"https://github.com/apache/iceberg/pull/8336#issuecomment-1684492115","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8336","id":1684492115,"node_id":"IC_kwDOCW7NX85kZ09T","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-18T22:24:15Z","updated_at":"2023-08-18T22:24:15Z","author_association":"CONTRIBUTOR","body":"@advancedxy @szehon-ho, could you take another look?\r\n\r\nI've changed the approach to use arrays in `OffsetsAwareSplitScanTaskIterator`. We call that part of code for every data file and it kept showing up in flamegrpahs, generating extra overhead. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1684492115/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685136564","html_url":"https://github.com/apache/iceberg/issues/6885#issuecomment-1685136564","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6885","id":1685136564,"node_id":"IC_kwDOCW7NX85kcSS0","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-08-20T00:11:01Z","updated_at":"2023-08-20T00:11:01Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685136564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685136574","html_url":"https://github.com/apache/iceberg/issues/6863#issuecomment-1685136574","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6863","id":1685136574,"node_id":"IC_kwDOCW7NX85kcSS-","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-08-20T00:11:04Z","updated_at":"2023-08-20T00:11:04Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685136574/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685206195","html_url":"https://github.com/apache/iceberg/issues/8190#issuecomment-1685206195","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8190","id":1685206195,"node_id":"IC_kwDOCW7NX85kcjSz","user":{"login":"kassett","id":121340503,"node_id":"U_kgDOBzuCVw","avatar_url":"https://avatars.githubusercontent.com/u/121340503?v=4","gravatar_id":"","url":"https://api.github.com/users/kassett","html_url":"https://github.com/kassett","followers_url":"https://api.github.com/users/kassett/followers","following_url":"https://api.github.com/users/kassett/following{/other_user}","gists_url":"https://api.github.com/users/kassett/gists{/gist_id}","starred_url":"https://api.github.com/users/kassett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kassett/subscriptions","organizations_url":"https://api.github.com/users/kassett/orgs","repos_url":"https://api.github.com/users/kassett/repos","events_url":"https://api.github.com/users/kassett/events{/privacy}","received_events_url":"https://api.github.com/users/kassett/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-20T07:07:07Z","updated_at":"2023-08-20T07:07:07Z","author_association":"NONE","body":"I am also getting a similar issue -- this seems like a pretty serious bug.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685206195/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685354024","html_url":"https://github.com/apache/iceberg/pull/8260#issuecomment-1685354024","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8260","id":1685354024,"node_id":"IC_kwDOCW7NX85kdHYo","user":{"login":"mohitgargk","id":1259955,"node_id":"MDQ6VXNlcjEyNTk5NTU=","avatar_url":"https://avatars.githubusercontent.com/u/1259955?v=4","gravatar_id":"","url":"https://api.github.com/users/mohitgargk","html_url":"https://github.com/mohitgargk","followers_url":"https://api.github.com/users/mohitgargk/followers","following_url":"https://api.github.com/users/mohitgargk/following{/other_user}","gists_url":"https://api.github.com/users/mohitgargk/gists{/gist_id}","starred_url":"https://api.github.com/users/mohitgargk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mohitgargk/subscriptions","organizations_url":"https://api.github.com/users/mohitgargk/orgs","repos_url":"https://api.github.com/users/mohitgargk/repos","events_url":"https://api.github.com/users/mohitgargk/events{/privacy}","received_events_url":"https://api.github.com/users/mohitgargk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-20T17:58:30Z","updated_at":"2023-08-20T17:58:30Z","author_association":"NONE","body":"> does it handle the case where we pointed the data directory somewhere else ?\r\n\r\nYes.\r\n\r\n@manuzhang added the design in the description","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685354024/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685435895","html_url":"https://github.com/apache/iceberg/issues/6897#issuecomment-1685435895","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6897","id":1685435895,"node_id":"IC_kwDOCW7NX85kdbX3","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-08-21T00:10:37Z","updated_at":"2023-08-21T00:10:37Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685435895/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685435906","html_url":"https://github.com/apache/iceberg/issues/6896#issuecomment-1685435906","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6896","id":1685435906,"node_id":"IC_kwDOCW7NX85kdbYC","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-08-21T00:10:38Z","updated_at":"2023-08-21T00:10:38Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685435906/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685435922","html_url":"https://github.com/apache/iceberg/issues/6891#issuecomment-1685435922","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6891","id":1685435922,"node_id":"IC_kwDOCW7NX85kdbYS","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-08-21T00:10:40Z","updated_at":"2023-08-21T00:10:40Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685435922/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685435930","html_url":"https://github.com/apache/iceberg/issues/6890#issuecomment-1685435930","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6890","id":1685435930,"node_id":"IC_kwDOCW7NX85kdbYa","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-08-21T00:10:42Z","updated_at":"2023-08-21T00:10:42Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685435930/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685435946","html_url":"https://github.com/apache/iceberg/issues/6865#issuecomment-1685435946","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6865","id":1685435946,"node_id":"IC_kwDOCW7NX85kdbYq","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-08-21T00:10:45Z","updated_at":"2023-08-21T00:10:45Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685435946/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685611555","html_url":"https://github.com/apache/iceberg/pull/8260#issuecomment-1685611555","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8260","id":1685611555,"node_id":"IC_kwDOCW7NX85keGQj","user":{"login":"manuzhang","id":1191767,"node_id":"MDQ6VXNlcjExOTE3Njc=","avatar_url":"https://avatars.githubusercontent.com/u/1191767?v=4","gravatar_id":"","url":"https://api.github.com/users/manuzhang","html_url":"https://github.com/manuzhang","followers_url":"https://api.github.com/users/manuzhang/followers","following_url":"https://api.github.com/users/manuzhang/following{/other_user}","gists_url":"https://api.github.com/users/manuzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/manuzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manuzhang/subscriptions","organizations_url":"https://api.github.com/users/manuzhang/orgs","repos_url":"https://api.github.com/users/manuzhang/repos","events_url":"https://api.github.com/users/manuzhang/events{/privacy}","received_events_url":"https://api.github.com/users/manuzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-21T04:11:00Z","updated_at":"2023-08-21T04:11:00Z","author_association":"COLLABORATOR","body":"@mohitgargk you may send the design doc to dev list for review.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685611555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685717985","html_url":"https://github.com/apache/iceberg/issues/8333#issuecomment-1685717985","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8333","id":1685717985,"node_id":"IC_kwDOCW7NX85kegPh","user":{"login":"chandu-1101","id":138012432,"node_id":"U_kgDOCDnnEA","avatar_url":"https://avatars.githubusercontent.com/u/138012432?v=4","gravatar_id":"","url":"https://api.github.com/users/chandu-1101","html_url":"https://github.com/chandu-1101","followers_url":"https://api.github.com/users/chandu-1101/followers","following_url":"https://api.github.com/users/chandu-1101/following{/other_user}","gists_url":"https://api.github.com/users/chandu-1101/gists{/gist_id}","starred_url":"https://api.github.com/users/chandu-1101/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chandu-1101/subscriptions","organizations_url":"https://api.github.com/users/chandu-1101/orgs","repos_url":"https://api.github.com/users/chandu-1101/repos","events_url":"https://api.github.com/users/chandu-1101/events{/privacy}","received_events_url":"https://api.github.com/users/chandu-1101/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-21T06:19:30Z","updated_at":"2023-08-21T06:19:30Z","author_association":"NONE","body":"any thoughts? @nastra  @RussellSpitzer the schema looks good. They match. None of them have datatype `long` in them, yet the issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685717985/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685831892","html_url":"https://github.com/apache/iceberg/pull/8345#issuecomment-1685831892","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8345","id":1685831892,"node_id":"IC_kwDOCW7NX85ke8DU","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-21T07:54:01Z","updated_at":"2023-08-21T07:54:01Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing @bitsondatadev and @dramaticlly ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1685831892/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1686020265","html_url":"https://github.com/apache/iceberg/issues/8347#issuecomment-1686020265","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8347","id":1686020265,"node_id":"IC_kwDOCW7NX85kfqCp","user":{"login":"xiaowujee","id":26532548,"node_id":"MDQ6VXNlcjI2NTMyNTQ4","avatar_url":"https://avatars.githubusercontent.com/u/26532548?v=4","gravatar_id":"","url":"https://api.github.com/users/xiaowujee","html_url":"https://github.com/xiaowujee","followers_url":"https://api.github.com/users/xiaowujee/followers","following_url":"https://api.github.com/users/xiaowujee/following{/other_user}","gists_url":"https://api.github.com/users/xiaowujee/gists{/gist_id}","starred_url":"https://api.github.com/users/xiaowujee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiaowujee/subscriptions","organizations_url":"https://api.github.com/users/xiaowujee/orgs","repos_url":"https://api.github.com/users/xiaowujee/repos","events_url":"https://api.github.com/users/xiaowujee/events{/privacy}","received_events_url":"https://api.github.com/users/xiaowujee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-21T09:56:37Z","updated_at":"2023-08-21T09:56:37Z","author_association":"NONE","body":"I also want to use it this way. Can you provide a complete example.    \r\nMy exampleï¼š\r\n```\r\nCREATE CATALOG hadoop_catalog WITH (\r\n    'type'='iceberg',\r\n    'warehouse'='s3://flink194/hive/data',\r\n    'catalog-impl'='org.apache.iceberg.aws.glue.GlueCatalog',\r\n    'io-impl'='org.apache.iceberg.aws.s3.S3FileIO',\r\n    's3.client-factory-impl'='org.apache.iceberg.aws.s3.DefaultS3FileIOAwsClientFactory',\r\n    's3.access-key-id'='minio',\r\n    's3.secret-access-key'='minio123',\r\n    's3.endpoint'='http://minio:9000',\r\n    's3.path-style-access'='true',\r\n    'client.region'='us-east-1'\r\n);\r\nCREATE TABLE `hadoop_catalog`.`default`.`test`\r\n(\r\n    id   BIGINT COMMENT 'unique id',\r\n    data STRING\r\n);\r\n```\r\nHowever, error prompts\r\n```\r\n[ERROR] Could not execute SQL statement. Reason:\r\nsoftware.amazon.awssdk.core.exception.SdkClientException: Unable to load credentials from any of the providers in the chain AwsCredentialsProviderChain(credentialsProviders=[SystemPropertyCredentialsProvider(), EnvironmentVariableCredentialsProvider(), WebIdentityTokenCredentialsProvider(), ProfileCredentialsProvider(profileName=default, profileFile=ProfileFile(profilesAndSectionsMap=[])), ContainerCredentialsProvider(), InstanceProfileCredentialsProvider()]) : [SystemPropertyCredentialsProvider(): Unable to load credentials from system settings. Access key must be specified either via environment variable (AWS_ACCESS_KEY_ID) or system property (aws.accessKeyId)., EnvironmentVariableCredentialsProvider(): Unable to load credentials from system settings. Access key must be specified either via environment variable (AWS_ACCESS_KEY_ID) or system property (aws.accessKeyId)., WebIdentityTokenCredentialsProvider(): Either the environment variable AWS_WEB_IDENTITY_TOKEN_FILE or the javaproperty aws.webIdentityTokenFile must be set., ProfileCredentialsProvider(profileName=default, profileFile=ProfileFile(profilesAndSectionsMap=[])): Profile file contained no credentials for profile 'default': ProfileFile(profilesAndSectionsMap=[]), ContainerCredentialsProvider(): Cannot fetch credentials from container - neither AWS_CONTAINER_CREDENTIALS_FULL_URI or AWS_CONTAINER_CREDENTIALS_RELATIVE_URI environment variables are set., InstanceProfileCredentialsProvider(): Failed to load credentials from IMDS.]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1686020265/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1686119510","html_url":"https://github.com/apache/iceberg/pull/8065#issuecomment-1686119510","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8065","id":1686119510,"node_id":"IC_kwDOCW7NX85kgCRW","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-21T11:04:46Z","updated_at":"2023-08-21T11:04:46Z","author_association":"MEMBER","body":"> Shouldn't we be producing a listing for each module with it's dependencies?\r\n\r\nBOMs contain the \"matching\" project artifacts, but not the transitive dependencies. It would not work though - think: different Spark/Flink versions.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1686119510/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1686432063","html_url":"https://github.com/apache/iceberg/issues/8343#issuecomment-1686432063","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8343","id":1686432063,"node_id":"IC_kwDOCW7NX85khOk_","user":{"login":"baptistegh","id":22121816,"node_id":"MDQ6VXNlcjIyMTIxODE2","avatar_url":"https://avatars.githubusercontent.com/u/22121816?v=4","gravatar_id":"","url":"https://api.github.com/users/baptistegh","html_url":"https://github.com/baptistegh","followers_url":"https://api.github.com/users/baptistegh/followers","following_url":"https://api.github.com/users/baptistegh/following{/other_user}","gists_url":"https://api.github.com/users/baptistegh/gists{/gist_id}","starred_url":"https://api.github.com/users/baptistegh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baptistegh/subscriptions","organizations_url":"https://api.github.com/users/baptistegh/orgs","repos_url":"https://api.github.com/users/baptistegh/repos","events_url":"https://api.github.com/users/baptistegh/events{/privacy}","received_events_url":"https://api.github.com/users/baptistegh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-21T14:23:03Z","updated_at":"2023-08-21T14:23:03Z","author_association":"NONE","body":"I have the exact same issue for my unit tests under Spark 3.4 / Iceberg 1.3. Everything works well but those `CALL` calls or `ALTER TABLE ... ADD|DROP PARTITION FIELD ... `\r\nBut the `spark.sql.extensions` is correctly set as described by @pulkit-cldcvr .","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1686432063/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1686563466","html_url":"https://github.com/apache/iceberg/pull/8177#issuecomment-1686563466","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8177","id":1686563466,"node_id":"IC_kwDOCW7NX85khuqK","user":{"login":"mderoy","id":1040009,"node_id":"MDQ6VXNlcjEwNDAwMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1040009?v=4","gravatar_id":"","url":"https://api.github.com/users/mderoy","html_url":"https://github.com/mderoy","followers_url":"https://api.github.com/users/mderoy/followers","following_url":"https://api.github.com/users/mderoy/following{/other_user}","gists_url":"https://api.github.com/users/mderoy/gists{/gist_id}","starred_url":"https://api.github.com/users/mderoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mderoy/subscriptions","organizations_url":"https://api.github.com/users/mderoy/orgs","repos_url":"https://api.github.com/users/mderoy/repos","events_url":"https://api.github.com/users/mderoy/events{/privacy}","received_events_url":"https://api.github.com/users/mderoy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-21T15:36:49Z","updated_at":"2023-08-21T15:36:49Z","author_association":"CONTRIBUTOR","body":"@nastra I added a new case insensitive test which covers both projection and filtering, but let me know if you'd like me to just put a filter scenario in those tests instead :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1686563466/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1686574328","html_url":"https://github.com/apache/iceberg/pull/8177#issuecomment-1686574328","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8177","id":1686574328,"node_id":"IC_kwDOCW7NX85khxT4","user":{"login":"mderoy","id":1040009,"node_id":"MDQ6VXNlcjEwNDAwMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1040009?v=4","gravatar_id":"","url":"https://api.github.com/users/mderoy","html_url":"https://github.com/mderoy","followers_url":"https://api.github.com/users/mderoy/followers","following_url":"https://api.github.com/users/mderoy/following{/other_user}","gists_url":"https://api.github.com/users/mderoy/gists{/gist_id}","starred_url":"https://api.github.com/users/mderoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mderoy/subscriptions","organizations_url":"https://api.github.com/users/mderoy/orgs","repos_url":"https://api.github.com/users/mderoy/repos","events_url":"https://api.github.com/users/mderoy/events{/privacy}","received_events_url":"https://api.github.com/users/mderoy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-21T15:43:18Z","updated_at":"2023-08-21T15:54:44Z","author_association":"CONTRIBUTOR","body":"There are formatting failures, and after some thought, I think I do prefer moving the caseinsensitive scenarios into the existing test cases for filtering and projection. I'll fix those now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1686574328/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1686720842","html_url":"https://github.com/apache/iceberg/pull/8177#issuecomment-1686720842","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8177","id":1686720842,"node_id":"IC_kwDOCW7NX85kiVFK","user":{"login":"mderoy","id":1040009,"node_id":"MDQ6VXNlcjEwNDAwMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1040009?v=4","gravatar_id":"","url":"https://api.github.com/users/mderoy","html_url":"https://github.com/mderoy","followers_url":"https://api.github.com/users/mderoy/followers","following_url":"https://api.github.com/users/mderoy/following{/other_user}","gists_url":"https://api.github.com/users/mderoy/gists{/gist_id}","starred_url":"https://api.github.com/users/mderoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mderoy/subscriptions","organizations_url":"https://api.github.com/users/mderoy/orgs","repos_url":"https://api.github.com/users/mderoy/repos","events_url":"https://api.github.com/users/mderoy/events{/privacy}","received_events_url":"https://api.github.com/users/mderoy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-21T17:11:37Z","updated_at":"2023-08-21T17:11:37Z","author_association":"CONTRIBUTOR","body":"ready for re-review :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1686720842/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1686968485","html_url":"https://github.com/apache/iceberg/pull/8336#issuecomment-1686968485","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8336","id":1686968485,"node_id":"IC_kwDOCW7NX85kjRil","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-21T20:06:36Z","updated_at":"2023-08-21T20:06:36Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @advancedxy @szehon-ho @jerqi! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1686968485/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1686976705","html_url":"https://github.com/apache/iceberg/pull/8042#issuecomment-1686976705","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8042","id":1686976705,"node_id":"IC_kwDOCW7NX85kjTjB","user":{"login":"namrathamyske","id":17932873,"node_id":"MDQ6VXNlcjE3OTMyODcz","avatar_url":"https://avatars.githubusercontent.com/u/17932873?v=4","gravatar_id":"","url":"https://api.github.com/users/namrathamyske","html_url":"https://github.com/namrathamyske","followers_url":"https://api.github.com/users/namrathamyske/followers","following_url":"https://api.github.com/users/namrathamyske/following{/other_user}","gists_url":"https://api.github.com/users/namrathamyske/gists{/gist_id}","starred_url":"https://api.github.com/users/namrathamyske/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/namrathamyske/subscriptions","organizations_url":"https://api.github.com/users/namrathamyske/orgs","repos_url":"https://api.github.com/users/namrathamyske/repos","events_url":"https://api.github.com/users/namrathamyske/events{/privacy}","received_events_url":"https://api.github.com/users/namrathamyske/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-21T20:11:56Z","updated_at":"2023-08-21T20:11:56Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer @aokolnychyi addressed the comments. Pls give this another look","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1686976705/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]