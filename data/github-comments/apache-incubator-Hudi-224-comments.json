[{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1100731242","html_url":"https://github.com/apache/hudi/issues/5198#issuecomment-1100731242","issue_url":"https://api.github.com/repos/apache/hudi/issues/5198","id":1100731242,"node_id":"IC_kwDOBI7nWM5Bm9Nq","user":{"login":"babumahesh-koo","id":88309485,"node_id":"MDQ6VXNlcjg4MzA5NDg1","avatar_url":"https://avatars.githubusercontent.com/u/88309485?v=4","gravatar_id":"","url":"https://api.github.com/users/babumahesh-koo","html_url":"https://github.com/babumahesh-koo","followers_url":"https://api.github.com/users/babumahesh-koo/followers","following_url":"https://api.github.com/users/babumahesh-koo/following{/other_user}","gists_url":"https://api.github.com/users/babumahesh-koo/gists{/gist_id}","starred_url":"https://api.github.com/users/babumahesh-koo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/babumahesh-koo/subscriptions","organizations_url":"https://api.github.com/users/babumahesh-koo/orgs","repos_url":"https://api.github.com/users/babumahesh-koo/repos","events_url":"https://api.github.com/users/babumahesh-koo/events{/privacy}","received_events_url":"https://api.github.com/users/babumahesh-koo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-16T18:47:47Z","updated_at":"2022-04-16T18:47:47Z","author_association":"NONE","body":"@nsivabalan Without Timestamp based key gen, it works. \r\n\r\nThe observation is that, as long as the extracted values data types are matching with original column data type it works.\r\n\r\nHave tried the same thing with SQL based transformers, my usecase is solved with transformers. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1100731242/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1100803165","html_url":"https://github.com/apache/hudi/issues/5313#issuecomment-1100803165","issue_url":"https://api.github.com/repos/apache/hudi/issues/5313","id":1100803165,"node_id":"IC_kwDOBI7nWM5BnOxd","user":{"login":"simonsssu","id":12323514,"node_id":"MDQ6VXNlcjEyMzIzNTE0","avatar_url":"https://avatars.githubusercontent.com/u/12323514?v=4","gravatar_id":"","url":"https://api.github.com/users/simonsssu","html_url":"https://github.com/simonsssu","followers_url":"https://api.github.com/users/simonsssu/followers","following_url":"https://api.github.com/users/simonsssu/following{/other_user}","gists_url":"https://api.github.com/users/simonsssu/gists{/gist_id}","starred_url":"https://api.github.com/users/simonsssu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simonsssu/subscriptions","organizations_url":"https://api.github.com/users/simonsssu/orgs","repos_url":"https://api.github.com/users/simonsssu/repos","events_url":"https://api.github.com/users/simonsssu/events{/privacy}","received_events_url":"https://api.github.com/users/simonsssu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-17T04:50:22Z","updated_at":"2022-04-17T04:50:22Z","author_association":"CONTRIBUTOR","body":"@nsivabalan hi nsivabalan, my jira id is HUDI-3877, thanks.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1100803165/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1100836274","html_url":"https://github.com/apache/hudi/issues/5327#issuecomment-1100836274","issue_url":"https://api.github.com/repos/apache/hudi/issues/5327","id":1100836274,"node_id":"IC_kwDOBI7nWM5BnW2y","user":{"login":"CodeCooker17","id":64473732,"node_id":"MDQ6VXNlcjY0NDczNzMy","avatar_url":"https://avatars.githubusercontent.com/u/64473732?v=4","gravatar_id":"","url":"https://api.github.com/users/CodeCooker17","html_url":"https://github.com/CodeCooker17","followers_url":"https://api.github.com/users/CodeCooker17/followers","following_url":"https://api.github.com/users/CodeCooker17/following{/other_user}","gists_url":"https://api.github.com/users/CodeCooker17/gists{/gist_id}","starred_url":"https://api.github.com/users/CodeCooker17/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodeCooker17/subscriptions","organizations_url":"https://api.github.com/users/CodeCooker17/orgs","repos_url":"https://api.github.com/users/CodeCooker17/repos","events_url":"https://api.github.com/users/CodeCooker17/events{/privacy}","received_events_url":"https://api.github.com/users/CodeCooker17/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-17T09:05:33Z","updated_at":"2022-04-17T09:05:33Z","author_association":"CONTRIBUTOR","body":"> \r\nThank you. I have created an issue: https://issues.apache.org/jira/projects/HUDI/issues/HUDI-3898?filter=allissues","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1100836274/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1100862213","html_url":"https://github.com/apache/hudi/pull/5333#issuecomment-1100862213","issue_url":"https://api.github.com/repos/apache/hudi/issues/5333","id":1100862213,"node_id":"IC_kwDOBI7nWM5BndMF","user":{"login":"XuQianJin-Stars","id":10494131,"node_id":"MDQ6VXNlcjEwNDk0MTMx","avatar_url":"https://avatars.githubusercontent.com/u/10494131?v=4","gravatar_id":"","url":"https://api.github.com/users/XuQianJin-Stars","html_url":"https://github.com/XuQianJin-Stars","followers_url":"https://api.github.com/users/XuQianJin-Stars/followers","following_url":"https://api.github.com/users/XuQianJin-Stars/following{/other_user}","gists_url":"https://api.github.com/users/XuQianJin-Stars/gists{/gist_id}","starred_url":"https://api.github.com/users/XuQianJin-Stars/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XuQianJin-Stars/subscriptions","organizations_url":"https://api.github.com/users/XuQianJin-Stars/orgs","repos_url":"https://api.github.com/users/XuQianJin-Stars/repos","events_url":"https://api.github.com/users/XuQianJin-Stars/events{/privacy}","received_events_url":"https://api.github.com/users/XuQianJin-Stars/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-17T12:02:47Z","updated_at":"2022-04-17T12:02:47Z","author_association":"CONTRIBUTOR","body":"hi @bhasudha have you verified it locally? LGTM","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1100862213/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1100885230","html_url":"https://github.com/apache/hudi/issues/5326#issuecomment-1100885230","issue_url":"https://api.github.com/repos/apache/hudi/issues/5326","id":1100885230,"node_id":"IC_kwDOBI7nWM5Bnizu","user":{"login":"zxding","id":7269835,"node_id":"MDQ6VXNlcjcyNjk4MzU=","avatar_url":"https://avatars.githubusercontent.com/u/7269835?v=4","gravatar_id":"","url":"https://api.github.com/users/zxding","html_url":"https://github.com/zxding","followers_url":"https://api.github.com/users/zxding/followers","following_url":"https://api.github.com/users/zxding/following{/other_user}","gists_url":"https://api.github.com/users/zxding/gists{/gist_id}","starred_url":"https://api.github.com/users/zxding/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zxding/subscriptions","organizations_url":"https://api.github.com/users/zxding/orgs","repos_url":"https://api.github.com/users/zxding/repos","events_url":"https://api.github.com/users/zxding/events{/privacy}","received_events_url":"https://api.github.com/users/zxding/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-17T14:08:21Z","updated_at":"2022-04-17T14:08:21Z","author_association":"NONE","body":"@nsivabalan Thank you for quick reply , I tried to add a property \"metricsname.prefix\" to make it more flexible for prometheus statistics , but I found that if I did that , the metric lack an tag to distinguish where the metric from , is there any way to archive it ? \r\nIn release 0.10.0 ,I found the \"PushGatewayReporter\"  class use \"DropwizardExports\" collector , the DropwizardExports does not use any additional tags , so is it possible to add another implementation of reporter just like \"simplecollector\" to archive this ?\r\nLook forward to your reply.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1100885230/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1100903354","html_url":"https://github.com/apache/hudi/pull/5339#issuecomment-1100903354","issue_url":"https://api.github.com/repos/apache/hudi/issues/5339","id":1100903354,"node_id":"IC_kwDOBI7nWM5BnnO6","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-17T15:40:24Z","updated_at":"2022-04-17T15:40:24Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"22f107ff1f69cbe2bbdf6c96752f107e5a90e94e\",\n    \"status\" : \"FAILURE\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8088\",\n    \"triggerID\" : \"22f107ff1f69cbe2bbdf6c96752f107e5a90e94e\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"22f107ff1f69cbe2bbdf6c96752f107e5a90e94e\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8090\",\n    \"triggerID\" : \"1100887116\",\n    \"triggerType\" : \"MANUAL\"\n  } ]\n}-->\n## CI report:\n\n* 22f107ff1f69cbe2bbdf6c96752f107e5a90e94e Azure: [FAILURE](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8088) Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8090) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1100903354/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101047075","html_url":"https://github.com/apache/hudi/pull/5057#issuecomment-1101047075","issue_url":"https://api.github.com/repos/apache/hudi/issues/5057","id":1101047075,"node_id":"IC_kwDOBI7nWM5BoKUj","user":{"login":"JerryYue-M","id":10253313,"node_id":"MDQ6VXNlcjEwMjUzMzEz","avatar_url":"https://avatars.githubusercontent.com/u/10253313?v=4","gravatar_id":"","url":"https://api.github.com/users/JerryYue-M","html_url":"https://github.com/JerryYue-M","followers_url":"https://api.github.com/users/JerryYue-M/followers","following_url":"https://api.github.com/users/JerryYue-M/following{/other_user}","gists_url":"https://api.github.com/users/JerryYue-M/gists{/gist_id}","starred_url":"https://api.github.com/users/JerryYue-M/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JerryYue-M/subscriptions","organizations_url":"https://api.github.com/users/JerryYue-M/orgs","repos_url":"https://api.github.com/users/JerryYue-M/repos","events_url":"https://api.github.com/users/JerryYue-M/events{/privacy}","received_events_url":"https://api.github.com/users/JerryYue-M/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T03:05:36Z","updated_at":"2022-04-18T03:05:36Z","author_association":"CONTRIBUTOR","body":"> @JerryYue-M You may need to rebase the code with latest master, would take a look soon ~\r\n\r\n@nsivabalan @danny0405 ok， I will rebase based on the latest master","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101047075/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101058375","html_url":"https://github.com/apache/hudi/pull/5185#issuecomment-1101058375","issue_url":"https://api.github.com/repos/apache/hudi/issues/5185","id":1101058375,"node_id":"IC_kwDOBI7nWM5BoNFH","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T03:29:55Z","updated_at":"2022-04-18T03:29:55Z","author_association":"CONTRIBUTOR","body":"Hello @wxplovecc Can you fix the checkstyle for building ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101058375/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101059248","html_url":"https://github.com/apache/hudi/issues/5330#issuecomment-1101059248","issue_url":"https://api.github.com/repos/apache/hudi/issues/5330","id":1101059248,"node_id":"IC_kwDOBI7nWM5BoNSw","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T03:32:11Z","updated_at":"2022-04-18T03:32:11Z","author_association":"CONTRIBUTOR","body":"Thanks for the PR @wxplovecc , can you explain why the #5185 patch fixed the bug ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101059248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101117856","html_url":"https://github.com/apache/hudi/issues/5253#issuecomment-1101117856","issue_url":"https://api.github.com/repos/apache/hudi/issues/5253","id":1101117856,"node_id":"IC_kwDOBI7nWM5Bobmg","user":{"login":"njalan","id":8622340,"node_id":"MDQ6VXNlcjg2MjIzNDA=","avatar_url":"https://avatars.githubusercontent.com/u/8622340?v=4","gravatar_id":"","url":"https://api.github.com/users/njalan","html_url":"https://github.com/njalan","followers_url":"https://api.github.com/users/njalan/followers","following_url":"https://api.github.com/users/njalan/following{/other_user}","gists_url":"https://api.github.com/users/njalan/gists{/gist_id}","starred_url":"https://api.github.com/users/njalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/njalan/subscriptions","organizations_url":"https://api.github.com/users/njalan/orgs","repos_url":"https://api.github.com/users/njalan/repos","events_url":"https://api.github.com/users/njalan/events{/privacy}","received_events_url":"https://api.github.com/users/njalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T05:52:47Z","updated_at":"2022-04-18T05:52:47Z","author_association":"NONE","body":"Can anyone take a look at it?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101117856/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101122997","html_url":"https://github.com/apache/hudi/issues/5253#issuecomment-1101122997","issue_url":"https://api.github.com/repos/apache/hudi/issues/5253","id":1101122997,"node_id":"IC_kwDOBI7nWM5Boc21","user":{"login":"XuQianJin-Stars","id":10494131,"node_id":"MDQ6VXNlcjEwNDk0MTMx","avatar_url":"https://avatars.githubusercontent.com/u/10494131?v=4","gravatar_id":"","url":"https://api.github.com/users/XuQianJin-Stars","html_url":"https://github.com/XuQianJin-Stars","followers_url":"https://api.github.com/users/XuQianJin-Stars/followers","following_url":"https://api.github.com/users/XuQianJin-Stars/following{/other_user}","gists_url":"https://api.github.com/users/XuQianJin-Stars/gists{/gist_id}","starred_url":"https://api.github.com/users/XuQianJin-Stars/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XuQianJin-Stars/subscriptions","organizations_url":"https://api.github.com/users/XuQianJin-Stars/orgs","repos_url":"https://api.github.com/users/XuQianJin-Stars/repos","events_url":"https://api.github.com/users/XuQianJin-Stars/events{/privacy}","received_events_url":"https://api.github.com/users/XuQianJin-Stars/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T06:02:06Z","updated_at":"2022-04-18T06:02:06Z","author_association":"CONTRIBUTOR","body":"> Can anyone take a look at it?\r\n\r\nhi @njalan I'll try to track down this issue today.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101122997/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101129900","html_url":"https://github.com/apache/hudi/pull/5177#issuecomment-1101129900","issue_url":"https://api.github.com/repos/apache/hudi/issues/5177","id":1101129900,"node_id":"IC_kwDOBI7nWM5Boeis","user":{"login":"liujinhui1994","id":25769285,"node_id":"MDQ6VXNlcjI1NzY5Mjg1","avatar_url":"https://avatars.githubusercontent.com/u/25769285?v=4","gravatar_id":"","url":"https://api.github.com/users/liujinhui1994","html_url":"https://github.com/liujinhui1994","followers_url":"https://api.github.com/users/liujinhui1994/followers","following_url":"https://api.github.com/users/liujinhui1994/following{/other_user}","gists_url":"https://api.github.com/users/liujinhui1994/gists{/gist_id}","starred_url":"https://api.github.com/users/liujinhui1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liujinhui1994/subscriptions","organizations_url":"https://api.github.com/users/liujinhui1994/orgs","repos_url":"https://api.github.com/users/liujinhui1994/repos","events_url":"https://api.github.com/users/liujinhui1994/events{/privacy}","received_events_url":"https://api.github.com/users/liujinhui1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T06:13:15Z","updated_at":"2022-04-18T06:13:15Z","author_association":"CONTRIBUTOR","body":"There is actually a problem here. I have tried several rounds and roughly found that there is a problem with the unit test assertEquals. This problem will cause the unit test to fail, but the CI status is successful. I haven't found a way to fix it\r\n@nsivabalan  ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101129900/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101132072","html_url":"https://github.com/apache/hudi/pull/5087#issuecomment-1101132072","issue_url":"https://api.github.com/repos/apache/hudi/issues/5087","id":1101132072,"node_id":"IC_kwDOBI7nWM5BofEo","user":{"login":"liujinhui1994","id":25769285,"node_id":"MDQ6VXNlcjI1NzY5Mjg1","avatar_url":"https://avatars.githubusercontent.com/u/25769285?v=4","gravatar_id":"","url":"https://api.github.com/users/liujinhui1994","html_url":"https://github.com/liujinhui1994","followers_url":"https://api.github.com/users/liujinhui1994/followers","following_url":"https://api.github.com/users/liujinhui1994/following{/other_user}","gists_url":"https://api.github.com/users/liujinhui1994/gists{/gist_id}","starred_url":"https://api.github.com/users/liujinhui1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liujinhui1994/subscriptions","organizations_url":"https://api.github.com/users/liujinhui1994/orgs","repos_url":"https://api.github.com/users/liujinhui1994/repos","events_url":"https://api.github.com/users/liujinhui1994/events{/privacy}","received_events_url":"https://api.github.com/users/liujinhui1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T06:16:46Z","updated_at":"2022-04-18T06:16:46Z","author_association":"CONTRIBUTOR","body":"@danny0405 In fact, the main thing is to reduce redundant code","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101132072/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101137515","html_url":"https://github.com/apache/hudi/pull/4718#issuecomment-1101137515","issue_url":"https://api.github.com/repos/apache/hudi/issues/4718","id":1101137515,"node_id":"IC_kwDOBI7nWM5BogZr","user":{"login":"zhangyue19921010","id":69956021,"node_id":"MDQ6VXNlcjY5OTU2MDIx","avatar_url":"https://avatars.githubusercontent.com/u/69956021?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyue19921010","html_url":"https://github.com/zhangyue19921010","followers_url":"https://api.github.com/users/zhangyue19921010/followers","following_url":"https://api.github.com/users/zhangyue19921010/following{/other_user}","gists_url":"https://api.github.com/users/zhangyue19921010/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyue19921010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyue19921010/subscriptions","organizations_url":"https://api.github.com/users/zhangyue19921010/orgs","repos_url":"https://api.github.com/users/zhangyue19921010/repos","events_url":"https://api.github.com/users/zhangyue19921010/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyue19921010/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T06:24:49Z","updated_at":"2022-04-18T06:26:39Z","author_association":"CONTRIBUTOR","body":"Very valuable idea! \r\n\r\nFurther, maybe we can do more interesting things based on this very valuable hudi metastore server, which is beneficial to realize **Hudi Lake Manager** which could decouple hudi ingestion and hudi table service, including cleaner, archival, clustering, compaction and any table services in the feature.\r\n\r\nAnd this lake manager could unify and automatically call put services such as cleaner/clustering/compaction/archive(multi-writer and async) based on this metastore server. \r\n\r\nUsers only need to care about their own ingest pipline and leave all the table services to the manager to automatically discover and manage the hudi table thereby greatly reducing the pressure of operation and maintenance and the cost of on board.\r\n\r\nMaybe We could expand this RFC or raising a new RFC and take this MTS as informations inputs?\r\n\r\nCC @yihua and @nsivabalan ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101137515/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101145546","html_url":"https://github.com/apache/hudi/pull/4724#issuecomment-1101145546","issue_url":"https://api.github.com/repos/apache/hudi/issues/4724","id":1101145546,"node_id":"IC_kwDOBI7nWM5BoiXK","user":{"login":"stayrascal","id":13775334,"node_id":"MDQ6VXNlcjEzNzc1MzM0","avatar_url":"https://avatars.githubusercontent.com/u/13775334?v=4","gravatar_id":"","url":"https://api.github.com/users/stayrascal","html_url":"https://github.com/stayrascal","followers_url":"https://api.github.com/users/stayrascal/followers","following_url":"https://api.github.com/users/stayrascal/following{/other_user}","gists_url":"https://api.github.com/users/stayrascal/gists{/gist_id}","starred_url":"https://api.github.com/users/stayrascal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stayrascal/subscriptions","organizations_url":"https://api.github.com/users/stayrascal/orgs","repos_url":"https://api.github.com/users/stayrascal/repos","events_url":"https://api.github.com/users/stayrascal/events{/privacy}","received_events_url":"https://api.github.com/users/stayrascal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T06:41:09Z","updated_at":"2022-04-18T06:41:09Z","author_association":"CONTRIBUTOR","body":"@hudi-bot run azure","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101145546/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101197673","html_url":"https://github.com/apache/hudi/pull/4724#issuecomment-1101197673","issue_url":"https://api.github.com/repos/apache/hudi/issues/4724","id":1101197673,"node_id":"IC_kwDOBI7nWM5BovFp","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T08:06:35Z","updated_at":"2022-04-18T08:06:35Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"d73d7f503615583bd233b1ba974e7c78125c41bb\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=5620\",\n    \"triggerID\" : \"d73d7f503615583bd233b1ba974e7c78125c41bb\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"6b6a60fd0f04f236289e500b20951158c2358f51\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=5746\",\n    \"triggerID\" : \"6b6a60fd0f04f236289e500b20951158c2358f51\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"21df6fe5ac130bfca73a7e3f528d8ef1df66c074\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=5757\",\n    \"triggerID\" : \"21df6fe5ac130bfca73a7e3f528d8ef1df66c074\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"21df6fe5ac130bfca73a7e3f528d8ef1df66c074\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=5758\",\n    \"triggerID\" : \"1031342598\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"21df6fe5ac130bfca73a7e3f528d8ef1df66c074\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=5757\",\n    \"triggerID\" : \"1031342598\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"21df6fe5ac130bfca73a7e3f528d8ef1df66c074\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=5759\",\n    \"triggerID\" : \"1031365957\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"21df6fe5ac130bfca73a7e3f528d8ef1df66c074\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=5758\",\n    \"triggerID\" : \"1031365957\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"14edef016d98786b713e155e9adec1d87a3500ba\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=6175\",\n    \"triggerID\" : \"14edef016d98786b713e155e9adec1d87a3500ba\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"ce561bc7ed79af0b0cc6cc627ed3747a1d2fd75e\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=6178\",\n    \"triggerID\" : \"ce561bc7ed79af0b0cc6cc627ed3747a1d2fd75e\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"c6f524ea6bf6800a797f9173c4034ce8d111a7d5\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=6320\",\n    \"triggerID\" : \"c6f524ea6bf6800a797f9173c4034ce8d111a7d5\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"d3b3e052e3565fe44174dfae73938bfaa44faee4\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=6357\",\n    \"triggerID\" : \"d3b3e052e3565fe44174dfae73938bfaa44faee4\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"a86b7ff2d204900374751371cd2c8c36e76ea4b8\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=6706\",\n    \"triggerID\" : \"a86b7ff2d204900374751371cd2c8c36e76ea4b8\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"d11c670e816a0a38f10e20c8cdbd8bb1cfc1afe5\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=7000\",\n    \"triggerID\" : \"d11c670e816a0a38f10e20c8cdbd8bb1cfc1afe5\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"e89fd60b77fbd366205df5e60777ced881b6d795\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=7203\",\n    \"triggerID\" : \"e89fd60b77fbd366205df5e60777ced881b6d795\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"e89fd60b77fbd366205df5e60777ced881b6d795\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=7220\",\n    \"triggerID\" : \"1075938530\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"3f771d39a403669bf7d0a8d50cd3e5b711b03ebe\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=7340\",\n    \"triggerID\" : \"3f771d39a403669bf7d0a8d50cd3e5b711b03ebe\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"5a0a1e9c86920017104fb1995d8a156014eb16c1\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=7994\",\n    \"triggerID\" : \"5a0a1e9c86920017104fb1995d8a156014eb16c1\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"20b1ee41afcb4cc5328bfb30e51e5a37bf0d46c7\",\n    \"status\" : \"FAILURE\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=7999\",\n    \"triggerID\" : \"20b1ee41afcb4cc5328bfb30e51e5a37bf0d46c7\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"20b1ee41afcb4cc5328bfb30e51e5a37bf0d46c7\",\n    \"status\" : \"FAILURE\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8093\",\n    \"triggerID\" : \"1101145546\",\n    \"triggerType\" : \"MANUAL\"\n  } ]\n}-->\n## CI report:\n\n* 20b1ee41afcb4cc5328bfb30e51e5a37bf0d46c7 Azure: [FAILURE](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=7999) Azure: [FAILURE](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8093) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101197673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101255459","html_url":"https://github.com/apache/hudi/pull/5111#issuecomment-1101255459","issue_url":"https://api.github.com/repos/apache/hudi/issues/5111","id":1101255459,"node_id":"IC_kwDOBI7nWM5Bo9Mj","user":{"login":"miomiocat","id":11596570,"node_id":"MDQ6VXNlcjExNTk2NTcw","avatar_url":"https://avatars.githubusercontent.com/u/11596570?v=4","gravatar_id":"","url":"https://api.github.com/users/miomiocat","html_url":"https://github.com/miomiocat","followers_url":"https://api.github.com/users/miomiocat/followers","following_url":"https://api.github.com/users/miomiocat/following{/other_user}","gists_url":"https://api.github.com/users/miomiocat/gists{/gist_id}","starred_url":"https://api.github.com/users/miomiocat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/miomiocat/subscriptions","organizations_url":"https://api.github.com/users/miomiocat/orgs","repos_url":"https://api.github.com/users/miomiocat/repos","events_url":"https://api.github.com/users/miomiocat/events{/privacy}","received_events_url":"https://api.github.com/users/miomiocat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T09:24:00Z","updated_at":"2022-04-18T09:24:00Z","author_association":"CONTRIBUTOR","body":"> @alexeykudinkin : can you follow up on the review when you get a chance. @miomiocat : can you rebase w/ latest master\r\n\r\nThanks for your reply.\r\n\r\nRebased, PTAL","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101255459/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101255556","html_url":"https://github.com/apache/hudi/issues/5330#issuecomment-1101255556","issue_url":"https://api.github.com/repos/apache/hudi/issues/5330","id":1101255556,"node_id":"IC_kwDOBI7nWM5Bo9OE","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T09:24:10Z","updated_at":"2022-04-18T09:24:10Z","author_association":"CONTRIBUTOR","body":"@Guanpx  Did you use the code of latest master ? The shuffle strategy in https://github.com/apache/hudi/blob/b8e465fdfcac1961fe05ed44993c8c6139e13b31/hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/partitioner/BucketIndexPartitioner.java#L44 determines that one bucket number is always handled by a single task, that means no two write tasks would write to the same bucket number, and within one write task, there is {bucket id} to {file id} mapping.\r\n\r\nDo you guys have any idea how the error happens ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101255556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101299756","html_url":"https://github.com/apache/hudi/pull/5343#issuecomment-1101299756","issue_url":"https://api.github.com/repos/apache/hudi/issues/5343","id":1101299756,"node_id":"IC_kwDOBI7nWM5BpIAs","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T10:34:15Z","updated_at":"2022-04-18T10:34:15Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"0354fcbd2b5841c4c403cc1a4f3b5bd0da647bec\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8097\",\n    \"triggerID\" : \"0354fcbd2b5841c4c403cc1a4f3b5bd0da647bec\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"300c4f0c2d75619024f06efe764d1cc8990521c3\",\n    \"status\" : \"FAILURE\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8099\",\n    \"triggerID\" : \"300c4f0c2d75619024f06efe764d1cc8990521c3\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 300c4f0c2d75619024f06efe764d1cc8990521c3 Azure: [FAILURE](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8099) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101299756/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101345557","html_url":"https://github.com/apache/hudi/issues/4825#issuecomment-1101345557","issue_url":"https://api.github.com/repos/apache/hudi/issues/4825","id":1101345557,"node_id":"IC_kwDOBI7nWM5BpTMV","user":{"login":"Aload","id":13082598,"node_id":"MDQ6VXNlcjEzMDgyNTk4","avatar_url":"https://avatars.githubusercontent.com/u/13082598?v=4","gravatar_id":"","url":"https://api.github.com/users/Aload","html_url":"https://github.com/Aload","followers_url":"https://api.github.com/users/Aload/followers","following_url":"https://api.github.com/users/Aload/following{/other_user}","gists_url":"https://api.github.com/users/Aload/gists{/gist_id}","starred_url":"https://api.github.com/users/Aload/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Aload/subscriptions","organizations_url":"https://api.github.com/users/Aload/orgs","repos_url":"https://api.github.com/users/Aload/repos","events_url":"https://api.github.com/users/Aload/events{/privacy}","received_events_url":"https://api.github.com/users/Aload/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T12:01:42Z","updated_at":"2022-04-18T12:01:42Z","author_association":"NONE","body":"hi , When I use Flink to consume Kakfa and write hudi, I configure the hive synchronization operation.  The same problem occurred during startup .\r\nWhen I looked through the hivesyncContext.java source code, I noticed that the package imported under the source code was very strange.  But this is normal when I don't synchronize hive.\r\n\r\n\r\n\r\nversion: hudi 0.10.1  flink 1.13.1  scala 2.12.10\r\neg:\r\n`  private val sinkSql: String = SinkSql.apply(sinkTableName, dataType.getLogicalType.asInstanceOf[RowType])\r\n    .option(FlinkOptions.PATH, hoodiePath.concat(sinkDbName).concat(\"/\").concat(sinkTableName).concat(\"/\"))\r\n    .option(FlinkOptions.PRECOMBINE_FIELD, \"receiveTime\")\r\n    .option(FlinkOptions.RECORD_KEY_FIELD, \"tenantId,pointId,sn,collectTime\")\r\n    .option(FlinkOptions.READ_AS_STREAMING, true)\r\n    .option(FlinkOptions.READ_START_COMMIT, \"earliest\")\r\n    .option(FlinkOptions.OPERATION, WriteOperationType.INSERT)\r\n    .option(FlinkOptions.WRITE_BULK_INSERT_SHUFFLE_BY_PARTITION, true)\r\n    .option(FlinkOptions.TABLE_TYPE, HoodieTableType.COPY_ON_WRITE)\r\n    .option(FlinkOptions.BUCKET_ASSIGN_TASKS, 10)\r\n    .option(FlinkOptions.COMPACTION_ASYNC_ENABLED, true)\r\n    .option(FlinkOptions.COMPACTION_DELTA_COMMITS, 1)\r\n    .option(FlinkOptions.READ_STREAMING_CHECK_INTERVAL, 10)\r\n    //    .option(FlinkOptions.INSERT_CLUSTER, true)\r\n    .option(FlinkOptions.RETRY_TIMES, 5)\r\n    .option(FlinkOptions.INSERT_CLUSTER, true)\r\n    .option(FlinkOptions.WRITE_TASKS, 10)\r\n    .option(FlinkOptions.HIVE_SYNC_ENABLED, true)\r\n    .option(FlinkOptions.HIVE_SYNC_AUTO_CREATE_DB, true)\r\n    .option(FlinkOptions.HIVE_SYNC_DB, \"ods\")\r\n    .option(FlinkOptions.HIVE_SYNC_TABLE, sinkTableName)\r\n    .option(FlinkOptions.HIVE_SYNC_MODE, \"hms\")\r\n    .option(FlinkOptions.HIVE_SYNC_METASTORE_URIS, \"thrift://dev32:9083\")\r\n    .option(FlinkOptions.HIVE_SYNC_JDBC_URL, \"jdbc:hive2://dev32:10000\")\r\n    .option(FlinkOptions.HIVE_STYLE_PARTITIONING, true)\r\n    .option(FlinkOptions.HIVE_SYNC_SUPPORT_TIMESTAMP, true)\r\n    .partitionField(\"tenantId\", \"fmy\", \"fmm\", \"fmd\")\r\n    //      .option(FlinkOptions.INDEX_GLOBAL_ENABLED, true)\r\n    .end`\r\n \r\n![image](https://user-images.githubusercontent.com/13082598/163804951-28bb43b7-d75b-4b30-bc1a-8cbfacb89b9f.png)\r\n![image](https://user-images.githubusercontent.com/13082598/163805146-700dea3a-2813-4bef-92e0-0218e017505f.png)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101345557/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101349187","html_url":"https://github.com/apache/hudi/issues/4881#issuecomment-1101349187","issue_url":"https://api.github.com/repos/apache/hudi/issues/4881","id":1101349187,"node_id":"IC_kwDOBI7nWM5BpUFD","user":{"login":"zhilinli123","id":76689593,"node_id":"MDQ6VXNlcjc2Njg5NTkz","avatar_url":"https://avatars.githubusercontent.com/u/76689593?v=4","gravatar_id":"","url":"https://api.github.com/users/zhilinli123","html_url":"https://github.com/zhilinli123","followers_url":"https://api.github.com/users/zhilinli123/followers","following_url":"https://api.github.com/users/zhilinli123/following{/other_user}","gists_url":"https://api.github.com/users/zhilinli123/gists{/gist_id}","starred_url":"https://api.github.com/users/zhilinli123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhilinli123/subscriptions","organizations_url":"https://api.github.com/users/zhilinli123/orgs","repos_url":"https://api.github.com/users/zhilinli123/repos","events_url":"https://api.github.com/users/zhilinli123/events{/privacy}","received_events_url":"https://api.github.com/users/zhilinli123/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T12:07:59Z","updated_at":"2022-04-18T12:07:59Z","author_association":"NONE","body":"> The expect behavior is that only after the bootstrap ends up we can handle the in-coming new records. Maybe when you set the bootstrap parallelism as `>1`, the in-coming records are handled before the bootstrap finish. Can you give some log in the `BootstrapOperator` to confirm this behavior ?\r\nAre you saying that a single degree of parallelism will block writes, but multiple degrees of parallelism may occur before chekpoint is finished brushing in a batch of data?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101349187/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101361219","html_url":"https://github.com/apache/hudi/pull/4441#issuecomment-1101361219","issue_url":"https://api.github.com/repos/apache/hudi/issues/4441","id":1101361219,"node_id":"IC_kwDOBI7nWM5BpXBD","user":{"login":"YuweiXiao","id":9959868,"node_id":"MDQ6VXNlcjk5NTk4Njg=","avatar_url":"https://avatars.githubusercontent.com/u/9959868?v=4","gravatar_id":"","url":"https://api.github.com/users/YuweiXiao","html_url":"https://github.com/YuweiXiao","followers_url":"https://api.github.com/users/YuweiXiao/followers","following_url":"https://api.github.com/users/YuweiXiao/following{/other_user}","gists_url":"https://api.github.com/users/YuweiXiao/gists{/gist_id}","starred_url":"https://api.github.com/users/YuweiXiao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YuweiXiao/subscriptions","organizations_url":"https://api.github.com/users/YuweiXiao/orgs","repos_url":"https://api.github.com/users/YuweiXiao/repos","events_url":"https://api.github.com/users/YuweiXiao/events{/privacy}","received_events_url":"https://api.github.com/users/YuweiXiao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T12:29:13Z","updated_at":"2022-04-18T12:29:13Z","author_association":"CONTRIBUTOR","body":"@hudi-bot run azure","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101361219/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101409827","html_url":"https://github.com/apache/hudi/pull/5347#issuecomment-1101409827","issue_url":"https://api.github.com/repos/apache/hudi/issues/5347","id":1101409827,"node_id":"IC_kwDOBI7nWM5Bpi4j","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T13:29:04Z","updated_at":"2022-04-18T13:29:04Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"c72a7f1af64141c4b6d2ca466be5c2af9a5ca774\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8103\",\n    \"triggerID\" : \"c72a7f1af64141c4b6d2ca466be5c2af9a5ca774\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* c72a7f1af64141c4b6d2ca466be5c2af9a5ca774 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8103) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101409827/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101617526","html_url":"https://github.com/apache/hudi/issues/5291#issuecomment-1101617526","issue_url":"https://api.github.com/repos/apache/hudi/issues/5291","id":1101617526,"node_id":"IC_kwDOBI7nWM5BqVl2","user":{"login":"zhedoubushishi","id":31263084,"node_id":"MDQ6VXNlcjMxMjYzMDg0","avatar_url":"https://avatars.githubusercontent.com/u/31263084?v=4","gravatar_id":"","url":"https://api.github.com/users/zhedoubushishi","html_url":"https://github.com/zhedoubushishi","followers_url":"https://api.github.com/users/zhedoubushishi/followers","following_url":"https://api.github.com/users/zhedoubushishi/following{/other_user}","gists_url":"https://api.github.com/users/zhedoubushishi/gists{/gist_id}","starred_url":"https://api.github.com/users/zhedoubushishi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhedoubushishi/subscriptions","organizations_url":"https://api.github.com/users/zhedoubushishi/orgs","repos_url":"https://api.github.com/users/zhedoubushishi/repos","events_url":"https://api.github.com/users/zhedoubushishi/events{/privacy}","received_events_url":"https://api.github.com/users/zhedoubushishi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T18:07:37Z","updated_at":"2022-04-18T18:07:37Z","author_association":"CONTRIBUTOR","body":"Sorry I don't fully understand your question. This should work: `os.environ['HUDI_CONF_DIR'] = args['HUDI_CONF_DIR']`. But what `args['HUDI_CONF_DIR']` stands for?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101617526/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101671339","html_url":"https://github.com/apache/hudi/pull/5337#issuecomment-1101671339","issue_url":"https://api.github.com/repos/apache/hudi/issues/5337","id":1101671339,"node_id":"IC_kwDOBI7nWM5Bqiur","user":{"login":"alexeykudinkin","id":428277,"node_id":"MDQ6VXNlcjQyODI3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/428277?v=4","gravatar_id":"","url":"https://api.github.com/users/alexeykudinkin","html_url":"https://github.com/alexeykudinkin","followers_url":"https://api.github.com/users/alexeykudinkin/followers","following_url":"https://api.github.com/users/alexeykudinkin/following{/other_user}","gists_url":"https://api.github.com/users/alexeykudinkin/gists{/gist_id}","starred_url":"https://api.github.com/users/alexeykudinkin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexeykudinkin/subscriptions","organizations_url":"https://api.github.com/users/alexeykudinkin/orgs","repos_url":"https://api.github.com/users/alexeykudinkin/repos","events_url":"https://api.github.com/users/alexeykudinkin/events{/privacy}","received_events_url":"https://api.github.com/users/alexeykudinkin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T19:10:50Z","updated_at":"2022-04-18T19:10:50Z","author_association":"CONTRIBUTOR","body":"@nsivabalan i don't think there's a way for us to assert this easily. We can try to assert the number of partitions after optimizing Spark plan. Will create a ticket to follow-up on it.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101671339/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101710498","html_url":"https://github.com/apache/hudi/pull/5344#issuecomment-1101710498","issue_url":"https://api.github.com/repos/apache/hudi/issues/5344","id":1101710498,"node_id":"IC_kwDOBI7nWM5BqsSi","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T19:55:09Z","updated_at":"2022-04-18T19:55:09Z","author_association":"CONTRIBUTOR","body":"@zhangyue19921010 : One of my error injection test run failed w/ below exception with metadata table validation. \r\n```\r\nRun Number : 0\r\n\r\n├── Deltastreamer Job\r\n\r\n│   ├── Status: Failed\r\n\r\n│   ├── Exceptions\r\n\r\n│   └── Killed\r\n\r\n│       └── Killing the jvm at /tmp/fail2_mt_write.txt Reason: Fail metadata \r\n\r\n│           table writing before commit 00000000000000\r\n\r\n└── Validation Job for Latest files\r\n\r\n    ├── Status: Failed\r\n\r\n    ├── Exceptions\r\n\r\n    │   ├── org.apache.hudi.exception.HoodieValidationException: There is no \r\n\r\n    │   │   completed instant for metadata table.\r\n\r\n    │   ├── org.apache.hudi.exception.HoodieException: Unable to do hoodie \r\n\r\n    │   │   metadata table validation in $BASE_PATH/COWDeltastreamerRun/base_path//hoodie_Table\r\n\r\n    │   ├── Caused by: org.apache.hudi.exception.HoodieException: Error fetching\r\n\r\n    │   │   partition paths from metadata table\r\n\r\n    │   ├── Caused by: org.apache.hudi.exception.HoodieMetadataException: Failed\r\n\r\n    │   │   to retrieve list of partition from metadata\r\n\r\n    │   └── Caused by: java.util.NoSuchElementException: No value present in \r\n\r\n    │       Option\r\n\r\n    └── Killed: False\r\n\r\nUploading logs to s3 $BASE_PATH/COWDeltastreamerRun/\r\n\r\nCompleted 1.2 KiB/435.1 KiB (17.4 KiB/s) with 4 file(s) remaining\r\nupload: job_runs/18-04-2022T00-37-10/hoodie_table_report.log to $BASE_PATH/COWDeltastreamerRun/hoodie_table_report.log\r\n\r\n```\r\n\r\nDo you think, w/ above fix, this failure will go away. This failure happened when there are no commits in metadata table. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101710498/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101714149","html_url":"https://github.com/apache/hudi/pull/5337#issuecomment-1101714149","issue_url":"https://api.github.com/repos/apache/hudi/issues/5337","id":1101714149,"node_id":"IC_kwDOBI7nWM5BqtLl","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T20:00:46Z","updated_at":"2022-04-18T20:00:46Z","author_association":"CONTRIBUTOR","body":"sure, sg. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101714149/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101715404","html_url":"https://github.com/apache/hudi/pull/5331#issuecomment-1101715404","issue_url":"https://api.github.com/repos/apache/hudi/issues/5331","id":1101715404,"node_id":"IC_kwDOBI7nWM5BqtfM","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T20:02:30Z","updated_at":"2022-04-18T20:02:30Z","author_association":"CONTRIBUTOR","body":"I don't see this being used anywhere. So, may I know whats the purpose then ? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101715404/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101715941","html_url":"https://github.com/apache/hudi/pull/5338#issuecomment-1101715941","issue_url":"https://api.github.com/repos/apache/hudi/issues/5338","id":1101715941,"node_id":"IC_kwDOBI7nWM5Bqtnl","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T20:03:15Z","updated_at":"2022-04-18T20:03:15Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"d619e9656c39f88c5e5c07f4d2b01baaf3e8c64a\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8086\",\n    \"triggerID\" : \"d619e9656c39f88c5e5c07f4d2b01baaf3e8c64a\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"5cd21a598d455492412ea525feddaa53325b5c9a\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8087\",\n    \"triggerID\" : \"5cd21a598d455492412ea525feddaa53325b5c9a\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"5b414e455d3ce63b354860d75ea0505de8269a35\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8110\",\n    \"triggerID\" : \"5b414e455d3ce63b354860d75ea0505de8269a35\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 5b414e455d3ce63b354860d75ea0505de8269a35 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8110) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101715941/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101721223","html_url":"https://github.com/apache/hudi/issues/5223#issuecomment-1101721223","issue_url":"https://api.github.com/repos/apache/hudi/issues/5223","id":1101721223,"node_id":"IC_kwDOBI7nWM5Bqu6H","user":{"login":"suryaprasanna","id":20996567,"node_id":"MDQ6VXNlcjIwOTk2NTY3","avatar_url":"https://avatars.githubusercontent.com/u/20996567?v=4","gravatar_id":"","url":"https://api.github.com/users/suryaprasanna","html_url":"https://github.com/suryaprasanna","followers_url":"https://api.github.com/users/suryaprasanna/followers","following_url":"https://api.github.com/users/suryaprasanna/following{/other_user}","gists_url":"https://api.github.com/users/suryaprasanna/gists{/gist_id}","starred_url":"https://api.github.com/users/suryaprasanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/suryaprasanna/subscriptions","organizations_url":"https://api.github.com/users/suryaprasanna/orgs","repos_url":"https://api.github.com/users/suryaprasanna/repos","events_url":"https://api.github.com/users/suryaprasanna/events{/privacy}","received_events_url":"https://api.github.com/users/suryaprasanna/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T20:10:08Z","updated_at":"2022-04-18T20:10:08Z","author_association":"CONTRIBUTOR","body":"@sharathkola \r\nI do not have much context if at all aws is having any custom implementation on hudi code.\r\n\r\nIn the spark DAG, the filter block is showing output rows as 2. Does that mean duplicates rows are returned?\r\nIf there are duplicates, then one problem I can think of is, completed replacecommit file not having partitionToReplaceFileIds, so, it maybe considering all 198 files as valid files even though only 2 of them are valid.\r\nFor further investigation, could you share us the contents of 20220404094047.commit and 20220404094203.replacecommit files?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101721223/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101729851","html_url":"https://github.com/apache/hudi/pull/5333#issuecomment-1101729851","issue_url":"https://api.github.com/repos/apache/hudi/issues/5333","id":1101729851,"node_id":"IC_kwDOBI7nWM5BqxA7","user":{"login":"bhasudha","id":2179254,"node_id":"MDQ6VXNlcjIxNzkyNTQ=","avatar_url":"https://avatars.githubusercontent.com/u/2179254?v=4","gravatar_id":"","url":"https://api.github.com/users/bhasudha","html_url":"https://github.com/bhasudha","followers_url":"https://api.github.com/users/bhasudha/followers","following_url":"https://api.github.com/users/bhasudha/following{/other_user}","gists_url":"https://api.github.com/users/bhasudha/gists{/gist_id}","starred_url":"https://api.github.com/users/bhasudha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhasudha/subscriptions","organizations_url":"https://api.github.com/users/bhasudha/orgs","repos_url":"https://api.github.com/users/bhasudha/repos","events_url":"https://api.github.com/users/bhasudha/events{/privacy}","received_events_url":"https://api.github.com/users/bhasudha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T20:21:36Z","updated_at":"2022-04-18T20:21:36Z","author_association":"CONTRIBUTOR","body":"> hi @bhasudha have you verified it locally? LGTM\r\n\r\nYes. Verified locally. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101729851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101733790","html_url":"https://github.com/apache/hudi/pull/5342#issuecomment-1101733790","issue_url":"https://api.github.com/repos/apache/hudi/issues/5342","id":1101733790,"node_id":"IC_kwDOBI7nWM5Bqx-e","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T20:26:41Z","updated_at":"2022-04-18T20:26:41Z","author_association":"CONTRIBUTOR","body":"There is some flakiness around TestHoodieIndexer.testTwoIndexersOneCreateOneDropPartition. I tried running it locally for 30 times and could not reproduce. have re-triggered CI run. lets see. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101733790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101736038","html_url":"https://github.com/apache/hudi/pull/5349#issuecomment-1101736038","issue_url":"https://api.github.com/repos/apache/hudi/issues/5349","id":1101736038,"node_id":"IC_kwDOBI7nWM5Bqyhm","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T20:29:39Z","updated_at":"2022-04-18T20:29:39Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"14ad8c1acfba4a5596d530550d483534a7c2705b\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8111\",\n    \"triggerID\" : \"14ad8c1acfba4a5596d530550d483534a7c2705b\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 14ad8c1acfba4a5596d530550d483534a7c2705b Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8111) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101736038/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101771568","html_url":"https://github.com/apache/hudi/pull/5342#issuecomment-1101771568","issue_url":"https://api.github.com/repos/apache/hudi/issues/5342","id":1101771568,"node_id":"IC_kwDOBI7nWM5Bq7Mw","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T21:11:29Z","updated_at":"2022-04-18T21:11:29Z","author_association":"CONTRIBUTOR","body":"@hudi-bot run azure","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101771568/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101833648","html_url":"https://github.com/apache/hudi/pull/5352#issuecomment-1101833648","issue_url":"https://api.github.com/repos/apache/hudi/issues/5352","id":1101833648,"node_id":"IC_kwDOBI7nWM5BrKWw","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T22:54:43Z","updated_at":"2022-04-18T22:54:43Z","author_association":"MEMBER","body":"@xiarixiaoyao Can you please skim this PR as well","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101833648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101850324","html_url":"https://github.com/apache/hudi/pull/5331#issuecomment-1101850324","issue_url":"https://api.github.com/repos/apache/hudi/issues/5331","id":1101850324,"node_id":"IC_kwDOBI7nWM5BrObU","user":{"login":"yihua","id":2497195,"node_id":"MDQ6VXNlcjI0OTcxOTU=","avatar_url":"https://avatars.githubusercontent.com/u/2497195?v=4","gravatar_id":"","url":"https://api.github.com/users/yihua","html_url":"https://github.com/yihua","followers_url":"https://api.github.com/users/yihua/followers","following_url":"https://api.github.com/users/yihua/following{/other_user}","gists_url":"https://api.github.com/users/yihua/gists{/gist_id}","starred_url":"https://api.github.com/users/yihua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yihua/subscriptions","organizations_url":"https://api.github.com/users/yihua/orgs","repos_url":"https://api.github.com/users/yihua/repos","events_url":"https://api.github.com/users/yihua/events{/privacy}","received_events_url":"https://api.github.com/users/yihua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T23:24:52Z","updated_at":"2022-04-18T23:24:52Z","author_association":"CONTRIBUTOR","body":"This minor PR (#5336) tries to add the logo to the github repo.  Existing logo is low-def and does not visualize well when enlarged.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101850324/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101853875","html_url":"https://github.com/apache/hudi/pull/5350#issuecomment-1101853875","issue_url":"https://api.github.com/repos/apache/hudi/issues/5350","id":1101853875,"node_id":"IC_kwDOBI7nWM5BrPSz","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T23:31:07Z","updated_at":"2022-04-18T23:31:07Z","author_association":"MEMBER","body":"cc @umehrot2 ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101853875/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101884294","html_url":"https://github.com/apache/hudi/pull/5353#issuecomment-1101884294","issue_url":"https://api.github.com/repos/apache/hudi/issues/5353","id":1101884294,"node_id":"IC_kwDOBI7nWM5BrWuG","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T00:40:40Z","updated_at":"2022-04-19T00:40:40Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"aaf1c07e06b65fd40d133ad6cbb67f3b0258344f\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8116\",\n    \"triggerID\" : \"aaf1c07e06b65fd40d133ad6cbb67f3b0258344f\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* aaf1c07e06b65fd40d133ad6cbb67f3b0258344f Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8116) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101884294/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101884862","html_url":"https://github.com/apache/hudi/issues/5291#issuecomment-1101884862","issue_url":"https://api.github.com/repos/apache/hudi/issues/5291","id":1101884862,"node_id":"IC_kwDOBI7nWM5BrW2-","user":{"login":"MoustafaAMahmoud","id":13502087,"node_id":"MDQ6VXNlcjEzNTAyMDg3","avatar_url":"https://avatars.githubusercontent.com/u/13502087?v=4","gravatar_id":"","url":"https://api.github.com/users/MoustafaAMahmoud","html_url":"https://github.com/MoustafaAMahmoud","followers_url":"https://api.github.com/users/MoustafaAMahmoud/followers","following_url":"https://api.github.com/users/MoustafaAMahmoud/following{/other_user}","gists_url":"https://api.github.com/users/MoustafaAMahmoud/gists{/gist_id}","starred_url":"https://api.github.com/users/MoustafaAMahmoud/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MoustafaAMahmoud/subscriptions","organizations_url":"https://api.github.com/users/MoustafaAMahmoud/orgs","repos_url":"https://api.github.com/users/MoustafaAMahmoud/repos","events_url":"https://api.github.com/users/MoustafaAMahmoud/events{/privacy}","received_events_url":"https://api.github.com/users/MoustafaAMahmoud/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T00:42:01Z","updated_at":"2022-04-19T00:43:54Z","author_association":"NONE","body":"@zhedoubushishi I updated the issue. args['HUDI_CONF_DIR'] is S3 URI to the hudi config. For example, \r\n```\r\nHUDI_CONF_DIR='s3://glue-development-bucket/scripts/hudi-conf/hudi-default.conf'\r\n```\r\nI am testing with Glue3 + Hudi 0.10.1 + S3\r\n\r\nThis file contains the below details \r\n\r\n```\r\n# Default system properties included when running Hudi jobs.\r\n# This is useful for setting default environmental settings.\r\n\r\n# Example:\r\nhoodie.datasource.write.table.type                      COPY_ON_WRITE\r\nhoodie.datasource.write.hive_style_partitioning         false\r\n\r\n# commonConfig      \r\nclassName                                               org.apache.hudi\r\nhoodie.datasource.hive_sync.use_jdbc                    false\r\nhoodie.datasource.write.precombine.field                tpep_pickup_datetime\r\nhoodie.datasource.write.recordkey.field                 pk_col\r\nhoodie.table.name                                       ny_yellow_trip_data_paritioned\r\nhoodie.consistency.check.enabled                        true\r\nhoodie.datasource.hive_sync.database                    hudi10\r\nhoodie.datasource.hive_sync.table                       ny_yellow_trip_data_paritioned\r\nhoodie.datasource.hive_sync.enable                      true\r\nhoodie.metrics.on                                       true\r\nhoodie.metrics.reporter.type                            CLOUDWATCH\r\npath                                                    s3://hudi-update/hudi10/ny_yellow_trip_data_partitioned\r\n\r\n#partitionDataConfig    \r\nhoodie.datasource.write.partitionpath.field             payment_type\r\nhoodie.datasource.hive_sync.partition_extractor_class   org.apache.hudi.hive.MultiPartKeysValueExtractor\r\nhoodie.datasource.hive_sync.partition_fields            payment_type\r\nhoodie.datasource.write.hive_style_partitioning         true\r\n\r\n# incrementalConfig\r\nhoodie.datasource.write.operation                       upsert\r\nhoodie.cleaner.policy                                   KEEP_LATEST_COMMITS\r\nhoodie.cleaner.commits.retained                         1     \r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101884862/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101907596","html_url":"https://github.com/apache/hudi/pull/5350#issuecomment-1101907596","issue_url":"https://api.github.com/repos/apache/hudi/issues/5350","id":1101907596,"node_id":"IC_kwDOBI7nWM5BrcaM","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T01:35:11Z","updated_at":"2022-04-19T01:39:55Z","author_association":"CONTRIBUTOR","body":"yes. While loading file groups, we deduce whether a commit is valid or not based on below logic \r\n```\r\n  /**\r\n   * A FileSlice is considered committed, if one of the following is true - There is a committed data file - There are\r\n   * some log files, that are based off a commit or delta commit.\r\n   */\r\n  private boolean isFileSliceCommitted(FileSlice slice) {\r\n    String maxCommitTime = lastInstant.get().getTimestamp();\r\n    return timeline.containsOrBeforeTimelineStarts(slice.getBaseInstantTime())\r\n        && HoodieTimeline.compareTimestamps(slice.getBaseInstantTime(), HoodieTimeline.LESSER_THAN_OR_EQUALS, maxCommitTime);\r\n  }\r\n```\r\n\r\nSo, after first entry in active timeline, there are no holes expected. May be there are other places where we make such assumptions. So, reverting the patch to WIP for now as this needs some more investigation. Since this is very much in the hot path, we may want to do a thorough analysis before we can put it up for review. \r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101907596/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101912976","html_url":"https://github.com/apache/hudi/pull/5342#issuecomment-1101912976","issue_url":"https://api.github.com/repos/apache/hudi/issues/5342","id":1101912976,"node_id":"IC_kwDOBI7nWM5BrduQ","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T01:47:28Z","updated_at":"2022-04-19T01:47:28Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"9bb3e7a690559977a4e30804e621fb85f96bf670\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8095\",\n    \"triggerID\" : \"9bb3e7a690559977a4e30804e621fb85f96bf670\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"f10e6ece4f254320ed20b28c721b8e82f201e163\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8108\",\n    \"triggerID\" : \"f10e6ece4f254320ed20b28c721b8e82f201e163\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"94b2045d1b9d20edadba53ae06af79540f73e22b\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8114\",\n    \"triggerID\" : \"1101771568\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"94b2045d1b9d20edadba53ae06af79540f73e22b\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8114\",\n    \"triggerID\" : \"94b2045d1b9d20edadba53ae06af79540f73e22b\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"TBD\",\n    \"triggerID\" : \"1101771568\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"9d6268b7a98f5f0bb2b13a6745314cf48aa4dea8\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8118\",\n    \"triggerID\" : \"9d6268b7a98f5f0bb2b13a6745314cf48aa4dea8\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 9d6268b7a98f5f0bb2b13a6745314cf48aa4dea8 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8118) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101912976/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101913209","html_url":"https://github.com/apache/hudi/pull/5352#issuecomment-1101913209","issue_url":"https://api.github.com/repos/apache/hudi/issues/5352","id":1101913209,"node_id":"IC_kwDOBI7nWM5Brdx5","user":{"login":"xiarixiaoyao","id":13514703,"node_id":"MDQ6VXNlcjEzNTE0NzAz","avatar_url":"https://avatars.githubusercontent.com/u/13514703?v=4","gravatar_id":"","url":"https://api.github.com/users/xiarixiaoyao","html_url":"https://github.com/xiarixiaoyao","followers_url":"https://api.github.com/users/xiarixiaoyao/followers","following_url":"https://api.github.com/users/xiarixiaoyao/following{/other_user}","gists_url":"https://api.github.com/users/xiarixiaoyao/gists{/gist_id}","starred_url":"https://api.github.com/users/xiarixiaoyao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiarixiaoyao/subscriptions","organizations_url":"https://api.github.com/users/xiarixiaoyao/orgs","repos_url":"https://api.github.com/users/xiarixiaoyao/repos","events_url":"https://api.github.com/users/xiarixiaoyao/events{/privacy}","received_events_url":"https://api.github.com/users/xiarixiaoyao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T01:48:05Z","updated_at":"2022-04-19T01:50:13Z","author_association":"CONTRIBUTOR","body":"@alexeykudinkin \r\n if we support prune nest schema, can we avoid this performance  problem\r\nnow schema evolution support prune nest schema， maybe  we can use that prune function.\r\nLGTM\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101913209/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101915682","html_url":"https://github.com/apache/hudi/issues/5346#issuecomment-1101915682","issue_url":"https://api.github.com/repos/apache/hudi/issues/5346","id":1101915682,"node_id":"IC_kwDOBI7nWM5BreYi","user":{"login":"puchangchun","id":19191526,"node_id":"MDQ6VXNlcjE5MTkxNTI2","avatar_url":"https://avatars.githubusercontent.com/u/19191526?v=4","gravatar_id":"","url":"https://api.github.com/users/puchangchun","html_url":"https://github.com/puchangchun","followers_url":"https://api.github.com/users/puchangchun/followers","following_url":"https://api.github.com/users/puchangchun/following{/other_user}","gists_url":"https://api.github.com/users/puchangchun/gists{/gist_id}","starred_url":"https://api.github.com/users/puchangchun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puchangchun/subscriptions","organizations_url":"https://api.github.com/users/puchangchun/orgs","repos_url":"https://api.github.com/users/puchangchun/repos","events_url":"https://api.github.com/users/puchangchun/events{/privacy}","received_events_url":"https://api.github.com/users/puchangchun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T01:54:26Z","updated_at":"2022-04-19T01:54:26Z","author_association":"NONE","body":"```\r\n        <dependency>\r\n            <groupId>org.apache.hive</groupId>\r\n            <artifactId>hive-exec</artifactId>\r\n            <version>2.3.9</version>\r\n        </dependency>\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101915682/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101917354","html_url":"https://github.com/apache/hudi/pull/5352#issuecomment-1101917354","issue_url":"https://api.github.com/repos/apache/hudi/issues/5352","id":1101917354,"node_id":"IC_kwDOBI7nWM5Breyq","user":{"login":"alexeykudinkin","id":428277,"node_id":"MDQ6VXNlcjQyODI3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/428277?v=4","gravatar_id":"","url":"https://api.github.com/users/alexeykudinkin","html_url":"https://github.com/alexeykudinkin","followers_url":"https://api.github.com/users/alexeykudinkin/followers","following_url":"https://api.github.com/users/alexeykudinkin/following{/other_user}","gists_url":"https://api.github.com/users/alexeykudinkin/gists{/gist_id}","starred_url":"https://api.github.com/users/alexeykudinkin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexeykudinkin/subscriptions","organizations_url":"https://api.github.com/users/alexeykudinkin/orgs","repos_url":"https://api.github.com/users/alexeykudinkin/repos","events_url":"https://api.github.com/users/alexeykudinkin/events{/privacy}","received_events_url":"https://api.github.com/users/alexeykudinkin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T01:58:35Z","updated_at":"2022-04-19T01:58:35Z","author_association":"CONTRIBUTOR","body":"@xiarixiaoyao it will most likely solve this particular issue, but we'll continue to be exposed to this becoming a problem again until we upstream the real fix and make `HadoopFsRelation` _extensible_ in Spark","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101917354/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101923406","html_url":"https://github.com/apache/hudi/issues/5330#issuecomment-1101923406","issue_url":"https://api.github.com/repos/apache/hudi/issues/5330","id":1101923406,"node_id":"IC_kwDOBI7nWM5BrgRO","user":{"login":"Guanpx","id":29246713,"node_id":"MDQ6VXNlcjI5MjQ2NzEz","avatar_url":"https://avatars.githubusercontent.com/u/29246713?v=4","gravatar_id":"","url":"https://api.github.com/users/Guanpx","html_url":"https://github.com/Guanpx","followers_url":"https://api.github.com/users/Guanpx/followers","following_url":"https://api.github.com/users/Guanpx/following{/other_user}","gists_url":"https://api.github.com/users/Guanpx/gists{/gist_id}","starred_url":"https://api.github.com/users/Guanpx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Guanpx/subscriptions","organizations_url":"https://api.github.com/users/Guanpx/orgs","repos_url":"https://api.github.com/users/Guanpx/repos","events_url":"https://api.github.com/users/Guanpx/events{/privacy}","received_events_url":"https://api.github.com/users/Guanpx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T02:12:23Z","updated_at":"2022-04-19T02:12:23Z","author_association":"NONE","body":"> \r\nI will try latest master tomorrow and debug that code ~","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101923406/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101925730","html_url":"https://github.com/apache/hudi/pull/5343#issuecomment-1101925730","issue_url":"https://api.github.com/repos/apache/hudi/issues/5343","id":1101925730,"node_id":"IC_kwDOBI7nWM5Brg1i","user":{"login":"xushiyan","id":2701446,"node_id":"MDQ6VXNlcjI3MDE0NDY=","avatar_url":"https://avatars.githubusercontent.com/u/2701446?v=4","gravatar_id":"","url":"https://api.github.com/users/xushiyan","html_url":"https://github.com/xushiyan","followers_url":"https://api.github.com/users/xushiyan/followers","following_url":"https://api.github.com/users/xushiyan/following{/other_user}","gists_url":"https://api.github.com/users/xushiyan/gists{/gist_id}","starred_url":"https://api.github.com/users/xushiyan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xushiyan/subscriptions","organizations_url":"https://api.github.com/users/xushiyan/orgs","repos_url":"https://api.github.com/users/xushiyan/repos","events_url":"https://api.github.com/users/xushiyan/events{/privacy}","received_events_url":"https://api.github.com/users/xushiyan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T02:16:51Z","updated_at":"2022-04-19T02:16:51Z","author_association":"MEMBER","body":"close in favor of #5352 ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101925730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101926246","html_url":"https://github.com/apache/hudi/pull/5331#issuecomment-1101926246","issue_url":"https://api.github.com/repos/apache/hudi/issues/5331","id":1101926246,"node_id":"IC_kwDOBI7nWM5Brg9m","user":{"login":"XuQianJin-Stars","id":10494131,"node_id":"MDQ6VXNlcjEwNDk0MTMx","avatar_url":"https://avatars.githubusercontent.com/u/10494131?v=4","gravatar_id":"","url":"https://api.github.com/users/XuQianJin-Stars","html_url":"https://github.com/XuQianJin-Stars","followers_url":"https://api.github.com/users/XuQianJin-Stars/followers","following_url":"https://api.github.com/users/XuQianJin-Stars/following{/other_user}","gists_url":"https://api.github.com/users/XuQianJin-Stars/gists{/gist_id}","starred_url":"https://api.github.com/users/XuQianJin-Stars/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XuQianJin-Stars/subscriptions","organizations_url":"https://api.github.com/users/XuQianJin-Stars/orgs","repos_url":"https://api.github.com/users/XuQianJin-Stars/repos","events_url":"https://api.github.com/users/XuQianJin-Stars/events{/privacy}","received_events_url":"https://api.github.com/users/XuQianJin-Stars/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T02:18:04Z","updated_at":"2022-04-19T02:18:04Z","author_association":"CONTRIBUTOR","body":"> This minor PR (#5336) tries to add the logo to the github repo. Existing logo is low-def and does not visualize well when enlarged.\r\n\r\n+1 for this","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101926246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101927451","html_url":"https://github.com/apache/hudi/pull/5316#issuecomment-1101927451","issue_url":"https://api.github.com/repos/apache/hudi/issues/5316","id":1101927451,"node_id":"IC_kwDOBI7nWM5BrhQb","user":{"login":"XuQianJin-Stars","id":10494131,"node_id":"MDQ6VXNlcjEwNDk0MTMx","avatar_url":"https://avatars.githubusercontent.com/u/10494131?v=4","gravatar_id":"","url":"https://api.github.com/users/XuQianJin-Stars","html_url":"https://github.com/XuQianJin-Stars","followers_url":"https://api.github.com/users/XuQianJin-Stars/followers","following_url":"https://api.github.com/users/XuQianJin-Stars/following{/other_user}","gists_url":"https://api.github.com/users/XuQianJin-Stars/gists{/gist_id}","starred_url":"https://api.github.com/users/XuQianJin-Stars/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XuQianJin-Stars/subscriptions","organizations_url":"https://api.github.com/users/XuQianJin-Stars/orgs","repos_url":"https://api.github.com/users/XuQianJin-Stars/repos","events_url":"https://api.github.com/users/XuQianJin-Stars/events{/privacy}","received_events_url":"https://api.github.com/users/XuQianJin-Stars/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T02:21:01Z","updated_at":"2022-04-19T02:21:01Z","author_association":"CONTRIBUTOR","body":"hi @bhasudha PTAL.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101927451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101939374","html_url":"https://github.com/apache/hudi/pull/5354#issuecomment-1101939374","issue_url":"https://api.github.com/repos/apache/hudi/issues/5354","id":1101939374,"node_id":"IC_kwDOBI7nWM5BrkKu","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T02:48:27Z","updated_at":"2022-04-19T02:48:27Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"99024f2b516f52d458aff8ca274bf4e4d15e140f\",\n    \"status\" : \"FAILURE\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8120\",\n    \"triggerID\" : \"99024f2b516f52d458aff8ca274bf4e4d15e140f\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 99024f2b516f52d458aff8ca274bf4e4d15e140f Azure: [FAILURE](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8120) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101939374/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101946263","html_url":"https://github.com/apache/hudi/issues/4881#issuecomment-1101946263","issue_url":"https://api.github.com/repos/apache/hudi/issues/4881","id":1101946263,"node_id":"IC_kwDOBI7nWM5Brl2X","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T03:05:20Z","updated_at":"2022-04-19T03:05:20Z","author_association":"CONTRIBUTOR","body":"I mean no new records are allowed to write before the bootstrap finish ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101946263/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101954300","html_url":"https://github.com/apache/hudi/pull/5357#issuecomment-1101954300","issue_url":"https://api.github.com/repos/apache/hudi/issues/5357","id":1101954300,"node_id":"IC_kwDOBI7nWM5Brnz8","user":{"login":"wxplovecc","id":3350718,"node_id":"MDQ6VXNlcjMzNTA3MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3350718?v=4","gravatar_id":"","url":"https://api.github.com/users/wxplovecc","html_url":"https://github.com/wxplovecc","followers_url":"https://api.github.com/users/wxplovecc/followers","following_url":"https://api.github.com/users/wxplovecc/following{/other_user}","gists_url":"https://api.github.com/users/wxplovecc/gists{/gist_id}","starred_url":"https://api.github.com/users/wxplovecc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wxplovecc/subscriptions","organizations_url":"https://api.github.com/users/wxplovecc/orgs","repos_url":"https://api.github.com/users/wxplovecc/repos","events_url":"https://api.github.com/users/wxplovecc/events{/privacy}","received_events_url":"https://api.github.com/users/wxplovecc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T03:23:50Z","updated_at":"2022-04-19T03:23:50Z","author_association":"CONTRIBUTOR","body":"cc @danny0405 ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101954300/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101955739","html_url":"https://github.com/apache/hudi/pull/5185#issuecomment-1101955739","issue_url":"https://api.github.com/repos/apache/hudi/issues/5185","id":1101955739,"node_id":"IC_kwDOBI7nWM5BroKb","user":{"login":"wxplovecc","id":3350718,"node_id":"MDQ6VXNlcjMzNTA3MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3350718?v=4","gravatar_id":"","url":"https://api.github.com/users/wxplovecc","html_url":"https://github.com/wxplovecc","followers_url":"https://api.github.com/users/wxplovecc/followers","following_url":"https://api.github.com/users/wxplovecc/following{/other_user}","gists_url":"https://api.github.com/users/wxplovecc/gists{/gist_id}","starred_url":"https://api.github.com/users/wxplovecc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wxplovecc/subscriptions","organizations_url":"https://api.github.com/users/wxplovecc/orgs","repos_url":"https://api.github.com/users/wxplovecc/repos","events_url":"https://api.github.com/users/wxplovecc/events{/privacy}","received_events_url":"https://api.github.com/users/wxplovecc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T03:26:50Z","updated_at":"2022-04-19T03:26:50Z","author_association":"CONTRIBUTOR","body":"> Hello @wxplovecc Can you fix the checkstyle for building ?\r\n\r\nok","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101955739/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101965808","html_url":"https://github.com/apache/hudi/issues/5330#issuecomment-1101965808","issue_url":"https://api.github.com/repos/apache/hudi/issues/5330","id":1101965808,"node_id":"IC_kwDOBI7nWM5Brqnw","user":{"login":"wxplovecc","id":3350718,"node_id":"MDQ6VXNlcjMzNTA3MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3350718?v=4","gravatar_id":"","url":"https://api.github.com/users/wxplovecc","html_url":"https://github.com/wxplovecc","followers_url":"https://api.github.com/users/wxplovecc/followers","following_url":"https://api.github.com/users/wxplovecc/following{/other_user}","gists_url":"https://api.github.com/users/wxplovecc/gists{/gist_id}","starred_url":"https://api.github.com/users/wxplovecc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wxplovecc/subscriptions","organizations_url":"https://api.github.com/users/wxplovecc/orgs","repos_url":"https://api.github.com/users/wxplovecc/repos","events_url":"https://api.github.com/users/wxplovecc/events{/privacy}","received_events_url":"https://api.github.com/users/wxplovecc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T03:51:51Z","updated_at":"2022-04-19T03:51:51Z","author_association":"CONTRIBUTOR","body":"> Thanks for the PR @wxplovecc , can you explain why the #5185 patch fixed the bug ?\r\n\r\nThe mor table rollback was not delete the log files , If the job failed before first successful commit it will left some invalid \r\nlog files, the PR #5185 was reuse the left invalid fileId by scan the left log file when restart the job ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1101965808/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102013085","html_url":"https://github.com/apache/hudi/pull/5355#issuecomment-1102013085","issue_url":"https://api.github.com/repos/apache/hudi/issues/5355","id":1102013085,"node_id":"IC_kwDOBI7nWM5Br2Kd","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T04:41:07Z","updated_at":"2022-04-19T04:41:07Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"35fd8d0aa5d56f1a0b98bb63e0b6f47f1452e35e\",\n    \"status\" : \"FAILURE\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8123\",\n    \"triggerID\" : \"35fd8d0aa5d56f1a0b98bb63e0b6f47f1452e35e\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 35fd8d0aa5d56f1a0b98bb63e0b6f47f1452e35e Azure: [FAILURE](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8123) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102013085/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102064611","html_url":"https://github.com/apache/hudi/pull/5344#issuecomment-1102064611","issue_url":"https://api.github.com/repos/apache/hudi/issues/5344","id":1102064611,"node_id":"IC_kwDOBI7nWM5BsCvj","user":{"login":"zhangyue19921010","id":69956021,"node_id":"MDQ6VXNlcjY5OTU2MDIx","avatar_url":"https://avatars.githubusercontent.com/u/69956021?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyue19921010","html_url":"https://github.com/zhangyue19921010","followers_url":"https://api.github.com/users/zhangyue19921010/followers","following_url":"https://api.github.com/users/zhangyue19921010/following{/other_user}","gists_url":"https://api.github.com/users/zhangyue19921010/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyue19921010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyue19921010/subscriptions","organizations_url":"https://api.github.com/users/zhangyue19921010/orgs","repos_url":"https://api.github.com/users/zhangyue19921010/repos","events_url":"https://api.github.com/users/zhangyue19921010/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyue19921010/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T05:15:20Z","updated_at":"2022-04-19T05:15:20Z","author_association":"CONTRIBUTOR","body":"> when there are no commits in metadata table.\r\n\r\nYeap, after this patch, when there are no commits in metadata table, HoodieMetadataTableValidator will skip current loop and log a warn message.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102064611/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102123099","html_url":"https://github.com/apache/hudi/pull/5356#issuecomment-1102123099","issue_url":"https://api.github.com/repos/apache/hudi/issues/5356","id":1102123099,"node_id":"IC_kwDOBI7nWM5BsRBb","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T05:58:08Z","updated_at":"2022-04-19T05:58:08Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"480b4e9c735edc69b37436376089086443a481ba\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8125\",\n    \"triggerID\" : \"480b4e9c735edc69b37436376089086443a481ba\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 480b4e9c735edc69b37436376089086443a481ba Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8125) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102123099/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102258674","html_url":"https://github.com/apache/hudi/pull/5359#issuecomment-1102258674","issue_url":"https://api.github.com/repos/apache/hudi/issues/5359","id":1102258674,"node_id":"IC_kwDOBI7nWM5BsyHy","user":{"login":"zhangyue19921010","id":69956021,"node_id":"MDQ6VXNlcjY5OTU2MDIx","avatar_url":"https://avatars.githubusercontent.com/u/69956021?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyue19921010","html_url":"https://github.com/zhangyue19921010","followers_url":"https://api.github.com/users/zhangyue19921010/followers","following_url":"https://api.github.com/users/zhangyue19921010/following{/other_user}","gists_url":"https://api.github.com/users/zhangyue19921010/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyue19921010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyue19921010/subscriptions","organizations_url":"https://api.github.com/users/zhangyue19921010/orgs","repos_url":"https://api.github.com/users/zhangyue19921010/repos","events_url":"https://api.github.com/users/zhangyue19921010/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyue19921010/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T08:11:15Z","updated_at":"2022-04-19T08:11:15Z","author_association":"CONTRIBUTOR","body":"@hudi-bot run azure","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102258674/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102288392","html_url":"https://github.com/apache/hudi/issues/5223#issuecomment-1102288392","issue_url":"https://api.github.com/repos/apache/hudi/issues/5223","id":1102288392,"node_id":"IC_kwDOBI7nWM5Bs5YI","user":{"login":"sharathkola","id":102993931,"node_id":"U_kgDOBiOQCw","avatar_url":"https://avatars.githubusercontent.com/u/102993931?v=4","gravatar_id":"","url":"https://api.github.com/users/sharathkola","html_url":"https://github.com/sharathkola","followers_url":"https://api.github.com/users/sharathkola/followers","following_url":"https://api.github.com/users/sharathkola/following{/other_user}","gists_url":"https://api.github.com/users/sharathkola/gists{/gist_id}","starred_url":"https://api.github.com/users/sharathkola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sharathkola/subscriptions","organizations_url":"https://api.github.com/users/sharathkola/orgs","repos_url":"https://api.github.com/users/sharathkola/repos","events_url":"https://api.github.com/users/sharathkola/events{/privacy}","received_events_url":"https://api.github.com/users/sharathkola/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T08:31:46Z","updated_at":"2022-04-19T08:31:46Z","author_association":"NONE","body":"@suryaprasanna \r\nYes, duplicate rows are returned.\r\nI have attached both the files you requested.\r\n[commit_files.zip](https://github.com/apache/hudi/files/8510790/commit_files.zip)","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102288392/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102329893","html_url":"https://github.com/apache/hudi/issues/4881#issuecomment-1102329893","issue_url":"https://api.github.com/repos/apache/hudi/issues/4881","id":1102329893,"node_id":"IC_kwDOBI7nWM5BtDgl","user":{"login":"zhilinli123","id":76689593,"node_id":"MDQ6VXNlcjc2Njg5NTkz","avatar_url":"https://avatars.githubusercontent.com/u/76689593?v=4","gravatar_id":"","url":"https://api.github.com/users/zhilinli123","html_url":"https://github.com/zhilinli123","followers_url":"https://api.github.com/users/zhilinli123/followers","following_url":"https://api.github.com/users/zhilinli123/following{/other_user}","gists_url":"https://api.github.com/users/zhilinli123/gists{/gist_id}","starred_url":"https://api.github.com/users/zhilinli123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhilinli123/subscriptions","organizations_url":"https://api.github.com/users/zhilinli123/orgs","repos_url":"https://api.github.com/users/zhilinli123/repos","events_url":"https://api.github.com/users/zhilinli123/events{/privacy}","received_events_url":"https://api.github.com/users/zhilinli123/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T08:55:07Z","updated_at":"2022-04-19T08:55:07Z","author_association":"NONE","body":"In the previous tests, data duplication occurred after the checkpoint was completed for the first time. No new data was written before the checkpoint was completed\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102329893/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102395288","html_url":"https://github.com/apache/hudi/pull/5359#issuecomment-1102395288","issue_url":"https://api.github.com/repos/apache/hudi/issues/5359","id":1102395288,"node_id":"IC_kwDOBI7nWM5BtTeY","user":{"login":"zhangyue19921010","id":69956021,"node_id":"MDQ6VXNlcjY5OTU2MDIx","avatar_url":"https://avatars.githubusercontent.com/u/69956021?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyue19921010","html_url":"https://github.com/zhangyue19921010","followers_url":"https://api.github.com/users/zhangyue19921010/followers","following_url":"https://api.github.com/users/zhangyue19921010/following{/other_user}","gists_url":"https://api.github.com/users/zhangyue19921010/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyue19921010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyue19921010/subscriptions","organizations_url":"https://api.github.com/users/zhangyue19921010/orgs","repos_url":"https://api.github.com/users/zhangyue19921010/repos","events_url":"https://api.github.com/users/zhangyue19921010/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyue19921010/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T09:38:40Z","updated_at":"2022-04-19T09:38:40Z","author_association":"CONTRIBUTOR","body":"@hudi-bot run azure","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102395288/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102418701","html_url":"https://github.com/apache/hudi/issues/5189#issuecomment-1102418701","issue_url":"https://api.github.com/repos/apache/hudi/issues/5189","id":1102418701,"node_id":"IC_kwDOBI7nWM5BtZMN","user":{"login":"harsh1231","id":5278043,"node_id":"MDQ6VXNlcjUyNzgwNDM=","avatar_url":"https://avatars.githubusercontent.com/u/5278043?v=4","gravatar_id":"","url":"https://api.github.com/users/harsh1231","html_url":"https://github.com/harsh1231","followers_url":"https://api.github.com/users/harsh1231/followers","following_url":"https://api.github.com/users/harsh1231/following{/other_user}","gists_url":"https://api.github.com/users/harsh1231/gists{/gist_id}","starred_url":"https://api.github.com/users/harsh1231/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/harsh1231/subscriptions","organizations_url":"https://api.github.com/users/harsh1231/orgs","repos_url":"https://api.github.com/users/harsh1231/repos","events_url":"https://api.github.com/users/harsh1231/events{/privacy}","received_events_url":"https://api.github.com/users/harsh1231/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T09:52:42Z","updated_at":"2022-04-19T09:53:46Z","author_association":"CONTRIBUTOR","body":"@nsivabalan @lowmmrfeeder  load from previous table itself is failing \r\n`at com.navi.sources.HoodieIncrSource.fetchNextBatch(HoodieIncrSource.java:122)`\r\nthis looks like your internal class @lowmmrfeeder  , you should check why 2nd tables have duplicate columns with name `_hoodie_partition_path`","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102418701/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102436171","html_url":"https://github.com/apache/hudi/pull/5087#issuecomment-1102436171","issue_url":"https://api.github.com/repos/apache/hudi/issues/5087","id":1102436171,"node_id":"IC_kwDOBI7nWM5BtddL","user":{"login":"xushiyan","id":2701446,"node_id":"MDQ6VXNlcjI3MDE0NDY=","avatar_url":"https://avatars.githubusercontent.com/u/2701446?v=4","gravatar_id":"","url":"https://api.github.com/users/xushiyan","html_url":"https://github.com/xushiyan","followers_url":"https://api.github.com/users/xushiyan/followers","following_url":"https://api.github.com/users/xushiyan/following{/other_user}","gists_url":"https://api.github.com/users/xushiyan/gists{/gist_id}","starred_url":"https://api.github.com/users/xushiyan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xushiyan/subscriptions","organizations_url":"https://api.github.com/users/xushiyan/orgs","repos_url":"https://api.github.com/users/xushiyan/repos","events_url":"https://api.github.com/users/xushiyan/events{/privacy}","received_events_url":"https://api.github.com/users/xushiyan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T10:01:49Z","updated_at":"2022-04-19T10:01:49Z","author_association":"MEMBER","body":"@danny0405 as @liujinhui1994 mentioned, reducing duplicate code is the intention and the direction, but yes, implementation wise we should also avoid perf impact. I see there have to more code design / refactoring work to achieve it.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102436171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102487837","html_url":"https://github.com/apache/hudi/issues/5189#issuecomment-1102487837","issue_url":"https://api.github.com/repos/apache/hudi/issues/5189","id":1102487837,"node_id":"IC_kwDOBI7nWM5BtqEd","user":{"login":"low-on-mana","id":8509512,"node_id":"MDQ6VXNlcjg1MDk1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/8509512?v=4","gravatar_id":"","url":"https://api.github.com/users/low-on-mana","html_url":"https://github.com/low-on-mana","followers_url":"https://api.github.com/users/low-on-mana/followers","following_url":"https://api.github.com/users/low-on-mana/following{/other_user}","gists_url":"https://api.github.com/users/low-on-mana/gists{/gist_id}","starred_url":"https://api.github.com/users/low-on-mana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/low-on-mana/subscriptions","organizations_url":"https://api.github.com/users/low-on-mana/orgs","repos_url":"https://api.github.com/users/low-on-mana/repos","events_url":"https://api.github.com/users/low-on-mana/events{/privacy}","received_events_url":"https://api.github.com/users/low-on-mana/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T10:37:43Z","updated_at":"2022-04-19T10:37:43Z","author_association":"CONTRIBUTOR","body":"@harsh1231 I am not sure of this, we aren't using columnname `_hoodie_partition_path` anywhere explicitly. \r\nMy guess is deltastreamer adds this column `_hoodie_partition_path` in 1st transformed table. On chaining a tranformation it tries adding it again 2nd time without removing the original column as we can read it in here https://github.com/apache/hudi/blob/b28f0d6ceb7750075be82b7bd4160a4475801159/hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/HoodieIncrSource.java#L176. I haven't gone in depth, so I might be wrong.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102487837/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102509627","html_url":"https://github.com/apache/hudi/pull/5359#issuecomment-1102509627","issue_url":"https://api.github.com/repos/apache/hudi/issues/5359","id":1102509627,"node_id":"IC_kwDOBI7nWM5BtvY7","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T11:04:48Z","updated_at":"2022-04-19T11:04:48Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"287a959ff3e828c539422a7450da09e023028486\",\n    \"status\" : \"CANCELED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8136\",\n    \"triggerID\" : \"287a959ff3e828c539422a7450da09e023028486\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"287a959ff3e828c539422a7450da09e023028486\",\n    \"status\" : \"FAILURE\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8137\",\n    \"triggerID\" : \"1102258674\",\n    \"triggerType\" : \"MANUAL\"\n  }, {\n    \"hash\" : \"287a959ff3e828c539422a7450da09e023028486\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8138\",\n    \"triggerID\" : \"1102395288\",\n    \"triggerType\" : \"MANUAL\"\n  } ]\n}-->\n## CI report:\n\n* 287a959ff3e828c539422a7450da09e023028486 Azure: [CANCELED](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8136) Azure: [FAILURE](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8137) Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8138) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102509627/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102561993","html_url":"https://github.com/apache/hudi/issues/5358#issuecomment-1102561993","issue_url":"https://api.github.com/repos/apache/hudi/issues/5358","id":1102561993,"node_id":"IC_kwDOBI7nWM5Bt8LJ","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T12:07:32Z","updated_at":"2022-04-19T12:07:32Z","author_association":"MEMBER","body":"> read data with spark when clean was happened throw exception\r\n\r\nThis means Hudi is attempting to read a version of the parquet file which no longer exists.\r\nhttps://github.com/apache/hudi/issues/2098 explains how this could happen in more detail. \r\n@Guanpx Can you please share your hudi configs and timeline in `.hoodie` directory?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102561993/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102593032","html_url":"https://github.com/apache/hudi/issues/5195#issuecomment-1102593032","issue_url":"https://api.github.com/repos/apache/hudi/issues/5195","id":1102593032,"node_id":"IC_kwDOBI7nWM5BuDwI","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T12:37:47Z","updated_at":"2022-04-19T12:37:47Z","author_association":"CONTRIBUTOR","body":"@watermelon12138 : gentle ping. can you respond when you can","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102593032/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102602829","html_url":"https://github.com/apache/hudi/issues/5313#issuecomment-1102602829","issue_url":"https://api.github.com/repos/apache/hudi/issues/5313","id":1102602829,"node_id":"IC_kwDOBI7nWM5BuGJN","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T12:47:21Z","updated_at":"2022-04-19T12:47:21Z","author_association":"CONTRIBUTOR","body":"thanks! ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102602829/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102609068","html_url":"https://github.com/apache/hudi/issues/5298#issuecomment-1102609068","issue_url":"https://api.github.com/repos/apache/hudi/issues/5298","id":1102609068,"node_id":"IC_kwDOBI7nWM5BuHqs","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T12:50:08Z","updated_at":"2022-04-19T12:50:08Z","author_association":"CONTRIBUTOR","body":"its not related to metadata table as such. essentially, the actual data files as part of the compaction commit could be different from what is found in compaction commit metadata. So, when reconciling markers, we may delete unintended files. \r\nyes, it is applicable even if you don't enable metadata. \r\n\r\nand thanks for clarifying your use-case. I get it now.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102609068/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102743626","html_url":"https://github.com/apache/hudi/pull/5352#issuecomment-1102743626","issue_url":"https://api.github.com/repos/apache/hudi/issues/5352","id":1102743626,"node_id":"IC_kwDOBI7nWM5BuohK","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T14:44:29Z","updated_at":"2022-04-19T14:44:29Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"57f622f643f7c623129636f8e5000ffe014b0c0b\",\n    \"status\" : \"UNKNOWN\",\n    \"url\" : \"TBD\",\n    \"triggerID\" : \"57f622f643f7c623129636f8e5000ffe014b0c0b\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"de28a2a5f5a3d0ae73ed832104ee10c7a09513f5\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8115\",\n    \"triggerID\" : \"de28a2a5f5a3d0ae73ed832104ee10c7a09513f5\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"6f2b0129ba44ba17b6bd1ba552e9724a62f8e96c\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8119\",\n    \"triggerID\" : \"6f2b0129ba44ba17b6bd1ba552e9724a62f8e96c\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"b975d3295cd534ac04c7ee58bb7961fd9971597d\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8130\",\n    \"triggerID\" : \"b975d3295cd534ac04c7ee58bb7961fd9971597d\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"cabf2cf679534f15b22f3b5daa77a75987667fa5\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8141\",\n    \"triggerID\" : \"cabf2cf679534f15b22f3b5daa77a75987667fa5\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 57f622f643f7c623129636f8e5000ffe014b0c0b UNKNOWN\n* cabf2cf679534f15b22f3b5daa77a75987667fa5 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8141) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102743626/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102800156","html_url":"https://github.com/apache/hudi/issues/5351#issuecomment-1102800156","issue_url":"https://api.github.com/repos/apache/hudi/issues/5351","id":1102800156,"node_id":"IC_kwDOBI7nWM5Bu2Uc","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T15:36:04Z","updated_at":"2022-04-19T15:36:04Z","author_association":"MEMBER","body":"@p-powell You can check by writing parquet directly. \r\n```\r\ndf_id.write.format(\"parquet\").mode(Overwrite).save(parquetBasePath)\r\n```\r\nI tried this and the time taken was comparable. For Hudi, it was 605s and for patquet it was 568s.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102800156/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102817401","html_url":"https://github.com/apache/hudi/issues/5345#issuecomment-1102817401","issue_url":"https://api.github.com/repos/apache/hudi/issues/5345","id":1102817401,"node_id":"IC_kwDOBI7nWM5Bu6h5","user":{"login":"KnightChess","id":20125927,"node_id":"MDQ6VXNlcjIwMTI1OTI3","avatar_url":"https://avatars.githubusercontent.com/u/20125927?v=4","gravatar_id":"","url":"https://api.github.com/users/KnightChess","html_url":"https://github.com/KnightChess","followers_url":"https://api.github.com/users/KnightChess/followers","following_url":"https://api.github.com/users/KnightChess/following{/other_user}","gists_url":"https://api.github.com/users/KnightChess/gists{/gist_id}","starred_url":"https://api.github.com/users/KnightChess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KnightChess/subscriptions","organizations_url":"https://api.github.com/users/KnightChess/orgs","repos_url":"https://api.github.com/users/KnightChess/repos","events_url":"https://api.github.com/users/KnightChess/events{/privacy}","received_events_url":"https://api.github.com/users/KnightChess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T15:52:31Z","updated_at":"2022-04-19T15:52:31Z","author_association":"CONTRIBUTOR","body":"you can update code to fix, default stats null","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102817401/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102828050","html_url":"https://github.com/apache/hudi/issues/5351#issuecomment-1102828050","issue_url":"https://api.github.com/repos/apache/hudi/issues/5351","id":1102828050,"node_id":"IC_kwDOBI7nWM5Bu9IS","user":{"login":"p-powell","id":71663919,"node_id":"MDQ6VXNlcjcxNjYzOTE5","avatar_url":"https://avatars.githubusercontent.com/u/71663919?v=4","gravatar_id":"","url":"https://api.github.com/users/p-powell","html_url":"https://github.com/p-powell","followers_url":"https://api.github.com/users/p-powell/followers","following_url":"https://api.github.com/users/p-powell/following{/other_user}","gists_url":"https://api.github.com/users/p-powell/gists{/gist_id}","starred_url":"https://api.github.com/users/p-powell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/p-powell/subscriptions","organizations_url":"https://api.github.com/users/p-powell/orgs","repos_url":"https://api.github.com/users/p-powell/repos","events_url":"https://api.github.com/users/p-powell/events{/privacy}","received_events_url":"https://api.github.com/users/p-powell/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T16:03:06Z","updated_at":"2022-04-19T16:03:06Z","author_association":"NONE","body":"@codope Thanks for the response. Strange I get 333s when I call the parquet writer directly using the exact snippet provided. Should hudi write and parquet write be similar in performance?  Really new to hudi and not sure if there are some optimization I can make.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102828050/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102842835","html_url":"https://github.com/apache/hudi/pull/5177#issuecomment-1102842835","issue_url":"https://api.github.com/repos/apache/hudi/issues/5177","id":1102842835,"node_id":"IC_kwDOBI7nWM5BvAvT","user":{"login":"xushiyan","id":2701446,"node_id":"MDQ6VXNlcjI3MDE0NDY=","avatar_url":"https://avatars.githubusercontent.com/u/2701446?v=4","gravatar_id":"","url":"https://api.github.com/users/xushiyan","html_url":"https://github.com/xushiyan","followers_url":"https://api.github.com/users/xushiyan/followers","following_url":"https://api.github.com/users/xushiyan/following{/other_user}","gists_url":"https://api.github.com/users/xushiyan/gists{/gist_id}","starred_url":"https://api.github.com/users/xushiyan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xushiyan/subscriptions","organizations_url":"https://api.github.com/users/xushiyan/orgs","repos_url":"https://api.github.com/users/xushiyan/repos","events_url":"https://api.github.com/users/xushiyan/events{/privacy}","received_events_url":"https://api.github.com/users/xushiyan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T16:18:17Z","updated_at":"2022-04-19T16:18:17Z","author_association":"MEMBER","body":"@nsivabalan we can make use of this to dig further. @liujinhui1994 this is a crucial fix. thanks for putting it up. Have you tried to reproduce locally ? like running the same command as CI does. I suspect either maven surefire plugin issue or the way junit handles scala testing is faulty. maybe try upgrade?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102842835/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102918926","html_url":"https://github.com/apache/hudi/issues/5298#issuecomment-1102918926","issue_url":"https://api.github.com/repos/apache/hudi/issues/5298","id":1102918926,"node_id":"IC_kwDOBI7nWM5BvTUO","user":{"login":"kasured","id":4102441,"node_id":"MDQ6VXNlcjQxMDI0NDE=","avatar_url":"https://avatars.githubusercontent.com/u/4102441?v=4","gravatar_id":"","url":"https://api.github.com/users/kasured","html_url":"https://github.com/kasured","followers_url":"https://api.github.com/users/kasured/followers","following_url":"https://api.github.com/users/kasured/following{/other_user}","gists_url":"https://api.github.com/users/kasured/gists{/gist_id}","starred_url":"https://api.github.com/users/kasured/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kasured/subscriptions","organizations_url":"https://api.github.com/users/kasured/orgs","repos_url":"https://api.github.com/users/kasured/repos","events_url":"https://api.github.com/users/kasured/events{/privacy}","received_events_url":"https://api.github.com/users/kasured/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T17:42:28Z","updated_at":"2022-04-19T17:42:28Z","author_association":"NONE","body":"I can see that the fix version is 0.11.0. Can this patch be safely backported to 0.9.0 though?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102918926/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102925668","html_url":"https://github.com/apache/hudi/issues/5291#issuecomment-1102925668","issue_url":"https://api.github.com/repos/apache/hudi/issues/5291","id":1102925668,"node_id":"IC_kwDOBI7nWM5BvU9k","user":{"login":"zhedoubushishi","id":31263084,"node_id":"MDQ6VXNlcjMxMjYzMDg0","avatar_url":"https://avatars.githubusercontent.com/u/31263084?v=4","gravatar_id":"","url":"https://api.github.com/users/zhedoubushishi","html_url":"https://github.com/zhedoubushishi","followers_url":"https://api.github.com/users/zhedoubushishi/followers","following_url":"https://api.github.com/users/zhedoubushishi/following{/other_user}","gists_url":"https://api.github.com/users/zhedoubushishi/gists{/gist_id}","starred_url":"https://api.github.com/users/zhedoubushishi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhedoubushishi/subscriptions","organizations_url":"https://api.github.com/users/zhedoubushishi/orgs","repos_url":"https://api.github.com/users/zhedoubushishi/repos","events_url":"https://api.github.com/users/zhedoubushishi/events{/privacy}","received_events_url":"https://api.github.com/users/zhedoubushishi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T17:50:13Z","updated_at":"2022-04-19T17:53:06Z","author_association":"CONTRIBUTOR","body":"First thing is it should be something like `HUDI_CONF_DIR='s3://glue-development-bucket/scripts/hudi-conf/`. This is just the directory path. And the config file name should be `hudi-defaults.conf` rather than `hudi-default.conf` since we hard code the config file name.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1102925668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103215308","html_url":"https://github.com/apache/hudi/pull/5365#issuecomment-1103215308","issue_url":"https://api.github.com/repos/apache/hudi/issues/5365","id":1103215308,"node_id":"IC_kwDOBI7nWM5BwbrM","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T22:06:30Z","updated_at":"2022-04-19T22:06:30Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"d13ebe715c323a13ecc9db28dba9986bd43455c1\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8147\",\n    \"triggerID\" : \"d13ebe715c323a13ecc9db28dba9986bd43455c1\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* d13ebe715c323a13ecc9db28dba9986bd43455c1 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8147) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103215308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103241149","html_url":"https://github.com/apache/hudi/pull/5364#issuecomment-1103241149","issue_url":"https://api.github.com/repos/apache/hudi/issues/5364","id":1103241149,"node_id":"IC_kwDOBI7nWM5Bwh-9","user":{"login":"alexeykudinkin","id":428277,"node_id":"MDQ6VXNlcjQyODI3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/428277?v=4","gravatar_id":"","url":"https://api.github.com/users/alexeykudinkin","html_url":"https://github.com/alexeykudinkin","followers_url":"https://api.github.com/users/alexeykudinkin/followers","following_url":"https://api.github.com/users/alexeykudinkin/following{/other_user}","gists_url":"https://api.github.com/users/alexeykudinkin/gists{/gist_id}","starred_url":"https://api.github.com/users/alexeykudinkin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexeykudinkin/subscriptions","organizations_url":"https://api.github.com/users/alexeykudinkin/orgs","repos_url":"https://api.github.com/users/alexeykudinkin/repos","events_url":"https://api.github.com/users/alexeykudinkin/events{/privacy}","received_events_url":"https://api.github.com/users/alexeykudinkin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T22:55:49Z","updated_at":"2022-04-19T22:55:49Z","author_association":"CONTRIBUTOR","body":"@xiarixiaoyao please take a look as well","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103241149/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103244072","html_url":"https://github.com/apache/hudi/issues/5291#issuecomment-1103244072","issue_url":"https://api.github.com/repos/apache/hudi/issues/5291","id":1103244072,"node_id":"IC_kwDOBI7nWM5Bwiso","user":{"login":"MoustafaAMahmoud","id":13502087,"node_id":"MDQ6VXNlcjEzNTAyMDg3","avatar_url":"https://avatars.githubusercontent.com/u/13502087?v=4","gravatar_id":"","url":"https://api.github.com/users/MoustafaAMahmoud","html_url":"https://github.com/MoustafaAMahmoud","followers_url":"https://api.github.com/users/MoustafaAMahmoud/followers","following_url":"https://api.github.com/users/MoustafaAMahmoud/following{/other_user}","gists_url":"https://api.github.com/users/MoustafaAMahmoud/gists{/gist_id}","starred_url":"https://api.github.com/users/MoustafaAMahmoud/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MoustafaAMahmoud/subscriptions","organizations_url":"https://api.github.com/users/MoustafaAMahmoud/orgs","repos_url":"https://api.github.com/users/MoustafaAMahmoud/repos","events_url":"https://api.github.com/users/MoustafaAMahmoud/events{/privacy}","received_events_url":"https://api.github.com/users/MoustafaAMahmoud/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T23:02:12Z","updated_at":"2022-04-20T23:15:50Z","author_association":"NONE","body":"~~The warning disappeared, I will verify it is working fine and share the output.~~ It still there. I added the details in the next comment\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103244072/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103282734","html_url":"https://github.com/apache/hudi/issues/4745#issuecomment-1103282734","issue_url":"https://api.github.com/repos/apache/hudi/issues/4745","id":1103282734,"node_id":"IC_kwDOBI7nWM5BwsIu","user":{"login":"harishraju-govindaraju","id":97610641,"node_id":"U_kgDOBdFrkQ","avatar_url":"https://avatars.githubusercontent.com/u/97610641?v=4","gravatar_id":"","url":"https://api.github.com/users/harishraju-govindaraju","html_url":"https://github.com/harishraju-govindaraju","followers_url":"https://api.github.com/users/harishraju-govindaraju/followers","following_url":"https://api.github.com/users/harishraju-govindaraju/following{/other_user}","gists_url":"https://api.github.com/users/harishraju-govindaraju/gists{/gist_id}","starred_url":"https://api.github.com/users/harishraju-govindaraju/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/harishraju-govindaraju/subscriptions","organizations_url":"https://api.github.com/users/harishraju-govindaraju/orgs","repos_url":"https://api.github.com/users/harishraju-govindaraju/repos","events_url":"https://api.github.com/users/harishraju-govindaraju/events{/privacy}","received_events_url":"https://api.github.com/users/harishraju-govindaraju/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T00:13:17Z","updated_at":"2022-04-20T00:13:17Z","author_association":"NONE","body":"Please mark this closed. The issue was our source files were csv gzip and it was not splittable to read the files parallely. we used a custom library that reads csv gzip in a splittable fashion and then we saw reduction in hudi blulk loads.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103282734/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103299526","html_url":"https://github.com/apache/hudi/issues/5291#issuecomment-1103299526","issue_url":"https://api.github.com/repos/apache/hudi/issues/5291","id":1103299526,"node_id":"IC_kwDOBI7nWM5BwwPG","user":{"login":"MoustafaAMahmoud","id":13502087,"node_id":"MDQ6VXNlcjEzNTAyMDg3","avatar_url":"https://avatars.githubusercontent.com/u/13502087?v=4","gravatar_id":"","url":"https://api.github.com/users/MoustafaAMahmoud","html_url":"https://github.com/MoustafaAMahmoud","followers_url":"https://api.github.com/users/MoustafaAMahmoud/followers","following_url":"https://api.github.com/users/MoustafaAMahmoud/following{/other_user}","gists_url":"https://api.github.com/users/MoustafaAMahmoud/gists{/gist_id}","starred_url":"https://api.github.com/users/MoustafaAMahmoud/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MoustafaAMahmoud/subscriptions","organizations_url":"https://api.github.com/users/MoustafaAMahmoud/orgs","repos_url":"https://api.github.com/users/MoustafaAMahmoud/repos","events_url":"https://api.github.com/users/MoustafaAMahmoud/events{/privacy}","received_events_url":"https://api.github.com/users/MoustafaAMahmoud/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T00:32:11Z","updated_at":"2022-04-20T00:32:11Z","author_association":"NONE","body":"@zhedoubushishi  it seems not working\r\n\r\n```python\r\n\r\nimport sys\r\nfrom pyspark.context import SparkContext\r\nfrom pyspark.sql.session import SparkSession\r\nfrom awsglue.context import GlueContext\r\nfrom awsglue.job import Job\r\nfrom awsglue.dynamicframe import DynamicFrame\r\nfrom pyspark.sql.functions import col, to_timestamp, monotonically_increasing_id, to_date, when,lit\r\nfrom awsglue.utils import getResolvedOptions\r\nfrom pyspark.sql.types import *\r\nfrom datetime import datetime\r\nimport os\r\nargs = getResolvedOptions(sys.argv, ['JOB_NAME','curated_bucket'])\r\nos.environ['HUDI_CONF_DIR'] = 's3://glue-development-bucket/scripts/hudi-conf/'\r\n\r\nspark = SparkSession.builder.config('spark.serializer','org.apache.spark.serializer.KryoSerializer')\\\r\n    .config('className', 'org.apache.hudi') \\\r\n    .config('spark.sql.hive.convertMetastoreParquet', 'false') \\\r\n    .config('spark.sql.extensions', 'org.apache.spark.sql.hudi.HoodieSparkSessionExtension') \\\r\n    .getOrCreate()\r\n\r\nsc = spark.sparkContext\r\nglueContext = GlueContext(sc)\r\njob = Job(glueContext)\r\njob.init(args['JOB_NAME'], args)\r\n\r\ndb_name = 'hudi_sql_dml_ddl_hive'\r\nbucket_name = args['curated_bucket']\r\nbucket_prefix = \"data\"\r\ntable_prefix = f\"{bucket_prefix}/{db_name}\"\r\ntable_base_location=f\"s3://{bucket_name}/{table_prefix}\"\r\ntable_name='hudi_tbl_partitioned'\r\ns3_output_path = f\"{table_base_location}/{table_name}\"\r\n\r\nspark.sql(f\"CREATE DATABASE IF NOT EXISTS {db_name};\")\r\nspark.sql(f\"use  {db_name};\")\r\nspark.sql(\"show tables;\").show()\r\n\r\nquery_create_tbl = f\"\"\"\r\ncreate table if not exists {db_name}.{table_name} (\r\n  id bigint,\r\n  name string,\r\n  ts bigint,\r\n  dt string,\r\n  hh string\r\n)   using hudi\r\noptions (\r\n  hoodie.table.name = '{table_name}',\r\n  path = '{s3_output_path}',\r\n  hoodie.datasource.hive_sync.table = '{table_name}'\r\n)\r\npartitioned by (dt, hh);\r\n\"\"\"\r\n\r\nspark.sql(query_create_tbl)\r\n\r\nprint(f\"\"\"SHOW CREATE TABLE {table_name};\"\"\")\r\nspark.sql(f\"SHOW CREATE TABLE {table_name};\").show(truncate=False)\r\n\r\nprint(f\"\"\"show partitions {table_name};\"\"\")\r\nspark.sql(f\"\"\"show partitions {table_name};\"\"\").show(truncate=False)\r\n\r\n#insert dynamic partition\r\nprint(f\"\"\"insert dynamic partition\"\"\")\r\nprint(f\"\"\"insert into {db_name}.{table_name} partition (dt, hh) select 1 as product_id, 'a1' as product_name, 1000 as ts, '2021-12-09' as dt, '10' as hh;\"\"\")\r\nspark.sql(f\"\"\"insert into {db_name}.{table_name} partition (dt, hh) select 1 as product_id, 'a1' as product_name, 1000 as ts, '2021-12-09' as dt, '10' as hh;\"\"\")\r\nspark.sql(f\"select * from {db_name}.{table_name};\").show(truncate=False)\r\n\r\n\r\nprint(\"insert static partition\")\r\nspark.sql(f\"\"\"insert into {db_name}.{table_name} partition(dt = '2021-12-09', hh='11') select 2, 'a2', 2000;\"\"\")\r\nspark.sql(f\"\"\"insert into {db_name}.{table_name} partition(dt = '2021-12-10', hh='11') select 3, 'a3', 3000;\"\"\")\r\nspark.sql(f\"\"\"insert into {db_name}.{table_name} partition(dt = '2021-12-10', hh='10') select 4, 'a4', 4000;\"\"\")\r\nspark.sql(f\"select * from {db_name}.{table_name};\").show(truncate=False)\r\n\r\n#show partition:\r\nprint(f\"\"\"show partitions {table_name};\"\"\")\r\nspark.sql(f\"\"\"show partitions {table_name};\"\"\").show(truncate=False)\r\n\r\n#drop partition：\r\nprint(f\"\"\"alter table {table_name} drop partition (dt='2021-12-09', hh='10');\"\"\")\r\nspark.sql(f\"\"\"alter table {table_name} drop partition (dt='2021-12-09', hh='10');\"\"\")\r\n\r\nprint(f\"\"\"show partitions {table_name}; after alter\"\"\")\r\n#show partition:\r\nspark.sql(f\"\"\"show partitions {table_name};\"\"\").show(truncate=False)\r\n\r\nspark.sql(f\"select * from {db_name}.{table_name};\").show(truncate=False)\r\n\r\n\r\n```\r\n\r\nhudi-defaults.conf\r\n\r\n```properties\r\n# Default system properties included when running Hudi jobs.\r\n# This is useful for setting default environmental settings.\r\n\r\n# Example:\r\nhoodie.datasource.write.table.type                      MERGE_ON_READ\r\n\r\n# commonConfig\r\nclassName                                               org.apache.hudi\r\nhoodie.datasource.hive_sync.use_jdbc                    false\r\nhoodie.datasource.write.precombine.field                ts\r\nhoodie.datasource.write.recordkey.field                 id\r\nhoodie.consistency.check.enabled                        true\r\nhoodie.datasource.hive_sync.database                    hudi_sql_dml_ddl_hive\r\nhoodie.datasource.hive_sync.enable                      true\r\nhoodie.metrics.on                                       true\r\nhoodie.metrics.reporter.type                            CLOUDWATCH\r\n\r\n#partitionDataConfig\r\nhoodie.datasource.hive_sync.partition_extractor_class   org.apache.hudi.hive.MultiPartKeysValueExtractor\r\nhoodie.datasource.write.hive_style_partitioning         true\r\nhoodie.datasource.write.partitionpath.urlencode         true\r\nhoodie.datasource.hive_sync.partition_fields            dt,hh\r\nhoodie.datasource.write.partitionpath.field             dt,hh\r\n\r\n# incrementalConfig\r\nhoodie.datasource.write.operation                       upsert\r\nhoodie.cleaner.policy                                   KEEP_LATEST_COMMITS\r\nhoodie.cleaner.commits.retained                         1\r\n\r\nhoodie.insert.shuffle.parallelism                       1\r\nhoodie.upsert.shuffle.parallelism                       1\r\nhoodie.update.shuffle.parallelism                       1\r\n\r\n```\r\n\r\nFull logs\r\n\r\n```html\r\n<html>\r\n<head> Glue logs </head>\r\n<body>\r\nawsglue-todworkers-iad-prod-2d-0a589c0e.us-east-1.amazon.com Tue Mar 29 16:05:52 UTC 2022 gluetod\r\nPreparing ...\r\nWed Apr 20 00:27:20 UTC 2022\r\n/usr/bin/java -cp /tmp:/opt/amazon/conf:/opt/amazon/glue-manifest.jar com.amazonaws.services.glue.PrepareLaunch --conf spark.dynamicAllocation.enabled=true --conf spark.shuffle.service.enabled=true --conf spark.dynamicAllocation.minExecutors=1 --conf spark.dynamicAllocation.maxExecutors=4 --conf spark.executor.memory=10g --conf spark.executor.cores=8 --conf spark.driver.memory=10g --conf spark.default.parallelism=40 --conf spark.sql.shuffle.partitions=40 --conf spark.network.timeout=600   --enable-glue-datacatalog true --job-bookmark-option job-bookmark-enable --TempDir s3://glue-development-bucket/temp/ --extra-jars s3://glue-development-bucket/jars/glue3/hudi-utilities-bundle_2.12-0.10.1.jar,s3://glue-development-bucket/jars/glue3/hudi-spark3.1.1-bundle_2.12-0.10.1.jar,s3://glue-development-bucket/jars/glue3/calcite-core-1.10.0.jar,s3://glue-development-bucket/jars/glue3/datanucleus-core-4.1.17.jar  --class GlueApp --JOB_ID j_b5ac6a0ebf4aaec1f512936c33608ce4cdd7601ac725d5e67710eaefe1581c46 --curated_bucket hudi-upgrade --enable-metrics true --spark-event-logs-path s3://glue-development-bucket/logs/  --JOB_RUN_ID jr_d23ecbb5f94c3aa3926907fde84f202e5830a8d7676ade74c2cc7bf3522642df --enable-continuous-cloudwatch-log true --scriptLocation s3://glue-development-bucket/scripts/hudi-spark-sql-test.py  --job-language python --JOB_NAME hudi-spark-sql-test\r\n1650414449874\r\nSLF4J: Class path contains multiple SLF4J bindings.\r\nSLF4J: Found binding in [jar:file:/opt/amazon/spark/jars/slf4j-log4j12-1.7.30.jar!/org/slf4j/impl/StaticLoggerBinder.class]\r\nSLF4J: Found binding in [jar:file:/opt/amazon/lib/Log4j-slf4j-2.x.jar!/org/slf4j/impl/StaticLoggerBinder.class]\r\nSLF4J: Found binding in [jar:file:/opt/amazon/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]\r\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\r\nSLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]\r\nINFO\t2022-04-20 00:27:31,785\t0\tcom.amazonaws.services.glue.PrepareLaunch\t[main]\tglue.etl.telemetry.runtimeImproveFeature.jobInsights30, jr_d23ecbb5f94c3aa3926907fde84f202e5830a8d7676ade74c2cc7bf3522642df\r\nGlue analyzer rules s3://aws-glue-jes-prod-us-east-1-assets/etl/analysis-rules/glue3/\r\nGlueTelemetry: Current region us-east-1\r\nGlueTelemetry: Glue Endpoint https://glue.us-east-1.amazonaws.com\r\nGlueTelemetry: Prod env...false\r\nGlueTelemetry: is disabled\r\nGlue ETL Marketplace - Start ETL connector activation process...\r\nGlue ETL Marketplace - no connections are attached to job hudi-spark-sql-test, no need to download custom connector jar for it.\r\nGlue ETL Marketplace - Retrieved no ETL connector jars, this may be due to no marketplace/custom connection attached to the job or failure of downloading them, please scroll back to the previous logs to find out the root cause. Container setup continues.\r\nGlue ETL Marketplace - ETL connector activation process finished, container setup continues...\r\nLaunching ...\r\nWed Apr 20 00:27:36 UTC 2022\r\n/usr/bin/java -cp /tmp:/opt/amazon/conf:/opt/amazon/glue-manifest.jar:/tmp/* -Dlog4j.configuration=log4j -server -Xmx10g -XX:+UseG1GC -XX:MaxHeapFreeRatio=70 -XX:InitiatingHeapOccupancyPercent=45 -XX:OnOutOfMemoryError=kill -9 %p -XX:+UseCompressedOops -Djavax.net.ssl.trustStore=/opt/amazon/certs/ExternalAndAWSTrustStore.jks -Djavax.net.ssl.trustStoreType=JKS -Djavax.net.ssl.trustStorePassword=amazon -DRDS_ROOT_CERT_PATH=/opt/amazon/certs/rds-combined-ca-bundle.pem -DREDSHIFT_ROOT_CERT_PATH=/opt/amazon/certs/redshift-ssl-ca-cert.pem -DRDS_TRUSTSTORE_URL=file:/opt/amazon/certs/RDSTrustStore.jks -Dspark.network.timeout=600 -Dspark.metrics.conf.*.source.jvm.class=org.apache.spark.metrics.source.JvmSource -Dspark.executor.instances=4 -Dspark.driver.cores=4 -Dspark.metrics.conf.*.source.system.class=org.apache.spark.metrics.source.SystemMetricsSource -Dspark.sql.parquet.output.committer.class=com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter -Dspark.script.location=s3://glue-development-bucket/scripts/hudi-spark-sql-test.py -Dspark.sql.shuffle.partitions=16 -Dspark.metrics.conf.*.sink.GlueCloudwatch.jobRunId=jr_d23ecbb5f94c3aa3926907fde84f202e5830a8d7676ade74c2cc7bf3522642df -Dspark.hadoop.aws.glue.endpoint=https://glue.us-east-1.amazonaws.com -Dspark.glueExceptionAnalysisEventLog.dir=/tmp/glue-exception-analysis-logs/ -Dspark.hadoop.mapred.output.direct.EmrFileSystem=true -Dspark.glueJobInsights.enabled=true -Dspark.glue.JOB_NAME=hudi-spark-sql-test -Dspark.glue.USE_PROXY=false -Dspark.eventLog.dir=/tmp/spark-event-logs/ -Dspark.extraListeners=com.amazonaws.services.glueexceptionanalysis.GlueExceptionAnalysisListener -Dspark.hadoop.fs.s3.impl=com.amazon.ws.emr.hadoop.fs.EmrFileSystem -Dspark.hadoop.mapred.output.direct.NativeS3FileSystem=true -Dspark.pyspark.python=/usr/bin/python3 -Dspark.hadoop.hive.metastore.client.factory.class=com.amazonaws.glue.catalog.metastore.AWSGlueDataCatalogHiveClientFactory -Dspark.authenticate.secret=<HIDDEN> -Dspark.glue.extra-jars=s3://glue-development-bucket/jars/glue3/hudi-utilities-bundle_2.12-0.10.1.jar,s3://glue-development-bucket/jars/glue3/hudi-spark3.1.1-bundle_2.12-0.10.1.jar,s3://glue-development-bucket/jars/glue3/calcite-core-1.10.0.jar,s3://glue-development-bucket/jars/glue3/datanucleus-core-4.1.17.jar -Dspark.cloudwatch.logging.ui.showConsoleProgress=true -Dspark.hadoop.mapreduce.fileoutputcommitter.algorithm.version=2 -Dspark.hadoop.glue.michiganCredentialsProviderProxy=com.amazonaws.services.glue.remote.LakeformationCredentialsProvider -Dspark.metrics.conf.driver.source.aggregate.class=org.apache.spark.metrics.source.AggregateMetricsSource -Dspark.glue.JOB_RUN_ID=jr_d23ecbb5f94c3aa3926907fde84f202e5830a8d7676ade74c2cc7bf3522642df -Dspark.glue.enable-continuous-cloudwatch-log=true -Dspark.glue.endpoint=https://glue-jes-prod.us-east-1.amazonaws.com -Dspark.sql.catalogImplementation=hive -Dspark.default.parallelism=16 -Dspark.ui.enabled=false -Dspark.driver.extraClassPath=/tmp:/opt/amazon/conf:/opt/amazon/glue-manifest.jar -Dspark.glue.GLUE_TASK_GROUP_ID=b8ef3e1f-06f7-40c2-b9f8-5a1756468c6c -Dspark.authenticate=true -Dspark.dynamicAllocation.enabled=false -Dspark.dynamicAllocation.maxExecutors=4 -Dspark.shuffle.service.enabled=false -Dspark.hadoop.mapred.output.committer.class=org.apache.hadoop.mapred.DirectOutputCommitter -Dspark.executor.extraClassPath=/tmp:/opt/amazon/conf:/opt/amazon/glue-manifest.jar -Dspark.glue.GLUE_VERSION=3.0 -Dspark.executor.cores=4 -Dspark.hadoop.lakeformation.credentials.url=http://localhost:9998/lakeformationcredentials -Dspark.driver.host=172.35.173.163 -Dspark.app.name=nativespark-hudi-spark-sql-test-jr_d23ecbb5f94c3aa3926907fde84f202e5830a8d7676ade74c2cc7bf3522642df -Dspark.sql.parquet.fs.optimized.committer.optimization-enabled=true -Dspark.rpc.askTimeout=600 -Dspark.metrics.conf.*.sink.GlueCloudwatch.jobName=hudi-spark-sql-test -Dspark.metrics.conf.*.source.s3.class=org.apache.spark.metrics.source.S3FileSystemSource -Dspark.metrics.conf.*.sink.GlueCloudwatch.namespace=Glue -Dspark.executor.memory=10g -Dspark.metrics.conf.*.sink.GlueCloudwatch.class=org.apache.spark.metrics.sink.GlueCloudwatchSink -Dspark.driver.memory=10g -Dspark.hadoop.fs.s3.buffer.dir=/tmp/hadoop-spark/s3 -Dspark.glue.GLUE_COMMAND_CRITERIA=glueetl -Dspark.master=jes -Dspark.hadoop.mapreduce.fileoutputcommitter.marksuccessfuljobs=false -Dspark.unsafe.sorter.spill.read.ahead.enabled=false -Dspark.hadoop.parquet.enable.summary-metadata=false -Dspark.glueAppInsightsLog.dir=/tmp/glue-app-insights-logs/ -Dspark.glue.jobLanguage=python -Dspark.files.overwrite=true -Dspark.cloudwatch.logging.conf.jobRunId=jr_d23ecbb5f94c3aa3926907fde84f202e5830a8d7676ade74c2cc7bf3522642df com.amazonaws.services.glue.ProcessLauncher --launch-class org.apache.spark.deploy.PythonRunner /opt/amazon/bin/runscript.py  /tmp/hudi-spark-sql-test.py true --job-bookmark-option job-bookmark-enable --TempDir s3://glue-development-bucket/temp/ --JOB_ID j_b5ac6a0ebf4aaec1f512936c33608ce4cdd7601ac725d5e67710eaefe1581c46 --curated_bucket hudi-upgrade true --spark-event-logs-path s3://glue-development-bucket/logs/ --JOB_RUN_ID jr_d23ecbb5f94c3aa3926907fde84f202e5830a8d7676ade74c2cc7bf3522642df --JOB_NAME hudi-spark-sql-test\r\nSLF4J: Class path contains multiple SLF4J bindings.\r\nSLF4J: Found binding in [jar:file:/opt/amazon/spark/jars/slf4j-log4j12-1.7.30.jar!/org/slf4j/impl/StaticLoggerBinder.class]\r\nSLF4J: Found binding in [jar:file:/opt/amazon/lib/Log4j-slf4j-2.x.jar!/org/slf4j/impl/StaticLoggerBinder.class]\r\nSLF4J: Found binding in [jar:file:/opt/amazon/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]\r\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\r\nContinuous Logging: Creating cloudwatch appender.\r\nContinuous Logging: Creating cloudwatch appender.\r\nContinuous Logging: Creating cloudwatch appender.\r\nContinuous Logging: Creating cloudwatch appender.\r\n\r\nSLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]\r\n\r\nSLF4J: A number (14) of logging calls during the initialization phase have been intercepted and are\r\n\r\nSLF4J: now being replayed. These are subject to the filtering rules of the underlying logging system.\r\n\r\nSLF4J: See also http://www.slf4j.org/codes.html#replay\r\n\r\n2022-04-20 00:27:40,055 INFO [Thread-6] glue.AnalyzerLogHelper$ (Logging.scala:logInfo(24)): SLF4J: Class path contains multiple SLF4J bindings.\r\n2022-04-20 00:27:40,058 INFO [Thread-6] glue.AnalyzerLogHelper$ (Logging.scala:logInfo(24)): SLF4J: Found binding in [jar:file:/opt/amazon/spark/jars/slf4j-log4j12-1.7.30.jar!/org/slf4j/impl/StaticLoggerBinder.class]\r\n2022-04-20 00:27:40,059 INFO [Thread-6] glue.AnalyzerLogHelper$ (Logging.scala:logInfo(24)): SLF4J: Found binding in [jar:file:/opt/amazon/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]\r\n2022-04-20 00:27:40,059 INFO [Thread-6] glue.AnalyzerLogHelper$ (Logging.scala:logInfo(24)): SLF4J: Found binding in [jar:file:/opt/amazon/lib/Log4j-slf4j-2.x.jar!/org/slf4j/impl/StaticLoggerBinder.class]\r\n2022-04-20 00:27:40,059 INFO [Thread-6] glue.AnalyzerLogHelper$ (Logging.scala:logInfo(24)): SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\r\n2022-04-20 00:27:40,076 INFO [Thread-6] glue.AnalyzerLogHelper$ (Logging.scala:logInfo(24)): SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]\r\n2022-04-20 00:27:40,459 INFO [Thread-6] glue.AnalyzerLogHelper$ (Logging.scala:logInfo(24)): log4j:WARN No appenders could be found for logger (org.apache.hadoop.util.Shell).\r\n2022-04-20 00:27:40,460 INFO [Thread-6] glue.AnalyzerLogHelper$ (Logging.scala:logInfo(24)): log4j:WARN Please initialize the log4j system properly.\r\n2022-04-20 00:27:40,460 INFO [Thread-6] glue.AnalyzerLogHelper$ (Logging.scala:logInfo(24)): log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.\r\n2022-04-20 00:27:41,440 INFO [Thread-6] glue.AnalyzerLogHelper$ (Logging.scala:logInfo(24)): ==== Netty Server Started ====\r\n2022-04-20 00:27:41,443 INFO [Thread-6] glue.AnalyzerLogHelper$ (Logging.scala:logInfo(24)): input rulesFilePath=/tmp/glue_app_analyzer_rules\r\n2022-04-20 00:27:41,565 INFO [main] glue.SafeLogging (Logging.scala:logInfo(57)): Initializing logging subsystem\r\n2022-04-20 00:27:43,949 INFO [Thread-10] spark.SparkContext (Logging.scala:logInfo(57)): Running Spark version 3.1.1-amzn-0\r\n2022-04-20 00:27:44,038 INFO [Thread-10] resource.ResourceUtils (Logging.scala:logInfo(57)): ==============================================================\r\n2022-04-20 00:27:44,040 INFO [Thread-10] resource.ResourceUtils (Logging.scala:logInfo(57)): No custom resources configured for spark.driver.\r\n2022-04-20 00:27:44,041 INFO [Thread-10] resource.ResourceUtils (Logging.scala:logInfo(57)): ==============================================================\r\n2022-04-20 00:27:44,043 INFO [Thread-10] spark.SparkContext (Logging.scala:logInfo(57)): Submitted application: nativespark-hudi-spark-sql-test-jr_d23ecbb5f94c3aa3926907fde84f202e5830a8d7676ade74c2cc7bf3522642df\r\n2022-04-20 00:27:44,076 INFO [Thread-10] resource.ResourceProfile (Logging.scala:logInfo(57)): Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 4, script: , vendor: , memory -> name: memory, amount: 10240, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)\r\n2022-04-20 00:27:44,101 INFO [Thread-10] resource.ResourceProfile (Logging.scala:logInfo(57)): Limiting resource is cpus at 4 tasks per executor\r\n2022-04-20 00:27:44,107 INFO [Thread-10] resource.ResourceProfileManager (Logging.scala:logInfo(57)): Added ResourceProfile id: 0\r\n2022-04-20 00:27:44,212 INFO [Thread-10] spark.SecurityManager (Logging.scala:logInfo(57)): Changing view acls to: spark\r\n2022-04-20 00:27:44,212 INFO [Thread-10] spark.SecurityManager (Logging.scala:logInfo(57)): Changing modify acls to: spark\r\n2022-04-20 00:27:44,213 INFO [Thread-10] spark.SecurityManager (Logging.scala:logInfo(57)): Changing view acls groups to: \r\n2022-04-20 00:27:44,214 INFO [Thread-10] spark.SecurityManager (Logging.scala:logInfo(57)): Changing modify acls groups to: \r\n2022-04-20 00:27:44,214 INFO [Thread-10] spark.SecurityManager (Logging.scala:logInfo(57)): SecurityManager: authentication enabled; ui acls disabled; users  with view permissions: Set(spark); groups with view permissions: Set(); users  with modify permissions: Set(spark); groups with modify permissions: Set()\r\n2022-04-20 00:27:44,605 INFO [Thread-10] util.Utils (Logging.scala:logInfo(57)): Successfully started service 'sparkDriver' on port 32837.\r\n2022-04-20 00:27:44,672 INFO [Thread-10] spark.SparkEnv (Logging.scala:logInfo(57)): Registering MapOutputTracker\r\n2022-04-20 00:27:44,727 INFO [Thread-10] spark.SparkEnv (Logging.scala:logInfo(57)): Registering BlockManagerMaster\r\n2022-04-20 00:27:44,769 INFO [Thread-10] storage.BlockManagerMasterEndpoint (Logging.scala:logInfo(57)): Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information\r\n2022-04-20 00:27:44,770 INFO [Thread-10] storage.BlockManagerMasterEndpoint (Logging.scala:logInfo(57)): BlockManagerMasterEndpoint up\r\n2022-04-20 00:27:44,792 INFO [Thread-10] spark.SparkEnv (Logging.scala:logInfo(57)): Registering BlockManagerMasterHeartbeat\r\n2022-04-20 00:27:44,864 INFO [Thread-10] storage.DiskBlockManager (Logging.scala:logInfo(57)): Created local directory at /tmp/blockmgr-1c1f7a46-9b63-4617-938e-45f9b509cc03\r\n2022-04-20 00:27:44,921 INFO [Thread-10] memory.MemoryStore (Logging.scala:logInfo(57)): MemoryStore started with capacity 5.8 GiB\r\n2022-04-20 00:27:44,956 INFO [Thread-10] spark.SparkEnv (Logging.scala:logInfo(57)): Registering OutputCommitCoordinator\r\n2022-04-20 00:27:45,131 INFO [Thread-10] scheduler.JESSchedulerBackend$JESAsSchedulerBackendEndpoint (Logging.scala:logInfo(57)): JESAsSchedulerBackendEndpoint\r\n2022-04-20 00:27:45,133 INFO [Thread-10] scheduler.JESSchedulerBackend (Logging.scala:logInfo(57)): JESSchedulerBackend\r\n2022-04-20 00:27:45,456 INFO [allocator] glue.TaskGroupInterface (Logging.scala:logInfo(57)): creating executor task for executor 1\r\n2022-04-20 00:27:45,492 INFO [Thread-10] util.Utils (Logging.scala:logInfo(57)): Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 39319.\r\n2022-04-20 00:27:45,493 INFO [Thread-10] netty.NettyBlockTransferService (NettyBlockTransferService.scala:init(81)): Server created on 172.35.173.163:39319\r\n2022-04-20 00:27:45,497 INFO [Thread-10] storage.BlockManager (Logging.scala:logInfo(57)): Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy\r\n2022-04-20 00:27:45,520 INFO [Thread-10] storage.BlockManagerMaster (Logging.scala:logInfo(57)): Registering BlockManager BlockManagerId(driver, 172.35.173.163, 39319, None)\r\n2022-04-20 00:27:45,524 INFO [dispatcher-BlockManagerMaster] storage.BlockManagerMasterEndpoint (Logging.scala:logInfo(57)): Registering block manager 172.35.173.163:39319 with 5.8 GiB RAM, BlockManagerId(driver, 172.35.173.163, 39319, None)\r\n2022-04-20 00:27:45,530 INFO [Thread-10] storage.BlockManagerMaster (Logging.scala:logInfo(57)): Registered BlockManager BlockManagerId(driver, 172.35.173.163, 39319, None)\r\n2022-04-20 00:27:45,531 INFO [Thread-10] storage.BlockManager (Logging.scala:logInfo(57)): Initialized BlockManager: BlockManagerId(driver, 172.35.173.163, 39319, None)\r\n2022-04-20 00:27:45,684 INFO [Thread-10] sink.GlueCloudwatchSink (GlueCloudwatchSink.scala:logInfo(22)): CloudwatchSink: Obtained credentials from the Instance Profile\r\n2022-04-20 00:27:45,753 INFO [Thread-10] sink.GlueCloudwatchSink (GlueCloudwatchSink.scala:logInfo(22)): CloudwatchSink: jobName: hudi-spark-sql-test jobRunId: jr_d23ecbb5f94c3aa3926907fde84f202e5830a8d7676ade74c2cc7bf3522642df\r\n2022-04-20 00:27:45,952 INFO [Thread-10] util.log (Log.java:initialized(169)): Logging initialized @9785ms to org.sparkproject.jetty.util.log.Slf4jLog\r\n2022-04-20 00:27:46,170 INFO [Thread-10] glueexceptionanalysis.EventLogFileWriter (FileWriter.scala:start(51)): Started file writer for com.amazonaws.services.glueexceptionanalysis.EventLogFileWriter\r\n2022-04-20 00:27:46,200 INFO [Thread-10] glueexceptionanalysis.EventLogSocketWriter (SocketWriter.scala:start(34)): Socket client for com.amazonaws.services.glueexceptionanalysis.EventLogSocketWriter started correctly\r\n2022-04-20 00:27:46,222 INFO [Thread-10] spark.SparkContext (Logging.scala:logInfo(57)): Registered listener com.amazonaws.services.glueexceptionanalysis.GlueExceptionAnalysisListener\r\n2022-04-20 00:27:46,322 INFO [allocator] glue.TaskGroupInterface (Logging.scala:logInfo(57)): createChildTask API response code 200\r\n2022-04-20 00:27:46,331 INFO [allocator] glue.ExecutorTaskManagement (Logging.scala:logInfo(57)): executor task g-1b2e819c3f4b83c04b4894f402137ccdb61cf885 created for executor 1\r\n2022-04-20 00:27:46,336 INFO [allocator] glue.TaskGroupInterface (Logging.scala:logInfo(57)): creating executor task for executor 2\r\n2022-04-20 00:27:46,333 INFO [Thread-10] scheduler.JESSchedulerBackend (Logging.scala:logInfo(57)): SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0\r\n2022-04-20 00:27:46,602 INFO [allocator] glue.TaskGroupInterface (Logging.scala:logInfo(57)): createChildTask API response code 200\r\n2022-04-20 00:27:46,602 INFO [allocator] glue.ExecutorTaskManagement (Logging.scala:logInfo(57)): executor task g-35e4f8ad9be7146bb0a17daa6bbf5f0aaeb24ad5 created for executor 2\r\n2022-04-20 00:27:46,603 INFO [allocator] glue.TaskGroupInterface (Logging.scala:logInfo(57)): creating executor task for executor 3\r\n2022-04-20 00:27:46,900 INFO [allocator] glue.TaskGroupInterface (Logging.scala:logInfo(57)): createChildTask API response code 200\r\n2022-04-20 00:27:46,901 INFO [allocator] glue.ExecutorTaskManagement (Logging.scala:logInfo(57)): executor task g-205779aebb30eba354306f8d2a7c98052d7de372 created for executor 3\r\n2022-04-20 00:27:46,902 INFO [allocator] glue.TaskGroupInterface (Logging.scala:logInfo(57)): creating executor task for executor 4\r\n2022-04-20 00:27:47,080 INFO [Thread-10] internal.SharedState (Logging.scala:logInfo(57)): Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/tmp/spark-warehouse').\r\n2022-04-20 00:27:47,081 INFO [Thread-10] internal.SharedState (Logging.scala:logInfo(57)): Warehouse path is 'file:/tmp/spark-warehouse'.\r\n2022-04-20 00:27:47,252 INFO [allocator] glue.TaskGroupInterface (Logging.scala:logInfo(57)): createChildTask API response code 200\r\n2022-04-20 00:27:47,253 INFO [allocator] glue.ExecutorTaskManagement (Logging.scala:logInfo(57)): executor task g-a4c51ec9fbbe46ea1cbf28d272842588bf0c9e00 created for executor 4\r\n2022-04-20 00:27:48,338 INFO [Thread-10] glue.GlueContext (GlueContext.scala:<init>(117)): GlueMetrics configured and enabled\r\n2022-04-20 00:27:49,312 INFO [Thread-10] util.PlatformInfo (PlatformInfo.java:getJobFlowId(56)): Unable to read clusterId from http://localhost:8321/configuration, trying extra instance data file: /var/lib/instance-controller/extraInstanceData.json\r\n2022-04-20 00:27:49,316 INFO [Thread-10] util.PlatformInfo (PlatformInfo.java:getJobFlowId(63)): Unable to read clusterId from /var/lib/instance-controller/extraInstanceData.json, trying EMR job-flow data file: /var/lib/info/job-flow.json\r\n2022-04-20 00:27:49,317 INFO [Thread-10] util.PlatformInfo (PlatformInfo.java:getJobFlowId(71)): Unable to read clusterId from /var/lib/info/job-flow.json, out of places to look\r\n2022-04-20 00:27:50,232 INFO [Thread-10] util.AvroReaderUtil$ (AvroReaderUtil.scala:getFieldParser(245)): Creating default Avro field parser for version 1.7.\r\n2022-04-20 00:27:50,448 INFO [Thread-10] memory.MemoryStore (Logging.scala:logInfo(57)): Block broadcast_0 stored as values in memory (estimated size 311.9 KiB, free 5.8 GiB)\r\n2022-04-20 00:27:51,456 INFO [Thread-10] memory.MemoryStore (Logging.scala:logInfo(57)): Block broadcast_0_piece0 stored as bytes in memory (estimated size 105.0 B, free 5.8 GiB)\r\n2022-04-20 00:27:51,459 INFO [dispatcher-BlockManagerMaster] storage.BlockManagerInfo (Logging.scala:logInfo(57)): Added broadcast_0_piece0 in memory on 172.35.173.163:39319 (size: 105.0 B, free: 5.8 GiB)\r\n2022-04-20 00:27:51,463 INFO [Thread-10] spark.SparkContext (Logging.scala:logInfo(57)): Created broadcast 0 from broadcast at DynamoConnection.scala:53\r\n2022-04-20 00:27:51,481 INFO [Thread-10] memory.MemoryStore (Logging.scala:logInfo(57)): Block broadcast_1 stored as values in memory (estimated size 311.9 KiB, free 5.8 GiB)\r\n2022-04-20 00:27:51,486 INFO [Thread-10] memory.MemoryStore (Logging.scala:logInfo(57)): Block broadcast_1_piece0 stored as bytes in memory (estimated size 105.0 B, free 5.8 GiB)\r\n2022-04-20 00:27:51,487 INFO [dispatcher-BlockManagerMaster] storage.BlockManagerInfo (Logging.scala:logInfo(57)): Added broadcast_1_piece0 in memory on 172.35.173.163:39319 (size: 105.0 B, free: 5.8 GiB)\r\n2022-04-20 00:27:51,490 INFO [Thread-10] spark.SparkContext (Logging.scala:logInfo(57)): Created broadcast 1 from broadcast at DynamoConnection.scala:53\r\nANTLR Tool version 4.7 used for code generation does not match the current runtime version 4.8\r\n2022-04-20 00:27:51,681 INFO [dispatcher-BlockManagerMaster] storage.BlockManagerInfo (Logging.scala:logInfo(57)): Removed broadcast_0_piece0 on 172.35.173.163:39319 in memory (size: 105.0 B, free: 5.8 GiB)\r\n2022-04-20 00:27:51,701 INFO [dispatcher-BlockManagerMaster] storage.BlockManagerInfo (Logging.scala:logInfo(57)): Removed broadcast_1_piece0 on 172.35.173.163:39319 in memory (size: 105.0 B, free: 5.8 GiB)\r\nANTLR Tool version 4.7 used for code generation does not match the current runtime version 4.8\r\n2022-04-20 00:27:54,655 INFO [Thread-10] conf.HiveConf (HiveConf.java:findConfigFile(181)): Found configuration file null\r\n2022-04-20 00:27:54,683 INFO [Thread-10] hive.HiveUtils (Logging.scala:logInfo(57)): Initializing HiveMetastoreConnection version 2.3.7-amzn-4 using Spark classes.\r\n2022-04-20 00:27:54,976 INFO [Thread-10] conf.HiveConf (HiveConf.java:findConfigFile(181)): Found configuration file null\r\n2022-04-20 00:27:55,867 INFO [Thread-10] session.SessionState (SessionState.java:createPath(753)): Created HDFS directory: /tmp/hive/spark\r\n2022-04-20 00:27:55,868 INFO [Thread-10] session.SessionState (SessionState.java:createPath(753)): Created local directory: /tmp/spark\r\n2022-04-20 00:27:55,869 INFO [Thread-10] session.SessionState (SessionState.java:createPath(753)): Created HDFS directory: /tmp/hive/spark/8eacaff7-b865-43fc-87f4-d41cbae09a3f\r\n2022-04-20 00:27:55,870 INFO [Thread-10] session.SessionState (SessionState.java:createPath(753)): Created local directory: /tmp/spark/8eacaff7-b865-43fc-87f4-d41cbae09a3f\r\n2022-04-20 00:27:55,870 INFO [Thread-10] session.SessionState (SessionState.java:createPath(753)): Created HDFS directory: /tmp/hive/spark/8eacaff7-b865-43fc-87f4-d41cbae09a3f/_tmp_space.db\r\n2022-04-20 00:27:55,884 INFO [Thread-10] client.HiveClientImpl (Logging.scala:logInfo(57)): Warehouse location for Hive client (version 2.3.7) is file:/tmp/spark-warehouse\r\n2022-04-20 00:27:56,852 INFO [Thread-10] metastore.AWSGlueClientFactory (AWSGlueClientFactory.java:newClient(56)): Setting glue service endpoint to https://glue.us-east-1.amazonaws.com\r\n2022-04-20 00:27:58,069 INFO [Thread-10] common.FileUtils (FileUtils.java:mkdir(520)): Creating directory if it doesn't exist: file:/tmp/spark-warehouse/hudi_sql_dml_ddl_hive.db\r\n2022-04-20 00:27:58,383 INFO [Thread-10] Configuration.deprecation (Configuration.java:logDeprecation(1394)): io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum\r\n2022-04-20 00:27:59,701 INFO [Thread-10] codegen.CodeGenerator (Logging.scala:logInfo(57)): Code generated in 288.195849 ms\r\n2022-04-20 00:27:59,745 INFO [Thread-10] codegen.CodeGenerator (Logging.scala:logInfo(57)): Code generated in 25.989248 ms\r\n2022-04-20 00:28:01,110 INFO [Thread-10] catalog.HoodieCatalogTable (Logging.scala:logInfo(57)): Init hoodie.properties for hudi_sql_dml_ddl_hive.hudi_tbl_partitioned\r\n2022-04-20 00:28:01,115 WARN [Thread-10] config.DFSPropertiesConfiguration (DFSPropertiesConfiguration.java:getConfPathFromEnv(188)): Cannot find HUDI_CONF_DIR, please set it as the dir of hudi-defaults.conf\r\n2022-04-20 00:28:01,202 WARN [Thread-10] config.DFSPropertiesConfiguration (DFSPropertiesConfiguration.java:addPropsFromFile(131)): Properties file file:/etc/hudi/conf/hudi-defaults.conf not found. Ignoring to load props file\r\n2022-04-20 00:28:01,367 ERROR [main] glue.ProcessLauncher (Logging.scala:logError(73)): Error from Python:Traceback (most recent call last):\r\n  File \"/tmp/hudi-spark-sql-test.py\", line 54, in <module>\r\n    spark.sql(query_create_tbl)\r\n  File \"/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py\", line 723, in sql\r\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\r\n  File \"/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py\", line 1305, in __call__\r\n    answer, self.gateway_client, self.target_id, self.name)\r\n  File \"/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py\", line 117, in deco\r\n    raise converted from None\r\npyspark.sql.utils.IllegalArgumentException: Can't find primaryKey `uuid` in root\r\n |-- _hoodie_commit_time: string (nullable = true)\r\n |-- _hoodie_commit_seqno: string (nullable = true)\r\n |-- _hoodie_record_key: string (nullable = true)\r\n |-- _hoodie_partition_path: string (nullable = true)\r\n |-- _hoodie_file_name: string (nullable = true)\r\n |-- id: long (nullable = true)\r\n |-- name: string (nullable = true)\r\n |-- ts: long (nullable = true)\r\n |-- dt: string (nullable = true)\r\n |-- hh: string (nullable = true)\r\n.\r\n2022-04-20 00:28:01,399 ERROR [main] glueexceptionanalysis.GlueExceptionAnalysisListener (Logging.scala:logError(9)): [Glue Exception Analysis] \r\n{\r\n    \"Event\": \"GlueETLJobExceptionEvent\",\r\n    \"Timestamp\": 1650414481388,\r\n    \"Failure Reason\": \"Traceback (most recent call last):\\n  File \\\"/tmp/hudi-spark-sql-test.py\\\", line 54, in <module>\\n    spark.sql(query_create_tbl)\\n  File \\\"/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py\\\", line 723, in sql\\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\\n  File \\\"/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py\\\", line 1305, in __call__\\n    answer, self.gateway_client, self.target_id, self.name)\\n  File \\\"/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py\\\", line 117, in deco\\n    raise converted from None\\npyspark.sql.utils.IllegalArgumentException: Can't find primaryKey `uuid` in root\\n |-- _hoodie_commit_time: string (nullable = true)\\n |-- _hoodie_commit_seqno: string (nullable = true)\\n |-- _hoodie_record_key: string (nullable = true)\\n |-- _hoodie_partition_path: string (nullable = true)\\n |-- _hoodie_file_name: string (nullable = true)\\n |-- id: long (nullable = true)\\n |-- name: string (nullable = true)\\n |-- ts: long (nullable = true)\\n |-- dt: string (nullable = true)\\n |-- hh: string (nullable = true)\\n.\",\r\n    \"Stack Trace\": [\r\n        {\r\n            \"Declaring Class\": \"deco\",\r\n            \"Method Name\": \"raise converted from None\",\r\n            \"File Name\": \"/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py\",\r\n            \"Line Number\": 117\r\n        },\r\n        {\r\n            \"Declaring Class\": \"__call__\",\r\n            \"Method Name\": \"answer, self.gateway_client, self.target_id, self.name)\",\r\n            \"File Name\": \"/opt/amazon/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py\",\r\n            \"Line Number\": 1305\r\n        },\r\n        {\r\n            \"Declaring Class\": \"sql\",\r\n            \"Method Name\": \"return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\",\r\n            \"File Name\": \"/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py\",\r\n            \"Line Number\": 723\r\n        },\r\n        {\r\n            \"Declaring Class\": \"<module>\",\r\n            \"Method Name\": \"spark.sql(query_create_tbl)\",\r\n            \"File Name\": \"/tmp/hudi-spark-sql-test.py\",\r\n            \"Line Number\": 54\r\n        }\r\n    ],\r\n    \"Last Executed Line number\": 54,\r\n    \"script\": \"hudi-spark-sql-test.py\"\r\n}\r\n\r\n2022-04-20 00:28:01,471 ERROR [main] glueexceptionanalysis.GlueExceptionAnalysisListener (Logging.scala:logError(9)): [Glue Exception Analysis] Last Executed Line number from script hudi-spark-sql-test.py: 54\r\n2022-04-20 00:28:01,477 INFO [main] glue.ResourceManagerSocketWriter (SocketWriter.scala:start(34)): Socket client for com.amazonaws.services.glue.ResourceManagerSocketWriter started correctly\r\n2022-04-20 00:28:01,486 INFO [main] glue.ProcessLauncher (Logging.scala:logInfo(57)): postprocessing\r\n2022-04-20 00:28:01,487 INFO [main] glue.AnalyzerLogHelper$ (Logging.scala:logInfo(24)): Analyzer: Error stopping analyzer process null\r\n2022-04-20 00:28:01,487 INFO [main] glue.AnalyzerLogHelper$ (Logging.scala:logInfo(24)): Analyzer: Error terminating analyzer process null\r\n2022-04-20 00:28:01,488 INFO [main] glue.LogPusher (Logging.scala:logInfo(57)): stopping\r\nContinuous Logging: Shutting down cloudwatch appender.\r\n\r\nContinuous Logging: Shutting down cloudwatch appender.\r\nContinuous Logging: Shutting down cloudwatch appender.\r\nContinuous Logging: Shutting down cloudwatch appender.\r\n\r\n2022-04-20 00:28:01,504 INFO [shutdown-hook-0] spark.SparkContext (Logging.scala:logInfo(57)): Invoking stop() from shutdown hook\r\n2022-04-20 00:28:01,517 INFO [spark-listener-group-shared] glueexceptionanalysis.EventLogFileWriter (FileWriter.scala:stop(70)): Logs, events processed and insights are written to file /tmp/glue-exception-analysis-logs/spark-application-1650414465125\r\n2022-04-20 00:28:01,520 INFO [shutdown-hook-0] scheduler.JESSchedulerBackend (Logging.scala:logInfo(57)): Shutting down all executors\r\n2022-04-20 00:28:01,536 INFO [dispatcher-CoarseGrainedScheduler] scheduler.JESSchedulerBackend$JESAsSchedulerBackendEndpoint (Logging.scala:logInfo(57)): Asking each executor to shut down\r\n2022-04-20 00:28:01,555 INFO [dispatcher-event-loop-3] spark.MapOutputTrackerMasterEndpoint (Logging.scala:logInfo(57)): MapOutputTrackerMasterEndpoint stopped!\r\n2022-04-20 00:28:01,556 INFO [Thread-6] glue.AnalyzerLogHelper$ (Logging.scala:logInfo(24)): GlueJobEventsInputHandler Interrupted Last event of a job received. Stop event handling.\r\n2022-04-20 00:28:01,556 INFO [Thread-6] glue.AnalyzerLogHelper$ (Logging.scala:logInfo(24)): Stopping - analyzer netty server\r\n2022-04-20 00:28:01,561 INFO [Thread-6] glue.AnalyzerLogHelper$ (Logging.scala:logInfo(24)): Stopped - analyzer netty server\r\n2022-04-20 00:28:01,561 INFO [Thread-6] glue.AnalyzerLogHelper$ (Logging.scala:logInfo(24)): Processing remaining events in queue before termination\r\n2022-04-20 00:28:01,561 INFO [Thread-6] glue.AnalyzerLogHelper$ (Logging.scala:logInfo(24)): Closing rules engine\r\n2022-04-20 00:28:01,562 INFO [Thread-6] glue.AnalyzerLogHelper$ (Logging.scala:logInfo(24)): Stopping analyzer log writer\r\n2022-04-20 00:28:01,607 INFO [shutdown-hook-0] memory.MemoryStore (Logging.scala:logInfo(57)): MemoryStore cleared\r\n2022-04-20 00:28:01,607 INFO [shutdown-hook-0] storage.BlockManager (Logging.scala:logInfo(57)): BlockManager stopped\r\n2022-04-20 00:28:01,612 INFO [shutdown-hook-0] storage.BlockManagerMaster (Logging.scala:logInfo(57)): BlockManagerMaster stopped\r\n2022-04-20 00:28:01,616 INFO [dispatcher-event-loop-3] scheduler.OutputCommitCoordinator$OutputCommitCoordinatorEndpoint (Logging.scala:logInfo(57)): OutputCommitCoordinator stopped!\r\n2022-04-20 00:28:01,622 INFO [shutdown-hook-0] spark.SparkContext (Logging.scala:logInfo(57)): Successfully stopped SparkContext\r\n2022-04-20 00:28:01,623 INFO [shutdown-hook-0] glue.LogPusher (Logging.scala:logInfo(57)): uploading /tmp/spark-event-logs/ to s3://glue-development-bucket/logs/\r\n2022-04-20 00:28:01,656 INFO [shutdown-hook-0] util.ShutdownHookManager (Logging.scala:logInfo(57)): Shutdown hook called\r\n2022-04-20 00:28:01,657 INFO [shutdown-hook-0] util.ShutdownHookManager (Logging.scala:logInfo(57)): Deleting directory /tmp/spark-4a067bfa-1a27-4b95-b961-1e01f94c5caa/pyspark-c8194dc3-28fb-4e01-a412-cd5f425f032b\r\n2022-04-20 00:28:01,662 INFO [shutdown-hook-0] util.ShutdownHookManager (Logging.scala:logInfo(57)): Deleting directory /tmp/spark-4a067bfa-1a27-4b95-b961-1e01f94c5caa\r\n</body></html>\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103299526/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103302907","html_url":"https://github.com/apache/hudi/issues/5291#issuecomment-1103302907","issue_url":"https://api.github.com/repos/apache/hudi/issues/5291","id":1103302907,"node_id":"IC_kwDOBI7nWM5BwxD7","user":{"login":"MoustafaAMahmoud","id":13502087,"node_id":"MDQ6VXNlcjEzNTAyMDg3","avatar_url":"https://avatars.githubusercontent.com/u/13502087?v=4","gravatar_id":"","url":"https://api.github.com/users/MoustafaAMahmoud","html_url":"https://github.com/MoustafaAMahmoud","followers_url":"https://api.github.com/users/MoustafaAMahmoud/followers","following_url":"https://api.github.com/users/MoustafaAMahmoud/following{/other_user}","gists_url":"https://api.github.com/users/MoustafaAMahmoud/gists{/gist_id}","starred_url":"https://api.github.com/users/MoustafaAMahmoud/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MoustafaAMahmoud/subscriptions","organizations_url":"https://api.github.com/users/MoustafaAMahmoud/orgs","repos_url":"https://api.github.com/users/MoustafaAMahmoud/repos","events_url":"https://api.github.com/users/MoustafaAMahmoud/events{/privacy}","received_events_url":"https://api.github.com/users/MoustafaAMahmoud/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T00:37:37Z","updated_at":"2022-04-20T00:37:37Z","author_association":"NONE","body":"I also tried to add the primaryKey and the preCombineField key, but the output table properties doesn't reflect the default config file. For example, The output table is `cow` and i expect `mor`\r\n\r\n\r\n```python\r\nquery_create_tbl = f\"\"\"\r\ncreate table if not exists {db_name}.{table_name} (\r\n  id bigint,\r\n  name string,\r\n  ts bigint,\r\n  dt string,\r\n  hh string\r\n)   using hudi\r\noptions (\r\n  preCombineField='ts', \r\n  primaryKey='id', \r\n  hoodie.table.name = '{table_name}',\r\n  path = '{s3_output_path}',\r\n  hoodie.datasource.hive_sync.table = '{table_name}'\r\n)\r\npartitioned by (dt, hh);\r\n\"\"\"\r\n```\r\n\r\nThe output table \r\n\r\n```sql\r\nCREATE EXTERNAL TABLE `hudi_tbl_partitioned`(\r\n  `_hoodie_commit_time` string, \r\n  `_hoodie_commit_seqno` string, \r\n  `_hoodie_record_key` string, \r\n  `_hoodie_partition_path` string, \r\n  `_hoodie_file_name` string, \r\n  `id` bigint, \r\n  `name` string, \r\n  `ts` bigint)\r\nPARTITIONED BY ( \r\n  `dt` string, \r\n  `hh` string)\r\nROW FORMAT SERDE \r\n  'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' \r\nWITH SERDEPROPERTIES ( \r\n  'path'='s3://hudi-upgrade/data/hudi_sql_dml_ddl_hive/hudi_tbl_partitioned') \r\nSTORED AS INPUTFORMAT \r\n  'org.apache.hudi.hadoop.HoodieParquetInputFormat' \r\nOUTPUTFORMAT \r\n  'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat'\r\nLOCATION\r\n  's3://hudi-upgrade/data/hudi_sql_dml_ddl_hive/hudi_tbl_partitioned'\r\nTBLPROPERTIES (\r\n  'hoodie.datasource.hive_sync.table'='hudi_tbl_partitioned', \r\n  'hoodie.table.name'='hudi_tbl_partitioned', \r\n  'last_commit_time_sync'='20220420003416329', \r\n  'preCombineField'='ts', \r\n  'primaryKey'='id', \r\n  'spark.sql.create.version'='3.1.1-amzn-0', \r\n  'spark.sql.sources.provider'='hudi', \r\n  'spark.sql.sources.schema.numPartCols'='2', \r\n  'spark.sql.sources.schema.numParts'='1', \r\n  'spark.sql.sources.schema.part.0'='{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"_hoodie_commit_time\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"_hoodie_commit_seqno\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"_hoodie_record_key\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"_hoodie_partition_path\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"_hoodie_file_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"id\\\",\\\"type\\\":\\\"long\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"ts\\\",\\\"type\\\":\\\"long\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"dt\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"hh\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]}', \r\n  'spark.sql.sources.schema.partCol.0'='dt', \r\n  'spark.sql.sources.schema.partCol.1'='hh', \r\n  'transient_lastDdlTime'='1650414765', \r\n  'type'='cow')\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103302907/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103314606","html_url":"https://github.com/apache/hudi/issues/5298#issuecomment-1103314606","issue_url":"https://api.github.com/repos/apache/hudi/issues/5298","id":1103314606,"node_id":"IC_kwDOBI7nWM5Bwz6u","user":{"login":"umehrot2","id":8647012,"node_id":"MDQ6VXNlcjg2NDcwMTI=","avatar_url":"https://avatars.githubusercontent.com/u/8647012?v=4","gravatar_id":"","url":"https://api.github.com/users/umehrot2","html_url":"https://github.com/umehrot2","followers_url":"https://api.github.com/users/umehrot2/followers","following_url":"https://api.github.com/users/umehrot2/following{/other_user}","gists_url":"https://api.github.com/users/umehrot2/gists{/gist_id}","starred_url":"https://api.github.com/users/umehrot2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/umehrot2/subscriptions","organizations_url":"https://api.github.com/users/umehrot2/orgs","repos_url":"https://api.github.com/users/umehrot2/repos","events_url":"https://api.github.com/users/umehrot2/events{/privacy}","received_events_url":"https://api.github.com/users/umehrot2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T00:55:03Z","updated_at":"2022-04-20T00:55:03Z","author_association":"CONTRIBUTOR","body":"@kasured I am from AWS EMR team. I hope you have opened a ticket with AWS support and we can work through that channel to backport this fix and provide you patched jars.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103314606/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103323341","html_url":"https://github.com/apache/hudi/issues/5298#issuecomment-1103323341","issue_url":"https://api.github.com/repos/apache/hudi/issues/5298","id":1103323341,"node_id":"IC_kwDOBI7nWM5Bw2DN","user":{"login":"umehrot2","id":8647012,"node_id":"MDQ6VXNlcjg2NDcwMTI=","avatar_url":"https://avatars.githubusercontent.com/u/8647012?v=4","gravatar_id":"","url":"https://api.github.com/users/umehrot2","html_url":"https://github.com/umehrot2","followers_url":"https://api.github.com/users/umehrot2/followers","following_url":"https://api.github.com/users/umehrot2/following{/other_user}","gists_url":"https://api.github.com/users/umehrot2/gists{/gist_id}","starred_url":"https://api.github.com/users/umehrot2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/umehrot2/subscriptions","organizations_url":"https://api.github.com/users/umehrot2/orgs","repos_url":"https://api.github.com/users/umehrot2/repos","events_url":"https://api.github.com/users/umehrot2/events{/privacy}","received_events_url":"https://api.github.com/users/umehrot2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T01:13:02Z","updated_at":"2022-04-20T01:13:02Z","author_association":"CONTRIBUTOR","body":"@kasured is it possible for you to have 3 separete spark applications that do not share spark context ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103323341/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103378430","html_url":"https://github.com/apache/hudi/pull/4958#issuecomment-1103378430","issue_url":"https://api.github.com/repos/apache/hudi/issues/4958","id":1103378430,"node_id":"IC_kwDOBI7nWM5BxDf-","user":{"login":"YuweiXiao","id":9959868,"node_id":"MDQ6VXNlcjk5NTk4Njg=","avatar_url":"https://avatars.githubusercontent.com/u/9959868?v=4","gravatar_id":"","url":"https://api.github.com/users/YuweiXiao","html_url":"https://github.com/YuweiXiao","followers_url":"https://api.github.com/users/YuweiXiao/followers","following_url":"https://api.github.com/users/YuweiXiao/following{/other_user}","gists_url":"https://api.github.com/users/YuweiXiao/gists{/gist_id}","starred_url":"https://api.github.com/users/YuweiXiao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YuweiXiao/subscriptions","organizations_url":"https://api.github.com/users/YuweiXiao/orgs","repos_url":"https://api.github.com/users/YuweiXiao/repos","events_url":"https://api.github.com/users/YuweiXiao/events{/privacy}","received_events_url":"https://api.github.com/users/YuweiXiao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T02:09:08Z","updated_at":"2022-04-20T02:09:08Z","author_association":"CONTRIBUTOR","body":"@hudi-bot run azure","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103378430/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103395668","html_url":"https://github.com/apache/hudi/issues/5345#issuecomment-1103395668","issue_url":"https://api.github.com/repos/apache/hudi/issues/5345","id":1103395668,"node_id":"IC_kwDOBI7nWM5BxHtU","user":{"login":"shaqf","id":14066803,"node_id":"MDQ6VXNlcjE0MDY2ODAz","avatar_url":"https://avatars.githubusercontent.com/u/14066803?v=4","gravatar_id":"","url":"https://api.github.com/users/shaqf","html_url":"https://github.com/shaqf","followers_url":"https://api.github.com/users/shaqf/followers","following_url":"https://api.github.com/users/shaqf/following{/other_user}","gists_url":"https://api.github.com/users/shaqf/gists{/gist_id}","starred_url":"https://api.github.com/users/shaqf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shaqf/subscriptions","organizations_url":"https://api.github.com/users/shaqf/orgs","repos_url":"https://api.github.com/users/shaqf/repos","events_url":"https://api.github.com/users/shaqf/events{/privacy}","received_events_url":"https://api.github.com/users/shaqf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T02:25:09Z","updated_at":"2022-04-20T02:25:28Z","author_association":"NONE","body":"Hadoop3.*.* use like this:\r\n\r\n\r\n112     try (FSDataOutputStream outputStream = new FSDataOutputStream(baos, null)) {\r\n113       try (HoodieParquetStreamWriter<IndexedRecord> parquetWriter = new HoodieParquetStreamWriter<>(outputStream, avroParquetConfig)) {\r\n114         for (IndexedRecord record : records) {\r\n115           String recordKey = getRecordKey(record).orElse(null);\r\n116           parquetWriter.writeAvro(recordKey, record);\r\n117         }\r\n118         outputStream.flush();\r\n119       }\r\n120     }\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103395668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103412910","html_url":"https://github.com/apache/hudi/pull/5199#issuecomment-1103412910","issue_url":"https://api.github.com/repos/apache/hudi/issues/5199","id":1103412910,"node_id":"IC_kwDOBI7nWM5BxL6u","user":{"login":"watermelon12138","id":49849410,"node_id":"MDQ6VXNlcjQ5ODQ5NDEw","avatar_url":"https://avatars.githubusercontent.com/u/49849410?v=4","gravatar_id":"","url":"https://api.github.com/users/watermelon12138","html_url":"https://github.com/watermelon12138","followers_url":"https://api.github.com/users/watermelon12138/followers","following_url":"https://api.github.com/users/watermelon12138/following{/other_user}","gists_url":"https://api.github.com/users/watermelon12138/gists{/gist_id}","starred_url":"https://api.github.com/users/watermelon12138/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/watermelon12138/subscriptions","organizations_url":"https://api.github.com/users/watermelon12138/orgs","repos_url":"https://api.github.com/users/watermelon12138/repos","events_url":"https://api.github.com/users/watermelon12138/events{/privacy}","received_events_url":"https://api.github.com/users/watermelon12138/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T02:42:30Z","updated_at":"2022-04-20T02:42:30Z","author_association":"CONTRIBUTOR","body":"@yihua \r\nHello，Thank you for your review. I answered your questions in the comments and hope you can review my code again.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103412910/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103415385","html_url":"https://github.com/apache/hudi/pull/5246#issuecomment-1103415385","issue_url":"https://api.github.com/repos/apache/hudi/issues/5246","id":1103415385,"node_id":"IC_kwDOBI7nWM5BxMhZ","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T02:46:59Z","updated_at":"2022-04-20T02:46:59Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"fdfcd0d06ec0000d0bd45d895522d5a9fff0bdea\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=7886\",\n    \"triggerID\" : \"fdfcd0d06ec0000d0bd45d895522d5a9fff0bdea\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"b0518ff7ab38ca449a47046563f13cae57130cde\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8153\",\n    \"triggerID\" : \"b0518ff7ab38ca449a47046563f13cae57130cde\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* b0518ff7ab38ca449a47046563f13cae57130cde Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8153) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103415385/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103415549","html_url":"https://github.com/apache/hudi/pull/5364#issuecomment-1103415549","issue_url":"https://api.github.com/repos/apache/hudi/issues/5364","id":1103415549,"node_id":"IC_kwDOBI7nWM5BxMj9","user":{"login":"xiarixiaoyao","id":13514703,"node_id":"MDQ6VXNlcjEzNTE0NzAz","avatar_url":"https://avatars.githubusercontent.com/u/13514703?v=4","gravatar_id":"","url":"https://api.github.com/users/xiarixiaoyao","html_url":"https://github.com/xiarixiaoyao","followers_url":"https://api.github.com/users/xiarixiaoyao/followers","following_url":"https://api.github.com/users/xiarixiaoyao/following{/other_user}","gists_url":"https://api.github.com/users/xiarixiaoyao/gists{/gist_id}","starred_url":"https://api.github.com/users/xiarixiaoyao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiarixiaoyao/subscriptions","organizations_url":"https://api.github.com/users/xiarixiaoyao/orgs","repos_url":"https://api.github.com/users/xiarixiaoyao/repos","events_url":"https://api.github.com/users/xiarixiaoyao/events{/privacy}","received_events_url":"https://api.github.com/users/xiarixiaoyao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T02:47:22Z","updated_at":"2022-04-20T02:47:22Z","author_association":"CONTRIBUTOR","body":"@alexeykudinkin  now we use hoodieparquetFile, \r\nwe may need to modfy this function to reduce the impact of schema evolution\r\nHoodieDataSourceHelper.getConfigurationWithInternalSchema \r\n```\r\n  def getConfigurationWithInternalSchema(conf: Configuration, internalSchema: InternalSchema, tablePath: String, validCommits: String): Configuration = {\r\n    val querySchemaString = SerDeHelper.toJson(internalSchema)\r\n    if (!querySchemaString.isEmpty) {\r\n      conf.set(SparkInternalSchemaConverter.HOODIE_QUERY_SCHEMA, querySchemaString)\r\n      conf.set(SparkInternalSchemaConverter.HOODIE_TABLE_PATH, tablePath)\r\n      conf.set(SparkInternalSchemaConverter.HOODIE_VALID_COMMITS_LIST, validCommits)\r\n    }\r\n    conf\r\n  }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103415549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103427563","html_url":"https://github.com/apache/hudi/issues/5351#issuecomment-1103427563","issue_url":"https://api.github.com/repos/apache/hudi/issues/5351","id":1103427563,"node_id":"IC_kwDOBI7nWM5BxPfr","user":{"login":"codope","id":16440354,"node_id":"MDQ6VXNlcjE2NDQwMzU0","avatar_url":"https://avatars.githubusercontent.com/u/16440354?v=4","gravatar_id":"","url":"https://api.github.com/users/codope","html_url":"https://github.com/codope","followers_url":"https://api.github.com/users/codope/followers","following_url":"https://api.github.com/users/codope/following{/other_user}","gists_url":"https://api.github.com/users/codope/gists{/gist_id}","starred_url":"https://api.github.com/users/codope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codope/subscriptions","organizations_url":"https://api.github.com/users/codope/orgs","repos_url":"https://api.github.com/users/codope/repos","events_url":"https://api.github.com/users/codope/events{/privacy}","received_events_url":"https://api.github.com/users/codope/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T03:15:11Z","updated_at":"2022-04-20T03:15:11Z","author_association":"MEMBER","body":"Ok. I tried with latest Hudi master. Can you give build from the latest master?\r\nI'll try Hudi 0.9. I think latest EMR already has it.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103427563/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103451500","html_url":"https://github.com/apache/hudi/pull/5360#issuecomment-1103451500","issue_url":"https://api.github.com/repos/apache/hudi/issues/5360","id":1103451500,"node_id":"IC_kwDOBI7nWM5BxVVs","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T04:10:56Z","updated_at":"2022-04-20T04:10:56Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"3b69640fb8bbd66767d32cccf67ba42345db2f36\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8140\",\n    \"triggerID\" : \"3b69640fb8bbd66767d32cccf67ba42345db2f36\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"d5efac3b62681191bce360b2f2d1012f354078e3\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8155\",\n    \"triggerID\" : \"d5efac3b62681191bce360b2f2d1012f354078e3\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* d5efac3b62681191bce360b2f2d1012f354078e3 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8155) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103451500/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103465853","html_url":"https://github.com/apache/hudi/pull/5364#issuecomment-1103465853","issue_url":"https://api.github.com/repos/apache/hudi/issues/5364","id":1103465853,"node_id":"IC_kwDOBI7nWM5BxY19","user":{"login":"alexeykudinkin","id":428277,"node_id":"MDQ6VXNlcjQyODI3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/428277?v=4","gravatar_id":"","url":"https://api.github.com/users/alexeykudinkin","html_url":"https://github.com/alexeykudinkin","followers_url":"https://api.github.com/users/alexeykudinkin/followers","following_url":"https://api.github.com/users/alexeykudinkin/following{/other_user}","gists_url":"https://api.github.com/users/alexeykudinkin/gists{/gist_id}","starred_url":"https://api.github.com/users/alexeykudinkin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexeykudinkin/subscriptions","organizations_url":"https://api.github.com/users/alexeykudinkin/orgs","repos_url":"https://api.github.com/users/alexeykudinkin/repos","events_url":"https://api.github.com/users/alexeykudinkin/events{/privacy}","received_events_url":"https://api.github.com/users/alexeykudinkin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T04:43:39Z","updated_at":"2022-04-20T04:43:39Z","author_association":"CONTRIBUTOR","body":"@xiarixiaoyao addressed","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103465853/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103496012","html_url":"https://github.com/apache/hudi/issues/5189#issuecomment-1103496012","issue_url":"https://api.github.com/repos/apache/hudi/issues/5189","id":1103496012,"node_id":"IC_kwDOBI7nWM5BxgNM","user":{"login":"harsh1231","id":5278043,"node_id":"MDQ6VXNlcjUyNzgwNDM=","avatar_url":"https://avatars.githubusercontent.com/u/5278043?v=4","gravatar_id":"","url":"https://api.github.com/users/harsh1231","html_url":"https://github.com/harsh1231","followers_url":"https://api.github.com/users/harsh1231/followers","following_url":"https://api.github.com/users/harsh1231/following{/other_user}","gists_url":"https://api.github.com/users/harsh1231/gists{/gist_id}","starred_url":"https://api.github.com/users/harsh1231/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/harsh1231/subscriptions","organizations_url":"https://api.github.com/users/harsh1231/orgs","repos_url":"https://api.github.com/users/harsh1231/repos","events_url":"https://api.github.com/users/harsh1231/events{/privacy}","received_events_url":"https://api.github.com/users/harsh1231/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T05:48:41Z","updated_at":"2022-04-20T05:48:41Z","author_association":"CONTRIBUTOR","body":"@lowmmrfeeder Got it , got distracted because of private package  `com.navi`  , let me try to reproduce this then we can work on fix ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103496012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103506131","html_url":"https://github.com/apache/hudi/pull/5362#issuecomment-1103506131","issue_url":"https://api.github.com/repos/apache/hudi/issues/5362","id":1103506131,"node_id":"IC_kwDOBI7nWM5BxirT","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T06:07:43Z","updated_at":"2022-04-20T06:07:43Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"fabdbf1c87824b1d39aa211f3eaea867ff96a2cc\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8142\",\n    \"triggerID\" : \"fabdbf1c87824b1d39aa211f3eaea867ff96a2cc\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"4426590f9cb6609b41fbb923e674b573fd7f79ad\",\n    \"status\" : \"FAILURE\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8158\",\n    \"triggerID\" : \"4426590f9cb6609b41fbb923e674b573fd7f79ad\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 4426590f9cb6609b41fbb923e674b573fd7f79ad Azure: [FAILURE](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8158) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103506131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103525747","html_url":"https://github.com/apache/hudi/pull/5364#issuecomment-1103525747","issue_url":"https://api.github.com/repos/apache/hudi/issues/5364","id":1103525747,"node_id":"IC_kwDOBI7nWM5Bxndz","user":{"login":"xiarixiaoyao","id":13514703,"node_id":"MDQ6VXNlcjEzNTE0NzAz","avatar_url":"https://avatars.githubusercontent.com/u/13514703?v=4","gravatar_id":"","url":"https://api.github.com/users/xiarixiaoyao","html_url":"https://github.com/xiarixiaoyao","followers_url":"https://api.github.com/users/xiarixiaoyao/followers","following_url":"https://api.github.com/users/xiarixiaoyao/following{/other_user}","gists_url":"https://api.github.com/users/xiarixiaoyao/gists{/gist_id}","starred_url":"https://api.github.com/users/xiarixiaoyao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiarixiaoyao/subscriptions","organizations_url":"https://api.github.com/users/xiarixiaoyao/orgs","repos_url":"https://api.github.com/users/xiarixiaoyao/repos","events_url":"https://api.github.com/users/xiarixiaoyao/events{/privacy}","received_events_url":"https://api.github.com/users/xiarixiaoyao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T06:39:21Z","updated_at":"2022-04-20T06:39:21Z","author_association":"CONTRIBUTOR","body":"@alexeykudinkin  thanks for your address.\r\n@alexeykudinkin  @nsivabalan @yihua  now schema evolution is not worked with this pr,  let me find the reason,  pls wait a moment","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103525747/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103536120","html_url":"https://github.com/apache/hudi/pull/5357#issuecomment-1103536120","issue_url":"https://api.github.com/repos/apache/hudi/issues/5357","id":1103536120,"node_id":"IC_kwDOBI7nWM5Bxp_4","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T06:55:58Z","updated_at":"2022-04-20T06:55:58Z","author_association":"CONTRIBUTOR","body":"Thanks for the contribution @wxplovecc , i have left some minor comments.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103536120/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103544454","html_url":"https://github.com/apache/hudi/issues/5189#issuecomment-1103544454","issue_url":"https://api.github.com/repos/apache/hudi/issues/5189","id":1103544454,"node_id":"IC_kwDOBI7nWM5BxsCG","user":{"login":"low-on-mana","id":8509512,"node_id":"MDQ6VXNlcjg1MDk1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/8509512?v=4","gravatar_id":"","url":"https://api.github.com/users/low-on-mana","html_url":"https://github.com/low-on-mana","followers_url":"https://api.github.com/users/low-on-mana/followers","following_url":"https://api.github.com/users/low-on-mana/following{/other_user}","gists_url":"https://api.github.com/users/low-on-mana/gists{/gist_id}","starred_url":"https://api.github.com/users/low-on-mana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/low-on-mana/subscriptions","organizations_url":"https://api.github.com/users/low-on-mana/orgs","repos_url":"https://api.github.com/users/low-on-mana/repos","events_url":"https://api.github.com/users/low-on-mana/events{/privacy}","received_events_url":"https://api.github.com/users/low-on-mana/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T07:07:16Z","updated_at":"2022-04-20T07:07:16Z","author_association":"CONTRIBUTOR","body":"Ohh ya, we did little modification to [HoodieIncrSource.java](https://github.com/apache/hudi/blob/b28f0d6ceb7750075be82b7bd4160a4475801159/hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/HoodieIncrSource.java#L176) and created our own class. The modifications were related to reading whole source table when doing incremental read with deltastreamer for first time ( Its supported now in `HoodieIncrSource` but wasnt there sometime back ), but rest of code is same. \r\nWe were able to reproduce this issue with current state of `HoodieIncrSource`","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103544454/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103555789","html_url":"https://github.com/apache/hudi/pull/5364#issuecomment-1103555789","issue_url":"https://api.github.com/repos/apache/hudi/issues/5364","id":1103555789,"node_id":"IC_kwDOBI7nWM5BxuzN","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T07:20:59Z","updated_at":"2022-04-20T07:20:59Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"6fa8f1506ac4cfeb00e2296b4a7f9fe5338fde96\",\n    \"status\" : \"UNKNOWN\",\n    \"url\" : \"TBD\",\n    \"triggerID\" : \"6fa8f1506ac4cfeb00e2296b4a7f9fe5338fde96\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"ceb5addbf5d6d1100443ecf598f06b4323e1d6fe\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8145\",\n    \"triggerID\" : \"ceb5addbf5d6d1100443ecf598f06b4323e1d6fe\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"c040d5c57e551bc7e0fbbad03236b70ab48b2cf8\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8146\",\n    \"triggerID\" : \"c040d5c57e551bc7e0fbbad03236b70ab48b2cf8\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"27d58e93df6310a8f35f93e73bff5ae3f2378bdd\",\n    \"status\" : \"UNKNOWN\",\n    \"url\" : \"TBD\",\n    \"triggerID\" : \"27d58e93df6310a8f35f93e73bff5ae3f2378bdd\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"3dc0bd1b03d19253dd4034e72f365d6e63e0fce0\",\n    \"status\" : \"UNKNOWN\",\n    \"url\" : \"TBD\",\n    \"triggerID\" : \"3dc0bd1b03d19253dd4034e72f365d6e63e0fce0\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"f4eaa8e08eb3759160f93e2bdb19ba7ac473a7df\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8150\",\n    \"triggerID\" : \"f4eaa8e08eb3759160f93e2bdb19ba7ac473a7df\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"e56dcad8f272d0450e2803790e2ca9dab1a8c4e7\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8157\",\n    \"triggerID\" : \"e56dcad8f272d0450e2803790e2ca9dab1a8c4e7\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"f9e166e9146345498e0aaee8eff844b9444f3a8d\",\n    \"status\" : \"UNKNOWN\",\n    \"url\" : \"TBD\",\n    \"triggerID\" : \"f9e166e9146345498e0aaee8eff844b9444f3a8d\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"64dd7b1a59d215289d97578dcd0943b4d9764dcd\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8161\",\n    \"triggerID\" : \"64dd7b1a59d215289d97578dcd0943b4d9764dcd\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 6fa8f1506ac4cfeb00e2296b4a7f9fe5338fde96 UNKNOWN\n* 27d58e93df6310a8f35f93e73bff5ae3f2378bdd UNKNOWN\n* 3dc0bd1b03d19253dd4034e72f365d6e63e0fce0 UNKNOWN\n* f9e166e9146345498e0aaee8eff844b9444f3a8d UNKNOWN\n* 64dd7b1a59d215289d97578dcd0943b4d9764dcd Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8161) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103555789/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103582328","html_url":"https://github.com/apache/hudi/pull/5357#issuecomment-1103582328","issue_url":"https://api.github.com/repos/apache/hudi/issues/5357","id":1103582328,"node_id":"IC_kwDOBI7nWM5Bx1R4","user":{"login":"wxplovecc","id":3350718,"node_id":"MDQ6VXNlcjMzNTA3MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3350718?v=4","gravatar_id":"","url":"https://api.github.com/users/wxplovecc","html_url":"https://github.com/wxplovecc","followers_url":"https://api.github.com/users/wxplovecc/followers","following_url":"https://api.github.com/users/wxplovecc/following{/other_user}","gists_url":"https://api.github.com/users/wxplovecc/gists{/gist_id}","starred_url":"https://api.github.com/users/wxplovecc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wxplovecc/subscriptions","organizations_url":"https://api.github.com/users/wxplovecc/orgs","repos_url":"https://api.github.com/users/wxplovecc/repos","events_url":"https://api.github.com/users/wxplovecc/events{/privacy}","received_events_url":"https://api.github.com/users/wxplovecc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T07:53:08Z","updated_at":"2022-04-20T07:53:08Z","author_association":"CONTRIBUTOR","body":"> Thanks for the contribution @wxplovecc , i have left some minor comments.\r\n\r\ndone","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103582328/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103616901","html_url":"https://github.com/apache/hudi/pull/5368#issuecomment-1103616901","issue_url":"https://api.github.com/repos/apache/hudi/issues/5368","id":1103616901,"node_id":"IC_kwDOBI7nWM5Bx9uF","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T08:31:01Z","updated_at":"2022-04-20T08:31:01Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"fea2f156c48828a3dc8ab12aec3721a847814144\",\n    \"status\" : \"SUCCESS\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8163\",\n    \"triggerID\" : \"fea2f156c48828a3dc8ab12aec3721a847814144\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* fea2f156c48828a3dc8ab12aec3721a847814144 Azure: [SUCCESS](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8163) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103616901/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103704544","html_url":"https://github.com/apache/hudi/pull/5196#issuecomment-1103704544","issue_url":"https://api.github.com/repos/apache/hudi/issues/5196","id":1103704544,"node_id":"IC_kwDOBI7nWM5ByTHg","user":{"login":"hudi-bot","id":79415918,"node_id":"MDQ6VXNlcjc5NDE1OTE4","avatar_url":"https://avatars.githubusercontent.com/u/79415918?v=4","gravatar_id":"","url":"https://api.github.com/users/hudi-bot","html_url":"https://github.com/hudi-bot","followers_url":"https://api.github.com/users/hudi-bot/followers","following_url":"https://api.github.com/users/hudi-bot/following{/other_user}","gists_url":"https://api.github.com/users/hudi-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/hudi-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hudi-bot/subscriptions","organizations_url":"https://api.github.com/users/hudi-bot/orgs","repos_url":"https://api.github.com/users/hudi-bot/repos","events_url":"https://api.github.com/users/hudi-bot/events{/privacy}","received_events_url":"https://api.github.com/users/hudi-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T09:34:35Z","updated_at":"2022-04-20T09:34:35Z","author_association":"NONE","body":"<!--\nMeta data\n{\n  \"version\" : 1,\n  \"metaDataEntries\" : [ {\n    \"hash\" : \"b0000619120204a002260b453c90aa8a910da3b7\",\n    \"status\" : \"DELETED\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=7680\",\n    \"triggerID\" : \"b0000619120204a002260b453c90aa8a910da3b7\",\n    \"triggerType\" : \"PUSH\"\n  }, {\n    \"hash\" : \"88b7475a1684472a4fb07e841c1f7f16faf612e8\",\n    \"status\" : \"FAILURE\",\n    \"url\" : \"https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8165\",\n    \"triggerID\" : \"88b7475a1684472a4fb07e841c1f7f16faf612e8\",\n    \"triggerType\" : \"PUSH\"\n  } ]\n}-->\n## CI report:\n\n* 88b7475a1684472a4fb07e841c1f7f16faf612e8 Azure: [FAILURE](https://dev.azure.com/apache-hudi-ci-org/785b6ef4-2f42-4a89-8f0e-5f0d7039a0cc/_build/results?buildId=8165) \n\n<details>\n<summary>Bot commands</summary>\n  @hudi-bot supports the following commands:\n\n - `@hudi-bot run azure` re-run the last Azure build\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/1103704544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]