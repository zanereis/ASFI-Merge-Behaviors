[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1579632193","html_url":"https://github.com/apache/iceberg/issues/6307#issuecomment-1579632193","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6307","id":1579632193,"node_id":"IC_kwDOCW7NX85eJ0ZB","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-06-07T00:12:21Z","updated_at":"2023-06-07T00:12:21Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1579632193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1579707514","html_url":"https://github.com/apache/iceberg/pull/7412#issuecomment-1579707514","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7412","id":1579707514,"node_id":"IC_kwDOCW7NX85eKGx6","user":{"login":"coufon","id":11655397,"node_id":"MDQ6VXNlcjExNjU1Mzk3","avatar_url":"https://avatars.githubusercontent.com/u/11655397?v=4","gravatar_id":"","url":"https://api.github.com/users/coufon","html_url":"https://github.com/coufon","followers_url":"https://api.github.com/users/coufon/followers","following_url":"https://api.github.com/users/coufon/following{/other_user}","gists_url":"https://api.github.com/users/coufon/gists{/gist_id}","starred_url":"https://api.github.com/users/coufon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coufon/subscriptions","organizations_url":"https://api.github.com/users/coufon/orgs","repos_url":"https://api.github.com/users/coufon/repos","events_url":"https://api.github.com/users/coufon/events{/privacy}","received_events_url":"https://api.github.com/users/coufon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-07T01:27:40Z","updated_at":"2023-06-07T01:27:40Z","author_association":"NONE","body":"> I think the `BigLakeClient` interface should be replaced with a better way to test the catalog's behavior.\r\n\r\nI used a different approach with the real client, and removed the BigLakeClient interface. This new approach uses a mock in-process gRPC server (MockMetastoreServiceImpl.java). Please let me know whether it works.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1579707514/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1579741659","html_url":"https://github.com/apache/iceberg/pull/7767#issuecomment-1579741659","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7767","id":1579741659,"node_id":"IC_kwDOCW7NX85eKPHb","user":{"login":"skytin1004","id":99078115,"node_id":"U_kgDOBefP4w","avatar_url":"https://avatars.githubusercontent.com/u/99078115?v=4","gravatar_id":"","url":"https://api.github.com/users/skytin1004","html_url":"https://github.com/skytin1004","followers_url":"https://api.github.com/users/skytin1004/followers","following_url":"https://api.github.com/users/skytin1004/following{/other_user}","gists_url":"https://api.github.com/users/skytin1004/gists{/gist_id}","starred_url":"https://api.github.com/users/skytin1004/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skytin1004/subscriptions","organizations_url":"https://api.github.com/users/skytin1004/orgs","repos_url":"https://api.github.com/users/skytin1004/repos","events_url":"https://api.github.com/users/skytin1004/events{/privacy}","received_events_url":"https://api.github.com/users/skytin1004/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-07T01:56:30Z","updated_at":"2023-06-07T02:06:27Z","author_association":"CONTRIBUTOR","body":"I should have done `git pull` in local after merging with Apache master branch, but I skipped the `gil pull`. \r\nAfter that I deleted unnecessary newlines and force push. \r\nSo I Merged the  `apache:master` branch into `test2` again.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1579741659/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1579794862","html_url":"https://github.com/apache/iceberg/pull/7382#issuecomment-1579794862","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7382","id":1579794862,"node_id":"IC_kwDOCW7NX85eKcGu","user":{"login":"manuzhang","id":1191767,"node_id":"MDQ6VXNlcjExOTE3Njc=","avatar_url":"https://avatars.githubusercontent.com/u/1191767?v=4","gravatar_id":"","url":"https://api.github.com/users/manuzhang","html_url":"https://github.com/manuzhang","followers_url":"https://api.github.com/users/manuzhang/followers","following_url":"https://api.github.com/users/manuzhang/following{/other_user}","gists_url":"https://api.github.com/users/manuzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/manuzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manuzhang/subscriptions","organizations_url":"https://api.github.com/users/manuzhang/orgs","repos_url":"https://api.github.com/users/manuzhang/repos","events_url":"https://api.github.com/users/manuzhang/events{/privacy}","received_events_url":"https://api.github.com/users/manuzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-07T03:00:53Z","updated_at":"2023-06-07T03:00:53Z","author_association":"COLLABORATOR","body":"@hililiwei gentle ping for review.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1579794862/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1579934993","html_url":"https://github.com/apache/iceberg/pull/7694#issuecomment-1579934993","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7694","id":1579934993,"node_id":"IC_kwDOCW7NX85eK-UR","user":{"login":"MaxNevermind","id":4653936,"node_id":"MDQ6VXNlcjQ2NTM5MzY=","avatar_url":"https://avatars.githubusercontent.com/u/4653936?v=4","gravatar_id":"","url":"https://api.github.com/users/MaxNevermind","html_url":"https://github.com/MaxNevermind","followers_url":"https://api.github.com/users/MaxNevermind/followers","following_url":"https://api.github.com/users/MaxNevermind/following{/other_user}","gists_url":"https://api.github.com/users/MaxNevermind/gists{/gist_id}","starred_url":"https://api.github.com/users/MaxNevermind/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaxNevermind/subscriptions","organizations_url":"https://api.github.com/users/MaxNevermind/orgs","repos_url":"https://api.github.com/users/MaxNevermind/repos","events_url":"https://api.github.com/users/MaxNevermind/events{/privacy}","received_events_url":"https://api.github.com/users/MaxNevermind/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-07T05:37:08Z","updated_at":"2023-06-07T05:37:08Z","author_association":"CONTRIBUTOR","body":"I’ve noticed that new dependencies were already added since PR was opened, so before merging PR to master it needs a final check for any dependencies with versions that are left over in all Gradle build files.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1579934993/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580081080","html_url":"https://github.com/apache/iceberg/issues/7777#issuecomment-1580081080","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7777","id":1580081080,"node_id":"IC_kwDOCW7NX85eLh-4","user":{"login":"tilman151","id":9466385,"node_id":"MDQ6VXNlcjk0NjYzODU=","avatar_url":"https://avatars.githubusercontent.com/u/9466385?v=4","gravatar_id":"","url":"https://api.github.com/users/tilman151","html_url":"https://github.com/tilman151","followers_url":"https://api.github.com/users/tilman151/followers","following_url":"https://api.github.com/users/tilman151/following{/other_user}","gists_url":"https://api.github.com/users/tilman151/gists{/gist_id}","starred_url":"https://api.github.com/users/tilman151/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tilman151/subscriptions","organizations_url":"https://api.github.com/users/tilman151/orgs","repos_url":"https://api.github.com/users/tilman151/repos","events_url":"https://api.github.com/users/tilman151/events{/privacy}","received_events_url":"https://api.github.com/users/tilman151/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-07T07:19:45Z","updated_at":"2023-06-07T07:19:45Z","author_association":"CONTRIBUTOR","body":"@Fokko PR is done. Do you want to have a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580081080/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580282286","html_url":"https://github.com/apache/iceberg/pull/7790#issuecomment-1580282286","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7790","id":1580282286,"node_id":"IC_kwDOCW7NX85eMTGu","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-07T09:20:42Z","updated_at":"2023-06-07T16:18:54Z","author_association":"MEMBER","body":"I opened [another PR](https://github.com/apache/iceberg/pull/7733) also aims to expose some configuration to SQL conf.\r\n\r\nSeems that Iceberg only allows a small set of configurations to be overwritten by SQL session configuration. I'm wondering if we can expose all configurations to SQL conf.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580282286/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580323565","html_url":"https://github.com/apache/iceberg/pull/7791#issuecomment-1580323565","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7791","id":1580323565,"node_id":"IC_kwDOCW7NX85eMdLt","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-07T09:44:54Z","updated_at":"2023-06-07T09:44:54Z","author_association":"CONTRIBUTOR","body":"Hi @stevenzwu @nastra @rdblue @Fokko @aokolnychyi, could you help to review this when you are free? Thanks in advance.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580323565/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580323847","html_url":"https://github.com/apache/iceberg/pull/7720#issuecomment-1580323847","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7720","id":1580323847,"node_id":"IC_kwDOCW7NX85eMdQH","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-07T09:45:06Z","updated_at":"2023-06-07T09:45:06Z","author_association":"CONTRIBUTOR","body":"Thanks @nastra @singhpk234 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580323847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580328661","html_url":"https://github.com/apache/iceberg/pull/7759#issuecomment-1580328661","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7759","id":1580328661,"node_id":"IC_kwDOCW7NX85eMebV","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-07T09:48:21Z","updated_at":"2023-06-07T09:48:21Z","author_association":"CONTRIBUTOR","body":"@nastra Thanks for your response, it indeed makes the code more complex. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580328661/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580331348","html_url":"https://github.com/apache/iceberg/pull/7719#issuecomment-1580331348","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7719","id":1580331348,"node_id":"IC_kwDOCW7NX85eMfFU","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-07T09:50:11Z","updated_at":"2023-06-07T09:50:11Z","author_association":"CONTRIBUTOR","body":"gentle ping @jzhuge @Fokko @singhpk234 @aokolnychyi","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580331348/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580331807","html_url":"https://github.com/apache/iceberg/pull/7717#issuecomment-1580331807","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7717","id":1580331807,"node_id":"IC_kwDOCW7NX85eMfMf","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-07T09:50:31Z","updated_at":"2023-06-07T09:50:31Z","author_association":"CONTRIBUTOR","body":"Same here, gentle ping @jzhuge @Fokko @singhpk234 @aokolnychyi","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580331807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580338593","html_url":"https://github.com/apache/iceberg/issues/5652#issuecomment-1580338593","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5652","id":1580338593,"node_id":"IC_kwDOCW7NX85eMg2h","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-07T09:53:31Z","updated_at":"2023-06-07T09:53:31Z","author_association":"CONTRIBUTOR","body":"We have met a similar problem and I have submitted a PR for this. @stevenzwu Could you help to review it?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580338593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580479891","html_url":"https://github.com/apache/iceberg/issues/7584#issuecomment-1580479891","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7584","id":1580479891,"node_id":"IC_kwDOCW7NX85eNDWT","user":{"login":"wojciechjak","id":17719639,"node_id":"MDQ6VXNlcjE3NzE5NjM5","avatar_url":"https://avatars.githubusercontent.com/u/17719639?v=4","gravatar_id":"","url":"https://api.github.com/users/wojciechjak","html_url":"https://github.com/wojciechjak","followers_url":"https://api.github.com/users/wojciechjak/followers","following_url":"https://api.github.com/users/wojciechjak/following{/other_user}","gists_url":"https://api.github.com/users/wojciechjak/gists{/gist_id}","starred_url":"https://api.github.com/users/wojciechjak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wojciechjak/subscriptions","organizations_url":"https://api.github.com/users/wojciechjak/orgs","repos_url":"https://api.github.com/users/wojciechjak/repos","events_url":"https://api.github.com/users/wojciechjak/events{/privacy}","received_events_url":"https://api.github.com/users/wojciechjak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-07T10:39:00Z","updated_at":"2023-06-07T10:39:00Z","author_association":"NONE","body":"Also the same issue when renaming columns.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580479891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580554936","html_url":"https://github.com/apache/iceberg/pull/7791#issuecomment-1580554936","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7791","id":1580554936,"node_id":"IC_kwDOCW7NX85eNVq4","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-07T11:10:28Z","updated_at":"2023-06-07T11:10:28Z","author_association":"CONTRIBUTOR","body":"Thanks @ConeyLiu for raising this, and sorry for the long wait. Did you confirm with the new `WeakHashMap` that the problem has been resolved?\r\n\r\nAt Avro, we had a similar issue: https://lists.apache.org/thread/8q3g304thhjgsfk7d6l62w706y365616 And the fix: https://github.com/apache/avro/pull/2090/","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580554936/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580559081","html_url":"https://github.com/apache/iceberg/pull/7791#issuecomment-1580559081","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7791","id":1580559081,"node_id":"IC_kwDOCW7NX85eNWrp","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-07T11:12:31Z","updated_at":"2023-06-07T11:12:31Z","author_association":"CONTRIBUTOR","body":"Hmm, that looks unrelated since it caches the fields that are singleton, and not the schema itself. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580559081/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580689840","html_url":"https://github.com/apache/iceberg/pull/7444#issuecomment-1580689840","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7444","id":1580689840,"node_id":"IC_kwDOCW7NX85eN2mw","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-07T12:16:37Z","updated_at":"2023-06-07T12:16:37Z","author_association":"CONTRIBUTOR","body":"Introduced `SqsMetricsReporterAwsClientFactory`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580689840/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580708249","html_url":"https://github.com/apache/iceberg/issues/7771#issuecomment-1580708249","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7771","id":1580708249,"node_id":"IC_kwDOCW7NX85eN7GZ","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-07T12:24:00Z","updated_at":"2023-06-07T12:24:00Z","author_association":"CONTRIBUTOR","body":"@d-tw I think this is because Spark intentionally uses a nullable schema when running CTAS/RTAS,  see this [PR](https://github.com/apache/spark/pull/25536) for more context. And Spark recently [introduced](https://github.com/apache/spark/pull/41070) a way to allow users reserve nullability, should be helpful for your case.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1580708249/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1581042806","html_url":"https://github.com/apache/iceberg/pull/7790#issuecomment-1581042806","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7790","id":1581042806,"node_id":"IC_kwDOCW7NX85ePMx2","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-07T15:17:54Z","updated_at":"2023-06-07T15:17:54Z","author_association":"CONTRIBUTOR","body":"@pan3793 I think it would be on a case-by-case basis depending on the use case for each configuration.\r\n\r\ncc: @rdblue @aokolnychyi @RussellSpitzer @szehon-ho","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1581042806/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1581683345","html_url":"https://github.com/apache/iceberg/issues/6347#issuecomment-1581683345","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6347","id":1581683345,"node_id":"IC_kwDOCW7NX85eRpKR","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-06-08T00:12:05Z","updated_at":"2023-06-08T00:12:05Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1581683345/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1581741823","html_url":"https://github.com/apache/iceberg/issues/7797#issuecomment-1581741823","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7797","id":1581741823,"node_id":"IC_kwDOCW7NX85eR3b_","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-08T01:12:55Z","updated_at":"2023-06-08T01:12:55Z","author_association":"CONTRIBUTOR","body":"@CaduRodrigues you can set 'write.target-file-size-bytes' to control the size of files, and you can find more tuning table configurations [here](https://iceberg.apache.org/docs/latest/configuration/).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1581741823/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1581980893","html_url":"https://github.com/apache/iceberg/pull/7791#issuecomment-1581980893","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7791","id":1581980893,"node_id":"IC_kwDOCW7NX85eSxzd","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-08T06:45:50Z","updated_at":"2023-06-08T06:45:50Z","author_association":"CONTRIBUTOR","body":"Thanks @Fokko for the review. \r\n\r\n> Did you confirm with the new WeakHashMap that the problem has been resolved?\r\n\r\nIt needs to run several weeks or months to trigger the problem. I tested locally and the caching works as expected.\r\n\r\n> Do you think it is possible to add a check to see if the HashMap actually removes objects that are garbage collected? It would be nice to check its behavior now, but also we make sure that we keep this behavior in the future (it was broken in Avro along the way).\r\n\r\nAdd the new UTs to cover this. Please take another look when you are free.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1581980893/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1582078900","html_url":"https://github.com/apache/iceberg/issues/7618#issuecomment-1582078900","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7618","id":1582078900,"node_id":"IC_kwDOCW7NX85eTJu0","user":{"login":"linyanghao","id":51444992,"node_id":"MDQ6VXNlcjUxNDQ0OTky","avatar_url":"https://avatars.githubusercontent.com/u/51444992?v=4","gravatar_id":"","url":"https://api.github.com/users/linyanghao","html_url":"https://github.com/linyanghao","followers_url":"https://api.github.com/users/linyanghao/followers","following_url":"https://api.github.com/users/linyanghao/following{/other_user}","gists_url":"https://api.github.com/users/linyanghao/gists{/gist_id}","starred_url":"https://api.github.com/users/linyanghao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/linyanghao/subscriptions","organizations_url":"https://api.github.com/users/linyanghao/orgs","repos_url":"https://api.github.com/users/linyanghao/repos","events_url":"https://api.github.com/users/linyanghao/events{/privacy}","received_events_url":"https://api.github.com/users/linyanghao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-08T07:53:34Z","updated_at":"2023-06-08T07:53:34Z","author_association":"CONTRIBUTOR","body":"Currently, it's necessary to include partition fields as a part of the pk. If not, iceberg won't be able to ensure the uniqueness of pk across partitions. For example: both ('partition1', 'key1'), ('partition2', 'key1') can exist in a table in the same time, which breaks the uniqueness constraint.\r\nTo support not including partition fields as pk. We need to implement a global index like hudi's. Given a record's pk, the global index routes the record to the partition containing it. In this way, we can ensure that the pk is unique.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1582078900/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1582196947","html_url":"https://github.com/apache/iceberg/issues/7618#issuecomment-1582196947","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7618","id":1582196947,"node_id":"IC_kwDOCW7NX85eTmjT","user":{"login":"rfyu","id":39233058,"node_id":"MDQ6VXNlcjM5MjMzMDU4","avatar_url":"https://avatars.githubusercontent.com/u/39233058?v=4","gravatar_id":"","url":"https://api.github.com/users/rfyu","html_url":"https://github.com/rfyu","followers_url":"https://api.github.com/users/rfyu/followers","following_url":"https://api.github.com/users/rfyu/following{/other_user}","gists_url":"https://api.github.com/users/rfyu/gists{/gist_id}","starred_url":"https://api.github.com/users/rfyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rfyu/subscriptions","organizations_url":"https://api.github.com/users/rfyu/orgs","repos_url":"https://api.github.com/users/rfyu/repos","events_url":"https://api.github.com/users/rfyu/events{/privacy}","received_events_url":"https://api.github.com/users/rfyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-08T09:14:11Z","updated_at":"2023-06-08T09:14:11Z","author_association":"NONE","body":"You're right.Currently, the partition field is not included in the pk, so I created this [PR](https://github.com/apache/iceberg/pull/7620).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1582196947/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1582428184","html_url":"https://github.com/apache/iceberg/pull/7607#issuecomment-1582428184","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7607","id":1582428184,"node_id":"IC_kwDOCW7NX85eUfAY","user":{"login":"Neuw84","id":5920770,"node_id":"MDQ6VXNlcjU5MjA3NzA=","avatar_url":"https://avatars.githubusercontent.com/u/5920770?v=4","gravatar_id":"","url":"https://api.github.com/users/Neuw84","html_url":"https://github.com/Neuw84","followers_url":"https://api.github.com/users/Neuw84/followers","following_url":"https://api.github.com/users/Neuw84/following{/other_user}","gists_url":"https://api.github.com/users/Neuw84/gists{/gist_id}","starred_url":"https://api.github.com/users/Neuw84/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Neuw84/subscriptions","organizations_url":"https://api.github.com/users/Neuw84/orgs","repos_url":"https://api.github.com/users/Neuw84/repos","events_url":"https://api.github.com/users/Neuw84/events{/privacy}","received_events_url":"https://api.github.com/users/Neuw84/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-08T11:41:00Z","updated_at":"2023-06-08T11:41:00Z","author_association":"CONTRIBUTOR","body":"Hi, \r\n\r\nIt would be great if we can push this feature to merge. \r\n\r\nI could help if needed too on the Java side. \r\n\r\nLet me know! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1582428184/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1582586509","html_url":"https://github.com/apache/iceberg/pull/7607#issuecomment-1582586509","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7607","id":1582586509,"node_id":"IC_kwDOCW7NX85eVFqN","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-08T13:31:02Z","updated_at":"2023-06-08T13:31:02Z","author_association":"MEMBER","body":"Other reviewers would be welcome, I'm a bit pressed for time","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1582586509/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1582607600","html_url":"https://github.com/apache/iceberg/pull/7607#issuecomment-1582607600","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7607","id":1582607600,"node_id":"IC_kwDOCW7NX85eVKzw","user":{"login":"giucris","id":9114810,"node_id":"MDQ6VXNlcjkxMTQ4MTA=","avatar_url":"https://avatars.githubusercontent.com/u/9114810?v=4","gravatar_id":"","url":"https://api.github.com/users/giucris","html_url":"https://github.com/giucris","followers_url":"https://api.github.com/users/giucris/followers","following_url":"https://api.github.com/users/giucris/following{/other_user}","gists_url":"https://api.github.com/users/giucris/gists{/gist_id}","starred_url":"https://api.github.com/users/giucris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/giucris/subscriptions","organizations_url":"https://api.github.com/users/giucris/orgs","repos_url":"https://api.github.com/users/giucris/repos","events_url":"https://api.github.com/users/giucris/events{/privacy}","received_events_url":"https://api.github.com/users/giucris/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-08T13:45:33Z","updated_at":"2023-06-08T13:45:33Z","author_association":"NONE","body":"Sorry. \r\nI was a bit underpressure on last 3 weeks. \r\nI will try to complete as soon I have some time","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1582607600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1582612694","html_url":"https://github.com/apache/iceberg/pull/7607#issuecomment-1582612694","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7607","id":1582612694,"node_id":"IC_kwDOCW7NX85eVMDW","user":{"login":"Neuw84","id":5920770,"node_id":"MDQ6VXNlcjU5MjA3NzA=","avatar_url":"https://avatars.githubusercontent.com/u/5920770?v=4","gravatar_id":"","url":"https://api.github.com/users/Neuw84","html_url":"https://github.com/Neuw84","followers_url":"https://api.github.com/users/Neuw84/followers","following_url":"https://api.github.com/users/Neuw84/following{/other_user}","gists_url":"https://api.github.com/users/Neuw84/gists{/gist_id}","starred_url":"https://api.github.com/users/Neuw84/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Neuw84/subscriptions","organizations_url":"https://api.github.com/users/Neuw84/orgs","repos_url":"https://api.github.com/users/Neuw84/repos","events_url":"https://api.github.com/users/Neuw84/events{/privacy}","received_events_url":"https://api.github.com/users/Neuw84/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-08T13:48:49Z","updated_at":"2023-06-08T13:48:49Z","author_association":"CONTRIBUTOR","body":"@giucris  let me know if I can help on anything 👍 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1582612694/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1583269987","html_url":"https://github.com/apache/iceberg/issues/7776#issuecomment-1583269987","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7776","id":1583269987,"node_id":"IC_kwDOCW7NX85eXshj","user":{"login":"mderoy","id":1040009,"node_id":"MDQ6VXNlcjEwNDAwMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1040009?v=4","gravatar_id":"","url":"https://api.github.com/users/mderoy","html_url":"https://github.com/mderoy","followers_url":"https://api.github.com/users/mderoy/followers","following_url":"https://api.github.com/users/mderoy/following{/other_user}","gists_url":"https://api.github.com/users/mderoy/gists{/gist_id}","starred_url":"https://api.github.com/users/mderoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mderoy/subscriptions","organizations_url":"https://api.github.com/users/mderoy/orgs","repos_url":"https://api.github.com/users/mderoy/repos","events_url":"https://api.github.com/users/mderoy/events{/privacy}","received_events_url":"https://api.github.com/users/mderoy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-08T20:07:29Z","updated_at":"2023-06-08T20:07:29Z","author_association":"CONTRIBUTOR","body":"I'd like to contribute on this","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1583269987/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1583341952","html_url":"https://github.com/apache/iceberg/issues/7776#issuecomment-1583341952","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7776","id":1583341952,"node_id":"IC_kwDOCW7NX85eX-GA","user":{"login":"mderoy","id":1040009,"node_id":"MDQ6VXNlcjEwNDAwMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1040009?v=4","gravatar_id":"","url":"https://api.github.com/users/mderoy","html_url":"https://github.com/mderoy","followers_url":"https://api.github.com/users/mderoy/followers","following_url":"https://api.github.com/users/mderoy/following{/other_user}","gists_url":"https://api.github.com/users/mderoy/gists{/gist_id}","starred_url":"https://api.github.com/users/mderoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mderoy/subscriptions","organizations_url":"https://api.github.com/users/mderoy/orgs","repos_url":"https://api.github.com/users/mderoy/repos","events_url":"https://api.github.com/users/mderoy/events{/privacy}","received_events_url":"https://api.github.com/users/mderoy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-08T21:05:16Z","updated_at":"2023-06-08T21:05:16Z","author_association":"CONTRIBUTOR","body":"@Fokko I've opened a PR for the D403 issues. Is there a guide to contribute for python (required python version, packages to install, etc) I assume for such a basic change there is CI that will run a set of unittests?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1583341952/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1583448330","html_url":"https://github.com/apache/iceberg/issues/6235#issuecomment-1583448330","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6235","id":1583448330,"node_id":"IC_kwDOCW7NX85eYYEK","user":{"login":"maswin","id":5331361,"node_id":"MDQ6VXNlcjUzMzEzNjE=","avatar_url":"https://avatars.githubusercontent.com/u/5331361?v=4","gravatar_id":"","url":"https://api.github.com/users/maswin","html_url":"https://github.com/maswin","followers_url":"https://api.github.com/users/maswin/followers","following_url":"https://api.github.com/users/maswin/following{/other_user}","gists_url":"https://api.github.com/users/maswin/gists{/gist_id}","starred_url":"https://api.github.com/users/maswin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maswin/subscriptions","organizations_url":"https://api.github.com/users/maswin/orgs","repos_url":"https://api.github.com/users/maswin/repos","events_url":"https://api.github.com/users/maswin/events{/privacy}","received_events_url":"https://api.github.com/users/maswin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-08T22:02:08Z","updated_at":"2023-06-08T22:02:08Z","author_association":"NONE","body":"@leedarHawk & @Gboyka - Iceberg doesn't support Tez execution engine for Inserts in Hive-3\r\n\r\nI have raised a PR to solve this issue - https://github.com/apache/iceberg/pull/7802\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1583448330/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1583653541","html_url":"https://github.com/apache/iceberg/issues/6265#issuecomment-1583653541","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6265","id":1583653541,"node_id":"IC_kwDOCW7NX85eZKKl","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-06-09T00:12:23Z","updated_at":"2023-06-09T00:12:23Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1583653541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1583722672","html_url":"https://github.com/apache/iceberg/pull/7561#issuecomment-1583722672","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7561","id":1583722672,"node_id":"IC_kwDOCW7NX85eZbCw","user":{"login":"cccs-eric","id":56447460,"node_id":"MDQ6VXNlcjU2NDQ3NDYw","avatar_url":"https://avatars.githubusercontent.com/u/56447460?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-eric","html_url":"https://github.com/cccs-eric","followers_url":"https://api.github.com/users/cccs-eric/followers","following_url":"https://api.github.com/users/cccs-eric/following{/other_user}","gists_url":"https://api.github.com/users/cccs-eric/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-eric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-eric/subscriptions","organizations_url":"https://api.github.com/users/cccs-eric/orgs","repos_url":"https://api.github.com/users/cccs-eric/repos","events_url":"https://api.github.com/users/cccs-eric/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-eric/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-09T01:05:45Z","updated_at":"2023-06-09T01:05:45Z","author_association":"CONTRIBUTOR","body":"Me and my co-worker just raised in Iceberg General Slack the same issue that this PR is fixing.  Any timeline on when this could be merged in?  And also, will this fix work for when a Postgresql database has closed an idle connection (so a reconnect will be done)?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1583722672/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1583966580","html_url":"https://github.com/apache/iceberg/issues/7776#issuecomment-1583966580","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7776","id":1583966580,"node_id":"IC_kwDOCW7NX85eaWl0","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-09T04:42:07Z","updated_at":"2023-06-09T04:42:07Z","author_association":"CONTRIBUTOR","body":"Thanks @mderoy for picking this up! Yes, there is a CI that I just kicked off.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1583966580/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584038291","html_url":"https://github.com/apache/iceberg/pull/3095#issuecomment-1584038291","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3095","id":1584038291,"node_id":"IC_kwDOCW7NX85eaoGT","user":{"login":"Xiangakun","id":20922357,"node_id":"MDQ6VXNlcjIwOTIyMzU3","avatar_url":"https://avatars.githubusercontent.com/u/20922357?v=4","gravatar_id":"","url":"https://api.github.com/users/Xiangakun","html_url":"https://github.com/Xiangakun","followers_url":"https://api.github.com/users/Xiangakun/followers","following_url":"https://api.github.com/users/Xiangakun/following{/other_user}","gists_url":"https://api.github.com/users/Xiangakun/gists{/gist_id}","starred_url":"https://api.github.com/users/Xiangakun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Xiangakun/subscriptions","organizations_url":"https://api.github.com/users/Xiangakun/orgs","repos_url":"https://api.github.com/users/Xiangakun/repos","events_url":"https://api.github.com/users/Xiangakun/events{/privacy}","received_events_url":"https://api.github.com/users/Xiangakun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-09T06:21:40Z","updated_at":"2023-06-09T06:21:40Z","author_association":"NONE","body":"@hameizi @openinx Hello guys，what's the status of the issue now, please? Any blocking things? Thanks~","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584038291/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584052810","html_url":"https://github.com/apache/iceberg/pull/7731#issuecomment-1584052810","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7731","id":1584052810,"node_id":"IC_kwDOCW7NX85earpK","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-09T06:38:11Z","updated_at":"2023-06-09T06:38:11Z","author_association":"CONTRIBUTOR","body":"Hi @rdblue, how to determine the target parallelism for a job such as Spark which enabled dynamic resource allocation? I think it has been set as enabled by default for many Spark application jobs in production.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584052810/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584062942","html_url":"https://github.com/apache/iceberg/pull/7781#issuecomment-1584062942","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7781","id":1584062942,"node_id":"IC_kwDOCW7NX85eauHe","user":{"login":"tilman151","id":9466385,"node_id":"MDQ6VXNlcjk0NjYzODU=","avatar_url":"https://avatars.githubusercontent.com/u/9466385?v=4","gravatar_id":"","url":"https://api.github.com/users/tilman151","html_url":"https://github.com/tilman151","followers_url":"https://api.github.com/users/tilman151/followers","following_url":"https://api.github.com/users/tilman151/following{/other_user}","gists_url":"https://api.github.com/users/tilman151/gists{/gist_id}","starred_url":"https://api.github.com/users/tilman151/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tilman151/subscriptions","organizations_url":"https://api.github.com/users/tilman151/orgs","repos_url":"https://api.github.com/users/tilman151/repos","events_url":"https://api.github.com/users/tilman151/events{/privacy}","received_events_url":"https://api.github.com/users/tilman151/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-09T06:49:51Z","updated_at":"2023-06-09T06:49:51Z","author_association":"CONTRIBUTOR","body":"@Fokko done. These changes were introduced by running the pre-commit linting. I didn't notice while commiting.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584062942/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584078304","html_url":"https://github.com/apache/iceberg/pull/7607#issuecomment-1584078304","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7607","id":1584078304,"node_id":"IC_kwDOCW7NX85eax3g","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-09T07:04:08Z","updated_at":"2023-06-09T07:04:08Z","author_association":"CONTRIBUTOR","body":"Thanks @giucris for the great work. left some API and code style comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584078304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584091761","html_url":"https://github.com/apache/iceberg/pull/7607#issuecomment-1584091761","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7607","id":1584091761,"node_id":"IC_kwDOCW7NX85ea1Jx","user":{"login":"giucris","id":9114810,"node_id":"MDQ6VXNlcjkxMTQ4MTA=","avatar_url":"https://avatars.githubusercontent.com/u/9114810?v=4","gravatar_id":"","url":"https://api.github.com/users/giucris","html_url":"https://github.com/giucris","followers_url":"https://api.github.com/users/giucris/followers","following_url":"https://api.github.com/users/giucris/following{/other_user}","gists_url":"https://api.github.com/users/giucris/gists{/gist_id}","starred_url":"https://api.github.com/users/giucris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/giucris/subscriptions","organizations_url":"https://api.github.com/users/giucris/orgs","repos_url":"https://api.github.com/users/giucris/repos","events_url":"https://api.github.com/users/giucris/events{/privacy}","received_events_url":"https://api.github.com/users/giucris/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-09T07:15:47Z","updated_at":"2023-06-09T07:15:47Z","author_association":"NONE","body":"> @giucris let me know if I can help on anything 👍\r\n\r\n@Neuw84 Feel free to contribute as you can","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584091761/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584155172","html_url":"https://github.com/apache/iceberg/pull/7802#issuecomment-1584155172","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7802","id":1584155172,"node_id":"IC_kwDOCW7NX85ebEok","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-09T08:09:05Z","updated_at":"2023-06-09T08:09:05Z","author_association":"CONTRIBUTOR","body":"I am not sure this will compile and run with Hive2","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584155172/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584161447","html_url":"https://github.com/apache/iceberg/pull/7791#issuecomment-1584161447","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7791","id":1584161447,"node_id":"IC_kwDOCW7NX85ebGKn","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-09T08:13:51Z","updated_at":"2023-06-09T08:13:51Z","author_association":"CONTRIBUTOR","body":"@ConeyLiu: One last question: Did we run any performance tests to check how the changed caching effects the performance?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584161447/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584307611","html_url":"https://github.com/apache/iceberg/pull/7767#issuecomment-1584307611","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7767","id":1584307611,"node_id":"IC_kwDOCW7NX85ebp2b","user":{"login":"skytin1004","id":99078115,"node_id":"U_kgDOBefP4w","avatar_url":"https://avatars.githubusercontent.com/u/99078115?v=4","gravatar_id":"","url":"https://api.github.com/users/skytin1004","html_url":"https://github.com/skytin1004","followers_url":"https://api.github.com/users/skytin1004/followers","following_url":"https://api.github.com/users/skytin1004/following{/other_user}","gists_url":"https://api.github.com/users/skytin1004/gists{/gist_id}","starred_url":"https://api.github.com/users/skytin1004/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skytin1004/subscriptions","organizations_url":"https://api.github.com/users/skytin1004/orgs","repos_url":"https://api.github.com/users/skytin1004/repos","events_url":"https://api.github.com/users/skytin1004/events{/privacy}","received_events_url":"https://api.github.com/users/skytin1004/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-09T10:00:05Z","updated_at":"2023-06-09T10:05:01Z","author_association":"CONTRIBUTOR","body":"Thanks for your review @nastra! I reviewed all code in this PR with set relationships and fixed it to use the `containsAll` method or the `containsExactlyInAnyOrderElementsOf` method.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584307611/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584378375","html_url":"https://github.com/apache/iceberg/issues/6368#issuecomment-1584378375","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6368","id":1584378375,"node_id":"IC_kwDOCW7NX85eb7IH","user":{"login":"lintingbin","id":5699014,"node_id":"MDQ6VXNlcjU2OTkwMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/5699014?v=4","gravatar_id":"","url":"https://api.github.com/users/lintingbin","html_url":"https://github.com/lintingbin","followers_url":"https://api.github.com/users/lintingbin/followers","following_url":"https://api.github.com/users/lintingbin/following{/other_user}","gists_url":"https://api.github.com/users/lintingbin/gists{/gist_id}","starred_url":"https://api.github.com/users/lintingbin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lintingbin/subscriptions","organizations_url":"https://api.github.com/users/lintingbin/orgs","repos_url":"https://api.github.com/users/lintingbin/repos","events_url":"https://api.github.com/users/lintingbin/events{/privacy}","received_events_url":"https://api.github.com/users/lintingbin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-09T10:49:17Z","updated_at":"2023-06-09T10:49:17Z","author_association":"CONTRIBUTOR","body":"This problem also occurs when executing rewrite_position_delete_files, even if the target table has never been updated or deleted. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584378375/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584589287","html_url":"https://github.com/apache/iceberg/issues/3619#issuecomment-1584589287","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3619","id":1584589287,"node_id":"IC_kwDOCW7NX85ecunn","user":{"login":"Ralnoc","id":2515191,"node_id":"MDQ6VXNlcjI1MTUxOTE=","avatar_url":"https://avatars.githubusercontent.com/u/2515191?v=4","gravatar_id":"","url":"https://api.github.com/users/Ralnoc","html_url":"https://github.com/Ralnoc","followers_url":"https://api.github.com/users/Ralnoc/followers","following_url":"https://api.github.com/users/Ralnoc/following{/other_user}","gists_url":"https://api.github.com/users/Ralnoc/gists{/gist_id}","starred_url":"https://api.github.com/users/Ralnoc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ralnoc/subscriptions","organizations_url":"https://api.github.com/users/Ralnoc/orgs","repos_url":"https://api.github.com/users/Ralnoc/repos","events_url":"https://api.github.com/users/Ralnoc/events{/privacy}","received_events_url":"https://api.github.com/users/Ralnoc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-09T13:36:22Z","updated_at":"2023-06-09T13:36:22Z","author_association":"NONE","body":"As I see it, this integration would have to be done in one of two ways:\r\n\r\n1) Integration into the Runtime components, which would take time as it would require updates to everything that has built a Iceberg integration. (Trino, Spark, Hive, etc.)\r\n2) Integration into the Rest Catalog, This would allow for a custom error response if the use is unauthorized. This difficulty in this would be that the Rest Catalog would need improvements on Authentication as well as implementing Ranger support for Authorization. It would really need to be able to support more than just OAUTH2 (LDAP and SAML2 come to mind) And pass that user information to the Ranger integration for validating Authorization.\r\n\r\nI wouldn't mind writing up a proposal on this, but I would like some guidance on which direction would be preferred. I admit that I'm personally more inclined to the addition of it into the Rest Catalog, as it seems to make more sense to have it there. Since doing so would protect not only the data attempting to be accessed, but the metadata surrounding it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584589287/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584821864","html_url":"https://github.com/apache/iceberg/pull/7801#issuecomment-1584821864","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7801","id":1584821864,"node_id":"IC_kwDOCW7NX85ednZo","user":{"login":"mderoy","id":1040009,"node_id":"MDQ6VXNlcjEwNDAwMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1040009?v=4","gravatar_id":"","url":"https://api.github.com/users/mderoy","html_url":"https://github.com/mderoy","followers_url":"https://api.github.com/users/mderoy/followers","following_url":"https://api.github.com/users/mderoy/following{/other_user}","gists_url":"https://api.github.com/users/mderoy/gists{/gist_id}","starred_url":"https://api.github.com/users/mderoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mderoy/subscriptions","organizations_url":"https://api.github.com/users/mderoy/orgs","repos_url":"https://api.github.com/users/mderoy/repos","events_url":"https://api.github.com/users/mderoy/events{/privacy}","received_events_url":"https://api.github.com/users/mderoy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-09T16:06:41Z","updated_at":"2023-06-09T16:06:41Z","author_association":"CONTRIBUTOR","body":"My pleasure, I'll try to find time to fix some more of this stuff :)\r\nLooks like tests passed but I don't have write access on the repo @Fokko can you merge this :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584821864/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584833787","html_url":"https://github.com/apache/iceberg/pull/7801#issuecomment-1584833787","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7801","id":1584833787,"node_id":"IC_kwDOCW7NX85edqT7","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-09T16:16:53Z","updated_at":"2023-06-09T16:16:53Z","author_association":"CONTRIBUTOR","body":"@mderoy thanks for pining me. I was waiting for the CI te pass :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584833787/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584858814","html_url":"https://github.com/apache/iceberg/pull/7412#issuecomment-1584858814","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7412","id":1584858814,"node_id":"IC_kwDOCW7NX85edwa-","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-09T16:40:11Z","updated_at":"2023-06-09T16:40:11Z","author_association":"CONTRIBUTOR","body":"Running CI","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1584858814/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585089810","html_url":"https://github.com/apache/iceberg/pull/7412#issuecomment-1585089810","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7412","id":1585089810,"node_id":"IC_kwDOCW7NX85eeo0S","user":{"login":"coufon","id":11655397,"node_id":"MDQ6VXNlcjExNjU1Mzk3","avatar_url":"https://avatars.githubusercontent.com/u/11655397?v=4","gravatar_id":"","url":"https://api.github.com/users/coufon","html_url":"https://github.com/coufon","followers_url":"https://api.github.com/users/coufon/followers","following_url":"https://api.github.com/users/coufon/following{/other_user}","gists_url":"https://api.github.com/users/coufon/gists{/gist_id}","starred_url":"https://api.github.com/users/coufon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coufon/subscriptions","organizations_url":"https://api.github.com/users/coufon/orgs","repos_url":"https://api.github.com/users/coufon/repos","events_url":"https://api.github.com/users/coufon/events{/privacy}","received_events_url":"https://api.github.com/users/coufon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-09T20:25:33Z","updated_at":"2023-06-09T20:25:33Z","author_association":"NONE","body":"> Running CI\r\n\r\nThere is a style check failure. Fixed it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585089810/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585176773","html_url":"https://github.com/apache/iceberg/pull/7741#issuecomment-1585176773","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7741","id":1585176773,"node_id":"IC_kwDOCW7NX85ee-DF","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-09T22:04:03Z","updated_at":"2023-06-09T22:04:03Z","author_association":"CONTRIBUTOR","body":"Looks great, thanks for getting this done, @nastra!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585176773/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585298522","html_url":"https://github.com/apache/iceberg/issues/6229#issuecomment-1585298522","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6229","id":1585298522,"node_id":"IC_kwDOCW7NX85efbxa","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-06-10T00:11:19Z","updated_at":"2023-06-10T00:11:19Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585298522/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585492658","html_url":"https://github.com/apache/iceberg/pull/7791#issuecomment-1585492658","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7791","id":1585492658,"node_id":"IC_kwDOCW7NX85egLKy","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-10T05:23:08Z","updated_at":"2023-06-10T05:23:51Z","author_association":"CONTRIBUTOR","body":"@pvary Thanks for pointing that out. This is really needed and found the potential problems.\r\n\r\nPreviously, we use `java.util.WeakHashMap` to replace the `MapMaker().weakKeys().makeMap()`, while the key equally checking is really slow compared with identity. The result is as follows:\r\n```\r\n// java.util.WeakHashMap\r\nBenchmark                               Mode  Cnt   Score   Error  Units\r\nManifestReadBenchmark.readManifestFile    ss    5  12.896 ± 1.155   s/op\r\n\r\n// MapMaker().weakKeys().makeMap()\r\nBenchmark                               Mode  Cnt  Score   Error  Units\r\nManifestReadBenchmark.readManifestFile    ss    5  6.180 ± 0.067   s/op\r\n```\r\n\r\nBecause for each avro record, we need to call the [DecoderResolver.resolveAndRead](https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/avro/GenericAvroReader.java#L72). So I keep the top map with `MapMaker().weakKeys().makeMap()` while the inner map changed to `java.util.WeakHashMap`.\r\nHere is the benchmarks:\r\n```\r\n// Master\r\nBenchmark                               Mode  Cnt  Score   Error  Units\r\nManifestReadBenchmark.readManifestFile    ss    5  6.180 ± 0.067   s/op\r\n\r\n// This change\r\nBenchmark                               Mode  Cnt  Score   Error  Units\r\nManifestReadBenchmark.readManifestFile    ss    5  6.190 ± 0.069   s/op\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585492658/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585501651","html_url":"https://github.com/apache/iceberg/pull/7791#issuecomment-1585501651","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7791","id":1585501651,"node_id":"IC_kwDOCW7NX85egNXT","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-10T05:46:32Z","updated_at":"2023-06-10T05:46:32Z","author_association":"CONTRIBUTOR","body":"Actually, I am not sure why we need [DecoderResolver.resolveAndRead](https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/avro/GenericAvroReader.java#L72) for each record reading. Maybe we could create a `ResolvingDecoder` for a given AvroReader instance because for each instance the [readSchema](https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/avro/GenericAvroReader.java#L35) and [fileSchema](https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/avro/GenericAvroReader.java#L55) are unchanged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585501651/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585869388","html_url":"https://github.com/apache/iceberg/issues/6315#issuecomment-1585869388","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6315","id":1585869388,"node_id":"IC_kwDOCW7NX85ehnJM","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-06-11T00:13:08Z","updated_at":"2023-06-11T00:13:08Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585869388/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585906554","html_url":"https://github.com/apache/iceberg/issues/6636#issuecomment-1585906554","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6636","id":1585906554,"node_id":"IC_kwDOCW7NX85ehwN6","user":{"login":"bitsondatadev","id":8547669,"node_id":"MDQ6VXNlcjg1NDc2Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8547669?v=4","gravatar_id":"","url":"https://api.github.com/users/bitsondatadev","html_url":"https://github.com/bitsondatadev","followers_url":"https://api.github.com/users/bitsondatadev/followers","following_url":"https://api.github.com/users/bitsondatadev/following{/other_user}","gists_url":"https://api.github.com/users/bitsondatadev/gists{/gist_id}","starred_url":"https://api.github.com/users/bitsondatadev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitsondatadev/subscriptions","organizations_url":"https://api.github.com/users/bitsondatadev/orgs","repos_url":"https://api.github.com/users/bitsondatadev/repos","events_url":"https://api.github.com/users/bitsondatadev/events{/privacy}","received_events_url":"https://api.github.com/users/bitsondatadev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-11T01:01:50Z","updated_at":"2023-06-11T01:01:50Z","author_association":"COLLABORATOR","body":"@jackye1995 is this completed?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585906554/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585909112","html_url":"https://github.com/apache/iceberg/issues/3481#issuecomment-1585909112","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3481","id":1585909112,"node_id":"IC_kwDOCW7NX85ehw14","user":{"login":"bitsondatadev","id":8547669,"node_id":"MDQ6VXNlcjg1NDc2Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8547669?v=4","gravatar_id":"","url":"https://api.github.com/users/bitsondatadev","html_url":"https://github.com/bitsondatadev","followers_url":"https://api.github.com/users/bitsondatadev/followers","following_url":"https://api.github.com/users/bitsondatadev/following{/other_user}","gists_url":"https://api.github.com/users/bitsondatadev/gists{/gist_id}","starred_url":"https://api.github.com/users/bitsondatadev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitsondatadev/subscriptions","organizations_url":"https://api.github.com/users/bitsondatadev/orgs","repos_url":"https://api.github.com/users/bitsondatadev/repos","events_url":"https://api.github.com/users/bitsondatadev/events{/privacy}","received_events_url":"https://api.github.com/users/bitsondatadev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-11T01:04:00Z","updated_at":"2023-06-11T01:04:00Z","author_association":"COLLABORATOR","body":"@rdblue is this good to close?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585909112/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585925708","html_url":"https://github.com/apache/iceberg/issues/3465#issuecomment-1585925708","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3465","id":1585925708,"node_id":"IC_kwDOCW7NX85eh05M","user":{"login":"bitsondatadev","id":8547669,"node_id":"MDQ6VXNlcjg1NDc2Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8547669?v=4","gravatar_id":"","url":"https://api.github.com/users/bitsondatadev","html_url":"https://github.com/bitsondatadev","followers_url":"https://api.github.com/users/bitsondatadev/followers","following_url":"https://api.github.com/users/bitsondatadev/following{/other_user}","gists_url":"https://api.github.com/users/bitsondatadev/gists{/gist_id}","starred_url":"https://api.github.com/users/bitsondatadev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitsondatadev/subscriptions","organizations_url":"https://api.github.com/users/bitsondatadev/orgs","repos_url":"https://api.github.com/users/bitsondatadev/repos","events_url":"https://api.github.com/users/bitsondatadev/events{/privacy}","received_events_url":"https://api.github.com/users/bitsondatadev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-11T01:12:25Z","updated_at":"2023-06-11T01:12:25Z","author_association":"COLLABORATOR","body":"@jackye1995 can this be closed?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585925708/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585929913","html_url":"https://github.com/apache/iceberg/issues/5343#issuecomment-1585929913","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5343","id":1585929913,"node_id":"IC_kwDOCW7NX85eh165","user":{"login":"bitsondatadev","id":8547669,"node_id":"MDQ6VXNlcjg1NDc2Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8547669?v=4","gravatar_id":"","url":"https://api.github.com/users/bitsondatadev","html_url":"https://github.com/bitsondatadev","followers_url":"https://api.github.com/users/bitsondatadev/followers","following_url":"https://api.github.com/users/bitsondatadev/following{/other_user}","gists_url":"https://api.github.com/users/bitsondatadev/gists{/gist_id}","starred_url":"https://api.github.com/users/bitsondatadev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitsondatadev/subscriptions","organizations_url":"https://api.github.com/users/bitsondatadev/orgs","repos_url":"https://api.github.com/users/bitsondatadev/repos","events_url":"https://api.github.com/users/bitsondatadev/events{/privacy}","received_events_url":"https://api.github.com/users/bitsondatadev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-11T01:15:38Z","updated_at":"2023-06-11T01:15:38Z","author_association":"COLLABORATOR","body":"@rdblue @szehon-ho can this be closed?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585929913/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585932053","html_url":"https://github.com/apache/iceberg/issues/6429#issuecomment-1585932053","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6429","id":1585932053,"node_id":"IC_kwDOCW7NX85eh2cV","user":{"login":"bitsondatadev","id":8547669,"node_id":"MDQ6VXNlcjg1NDc2Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8547669?v=4","gravatar_id":"","url":"https://api.github.com/users/bitsondatadev","html_url":"https://github.com/bitsondatadev","followers_url":"https://api.github.com/users/bitsondatadev/followers","following_url":"https://api.github.com/users/bitsondatadev/following{/other_user}","gists_url":"https://api.github.com/users/bitsondatadev/gists{/gist_id}","starred_url":"https://api.github.com/users/bitsondatadev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitsondatadev/subscriptions","organizations_url":"https://api.github.com/users/bitsondatadev/orgs","repos_url":"https://api.github.com/users/bitsondatadev/repos","events_url":"https://api.github.com/users/bitsondatadev/events{/privacy}","received_events_url":"https://api.github.com/users/bitsondatadev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-11T01:17:22Z","updated_at":"2023-06-11T01:17:22Z","author_association":"COLLABORATOR","body":"@bryanck is there any overlap here with the kafka connect sink?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585932053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585933453","html_url":"https://github.com/apache/iceberg/issues/189#issuecomment-1585933453","issue_url":"https://api.github.com/repos/apache/iceberg/issues/189","id":1585933453,"node_id":"IC_kwDOCW7NX85eh2yN","user":{"login":"bitsondatadev","id":8547669,"node_id":"MDQ6VXNlcjg1NDc2Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8547669?v=4","gravatar_id":"","url":"https://api.github.com/users/bitsondatadev","html_url":"https://github.com/bitsondatadev","followers_url":"https://api.github.com/users/bitsondatadev/followers","following_url":"https://api.github.com/users/bitsondatadev/following{/other_user}","gists_url":"https://api.github.com/users/bitsondatadev/gists{/gist_id}","starred_url":"https://api.github.com/users/bitsondatadev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitsondatadev/subscriptions","organizations_url":"https://api.github.com/users/bitsondatadev/orgs","repos_url":"https://api.github.com/users/bitsondatadev/repos","events_url":"https://api.github.com/users/bitsondatadev/events{/privacy}","received_events_url":"https://api.github.com/users/bitsondatadev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-11T01:18:33Z","updated_at":"2023-06-11T01:18:33Z","author_association":"COLLABORATOR","body":"Can we close this @rdblue ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585933453/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585982541","html_url":"https://github.com/apache/iceberg/issues/3481#issuecomment-1585982541","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3481","id":1585982541,"node_id":"IC_kwDOCW7NX85eiCxN","user":{"login":"luoyuxia","id":20389154,"node_id":"MDQ6VXNlcjIwMzg5MTU0","avatar_url":"https://avatars.githubusercontent.com/u/20389154?v=4","gravatar_id":"","url":"https://api.github.com/users/luoyuxia","html_url":"https://github.com/luoyuxia","followers_url":"https://api.github.com/users/luoyuxia/followers","following_url":"https://api.github.com/users/luoyuxia/following{/other_user}","gists_url":"https://api.github.com/users/luoyuxia/gists{/gist_id}","starred_url":"https://api.github.com/users/luoyuxia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luoyuxia/subscriptions","organizations_url":"https://api.github.com/users/luoyuxia/orgs","repos_url":"https://api.github.com/users/luoyuxia/repos","events_url":"https://api.github.com/users/luoyuxia/events{/privacy}","received_events_url":"https://api.github.com/users/luoyuxia/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-11T02:51:21Z","updated_at":"2023-06-11T02:51:21Z","author_association":"NONE","body":"Thanks all. Close it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585982541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585987456","html_url":"https://github.com/apache/iceberg/issues/6429#issuecomment-1585987456","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6429","id":1585987456,"node_id":"IC_kwDOCW7NX85eiD-A","user":{"login":"bryanck","id":5475421,"node_id":"MDQ6VXNlcjU0NzU0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/5475421?v=4","gravatar_id":"","url":"https://api.github.com/users/bryanck","html_url":"https://github.com/bryanck","followers_url":"https://api.github.com/users/bryanck/followers","following_url":"https://api.github.com/users/bryanck/following{/other_user}","gists_url":"https://api.github.com/users/bryanck/gists{/gist_id}","starred_url":"https://api.github.com/users/bryanck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bryanck/subscriptions","organizations_url":"https://api.github.com/users/bryanck/orgs","repos_url":"https://api.github.com/users/bryanck/repos","events_url":"https://api.github.com/users/bryanck/events{/privacy}","received_events_url":"https://api.github.com/users/bryanck/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-11T03:15:21Z","updated_at":"2023-06-11T03:15:48Z","author_association":"CONTRIBUTOR","body":"I don't believe so. With the Kafka Connect sink, all files written and commits performed are logged as messages on a control topic. That acts as a log for write activity (at file-level grain), so a downstream process could consume from that without requiring an additional log.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1585987456/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1586017170","html_url":"https://github.com/apache/iceberg/pull/7762#issuecomment-1586017170","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7762","id":1586017170,"node_id":"IC_kwDOCW7NX85eiLOS","user":{"login":"dependabot[bot]","id":49699333,"node_id":"MDM6Qm90NDk2OTkzMzM=","avatar_url":"https://avatars.githubusercontent.com/in/29110?v=4","gravatar_id":"","url":"https://api.github.com/users/dependabot%5Bbot%5D","html_url":"https://github.com/apps/dependabot","followers_url":"https://api.github.com/users/dependabot%5Bbot%5D/followers","following_url":"https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dependabot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/dependabot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/dependabot%5Bbot%5D/repos","events_url":"https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/dependabot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-06-11T04:58:08Z","updated_at":"2023-06-11T04:58:08Z","author_association":"CONTRIBUTOR","body":"Superseded by #7812.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1586017170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1586176014","html_url":"https://github.com/apache/iceberg/pull/7803#issuecomment-1586176014","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7803","id":1586176014,"node_id":"IC_kwDOCW7NX85eiyAO","user":{"login":"skytin1004","id":99078115,"node_id":"U_kgDOBefP4w","avatar_url":"https://avatars.githubusercontent.com/u/99078115?v=4","gravatar_id":"","url":"https://api.github.com/users/skytin1004","html_url":"https://github.com/skytin1004","followers_url":"https://api.github.com/users/skytin1004/followers","following_url":"https://api.github.com/users/skytin1004/following{/other_user}","gists_url":"https://api.github.com/users/skytin1004/gists{/gist_id}","starred_url":"https://api.github.com/users/skytin1004/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skytin1004/subscriptions","organizations_url":"https://api.github.com/users/skytin1004/orgs","repos_url":"https://api.github.com/users/skytin1004/repos","events_url":"https://api.github.com/users/skytin1004/events{/privacy}","received_events_url":"https://api.github.com/users/skytin1004/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-11T13:56:10Z","updated_at":"2023-06-11T13:59:30Z","author_association":"CONTRIBUTOR","body":"Thank you very much for the detailed review, @nastra.\r\nBased on your review, I went back through all the code in this PR and deleted the `.as(..) `and added a  `.hasMessage(..)` method in `assertThatThrownBy` . \r\n\r\nI also removed `as(..)`, which can be omitted in the part you suggested (\"Namespaces should be equal\" and \"Properties should be equal\") \r\n\r\nand I changed \r\n   `Assert.assertFalse(\r\n        \"The merged properties map should omit keys with null values\", merged.containsValue(null))`  to code that uses AssertJ with the method you suggested.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1586176014/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1586391702","html_url":"https://github.com/apache/iceberg/issues/6416#issuecomment-1586391702","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6416","id":1586391702,"node_id":"IC_kwDOCW7NX85ejmqW","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-06-12T00:14:01Z","updated_at":"2023-06-12T00:14:01Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1586391702/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1586526461","html_url":"https://github.com/apache/iceberg/issues/7766#issuecomment-1586526461","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7766","id":1586526461,"node_id":"IC_kwDOCW7NX85ekHj9","user":{"login":"jhchee","id":33974196,"node_id":"MDQ6VXNlcjMzOTc0MTk2","avatar_url":"https://avatars.githubusercontent.com/u/33974196?v=4","gravatar_id":"","url":"https://api.github.com/users/jhchee","html_url":"https://github.com/jhchee","followers_url":"https://api.github.com/users/jhchee/followers","following_url":"https://api.github.com/users/jhchee/following{/other_user}","gists_url":"https://api.github.com/users/jhchee/gists{/gist_id}","starred_url":"https://api.github.com/users/jhchee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhchee/subscriptions","organizations_url":"https://api.github.com/users/jhchee/orgs","repos_url":"https://api.github.com/users/jhchee/repos","events_url":"https://api.github.com/users/jhchee/events{/privacy}","received_events_url":"https://api.github.com/users/jhchee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-12T03:41:51Z","updated_at":"2023-06-20T10:39:19Z","author_association":"NONE","body":"Looks like a Spark issue, I don't encounter the issue with Spark 3.4.0.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1586526461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1586645196","html_url":"https://github.com/apache/iceberg/issues/7794#issuecomment-1586645196","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7794","id":1586645196,"node_id":"IC_kwDOCW7NX85ekkjM","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-12T06:05:24Z","updated_at":"2023-06-12T06:05:24Z","author_association":"CONTRIBUTOR","body":"The Spec(s) are linked under the **Project** section in case that helps","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1586645196/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1586785170","html_url":"https://github.com/apache/iceberg/pull/7144#issuecomment-1586785170","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7144","id":1586785170,"node_id":"IC_kwDOCW7NX85elGuS","user":{"login":"wangyinsheng","id":13392313,"node_id":"MDQ6VXNlcjEzMzkyMzEz","avatar_url":"https://avatars.githubusercontent.com/u/13392313?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyinsheng","html_url":"https://github.com/wangyinsheng","followers_url":"https://api.github.com/users/wangyinsheng/followers","following_url":"https://api.github.com/users/wangyinsheng/following{/other_user}","gists_url":"https://api.github.com/users/wangyinsheng/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyinsheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyinsheng/subscriptions","organizations_url":"https://api.github.com/users/wangyinsheng/orgs","repos_url":"https://api.github.com/users/wangyinsheng/repos","events_url":"https://api.github.com/users/wangyinsheng/events{/privacy}","received_events_url":"https://api.github.com/users/wangyinsheng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-12T07:58:18Z","updated_at":"2023-06-12T07:58:18Z","author_association":"CONTRIBUTOR","body":"> > @nastra, where are we with the fix for serialization here?\r\n> \r\n> @rdblue I haven't heard back from @wangyinsheng after [my comment above ](https://github.com/apache/iceberg/pull/7144#issuecomment-1519866237), so I've opened #7370 a while ago for initial experimentation and then updated it to fix the serialization issue.\r\n\r\n@nastra @rdblue Sorry，I am working on other things for a while.  But I am still keep my opinion,  I think the `SerializableTable` is the best place to handle the `lazily initialization` stuff for `MetricsReporter`, we should not just make `MetricsReporter` serializable, which will throw the `lazily initialization` stuff to any implemention class of `MetricsReporter`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1586785170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1587194702","html_url":"https://github.com/apache/iceberg/pull/7761#issuecomment-1587194702","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7761","id":1587194702,"node_id":"IC_kwDOCW7NX85emqtO","user":{"login":"TaoZex","id":45089228,"node_id":"MDQ6VXNlcjQ1MDg5MjI4","avatar_url":"https://avatars.githubusercontent.com/u/45089228?v=4","gravatar_id":"","url":"https://api.github.com/users/TaoZex","html_url":"https://github.com/TaoZex","followers_url":"https://api.github.com/users/TaoZex/followers","following_url":"https://api.github.com/users/TaoZex/following{/other_user}","gists_url":"https://api.github.com/users/TaoZex/gists{/gist_id}","starred_url":"https://api.github.com/users/TaoZex/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TaoZex/subscriptions","organizations_url":"https://api.github.com/users/TaoZex/orgs","repos_url":"https://api.github.com/users/TaoZex/repos","events_url":"https://api.github.com/users/TaoZex/events{/privacy}","received_events_url":"https://api.github.com/users/TaoZex/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-12T12:01:36Z","updated_at":"2023-06-12T12:01:36Z","author_association":"CONTRIBUTOR","body":" @hililiwei  @stevenzwu @Fokko @nastra @rdblue Hello, I am a contributor to iceberg for the first time. Could you please help me review it? Thank you.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1587194702/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1587372823","html_url":"https://github.com/apache/iceberg/issues/3405#issuecomment-1587372823","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3405","id":1587372823,"node_id":"IC_kwDOCW7NX85enWMX","user":{"login":"yanivkrol","id":130914260,"node_id":"U_kgDOB82X1A","avatar_url":"https://avatars.githubusercontent.com/u/130914260?v=4","gravatar_id":"","url":"https://api.github.com/users/yanivkrol","html_url":"https://github.com/yanivkrol","followers_url":"https://api.github.com/users/yanivkrol/followers","following_url":"https://api.github.com/users/yanivkrol/following{/other_user}","gists_url":"https://api.github.com/users/yanivkrol/gists{/gist_id}","starred_url":"https://api.github.com/users/yanivkrol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanivkrol/subscriptions","organizations_url":"https://api.github.com/users/yanivkrol/orgs","repos_url":"https://api.github.com/users/yanivkrol/repos","events_url":"https://api.github.com/users/yanivkrol/events{/privacy}","received_events_url":"https://api.github.com/users/yanivkrol/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-12T13:43:59Z","updated_at":"2023-06-12T14:07:17Z","author_association":"NONE","body":"> Hi @Rajashekhar-meesala, is the error message exactly the same? If it is, you need to check all your dependencies including the transitive dependencies to make sure there is no old version(< 4.1.63.Final) of netty buffer get into your Spark runtime.\r\n\r\nHi, I'm getting the same error. It seems that I get version `4.1.45.Final` as part of spark's 3.4.0 dependencies:\r\n```\r\nYour branch is up to date with 'origin/master'.\r\n❯ mvn dependency:tree | grep netty\r\n[INFO] |  |  \\- io.netty:netty:jar:3.10.5.Final:compile\r\n// adding the dependency here\r\n❯ mvn dependency:tree | grep netty\r\n[INFO] |  |  +- io.netty:netty-all:jar:4.1.45.Final:provided\r\n[INFO] |  |  +- io.netty:netty-transport-native-epoll:jar:linux-x86_64:4.1.45.Final:provided\r\n[INFO] |  |  |  +- io.netty:netty-common:jar:4.1.45.Final:provided\r\n[INFO] |  |  |  +- io.netty:netty-buffer:jar:4.1.45.Final:provided\r\n[INFO] |  |  |  +- io.netty:netty-transport:jar:4.1.45.Final:provided\r\n[INFO] |  |  |  |  \\- io.netty:netty-resolver:jar:4.1.45.Final:provided\r\n[INFO] |  |  |  \\- io.netty:netty-transport-native-unix-common:jar:4.1.45.Final:provided\r\n[INFO] |  |  +- io.netty:netty-transport-native-epoll:jar:linux-aarch_64:4.1.87.Final:provided\r\n[INFO] |  |  |  \\- io.netty:netty-transport-classes-epoll:jar:4.1.87.Final:provided\r\n[INFO] |  |  +- io.netty:netty-transport-native-kqueue:jar:osx-aarch_64:4.1.87.Final:provided\r\n[INFO] |  |  |  \\- io.netty:netty-transport-classes-kqueue:jar:4.1.87.Final:provided\r\n[INFO] |  |  +- io.netty:netty-transport-native-kqueue:jar:osx-x86_64:4.1.45.Final:provided\r\n[INFO] |  |  \\- org.apache.arrow:arrow-memory-netty:jar:11.0.0:provided\r\n[INFO] |  |  \\- io.netty:netty:jar:3.10.5.Final:compile\r\n```\r\nUsing:\r\n```\r\n<dependency>\r\n    <groupId>org.apache.spark</groupId>\r\n    <artifactId>spark-sql_2.13</artifactId>\r\n    <version>3.4.0</version>\r\n    <scope>provided</scope>\r\n</dependency>\r\n```\r\n\r\nI'm on MacOS with M1 chip\r\nopenjdk 11.0.19 2023-04-18 LTS\r\nZulu11.64","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1587372823/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1587718483","html_url":"https://github.com/apache/iceberg/issues/7797#issuecomment-1587718483","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7797","id":1587718483,"node_id":"IC_kwDOCW7NX85eoqlT","user":{"login":"CaduRodrigues","id":5335045,"node_id":"MDQ6VXNlcjUzMzUwNDU=","avatar_url":"https://avatars.githubusercontent.com/u/5335045?v=4","gravatar_id":"","url":"https://api.github.com/users/CaduRodrigues","html_url":"https://github.com/CaduRodrigues","followers_url":"https://api.github.com/users/CaduRodrigues/followers","following_url":"https://api.github.com/users/CaduRodrigues/following{/other_user}","gists_url":"https://api.github.com/users/CaduRodrigues/gists{/gist_id}","starred_url":"https://api.github.com/users/CaduRodrigues/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CaduRodrigues/subscriptions","organizations_url":"https://api.github.com/users/CaduRodrigues/orgs","repos_url":"https://api.github.com/users/CaduRodrigues/repos","events_url":"https://api.github.com/users/CaduRodrigues/events{/privacy}","received_events_url":"https://api.github.com/users/CaduRodrigues/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-12T17:00:47Z","updated_at":"2023-06-12T17:00:47Z","author_association":"NONE","body":"I did it that way and it still didn't solve it, it seems that he doesn't understand the command, he even throws the configuration in the metadata, but it still creates the small file, is there any extra configuration that needs to be done? Would you have an example of a table created?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1587718483/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1587749497","html_url":"https://github.com/apache/iceberg/issues/5343#issuecomment-1587749497","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5343","id":1587749497,"node_id":"IC_kwDOCW7NX85eoyJ5","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-12T17:21:15Z","updated_at":"2023-06-12T17:21:15Z","author_association":"COLLABORATOR","body":"Sure, i have checked with Spark folks recently, will follow up with them there.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1587749497/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1587751201","html_url":"https://github.com/apache/iceberg/issues/5343#issuecomment-1587751201","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5343","id":1587751201,"node_id":"IC_kwDOCW7NX85eoykh","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-12T17:22:40Z","updated_at":"2023-06-12T17:22:40Z","author_association":"CONTRIBUTOR","body":"I am not 100% sure but #7732 seems promising","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1587751201/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1587812533","html_url":"https://github.com/apache/iceberg/issues/6375#issuecomment-1587812533","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6375","id":1587812533,"node_id":"IC_kwDOCW7NX85epBi1","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-12T17:58:44Z","updated_at":"2023-06-12T17:58:44Z","author_association":"COLLABORATOR","body":"Hi, sorry for delay, just saw this.  Was thinking about what happens when you combine two delete manifest with different sequence numbers, and I think this makes sense, unless I'm missing something.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1587812533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1587828888","html_url":"https://github.com/apache/iceberg/issues/7776#issuecomment-1587828888","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7776","id":1587828888,"node_id":"IC_kwDOCW7NX85epFiY","user":{"login":"mderoy","id":1040009,"node_id":"MDQ6VXNlcjEwNDAwMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1040009?v=4","gravatar_id":"","url":"https://api.github.com/users/mderoy","html_url":"https://github.com/mderoy","followers_url":"https://api.github.com/users/mderoy/followers","following_url":"https://api.github.com/users/mderoy/following{/other_user}","gists_url":"https://api.github.com/users/mderoy/gists{/gist_id}","starred_url":"https://api.github.com/users/mderoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mderoy/subscriptions","organizations_url":"https://api.github.com/users/mderoy/orgs","repos_url":"https://api.github.com/users/mderoy/repos","events_url":"https://api.github.com/users/mderoy/events{/privacy}","received_events_url":"https://api.github.com/users/mderoy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-12T18:08:17Z","updated_at":"2023-06-12T18:08:17Z","author_association":"CONTRIBUTOR","body":"opened a pr for D205. FYI you missed checking off D202 from the above list :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1587828888/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1588274596","html_url":"https://github.com/apache/iceberg/pull/7750#issuecomment-1588274596","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7750","id":1588274596,"node_id":"IC_kwDOCW7NX85eqyWk","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-13T00:08:44Z","updated_at":"2023-06-13T00:08:44Z","author_association":"CONTRIBUTOR","body":"@nastra, this is looking really close. I think the only issue is validating that the assertions are created correctly from the base table state, not just that the correct type of requirements are created. I guess this was being tested before by the REST catalog tests since these were embedded, but now that this is stand-alone logic I'd prefer to finish the tests. Also, we should make sure that there are tests for all of the paths in `UpdateRequirements` including when requirements are omitted because the table state has already changed (for example, two `SetCurrentSchema` updates).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1588274596/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1589053551","html_url":"https://github.com/apache/iceberg/pull/7826#issuecomment-1589053551","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7826","id":1589053551,"node_id":"IC_kwDOCW7NX85etwhv","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-13T10:48:36Z","updated_at":"2023-06-13T10:48:36Z","author_association":"MEMBER","body":"cc: @nastra ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1589053551/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1589161981","html_url":"https://github.com/apache/iceberg/pull/7828#issuecomment-1589161981","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7828","id":1589161981,"node_id":"IC_kwDOCW7NX85euK_9","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-13T12:00:11Z","updated_at":"2023-06-13T12:00:11Z","author_association":"MEMBER","body":"This PR depends on / includes  #7702","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1589161981/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1589308633","html_url":"https://github.com/apache/iceberg/issues/6853#issuecomment-1589308633","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6853","id":1589308633,"node_id":"IC_kwDOCW7NX85euuzZ","user":{"login":"JakeMcPherson25","id":41159681,"node_id":"MDQ6VXNlcjQxMTU5Njgx","avatar_url":"https://avatars.githubusercontent.com/u/41159681?v=4","gravatar_id":"","url":"https://api.github.com/users/JakeMcPherson25","html_url":"https://github.com/JakeMcPherson25","followers_url":"https://api.github.com/users/JakeMcPherson25/followers","following_url":"https://api.github.com/users/JakeMcPherson25/following{/other_user}","gists_url":"https://api.github.com/users/JakeMcPherson25/gists{/gist_id}","starred_url":"https://api.github.com/users/JakeMcPherson25/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JakeMcPherson25/subscriptions","organizations_url":"https://api.github.com/users/JakeMcPherson25/orgs","repos_url":"https://api.github.com/users/JakeMcPherson25/repos","events_url":"https://api.github.com/users/JakeMcPherson25/events{/privacy}","received_events_url":"https://api.github.com/users/JakeMcPherson25/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-13T13:22:15Z","updated_at":"2023-06-13T13:22:15Z","author_association":"NONE","body":"I am seeing a similar issue with decimal partitions with trailing zero's using an `IN` predicate. They seem to get filtered out through the ResidualEvaluator. For example \r\nthe table data structure:\r\n```\r\ns3a://warehouse/iceberg_test1/data/varchar1=test1/int1=1383779907/decimal1=1.1000\r\ns3a://warehouse/iceberg_test1/data/varchar1=test1/int1=1383779907/decimal1=1.2000\r\ns3a://warehouse/iceberg_test1/data/varchar1=test1/int1=1383779907/decimal1=1.2001\r\ns3a://warehouse/iceberg_test1/data/varchar1=test1/int1=1383779907/decimal1=1.2002\r\ns3a://warehouse/iceberg_test1/data/varchar1=test1/int1=1383779907/decimal1=1.4000\r\n```\r\nwhen running the predicate:`SELECT * FROM iceberg_test1 where decimal1 IN(1.4000,1.1000)`\r\nit returns the results \r\n```\r\nreal1                    varchar1                                      int1                    decimal1\r\n------------------------ --------------------------------------------- ----------------------- ---------------------------\r\n\r\n  0 record(s) selected.\r\n```\r\nfurthermore this works when the `IN` predicate only contains 1 value (in this situation iceberg converts the the `IN` to an `==` here: https://github.com/apache/iceberg/blob/c256604b34233885f6565902719bbfcf55e4cacf/api/src/main/java/org/apache/iceberg/expressions/UnboundPredicate.java#L223-L234 and this predicate produces the correct results.\r\n\r\nEliminating the decimal column from the partition expression during the create table statement resolves this issue as well. I understand that this is most likely a separate issue but both problems seem extremely similar ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1589308633/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1589400420","html_url":"https://github.com/apache/iceberg/issues/7827#issuecomment-1589400420","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7827","id":1589400420,"node_id":"IC_kwDOCW7NX85evFNk","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-13T14:12:21Z","updated_at":"2023-06-13T14:12:21Z","author_association":"MEMBER","body":"You actually have two problems. The \"Location based table\" means there is no catalog for your table. It's location is wherever it is. Basically when looking for a metadata.json file, it just looks in that spot. So you can't ever \"change\" this location because by definition the location of the table is where you are looking for the file.\r\n\r\nThe second issue is that even if you could update the location, or set a new data directory or metadata directory (those are options with a location based table), this would only effect new files. The metadata for old files would remain and the references to files would be unchanged. This means if you saved the full cluster path in the only metadata files, the only way to update the location would be to write new metadata files. Unfortunately, at the moment there is no automatic way to do this. Internally we have written small actions to do this but that code is not in OSS.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1589400420/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1589562303","html_url":"https://github.com/apache/iceberg/pull/6906#issuecomment-1589562303","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6906","id":1589562303,"node_id":"IC_kwDOCW7NX85evsu_","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-13T15:38:30Z","updated_at":"2023-06-13T15:38:30Z","author_association":"CONTRIBUTOR","body":"@Buktoria No problem, just checking if it is still on your list. Would be really cool to get this in.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1589562303/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1589624909","html_url":"https://github.com/apache/iceberg/pull/7781#issuecomment-1589624909","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7781","id":1589624909,"node_id":"IC_kwDOCW7NX85ev8BN","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-13T16:14:44Z","updated_at":"2023-06-13T16:14:44Z","author_association":"CONTRIBUTOR","body":"@tilman151 Thanks for picking this up!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1589624909/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1589651373","html_url":"https://github.com/apache/iceberg/pull/7761#issuecomment-1589651373","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7761","id":1589651373,"node_id":"IC_kwDOCW7NX85ewCet","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-13T16:30:26Z","updated_at":"2023-06-13T16:30:26Z","author_association":"CONTRIBUTOR","body":"thanks @TaoZex for your contribution and welcome to the Iceberg community","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1589651373/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1589733593","html_url":"https://github.com/apache/iceberg/issues/6181#issuecomment-1589733593","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6181","id":1589733593,"node_id":"IC_kwDOCW7NX85ewWjZ","user":{"login":"jackieo168","id":35482650,"node_id":"MDQ6VXNlcjM1NDgyNjUw","avatar_url":"https://avatars.githubusercontent.com/u/35482650?v=4","gravatar_id":"","url":"https://api.github.com/users/jackieo168","html_url":"https://github.com/jackieo168","followers_url":"https://api.github.com/users/jackieo168/followers","following_url":"https://api.github.com/users/jackieo168/following{/other_user}","gists_url":"https://api.github.com/users/jackieo168/gists{/gist_id}","starred_url":"https://api.github.com/users/jackieo168/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackieo168/subscriptions","organizations_url":"https://api.github.com/users/jackieo168/orgs","repos_url":"https://api.github.com/users/jackieo168/repos","events_url":"https://api.github.com/users/jackieo168/events{/privacy}","received_events_url":"https://api.github.com/users/jackieo168/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-13T17:26:44Z","updated_at":"2023-06-13T17:26:44Z","author_association":"NONE","body":"> The problem has been solved. It's my local environment. It's fine now @nastra\r\n\r\nHi @V-yg, may I ask what you did to resolve the issue?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1589733593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1589874661","html_url":"https://github.com/apache/iceberg/issues/7832#issuecomment-1589874661","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7832","id":1589874661,"node_id":"IC_kwDOCW7NX85ew4_l","user":{"login":"rajasinghr","id":41968211,"node_id":"MDQ6VXNlcjQxOTY4MjEx","avatar_url":"https://avatars.githubusercontent.com/u/41968211?v=4","gravatar_id":"","url":"https://api.github.com/users/rajasinghr","html_url":"https://github.com/rajasinghr","followers_url":"https://api.github.com/users/rajasinghr/followers","following_url":"https://api.github.com/users/rajasinghr/following{/other_user}","gists_url":"https://api.github.com/users/rajasinghr/gists{/gist_id}","starred_url":"https://api.github.com/users/rajasinghr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajasinghr/subscriptions","organizations_url":"https://api.github.com/users/rajasinghr/orgs","repos_url":"https://api.github.com/users/rajasinghr/repos","events_url":"https://api.github.com/users/rajasinghr/events{/privacy}","received_events_url":"https://api.github.com/users/rajasinghr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-13T19:07:58Z","updated_at":"2023-06-13T19:07:58Z","author_association":"NONE","body":"Attaching the recent spark plan. \r\n![localhost_18080_history_spark-application-1686605110730_SQL_execution__id=5](https://github.com/apache/iceberg/assets/41968211/215ae584-69fb-4e6c-a5d4-b35b0fba37aa)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1589874661/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1589945848","html_url":"https://github.com/apache/iceberg/pull/7831#issuecomment-1589945848","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7831","id":1589945848,"node_id":"IC_kwDOCW7NX85exKX4","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-13T20:03:02Z","updated_at":"2023-06-13T20:06:00Z","author_association":"CONTRIBUTOR","body":"Hey @maxdebayser thanks for raising this PR. I had something different in mind with the issue. The main problem here is that we pull a lot of data through Python, which brings in a lot of issues (the binary conversion that's probably expensive, and limited scalability due to the GIL).\r\n\r\nI just did a quick stab (and should have done that sooner), and found the following:\r\n\r\n```python\r\n➜  Desktop python3 \r\nPython 3.11.3 (main, Apr  7 2023, 20:13:31) [Clang 14.0.0 (clang-1400.0.29.202)] on darwin\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import pyarrow as pa\r\n>>> table = pa.table({'n_legs': [2, 2, 4, 4, 5, 100],\r\n...                   'animal': [\"Flamingo\", \"Parrot\", \"Dog\", \"Horse\",\r\n...                              \"Brittle stars\", \"Centipede\"]})\r\n>>> metadata_collector = []\r\n>>> import pyarrow.parquet as pq\r\n>>> pq.write_to_dataset(\r\n...     table, '/tmp/table',\r\n...      metadata_collector=metadata_collector)\r\n>>> metadata_collector\r\n[<pyarrow._parquet.FileMetaData object at 0x11f955850>\r\n  created_by: parquet-cpp-arrow version 11.0.0\r\n  num_columns: 2\r\n  num_rows: 6\r\n  num_row_groups: 1\r\n  format_version: 1.0\r\n  serialized_size: 0]\r\n\r\n>>> metadata_collector[0].row_group(0)\r\n<pyarrow._parquet.RowGroupMetaData object at 0x105837d80>\r\n  num_columns: 2\r\n  num_rows: 6\r\n  total_byte_size: 256\r\n\r\n>>> metadata_collector[0].row_group(0).to_dict()\r\n{\r\n\t'num_columns': 2,\r\n\t'num_rows': 6,\r\n\t'total_byte_size': 256,\r\n\t'columns': [{\r\n\t\t'file_offset': 119,\r\n\t\t'file_path': 'c569c5eaf90c4395885f31e012068b69-0.parquet',\r\n\t\t'physical_type': 'INT64',\r\n\t\t'num_values': 6,\r\n\t\t'path_in_schema': 'n_legs',\r\n\t\t'is_stats_set': True,\r\n\t\t'statistics': {\r\n\t\t\t'has_min_max': True,\r\n\t\t\t'min': 2,\r\n\t\t\t'max': 100,\r\n\t\t\t'null_count': 0,\r\n\t\t\t'distinct_count': 0,\r\n\t\t\t'num_values': 6,\r\n\t\t\t'physical_type': 'INT64'\r\n\t\t},\r\n\t\t'compression': 'SNAPPY',\r\n\t\t'encodings': ('PLAIN_DICTIONARY', 'PLAIN', 'RLE'),\r\n\t\t'has_dictionary_page': True,\r\n\t\t'dictionary_page_offset': 4,\r\n\t\t'data_page_offset': 46,\r\n\t\t'total_compressed_size': 115,\r\n\t\t'total_uncompressed_size': 117\r\n\t}, {\r\n\t\t'file_offset': 359,\r\n\t\t'file_path': 'c569c5eaf90c4395885f31e012068b69-0.parquet',\r\n\t\t'physical_type': 'BYTE_ARRAY',\r\n\t\t'num_values': 6,\r\n\t\t'path_in_schema': 'animal',\r\n\t\t'is_stats_set': True,\r\n\t\t'statistics': {\r\n\t\t\t'has_min_max': True,\r\n\t\t\t'min': 'Brittle stars',\r\n\t\t\t'max': 'Parrot',\r\n\t\t\t'null_count': 0,\r\n\t\t\t'distinct_count': 0,\r\n\t\t\t'num_values': 6,\r\n\t\t\t'physical_type': 'BYTE_ARRAY'\r\n\t\t},\r\n\t\t'compression': 'SNAPPY',\r\n\t\t'encodings': ('PLAIN_DICTIONARY', 'PLAIN', 'RLE'),\r\n\t\t'has_dictionary_page': True,\r\n\t\t'dictionary_page_offset': 215,\r\n\t\t'data_page_offset': 302,\r\n\t\t'total_compressed_size': 144,\r\n\t\t'total_uncompressed_size': 139\r\n\t}]\r\n}\r\n```\r\n\r\nI think it is much better to retrieve the min-max from there. This is done by PyArrow and is probably much faster than when we do it in Python. I really would like to stay away from processing data as much as possible.\r\n\r\nI think the complexity here is:\r\n\r\n- How does this work with nested columns\r\n- I think most of it is there, but we're missing the NaN's. Adding this to Parquet, is still an open PR: https://github.com/apache/parquet-format/pull/196","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1589945848/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590003401","html_url":"https://github.com/apache/iceberg/pull/7831#issuecomment-1590003401","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7831","id":1590003401,"node_id":"IC_kwDOCW7NX85exYbJ","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-13T20:46:00Z","updated_at":"2023-06-13T20:46:00Z","author_association":"CONTRIBUTOR","body":"It looks like the metadata is also available on the plain writer, where we don't have to write a dataset:\r\n\r\n```python\r\n➜  Desktop python3                       \r\nPython 3.11.3 (main, Apr  7 2023, 20:13:31) [Clang 14.0.0 (clang-1400.0.29.202)] on darwin\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import pyarrow as pa\r\n>>> table = pa.table({'n_legs': [2, 2, 4, 4, 5, 100],\r\n...                   'animal': [\"Flamingo\", \"Parrot\", \"Dog\", \"Horse\", \"Brittle stars\", \"Centipede\"]})\r\n>>> import pyarrow.parquet as pq\r\n>>> \r\n>>> writer = pq.ParquetWriter('/tmp/vo.parquet', table.schema)\r\n>>> writer.write_table(table)\r\n>>> writer.close()\r\n>>> writer.writer.metadata.row_group(0)\r\n<pyarrow._parquet.RowGroupMetaData object at 0x1375b9080>\r\n  num_columns: 2\r\n  num_rows: 6\r\n  total_byte_size: 256\r\n>>> writer.writer.metadata.row_group(0).to_dict()\r\n{\r\n\t'num_columns': 2,\r\n\t'num_rows': 6,\r\n\t'total_byte_size': 256,\r\n\t'columns': [{\r\n\t\t'file_offset': 119,\r\n\t\t'file_path': '',\r\n\t\t'physical_type': 'INT64',\r\n\t\t'num_values': 6,\r\n\t\t'path_in_schema': 'n_legs',\r\n\t\t'is_stats_set': True,\r\n\t\t'statistics': {\r\n\t\t\t'has_min_max': True,\r\n\t\t\t'min': 2,\r\n\t\t\t'max': 100,\r\n\t\t\t'null_count': 0,\r\n\t\t\t'distinct_count': 0,\r\n\t\t\t'num_values': 6,\r\n\t\t\t'physical_type': 'INT64'\r\n\t\t},\r\n\t\t'compression': 'SNAPPY',\r\n\t\t'encodings': ('RLE_DICTIONARY', 'PLAIN', 'RLE'),\r\n\t\t'has_dictionary_page': True,\r\n\t\t'dictionary_page_offset': 4,\r\n\t\t'data_page_offset': 46,\r\n\t\t'total_compressed_size': 115,\r\n\t\t'total_uncompressed_size': 117\r\n\t}, {\r\n\t\t'file_offset': 359,\r\n\t\t'file_path': '',\r\n\t\t'physical_type': 'BYTE_ARRAY',\r\n\t\t'num_values': 6,\r\n\t\t'path_in_schema': 'animal',\r\n\t\t'is_stats_set': True,\r\n\t\t'statistics': {\r\n\t\t\t'has_min_max': True,\r\n\t\t\t'min': 'Brittle stars',\r\n\t\t\t'max': 'Parrot',\r\n\t\t\t'null_count': 0,\r\n\t\t\t'distinct_count': 0,\r\n\t\t\t'num_values': 6,\r\n\t\t\t'physical_type': 'BYTE_ARRAY'\r\n\t\t},\r\n\t\t'compression': 'SNAPPY',\r\n\t\t'encodings': ('RLE_DICTIONARY', 'PLAIN', 'RLE'),\r\n\t\t'has_dictionary_page': True,\r\n\t\t'dictionary_page_offset': 215,\r\n\t\t'data_page_offset': 302,\r\n\t\t'total_compressed_size': 144,\r\n\t\t'total_uncompressed_size': 139\r\n\t}]\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590003401/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590005818","html_url":"https://github.com/apache/iceberg/pull/7831#issuecomment-1590005818","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7831","id":1590005818,"node_id":"IC_kwDOCW7NX85exZA6","user":{"login":"maxdebayser","id":1291418,"node_id":"MDQ6VXNlcjEyOTE0MTg=","avatar_url":"https://avatars.githubusercontent.com/u/1291418?v=4","gravatar_id":"","url":"https://api.github.com/users/maxdebayser","html_url":"https://github.com/maxdebayser","followers_url":"https://api.github.com/users/maxdebayser/followers","following_url":"https://api.github.com/users/maxdebayser/following{/other_user}","gists_url":"https://api.github.com/users/maxdebayser/gists{/gist_id}","starred_url":"https://api.github.com/users/maxdebayser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxdebayser/subscriptions","organizations_url":"https://api.github.com/users/maxdebayser/orgs","repos_url":"https://api.github.com/users/maxdebayser/repos","events_url":"https://api.github.com/users/maxdebayser/events{/privacy}","received_events_url":"https://api.github.com/users/maxdebayser/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-13T20:48:32Z","updated_at":"2023-06-13T20:48:32Z","author_association":"CONTRIBUTOR","body":"@Fokko, I understand your concern, I think it's because we have different use cases in mind.\r\n\r\nIf I understand correctly you want to write a pyarrow.Table to a partitioned dataset with write_dataset. Therefore computing min/max on the whole Table is not what you need because you actually need the min/max for the columns of the individual files. (Just pointing out that with the metadata collector you get the stats for the row chunks, so you'll still have to compute the stats for the file from those).\r\n\r\nI'm coming from a different use case. I would like to write from Ray using something like https://docs.ray.io/en/latest/data/api/doc/ray.data.Dataset.write_parquet.html#ray.data.Dataset.write_parquet . In this case there is no global pyarrow.Table that represent the dataset, Pyarrow tables are the blocks of the dataset that each individual ray task sees, for example in `map_batches`. In this scenario the pyarrow.write_dataset cannot be used because the full dataset is not entirely loaded into the memory of any compute node. In this scenario the GIL is also not a big concern because ray uses multiple worker processes.\r\n\r\nI think we have to see if there is a way to have a single API for both use cases or if we'll need to have different API calls for both. In the second case it would be better to share part of the implementation to ensure that the behavior is consistent, but it could perhaps lead to bad performance.\r\n\r\nRegarding the efficiency, the pyarrow.compute.min function is implemented in C++, so I think the performance is probably not a huge concern here. But I can try to compare both approaches with a large enough data set to measure it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590005818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590051495","html_url":"https://github.com/apache/iceberg/pull/7743#issuecomment-1590051495","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7743","id":1590051495,"node_id":"IC_kwDOCW7NX85exkKn","user":{"login":"CodingCat","id":678008,"node_id":"MDQ6VXNlcjY3ODAwOA==","avatar_url":"https://avatars.githubusercontent.com/u/678008?v=4","gravatar_id":"","url":"https://api.github.com/users/CodingCat","html_url":"https://github.com/CodingCat","followers_url":"https://api.github.com/users/CodingCat/followers","following_url":"https://api.github.com/users/CodingCat/following{/other_user}","gists_url":"https://api.github.com/users/CodingCat/gists{/gist_id}","starred_url":"https://api.github.com/users/CodingCat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodingCat/subscriptions","organizations_url":"https://api.github.com/users/CodingCat/orgs","repos_url":"https://api.github.com/users/CodingCat/repos","events_url":"https://api.github.com/users/CodingCat/events{/privacy}","received_events_url":"https://api.github.com/users/CodingCat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-13T21:30:37Z","updated_at":"2023-06-13T21:30:37Z","author_association":"CONTRIBUTOR","body":"@flyrain sorry for the delay, just addressed the comments, please take another look","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590051495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590236576","html_url":"https://github.com/apache/iceberg/issues/6302#issuecomment-1590236576","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6302","id":1590236576,"node_id":"IC_kwDOCW7NX85eyRWg","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-06-14T00:11:55Z","updated_at":"2023-06-14T00:11:55Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590236576/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590236602","html_url":"https://github.com/apache/iceberg/issues/6290#issuecomment-1590236602","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6290","id":1590236602,"node_id":"IC_kwDOCW7NX85eyRW6","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-06-14T00:11:57Z","updated_at":"2023-06-14T00:11:57Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590236602/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590326411","html_url":"https://github.com/apache/iceberg/issues/7797#issuecomment-1590326411","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7797","id":1590326411,"node_id":"IC_kwDOCW7NX85eynSL","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-14T02:00:07Z","updated_at":"2023-06-14T02:00:07Z","author_association":"CONTRIBUTOR","body":"Yea, 'write.target-file-size-bytes' can only split large files into files of the target size, and cannot merge small files. \r\nWhat's your table's `write.distribution-mode`, if it's `none`, try to change it to `hash` or `range`, In addition, you may also need to tune the Spark AQE parameters, (Assuming you are using Spark, don't know if other engines need additional tunning.) Please refer this [docs](https://iceberg.apache.org/docs/latest/spark-writes/#writing-distribution-modes) for more information, it do a good job of explaining how to control file size when using Spark.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590326411/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590587514","html_url":"https://github.com/apache/iceberg/pull/7836#issuecomment-1590587514","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7836","id":1590587514,"node_id":"IC_kwDOCW7NX85eznB6","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-14T07:01:11Z","updated_at":"2023-06-14T07:01:11Z","author_association":"CONTRIBUTOR","body":"Hi @stevenzwu @pvary @Fokko @chenjunjiedada, could you help to review this? Thanks a lot.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590587514/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590604013","html_url":"https://github.com/apache/iceberg/pull/7829#issuecomment-1590604013","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7829","id":1590604013,"node_id":"IC_kwDOCW7NX85ezrDt","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-14T07:09:03Z","updated_at":"2023-06-14T07:09:03Z","author_association":"CONTRIBUTOR","body":"Thanks @Rondiz for the work, this is awesome! 🥳 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590604013/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590605138","html_url":"https://github.com/apache/iceberg/pull/7823#issuecomment-1590605138","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7823","id":1590605138,"node_id":"IC_kwDOCW7NX85ezrVS","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-14T07:09:47Z","updated_at":"2023-06-14T07:09:47Z","author_association":"CONTRIBUTOR","body":"@mderoy Could you rebase? https://github.com/apache/iceberg/pull/7829 went just in and it looks it has a lot of conflicts","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590605138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590611619","html_url":"https://github.com/apache/iceberg/pull/7744#issuecomment-1590611619","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7744","id":1590611619,"node_id":"IC_kwDOCW7NX85ezs6j","user":{"login":"gaborkaszab","id":29145491,"node_id":"MDQ6VXNlcjI5MTQ1NDkx","avatar_url":"https://avatars.githubusercontent.com/u/29145491?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborkaszab","html_url":"https://github.com/gaborkaszab","followers_url":"https://api.github.com/users/gaborkaszab/followers","following_url":"https://api.github.com/users/gaborkaszab/following{/other_user}","gists_url":"https://api.github.com/users/gaborkaszab/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborkaszab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborkaszab/subscriptions","organizations_url":"https://api.github.com/users/gaborkaszab/orgs","repos_url":"https://api.github.com/users/gaborkaszab/repos","events_url":"https://api.github.com/users/gaborkaszab/events{/privacy}","received_events_url":"https://api.github.com/users/gaborkaszab/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-14T07:14:50Z","updated_at":"2023-06-14T07:14:50Z","author_association":"COLLABORATOR","body":"I made another round of review and I think this PR is fine.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590611619/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590614290","html_url":"https://github.com/apache/iceberg/pull/7744#issuecomment-1590614290","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7744","id":1590614290,"node_id":"IC_kwDOCW7NX85eztkS","user":{"login":"gaborkaszab","id":29145491,"node_id":"MDQ6VXNlcjI5MTQ1NDkx","avatar_url":"https://avatars.githubusercontent.com/u/29145491?v=4","gravatar_id":"","url":"https://api.github.com/users/gaborkaszab","html_url":"https://github.com/gaborkaszab","followers_url":"https://api.github.com/users/gaborkaszab/followers","following_url":"https://api.github.com/users/gaborkaszab/following{/other_user}","gists_url":"https://api.github.com/users/gaborkaszab/gists{/gist_id}","starred_url":"https://api.github.com/users/gaborkaszab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaborkaszab/subscriptions","organizations_url":"https://api.github.com/users/gaborkaszab/orgs","repos_url":"https://api.github.com/users/gaborkaszab/repos","events_url":"https://api.github.com/users/gaborkaszab/events{/privacy}","received_events_url":"https://api.github.com/users/gaborkaszab/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-14T07:16:51Z","updated_at":"2023-06-14T07:16:51Z","author_association":"COLLABORATOR","body":"Also comparing to the other solution, indeed this in-place approach seems better because it won't require any changes on the client side. One last thing I'd like to try is to make a build from this, load it under my local Impala and run my tests just to be on the safe side.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590614290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590762684","html_url":"https://github.com/apache/iceberg/issues/7644#issuecomment-1590762684","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7644","id":1590762684,"node_id":"IC_kwDOCW7NX85e0Ry8","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-14T08:52:19Z","updated_at":"2023-06-14T08:52:19Z","author_association":"CONTRIBUTOR","body":"@grobgl Sorry for the lack of attention. I was going through https://github.com/apache/iceberg/issues/5800#issuecomment-1553073273 and I think it makes sense to add this. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590762684/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590981825","html_url":"https://github.com/apache/iceberg/issues/7827#issuecomment-1590981825","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7827","id":1590981825,"node_id":"IC_kwDOCW7NX85e1HTB","user":{"login":"zixiao144","id":21092977,"node_id":"MDQ6VXNlcjIxMDkyOTc3","avatar_url":"https://avatars.githubusercontent.com/u/21092977?v=4","gravatar_id":"","url":"https://api.github.com/users/zixiao144","html_url":"https://github.com/zixiao144","followers_url":"https://api.github.com/users/zixiao144/followers","following_url":"https://api.github.com/users/zixiao144/following{/other_user}","gists_url":"https://api.github.com/users/zixiao144/gists{/gist_id}","starred_url":"https://api.github.com/users/zixiao144/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zixiao144/subscriptions","organizations_url":"https://api.github.com/users/zixiao144/orgs","repos_url":"https://api.github.com/users/zixiao144/repos","events_url":"https://api.github.com/users/zixiao144/events{/privacy}","received_events_url":"https://api.github.com/users/zixiao144/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-14T11:06:59Z","updated_at":"2023-06-14T11:06:59Z","author_association":"NONE","body":"Thanks  you for your answer","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1590981825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1591040882","html_url":"https://github.com/apache/iceberg/pull/7664#issuecomment-1591040882","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7664","id":1591040882,"node_id":"IC_kwDOCW7NX85e1Vty","user":{"login":"bryanck","id":5475421,"node_id":"MDQ6VXNlcjU0NzU0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/5475421?v=4","gravatar_id":"","url":"https://api.github.com/users/bryanck","html_url":"https://github.com/bryanck","followers_url":"https://api.github.com/users/bryanck/followers","following_url":"https://api.github.com/users/bryanck/following{/other_user}","gists_url":"https://api.github.com/users/bryanck/gists{/gist_id}","starred_url":"https://api.github.com/users/bryanck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bryanck/subscriptions","organizations_url":"https://api.github.com/users/bryanck/orgs","repos_url":"https://api.github.com/users/bryanck/repos","events_url":"https://api.github.com/users/bryanck/events{/privacy}","received_events_url":"https://api.github.com/users/bryanck/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-14T11:49:30Z","updated_at":"2023-06-14T11:49:30Z","author_association":"CONTRIBUTOR","body":"I created a new PR for this: https://github.com/apache/iceberg/pull/7834","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1591040882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1591140971","html_url":"https://github.com/apache/iceberg/pull/6712#issuecomment-1591140971","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6712","id":1591140971,"node_id":"IC_kwDOCW7NX85e1uJr","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-14T12:51:26Z","updated_at":"2023-06-14T12:52:08Z","author_association":"MEMBER","body":"I just rebased the PR (as it was stale) \r\n\r\n@snazy: The previous comments are addressed. Can you please take a look at this again? Thanks.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1591140971/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]