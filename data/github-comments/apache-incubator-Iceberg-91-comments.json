[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833707758","html_url":"https://github.com/apache/iceberg/pull/2552#issuecomment-833707758","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2552","id":833707758,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzcwNzc1OA==","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T17:29:36Z","updated_at":"2021-05-06T17:29:36Z","author_association":"CONTRIBUTOR","body":"User should avoid eventually consistent Catalog if possible. If Hive catalog is used, we normally expect HMS is strong consistency. It is NOT the case some times, for example, HMS could be an eventual consistency system if it uses Cassandra as the backend DB. But I like the call-out from @RussellSpitzer and @kbendick, avoid it as much as possible.\r\n\r\nHowever, we cannot remove eventual consistency related code if Iceberg still support Hadoop catalog, which based on an eventual consistency system, HDFS. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833707758/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833724970","html_url":"https://github.com/apache/iceberg/issues/2553#issuecomment-833724970","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2553","id":833724970,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzcyNDk3MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T17:40:13Z","updated_at":"2021-05-06T17:40:13Z","author_association":"CONTRIBUTOR","body":"The metrics setting is for Iceberg metrics and this is happening when filtering row groups in Parquet. That's why the metrics setting doesn't help. We just need to update Iceberg's [ParquetMetricsRowGroupFilter](https://github.com/apache/iceberg/blob/master/parquet/src/main/java/org/apache/iceberg/parquet/ParquetMetricsRowGroupFilter.java#L97) to ignore INT96 stats. I thought that Parquet would not return them in the first place, which is why I think we overlooked this. Would you like to open a PR with the fix, @thesquelched?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833724970/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833747517","html_url":"https://github.com/apache/iceberg/issues/2446#issuecomment-833747517","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2446","id":833747517,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzc0NzUxNw==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T18:11:03Z","updated_at":"2021-05-06T18:11:03Z","author_association":"CONTRIBUTOR","body":"I believe you can request on gitbox\n\nOn Wed, 5 May 2021, 23:18 Anton Okolnychyi, ***@***.***>\nwrote:\n\n> Sorry, missed the last messages. Any tips on how to do that, @rymurr\n> <https://github.com/rymurr>?\n>\n> cc @rdblue <https://github.com/rdblue>\n>\n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/iceberg/issues/2446#issuecomment-833013835>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AAPNXIMXSXBXL6VTMBJ3YO3TMGY2JANCNFSM42UM3FDA>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833747517/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833752923","html_url":"https://github.com/apache/iceberg/issues/2553#issuecomment-833752923","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2553","id":833752923,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzc1MjkyMw==","user":{"login":"thesquelched","id":838700,"node_id":"MDQ6VXNlcjgzODcwMA==","avatar_url":"https://avatars.githubusercontent.com/u/838700?v=4","gravatar_id":"","url":"https://api.github.com/users/thesquelched","html_url":"https://github.com/thesquelched","followers_url":"https://api.github.com/users/thesquelched/followers","following_url":"https://api.github.com/users/thesquelched/following{/other_user}","gists_url":"https://api.github.com/users/thesquelched/gists{/gist_id}","starred_url":"https://api.github.com/users/thesquelched/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thesquelched/subscriptions","organizations_url":"https://api.github.com/users/thesquelched/orgs","repos_url":"https://api.github.com/users/thesquelched/repos","events_url":"https://api.github.com/users/thesquelched/events{/privacy}","received_events_url":"https://api.github.com/users/thesquelched/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T18:19:11Z","updated_at":"2021-05-06T18:19:11Z","author_association":"NONE","body":"> Would you like to open a PR with the fix, @thesquelched?\r\n\r\nI'm hoping to have one up today or tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833752923/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833804851","html_url":"https://github.com/apache/iceberg/pull/2427#issuecomment-833804851","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2427","id":833804851,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzgwNDg1MQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T19:34:30Z","updated_at":"2021-05-06T19:34:30Z","author_association":"CONTRIBUTOR","body":"@rdblue, rebased.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833804851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833844963","html_url":"https://github.com/apache/iceberg/pull/2427#issuecomment-833844963","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2427","id":833844963,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzg0NDk2Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T20:38:55Z","updated_at":"2021-05-06T20:38:55Z","author_association":"CONTRIBUTOR","body":"Thanks, Anton!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833844963/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833845266","html_url":"https://github.com/apache/iceberg/issues/2557#issuecomment-833845266","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2557","id":833845266,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzg0NTI2Ng==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T20:39:21Z","updated_at":"2021-05-06T20:39:36Z","author_association":"CONTRIBUTOR","body":"For the record, these logs are not a big deal if y'all find them helpful. I don't typically work over there, so I don't know.\r\n\r\nIf we did want to do clean up, I'd be happy to open another issue for Flink. Or if this is not something that's relatively simple to update in Gradle for test suites, then it's likely not worth the effort as mostly what I look for in test logs is just failure related issues.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833845266/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833892984","html_url":"https://github.com/apache/iceberg/pull/2503#issuecomment-833892984","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2503","id":833892984,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzg5Mjk4NA==","user":{"login":"karuppayya","id":5082742,"node_id":"MDQ6VXNlcjUwODI3NDI=","avatar_url":"https://avatars.githubusercontent.com/u/5082742?v=4","gravatar_id":"","url":"https://api.github.com/users/karuppayya","html_url":"https://github.com/karuppayya","followers_url":"https://api.github.com/users/karuppayya/followers","following_url":"https://api.github.com/users/karuppayya/following{/other_user}","gists_url":"https://api.github.com/users/karuppayya/gists{/gist_id}","starred_url":"https://api.github.com/users/karuppayya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karuppayya/subscriptions","organizations_url":"https://api.github.com/users/karuppayya/orgs","repos_url":"https://api.github.com/users/karuppayya/repos","events_url":"https://api.github.com/users/karuppayya/events{/privacy}","received_events_url":"https://api.github.com/users/karuppayya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T21:51:15Z","updated_at":"2021-05-06T21:51:15Z","author_association":"CONTRIBUTOR","body":"Test failures doesnot seem to be related to the change.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833892984/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833970309","html_url":"https://github.com/apache/iceberg/pull/2503#issuecomment-833970309","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2503","id":833970309,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzk3MDMwOQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T00:29:29Z","updated_at":"2021-05-07T00:29:29Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer, could you take one more look too?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833970309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833973237","html_url":"https://github.com/apache/iceberg/pull/2547#issuecomment-833973237","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2547","id":833973237,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzk3MzIzNw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T00:36:57Z","updated_at":"2021-05-07T00:36:57Z","author_association":"CONTRIBUTOR","body":"Let me also take a look today/tomorrow. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833973237/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833998634","html_url":"https://github.com/apache/iceberg/issues/2558#issuecomment-833998634","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2558","id":833998634,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzk5ODYzNA==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T01:48:42Z","updated_at":"2021-05-07T01:48:42Z","author_association":"CONTRIBUTOR","body":"I tested that , when we remove `CatalogDescriptorValidator` ,  we can build succeed, but when run the test case, it is failed.  I think we may need to do some extra work to be compatible with 1.12 and 1.13","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/833998634/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834008832","html_url":"https://github.com/apache/iceberg/pull/2560#issuecomment-834008832","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2560","id":834008832,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDAwODgzMg==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T02:17:06Z","updated_at":"2021-05-07T02:17:06Z","author_association":"CONTRIBUTOR","body":"@openinx @rdblue @yyanyy could you take a look? Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834008832/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834036022","html_url":"https://github.com/apache/iceberg/pull/2538#issuecomment-834036022","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2538","id":834036022,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDAzNjAyMg==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T03:27:13Z","updated_at":"2021-05-07T03:27:13Z","author_association":"COLLABORATOR","body":"cc @jackye1995 as well. \r\n\r\nI added a couple of unit tests for this, more unit tests could be added in the deletes reader PR. @RussellSpitzer @yyanyy @rdblue @openinx, could you please help to take a look when you have time?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834036022/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834056017","html_url":"https://github.com/apache/iceberg/pull/2544#issuecomment-834056017","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2544","id":834056017,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDA1NjAxNw==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T04:30:41Z","updated_at":"2021-05-07T04:30:41Z","author_association":"CONTRIBUTOR","body":"@rdblue @marton-bod thanks for the new review, I moved the type conversion to the end to cover both forward and backward conversions. Please verify if the mappings are correct. \r\n\r\nApart from that, I think everything should be good to go. For the `custom` catalog type issue, I will put another PR later to fix it and make the experience consistent.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834056017/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834068536","html_url":"https://github.com/apache/iceberg/pull/2547#issuecomment-834068536","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2547","id":834068536,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDA2ODUzNg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T05:01:35Z","updated_at":"2021-05-07T05:01:35Z","author_association":"MEMBER","body":"Users can only synchronize entire writes not just the commit process. Without this patch, a user has to do the entire write process synchronously to gain the same effect.\n\nFor example instead of two jobs preparing files at the same time and then synchronously committing, a user would need to do one write and commit before proceeding to the next.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834068536/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834118497","html_url":"https://github.com/apache/iceberg/issues/2524#issuecomment-834118497","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2524","id":834118497,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDExODQ5Nw==","user":{"login":"jinchengchenghh","id":79615558,"node_id":"MDQ6VXNlcjc5NjE1NTU4","avatar_url":"https://avatars.githubusercontent.com/u/79615558?v=4","gravatar_id":"","url":"https://api.github.com/users/jinchengchenghh","html_url":"https://github.com/jinchengchenghh","followers_url":"https://api.github.com/users/jinchengchenghh/followers","following_url":"https://api.github.com/users/jinchengchenghh/following{/other_user}","gists_url":"https://api.github.com/users/jinchengchenghh/gists{/gist_id}","starred_url":"https://api.github.com/users/jinchengchenghh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jinchengchenghh/subscriptions","organizations_url":"https://api.github.com/users/jinchengchenghh/orgs","repos_url":"https://api.github.com/users/jinchengchenghh/repos","events_url":"https://api.github.com/users/jinchengchenghh/events{/privacy}","received_events_url":"https://api.github.com/users/jinchengchenghh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T06:59:18Z","updated_at":"2021-05-07T06:59:18Z","author_association":"NONE","body":"same issue, thank you! I will close this one.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834118497/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834667332","html_url":"https://github.com/apache/iceberg/pull/2564#issuecomment-834667332","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2564","id":834667332,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDY2NzMzMg==","user":{"login":"karuppayya","id":5082742,"node_id":"MDQ6VXNlcjUwODI3NDI=","avatar_url":"https://avatars.githubusercontent.com/u/5082742?v=4","gravatar_id":"","url":"https://api.github.com/users/karuppayya","html_url":"https://github.com/karuppayya","followers_url":"https://api.github.com/users/karuppayya/followers","following_url":"https://api.github.com/users/karuppayya/following{/other_user}","gists_url":"https://api.github.com/users/karuppayya/gists{/gist_id}","starred_url":"https://api.github.com/users/karuppayya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karuppayya/subscriptions","organizations_url":"https://api.github.com/users/karuppayya/orgs","repos_url":"https://api.github.com/users/karuppayya/repos","events_url":"https://api.github.com/users/karuppayya/events{/privacy}","received_events_url":"https://api.github.com/users/karuppayya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T18:14:06Z","updated_at":"2021-05-07T18:14:06Z","author_association":"CONTRIBUTOR","body":"cc: @aokolnychyi @RussellSpitzer @flyrain @kbendick for review. Thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834667332/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834724744","html_url":"https://github.com/apache/iceberg/pull/2547#issuecomment-834724744","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2547","id":834724744,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDcyNDc0NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T19:38:12Z","updated_at":"2021-05-07T19:38:12Z","author_association":"CONTRIBUTOR","body":"Thanks for fixing this, @marton-bod! Thanks for reviewing, @RussellSpitzer @pvary @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834724744/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834820165","html_url":"https://github.com/apache/iceberg/issues/2559#issuecomment-834820165","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2559","id":834820165,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDgyMDE2NQ==","user":{"login":"karuppayya","id":5082742,"node_id":"MDQ6VXNlcjUwODI3NDI=","avatar_url":"https://avatars.githubusercontent.com/u/5082742?v=4","gravatar_id":"","url":"https://api.github.com/users/karuppayya","html_url":"https://github.com/karuppayya","followers_url":"https://api.github.com/users/karuppayya/followers","following_url":"https://api.github.com/users/karuppayya/following{/other_user}","gists_url":"https://api.github.com/users/karuppayya/gists{/gist_id}","starred_url":"https://api.github.com/users/karuppayya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karuppayya/subscriptions","organizations_url":"https://api.github.com/users/karuppayya/orgs","repos_url":"https://api.github.com/users/karuppayya/repos","events_url":"https://api.github.com/users/karuppayya/events{/privacy}","received_events_url":"https://api.github.com/users/karuppayya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T22:19:24Z","updated_at":"2021-05-07T22:19:24Z","author_association":"CONTRIBUTOR","body":"PR: https://github.com/apache/iceberg/pull/2564","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834820165/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834853656","html_url":"https://github.com/apache/iceberg/issues/2533#issuecomment-834853656","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2533","id":834853656,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDg1MzY1Ng==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T23:17:34Z","updated_at":"2021-05-07T23:17:34Z","author_association":"CONTRIBUTOR","body":"cc @RussellSpitzer @flyrain @karuppayya @kbendick, has anyone seen anything similar? Can anybody investigate?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834853656/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834866563","html_url":"https://github.com/apache/iceberg/pull/2547#issuecomment-834866563","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2547","id":834866563,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDg2NjU2Mw==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T23:41:01Z","updated_at":"2021-05-07T23:41:01Z","author_association":"CONTRIBUTOR","body":"> Thanks @kbendick for reviewing. I also think we probably don't want to include this in the docs in order to avoid overloading users with internally-used configs they'll most likely never need to tune. Tuning this parameter should be very rare and 99% of users would not care about it, I expect. For the remainder of users, they will probably dig into the code anyway and find this flag quite soon after a bit of search, but just my 2 cents.\r\n\r\nYeah that makes sense to me. Only a power user would be likely to tune this parameter and they'd probably go into the code / reach out in one of the channels, etc, like you mentioned. 👍 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834866563/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834873360","html_url":"https://github.com/apache/iceberg/issues/2533#issuecomment-834873360","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2533","id":834873360,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDg3MzM2MA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T23:51:20Z","updated_at":"2021-05-07T23:51:20Z","author_association":"MEMBER","body":"Looks like there is a special casing for empty RDD's\r\n\r\nhttps://github.com/apache/spark/blob/d378dc5f6db6fe37426728bea714f44b94a94861/sql/core/src/main/scala/org/apache/spark/sql/execution/datasources/v2/WriteToDataSourceV2Exec.scala#L362-L371\r\n\r\nWhich generates a single partition rdd from a 0 partition rdd.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834873360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834876505","html_url":"https://github.com/apache/iceberg/issues/2533#issuecomment-834876505","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2533","id":834876505,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDg3NjUwNQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T23:55:59Z","updated_at":"2021-05-07T23:55:59Z","author_association":"MEMBER","body":"My guess is that something in our code is invoking a ZippedRDD (probably a broadcast join?) which ends up having 0 data in it. This is a ZippedRDD with 0 partitions, but there is an assertion error that you can't have such an RDD when we call .partitions\r\n\r\nhttps://github.com/apache/spark/blob/v3.0.2/sql/core/src/main/scala/org/apache/spark/sql/execution/datasources/v2/WriteToDataSourceV2Exec.scala#L366\r\n\r\nI'm going to see if I can figure out where we generate this RDD, basically we need to not have our underlying query.execute produce a zipped rdd if it is empty.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834876505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834913139","html_url":"https://github.com/apache/iceberg/issues/2533#issuecomment-834913139","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2533","id":834913139,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDkxMzEzOQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T00:50:59Z","updated_at":"2021-05-08T00:54:13Z","author_association":"MEMBER","body":"OK So here is what happens,\r\n\r\nWe build up this plan which has a sort merge join\r\n\r\nThe sort merge join implements as a zippartitions rdd\r\n```\r\nresult = {MapPartitionsRDD@21132} \"MapPartitionsRDD[49] at sql at <console>:26\"\r\n isBarrier_ = false\r\n prev = {ZippedPartitionsRDD2@21135} \"ZippedPartitionsRDD2[48] at sql at <console>:26\"\r\n  f = {SortMergeJoinExec$lambda@21156} \"org.apache.spark.sql.execution.joins.SortMergeJoinExec$$Lambda$3615/2092599862@10710787\"\r\n   arg = {SortMergeJoinExec@21170} \"SortMergeJoin [user_name#39, start_time#32], [user_name#36, end_time#35], FullOuter\\n:- *(2) Sort [user_name#39 ASC NULLS FIRST, start_time#32 ASC NULLS FIRST], false, 0\\n:  +- SortAggregate(key=[user_name#39], functions=[min(log_time#37), max(log_time#37)], output=[start_time#32, end_time#33, user_name#39, _row_from_source_#42])\\n:     +- SortAggregate(key=[user_name#39], functions=[partial_min(log_time#37), partial_max(log_time#37)], output=[user_name#39, min#60, max#61])\\n:        +- *(1) Sort [user_name#39 ASC NULLS FIRST], false, 0\\n:           +- *(1) Project [log_time#37, user_name#39]\\n:              +- *(1) Filter ((isnotnull(log_time#37) AND (log_time#37 >= 2021-05-06 12:05:00)) AND (log_time#37 < 2021-05-06 12:10:00))\\n:                 +- BatchScan[log_time#37, user_name#39] iceberg.iceberg_db.user_logs [filters=log_time IS NOT NULL, log_time >= '2021-05-06 12:05:00', log_time < '2021-05-06 12:10:00']\\n+- *(8) Sort [user_name#36 ASC NULLS FIRST, end_time#35 ASC NULLS FIRST], false,\"\r\n   ```\r\n   \r\n   This is because of SortMergeJoinExec\r\n   \r\n   https://github.com/apache/spark/blob/94cac5978cf33f99a9f28180c9c909d5c884c152/sql/core/src/main/scala/org/apache/spark/sql/execution/joins/SortMergeJoinExec.scala#L132\r\n   \r\n   does the zip partitions. This code is not built for handling what happens when you try to zip a 0 partition RDD with a 1 Partition RDD.\r\n   \r\n   I think we basically just need to preempt our creation of a JoinPlan if either side of the join is an empty RDD and just bail out in the MergePlanning. Or we have to never create 0 partition rdd's from our sources ... ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834913139/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834940896","html_url":"https://github.com/apache/iceberg/issues/2533#issuecomment-834940896","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2533","id":834940896,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDk0MDg5Ng==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T01:34:42Z","updated_at":"2021-05-08T01:34:42Z","author_association":"MEMBER","body":"Spark normally just won't plan a join when one side is empty, quick demonstration\r\n\r\n```\r\nscala> val left = spark.createDataset(Seq.empty[Row])\r\nleft: org.apache.spark.sql.Dataset[Row] = [i: int]\r\n\r\nscala> val right = spark.createDataset(Seq(Row(1)))\r\nright: org.apache.spark.sql.Dataset[Row] = [i: int]\r\n\r\nscala> left.join(right, left(\"i\") === right(\"i\"), \"left_outer\").show\r\n+---+---+\r\n|  i|  i|\r\n+---+---+\r\n+---+---+\r\n\r\n\r\nscala> left.join(right, left(\"i\") === right(\"i\"), \"left_outer\").queryExecution.logical\r\nres14: org.apache.spark.sql.catalyst.plans.logical.LogicalPlan =\r\nJoin LeftOuter, (i#133 = i#137)\r\n:- LocalRelation <empty>, [i#133]\r\n+- LocalRelation [i#137]\r\n\r\nscala> left.join(right, left(\"i\") === right(\"i\"), \"left_outer\").queryExecution.spark\r\nsparkPlan   sparkSession\r\n\r\nscala> left.join(right, left(\"i\") === right(\"i\"), \"left_outer\").queryExecution.sparkPlan\r\nres15: org.apache.spark.sql.execution.SparkPlan =\r\nLocalTableScan <empty>, [i#133, i#137]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834940896/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834944547","html_url":"https://github.com/apache/iceberg/issues/2533#issuecomment-834944547","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2533","id":834944547,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDk0NDU0Nw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T01:40:20Z","updated_at":"2021-05-08T01:40:20Z","author_association":"MEMBER","body":"I think this rule is fixing it for Spark \r\n\r\nhttps://github.com/apache/spark/blob/8f0fef18438aa8fb07f5ed885ffad1339992f102/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/optimizer/joins.scala#L128","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834944547/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834981100","html_url":"https://github.com/apache/iceberg/pull/2560#issuecomment-834981100","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2560","id":834981100,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDk4MTEwMA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T02:30:36Z","updated_at":"2021-05-08T02:30:36Z","author_association":"MEMBER","body":"I would like to invite @aokolnychyi to review this patch !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834981100/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834988857","html_url":"https://github.com/apache/iceberg/issues/2561#issuecomment-834988857","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2561","id":834988857,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDk4ODg1Nw==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T02:40:53Z","updated_at":"2021-05-08T02:40:53Z","author_association":"MEMBER","body":"I think that's because we've changed the page to [here](https://iceberg.apache.org/javadoc/0.11.1/),  would you like to prepare a PR for those broken link ? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/834988857/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835118192","html_url":"https://github.com/apache/iceberg/pull/2566#issuecomment-835118192","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2566","id":835118192,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTExODE5Mg==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T05:42:35Z","updated_at":"2021-05-08T05:42:35Z","author_association":"CONTRIBUTOR","body":"@zhangjun0x01 I am very interested in this PR and the general support of vectorized reader. While working on FLIP-27 Flink source [1], one of the open question is if we should extend from Flink's `FileSourceSplit` and `BulkFormat` for vectorized reader [2]. Now if we are making the effort in Iceberg to support vectorized readers for Orc and Parquet. Then I think we shouldn't need to extend from Flink's vectorized reader.\r\n\r\ncc @openinx \r\n\r\n[1] the uber PR for FLIP-27 Iceberg source that are broken down into smaller PRs: https://github.com/apache/iceberg/pull/2105\r\n[2] PR for the split reader: https://github.com/apache/iceberg/pull/2305 \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835118192/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835140457","html_url":"https://github.com/apache/iceberg/pull/2566#issuecomment-835140457","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2566","id":835140457,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTE0MDQ1Nw==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T06:27:56Z","updated_at":"2021-05-08T06:27:56Z","author_association":"CONTRIBUTOR","body":"@stevenzwu Thanks for your response， could you help me review it ? \r\n@rdblue @openinx ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835140457/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835163660","html_url":"https://github.com/apache/iceberg/pull/2410#issuecomment-835163660","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2410","id":835163660,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTE2MzY2MA==","user":{"login":"dixingxing0","id":1303530,"node_id":"MDQ6VXNlcjEzMDM1MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1303530?v=4","gravatar_id":"","url":"https://api.github.com/users/dixingxing0","html_url":"https://github.com/dixingxing0","followers_url":"https://api.github.com/users/dixingxing0/followers","following_url":"https://api.github.com/users/dixingxing0/following{/other_user}","gists_url":"https://api.github.com/users/dixingxing0/gists{/gist_id}","starred_url":"https://api.github.com/users/dixingxing0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dixingxing0/subscriptions","organizations_url":"https://api.github.com/users/dixingxing0/orgs","repos_url":"https://api.github.com/users/dixingxing0/repos","events_url":"https://api.github.com/users/dixingxing0/events{/privacy}","received_events_url":"https://api.github.com/users/dixingxing0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T07:13:10Z","updated_at":"2021-05-08T07:13:10Z","author_association":"CONTRIBUTOR","body":"Is anyone reviewing this PR, it seems that once this PR is merged it will be the first available version for the CDC stream writing, which will be of great help to iceberg users who want to use the upsert feature, personally i think this PR should be merged before 0.12 release.  @rdblue @stevenzwu @openinx ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835163660/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835165046","html_url":"https://github.com/apache/iceberg/pull/2410#issuecomment-835165046","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2410","id":835165046,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTE2NTA0Ng==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T07:15:58Z","updated_at":"2021-05-08T07:15:58Z","author_association":"CONTRIBUTOR","body":"@dixingxing0 yeah I think this should definitely be a part of 0.12.0 milestone. It's late night at my timezone, I am planning to review tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835165046/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835182253","html_url":"https://github.com/apache/iceberg/issues/2567#issuecomment-835182253","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2567","id":835182253,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTE4MjI1Mw==","user":{"login":"liubo1022126","id":47106533,"node_id":"MDQ6VXNlcjQ3MTA2NTMz","avatar_url":"https://avatars.githubusercontent.com/u/47106533?v=4","gravatar_id":"","url":"https://api.github.com/users/liubo1022126","html_url":"https://github.com/liubo1022126","followers_url":"https://api.github.com/users/liubo1022126/followers","following_url":"https://api.github.com/users/liubo1022126/following{/other_user}","gists_url":"https://api.github.com/users/liubo1022126/gists{/gist_id}","starred_url":"https://api.github.com/users/liubo1022126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liubo1022126/subscriptions","organizations_url":"https://api.github.com/users/liubo1022126/orgs","repos_url":"https://api.github.com/users/liubo1022126/repos","events_url":"https://api.github.com/users/liubo1022126/events{/privacy}","received_events_url":"https://api.github.com/users/liubo1022126/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T07:46:21Z","updated_at":"2021-05-08T07:46:21Z","author_association":"NONE","body":"#2198 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835182253/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835182991","html_url":"https://github.com/apache/iceberg/pull/2410#issuecomment-835182991","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2410","id":835182991,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTE4Mjk5MQ==","user":{"login":"dixingxing0","id":1303530,"node_id":"MDQ6VXNlcjEzMDM1MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1303530?v=4","gravatar_id":"","url":"https://api.github.com/users/dixingxing0","html_url":"https://github.com/dixingxing0","followers_url":"https://api.github.com/users/dixingxing0/followers","following_url":"https://api.github.com/users/dixingxing0/following{/other_user}","gists_url":"https://api.github.com/users/dixingxing0/gists{/gist_id}","starred_url":"https://api.github.com/users/dixingxing0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dixingxing0/subscriptions","organizations_url":"https://api.github.com/users/dixingxing0/orgs","repos_url":"https://api.github.com/users/dixingxing0/repos","events_url":"https://api.github.com/users/dixingxing0/events{/privacy}","received_events_url":"https://api.github.com/users/dixingxing0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T07:47:34Z","updated_at":"2021-05-08T07:47:34Z","author_association":"CONTRIBUTOR","body":"> @dixingxing0 yeah I think this should definitely be a part of 0.12.0 milestone. It's late night at my timezone, I am planning to review tomorrow.\r\n\r\nThanks  @jackye1995, glad to hear that!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835182991/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835636004","html_url":"https://github.com/apache/iceberg/pull/2454#issuecomment-835636004","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2454","id":835636004,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTYzNjAwNA==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-09T02:26:39Z","updated_at":"2021-05-09T02:26:39Z","author_association":"COLLABORATOR","body":"Update the PR to move the filter logic to the visitor consumer. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835636004/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835712604","html_url":"https://github.com/apache/iceberg/issues/2526#issuecomment-835712604","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2526","id":835712604,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTcxMjYwNA==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-09T06:40:58Z","updated_at":"2021-05-09T06:45:32Z","author_association":"COLLABORATOR","body":"Agree, seems affecting the result of describe command.\r\nSent a quick fix for it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835712604/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835714115","html_url":"https://github.com/apache/iceberg/pull/2568#issuecomment-835714115","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2568","id":835714115,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTcxNDExNQ==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-09T06:46:27Z","updated_at":"2021-05-09T06:46:27Z","author_association":"COLLABORATOR","body":"cc @RussellSpitzer and @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835714115/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835734020","html_url":"https://github.com/apache/iceberg/issues/2309#issuecomment-835734020","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2309","id":835734020,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTczNDAyMA==","user":{"login":"somayaj","id":35785881,"node_id":"MDQ6VXNlcjM1Nzg1ODgx","avatar_url":"https://avatars.githubusercontent.com/u/35785881?v=4","gravatar_id":"","url":"https://api.github.com/users/somayaj","html_url":"https://github.com/somayaj","followers_url":"https://api.github.com/users/somayaj/followers","following_url":"https://api.github.com/users/somayaj/following{/other_user}","gists_url":"https://api.github.com/users/somayaj/gists{/gist_id}","starred_url":"https://api.github.com/users/somayaj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/somayaj/subscriptions","organizations_url":"https://api.github.com/users/somayaj/orgs","repos_url":"https://api.github.com/users/somayaj/repos","events_url":"https://api.github.com/users/somayaj/events{/privacy}","received_events_url":"https://api.github.com/users/somayaj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-09T07:57:20Z","updated_at":"2021-05-09T07:57:20Z","author_association":"NONE","body":"Can this be worked?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835734020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835741882","html_url":"https://github.com/apache/iceberg/pull/2568#issuecomment-835741882","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2568","id":835741882,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTc0MTg4Mg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-09T08:23:23Z","updated_at":"2021-05-09T08:23:23Z","author_association":"MEMBER","body":"Looks good to me","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835741882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835852899","html_url":"https://github.com/apache/iceberg/issues/2309#issuecomment-835852899","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2309","id":835852899,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTg1Mjg5OQ==","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-09T17:53:19Z","updated_at":"2021-05-09T17:53:19Z","author_association":"CONTRIBUTOR","body":"Hi @somayaj , the PR #2330 has been merged into the master branch. Please have a try.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835852899/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835905236","html_url":"https://github.com/apache/iceberg/issues/2309#issuecomment-835905236","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2309","id":835905236,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTkwNTIzNg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-09T22:08:45Z","updated_at":"2021-05-09T22:08:45Z","author_association":"CONTRIBUTOR","body":"Closing this one as it has been fixed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835905236/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835991435","html_url":"https://github.com/apache/iceberg/pull/2566#issuecomment-835991435","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2566","id":835991435,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTk5MTQzNQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T00:50:31Z","updated_at":"2021-05-10T00:50:31Z","author_association":"MEMBER","body":"Thanks for the work,  I will take a look today. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/835991435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836046219","html_url":"https://github.com/apache/iceberg/pull/2570#issuecomment-836046219","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2570","id":836046219,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjA0NjIxOQ==","user":{"login":"XuQianJin-Stars","id":10494131,"node_id":"MDQ6VXNlcjEwNDk0MTMx","avatar_url":"https://avatars.githubusercontent.com/u/10494131?v=4","gravatar_id":"","url":"https://api.github.com/users/XuQianJin-Stars","html_url":"https://github.com/XuQianJin-Stars","followers_url":"https://api.github.com/users/XuQianJin-Stars/followers","following_url":"https://api.github.com/users/XuQianJin-Stars/following{/other_user}","gists_url":"https://api.github.com/users/XuQianJin-Stars/gists{/gist_id}","starred_url":"https://api.github.com/users/XuQianJin-Stars/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XuQianJin-Stars/subscriptions","organizations_url":"https://api.github.com/users/XuQianJin-Stars/orgs","repos_url":"https://api.github.com/users/XuQianJin-Stars/repos","events_url":"https://api.github.com/users/XuQianJin-Stars/events{/privacy}","received_events_url":"https://api.github.com/users/XuQianJin-Stars/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T01:30:54Z","updated_at":"2021-05-10T01:30:54Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836046219/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836055150","html_url":"https://github.com/apache/iceberg/issues/2571#issuecomment-836055150","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2571","id":836055150,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjA1NTE1MA==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T01:46:12Z","updated_at":"2021-05-10T01:46:12Z","author_association":"COLLABORATOR","body":"Did you write positional delete as well? From the code path, it looks like the `posDeletes` is not equal to null.  The `fileProjection` only project `_pos` when `posDeletes` is not empty.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836055150/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836140966","html_url":"https://github.com/apache/iceberg/issues/2561#issuecomment-836140966","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2561","id":836140966,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjE0MDk2Ng==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T04:08:01Z","updated_at":"2021-05-10T04:08:10Z","author_association":"MEMBER","body":"Okay,  I think I misunderstood the javadoc issue,  the iceberg master branch haven't updated the [javadoc](FlinkSource#Builder) since 2 years ago, so we could not see the correct  `FlinkSource#Builder`.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836140966/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836141548","html_url":"https://github.com/apache/iceberg/issues/2561#issuecomment-836141548","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2561","id":836141548,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjE0MTU0OA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T04:09:02Z","updated_at":"2021-05-10T04:09:02Z","author_association":"MEMBER","body":"Linked to this [issue](https://github.com/apache/iceberg/issues/2446).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836141548/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836142079","html_url":"https://github.com/apache/iceberg/pull/2573#issuecomment-836142079","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2573","id":836142079,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjE0MjA3OQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T04:09:59Z","updated_at":"2021-05-10T04:09:59Z","author_association":"MEMBER","body":"Close this via https://github.com/apache/iceberg/issues/2561#issuecomment-836140966","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836142079/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836254599","html_url":"https://github.com/apache/iceberg/pull/2556#issuecomment-836254599","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2556","id":836254599,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjI1NDU5OQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T06:46:44Z","updated_at":"2021-05-10T06:46:44Z","author_association":"MEMBER","body":"Looks like we are encountering the flaky unit test. Let's retry the travis ci !\r\n\r\n```\r\norg.apache.iceberg.flink.TestFlinkTableSink > testHashDistributeMode[catalogName=testhive, baseNamespace=, format=AVRO, isStreaming=true] FAILED\r\n    java.lang.AssertionError: There should be only 1 data file in partition 'aaa' expected:<1> but was:<2>\r\n        at org.junit.Assert.fail(Assert.java:88)\r\n        at org.junit.Assert.failNotEquals(Assert.java:834)\r\n        at org.junit.Assert.assertEquals(Assert.java:645)\r\n        at org.apache.iceberg.flink.TestFlinkTableSink.testHashDistributeMode(TestFlinkTableSink.java:274)\r\n\r\n    org.apache.flink.table.api.ValidationException: Could not execute DROP DATABASE IF EXISTS  testhive.db RESTRICT\r\n        at org.apache.flink.table.api.internal.TableEnvironmentImpl.executeOperation(TableEnvironmentImpl.java:989)\r\n        at org.apache.flink.table.api.internal.TableEnvironmentImpl.executeSql(TableEnvironmentImpl.java:666)\r\n        at org.apache.iceberg.flink.FlinkTestBase.exec(FlinkTestBase.java:91)\r\n        at org.apache.iceberg.flink.FlinkTestBase.exec(FlinkTestBase.java:95)\r\n        at org.apache.iceberg.flink.FlinkTestBase.sql(FlinkTestBase.java:99)\r\n        at org.apache.iceberg.flink.TestFlinkTableSink.clean(TestFlinkTableSink.java:126)\r\n\r\n        Caused by:\r\n        org.apache.flink.table.catalog.exceptions.DatabaseNotEmptyException: Database db in catalog testhive is not empty.\r\n            at org.apache.iceberg.flink.FlinkCatalog.dropDatabase(FlinkCatalog.java:240)\r\n            at org.apache.flink.table.api.internal.TableEnvironmentImpl.executeOperation(TableEnvironmentImpl.java:983)\r\n            ... 5 more\r\n\r\n            Caused by:\r\n            org.apache.iceberg.exceptions.NamespaceNotEmptyException: Namespace db is not empty. One or more tables exist.\r\n                at org.apache.iceberg.hive.HiveCatalog.dropNamespace(HiveCatalog.java:307)\r\n                at org.apache.iceberg.flink.FlinkCatalog.dropDatabase(FlinkCatalog.java:231)\r\n                ... 6 more\r\n\r\n                Caused by:\r\n                InvalidOperationException(message:Database db is not empty. One or more tables exist.)\r\n                    at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$drop_database_result$drop_database_resultStandardScheme.read(ThriftHiveMetastore.java:28714)\r\n                    at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$drop_database_result$drop_database_resultStandardScheme.read(ThriftHiveMetastore.java:28691)\r\n                    at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$drop_database_result.read(ThriftHiveMetastore.java:28625)\r\n                    at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:86)\r\n                    at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.recv_drop_database(ThriftHiveMetastore.java:813)\r\n                    at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.drop_database(ThriftHiveMetastore.java:798)\r\n                    at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:868)\r\n                    at org.apache.iceberg.hive.HiveCatalog.lambda$dropNamespace$9(HiveCatalog.java:296)\r\n                    at org.apache.iceberg.ClientPoolImpl.run(ClientPoolImpl.java:51)\r\n                    at org.apache.iceberg.hive.CachedClientPool.run(CachedClientPool.java:77)\r\n                    at org.apache.iceberg.hive.HiveCatalog.dropNamespace(HiveCatalog.java:295)\r\n                    ... 7 more\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836254599/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836450994","html_url":"https://github.com/apache/iceberg/pull/2547#issuecomment-836450994","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2547","id":836450994,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjQ1MDk5NA==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T09:18:46Z","updated_at":"2021-05-10T09:18:46Z","author_association":"COLLABORATOR","body":"Thanks everyone for the reviews and @aokolnychyi for the merge!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836450994/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836582964","html_url":"https://github.com/apache/iceberg/pull/2550#issuecomment-836582964","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2550","id":836582964,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjU4Mjk2NA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T11:31:03Z","updated_at":"2021-05-10T11:31:03Z","author_association":"CONTRIBUTOR","body":"@boroknagyz: Could you please port this change to the Hive repo as well?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836582964/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836603671","html_url":"https://github.com/apache/iceberg/issues/2554#issuecomment-836603671","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2554","id":836603671,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjYwMzY3MQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T11:53:55Z","updated_at":"2021-05-10T11:53:55Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer: How likely is this situation based on your experience?\r\n\r\nIn Hive we faced similar situation a few times before, for example:\r\n- Dropping the table and failing to remove the files\r\n \r\nSadly we still do not have a way in Hive to return a warning message along with reporting the success of the drop table operation. What we did in these cases:\r\n- Log a warn message in the logs, and silently (for the user) drop the metadata and skip the file removal.\r\n\r\nThis looks like the same solution suggested by @marton-bod, and I think it is much easier to recover from a problem if we follow this way. It is easier to drop the remaining data from the Iceberg table later, than recreating the appropriate files just so the metadata could be deleted as well.\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836603671/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836617396","html_url":"https://github.com/apache/iceberg/issues/2554#issuecomment-836617396","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2554","id":836617396,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjYxNzM5Ng==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T12:08:08Z","updated_at":"2021-05-10T13:19:25Z","author_association":"MEMBER","body":"So far this has never cropped up intentionally, but I had a user who saw the hive.engine.enabled property and set it on a large number of multiuser tables. \r\n\r\nThis caused a bit of havoc. The deletion issue then happened first as they were used to standard hive tables and removed the data files from some tables before the dropping them from the catalog.\r\n\r\nThe next issue we kept hitting is that there were no iceberg jars on the hive class-path which is a problem because you can always set the storage handler, but once set, you can't remove the property without the jars on the class-path","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836617396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836618503","html_url":"https://github.com/apache/iceberg/issues/2554#issuecomment-836618503","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2554","id":836618503,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjYxODUwMw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T12:09:18Z","updated_at":"2021-05-10T12:09:18Z","author_association":"MEMBER","body":"So for now it's 1/1 with users who set this property 😊. They were setting up a framework for tons of other users and use cases so they created a lot of entities","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836618503/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836648885","html_url":"https://github.com/apache/iceberg/pull/2565#issuecomment-836648885","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2565","id":836648885,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjY0ODg4NQ==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T12:41:04Z","updated_at":"2021-05-10T12:41:04Z","author_association":"COLLABORATOR","body":"Thanks @jackye1995 for this, a few comments. \r\nAlso, shouldn't we include the hive docs change (re. catalog loading) in this PR too to keep them in lockstep?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836648885/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836682523","html_url":"https://github.com/apache/iceberg/issues/2554#issuecomment-836682523","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2554","id":836682523,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjY4MjUyMw==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T13:12:06Z","updated_at":"2021-05-10T13:12:47Z","author_association":"COLLABORATOR","body":"We do have the post-drop hook available though to convey information to the user after-the-fact, so for example we can throw an exception to draw the user's attention to this anomaly, despite the success of the core DROP operation. \r\n\r\nSo, I see two options:\r\n\r\n- we try to load the Iceberg table in the pre-drop hook, save in a boolean whether it succeeded, DROP the table as per Hive, and if the load failed earlier then throw a descriptive exception in the post-drop hook explaining what happened (i.e. the drop succeeded, but there was this anomaly, so please look into it, there might metadata files undeleted which might need manual intervention, etc.)\r\n- we try to load the Iceberg table in the pre-drop hook, log a descriptive error msg if it fails, DROP the table as per Hive, nothing else (i.e. what I described a couple days ago)\r\n\r\nI would prefer the first one, since I think it's more explicit (the drawback is that it fails the operation from a return code point of view, but not from a functional pov). The second one is silent and we can't expect the user to inspect the logs after each DROP operation looking for warning signs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836682523/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836762324","html_url":"https://github.com/apache/iceberg/issues/2554#issuecomment-836762324","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2554","id":836762324,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjc2MjMyNA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T14:22:23Z","updated_at":"2021-05-10T14:22:36Z","author_association":"CONTRIBUTOR","body":"@marton-bod: I would prefer your first suggestion:\r\n- Log a warn message\r\n- `DROP TABLE` should be successful\r\n\r\nThere are automatic clients who might expect the table to remain if the `DROP TABLE` command is not successful. This could be confusing. We either do not drop a table metadata and return an error, or drop the table metadata and return successfully. At least that was the reasoning behind our decision in the aforementioned case.\r\n\r\n> The next issue we kept hitting is that there were no iceberg jars on the hive class-path which is a problem because you can always set the storage handler, but once set, you can't remove the property without the jars on the class-path\r\n\r\nThis is another story might worth another issue, if we are not able to drop the table even from Spark, or Java clients","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836762324/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836785417","html_url":"https://github.com/apache/iceberg/issues/2554#issuecomment-836785417","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2554","id":836785417,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjc4NTQxNw==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T14:42:30Z","updated_at":"2021-05-10T14:42:30Z","author_association":"COLLABORATOR","body":"> .. who might expect the table to remain if the DROP TABLE command is not successful\r\n\r\nThis is a good point! Let's go with the first idea then - I'll put together a PR soon.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836785417/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836811760","html_url":"https://github.com/apache/iceberg/issues/2481#issuecomment-836811760","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2481","id":836811760,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjgxMTc2MA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T15:04:35Z","updated_at":"2021-05-10T15:04:35Z","author_association":"CONTRIBUTOR","body":"We were considering enhancing HiveCatalog to point to a specific snapshot of an Iceberg table.\r\nThis could be useful if we want to share a specific version of the table but still want to continue adding more data to the table, but a snapshot table might also solve this problem.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836811760/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836811980","html_url":"https://github.com/apache/iceberg/issues/2554#issuecomment-836811980","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2554","id":836811980,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjgxMTk4MA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T15:04:46Z","updated_at":"2021-05-10T15:04:46Z","author_association":"MEMBER","body":"Made #2578 for the engine enabled issue no jars on CP @pvary, Thanks ya'll for helping out with this","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836811980/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836816786","html_url":"https://github.com/apache/iceberg/issues/2576#issuecomment-836816786","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2576","id":836816786,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjgxNjc4Ng==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T15:08:44Z","updated_at":"2021-05-10T15:08:44Z","author_association":"MEMBER","body":"Copying @marton-bod 's Email from the Dev Mailing list for future lookup\r\n\r\n> \r\n> Hi,\r\n> \r\n> Thanks for reaching out! Unfortunately insert overwrite commands are not currently supported by the Hive engine in upstream Iceberg, since it's a feature difficult to implement without touching the Hive codebase as well. Currently we only have support for regular insert queries (using the mr engine, not tez).\r\n> \r\n> We have recently created a new module in upstream Hive called \"hive-iceberg-handler\", which is supposed to be an alternative over time to using the iceberg-hive-runtime jar, providing an extended feature set and performance improvements. Support for insert overwrites has already been implemented there. Please note the module is still experimental and some of these newer features would require you to run Hive from the master branch due to core Hive API changes, but it might be a good candidate for experimentation. Here's the link for the module if you'd like to check out our ongoing work: https://github.com/apache/hive/tree/master/iceberg/iceberg-handler\r\n> \r\n> As for the specific error message you're getting, it's because the HMS by design sees the Iceberg table as unpartitioned (to enable flexible partitioning down the line and due to how the Hive query planner works), even though the underlying Iceberg table is actually partitioned - hence the upstream error during the compilation phase.\r\n> \r\n> Best,\r\n> Marton","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836816786/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836837836","html_url":"https://github.com/apache/iceberg/issues/2572#issuecomment-836837836","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2572","id":836837836,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjgzNzgzNg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T15:26:23Z","updated_at":"2021-05-10T15:26:23Z","author_association":"MEMBER","body":"Looks reasonable to me, how does the database work in this situation? Is there just a default database for each catalog?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836837836/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836841955","html_url":"https://github.com/apache/iceberg/pull/2568#issuecomment-836841955","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2568","id":836841955,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjg0MTk1NQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T15:29:55Z","updated_at":"2021-05-10T15:29:55Z","author_association":"MEMBER","body":"Thanks @jun-he !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836841955/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836847031","html_url":"https://github.com/apache/iceberg/issues/2567#issuecomment-836847031","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2567","id":836847031,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjg0NzAzMQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T15:34:05Z","updated_at":"2021-05-10T15:34:05Z","author_association":"CONTRIBUTOR","body":"@liubo1022126: To be honest, I am a bit confused. Did @dixingxing0 solution worked for you?\r\nWhen @dixingxing0 closed #2198 I was not sure how he fixed it, and I assumed that it was somewhere in his own code. If not then we might want to find a general solution.\r\n\r\n@dixingxing0: Could you please help us out here?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836847031/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836894262","html_url":"https://github.com/apache/iceberg/issues/2578#issuecomment-836894262","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2578","id":836894262,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjg5NDI2Mg==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T16:07:36Z","updated_at":"2021-05-10T16:07:36Z","author_association":"CONTRIBUTOR","body":"The root cause is that even `HiveMetastoreClient.getTable()` tries to instantiate the defined storageHandler, and if that fails then an exception is thrown.\r\nMaybe some fix on HMSClient side?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/836894262/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837013251","html_url":"https://github.com/apache/iceberg/pull/2565#issuecomment-837013251","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2565","id":837013251,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzAxMzI1MQ==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T17:31:37Z","updated_at":"2021-05-10T17:31:37Z","author_association":"CONTRIBUTOR","body":"> shouldn't we include the hive docs change (re. catalog loading) in this PR too to keep them in lockstep?\r\n\r\n@marton-bod depending on which one gets merged first, I will make change in the other PR accordingly.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837013251/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837212607","html_url":"https://github.com/apache/iceberg/pull/2512#issuecomment-837212607","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2512","id":837212607,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzIxMjYwNw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T19:38:15Z","updated_at":"2021-05-10T19:38:15Z","author_association":"MEMBER","body":"@wypoon + @rdblue  Wrote up a little example about we can do a similar multi-test version here\r\nhttps://github.com/RussellSpitzer/iceberg/commit/7ee33d90cb3299fb90c7dd4707e16078eee89904\r\n\r\nBasically what we do in this example is have 2 test tasks\r\nThe default which uses 3.0.2\r\nAnd testSpark31 which uses 3.1\r\n\r\nIn both cases the test code itself is compiled against the respective Spark version but the library code is always based on the 3.0.2 code. So basically we make sure our library classes work regardless of which Spark version you use them with. I only implemented the Spark3 config for this but we could duplicate it for Extensions and Integration tests pretty easily. Let me know what you think.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837212607/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837260122","html_url":"https://github.com/apache/iceberg/pull/2512#issuecomment-837260122","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2512","id":837260122,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzI2MDEyMg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T20:10:11Z","updated_at":"2021-05-10T20:10:11Z","author_association":"MEMBER","body":"Added another commit https://github.com/RussellSpitzer/iceberg/tree/spark3_1_RussDualConfigTest \r\n\r\nTo add test suites to the rest of the modules I think thats most of it, but I may have screwed up something with the \"sql\" command. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837260122/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837305770","html_url":"https://github.com/apache/iceberg/pull/2257#issuecomment-837305770","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2257","id":837305770,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzMwNTc3MA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T20:40:44Z","updated_at":"2021-05-10T20:40:44Z","author_association":"MEMBER","body":"Looks good to me, @aokolnychyi Were you 👍 ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837305770/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837326826","html_url":"https://github.com/apache/iceberg/pull/2564#issuecomment-837326826","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2564","id":837326826,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzMyNjgyNg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T20:55:11Z","updated_at":"2021-05-10T20:55:11Z","author_association":"CONTRIBUTOR","body":"Sorry for the delay @karuppayya, let me take a look now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837326826/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837341889","html_url":"https://github.com/apache/iceberg/pull/2574#issuecomment-837341889","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2574","id":837341889,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzM0MTg4OQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T21:05:54Z","updated_at":"2021-05-10T21:05:54Z","author_association":"MEMBER","body":"@aokolnychyi + @rdblue I haven't done a release so one of you should probably check it too :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837341889/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837394219","html_url":"https://github.com/apache/iceberg/issues/2562#issuecomment-837394219","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2562","id":837394219,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzM5NDIxOQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T21:44:32Z","updated_at":"2021-05-10T21:44:32Z","author_association":"MEMBER","body":"Do you have a reproducible benchmark? That would be helpful but I try not to guess on root causes of performance differences without benchmarks and instrumented code. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837394219/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837459076","html_url":"https://github.com/apache/iceberg/issues/2481#issuecomment-837459076","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2481","id":837459076,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzQ1OTA3Ng==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T22:54:42Z","updated_at":"2021-05-10T22:54:42Z","author_association":"COLLABORATOR","body":"Yea , snapshotting an Iceberg table would be a great usability feature for sharing a certain snapshot of a table to others.\r\n\r\nThe stageOnly() API probably works for this but is not well known, and hard to expose through Spark/Hive to be shareable to other users.\r\n\r\nOne risk would be a user running snapshot on an Iceberg table, then dropping it thinking they are only dropping the snapshot.  \r\n If I'm not mistaken, dropping the table through the Sparkcatalog (purge=true) will drop all the current data of the original table (a general problem of the snapshot command).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837459076/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837547761","html_url":"https://github.com/apache/iceberg/pull/2556#issuecomment-837547761","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2556","id":837547761,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzU0Nzc2MQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T00:28:00Z","updated_at":"2021-05-11T00:28:00Z","author_association":"MEMBER","body":"Looks good to me now.  I will get this merged !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837547761/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837554970","html_url":"https://github.com/apache/iceberg/issues/2580#issuecomment-837554970","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2580","id":837554970,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzU1NDk3MA==","user":{"login":"indranildey-sfdc","id":65305061,"node_id":"MDQ6VXNlcjY1MzA1MDYx","avatar_url":"https://avatars.githubusercontent.com/u/65305061?v=4","gravatar_id":"","url":"https://api.github.com/users/indranildey-sfdc","html_url":"https://github.com/indranildey-sfdc","followers_url":"https://api.github.com/users/indranildey-sfdc/followers","following_url":"https://api.github.com/users/indranildey-sfdc/following{/other_user}","gists_url":"https://api.github.com/users/indranildey-sfdc/gists{/gist_id}","starred_url":"https://api.github.com/users/indranildey-sfdc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/indranildey-sfdc/subscriptions","organizations_url":"https://api.github.com/users/indranildey-sfdc/orgs","repos_url":"https://api.github.com/users/indranildey-sfdc/repos","events_url":"https://api.github.com/users/indranildey-sfdc/events{/privacy}","received_events_url":"https://api.github.com/users/indranildey-sfdc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T00:35:30Z","updated_at":"2021-05-11T00:35:30Z","author_association":"NONE","body":"Besically `SchemaToType` class should be \r\n\r\n- Public\r\n- It should have protected Constructor \r\n- `Schema root` should protected final\r\n- `int nextId` should be protected.\r\n\r\nThese only allow us to override the `record` method in the Iceberg.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837554970/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837570620","html_url":"https://github.com/apache/iceberg/pull/2512#issuecomment-837570620","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2512","id":837570620,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzU3MDYyMA==","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T00:51:28Z","updated_at":"2021-05-11T00:51:28Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer thanks for providing the example! Let me try it out.\r\nI can handle the java/scala changes, but the gradle changes are a struggle for me!\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837570620/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837600382","html_url":"https://github.com/apache/iceberg/pull/2512#issuecomment-837600382","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2512","id":837600382,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzYwMDM4Mg==","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T01:24:45Z","updated_at":"2021-05-11T01:24:45Z","author_association":"CONTRIBUTOR","body":"I pushed the code-side changes for now. I'll follow up with the build-side changes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837600382/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837659408","html_url":"https://github.com/apache/iceberg/issues/2567#issuecomment-837659408","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2567","id":837659408,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzY1OTQwOA==","user":{"login":"dixingxing0","id":1303530,"node_id":"MDQ6VXNlcjEzMDM1MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1303530?v=4","gravatar_id":"","url":"https://api.github.com/users/dixingxing0","html_url":"https://github.com/dixingxing0","followers_url":"https://api.github.com/users/dixingxing0/followers","following_url":"https://api.github.com/users/dixingxing0/following{/other_user}","gists_url":"https://api.github.com/users/dixingxing0/gists{/gist_id}","starred_url":"https://api.github.com/users/dixingxing0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dixingxing0/subscriptions","organizations_url":"https://api.github.com/users/dixingxing0/orgs","repos_url":"https://api.github.com/users/dixingxing0/repos","events_url":"https://api.github.com/users/dixingxing0/events{/privacy}","received_events_url":"https://api.github.com/users/dixingxing0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T02:23:27Z","updated_at":"2021-05-11T02:23:27Z","author_association":"CONTRIBUTOR","body":"Hi @pvary, as i described in #2198, this exception occurred in the `initializeMapOperator` phase, and `HiveIcebergSerDe` will not be used to deserialize data of hive table, so i just caught the exception in `IcebergRecordObjectInspector#getStructFieldRef` and returned a dummy struct field, i'll submit a PR to show how it works.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837659408/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837659767","html_url":"https://github.com/apache/iceberg/issues/2576#issuecomment-837659767","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2576","id":837659767,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzY1OTc2Nw==","user":{"login":"zhangbutao","id":9760681,"node_id":"MDQ6VXNlcjk3NjA2ODE=","avatar_url":"https://avatars.githubusercontent.com/u/9760681?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangbutao","html_url":"https://github.com/zhangbutao","followers_url":"https://api.github.com/users/zhangbutao/followers","following_url":"https://api.github.com/users/zhangbutao/following{/other_user}","gists_url":"https://api.github.com/users/zhangbutao/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangbutao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangbutao/subscriptions","organizations_url":"https://api.github.com/users/zhangbutao/orgs","repos_url":"https://api.github.com/users/zhangbutao/repos","events_url":"https://api.github.com/users/zhangbutao/events{/privacy}","received_events_url":"https://api.github.com/users/zhangbutao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T02:23:48Z","updated_at":"2021-05-11T02:24:20Z","author_association":"CONTRIBUTOR","body":"Hi @RussellSpitzer @marton-bod . I have test \"Hive-iceberg-handler\" module of  Hive master branch. Here are the test steps:\r\n1, **Create the ice table using hive beelin:**\r\n  CREATE EXTERNAL TABLE ice_tbl (i int) STORED BY 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler';\r\n2, **Make a insert DDL:**\r\n  set hive.execution.engine=mr;\r\n  insert overwrite table ice_tbl values(1);\r\n3,**Make a select statement of ice_tbl, but found no data:**\r\n__0: jdbc:hive2://hivenode:10000> select * from ice_tbl;\r\n\r\n```\r\nINFO  : Compiling command(queryId=hive_20210511100644_a0676d7a-11ac-4c69-8b03-ee081ec33f70): select * from ice_tbl\r\nINFO  : No Stats for default@ice_tbl, Columns: i\r\nINFO  : Semantic Analysis Completed (retrial = false)\r\nINFO  : Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:ice_tbl.i, type:int, comment:null)], properties:null)\r\nINFO  : Completed compiling command(queryId=hive_20210511100644_a0676d7a-11ac-4c69-8b03-ee081ec33f70); Time taken: 0.28 seconds\r\nINFO  : Concurrency mode is disabled, not creating a lock manager\r\nINFO  : Executing command(queryId=hive_20210511100644_a0676d7a-11ac-4c69-8b03-ee081ec33f70): select * from ice_tbl\r\nINFO  : Completed executing command(queryId=hive_20210511100644_a0676d7a-11ac-4c69-8b03-ee081ec33f70); Time taken: 0.0 seconds\r\n+------------+\r\n| ice_tbl.i  |\r\n+------------+\r\n+------------+\r\nNo rows selected (0.36 seconds)__\r\n\r\n```\r\n\r\nSo, Why is no data returned?  Am I missing some hive_iceberg configuration?  \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837659767/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837665198","html_url":"https://github.com/apache/iceberg/issues/2576#issuecomment-837665198","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2576","id":837665198,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzY2NTE5OA==","user":{"login":"zhangbutao","id":9760681,"node_id":"MDQ6VXNlcjk3NjA2ODE=","avatar_url":"https://avatars.githubusercontent.com/u/9760681?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangbutao","html_url":"https://github.com/zhangbutao","followers_url":"https://api.github.com/users/zhangbutao/followers","following_url":"https://api.github.com/users/zhangbutao/following{/other_user}","gists_url":"https://api.github.com/users/zhangbutao/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangbutao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangbutao/subscriptions","organizations_url":"https://api.github.com/users/zhangbutao/orgs","repos_url":"https://api.github.com/users/zhangbutao/repos","events_url":"https://api.github.com/users/zhangbutao/events{/privacy}","received_events_url":"https://api.github.com/users/zhangbutao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T02:28:46Z","updated_at":"2021-05-11T02:28:46Z","author_association":"CONTRIBUTOR","body":"Here append ice_tbl table structure:\r\n\r\n```\r\n0: jdbc:hive2://hivenode:10000> show create table ice_tbl;\r\n+----------------------------------------------------+\r\n|                   createtab_stmt                   |\r\n+----------------------------------------------------+\r\n| CREATE EXTERNAL TABLE `ice_tbl`(                   |\r\n|   `i` int COMMENT 'from deserializer')             |\r\n| ROW FORMAT SERDE                                   |\r\n|   'org.apache.iceberg.mr.hive.HiveIcebergSerDe'    |\r\n| STORED BY                                          |\r\n|   'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'  |\r\n|                                                    |\r\n| LOCATION                                           |\r\n|   'hdfs://XXX/user/hive/warehouse/hiveice/ice_tbl' |\r\n| TBLPROPERTIES (                                    |\r\n|   'bucketing_version'='2',                         |\r\n|   'engine.hive.enabled'='true',                    |\r\n|   'external.table.purge'='TRUE',                   |\r\n|   'last_modified_by'='hive',                       |\r\n|   'last_modified_time'='1620698724',               |\r\n|   'metadata_location'='hdfs://XXX/user/hive/warehouse/hiveice/ice_tbl/metadata/00001-f664af14-126c-4e5e-9e3f-3b7fa356ff48.metadata.json',  |\r\n|   'previous_metadata_location'='hdfs://XXX/user/hive/warehouse/hiveice/ice_tbl/metadata/00000-33a14d2d-ec8b-4e6c-87df-c87fac954e9e.metadata.json',  |\r\n|   'table_type'='ICEBERG',                          |\r\n|   'transient_lastDdlTime'='1620698724')            |\r\n+----------------------------------------------------+\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837665198/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837702516","html_url":"https://github.com/apache/iceberg/pull/2560#issuecomment-837702516","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2560","id":837702516,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzcwMjUxNg==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T03:05:51Z","updated_at":"2021-05-11T03:05:51Z","author_association":"CONTRIBUTOR","body":"@yyanyy I changed to use `SET` and `UNSET` instead of `REPLACE` and `DROP`, please see it that feels better, thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837702516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837846615","html_url":"https://github.com/apache/iceberg/issues/1914#issuecomment-837846615","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1914","id":837846615,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzg0NjYxNQ==","user":{"login":"huadongliu","id":2797280,"node_id":"MDQ6VXNlcjI3OTcyODA=","avatar_url":"https://avatars.githubusercontent.com/u/2797280?v=4","gravatar_id":"","url":"https://api.github.com/users/huadongliu","html_url":"https://github.com/huadongliu","followers_url":"https://api.github.com/users/huadongliu/followers","following_url":"https://api.github.com/users/huadongliu/following{/other_user}","gists_url":"https://api.github.com/users/huadongliu/gists{/gist_id}","starred_url":"https://api.github.com/users/huadongliu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huadongliu/subscriptions","organizations_url":"https://api.github.com/users/huadongliu/orgs","repos_url":"https://api.github.com/users/huadongliu/repos","events_url":"https://api.github.com/users/huadongliu/events{/privacy}","received_events_url":"https://api.github.com/users/huadongliu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T05:28:54Z","updated_at":"2021-05-11T05:28:54Z","author_association":"NONE","body":"I saw the same Spark error when loading a table with a timestamp column created by the Java API. It is expected by https://iceberg.apache.org/spark-writes/#iceberg-type-to-spark-type.\r\n\r\nI was able to workaround it by `s/timestamp/timestamptz` in the schema section of the json snapshot file. Surprisingly, Spark still shows UTC timestamps while my local timezone is GMT-7. The parquet files have UTC timestamps.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/837846615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/838004158","html_url":"https://github.com/apache/iceberg/issues/2576#issuecomment-838004158","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2576","id":838004158,"node_id":"MDEyOklzc3VlQ29tbWVudDgzODAwNDE1OA==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T07:42:02Z","updated_at":"2021-05-11T07:42:02Z","author_association":"COLLABORATOR","body":"@butaozhang Thanks for getting back to us. All the features developed in the `hive-iceberg-handler` module are tested only with the Tez execution engine, since MR has been officially deprecated for Hive4, so we're focusing only on Tez. (It's the opposite situation from the iceberg-hive-runtime, where only MR writes are currently working due to limitations of the Tez/Hive versions depended on by Iceberg). Can you please retry with Tez? Otherwise your setup seems correct. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/838004158/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/838045977","html_url":"https://github.com/apache/iceberg/issues/2576#issuecomment-838045977","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2576","id":838045977,"node_id":"MDEyOklzc3VlQ29tbWVudDgzODA0NTk3Nw==","user":{"login":"zhangbutao","id":9760681,"node_id":"MDQ6VXNlcjk3NjA2ODE=","avatar_url":"https://avatars.githubusercontent.com/u/9760681?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangbutao","html_url":"https://github.com/zhangbutao","followers_url":"https://api.github.com/users/zhangbutao/followers","following_url":"https://api.github.com/users/zhangbutao/following{/other_user}","gists_url":"https://api.github.com/users/zhangbutao/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangbutao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangbutao/subscriptions","organizations_url":"https://api.github.com/users/zhangbutao/orgs","repos_url":"https://api.github.com/users/zhangbutao/repos","events_url":"https://api.github.com/users/zhangbutao/events{/privacy}","received_events_url":"https://api.github.com/users/zhangbutao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T08:14:07Z","updated_at":"2021-05-11T08:14:07Z","author_association":"CONTRIBUTOR","body":"@marton-bod Thanks for giving guidance. I test and it works!  Here is the correct config:\r\n```\r\nset hive.vectorized.execution.enabled=false;\r\nset hive.execution.engine=tez;\r\n```\r\n\r\nBy the way, can SparkSQL(version3.0)  read hive_Ice tables? I try to add jar hive-iceberg-handler-4.0.0-SNAPSHOT.jar to sparkSQL classpath and make ddl query of the hive_ice table, but didn't succeed. Error like the following:\r\n```\r\n./spark-sql --jars /data/hive-iceberg-handler-4.0.0-SNAPSHOT.jar\r\n\r\nspark-sql> select * from ice_tbl;\r\n21/05/11 16:03:37 ERROR thriftserver.SparkSQLDriver: Failed in [select * from ice_tbl]\r\njava.lang.ExceptionInInitializerError\r\n        at org.apache.iceberg.mr.hive.HiveIcebergSerDe.initialize(HiveIcebergSerDe.java:135)\r\n        at org.apache.hadoop.hive.serde2.SerDeUtils.initializeSerDe(SerDeUtils.java:533)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreUtils.getDeserializer(MetaStoreUtils.java:450)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreUtils.getDeserializer(MetaStoreUtils.java:437)\r\n        at org.apache.hadoop.hive.ql.metadata.Table.getDeserializerFromMetaStore(Table.java:281)\r\n        at org.apache.hadoop.hive.ql.metadata.Table.getDeserializer(Table.java:263)\r\n        at org.apache.hadoop.hive.ql.metadata.Table.getColsInternal(Table.java:641)\r\n        at org.apache.hadoop.hive.ql.metadata.Table.getCols(Table.java:624)\r\n        at org.apache.spark.sql.hive.client.HiveClientImpl.liftedTree2$1(HiveClientImpl.scala:431)\r\n        at org.apache.spark.sql.hive.client.HiveClientImpl.convertHiveTableToCatalogTable(HiveClientImpl.scala:430)\r\n        at org.apache.spark.sql.hive.client.HiveClientImpl.$anonfun$getTableOption$3(HiveClientImpl.scala:424)\r\n        at scala.Option.map(Option.scala:230)\r\n\r\n        Caused by: java.lang.RuntimeException: Cannot find method: get\r\n        at org.apache.iceberg.common.DynMethods$Builder.build(DynMethods.java:454)\r\n        at org.apache.iceberg.common.DynMethods$Builder.buildStatic(DynMethods.java:522)\r\n        at org.apache.iceberg.mr.hive.serde.objectinspector.IcebergObjectInspector.<clinit>(IcebergObjectInspector.java:46)\r\n        ... 111 more\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/838045977/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/838908582","html_url":"https://github.com/apache/iceberg/pull/2257#issuecomment-838908582","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2257","id":838908582,"node_id":"MDEyOklzc3VlQ29tbWVudDgzODkwODU4Mg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T17:53:13Z","updated_at":"2021-05-11T17:53:13Z","author_association":"CONTRIBUTOR","body":"Sorry for the delay, let me take a look once I get out of meetings.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/838908582/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/838946848","html_url":"https://github.com/apache/iceberg/pull/2512#issuecomment-838946848","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2512","id":838946848,"node_id":"MDEyOklzc3VlQ29tbWVudDgzODk0Njg0OA==","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T18:20:00Z","updated_at":"2021-05-11T18:20:00Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer I tried out your build.gradle. Unfortunately, it appears that an Iceberg Spark3 runtime jar built against Spark 3.0 does not completely work with Spark 3.1. The integration test, `SmokeTest` fails in `testGettingStarted` when running a `MERGE INTO`, due to incompatible signatures in the Spark case class `Alias`:\r\n```\r\njava.lang.NoSuchMethodError: org.apache.spark.sql.catalyst.expressions.Alias.<init>(Lorg/apache/spark/sql/catalyst/expressions/Expression;Ljava/lang/String;Lorg/apache/spark/sql/catalyst/expressions/ExprId;Lscala/collection/Seq;Lscala/Option;)V\r\n\tat org.apache.spark.sql.catalyst.optimizer.RewriteMergeInto$$anonfun$apply$1.applyOrElse(RewriteMergeInto.scala:156)\r\n```\r\nThis is because the case class added an additional parameter in 3.1 vs 3.0:\r\nhttps://github.com/apache/spark/blob/branch-3.0/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/expressions/namedExpressions.scala#L146-L150\r\nhttps://github.com/apache/spark/blob/branch-3.1/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/expressions/namedExpressions.scala#L149-L154\r\n\r\n@rdblue I'm going to stick with my approach, introduce new modules to build and test spark3 and spark3-extensions against Spark 3.1, and also to introduce a new runtime module for Spark 3.1. We will produce two Spark3 runtime jars explicitly, one for 3.0 and one for 3.1. I won't use a build property.\r\n ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/838946848/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/838955621","html_url":"https://github.com/apache/iceberg/pull/2512#issuecomment-838955621","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2512","id":838955621,"node_id":"MDEyOklzc3VlQ29tbWVudDgzODk1NTYyMQ==","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T18:25:55Z","updated_at":"2021-05-11T18:25:55Z","author_association":"CONTRIBUTOR","body":"Excerpt from my gradle output:\r\n```\r\n> Task :iceberg-spark3-runtime:integrationTest\r\n[Thread-8] INFO org.apache.spark.util.ShutdownHookManager - Shutdown hook calle\r\n[Thread-8] INFO org.apache.spark.util.ShutdownHookManager - Deleting directory /private/var/folders/7x/vgfk2h155v9gjtw55z6ncgc00000gp/T/spark-51d1d3aa-5b0a-48fa-8dec-70ef4725e0be\r\n\r\n> Task :iceberg-spark3-runtime:spark31IntegrationTest\r\n\r\norg.apache.iceberg.spark.SmokeTest > testGettingStarted[catalogName = testhive, implementation = org.apache.iceberg.spark.SparkCatalog, config = {type=hive, default-namespace=default}] FAILED\r\n    java.lang.NoSuchMethodError at SmokeTest.java:67\r\n\r\norg.apache.iceberg.spark.SmokeTest > testGettingStarted[catalogName = testhadoop, implementation = org.apache.iceberg.spark.SparkCatalog, config = {type=hadoop}] FAILED\r\n    java.lang.NoSuchMethodError at SmokeTest.java:67\r\n\r\norg.apache.iceberg.spark.SmokeTest > testGettingStarted[catalogName = spark_catalog, implementation = org.apache.iceberg.spark.SparkSessionCatalog, config = {type=hive, default-namespace=default, parquet-enabled=true, cache-enabled=false}]FAILED\r\n    java.lang.NoSuchMethodError at SmokeTest.java:67\r\n[shutdown-hook-0] INFO org.apache.spark.util.ShutdownHookManager - Shutdown hook called\r\n[shutdown-hook-0] INFO org.apache.spark.util.ShutdownHookManager - Deleting directory /private/var/folders/7x/vgfk2h155v9gjtw55z6ncgc00000gp/T/spark-93a9a974-bcaf-4d43-99c8-2b4b97f6a9ed\r\n\r\n9 tests completed, 3 failed\r\n\r\n> Task :iceberg-spark3-runtime:spark31IntegrationTest FAILED\r\n\r\nFAILURE: Build failed with an exception.\r\n\r\n```\r\n(@RussellSpitzer I renamed your testSpark31 task to spark31IntegrationTest. As you can see integrationTest passed, but spark31IntegrationTest failed.)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/838955621/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839066499","html_url":"https://github.com/apache/iceberg/pull/2272#issuecomment-839066499","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2272","id":839066499,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTA2NjQ5OQ==","user":{"login":"holdenk","id":59893,"node_id":"MDQ6VXNlcjU5ODkz","avatar_url":"https://avatars.githubusercontent.com/u/59893?v=4","gravatar_id":"","url":"https://api.github.com/users/holdenk","html_url":"https://github.com/holdenk","followers_url":"https://api.github.com/users/holdenk/followers","following_url":"https://api.github.com/users/holdenk/following{/other_user}","gists_url":"https://api.github.com/users/holdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/holdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holdenk/subscriptions","organizations_url":"https://api.github.com/users/holdenk/orgs","repos_url":"https://api.github.com/users/holdenk/repos","events_url":"https://api.github.com/users/holdenk/events{/privacy}","received_events_url":"https://api.github.com/users/holdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T19:42:39Z","updated_at":"2021-05-11T19:42:39Z","author_association":"CONTRIBUTOR","body":"I really appreciate the time given to the test case :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839066499/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839135720","html_url":"https://github.com/apache/iceberg/pull/2257#issuecomment-839135720","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2257","id":839135720,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTEzNTcyMA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T20:27:50Z","updated_at":"2021-05-11T20:27:50Z","author_association":"CONTRIBUTOR","body":"Just a few comments/questions. Otherwise, looks good to go. Thanks, @holdenk!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839135720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839137874","html_url":"https://github.com/apache/iceberg/issues/2533#issuecomment-839137874","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2533","id":839137874,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTEzNzg3NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T20:30:02Z","updated_at":"2021-05-11T20:30:02Z","author_association":"CONTRIBUTOR","body":"I think @RussellSpitzer got it correctly and will submit a fix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839137874/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839294873","html_url":"https://github.com/apache/iceberg/pull/2584#issuecomment-839294873","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2584","id":839294873,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTI5NDg3Mw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T23:50:45Z","updated_at":"2021-05-11T23:50:45Z","author_association":"MEMBER","body":"Fixes #2533 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839294873/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839296625","html_url":"https://github.com/apache/iceberg/pull/2584#issuecomment-839296625","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2584","id":839296625,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTI5NjYyNQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T23:53:32Z","updated_at":"2021-05-11T23:53:32Z","author_association":"MEMBER","body":"@Reo-LEI @221770490011111  Could you please take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839296625/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839360481","html_url":"https://github.com/apache/iceberg/pull/2501#issuecomment-839360481","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2501","id":839360481,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTM2MDQ4MQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T01:17:47Z","updated_at":"2021-05-12T01:17:47Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @stevenzwu @rdblue @kbendick @yyanyy @chenjunjiedada @jackye1995!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839360481/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839367064","html_url":"https://github.com/apache/iceberg/pull/2582#issuecomment-839367064","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2582","id":839367064,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTM2NzA2NA==","user":{"login":"jshmchenxi","id":11854435,"node_id":"MDQ6VXNlcjExODU0NDM1","avatar_url":"https://avatars.githubusercontent.com/u/11854435?v=4","gravatar_id":"","url":"https://api.github.com/users/jshmchenxi","html_url":"https://github.com/jshmchenxi","followers_url":"https://api.github.com/users/jshmchenxi/followers","following_url":"https://api.github.com/users/jshmchenxi/following{/other_user}","gists_url":"https://api.github.com/users/jshmchenxi/gists{/gist_id}","starred_url":"https://api.github.com/users/jshmchenxi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jshmchenxi/subscriptions","organizations_url":"https://api.github.com/users/jshmchenxi/orgs","repos_url":"https://api.github.com/users/jshmchenxi/repos","events_url":"https://api.github.com/users/jshmchenxi/events{/privacy}","received_events_url":"https://api.github.com/users/jshmchenxi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T01:36:53Z","updated_at":"2021-05-12T01:36:53Z","author_association":"CONTRIBUTOR","body":"@chenjunjiedada Hi, would you please help review this patch? Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839367064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839370435","html_url":"https://github.com/apache/iceberg/pull/2544#issuecomment-839370435","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2544","id":839370435,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTM3MDQzNQ==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T01:47:25Z","updated_at":"2021-05-12T01:47:25Z","author_association":"CONTRIBUTOR","body":"restart test","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839370435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839376462","html_url":"https://github.com/apache/iceberg/pull/2272#issuecomment-839376462","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2272","id":839376462,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTM3NjQ2Mg==","user":{"login":"XuQianJin-Stars","id":10494131,"node_id":"MDQ6VXNlcjEwNDk0MTMx","avatar_url":"https://avatars.githubusercontent.com/u/10494131?v=4","gravatar_id":"","url":"https://api.github.com/users/XuQianJin-Stars","html_url":"https://github.com/XuQianJin-Stars","followers_url":"https://api.github.com/users/XuQianJin-Stars/followers","following_url":"https://api.github.com/users/XuQianJin-Stars/following{/other_user}","gists_url":"https://api.github.com/users/XuQianJin-Stars/gists{/gist_id}","starred_url":"https://api.github.com/users/XuQianJin-Stars/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XuQianJin-Stars/subscriptions","organizations_url":"https://api.github.com/users/XuQianJin-Stars/orgs","repos_url":"https://api.github.com/users/XuQianJin-Stars/repos","events_url":"https://api.github.com/users/XuQianJin-Stars/events{/privacy}","received_events_url":"https://api.github.com/users/XuQianJin-Stars/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T02:05:08Z","updated_at":"2021-05-12T02:05:08Z","author_association":"CONTRIBUTOR","body":"hi @holdenk  Thank you very much for your review, I will reply to your comments later.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839376462/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839385622","html_url":"https://github.com/apache/iceberg/pull/2584#issuecomment-839385622","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2584","id":839385622,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTM4NTYyMg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T02:27:40Z","updated_at":"2021-05-12T02:27:40Z","author_association":"CONTRIBUTOR","body":"cc @dilipbiswal @rdblue @prodeezy ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839385622/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839391150","html_url":"https://github.com/apache/iceberg/pull/2585#issuecomment-839391150","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2585","id":839391150,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTM5MTE1MA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T02:45:39Z","updated_at":"2021-05-12T02:45:39Z","author_association":"MEMBER","body":"@chenjunjiedada + @openinx Could you please take a look as well? And of course anyone else who would like to contribute, I really value the comments","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839391150/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839536993","html_url":"https://github.com/apache/iceberg/issues/2571#issuecomment-839536993","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2571","id":839536993,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTUzNjk5Mw==","user":{"login":"wulei0302","id":52473940,"node_id":"MDQ6VXNlcjUyNDczOTQw","avatar_url":"https://avatars.githubusercontent.com/u/52473940?v=4","gravatar_id":"","url":"https://api.github.com/users/wulei0302","html_url":"https://github.com/wulei0302","followers_url":"https://api.github.com/users/wulei0302/followers","following_url":"https://api.github.com/users/wulei0302/following{/other_user}","gists_url":"https://api.github.com/users/wulei0302/gists{/gist_id}","starred_url":"https://api.github.com/users/wulei0302/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wulei0302/subscriptions","organizations_url":"https://api.github.com/users/wulei0302/orgs","repos_url":"https://api.github.com/users/wulei0302/repos","events_url":"https://api.github.com/users/wulei0302/events{/privacy}","received_events_url":"https://api.github.com/users/wulei0302/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T07:33:49Z","updated_at":"2021-05-12T07:33:49Z","author_association":"CONTRIBUTOR","body":"I think this may be a problem with FlinkAvroReader. When reading the avro data file, FlinkAvroReader did not return the position information of the record, which caused the NEP problem later. Can we refer to FlinkParquetReaders ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839536993/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839609519","html_url":"https://github.com/apache/iceberg/pull/2584#issuecomment-839609519","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2584","id":839609519,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTYwOTUxOQ==","user":{"login":"bihaiyang","id":39689341,"node_id":"MDQ6VXNlcjM5Njg5MzQx","avatar_url":"https://avatars.githubusercontent.com/u/39689341?v=4","gravatar_id":"","url":"https://api.github.com/users/bihaiyang","html_url":"https://github.com/bihaiyang","followers_url":"https://api.github.com/users/bihaiyang/followers","following_url":"https://api.github.com/users/bihaiyang/following{/other_user}","gists_url":"https://api.github.com/users/bihaiyang/gists{/gist_id}","starred_url":"https://api.github.com/users/bihaiyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bihaiyang/subscriptions","organizations_url":"https://api.github.com/users/bihaiyang/orgs","repos_url":"https://api.github.com/users/bihaiyang/repos","events_url":"https://api.github.com/users/bihaiyang/events{/privacy}","received_events_url":"https://api.github.com/users/bihaiyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T09:15:07Z","updated_at":"2021-05-12T09:15:07Z","author_association":"NONE","body":"Thank you very much，I have another question, can you help me answer it：When I'm merge into operation on the same table   ，appear error。can i  Obtain the state of the table to determine？thanks\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839609519/reactions","total_count":1,"+1":0,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839639218","html_url":"https://github.com/apache/iceberg/pull/1870#issuecomment-839639218","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1870","id":839639218,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTYzOTIxOA==","user":{"login":"ismailsimsek","id":6005685,"node_id":"MDQ6VXNlcjYwMDU2ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6005685?v=4","gravatar_id":"","url":"https://api.github.com/users/ismailsimsek","html_url":"https://github.com/ismailsimsek","followers_url":"https://api.github.com/users/ismailsimsek/followers","following_url":"https://api.github.com/users/ismailsimsek/following{/other_user}","gists_url":"https://api.github.com/users/ismailsimsek/gists{/gist_id}","starred_url":"https://api.github.com/users/ismailsimsek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ismailsimsek/subscriptions","organizations_url":"https://api.github.com/users/ismailsimsek/orgs","repos_url":"https://api.github.com/users/ismailsimsek/repos","events_url":"https://api.github.com/users/ismailsimsek/events{/privacy}","received_events_url":"https://api.github.com/users/ismailsimsek/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T09:54:10Z","updated_at":"2021-05-12T09:54:10Z","author_association":"CONTRIBUTOR","body":"hi @jackye1995 @rdblue @rymurr its ready for review\r\nif nothing major seem wrong it could be useful to merge and followup with improvements, enable other developers ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/839639218/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]