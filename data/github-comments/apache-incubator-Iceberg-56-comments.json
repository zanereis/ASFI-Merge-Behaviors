[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712156810","html_url":"https://github.com/apache/iceberg/issues/1630#issuecomment-712156810","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1630","id":712156810,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjE1NjgxMA==","user":{"login":"massdosage","id":29457,"node_id":"MDQ6VXNlcjI5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/29457?v=4","gravatar_id":"","url":"https://api.github.com/users/massdosage","html_url":"https://github.com/massdosage","followers_url":"https://api.github.com/users/massdosage/followers","following_url":"https://api.github.com/users/massdosage/following{/other_user}","gists_url":"https://api.github.com/users/massdosage/gists{/gist_id}","starred_url":"https://api.github.com/users/massdosage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massdosage/subscriptions","organizations_url":"https://api.github.com/users/massdosage/orgs","repos_url":"https://api.github.com/users/massdosage/repos","events_url":"https://api.github.com/users/massdosage/events{/privacy}","received_events_url":"https://api.github.com/users/massdosage/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-19T13:28:49Z","updated_at":"2020-10-19T13:28:49Z","author_association":"CONTRIBUTOR","body":"OK, yes, sounds like a good option.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712156810/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712249285","html_url":"https://github.com/apache/iceberg/pull/1624#issuecomment-712249285","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1624","id":712249285,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjI0OTI4NQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-19T15:34:19Z","updated_at":"2020-10-19T15:34:19Z","author_association":"MEMBER","body":"If we are moving the \"Action\" class perhaps it belongs in the API module rather than core (although BaseAction probably still belongs in core?)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712249285/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712252740","html_url":"https://github.com/apache/iceberg/pull/1624#issuecomment-712252740","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1624","id":712252740,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjI1Mjc0MA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-19T15:39:50Z","updated_at":"2020-10-19T15:39:50Z","author_association":"MEMBER","body":"I think this makes sense to me, one question though is do we leave \"Actions\" in the Spark Module? I wouldn't want to break the api there if possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712252740/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712283670","html_url":"https://github.com/apache/iceberg/pull/1625#issuecomment-712283670","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1625","id":712283670,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjI4MzY3MA==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-19T16:29:41Z","updated_at":"2020-10-19T16:30:37Z","author_association":"CONTRIBUTOR","body":"@JingsongLi I have moved the convertConstant method to `RowDataUtil` as you suggested. Also updated and rebased the PR.\r\n\r\n@openinx yes, internally we have a similar iterator/iterable for Avro GenericRecord type. It is not much code since Iceberg library provided those reader functions already, like `ParquetAvroValueReaders`. For the future FLIP-27 source, we can reuse the `DataIterator` base class/interface.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712283670/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712289914","html_url":"https://github.com/apache/iceberg/pull/1566#issuecomment-712289914","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1566","id":712289914,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjI4OTkxNA==","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-19T16:40:29Z","updated_at":"2020-10-19T16:40:29Z","author_association":"CONTRIBUTOR","body":"Nice work @shangxinli! Do you plan to add any jmh benchmark tests to illustrate the filtering benefits?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712289914/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712292673","html_url":"https://github.com/apache/iceberg/pull/1566#issuecomment-712292673","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1566","id":712292673,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjI5MjY3Mw==","user":{"login":"shangxinli","id":31421745,"node_id":"MDQ6VXNlcjMxNDIxNzQ1","avatar_url":"https://avatars.githubusercontent.com/u/31421745?v=4","gravatar_id":"","url":"https://api.github.com/users/shangxinli","html_url":"https://github.com/shangxinli","followers_url":"https://api.github.com/users/shangxinli/followers","following_url":"https://api.github.com/users/shangxinli/following{/other_user}","gists_url":"https://api.github.com/users/shangxinli/gists{/gist_id}","starred_url":"https://api.github.com/users/shangxinli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shangxinli/subscriptions","organizations_url":"https://api.github.com/users/shangxinli/orgs","repos_url":"https://api.github.com/users/shangxinli/repos","events_url":"https://api.github.com/users/shangxinli/events{/privacy}","received_events_url":"https://api.github.com/users/shangxinli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-19T16:45:27Z","updated_at":"2020-10-19T16:45:27Z","author_association":"CONTRIBUTOR","body":"I am new to Iceberg. Can you add more details about 'jmh'? My plan is to have unit tests along with this PR. I can then open another PR if benchmarking tests and other tests are needed.  \r\n\r\n> Nice work @shangxinli! Do you plan to add any jmh benchmark tests to illustrate the filtering benefits?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712292673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712294533","html_url":"https://github.com/apache/iceberg/pull/1566#issuecomment-712294533","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1566","id":712294533,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjI5NDUzMw==","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-19T16:48:48Z","updated_at":"2020-10-19T16:48:48Z","author_association":"CONTRIBUTOR","body":"> I am new to Iceberg. Can you add more details about 'jmh'? My plan is to have unit tests along with this PR. I can then open another PR if benchmarking tests and other tests are needed.\r\n\r\nJMH is a toolkit for microbenchmarks in Java. There are some tests here in Iceberg that use it:\r\nhttps://github.com/apache/iceberg/tree/c9ccdfef4fd7798cd824047cf4e8077c31c1c9e1/spark2/src/jmh/java/org/apache/iceberg/spark/data/parquet\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712294533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712295128","html_url":"https://github.com/apache/iceberg/pull/1633#issuecomment-712295128","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1633","id":712295128,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjI5NTEyOA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-19T16:49:54Z","updated_at":"2020-10-19T16:49:54Z","author_association":"MEMBER","body":"Looking good! Supporting more catalogs is great for the project!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712295128/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712310054","html_url":"https://github.com/apache/iceberg/issues/1628#issuecomment-712310054","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1628","id":712310054,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjMxMDA1NA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-19T17:16:59Z","updated_at":"2020-10-19T17:16:59Z","author_association":"CONTRIBUTOR","body":"cc @jerryshao as you've been working on and off on the original PR. Wondering where you are in currently working on it or if you'd be looking for assistance if you're currently busy?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712310054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712318187","html_url":"https://github.com/apache/iceberg/issues/1634#issuecomment-712318187","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1634","id":712318187,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjMxODE4Nw==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-19T17:31:31Z","updated_at":"2020-10-19T17:31:31Z","author_association":"CONTRIBUTOR","body":"I'll work on this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712318187/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712394812","html_url":"https://github.com/apache/iceberg/pull/1631#issuecomment-712394812","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1631","id":712394812,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjM5NDgxMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-19T19:32:16Z","updated_at":"2020-10-19T19:32:16Z","author_association":"CONTRIBUTOR","body":"Thanks, @marton-bod! I like the direction that this is heading. I just have a few questions to understand how this alternative works.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712394812/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712395701","html_url":"https://github.com/apache/iceberg/pull/1632#issuecomment-712395701","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1632","id":712395701,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjM5NTcwMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-19T19:34:07Z","updated_at":"2020-10-19T19:34:07Z","author_association":"CONTRIBUTOR","body":"Thanks for the fix!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712395701/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712475344","html_url":"https://github.com/apache/iceberg/issues/1635#issuecomment-712475344","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1635","id":712475344,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjQ3NTM0NA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-19T22:24:12Z","updated_at":"2020-10-19T22:24:12Z","author_association":"MEMBER","body":"I *think* the right thing to do here is to not rely on hasNonNullValues and also check if rowCount > numNull. I'll check other readers tomorrow to see how they deal with the issue","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712475344/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712490984","html_url":"https://github.com/apache/iceberg/pull/1636#issuecomment-712490984","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1636","id":712490984,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjQ5MDk4NA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-19T23:11:21Z","updated_at":"2020-10-19T23:11:55Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @RussellSpitzer if you wouldn't mind taking a look at my draft approach to removing a good handful of `NarrowingCompoundAssignment` warnings, I'd be very appreciative.\r\n\r\nSpecifically, I'm not 100% sure that there isn't still an issue with `cv.childCount` still being overflown. But that depends on whether or not `output` is constantly reused. Your input would be appreciated before I fix the rest of them (one way or another).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712490984/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712492648","html_url":"https://github.com/apache/iceberg/issues/1635#issuecomment-712492648","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1635","id":712492648,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjQ5MjY0OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-19T23:16:14Z","updated_at":"2020-10-19T23:16:14Z","author_association":"CONTRIBUTOR","body":"Are there non-null values in the row group?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712492648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712497137","html_url":"https://github.com/apache/iceberg/issues/1635#issuecomment-712497137","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1635","id":712497137,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjQ5NzEzNw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-19T23:30:20Z","updated_at":"2020-10-19T23:31:01Z","author_association":"MEMBER","body":"Yes, there are only non null values in the row group. The correct action is to not skip any row groups","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712497137/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712523136","html_url":"https://github.com/apache/iceberg/pull/1619#issuecomment-712523136","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1619","id":712523136,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjUyMzEzNg==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T00:58:58Z","updated_at":"2020-10-20T00:58:58Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712523136/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712525508","html_url":"https://github.com/apache/iceberg/issues/1628#issuecomment-712525508","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1628","id":712525508,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjUyNTUwOA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T01:06:51Z","updated_at":"2020-10-20T01:06:51Z","author_association":"CONTRIBUTOR","body":"Actually as I understand it @jerryshao is still somewhat working on this. I'm waiting to hear back but I'm likely to close this ticket.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712525508/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712535246","html_url":"https://github.com/apache/iceberg/issues/1635#issuecomment-712535246","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1635","id":712535246,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjUzNTI0Ng==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T01:43:42Z","updated_at":"2020-10-20T01:43:42Z","author_association":"CONTRIBUTOR","body":"Do you know if there's a version number at which this is fixed? Are we able to tell which version the files were written with and possibly check that? I imagine not, as they usually say the writer type and I don't think parquet files usually have the parquet version in them, more the spark version etc. But a thought.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712535246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712543551","html_url":"https://github.com/apache/iceberg/issues/1628#issuecomment-712543551","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1628","id":712543551,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjU0MzU1MQ==","user":{"login":"jerryshao","id":850797,"node_id":"MDQ6VXNlcjg1MDc5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/850797?v=4","gravatar_id":"","url":"https://api.github.com/users/jerryshao","html_url":"https://github.com/jerryshao","followers_url":"https://api.github.com/users/jerryshao/followers","following_url":"https://api.github.com/users/jerryshao/following{/other_user}","gists_url":"https://api.github.com/users/jerryshao/gists{/gist_id}","starred_url":"https://api.github.com/users/jerryshao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerryshao/subscriptions","organizations_url":"https://api.github.com/users/jerryshao/orgs","repos_url":"https://api.github.com/users/jerryshao/repos","events_url":"https://api.github.com/users/jerryshao/events{/privacy}","received_events_url":"https://api.github.com/users/jerryshao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T02:13:07Z","updated_at":"2020-10-20T02:13:07Z","author_association":"CONTRIBUTOR","body":"Hi @kbendick , thanks for your bringing out of this thing. Yes, I'm still working on this. Currently the left comments are mostly style or refactoring issues, so I didn't update the PR actively. I was waiting (for a long while) to see if any committer could check and approve the overall implementations, based on this I could start to change the details and make progress","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712543551/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712550754","html_url":"https://github.com/apache/iceberg/issues/1533#issuecomment-712550754","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1533","id":712550754,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjU1MDc1NA==","user":{"login":"tangchenyang","id":44256449,"node_id":"MDQ6VXNlcjQ0MjU2NDQ5","avatar_url":"https://avatars.githubusercontent.com/u/44256449?v=4","gravatar_id":"","url":"https://api.github.com/users/tangchenyang","html_url":"https://github.com/tangchenyang","followers_url":"https://api.github.com/users/tangchenyang/followers","following_url":"https://api.github.com/users/tangchenyang/following{/other_user}","gists_url":"https://api.github.com/users/tangchenyang/gists{/gist_id}","starred_url":"https://api.github.com/users/tangchenyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tangchenyang/subscriptions","organizations_url":"https://api.github.com/users/tangchenyang/orgs","repos_url":"https://api.github.com/users/tangchenyang/repos","events_url":"https://api.github.com/users/tangchenyang/events{/privacy}","received_events_url":"https://api.github.com/users/tangchenyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T02:37:51Z","updated_at":"2020-10-20T02:37:51Z","author_association":"NONE","body":"Hi akkinenivijay @akkinenivijay.  \r\nI had the same problem with hive-2.3.7 and spark-3.0.1-hadoop-2.7.\r\nIs there a solution to this problem? \r\nThanks. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712550754/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712551444","html_url":"https://github.com/apache/iceberg/issues/1635#issuecomment-712551444","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1635","id":712551444,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjU1MTQ0NA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T02:40:14Z","updated_at":"2020-10-20T02:40:14Z","author_association":"MEMBER","body":"All I know for sure is we had a user with 1.5.0-Cloudera build of Parquet\nFiles. I haven't actually explored past the point where we figured out this\nwas the issue. I know in 1.11 there is no problem since when I initially\ntried to repo this issue by just faking their data it was fine. The issue\nonly repo'd when I took an actual file they had and imported them into a\nnew Iceberg table.\n\nOn Mon, Oct 19, 2020 at 8:43 PM Kyle Bendickson <notifications@github.com>\nwrote:\n\n> Do you know if there's a version number at which this is fixed? Are we\n> able to tell which version the files were written with and possibly check\n> that? I imagine not, as they usually say the writer type and I don't think\n> parquet files usually have the parquet version in them, more the spark\n> version etc. But a thought.\n>\n> â€”\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/iceberg/issues/1635#issuecomment-712535246>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AADE2YMXFAVJ374XGLM2IXTSLTTN3ANCNFSM4SW2V5ZQ>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712551444/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712627740","html_url":"https://github.com/apache/iceberg/pull/1624#issuecomment-712627740","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1624","id":712627740,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjYyNzc0MA==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T06:35:19Z","updated_at":"2020-10-20T06:35:19Z","author_association":"CONTRIBUTOR","body":"> I think this makes sense to me, one question though is do we leave \"Actions\" in the Spark Module? I wouldn't want to break the api there if possible.\r\n\r\nThe Actions  class involve some non-common functions, so I did not extract Actions. For example, spark Actions need SparkSession, and flink Actions need ExecutionEnvironment.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712627740/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712633629","html_url":"https://github.com/apache/iceberg/issues/1622#issuecomment-712633629","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1622","id":712633629,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjYzMzYyOQ==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T06:49:25Z","updated_at":"2020-10-20T06:49:25Z","author_association":"CONTRIBUTOR","body":"Could you please double check you're adding \"iceberg-spark3-runtime\" only for Iceberg?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712633629/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712654972","html_url":"https://github.com/apache/iceberg/pull/1508#issuecomment-712654972","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1508","id":712654972,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjY1NDk3Mg==","user":{"login":"edwinchoi","id":773193,"node_id":"MDQ6VXNlcjc3MzE5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/773193?v=4","gravatar_id":"","url":"https://api.github.com/users/edwinchoi","html_url":"https://github.com/edwinchoi","followers_url":"https://api.github.com/users/edwinchoi/followers","following_url":"https://api.github.com/users/edwinchoi/following{/other_user}","gists_url":"https://api.github.com/users/edwinchoi/gists{/gist_id}","starred_url":"https://api.github.com/users/edwinchoi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edwinchoi/subscriptions","organizations_url":"https://api.github.com/users/edwinchoi/orgs","repos_url":"https://api.github.com/users/edwinchoi/repos","events_url":"https://api.github.com/users/edwinchoi/events{/privacy}","received_events_url":"https://api.github.com/users/edwinchoi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T07:31:57Z","updated_at":"2020-10-20T07:31:57Z","author_association":"NONE","body":"@rdblue what about adding a method `Table rewind(Snapshot)` to `Table`? This seems like a more straight-forward way to handle views as-of a snapshot or moment in time with potentially enough flexibility to work with v2 (queries as-of a moment would select the snapshot upstream). The return value would be a new instance that prohibits any mutating operations against `Table` and `TableOperations`.\r\n\r\nI suspect there would need to be an equivalent `rewind` on `TableOperations` as well for fetching the matching metadata file (there are a lot of fields in the metadata object that seem relevant to queries, e.g., partition specs, table properties, and sort orders.. I'm assuming it's necessary to know these to read a historic snapshot, and not simply the schema alone).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712654972/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712726668","html_url":"https://github.com/apache/iceberg/pull/1624#issuecomment-712726668","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1624","id":712726668,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjcyNjY2OA==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T09:38:43Z","updated_at":"2020-10-20T09:38:43Z","author_association":"CONTRIBUTOR","body":"Thank you very much for the review. @openinx ,@simonsssu ,@RussellSpitzer  I have not submitted a patch in the iceberg community before, so some rules are not well understood , make some low-level mistakes. I will pay attention to it later,I update the code.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712726668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712736154","html_url":"https://github.com/apache/iceberg/pull/1624#issuecomment-712736154","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1624","id":712736154,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjczNjE1NA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T09:55:14Z","updated_at":"2020-10-20T09:55:14Z","author_association":"MEMBER","body":"@zhangjun0x01 ,  Pls feel free to update your pull request, we may need a more friendly document for the beginner to start with. Thanks for your work.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712736154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712765921","html_url":"https://github.com/apache/iceberg/pull/1624#issuecomment-712765921","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1624","id":712765921,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjc2NTkyMQ==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T10:52:10Z","updated_at":"2020-10-20T10:52:10Z","author_association":"CONTRIBUTOR","body":"ok, I will write a document later","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712765921/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712831987","html_url":"https://github.com/apache/iceberg/pull/1624#issuecomment-712831987","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1624","id":712831987,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjgzMTk4Nw==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T13:01:12Z","updated_at":"2020-10-20T13:01:12Z","author_association":"MEMBER","body":"> ok, I will write a document later\r\n\r\nSorry,  I did not describe this thing clearly.   You don't have to provide a document for this PR, it's simple enough now.  I mean I might need to provide a more friendly document for the iceberg beginner to start how to contribute to iceberg.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712831987/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712898607","html_url":"https://github.com/apache/iceberg/issues/1635#issuecomment-712898607","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1635","id":712898607,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjg5ODYwNw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T14:34:21Z","updated_at":"2020-10-20T14:34:21Z","author_association":"MEMBER","body":"The issue is \"hasNonNull\" was only added in 1.7 \r\nhttps://github.com/apache/parquet-mr/commit/4bf9be34a87b51d07e0b0c9e74831bbcdbce0f74\r\n\r\n\r\nPrior to this \"isEmpty\" had a different definition as well\r\n\r\nhttps://github.com/apache/parquet-mr/blame/d70fdbc40195077057a1edb14ccd16a26435d007/parquet-column/src/main/java/parquet/column/statistics/Statistics.java#L222-L224\r\n\r\nSo I think out best thing to do is again to not rely only on \"hasNonNull\"","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712898607/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712918616","html_url":"https://github.com/apache/iceberg/issues/1635#issuecomment-712918616","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1635","id":712918616,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjkxODYxNg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T15:03:15Z","updated_at":"2020-10-20T15:05:13Z","author_association":"MEMBER","body":"Ok just fixing the nonnull check is not sufficient because the min and max values cannot be serialized correctly either. I wrote a quick test to just manual check for nonnull s and when you do that it crashes attempting to check the min and max bounds.\r\n\r\nThis makes me think we need to make a backup isEmpty check. This would see whether nullcount is 0 and min/max are undefined. In this case we should also treat the stats as empty","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712918616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712956694","html_url":"https://github.com/apache/iceberg/pull/1631#issuecomment-712956694","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1631","id":712956694,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjk1NjY5NA==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T15:59:52Z","updated_at":"2020-10-20T15:59:52Z","author_association":"COLLABORATOR","body":"Thanks for your review @rdblue! I've made some changes based on your suggestions.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/712956694/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713011906","html_url":"https://github.com/apache/iceberg/issues/1635#issuecomment-713011906","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1635","id":713011906,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzAxMTkwNg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T17:12:43Z","updated_at":"2020-10-20T17:12:43Z","author_association":"MEMBER","body":"@kbendick I think it's probably best I take this one since I have the active repo, Should be ready soon.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713011906/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713026334","html_url":"https://github.com/apache/iceberg/pull/1407#issuecomment-713026334","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1407","id":713026334,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzAyNjMzNA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T17:38:22Z","updated_at":"2020-10-20T17:38:22Z","author_association":"CONTRIBUTOR","body":"@rdblue: If you have time, could you please review this one?\r\nRebased and also added Partitioned writes ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713026334/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713027825","html_url":"https://github.com/apache/iceberg/pull/1612#issuecomment-713027825","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1612","id":713027825,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzAyNzgyNQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T17:41:08Z","updated_at":"2020-10-20T17:41:08Z","author_association":"CONTRIBUTOR","body":"@rdblue, @pvary, @marton-bod: If you have time, could you please review this one?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713027825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713028501","html_url":"https://github.com/apache/iceberg/pull/1407#issuecomment-713028501","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1407","id":713028501,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzAyODUwMQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T17:42:22Z","updated_at":"2020-10-20T17:42:22Z","author_association":"CONTRIBUTOR","body":"@marton-bod: You might be interested in this too, as I have changed some Hive3 related stuff too","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713028501/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713063712","html_url":"https://github.com/apache/iceberg/issues/1635#issuecomment-713063712","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1635","id":713063712,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzA2MzcxMg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T18:45:58Z","updated_at":"2020-10-20T18:45:58Z","author_association":"MEMBER","body":"Ok I can get repos on Hive 1.Latest and Hadoop 2.Latest. The default config there produces Parquet-mr 1.6 which has the same issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713063712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713133254","html_url":"https://github.com/apache/iceberg/issues/1628#issuecomment-713133254","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1628","id":713133254,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzEzMzI1NA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T20:53:37Z","updated_at":"2020-10-20T20:53:37Z","author_association":"CONTRIBUTOR","body":"Thanks for letting me know @jerryshao. For your own update, a lot of things in that PR seem to have been somewhat merged in.\r\n\r\nPossibly try forking off of your current branch and merging in master to check the diff. A number of files might go away.\r\n\r\nFor example, if you check this PR (which I thought I linked to this issue but somehow the link didn't show), you'll see that the `Microbatches` class that's in your PR exists in some form: https://github.com/apache/iceberg/pull/1627/files\r\n\r\nI just updated one  javadoc comment and then added some tests to verify behavior. So I would think that possibly seeing if you can take your old PR (and the changes that you mentioned if you should like), place them in a new branch based off of the latest master, and see if the overall PR gets smaller.\r\n\r\nMy guess is that it might still need to be broken up into one or two refactor PRs, but I think the overall size of it will be much smaller. Please let me know if I can be of help in some way and I'll see what I can do (time at work permitting).\r\n\r\nThanks for you reply!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713133254/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713145173","html_url":"https://github.com/apache/iceberg/issues/1635#issuecomment-713145173","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1635","id":713145173,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzE0NTE3Mw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-20T21:17:50Z","updated_at":"2020-10-20T21:18:11Z","author_association":"MEMBER","body":"So this is a bit more complicated. This bug only effects files made by parquet versions not effected by\r\n\r\nhttps://github.com/apache/parquet-mr/pull/197/files\r\n\r\nAnd also made before 1.7\r\n\r\nThis means it should only effect Parquet Files made by Cloudera Parquet builds since they are the only pre 1.7.0 builds which also have valid statistics which can be read","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713145173/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713228162","html_url":"https://github.com/apache/iceberg/pull/1619#issuecomment-713228162","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1619","id":713228162,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzIyODE2Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-21T01:09:44Z","updated_at":"2020-10-21T01:09:44Z","author_association":"CONTRIBUTOR","body":"Looks great. Thanks @openinx!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713228162/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713247329","html_url":"https://github.com/apache/iceberg/issues/1635#issuecomment-713247329","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1635","id":713247329,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzI0NzMyOQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-21T02:13:06Z","updated_at":"2020-10-21T02:13:06Z","author_association":"MEMBER","body":"PR up https://github.com/apache/iceberg/pull/1638","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713247329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713247464","html_url":"https://github.com/apache/iceberg/pull/1638#issuecomment-713247464","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1638","id":713247464,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzI0NzQ2NA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-21T02:13:29Z","updated_at":"2020-10-21T02:13:29Z","author_association":"MEMBER","body":"Re: @kbendick + @aokolnychyi  + @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713247464/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713371806","html_url":"https://github.com/apache/iceberg/issues/1639#issuecomment-713371806","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1639","id":713371806,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzM3MTgwNg==","user":{"login":"zanmeipaul","id":20592867,"node_id":"MDQ6VXNlcjIwNTkyODY3","avatar_url":"https://avatars.githubusercontent.com/u/20592867?v=4","gravatar_id":"","url":"https://api.github.com/users/zanmeipaul","html_url":"https://github.com/zanmeipaul","followers_url":"https://api.github.com/users/zanmeipaul/followers","following_url":"https://api.github.com/users/zanmeipaul/following{/other_user}","gists_url":"https://api.github.com/users/zanmeipaul/gists{/gist_id}","starred_url":"https://api.github.com/users/zanmeipaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zanmeipaul/subscriptions","organizations_url":"https://api.github.com/users/zanmeipaul/orgs","repos_url":"https://api.github.com/users/zanmeipaul/repos","events_url":"https://api.github.com/users/zanmeipaul/events{/privacy}","received_events_url":"https://api.github.com/users/zanmeipaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-21T07:33:31Z","updated_at":"2020-10-21T07:33:31Z","author_association":"NONE","body":"When do you plan to complete the Flink CDC integration? We also have this requirement","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713371806/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713372597","html_url":"https://github.com/apache/iceberg/issues/1230#issuecomment-713372597","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1230","id":713372597,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzM3MjU5Nw==","user":{"login":"zhangdove","id":25578853,"node_id":"MDQ6VXNlcjI1NTc4ODUz","avatar_url":"https://avatars.githubusercontent.com/u/25578853?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangdove","html_url":"https://github.com/zhangdove","followers_url":"https://api.github.com/users/zhangdove/followers","following_url":"https://api.github.com/users/zhangdove/following{/other_user}","gists_url":"https://api.github.com/users/zhangdove/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangdove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangdove/subscriptions","organizations_url":"https://api.github.com/users/zhangdove/orgs","repos_url":"https://api.github.com/users/zhangdove/repos","events_url":"https://api.github.com/users/zhangdove/events{/privacy}","received_events_url":"https://api.github.com/users/zhangdove/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-21T07:35:01Z","updated_at":"2020-10-21T07:35:01Z","author_association":"CONTRIBUTOR","body":"When Analyzing Iceberg's Catalog, I find that There is still an issue left here, and I have made some new discoveries:\r\n\r\n`spark.read.format(\"iceberg\").load(\"hdfs://nn:8020/path/to/table\")` By this way, Iceberg table loading does not use the Iceberg Catalog. Of course, Iceberg's metadata information will not be cached. Instead, Iceberg Table will be obtained directly by using `IcebergSource.findTable(options,conf)`.\r\n\r\nHowever, when Iceberg table is loaded using `spark.table(\"prod.db.table\")`, CachingCatalog(`cache-enabled`default value is true) automatically looks for Iceberg table from the cache(Caffeine Cache).\r\n\r\nFinally, whether it is incorrect that I find that the description of the document [in this place](https://github.com/apache/iceberg/blob/master/site/docs/spark.md#querying-with-dataframes)?\r\n\r\nThe correct description should not be this ?\r\n`Using spark.table(\"prod.db.table\") loads an isolated table reference that is not refreshed when other queries update the table.`\r\n\r\n@rdblue How do you think this description? Should we update this place?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713372597/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713373058","html_url":"https://github.com/apache/iceberg/issues/1230#issuecomment-713373058","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1230","id":713373058,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzM3MzA1OA==","user":{"login":"zhangdove","id":25578853,"node_id":"MDQ6VXNlcjI1NTc4ODUz","avatar_url":"https://avatars.githubusercontent.com/u/25578853?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangdove","html_url":"https://github.com/zhangdove","followers_url":"https://api.github.com/users/zhangdove/followers","following_url":"https://api.github.com/users/zhangdove/following{/other_user}","gists_url":"https://api.github.com/users/zhangdove/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangdove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangdove/subscriptions","organizations_url":"https://api.github.com/users/zhangdove/orgs","repos_url":"https://api.github.com/users/zhangdove/repos","events_url":"https://api.github.com/users/zhangdove/events{/privacy}","received_events_url":"https://api.github.com/users/zhangdove/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-21T07:35:54Z","updated_at":"2020-10-21T07:35:54Z","author_association":"CONTRIBUTOR","body":"At least I can close the current issue now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713373058/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713377359","html_url":"https://github.com/apache/iceberg/issues/1639#issuecomment-713377359","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1639","id":713377359,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzM3NzM1OQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-21T07:44:16Z","updated_at":"2020-10-21T07:44:16Z","author_association":"MEMBER","body":"@paulzanmei ,  I think it will be available in the next 0.12.0 release, but I am not sure what's the precise release time, maybe two months later. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713377359/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713382813","html_url":"https://github.com/apache/iceberg/issues/1639#issuecomment-713382813","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1639","id":713382813,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzM4MjgxMw==","user":{"login":"zanmeipaul","id":20592867,"node_id":"MDQ6VXNlcjIwNTkyODY3","avatar_url":"https://avatars.githubusercontent.com/u/20592867?v=4","gravatar_id":"","url":"https://api.github.com/users/zanmeipaul","html_url":"https://github.com/zanmeipaul","followers_url":"https://api.github.com/users/zanmeipaul/followers","following_url":"https://api.github.com/users/zanmeipaul/following{/other_user}","gists_url":"https://api.github.com/users/zanmeipaul/gists{/gist_id}","starred_url":"https://api.github.com/users/zanmeipaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zanmeipaul/subscriptions","organizations_url":"https://api.github.com/users/zanmeipaul/orgs","repos_url":"https://api.github.com/users/zanmeipaul/repos","events_url":"https://api.github.com/users/zanmeipaul/events{/privacy}","received_events_url":"https://api.github.com/users/zanmeipaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-21T07:54:47Z","updated_at":"2020-10-21T07:54:47Z","author_association":"NONE","body":"@openinx   Thank you for your reply, I will continue to follow","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713382813/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713608937","html_url":"https://github.com/apache/iceberg/issues/1533#issuecomment-713608937","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1533","id":713608937,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzYwODkzNw==","user":{"login":"akkinenivijay","id":334752,"node_id":"MDQ6VXNlcjMzNDc1Mg==","avatar_url":"https://avatars.githubusercontent.com/u/334752?v=4","gravatar_id":"","url":"https://api.github.com/users/akkinenivijay","html_url":"https://github.com/akkinenivijay","followers_url":"https://api.github.com/users/akkinenivijay/followers","following_url":"https://api.github.com/users/akkinenivijay/following{/other_user}","gists_url":"https://api.github.com/users/akkinenivijay/gists{/gist_id}","starred_url":"https://api.github.com/users/akkinenivijay/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akkinenivijay/subscriptions","organizations_url":"https://api.github.com/users/akkinenivijay/orgs","repos_url":"https://api.github.com/users/akkinenivijay/repos","events_url":"https://api.github.com/users/akkinenivijay/events{/privacy}","received_events_url":"https://api.github.com/users/akkinenivijay/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-21T14:14:52Z","updated_at":"2020-10-21T14:14:52Z","author_association":"NONE","body":"@tangchenyang I am still having this issue. I could only get iceberg to work with hadoop not with Hive and S3 using spark.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713608937/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713729137","html_url":"https://github.com/apache/iceberg/pull/1586#issuecomment-713729137","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1586","id":713729137,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzcyOTEzNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-21T17:18:44Z","updated_at":"2020-10-21T17:18:44Z","author_association":"CONTRIBUTOR","body":"Thanks, @openinx! Mostly minor comments, except for the number of threads for the Hive MetaStore. We're very careful about changing that value so I'd like to understand your reason for changing it.\r\n\r\nI think the implementation here addresses my concerns from the discussion on #1558. I understand not being able to add files to the classpath easily, and I like that this makes it simple to add a config directory. That's a reasonable thing to support, although it would be nice if users didn't need to specify it each time they create a catalog.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713729137/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713729968","html_url":"https://github.com/apache/iceberg/pull/1558#issuecomment-713729968","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1558","id":713729968,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzcyOTk2OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-21T17:20:16Z","updated_at":"2020-10-21T17:20:16Z","author_association":"CONTRIBUTOR","body":"It sounds like we should move forward with #1586, so I'm going to close this one. Thanks for the additional information to explain why we should add a conf dir property to catalogs. I think the logic in #1586 makes sense.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713729968/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713805766","html_url":"https://github.com/apache/iceberg/pull/1587#issuecomment-713805766","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1587","id":713805766,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzgwNTc2Ng==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-21T18:59:25Z","updated_at":"2020-10-21T18:59:25Z","author_association":"CONTRIBUTOR","body":"Opening this up as a reviewable PR to get early feedback. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713805766/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713892121","html_url":"https://github.com/apache/iceberg/pull/1638#issuecomment-713892121","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1638","id":713892121,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzg5MjEyMQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-21T21:37:56Z","updated_at":"2020-10-21T21:37:56Z","author_association":"MEMBER","body":"@jun-he You may want to took a look as well since you added some of the more recent filtering code?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713892121/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713999158","html_url":"https://github.com/apache/iceberg/pull/1612#issuecomment-713999158","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1612","id":713999158,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzk5OTE1OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-21T23:44:01Z","updated_at":"2020-10-21T23:44:01Z","author_association":"CONTRIBUTOR","body":"I'm planning on spending most of Friday reviewing. Sorry for the delay!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/713999158/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714005223","html_url":"https://github.com/apache/iceberg/issues/1637#issuecomment-714005223","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1637","id":714005223,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDAwNTIyMw==","user":{"login":"johnclara","id":9331049,"node_id":"MDQ6VXNlcjkzMzEwNDk=","avatar_url":"https://avatars.githubusercontent.com/u/9331049?v=4","gravatar_id":"","url":"https://api.github.com/users/johnclara","html_url":"https://github.com/johnclara","followers_url":"https://api.github.com/users/johnclara/followers","following_url":"https://api.github.com/users/johnclara/following{/other_user}","gists_url":"https://api.github.com/users/johnclara/gists{/gist_id}","starred_url":"https://api.github.com/users/johnclara/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johnclara/subscriptions","organizations_url":"https://api.github.com/users/johnclara/orgs","repos_url":"https://api.github.com/users/johnclara/repos","events_url":"https://api.github.com/users/johnclara/events{/privacy}","received_events_url":"https://api.github.com/users/johnclara/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-21T23:47:52Z","updated_at":"2020-10-21T23:47:52Z","author_association":"NONE","body":"I ended up overriding `planFiles` in the DataTableScan to deduplicate FileScanTasks based on the file path ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714005223/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714028966","html_url":"https://github.com/apache/iceberg/pull/1638#issuecomment-714028966","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1638","id":714028966,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDAyODk2Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T00:07:54Z","updated_at":"2020-10-22T00:07:54Z","author_association":"CONTRIBUTOR","body":"Thanks for the quick fix, @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714028966/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714032679","html_url":"https://github.com/apache/iceberg/pull/1477#issuecomment-714032679","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1477","id":714032679,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDAzMjY3OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T00:10:35Z","updated_at":"2020-10-22T00:10:35Z","author_association":"CONTRIBUTOR","body":"If @stevenzwu is happy with the Flink part, I'm good. I just want to look at the Avro serialization parts. Unfortunately, I haven't had a chance to get to this one today, but I should have time on Friday.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714032679/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714088503","html_url":"https://github.com/apache/iceberg/issues/1413#issuecomment-714088503","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1413","id":714088503,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDA4ODUwMw==","user":{"login":"shangxinli","id":31421745,"node_id":"MDQ6VXNlcjMxNDIxNzQ1","avatar_url":"https://avatars.githubusercontent.com/u/31421745?v=4","gravatar_id":"","url":"https://api.github.com/users/shangxinli","html_url":"https://github.com/shangxinli","followers_url":"https://api.github.com/users/shangxinli/followers","following_url":"https://api.github.com/users/shangxinli/following{/other_user}","gists_url":"https://api.github.com/users/shangxinli/gists{/gist_id}","starred_url":"https://api.github.com/users/shangxinli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shangxinli/subscriptions","organizations_url":"https://api.github.com/users/shangxinli/orgs","repos_url":"https://api.github.com/users/shangxinli/repos","events_url":"https://api.github.com/users/shangxinli/events{/privacy}","received_events_url":"https://api.github.com/users/shangxinli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T00:53:01Z","updated_at":"2020-10-22T00:53:01Z","author_association":"CONTRIBUTOR","body":"EncryptionPropertiesFactory/DecryptionPropertiesFactory help you build up the FileEncryptionProperties/FileDecryptionProperties. There is an open PR(https://github.com/apache/parquet-mr/pull/808) about how to use them.\r\n\r\n ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714088503/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714168491","html_url":"https://github.com/apache/iceberg/pull/1624#issuecomment-714168491","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1624","id":714168491,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDE2ODQ5MQ==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T01:45:22Z","updated_at":"2020-10-22T01:59:57Z","author_association":"CONTRIBUTOR","body":"hi,@openinx ,I add a table properties'REWRITE_SCAN_LIMIT' ,and set the default value is 100M, in RewriteDataFilesAction, if the file size is greater  than this value, it will not be scanned, that is, it will not be compressed.\r\n\r\nBecause the default value of the targetSizeInBytes is 128M.For example, my iceberg table has 3 datafiles, each of them is 120M. During the execution of Rewrite, the program will still scan these three files and then regenerate the 3 new files which file size  is the same as the original data. If we periodically perform a Rewrite operation on an iceberg table that is being written in real time, these 120M files will be compressed  repeatedly. I think this is unreasonable.\r\n\r\nIn addition, in the process of combine FileScanTask into CombinedScanTask, it is difficult to ensure that the size of scanned data is exactly targetSizeInBytes (default: 128M).\r\n\r\norg.apache.iceberg.util.BinPacking.Bin#canAdd method.\r\n```\r\n    boolean canAdd(long weight) {\r\n      return binWeight + weight <= targetWeight;\r\n    }\r\n```\r\n\r\nIn most cases, the actual scan size will be less than  targetSizeInBytes, so I set this limit to the default 100M,not 128M","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714168491/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714184907","html_url":"https://github.com/apache/iceberg/pull/1624#issuecomment-714184907","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1624","id":714184907,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDE4NDkwNw==","user":{"login":"simonsssu","id":12323514,"node_id":"MDQ6VXNlcjEyMzIzNTE0","avatar_url":"https://avatars.githubusercontent.com/u/12323514?v=4","gravatar_id":"","url":"https://api.github.com/users/simonsssu","html_url":"https://github.com/simonsssu","followers_url":"https://api.github.com/users/simonsssu/followers","following_url":"https://api.github.com/users/simonsssu/following{/other_user}","gists_url":"https://api.github.com/users/simonsssu/gists{/gist_id}","starred_url":"https://api.github.com/users/simonsssu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simonsssu/subscriptions","organizations_url":"https://api.github.com/users/simonsssu/orgs","repos_url":"https://api.github.com/users/simonsssu/repos","events_url":"https://api.github.com/users/simonsssu/events{/privacy}","received_events_url":"https://api.github.com/users/simonsssu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T02:41:27Z","updated_at":"2020-10-22T02:41:27Z","author_association":"CONTRIBUTOR","body":"@zhangjun0x01 I think your point is only scan the file which less then 100MB, I think it's a little tricky, if your table has 3 files and each of them was 99MB, they will also be put into FileScanTask right ? I think it will also regenerate 3 datafilesã€‚","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714184907/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714201951","html_url":"https://github.com/apache/iceberg/pull/1624#issuecomment-714201951","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1624","id":714201951,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDIwMTk1MQ==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T03:44:02Z","updated_at":"2020-10-22T03:44:02Z","author_association":"CONTRIBUTOR","body":"hi,@simonsssu:\r\nNo matter how much this value is set, there will always be files smaller than the threshold that are repeatedly compressed. My idea is to find a compromise in various cases, such as do Rewrite Action on continuously written streaming data. First One Rewrite Action generated a 99M file, but when the second Rewrite Action was performed, the streaming task generated a lot of small files again. For example, if a file is 10M,  this 99M file and 10M files are merged into 109M,  to avoid this 99M file be compressed repeatedly.\r\n\r\nIf we only temporarily rewrite the datafile once, the 99M file is regenerated, I think it is acceptable.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714201951/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714262488","html_url":"https://github.com/apache/iceberg/pull/1624#issuecomment-714262488","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1624","id":714262488,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDI2MjQ4OA==","user":{"login":"simonsssu","id":12323514,"node_id":"MDQ6VXNlcjEyMzIzNTE0","avatar_url":"https://avatars.githubusercontent.com/u/12323514?v=4","gravatar_id":"","url":"https://api.github.com/users/simonsssu","html_url":"https://github.com/simonsssu","followers_url":"https://api.github.com/users/simonsssu/followers","following_url":"https://api.github.com/users/simonsssu/following{/other_user}","gists_url":"https://api.github.com/users/simonsssu/gists{/gist_id}","starred_url":"https://api.github.com/users/simonsssu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simonsssu/subscriptions","organizations_url":"https://api.github.com/users/simonsssu/orgs","repos_url":"https://api.github.com/users/simonsssu/repos","events_url":"https://api.github.com/users/simonsssu/events{/privacy}","received_events_url":"https://api.github.com/users/simonsssu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T06:28:15Z","updated_at":"2020-10-22T06:28:15Z","author_association":"CONTRIBUTOR","body":"@zhangjun0x01 Hi ZhangJun, Thanks for your explanation. We can not make sure that the second streaming task will generated a lot of small files again. The purpose you want to add this is you consider there will have 3 DataFiles which are all 120MB then they will regenerate, If I have the first Datafile 120MB, and then I generated a 5MB datafile in the second time , it will also trigger to merge to a 125MB.  Is it the same as what you have done now?  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714262488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714321255","html_url":"https://github.com/apache/iceberg/issues/1643#issuecomment-714321255","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1643","id":714321255,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDMyMTI1NQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T08:21:18Z","updated_at":"2020-10-22T08:21:18Z","author_association":"MEMBER","body":"In most flink cases,  the `FlinkInputFormat` will read a record and emit it to the downstream operator,  that means  it will serialize the `RowData` and then sends bytes to next operator,  so I think it's right to set `reuse=true` by default, that saves lots of object allocation from JVM.  \r\n\r\nIn your batch-read case,  the ideal way should be :  allocating a fixed-size array which should be reused in every batch read, when reading a given record we should pass the relative element from reused array for reusing purpose.    But I read the code, seems the `newAvroIterable`, `newParquetIterable`, `newOrcIterable` will return a Iterable whose `next()` method has no way to pass a `reused` instance for reusing.  we have to do the `RowData` copying (Copy RowData from iterator to the fixed-size array) but we still could reuse the fixed-size array to avoiding allocating too many young objects. \r\n\r\nDoes that make sense ? \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714321255/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714364533","html_url":"https://github.com/apache/iceberg/issues/1502#issuecomment-714364533","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1502","id":714364533,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDM2NDUzMw==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T09:33:00Z","updated_at":"2020-10-22T09:33:00Z","author_association":"COLLABORATOR","body":"This also happens when the catalog is expired by catalog cache but the table is still in use. Currently, we expire the catalog after 10 minutes of last access. While actions like a rewrite or merge into might spend more time than it. @aokolnychyi, Did you encounter this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714364533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714388353","html_url":"https://github.com/apache/iceberg/issues/1410#issuecomment-714388353","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1410","id":714388353,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDM4ODM1Mw==","user":{"login":"skambha","id":16563220,"node_id":"MDQ6VXNlcjE2NTYzMjIw","avatar_url":"https://avatars.githubusercontent.com/u/16563220?v=4","gravatar_id":"","url":"https://api.github.com/users/skambha","html_url":"https://github.com/skambha","followers_url":"https://api.github.com/users/skambha/followers","following_url":"https://api.github.com/users/skambha/following{/other_user}","gists_url":"https://api.github.com/users/skambha/gists{/gist_id}","starred_url":"https://api.github.com/users/skambha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skambha/subscriptions","organizations_url":"https://api.github.com/users/skambha/orgs","repos_url":"https://api.github.com/users/skambha/repos","events_url":"https://api.github.com/users/skambha/events{/privacy}","received_events_url":"https://api.github.com/users/skambha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T10:12:56Z","updated_at":"2020-10-22T10:12:56Z","author_association":"CONTRIBUTOR","body":"@rdblue , Thanks so much for the detailed explanation and sharing the use case.  \r\nFor now, I have updated the doc to highlight the existing behavior. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714388353/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714394653","html_url":"https://github.com/apache/iceberg/pull/1612#issuecomment-714394653","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1612","id":714394653,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDM5NDY1Mw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T10:23:29Z","updated_at":"2020-10-22T10:23:29Z","author_association":"CONTRIBUTOR","body":"@rdblue: I will be on PTO next week and I will do my best to not open my laptop during that time ðŸ˜„. So it is absolutely ok if you review the patch only sometime next week. It would be good to have the main points identified here and in #1407 as well, so after the PTO I can start fixing those with fresh energies ðŸ˜„ \r\n\r\nI start to feel more-more convinced that we should not reuse the Hive `PARTITIONED BY` clause to create Iceberg partitioned tables because of the following reasons:\r\n- The resulting table will/should be non-partitioned in Hive and this is non-intuitive for the users (creating a partitioned table, and getting a non-partitioned one)\r\n- We can create only identity partition specifications this way which is very limited in contrast to the nice feature set already provided by Iceberg.\r\n\r\n If you agree, I would throw an error in the next iteration of this PR when the user tries to create a partitioned table with the `PARTITIONED BY` clause. The `TBLPROPERTIES` still could be used to create the full range of Iceberg partitions. In one of my next PRs, I will try to find a better solution for creating Iceberg partitioned tables with a normal SQL statement without using JSON-s ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714394653/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714627866","html_url":"https://github.com/apache/iceberg/pull/1386#issuecomment-714627866","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1386","id":714627866,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDYyNzg2Ng==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T16:57:10Z","updated_at":"2020-10-22T16:57:10Z","author_association":"CONTRIBUTOR","body":"https://github.com/apache/iceberg/pull/1646","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714627866/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714629292","html_url":"https://github.com/apache/iceberg/pull/1646#issuecomment-714629292","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1646","id":714629292,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDYyOTI5Mg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T16:59:44Z","updated_at":"2020-10-22T16:59:44Z","author_association":"MEMBER","body":"Thanks for doing this, perhaps we should get one of those version update bots so we don't have to keep doing these manually?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714629292/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714630320","html_url":"https://github.com/apache/iceberg/pull/1646#issuecomment-714630320","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1646","id":714630320,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDYzMDMyMA==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T17:01:41Z","updated_at":"2020-10-22T17:01:41Z","author_association":"CONTRIBUTOR","body":"Yes, that's a good point. For now, I see two issues:\r\n\r\n- Not sure if there is something of the self available for Gradle (using the versions.lock).\r\n- Apache doesn't allow to have 3rd parties write access to the repository. Dependabot requires this :(","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714630320/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714630825","html_url":"https://github.com/apache/iceberg/pull/1646#issuecomment-714630825","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1646","id":714630825,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDYzMDgyNQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T17:02:37Z","updated_at":"2020-10-22T17:02:37Z","author_association":"MEMBER","body":"Could we have dependabot just work off another repository and submit pr's? Then at least we only have to click merge :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714630825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714637110","html_url":"https://github.com/apache/iceberg/issues/1556#issuecomment-714637110","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1556","id":714637110,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDYzNzExMA==","user":{"login":"elkhand","id":4366998,"node_id":"MDQ6VXNlcjQzNjY5OTg=","avatar_url":"https://avatars.githubusercontent.com/u/4366998?v=4","gravatar_id":"","url":"https://api.github.com/users/elkhand","html_url":"https://github.com/elkhand","followers_url":"https://api.github.com/users/elkhand/followers","following_url":"https://api.github.com/users/elkhand/following{/other_user}","gists_url":"https://api.github.com/users/elkhand/gists{/gist_id}","starred_url":"https://api.github.com/users/elkhand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elkhand/subscriptions","organizations_url":"https://api.github.com/users/elkhand/orgs","repos_url":"https://api.github.com/users/elkhand/repos","events_url":"https://api.github.com/users/elkhand/events{/privacy}","received_events_url":"https://api.github.com/users/elkhand/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T17:13:59Z","updated_at":"2020-10-22T17:13:59Z","author_association":"CONTRIBUTOR","body":"I did retry with a clean table. \r\nI confirm the drop table worked as expected, and removed all the data.\r\nThanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714637110/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714689715","html_url":"https://github.com/apache/iceberg/issues/1647#issuecomment-714689715","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1647","id":714689715,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDY4OTcxNQ==","user":{"login":"jacques-n","id":183350,"node_id":"MDQ6VXNlcjE4MzM1MA==","avatar_url":"https://avatars.githubusercontent.com/u/183350?v=4","gravatar_id":"","url":"https://api.github.com/users/jacques-n","html_url":"https://github.com/jacques-n","followers_url":"https://api.github.com/users/jacques-n/followers","following_url":"https://api.github.com/users/jacques-n/following{/other_user}","gists_url":"https://api.github.com/users/jacques-n/gists{/gist_id}","starred_url":"https://api.github.com/users/jacques-n/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jacques-n/subscriptions","organizations_url":"https://api.github.com/users/jacques-n/orgs","repos_url":"https://api.github.com/users/jacques-n/repos","events_url":"https://api.github.com/users/jacques-n/events{/privacy}","received_events_url":"https://api.github.com/users/jacques-n/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T18:47:41Z","updated_at":"2020-10-22T18:47:41Z","author_association":"NONE","body":"@rdblue can you assign this to me for now?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714689715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714700304","html_url":"https://github.com/apache/iceberg/issues/1643#issuecomment-714700304","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1643","id":714700304,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDcwMDMwNA==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T19:06:12Z","updated_at":"2020-10-22T19:07:11Z","author_association":"CONTRIBUTOR","body":"Let's look at the nextRecord contract from the `InputFormat`. reuse or not is controlled by the caller of `nextRecord(OT reuse)`. \r\n```\r\n\t/**\r\n\t * @param reuse Object that may be reused.\r\n\t */\r\n\tOT nextRecord(OT reuse) throws IOException;\r\n```\r\n\r\nIf the input `reuse` arg is null, there is no reuse. Otherwise, input arg should be used for deserialization. That is how `BinaryInputFormat` implemented.\r\n```\r\n\t@Override\r\n\tpublic T nextRecord(T record) throws IOException {\r\n                // ...\r\n\t\trecord = this.deserialize(record, this.dataInputStream);\r\n                // ...\r\n\t}\r\n```\r\n\r\n`CloseableIterable<T>` interface is just NOT a good fit for InputFormat interface. Now the `FlinkInputFormat` ignore the reuse hint from caller and simply returns reused RowData object.\r\n```\r\n  @Override\r\n  public RowData nextRecord(RowData reuse) {\r\n    return iterator.next();\r\n  }\r\n```\r\n\r\nSo technically, `FlinkInputFormat` is not conforming to the contract of `InputFormat` interface.  If we truly want to implement the correct nextRecord contract, we need to change the `CloseableIterable/Iterator` to support `next(T reuse)`, which is impossible to change the java `Iterator` interface. If it can't conform to the contract, maybe the default behavior should be the more conservative (and less performant) behavior of no reuse.\r\n\r\nWe don't use InputFormat internally. So its behavior is not very relevant to us. This is purely a semantic discussion. I will address other issues in separate comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714700304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714718007","html_url":"https://github.com/apache/iceberg/pull/1646#issuecomment-714718007","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1646","id":714718007,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDcxODAwNw==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T19:39:27Z","updated_at":"2020-10-22T19:39:46Z","author_association":"CONTRIBUTOR","body":"I don't mind doing it now and then. It is a nice way to keep in touch with the project. Also, some other dependencies need some love, such as https://github.com/apache/iceberg/pull/1648","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714718007/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714728550","html_url":"https://github.com/apache/iceberg/issues/1583#issuecomment-714728550","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1583","id":714728550,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDcyODU1MA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T20:00:39Z","updated_at":"2020-10-22T20:00:39Z","author_association":"CONTRIBUTOR","body":"This is closed. In my the above linked issue, Github user [at]mithro said that they were not able to upgrade the bot to use the new API. I've opened a new issue to upgrade. https://github.com/apache/iceberg/issues/1583","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714728550/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714730457","html_url":"https://github.com/apache/iceberg/issues/1649#issuecomment-714730457","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1649","id":714730457,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDczMDQ1Nw==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T20:04:24Z","updated_at":"2020-10-22T20:04:24Z","author_association":"CONTRIBUTOR","body":"Here's the closed issue indicating that the old autolabeler will not be coming back, so we should definitely upgrade both us and then Spark: https://github.com/apache/iceberg/issues/1583\r\n\r\nI will do so in the next few days, working it out with the asf infra team.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714730457/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714731033","html_url":"https://github.com/apache/iceberg/issues/1649#issuecomment-714731033","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1649","id":714731033,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDczMTAzMw==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T20:05:33Z","updated_at":"2020-10-22T20:05:33Z","author_association":"CONTRIBUTOR","body":"This is the \"standard\" labeler action, but if anybody else has any specific suggestions I'm open to them: https://github.com/actions/labeler","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714731033/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714734990","html_url":"https://github.com/apache/iceberg/issues/1649#issuecomment-714734990","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1649","id":714734990,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDczNDk5MA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T20:13:39Z","updated_at":"2020-10-22T20:13:39Z","author_association":"CONTRIBUTOR","body":"I'll also reach out to ASF Infra to ensure that the permissions that the old Probot Autolabeler requested from any of our repos has been turned off as the developer confirmed they won't be maintaining.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714734990/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714738924","html_url":"https://github.com/apache/iceberg/issues/1626#issuecomment-714738924","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1626","id":714738924,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDczODkyNA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T20:21:21Z","updated_at":"2020-10-22T20:21:21Z","author_association":"CONTRIBUTOR","body":"Thanks @stevenzwu. I'm looking forward to this as well. The new source interface allows OSS to once again chain AsyncWait tasks which has been a pain point, so thank you!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714738924/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714761429","html_url":"https://github.com/apache/iceberg/pull/1640#issuecomment-714761429","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1640","id":714761429,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDc2MTQyOQ==","user":{"login":"giovannifumarola","id":672568,"node_id":"MDQ6VXNlcjY3MjU2OA==","avatar_url":"https://avatars.githubusercontent.com/u/672568?v=4","gravatar_id":"","url":"https://api.github.com/users/giovannifumarola","html_url":"https://github.com/giovannifumarola","followers_url":"https://api.github.com/users/giovannifumarola/followers","following_url":"https://api.github.com/users/giovannifumarola/following{/other_user}","gists_url":"https://api.github.com/users/giovannifumarola/gists{/gist_id}","starred_url":"https://api.github.com/users/giovannifumarola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/giovannifumarola/subscriptions","organizations_url":"https://api.github.com/users/giovannifumarola/orgs","repos_url":"https://api.github.com/users/giovannifumarola/repos","events_url":"https://api.github.com/users/giovannifumarola/events{/privacy}","received_events_url":"https://api.github.com/users/giovannifumarola/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T21:04:33Z","updated_at":"2020-10-22T21:04:33Z","author_association":"NONE","body":"Thanks Jack. I like the following approach.\r\nspark.sql.catalog.glue = org.apache.iceberg.spark.SparkCatalog\r\nspark.sql.catalog.glue.type = custom\r\nspark.sql.catalog.glue.impl = org.apache.iceberg.aws.glue.GlueCatalog\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714761429/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714811863","html_url":"https://github.com/apache/iceberg/issues/1643#issuecomment-714811863","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1643","id":714811863,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDgxMTg2Mw==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T23:12:56Z","updated_at":"2020-10-22T23:12:56Z","author_association":"CONTRIBUTOR","body":"Regarding copying RowData from iterator to a fixed-size array by the `IcebergSourceSplitReader<T>`, let's first discuss some of the implementation details.\r\n\r\n- How would `IcebergSourceSplitReader<T>` know how to create a reuseable empty object array for a generic type T?\r\n- How would `IcebergSourceSplitReader<T>` know how to clone the generic type T returned by DataIterator.next()? Both Flink RowData and Avro GenericRecord don't implement `Cloneable` interface.\r\n\r\nRowDataIterator and its underneath Flink*Reader have the knowledge on how to achieve the correct object reuse semantic. \r\n\r\nAssuming `IcebergSourceSplitReader<T>` can implement proper cloning to reusable array, we should still discuss the reuse semantic for records emitted by Iceberg source. Not sure if Flink defines the reuse semantic for the records emitted by source or it is up to the source implementation. If it is up to the source and we decided that Iceberg source should only emit reused records, we should clearly document the expectation. \r\n\r\nE.g. users could have a chained downstream operator (no serialization) that performs de-dup aggregation in memory. When it first time saw a key, it keep the record/row for the key. If there is another row coming for the same key, it simply update a field in the first received row.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714811863/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714842987","html_url":"https://github.com/apache/iceberg/pull/1624#issuecomment-714842987","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1624","id":714842987,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDg0Mjk4Nw==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T01:00:41Z","updated_at":"2020-10-23T01:00:41Z","author_association":"CONTRIBUTOR","body":"@openinx thanks for your review,I have updated the code according to your suggestion","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714842987/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714874835","html_url":"https://github.com/apache/iceberg/issues/1643#issuecomment-714874835","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1643","id":714874835,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDg3NDgzNQ==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T02:52:13Z","updated_at":"2020-10-23T02:54:26Z","author_association":"CONTRIBUTOR","body":"- How would IcebergSourceSplitReader<T> know how to create a reuseable empty object array for a generic type T?\r\n- How would IcebergSourceSplitReader<T> know how to clone the generic type T returned by DataIterator.next()? \r\n\r\nWe already added a `DataIteratorFactory` on how to create an iterator from split. I think we can extend the interface on how create and clone objects.\r\n```\r\npublic class RowDataIteratorFactory implements DataIteratorFactory<RowData> {\r\n  @Override\r\n  public DataIterator<RowData> createIterator(\r\n      IcebergSourceSplit split,\r\n      TableInfo tableInfo,\r\n      ScanContext scanContext) {\r\n    return new RowDataIterator(...);\r\n  }\r\n```\r\n\r\nThe unclear question for is still what should be reuse behavior for Flink source.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714874835/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714883579","html_url":"https://github.com/apache/iceberg/issues/1643#issuecomment-714883579","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1643","id":714883579,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDg4MzU3OQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T03:21:29Z","updated_at":"2020-10-23T03:21:29Z","author_association":"MEMBER","body":"> The unclear question for is still what should be reuse behavior for Flink source.\r\n\r\nI read the  [DataSourceTask](https://github.com/apache/flink/blob/master/flink-runtime/src/main/java/org/apache/flink/runtime/operators/DataSourceTask.java#L181) code,  there's a `objectReuse` ( default value is false)  from `ExecutionConfig` to indicate whether we should enable object reuse.   I also checked the [RecordWriter](https://github.com/apache/flink/blob/master/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/api/writer/RecordWriter.java#L100),  for every emited record,  it would serialized into a ByteBuffer .  So in theory, regardless of enabling or disabling object reuse,  it actually would copy the object into a totally new ByteBuffer,  we don't have to worry about the objects messing up issue caused by reuse at flink runtime at least. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714883579/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714888205","html_url":"https://github.com/apache/iceberg/issues/1643#issuecomment-714888205","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1643","id":714888205,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDg4ODIwNQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T03:37:00Z","updated_at":"2020-10-23T03:37:00Z","author_association":"MEMBER","body":"I think we have reached an agreement that it's useful to reuse objects in the  row data iterators,  the current problem is :  how to reuse it  ? \r\n\r\nNow we  `RichInputFormat#nextRecord(T reuse)`  have provided  the `reuse` instance for reusing,  but our parquet, orc, avro have an internal object reuse mechanism. Unless we change the `Iteratable` interface to accept the `reuse` from `RichInputFormat`, we couldn't bridge them into a single `reuse` instance. \r\n\r\n\r\nSo another way I can image is copying it from the internal parquet, orc, avro iterator's `reuse` to the `RichInputFormat`'s `reuse` .  But as you said, for a generic type `T`,  it does not expose a `Cloneable` method to accomplish the copying.   In that way, we may need a copy function similar to `Cloneable` when constructing the `FlinkInputFormat` ? \r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714888205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714888988","html_url":"https://github.com/apache/iceberg/issues/1643#issuecomment-714888988","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1643","id":714888988,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDg4ODk4OA==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T03:39:47Z","updated_at":"2020-10-23T03:45:19Z","author_association":"CONTRIBUTOR","body":"We actually enable `objectReuse` by default so that chained operators can avoid the serialization and deserialization cost, which is huge for embarrassingly parallel DAGs. That is mainly for operator chaining. \r\n\r\n`RecordWriter` is used for network shuffle (like keyBy). \r\n\r\nBoth probably shouldn't affect or dictate the object reuse semantic in source emitted records.\r\n\r\nBTW, Iceberg's `ParquetAvroValueReaders` returns a new Avro GenericRecord object for each iterator.next() call.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714888988/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714891057","html_url":"https://github.com/apache/iceberg/issues/1643#issuecomment-714891057","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1643","id":714891057,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDg5MTA1Nw==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T03:47:29Z","updated_at":"2020-10-23T03:52:05Z","author_association":"CONTRIBUTOR","body":"> the current problem is : how to reuse it ?\r\n\r\nregarding how to create and clone instance, we can extend the new [DataIteratorFactory](https://github.com/stevenzwu/iceberg/blob/flip27IcebergSource/flink/src/main/java/org/apache/iceberg/flink/source/reader/DataIteratorFactory.java) interface in the flip-27 source poc code. So that is doable\r\n```\r\npublic class RowDataIteratorFactory implements DataIteratorFactory<RowData> {\r\n\r\n  @Override\r\n  public DataIterator<RowData> createIterator(\r\n      IcebergSourceSplit split,\r\n      TableInfo tableInfo,\r\n      ScanContext scanContext) {\r\n    return new RowDataIterator(...);\r\n  }\r\n\r\n  @Override\r\n  public RowData create() {\r\n  ...\r\n  }\r\n\r\n  @Override\r\n  public void clone(RowData from, RowData to) {\r\n  ...\r\n  }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714891057/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714892412","html_url":"https://github.com/apache/iceberg/issues/1643#issuecomment-714892412","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1643","id":714892412,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDg5MjQxMg==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T03:52:40Z","updated_at":"2020-10-23T03:52:40Z","author_association":"CONTRIBUTOR","body":">  it's useful to reuse objects in the row data iterators\r\n\r\nYeah. I am fine either way. My main question is for the records emitted by Iceberg source (FLIP-27) should reuse objects or not.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714892412/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714893283","html_url":"https://github.com/apache/iceberg/issues/1643#issuecomment-714893283","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1643","id":714893283,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDg5MzI4Mw==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T03:55:49Z","updated_at":"2020-10-23T03:55:49Z","author_association":"MEMBER","body":"I'd love to comment the patch if you plan to update it and propose a new one for the reuse idea. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714893283/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714913878","html_url":"https://github.com/apache/iceberg/issues/1643#issuecomment-714913878","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1643","id":714913878,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDkxMzg3OA==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T05:05:23Z","updated_at":"2020-10-23T05:19:02Z","author_association":"CONTRIBUTOR","body":"@openinx I updated [the patch](https://github.com/stevenzwu/iceberg/pull/1/files). You can find the iterator factory change [here](https://github.com/stevenzwu/iceberg/blob/flip27IcebergSource/flink/src/main/java/org/apache/iceberg/flink/source/reader/IcebergSourceSplitReader.java#L93-L100). Right now, it is just doing simple clone if iterator returns reused object. for Avro iterator (which already returns new objects), we don't need to clone again.\r\n\r\nBTW, some unit tests still fail. so it is not completely working.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714913878/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714932966","html_url":"https://github.com/apache/iceberg/issues/1652#issuecomment-714932966","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1652","id":714932966,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDkzMjk2Ng==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T06:00:20Z","updated_at":"2020-10-23T06:21:18Z","author_association":"CONTRIBUTOR","body":"It's a known issue and we've documented into Iceberg-Spark guide doc.\r\nhttps://iceberg.apache.org/spark/#inspecting-tables\r\n\r\n> Note\r\n> \r\n> As of Spark 3.0, the format of the table name for inspection (catalog.database.table.metadata) doesnâ€™t work with Sparkâ€™s default catalog (spark_catalog). If youâ€™ve replaced the default catalog, you may want to use DataFrameReader API to inspect the table.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714932966/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714939569","html_url":"https://github.com/apache/iceberg/issues/1643#issuecomment-714939569","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1643","id":714939569,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDkzOTU2OQ==","user":{"login":"JingsongLi","id":9601882,"node_id":"MDQ6VXNlcjk2MDE4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9601882?v=4","gravatar_id":"","url":"https://api.github.com/users/JingsongLi","html_url":"https://github.com/JingsongLi","followers_url":"https://api.github.com/users/JingsongLi/followers","following_url":"https://api.github.com/users/JingsongLi/following{/other_user}","gists_url":"https://api.github.com/users/JingsongLi/gists{/gist_id}","starred_url":"https://api.github.com/users/JingsongLi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JingsongLi/subscriptions","organizations_url":"https://api.github.com/users/JingsongLi/orgs","repos_url":"https://api.github.com/users/JingsongLi/repos","events_url":"https://api.github.com/users/JingsongLi/events{/privacy}","received_events_url":"https://api.github.com/users/JingsongLi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T06:16:26Z","updated_at":"2020-10-23T06:16:26Z","author_association":"CONTRIBUTOR","body":"I think a file like connector like iceberg can use an interface like `BulkFormat`:\r\nhttps://github.com/apache/flink/blob/2da55b8f841ba93e1aa7c56de31e6c5632d725ba/flink-connectors/flink-connector-files/src/main/java/org/apache/flink/connector/file/src/reader/BulkFormat.java\r\n\r\nHere is a parquet format example:\r\nhttps://github.com/apache/flink/blob/8da968e8d0b1bb13e79d227236f814db69eb31a7/flink-formats/flink-parquet/src/main/java/org/apache/flink/formats/parquet/ParquetVectorizedInputFormat.java\r\n\r\nI think in Iceberg, we can integrate Flink reader to vectorized parquet/orc reader too. This should be the good performance reader.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714939569/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714946582","html_url":"https://github.com/apache/iceberg/issues/1643#issuecomment-714946582","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1643","id":714946582,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDk0NjU4Mg==","user":{"login":"JingsongLi","id":9601882,"node_id":"MDQ6VXNlcjk2MDE4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9601882?v=4","gravatar_id":"","url":"https://api.github.com/users/JingsongLi","html_url":"https://github.com/JingsongLi","followers_url":"https://api.github.com/users/JingsongLi/followers","following_url":"https://api.github.com/users/JingsongLi/following{/other_user}","gists_url":"https://api.github.com/users/JingsongLi/gists{/gist_id}","starred_url":"https://api.github.com/users/JingsongLi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JingsongLi/subscriptions","organizations_url":"https://api.github.com/users/JingsongLi/orgs","repos_url":"https://api.github.com/users/JingsongLi/repos","events_url":"https://api.github.com/users/JingsongLi/events{/privacy}","received_events_url":"https://api.github.com/users/JingsongLi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T06:21:02Z","updated_at":"2020-10-23T06:21:02Z","author_association":"CONTRIBUTOR","body":"For the row-based reader, can `RowDataIteratorFactory` just provide a `createIterator(...., boolean objectReuse)`? Is this enough?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/714946582/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/715219096","html_url":"https://github.com/apache/iceberg/issues/1652#issuecomment-715219096","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1652","id":715219096,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNTIxOTA5Ng==","user":{"login":"liukun4515","id":7450163,"node_id":"MDQ6VXNlcjc0NTAxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/7450163?v=4","gravatar_id":"","url":"https://api.github.com/users/liukun4515","html_url":"https://github.com/liukun4515","followers_url":"https://api.github.com/users/liukun4515/followers","following_url":"https://api.github.com/users/liukun4515/following{/other_user}","gists_url":"https://api.github.com/users/liukun4515/gists{/gist_id}","starred_url":"https://api.github.com/users/liukun4515/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liukun4515/subscriptions","organizations_url":"https://api.github.com/users/liukun4515/orgs","repos_url":"https://api.github.com/users/liukun4515/repos","events_url":"https://api.github.com/users/liukun4515/events{/privacy}","received_events_url":"https://api.github.com/users/liukun4515/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T09:23:20Z","updated_at":"2020-10-23T09:23:20Z","author_association":"NONE","body":"There is also an error when the name of the catalog is not `spark_catalog`.\r\n\r\n```\r\norg.apache.iceberg.exceptions.NoSuchTableException: Invalid table identifier: testhive.default.table.ALL_MANIFESTS\r\n\tat org.apache.iceberg.BaseMetastoreCatalog.loadTable(BaseMetastoreCatalog.java:119)\r\n\tat org.apache.iceberg.spark.source.IcebergSource.findTable(IcebergSource.java:79)\r\n\tat org.apache.iceberg.spark.source.IcebergSource.getTableAndResolveHadoopConfiguration(IcebergSource.java:87)\r\n\tat org.apache.iceberg.spark.source.IcebergSource.getTable(IcebergSource.java:62)\r\n\tat org.apache.iceberg.spark.source.IcebergSource.inferPartitioning(IcebergSource.java:50)\r\n\tat org.apache.spark.sql.execution.datasources.v2.DataSourceV2Utils$.getTableFromProvider(DataSourceV2Utils.scala:82)\r\n\tat org.apache.spark.sql.DataFrameReader.$anonfun$load$1(DataFrameReader.scala:256)\r\n\tat scala.Option.map(Option.scala:230)\r\n```\r\n@HeartSaVioR \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/715219096/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/715223620","html_url":"https://github.com/apache/iceberg/issues/1652#issuecomment-715223620","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1652","id":715223620,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNTIyMzYyMA==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T09:31:26Z","updated_at":"2020-10-23T09:31:26Z","author_association":"CONTRIBUTOR","body":"Could you please provide the query you ran, and how you provide the configuration to setup catalog?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/715223620/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/715235196","html_url":"https://github.com/apache/iceberg/issues/1652#issuecomment-715235196","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1652","id":715235196,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNTIzNTE5Ng==","user":{"login":"liukun4515","id":7450163,"node_id":"MDQ6VXNlcjc0NTAxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/7450163?v=4","gravatar_id":"","url":"https://api.github.com/users/liukun4515","html_url":"https://github.com/liukun4515","followers_url":"https://api.github.com/users/liukun4515/followers","following_url":"https://api.github.com/users/liukun4515/following{/other_user}","gists_url":"https://api.github.com/users/liukun4515/gists{/gist_id}","starred_url":"https://api.github.com/users/liukun4515/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liukun4515/subscriptions","organizations_url":"https://api.github.com/users/liukun4515/orgs","repos_url":"https://api.github.com/users/liukun4515/repos","events_url":"https://api.github.com/users/liukun4515/events{/privacy}","received_events_url":"https://api.github.com/users/liukun4515/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T09:53:00Z","updated_at":"2020-10-23T10:15:21Z","author_association":"NONE","body":"I implement the spark sql extension (remove orphan files) using the spark action.\r\nThe pr is [sql remove orphan files](https://github.com/aokolnychyi/incubator-iceberg/pull/2)\r\n\r\nWhen running the test, the corresponding error will be generated.\r\n\r\nThe configuration is :\r\n![image](https://user-images.githubusercontent.com/7450163/96989614-8a81cd80-1558-11eb-9f85-0c41bd5aca24.png)\r\n\r\nThe exception is \r\n```\r\norg.apache.iceberg.exceptions.NoSuchTableException: Invalid table identifier: testhive.default.table.ALL_MANIFESTS\r\n\tat org.apache.iceberg.BaseMetastoreCatalog.loadTable(BaseMetastoreCatalog.java:119)\r\n\tat org.apache.iceberg.spark.source.IcebergSource.findTable(IcebergSource.java:79)\r\n\tat org.apache.iceberg.spark.source.IcebergSource.getTableAndResolveHadoopConfiguration(IcebergSource.java:87)\r\n\tat org.apache.iceberg.spark.source.IcebergSource.getTable(IcebergSource.java:62)\r\n\tat org.apache.iceberg.spark.source.IcebergSource.inferPartitioning(IcebergSource.java:50)\r\n\tat org.apache.spark.sql.execution.datasources.v2.DataSourceV2Utils$.getTableFromProvider(DataSourceV2Utils.scala:82)\r\n\tat org.apache.spark.sql.DataFrameReader.$anonfun$load$1(DataFrameReader.scala:256)\r\n\tat scala.Option.map(Option.scala:230)\r\n```\r\n@HeartSaVioR ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/715235196/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/715238022","html_url":"https://github.com/apache/iceberg/issues/1652#issuecomment-715238022","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1652","id":715238022,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNTIzODAyMg==","user":{"login":"liukun4515","id":7450163,"node_id":"MDQ6VXNlcjc0NTAxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/7450163?v=4","gravatar_id":"","url":"https://api.github.com/users/liukun4515","html_url":"https://github.com/liukun4515","followers_url":"https://api.github.com/users/liukun4515/followers","following_url":"https://api.github.com/users/liukun4515/following{/other_user}","gists_url":"https://api.github.com/users/liukun4515/gists{/gist_id}","starred_url":"https://api.github.com/users/liukun4515/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liukun4515/subscriptions","organizations_url":"https://api.github.com/users/liukun4515/orgs","repos_url":"https://api.github.com/users/liukun4515/repos","events_url":"https://api.github.com/users/liukun4515/events{/privacy}","received_events_url":"https://api.github.com/users/liukun4515/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T09:58:26Z","updated_at":"2020-10-23T09:59:09Z","author_association":"NONE","body":"The code is \r\n```\r\n  protected Dataset<Row> buildValidDataFileDF(SparkSession spark, String tableName) {\r\n    JavaSparkContext context = new JavaSparkContext(spark.sparkContext());\r\n    Broadcast<FileIO> ioBroadcast = context.broadcast(SparkUtil.serializableFileIO(table()));\r\n    String allManifestsMetadataTable = metadataTableName(tableName, MetadataTableType.ALL_MANIFESTS);\r\n\r\n    Dataset<ManifestFileBean> allManifests = spark.read().format(\"iceberg\").load(allManifestsMetadataTable)\r\n        .selectExpr(\"path\", \"length\", \"partition_spec_id as partitionSpecId\", \"added_snapshot_id as addedSnapshotId\")\r\n        .dropDuplicates(\"path\")\r\n        .repartition(spark.sessionState().conf().numShufflePartitions()) // avoid adaptive execution combining tasks\r\n        .as(Encoders.bean(ManifestFileBean.class));\r\n\r\n    return allManifests.flatMap(new ReadManifest(ioBroadcast), Encoders.STRING()).toDF(\"file_path\");\r\n  }\r\n```\r\nif the table is loaded by spark catalog, the format of the table name is `catalog.database.tablename` which is not suitable for [inspect by DF](https://iceberg.apache.org/spark/#inspecting-with-dataframes)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/715238022/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/715264529","html_url":"https://github.com/apache/iceberg/issues/1652#issuecomment-715264529","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1652","id":715264529,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNTI2NDUyOQ==","user":{"login":"liukun4515","id":7450163,"node_id":"MDQ6VXNlcjc0NTAxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/7450163?v=4","gravatar_id":"","url":"https://api.github.com/users/liukun4515","html_url":"https://github.com/liukun4515","followers_url":"https://api.github.com/users/liukun4515/followers","following_url":"https://api.github.com/users/liukun4515/following{/other_user}","gists_url":"https://api.github.com/users/liukun4515/gists{/gist_id}","starred_url":"https://api.github.com/users/liukun4515/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liukun4515/subscriptions","organizations_url":"https://api.github.com/users/liukun4515/orgs","repos_url":"https://api.github.com/users/liukun4515/repos","events_url":"https://api.github.com/users/liukun4515/events{/privacy}","received_events_url":"https://api.github.com/users/liukun4515/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T10:47:49Z","updated_at":"2020-10-23T10:47:49Z","author_association":"NONE","body":"@HeartSaVioR ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/715264529/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/715429823","html_url":"https://github.com/apache/iceberg/issues/1643#issuecomment-715429823","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1643","id":715429823,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNTQyOTgyMw==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T15:59:04Z","updated_at":"2020-10-23T16:38:19Z","author_association":"CONTRIBUTOR","body":"> For the row-based reader, can `RowDataIteratorFactory` just provide a `createIterator(...., boolean objectReuse)`? Is this enough?\r\n\r\n@JingsongLi I really like the suggestion, which hides the reuse behavior within the iterator. It is a better abstraction that doesn't leak the reuse/clone logic to the caller or factory. It is actually what I was originally looking for as the title suggested.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/715429823/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/715466468","html_url":"https://github.com/apache/iceberg/issues/1502#issuecomment-715466468","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1502","id":715466468,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNTQ2NjQ2OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T17:11:04Z","updated_at":"2020-10-23T17:11:04Z","author_association":"CONTRIBUTOR","body":"I think that the lifecycle of a catalog should be tied to the lifecycle of a SQL session, which addresses the problem because the catalog is not closed unless the session is.\r\n\r\nI'm not aware of a catalog cache anywhere. Is that something you have added?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/715466468/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/715500867","html_url":"https://github.com/apache/iceberg/pull/1650#issuecomment-715500867","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1650","id":715500867,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNTUwMDg2Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T18:19:56Z","updated_at":"2020-10-23T18:19:56Z","author_association":"CONTRIBUTOR","body":"Thanks for the fixes, @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/715500867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]