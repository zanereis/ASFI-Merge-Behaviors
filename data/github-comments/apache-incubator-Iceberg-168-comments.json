[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121361571","html_url":"https://github.com/apache/iceberg/pull/4720#issuecomment-1121361571","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4720","id":1121361571,"node_id":"IC_kwDOCW7NX85C1p6j","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-09T17:12:32Z","updated_at":"2022-05-09T17:12:32Z","author_association":"MEMBER","body":"Thanks @singhpk234 for the PR and @abmo-x for review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121361571/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121384864","html_url":"https://github.com/apache/iceberg/pull/4011#issuecomment-1121384864","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4011","id":1121384864,"node_id":"IC_kwDOCW7NX85C1vmg","user":{"login":"SinghAsDev","id":4915557,"node_id":"MDQ6VXNlcjQ5MTU1NTc=","avatar_url":"https://avatars.githubusercontent.com/u/4915557?v=4","gravatar_id":"","url":"https://api.github.com/users/SinghAsDev","html_url":"https://github.com/SinghAsDev","followers_url":"https://api.github.com/users/SinghAsDev/followers","following_url":"https://api.github.com/users/SinghAsDev/following{/other_user}","gists_url":"https://api.github.com/users/SinghAsDev/gists{/gist_id}","starred_url":"https://api.github.com/users/SinghAsDev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SinghAsDev/subscriptions","organizations_url":"https://api.github.com/users/SinghAsDev/orgs","repos_url":"https://api.github.com/users/SinghAsDev/repos","events_url":"https://api.github.com/users/SinghAsDev/events{/privacy}","received_events_url":"https://api.github.com/users/SinghAsDev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-09T17:35:30Z","updated_at":"2022-05-09T17:36:20Z","author_association":"CONTRIBUTOR","body":"Hey @rajarshisarkar so sorry for not being able to spend time on this :disappointed:. I think if you have time I would appreciate the help to help close this, thanks. If you don't get time either, I can try to get to it by end of this week.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121384864/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121385349","html_url":"https://github.com/apache/iceberg/pull/4720#issuecomment-1121385349","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4720","id":1121385349,"node_id":"IC_kwDOCW7NX85C1vuF","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-09T17:36:01Z","updated_at":"2022-05-09T17:36:01Z","author_association":"COLLABORATOR","body":"Arg, sorry about the initial bug, thanks @singhpk234 for the fix and all for review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121385349/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121389974","html_url":"https://github.com/apache/iceberg/pull/4693#issuecomment-1121389974","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4693","id":1121389974,"node_id":"IC_kwDOCW7NX85C1w2W","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-09T17:40:41Z","updated_at":"2022-05-09T17:40:41Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121389974/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121398382","html_url":"https://github.com/apache/iceberg/pull/4719#issuecomment-1121398382","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4719","id":1121398382,"node_id":"IC_kwDOCW7NX85C1y5u","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-09T17:49:16Z","updated_at":"2022-05-09T17:49:16Z","author_association":"MEMBER","body":"I was wrong about needing a different fix for 2.4, should be the same. Writing a test for it will be very different though","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121398382/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121409812","html_url":"https://github.com/apache/iceberg/pull/4714#issuecomment-1121409812","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4714","id":1121409812,"node_id":"IC_kwDOCW7NX85C11sU","user":{"login":"ggershinsky","id":12033212,"node_id":"MDQ6VXNlcjEyMDMzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/12033212?v=4","gravatar_id":"","url":"https://api.github.com/users/ggershinsky","html_url":"https://github.com/ggershinsky","followers_url":"https://api.github.com/users/ggershinsky/followers","following_url":"https://api.github.com/users/ggershinsky/following{/other_user}","gists_url":"https://api.github.com/users/ggershinsky/gists{/gist_id}","starred_url":"https://api.github.com/users/ggershinsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggershinsky/subscriptions","organizations_url":"https://api.github.com/users/ggershinsky/orgs","repos_url":"https://api.github.com/users/ggershinsky/repos","events_url":"https://api.github.com/users/ggershinsky/events{/privacy}","received_events_url":"https://api.github.com/users/ggershinsky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-09T18:01:42Z","updated_at":"2022-05-09T18:01:42Z","author_association":"CONTRIBUTOR","body":"Yep, a KMS client doesn't receive catalog properties (which makes sense, because a KMS and a Catalog are two unrelated services). It can be configured via table properties and via custom channels. If the default AWS KMS client works out of box for a typical environment, then maybe we can start without custom channels; allowing users to override this as needed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121409812/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121444481","html_url":"https://github.com/apache/iceberg/pull/4242#issuecomment-1121444481","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4242","id":1121444481,"node_id":"IC_kwDOCW7NX85C1-KB","user":{"login":"wmoustafa","id":10084105,"node_id":"MDQ6VXNlcjEwMDg0MTA1","avatar_url":"https://avatars.githubusercontent.com/u/10084105?v=4","gravatar_id":"","url":"https://api.github.com/users/wmoustafa","html_url":"https://github.com/wmoustafa","followers_url":"https://api.github.com/users/wmoustafa/followers","following_url":"https://api.github.com/users/wmoustafa/following{/other_user}","gists_url":"https://api.github.com/users/wmoustafa/gists{/gist_id}","starred_url":"https://api.github.com/users/wmoustafa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wmoustafa/subscriptions","organizations_url":"https://api.github.com/users/wmoustafa/orgs","repos_url":"https://api.github.com/users/wmoustafa/repos","events_url":"https://api.github.com/users/wmoustafa/events{/privacy}","received_events_url":"https://api.github.com/users/wmoustafa/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-09T18:37:59Z","updated_at":"2022-05-09T18:38:09Z","author_association":"CONTRIBUTOR","body":"Thank you @shardulm94 for the review! @rdblue could you take a look? @shardulm94 has already approved. If you do not have any other concerns, we can go ahead and merge it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121444481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121477813","html_url":"https://github.com/apache/iceberg/issues/4472#issuecomment-1121477813","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4472","id":1121477813,"node_id":"IC_kwDOCW7NX85C2GS1","user":{"login":"MichaelTiemannOSC","id":72577720,"node_id":"MDQ6VXNlcjcyNTc3NzIw","avatar_url":"https://avatars.githubusercontent.com/u/72577720?v=4","gravatar_id":"","url":"https://api.github.com/users/MichaelTiemannOSC","html_url":"https://github.com/MichaelTiemannOSC","followers_url":"https://api.github.com/users/MichaelTiemannOSC/followers","following_url":"https://api.github.com/users/MichaelTiemannOSC/following{/other_user}","gists_url":"https://api.github.com/users/MichaelTiemannOSC/gists{/gist_id}","starred_url":"https://api.github.com/users/MichaelTiemannOSC/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MichaelTiemannOSC/subscriptions","organizations_url":"https://api.github.com/users/MichaelTiemannOSC/orgs","repos_url":"https://api.github.com/users/MichaelTiemannOSC/repos","events_url":"https://api.github.com/users/MichaelTiemannOSC/events{/privacy}","received_events_url":"https://api.github.com/users/MichaelTiemannOSC/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-09T19:15:18Z","updated_at":"2022-05-09T19:15:18Z","author_association":"NONE","body":"Problem has gone away due to refreshing of CL2.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121477813/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121505437","html_url":"https://github.com/apache/iceberg/pull/4097#issuecomment-1121505437","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4097","id":1121505437,"node_id":"IC_kwDOCW7NX85C2NCd","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-09T19:44:10Z","updated_at":"2022-05-09T19:44:10Z","author_association":"CONTRIBUTOR","body":"Closing this as it's very outdated.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121505437/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121506124","html_url":"https://github.com/apache/iceberg/pull/4724#issuecomment-1121506124","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4724","id":1121506124,"node_id":"IC_kwDOCW7NX85C2NNM","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-09T19:45:02Z","updated_at":"2022-05-09T19:45:02Z","author_association":"CONTRIBUTOR","body":"cc @hililiwei @yittg @stevenzwu if you get a chance.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121506124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121506671","html_url":"https://github.com/apache/iceberg/pull/4235#issuecomment-1121506671","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4235","id":1121506671,"node_id":"IC_kwDOCW7NX85C2NVv","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-09T19:45:44Z","updated_at":"2022-05-09T19:45:44Z","author_association":"CONTRIBUTOR","body":"Closing as this is outdated.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121506671/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121780430","html_url":"https://github.com/apache/iceberg/pull/4734#issuecomment-1121780430","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4734","id":1121780430,"node_id":"IC_kwDOCW7NX85C3QLO","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T01:54:16Z","updated_at":"2022-05-10T01:54:16Z","author_association":"CONTRIBUTOR","body":"Hi @kbendick, thank you for your timely review.\r\nIn the latest revision, I adopted the split scheme for subsequent review.\r\n1. Keep the original method for the common part of the test.\r\n2. separated the different tests(for no_nans) into two methods, one for ORC and one for Parquet, named `testIsNanOrc` and `testIsNanParquet`. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121780430/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121781999","html_url":"https://github.com/apache/iceberg/pull/3457#issuecomment-1121781999","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3457","id":1121781999,"node_id":"IC_kwDOCW7NX85C3Qjv","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T01:58:02Z","updated_at":"2022-05-10T01:58:02Z","author_association":"CONTRIBUTOR","body":"@szehon-ho, the reason why we use `all_manifests` is to avoid the expensive driver-side manifest list file reads. `all_files` has to read through every manifest list in the table from the driver to find all the manifests, dedup, and then make tasks. The `all_manifests` table makes a task out of each manifest list to produce a collection of manifests from just the list of snapshots/manifest lists.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121781999/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121784807","html_url":"https://github.com/apache/iceberg/pull/4733#issuecomment-1121784807","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4733","id":1121784807,"node_id":"IC_kwDOCW7NX85C3RPn","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T02:02:01Z","updated_at":"2022-05-10T02:02:01Z","author_association":"CONTRIBUTOR","body":"I don't think this is a good idea. While Flink may not need the referenced files set, the writer that you're modifying here lives in core and could be used by other modules. If this were entirely in Flink I think it would be fine, but it probably isn't a good idea to modify this class.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121784807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121791545","html_url":"https://github.com/apache/iceberg/pull/4721#issuecomment-1121791545","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4721","id":1121791545,"node_id":"IC_kwDOCW7NX85C3S45","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T02:05:33Z","updated_at":"2022-05-10T02:05:33Z","author_association":"CONTRIBUTOR","body":"@southernriver, when can Iceberg metadata be used to evaluate `endsWith`? The only case I can think of is when evaluating for identity partitioned data values, but that's an extremely narrow use case. I don't think it is worth the complexity of adding more predicates unless Iceberg metadata can be used to skip more data.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121791545/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121791934","html_url":"https://github.com/apache/iceberg/pull/4731#issuecomment-1121791934","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4731","id":1121791934,"node_id":"IC_kwDOCW7NX85C3S--","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T02:06:17Z","updated_at":"2022-05-10T02:06:17Z","author_association":"CONTRIBUTOR","body":"Thanks, @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121791934/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121793259","html_url":"https://github.com/apache/iceberg/pull/4728#issuecomment-1121793259","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4728","id":1121793259,"node_id":"IC_kwDOCW7NX85C3TTr","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T02:09:10Z","updated_at":"2022-05-10T02:09:10Z","author_association":"CONTRIBUTOR","body":"Thanks, @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121793259/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121793472","html_url":"https://github.com/apache/iceberg/pull/4721#issuecomment-1121793472","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4721","id":1121793472,"node_id":"IC_kwDOCW7NX85C3TXA","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T02:09:38Z","updated_at":"2022-05-10T02:11:53Z","author_association":"CONTRIBUTOR","body":"> @southernriver, when can Iceberg metadata be used to evaluate `endsWith`? The only case I can think of is when evaluating for identity partitioned data values, but that's an extremely narrow use case. I don't think it is worth the complexity of adding more predicates unless Iceberg metadata can be used to skip more data.\r\n\r\nYeah I do agree. It would have to be identity partitions and the metrics would need to be stored longer than the value to compare to and the value being evaluated (by default fields are truncated at 16 characters but it’s controllable). I pulled this down and played with it and it’s a very narrow use case as far as I can tell.\r\n\r\nThere are cases where it can have benefit, but we should weigh the complexity of the implementation over the value added. The use cases that will see a performance benefit from this are very narrow, but as it stands now I think  the added complexity could lead to incorrect results potentially. Like the truncation right now etc. so I’m not inherently opposed to it but I’d like to at least “be more permissive” / signify that data might match more often out of an abundance of correctness concerns.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121793472/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121795483","html_url":"https://github.com/apache/iceberg/pull/4724#issuecomment-1121795483","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4724","id":1121795483,"node_id":"IC_kwDOCW7NX85C3T2b","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T02:13:51Z","updated_at":"2022-05-10T02:13:51Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121795483/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121796772","html_url":"https://github.com/apache/iceberg/pull/4712#issuecomment-1121796772","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4712","id":1121796772,"node_id":"IC_kwDOCW7NX85C3UKk","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T02:16:52Z","updated_at":"2022-05-10T02:16:52Z","author_association":"CONTRIBUTOR","body":"Thanks, @yittg! Good to have this fixed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121796772/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121798006","html_url":"https://github.com/apache/iceberg/pull/4711#issuecomment-1121798006","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4711","id":1121798006,"node_id":"IC_kwDOCW7NX85C3Ud2","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T02:17:50Z","updated_at":"2022-05-10T02:17:50Z","author_association":"CONTRIBUTOR","body":"Thanks, @ulmako! Good to have this fixed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121798006/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121800112","html_url":"https://github.com/apache/iceberg/pull/4710#issuecomment-1121800112","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4710","id":1121800112,"node_id":"IC_kwDOCW7NX85C3U-w","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T02:19:30Z","updated_at":"2022-05-10T02:19:30Z","author_association":"CONTRIBUTOR","body":"@jzhuge, what does it mean for two schemas to be equal?\r\n\r\nWe didn't implement this originally because it isn't clear what the right answer is. If two schemas are structurally equal but have different identity columns, are they equal? Not implementing equals avoids the problem. Is there some reason why you need `equals` and `hashCode` that makes it a good time to solve this problem?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121800112/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121803278","html_url":"https://github.com/apache/iceberg/pull/4702#issuecomment-1121803278","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4702","id":1121803278,"node_id":"IC_kwDOCW7NX85C3VwO","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T02:21:57Z","updated_at":"2022-05-10T02:21:57Z","author_association":"CONTRIBUTOR","body":"These aren't going to be null because they're set in the constructor and don't change. I don't see much value in changes like this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121803278/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121815659","html_url":"https://github.com/apache/iceberg/pull/4708#issuecomment-1121815659","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4708","id":1121815659,"node_id":"IC_kwDOCW7NX85C3Yxr","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T02:32:07Z","updated_at":"2022-05-10T02:32:07Z","author_association":"CONTRIBUTOR","body":"@flyrain, is this really an \"Action\"? What if we had a separate API for helpers like this that wasn't called \"actions\"? Then we wouldn't need to add and remove things from actions. I'd prefer to keep it separate, though I'm open to hearing the arguments for mixing this in.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121815659/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121816959","html_url":"https://github.com/apache/iceberg/pull/3457#issuecomment-1121816959","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3457","id":1121816959,"node_id":"IC_kwDOCW7NX85C3ZF_","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T02:33:01Z","updated_at":"2022-05-10T02:34:44Z","author_association":"COLLABORATOR","body":"@RussellSpitzer @aokolnychyi Rebased the pr , it's still using the manual way to filter out snapshots from all_manifest table, if you guys have time to take a look.\r\n\r\nThe idea I was mentioning in above few comments to use manifest table with snapshot filtering via time-travel (to make it cleaner), I tried to implement in : https://github.com/apache/iceberg/pull/4736 , I'd like to see your thoughts if that is a better approach.  The problem there is I stopped when I realized manifest table do not support time-travel, and it didn't look trivial to implement.  \r\n\r\nAlso FYI @ajantha-bhat as we were talking about this on https://github.com/apache/iceberg/pull/4674","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121816959/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121817453","html_url":"https://github.com/apache/iceberg/pull/4705#issuecomment-1121817453","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4705","id":1121817453,"node_id":"IC_kwDOCW7NX85C3ZNt","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T02:33:20Z","updated_at":"2022-05-10T02:33:20Z","author_association":"CONTRIBUTOR","body":"@flyrain, can you open these in separate PRs? They seem like different features to me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121817453/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121818240","html_url":"https://github.com/apache/iceberg/pull/3457#issuecomment-1121818240","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3457","id":1121818240,"node_id":"IC_kwDOCW7NX85C3ZaA","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T02:34:08Z","updated_at":"2022-05-10T02:34:08Z","author_association":"COLLABORATOR","body":"@rdblue yea thanks, I realized it after asking.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121818240/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121818466","html_url":"https://github.com/apache/iceberg/pull/4729#issuecomment-1121818466","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4729","id":1121818466,"node_id":"IC_kwDOCW7NX85C3Zdi","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T02:34:16Z","updated_at":"2022-05-10T02:34:16Z","author_association":"CONTRIBUTOR","body":"Thanks, @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121818466/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121819613","html_url":"https://github.com/apache/iceberg/pull/4727#issuecomment-1121819613","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4727","id":1121819613,"node_id":"IC_kwDOCW7NX85C3Zvd","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T02:35:06Z","updated_at":"2022-05-10T02:35:06Z","author_association":"CONTRIBUTOR","body":"@jun-he, since #4728 was merged, I think this will fail tests. Can you update please?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121819613/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121820816","html_url":"https://github.com/apache/iceberg/pull/4702#issuecomment-1121820816","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4702","id":1121820816,"node_id":"IC_kwDOCW7NX85C3aCQ","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T02:36:11Z","updated_at":"2022-05-10T02:36:11Z","author_association":"CONTRIBUTOR","body":"@rdblue \r\n\r\n> These aren't going to be null because they're set in the constructor and don't change. I don't see much value in changes like this.\r\n\r\nOK, I'll close this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121820816/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121825416","html_url":"https://github.com/apache/iceberg/pull/4674#issuecomment-1121825416","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4674","id":1121825416,"node_id":"IC_kwDOCW7NX85C3bKI","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T02:40:23Z","updated_at":"2022-05-10T02:41:04Z","author_association":"COLLABORATOR","body":"> c) I have some more plans for improving the expire_snaphots (different idea than https://github.com/apache/iceberg/pull/3457), I will work in the subsequent PR.\r\n\r\n> Idea is that add a new column \"from_snapshot_id\" while preparing the actual files, then filter out (NOT IN filter) the expired snapshot ids rows from persisted output (without scanning again) and then same logic of df.except() to find the expired files.\r\n\r\nThe problem I think is that there's not many Iceberg utilities to project anything other than partition filter to do the filtering .  I spent some time to look again, and tried to use time-travel which is effectively snapshot-filtering in  https://github.com/apache/iceberg/pull/4736 but unfortunately it didn't work as manifest table does not support it.  You can take a look if that also makes sense to pursue that path (to implement time-travel on manifest table).\r\n\r\nAnyway look forward to working together on this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121825416/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121831588","html_url":"https://github.com/apache/iceberg/pull/4733#issuecomment-1121831588","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4733","id":1121831588,"node_id":"IC_kwDOCW7NX85C3cqk","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T02:54:19Z","updated_at":"2022-05-10T02:54:19Z","author_association":"COLLABORATOR","body":"Sounds reasonable to me. Let me close this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121831588/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121907445","html_url":"https://github.com/apache/iceberg/pull/4703#issuecomment-1121907445","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4703","id":1121907445,"node_id":"IC_kwDOCW7NX85C3vL1","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T04:30:04Z","updated_at":"2022-05-10T04:30:04Z","author_association":"COLLABORATOR","body":"@rdblue , I think the change to remove position deletes references is related to this, so I put that change in the PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121907445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121970296","html_url":"https://github.com/apache/iceberg/issues/4713#issuecomment-1121970296","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4713","id":1121970296,"node_id":"IC_kwDOCW7NX85C3-h4","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T06:11:57Z","updated_at":"2022-05-10T06:11:57Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121970296/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121975217","html_url":"https://github.com/apache/iceberg/pull/4011#issuecomment-1121975217","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4011","id":1121975217,"node_id":"IC_kwDOCW7NX85C3_ux","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T06:19:41Z","updated_at":"2022-05-10T06:19:41Z","author_association":"CONTRIBUTOR","body":"Hi @SinghAsDev, I am happy to take this PR to closure. Can you please give access to your fork so that I can push new commits in your branch.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1121975217/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122037631","html_url":"https://github.com/apache/iceberg/pull/4714#issuecomment-1122037631","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4714","id":1122037631,"node_id":"IC_kwDOCW7NX85C4O9_","user":{"login":"ggershinsky","id":12033212,"node_id":"MDQ6VXNlcjEyMDMzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/12033212?v=4","gravatar_id":"","url":"https://api.github.com/users/ggershinsky","html_url":"https://github.com/ggershinsky","followers_url":"https://api.github.com/users/ggershinsky/followers","following_url":"https://api.github.com/users/ggershinsky/following{/other_user}","gists_url":"https://api.github.com/users/ggershinsky/gists{/gist_id}","starred_url":"https://api.github.com/users/ggershinsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggershinsky/subscriptions","organizations_url":"https://api.github.com/users/ggershinsky/orgs","repos_url":"https://api.github.com/users/ggershinsky/repos","events_url":"https://api.github.com/users/ggershinsky/events{/privacy}","received_events_url":"https://api.github.com/users/ggershinsky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T07:38:15Z","updated_at":"2022-05-10T07:38:15Z","author_association":"CONTRIBUTOR","body":"not any users, but org security experts, see eg our earlier docs at https://spark.apache.org/docs/latest/sql-data-sources-parquet.html#kms-client . Let us think a bit more about this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122037631/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122095762","html_url":"https://github.com/apache/iceberg/issues/1163#issuecomment-1122095762","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1163","id":1122095762,"node_id":"IC_kwDOCW7NX85C4dKS","user":{"login":"Niliria","id":39268464,"node_id":"MDQ6VXNlcjM5MjY4NDY0","avatar_url":"https://avatars.githubusercontent.com/u/39268464?v=4","gravatar_id":"","url":"https://api.github.com/users/Niliria","html_url":"https://github.com/Niliria","followers_url":"https://api.github.com/users/Niliria/followers","following_url":"https://api.github.com/users/Niliria/following{/other_user}","gists_url":"https://api.github.com/users/Niliria/gists{/gist_id}","starred_url":"https://api.github.com/users/Niliria/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Niliria/subscriptions","organizations_url":"https://api.github.com/users/Niliria/orgs","repos_url":"https://api.github.com/users/Niliria/repos","events_url":"https://api.github.com/users/Niliria/events{/privacy}","received_events_url":"https://api.github.com/users/Niliria/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T08:34:47Z","updated_at":"2022-05-10T08:34:47Z","author_association":"NONE","body":"So I'm just following the [Getting Started](https://iceberg.apache.org/getting-started/)\r\nApache-Hive-2.1.0\r\niceberg-hive-runtime-0.12.1.jar\r\nMetastore of Hive is deployed on the local Mysql server\r\n\r\nWhen I perform\r\n\r\n```\r\nSET iceberg.engine.hive.enabled=true;\r\nCREATE DATABASE IF NOT EXISTS iceberg_db;\r\nADD JAR /opt/software/hive/lib/iceberg-hive-runtime-0.12.1.jar;\r\nCREATE TABLE iceberg_db.test_2 (\r\n  id bigint,\r\n  name string\r\n)\r\nSTORED BY 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'\r\n;\r\n```\r\nJob exception：\r\n\r\n```\r\n2022-05-10T16:30:54,595 INFO  [HiveServer2-Background-Pool: Thread-15666]: ql.Driver (:()) - Executing command(queryId=root_20220510163054_4db7c534-2f5d-47db-b515-618f64aa0ecc): CREATE TABLE iceberg_db.test_3 (\r\n  id bigint,\r\n  name string\r\n)\r\nSTORED BY 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'\r\n2022-05-10T16:30:54,595 INFO  [HiveServer2-Background-Pool: Thread-15666]: ql.Driver (:()) - Starting task [Stage-0:DDL] in serial mode\r\n2022-05-10T16:30:54,595 INFO  [HiveServer2-Background-Pool: Thread-15666]: plan.CreateTableDesc (:()) - Use StorageHandler-supplied org.apache.iceberg.mr.hive.HiveIcebergSerDe for table test_3\r\n2022-05-10T16:30:54,596 INFO  [HiveServer2-Background-Pool: Thread-15666]: exec.DDLTask (:()) - creating table iceberg_db.test_3 on null\r\n2022-05-10T16:30:54,641 WARN  [HiveServer2-Background-Pool: Thread-15666]: conf.HiveConf (HiveConf.java:initialize(3683)) - HiveConf of name hive.metastore.event.db.notification.api.auth does not exist\r\n2022-05-10T16:30:54,641 WARN  [HiveServer2-Background-Pool: Thread-15666]: conf.HiveConf (HiveConf.java:initialize(3683)) - HiveConf of name hive.internal.ss.authz.settings.applied.marker does not exist\r\n2022-05-10T16:30:54,649 INFO  [ForkJoinPool.commonPool-worker-0]: hive.metastore (:()) - Closed a connection to metastore, current connections: 8\r\n2022-05-10T16:30:54,658 INFO  [HiveServer2-Background-Pool: Thread-15666]: hive.metastore (:()) - Trying to connect to metastore with URI thrift://master:9083\r\n2022-05-10T16:30:54,659 INFO  [HiveServer2-Background-Pool: Thread-15666]: hive.metastore (:()) - Opened a connection to metastore, current connections: 9\r\n2022-05-10T16:30:54,661 INFO  [HiveServer2-Background-Pool: Thread-15666]: hive.metastore (:()) - Connected to metastore.\r\n2022-05-10T16:30:54,666 INFO  [HiveServer2-Background-Pool: Thread-15666]: hive.HiveIcebergSerDe (:()) - Using hive schema {\"type\":\"struct\",\"schema-id\":0,\"fields\":[{\"id\":0,\"name\":\"id\",\"required\":false,\"type\":\"long\"},{\"id\":1,\"name\":\"name\",\"required\":false,\"type\":\"string\"}]}\r\n2022-05-10T16:30:54,667 INFO  [HiveServer2-Background-Pool: Thread-15666]: hive.HiveIcebergSerDe (:()) - Using hive schema {\"type\":\"struct\",\"schema-id\":0,\"fields\":[{\"id\":0,\"name\":\"id\",\"required\":false,\"type\":\"long\"},{\"id\":1,\"name\":\"name\",\"required\":false,\"type\":\"string\"}]}\r\n2022-05-10T16:30:54,819 WARN  [HiveServer2-Background-Pool: Thread-15666]: metastore.RetryingMetaStoreClient (:()) - MetaStoreClient lost connection. Attempting to reconnect.\r\norg.apache.thrift.transport.TTransportException\r\n        at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:132)\r\n        at org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)\r\n        at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:429)\r\n        at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:318)\r\n        at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:219)\r\n        at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:77)\r\n        at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.recv_lock(ThriftHiveMetastore.java:4549)\r\n        at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.lock(ThriftHiveMetastore.java:4536)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.lock(HiveMetaStoreClient.java:2104)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:150)\r\n        at com.sun.proxy.$Proxy22.lock(Unknown Source)\r\n        at org.apache.iceberg.hive.HiveTableOperations.lambda$acquireLock$7(HiveTableOperations.java:430)\r\n        at org.apache.iceberg.ClientPoolImpl.run(ClientPoolImpl.java:58)\r\n        at org.apache.iceberg.ClientPoolImpl.run(ClientPoolImpl.java:51)\r\n        at org.apache.iceberg.hive.CachedClientPool.run(CachedClientPool.java:76)\r\n        at org.apache.iceberg.hive.HiveTableOperations.acquireLock(HiveTableOperations.java:430)\r\n        at org.apache.iceberg.hive.HiveTableOperations.doCommit(HiveTableOperations.java:226)\r\n        at org.apache.iceberg.BaseMetastoreTableOperations.commit(BaseMetastoreTableOperations.java:127)\r\n        at org.apache.iceberg.BaseMetastoreCatalog$BaseMetastoreCatalogTableBuilder.create(BaseMetastoreCatalog.java:165)\r\n        at org.apache.iceberg.catalog.Catalog.createTable(Catalog.java:78)\r\n        at org.apache.iceberg.mr.Catalogs.createTable(Catalogs.java:165)\r\n        at org.apache.iceberg.mr.hive.HiveIcebergMetaHook.commitCreateTable(HiveIcebergMetaHook.java:147)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:738)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:724)\r\n        at sun.reflect.GeneratedMethodAccessor91.invoke(Unknown Source)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:154)\r\n        at com.sun.proxy.$Proxy22.createTable(Unknown Source)\r\n        at sun.reflect.GeneratedMethodAccessor91.invoke(Unknown Source)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient$SynchronizedHandler.invoke(HiveMetaStoreClient.java:2254)\r\n        at com.sun.proxy.$Proxy22.createTable(Unknown Source)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:830)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:845)\r\n        at org.apache.hadoop.hive.ql.exec.DDLTask.createTable(DDLTask.java:3979)\r\n        at org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:333)\r\n        at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:197)\r\n        at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:100)\r\n        at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1858)\r\n        at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1562)\r\n        at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1313)\r\n        at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1084)\r\n        at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1077)\r\n        at org.apache.hive.service.cli.operation.SQLOperation.runQuery(SQLOperation.java:235)\r\n        at org.apache.hive.service.cli.operation.SQLOperation.access$300(SQLOperation.java:90)\r\n        at org.apache.hive.service.cli.operation.SQLOperation$2$1.run(SQLOperation.java:299)\r\n        at java.security.AccessController.doPrivileged(Native Method)\r\n        at javax.security.auth.Subject.doAs(Subject.java:422)\r\n        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1698)\r\n        at org.apache.hive.service.cli.operation.SQLOperation$2.run(SQLOperation.java:312)\r\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n        at java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n        at java.lang.Thread.run(Thread.java:750)\r\n2022-05-10T16:30:55,819 INFO  [HiveServer2-Background-Pool: Thread-15666]: hive.metastore (:()) - Closed a connection to metastore, current connections: 8\r\n2022-05-10T16:30:55,819 INFO  [HiveServer2-Background-Pool: Thread-15666]: hive.metastore (:()) - Trying to connect to metastore with URI thrift://master:9083\r\n2022-05-10T16:30:55,819 INFO  [HiveServer2-Background-Pool: Thread-15666]: hive.metastore (:()) - Opened a connection to metastore, current connections: 9\r\n2022-05-10T16:30:55,820 INFO  [HiveServer2-Background-Pool: Thread-15666]: hive.metastore (:()) - Connected to metastore.\r\n2022-05-10T16:30:55,825 ERROR [HiveServer2-Background-Pool: Thread-15666]: exec.DDLTask (:()) - org.apache.hadoop.hive.ql.metadata.HiveException: java.lang.RuntimeException: Metastore operation failed for iceberg_db.test_3\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:840)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:845)\r\n        at org.apache.hadoop.hive.ql.exec.DDLTask.createTable(DDLTask.java:3979)\r\n        at org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:333)\r\n        at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:197)\r\n        at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:100)\r\n        at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1858)\r\n        at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1562)\r\n        at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1313)\r\n        at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1084)\r\n        at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1077)\r\n        at org.apache.hive.service.cli.operation.SQLOperation.runQuery(SQLOperation.java:235)\r\n        at org.apache.hive.service.cli.operation.SQLOperation.access$300(SQLOperation.java:90)\r\n        at org.apache.hive.service.cli.operation.SQLOperation$2$1.run(SQLOperation.java:299)\r\n        at java.security.AccessController.doPrivileged(Native Method)\r\n        at javax.security.auth.Subject.doAs(Subject.java:422)\r\n        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1698)\r\n        at org.apache.hive.service.cli.operation.SQLOperation$2.run(SQLOperation.java:312)\r\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n        at java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n        at java.lang.Thread.run(Thread.java:750)\r\nCaused by: java.lang.RuntimeException: Metastore operation failed for iceberg_db.test_3\r\n        at org.apache.iceberg.hive.HiveTableOperations.doCommit(HiveTableOperations.java:297)\r\n        at org.apache.iceberg.BaseMetastoreTableOperations.commit(BaseMetastoreTableOperations.java:127)\r\n        at org.apache.iceberg.BaseMetastoreCatalog$BaseMetastoreCatalogTableBuilder.create(BaseMetastoreCatalog.java:165)\r\n        at org.apache.iceberg.catalog.Catalog.createTable(Catalog.java:78)\r\n        at org.apache.iceberg.mr.Catalogs.createTable(Catalogs.java:165)\r\n        at org.apache.iceberg.mr.hive.HiveIcebergMetaHook.commitCreateTable(HiveIcebergMetaHook.java:147)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:738)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:724)\r\n        at sun.reflect.GeneratedMethodAccessor91.invoke(Unknown Source)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:154)\r\n        at com.sun.proxy.$Proxy22.createTable(Unknown Source)\r\n        at sun.reflect.GeneratedMethodAccessor91.invoke(Unknown Source)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient$SynchronizedHandler.invoke(HiveMetaStoreClient.java:2254)\r\n        at com.sun.proxy.$Proxy22.createTable(Unknown Source)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:830)\r\n        ... 22 more\r\nCaused by: org.apache.thrift.transport.TTransportException\r\n        at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:132)\r\n        at org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)\r\n        at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:429)\r\n        at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:318)\r\n        at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:219)\r\n        at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:77)\r\n        at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.recv_lock(ThriftHiveMetastore.java:4549)\r\n        at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.lock(ThriftHiveMetastore.java:4536)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.lock(HiveMetaStoreClient.java:2104)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:150)\r\n        at com.sun.proxy.$Proxy22.lock(Unknown Source)\r\n        at org.apache.iceberg.hive.HiveTableOperations.lambda$acquireLock$7(HiveTableOperations.java:430)\r\n        at org.apache.iceberg.ClientPoolImpl.run(ClientPoolImpl.java:58)\r\n        at org.apache.iceberg.ClientPoolImpl.run(ClientPoolImpl.java:51)\r\n        at org.apache.iceberg.hive.CachedClientPool.run(CachedClientPool.java:76)\r\n        at org.apache.iceberg.hive.HiveTableOperations.acquireLock(HiveTableOperations.java:430)\r\n        at org.apache.iceberg.hive.HiveTableOperations.doCommit(HiveTableOperations.java:226)\r\n        ... 40 more\r\n\r\n2022-05-10T16:30:55,825 ERROR [HiveServer2-Background-Pool: Thread-15666]: ql.Driver (:()) - FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. java.lang.RuntimeException: Metastore operation failed for iceberg_db.test_3\r\n2022-05-10T16:30:55,825 INFO  [HiveServer2-Background-Pool: Thread-15666]: ql.Driver (:()) - Completed executing command(queryId=root_20220510163054_4db7c534-2f5d-47db-b515-618f64aa0ecc); Time taken: 1.23 seconds\r\n2022-05-10T16:30:55,825 ERROR [HiveServer2-Background-Pool: Thread-15666]: operation.Operation (:()) - Error running hive query: \r\norg.apache.hive.service.cli.HiveSQLException: Error while processing statement: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. java.lang.RuntimeException: Metastore operation failed for iceberg_db.test_3\r\n        at org.apache.hive.service.cli.operation.Operation.toSQLException(Operation.java:387)\r\n        at org.apache.hive.service.cli.operation.SQLOperation.runQuery(SQLOperation.java:237)\r\n        at org.apache.hive.service.cli.operation.SQLOperation.access$300(SQLOperation.java:90)\r\n        at org.apache.hive.service.cli.operation.SQLOperation$2$1.run(SQLOperation.java:299)\r\n        at java.security.AccessController.doPrivileged(Native Method)\r\n        at javax.security.auth.Subject.doAs(Subject.java:422)\r\n        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1698)\r\n        at org.apache.hive.service.cli.operation.SQLOperation$2.run(SQLOperation.java:312)\r\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n        at java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n        at java.lang.Thread.run(Thread.java:750)\r\nCaused by: org.apache.hadoop.hive.ql.metadata.HiveException: java.lang.RuntimeException: Metastore operation failed for iceberg_db.test_3\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:840)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:845)\r\n        at org.apache.hadoop.hive.ql.exec.DDLTask.createTable(DDLTask.java:3979)\r\n        at org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:333)\r\n        at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:197)\r\n        at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:100)\r\n        at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1858)\r\n        at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1562)\r\n        at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1313)\r\n        at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1084)\r\n        at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1077)\r\n        at org.apache.hive.service.cli.operation.SQLOperation.runQuery(SQLOperation.java:235)\r\n        ... 11 more\r\nCaused by: java.lang.RuntimeException: Metastore operation failed for iceberg_db.test_3\r\n        at org.apache.iceberg.hive.HiveTableOperations.doCommit(HiveTableOperations.java:297)\r\n        at org.apache.iceberg.BaseMetastoreTableOperations.commit(BaseMetastoreTableOperations.java:127)\r\n        at org.apache.iceberg.BaseMetastoreCatalog$BaseMetastoreCatalogTableBuilder.create(BaseMetastoreCatalog.java:165)\r\n        at org.apache.iceberg.catalog.Catalog.createTable(Catalog.java:78)\r\n        at org.apache.iceberg.mr.Catalogs.createTable(Catalogs.java:165)\r\n        at org.apache.iceberg.mr.hive.HiveIcebergMetaHook.commitCreateTable(HiveIcebergMetaHook.java:147)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:738)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:724)\r\n        at sun.reflect.GeneratedMethodAccessor91.invoke(Unknown Source)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:154)\r\n        at com.sun.proxy.$Proxy22.createTable(Unknown Source)\r\n        at sun.reflect.GeneratedMethodAccessor91.invoke(Unknown Source)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient$SynchronizedHandler.invoke(HiveMetaStoreClient.java:2254)\r\n        at com.sun.proxy.$Proxy22.createTable(Unknown Source)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:830)\r\n        ... 22 more\r\nCaused by: org.apache.thrift.transport.TTransportException\r\n        at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:132)\r\n        at org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)\r\n        at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:429)\r\n        at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:318)\r\n        at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:219)\r\n        at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:77)\r\n        at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.recv_lock(ThriftHiveMetastore.java:4549)\r\n        at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.lock(ThriftHiveMetastore.java:4536)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.lock(HiveMetaStoreClient.java:2104)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:150)\r\n        at com.sun.proxy.$Proxy22.lock(Unknown Source)\r\n        at org.apache.iceberg.hive.HiveTableOperations.lambda$acquireLock$7(HiveTableOperations.java:430)\r\n        at org.apache.iceberg.ClientPoolImpl.run(ClientPoolImpl.java:58)\r\n        at org.apache.iceberg.ClientPoolImpl.run(ClientPoolImpl.java:51)\r\n        at org.apache.iceberg.hive.CachedClientPool.run(CachedClientPool.java:76)\r\n        at org.apache.iceberg.hive.HiveTableOperations.acquireLock(HiveTableOperations.java:430)\r\n        at org.apache.iceberg.hive.HiveTableOperations.doCommit(HiveTableOperations.java:226)\r\n        ... 40 more\r\n\r\n```\r\n<img width=\"1200\" alt=\"image\" src=\"https://user-images.githubusercontent.com/39268464/167585604-cdedb124-cafc-46d2-a65e-7ce5da534442.png\">\r\nThe metadata folder is created on HDFS；\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122095762/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122354604","html_url":"https://github.com/apache/iceberg/pull/4537#issuecomment-1122354604","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4537","id":1122354604,"node_id":"IC_kwDOCW7NX85C5cWs","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T12:56:10Z","updated_at":"2022-05-10T12:56:10Z","author_association":"MEMBER","body":"Superseded by https://github.com/apache/iceberg/pull/4741 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122354604/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122445001","html_url":"https://github.com/apache/iceberg/pull/4704#issuecomment-1122445001","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4704","id":1122445001,"node_id":"IC_kwDOCW7NX85C5ybJ","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T14:05:57Z","updated_at":"2022-05-10T14:05:57Z","author_association":"CONTRIBUTOR","body":"Thanks, @singhpk234 @rdblue for the reviewing, the code has been updated. Please take another look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122445001/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122559470","html_url":"https://github.com/apache/iceberg/pull/4741#issuecomment-1122559470","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4741","id":1122559470,"node_id":"IC_kwDOCW7NX85C6OXu","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T15:40:10Z","updated_at":"2022-05-10T15:40:10Z","author_association":"CONTRIBUTOR","body":"@findepi, I think this is too big to go in on its own. Can you split it into separate PRs for different parts?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122559470/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122564086","html_url":"https://github.com/apache/iceberg/pull/4726#issuecomment-1122564086","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4726","id":1122564086,"node_id":"IC_kwDOCW7NX85C6Pf2","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T15:44:26Z","updated_at":"2022-05-10T15:44:26Z","author_association":"CONTRIBUTOR","body":"Thanks for this! This change looks good to me","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122564086/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122661884","html_url":"https://github.com/apache/iceberg/pull/4705#issuecomment-1122661884","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4705","id":1122661884,"node_id":"IC_kwDOCW7NX85C6nX8","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T17:14:40Z","updated_at":"2022-05-10T17:14:40Z","author_association":"CONTRIBUTOR","body":"@rdblue, filed this mainly for sharing. I will close this first, and we can always file separated new PRs if we want to merge this into master.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122661884/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122694244","html_url":"https://github.com/apache/iceberg/pull/4708#issuecomment-1122694244","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4708","id":1122694244,"node_id":"IC_kwDOCW7NX85C6vRk","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T17:48:44Z","updated_at":"2022-05-10T17:48:44Z","author_association":"CONTRIBUTOR","body":"@rdblue, @aokolnychyi and me have planned a separated PR for the CDC scan API, which will be more general, can be used across engines.\r\n\r\n> What if we had a separate API for helpers like this that wasn't called \"actions\"?\r\n\r\nIs the helper the CDC scan API, or an abstract(interface) of the CDC action and the CDC scan API? I think the later makes more sense, which I image is a pretty thin layer. Is it necessary?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122694244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122819688","html_url":"https://github.com/apache/iceberg/pull/4704#issuecomment-1122819688","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4704","id":1122819688,"node_id":"IC_kwDOCW7NX85C7N5o","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T20:16:28Z","updated_at":"2022-05-10T20:16:28Z","author_association":"CONTRIBUTOR","body":"Thanks, @ConeyLiu!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122819688/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122820136","html_url":"https://github.com/apache/iceberg/pull/4741#issuecomment-1122820136","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4741","id":1122820136,"node_id":"IC_kwDOCW7NX85C7OAo","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T20:17:01Z","updated_at":"2022-05-10T20:17:01Z","author_association":"MEMBER","body":"@rdblue i have this split. https://github.com/apache/iceberg/pull/4537 has already been reviewed.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122820136/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122826826","html_url":"https://github.com/apache/iceberg/issues/4168#issuecomment-1122826826","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4168","id":1122826826,"node_id":"IC_kwDOCW7NX85C7PpK","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T20:25:07Z","updated_at":"2022-05-10T20:25:07Z","author_association":"CONTRIBUTOR","body":"From the stack trace, it looks like this is a failure during part upload, but that should result in an abort of the upload request.  It may be the case that the abort is happening, but it's possible that we're not throwing in the failed part upload path here: https://github.com/apache/iceberg/blob/master/aws/src/main/java/org/apache/iceberg/aws/s3/S3OutputStream.java#L317","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1122826826/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123000990","html_url":"https://github.com/apache/iceberg/issues/4168#issuecomment-1123000990","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4168","id":1123000990,"node_id":"IC_kwDOCW7NX85C76Ke","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T23:14:27Z","updated_at":"2022-05-10T23:14:27Z","author_association":"CONTRIBUTOR","body":"I did a little investigation and this should actually be handled correctly.  The completable future is [joined on](https://github.com/apache/iceberg/blob/master/aws/src/main/java/org/apache/iceberg/aws/s3/S3OutputStream.java#L331) which will propagate the exception up prior to closing the stream.  I'm not clear how a task could have completed successfully without hitting this error unless it is an issue higher up in Flink. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123000990/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123013430","html_url":"https://github.com/apache/iceberg/pull/4722#issuecomment-1123013430","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4722","id":1123013430,"node_id":"IC_kwDOCW7NX85C79M2","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T23:34:20Z","updated_at":"2022-05-10T23:34:20Z","author_association":"COLLABORATOR","body":"Thanks @ajantha-bhat ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123013430/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123025380","html_url":"https://github.com/apache/iceberg/issues/4168#issuecomment-1123025380","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4168","id":1123025380,"node_id":"IC_kwDOCW7NX85C8AHk","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-10T23:57:45Z","updated_at":"2022-05-10T23:57:45Z","author_association":"CONTRIBUTOR","body":"@szehon-ho Flink doesn't do any abort cleanup that delete data files when commit failed. \r\n\r\nFrom the stack trace, it seems that the staging/part file was not found in local disk (tmp dir). How could that happen? disk full? but even if disk is full, we also need a bug somewhere that prevents the error from bubbling up. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123025380/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123039815","html_url":"https://github.com/apache/iceberg/issues/4168#issuecomment-1123039815","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4168","id":1123039815,"node_id":"IC_kwDOCW7NX85C8DpH","user":{"login":"krisdas","id":5305131,"node_id":"MDQ6VXNlcjUzMDUxMzE=","avatar_url":"https://avatars.githubusercontent.com/u/5305131?v=4","gravatar_id":"","url":"https://api.github.com/users/krisdas","html_url":"https://github.com/krisdas","followers_url":"https://api.github.com/users/krisdas/followers","following_url":"https://api.github.com/users/krisdas/following{/other_user}","gists_url":"https://api.github.com/users/krisdas/gists{/gist_id}","starred_url":"https://api.github.com/users/krisdas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/krisdas/subscriptions","organizations_url":"https://api.github.com/users/krisdas/orgs","repos_url":"https://api.github.com/users/krisdas/repos","events_url":"https://api.github.com/users/krisdas/events{/privacy}","received_events_url":"https://api.github.com/users/krisdas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T00:21:47Z","updated_at":"2022-05-11T00:21:47Z","author_association":"CONTRIBUTOR","body":"@stevenzwu as far i remember, we searched for any logs saying, disk is full or the staging file was not created due to x reason. but we couldn't find anything on that line.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123039815/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123063285","html_url":"https://github.com/apache/iceberg/pull/4670#issuecomment-1123063285","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4670","id":1123063285,"node_id":"IC_kwDOCW7NX85C8JX1","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T00:57:58Z","updated_at":"2022-05-11T00:57:58Z","author_association":"COLLABORATOR","body":"@kbendick， Now 1.13 is in. Do we still need port 1.15 as well?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123063285/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123078157","html_url":"https://github.com/apache/iceberg/pull/4738#issuecomment-1123078157","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4738","id":1123078157,"node_id":"IC_kwDOCW7NX85C8NAN","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T01:23:00Z","updated_at":"2022-05-11T01:23:00Z","author_association":"COLLABORATOR","body":"@RussellSpitzer, Is this change OK for you? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123078157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123084596","html_url":"https://github.com/apache/iceberg/pull/4704#issuecomment-1123084596","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4704","id":1123084596,"node_id":"IC_kwDOCW7NX85C8Ok0","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T01:34:54Z","updated_at":"2022-05-11T01:34:54Z","author_association":"CONTRIBUTOR","body":"Thanks all for the review.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123084596/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123094275","html_url":"https://github.com/apache/iceberg/issues/4743#issuecomment-1123094275","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4743","id":1123094275,"node_id":"IC_kwDOCW7NX85C8Q8D","user":{"login":"caesar168","id":4076070,"node_id":"MDQ6VXNlcjQwNzYwNzA=","avatar_url":"https://avatars.githubusercontent.com/u/4076070?v=4","gravatar_id":"","url":"https://api.github.com/users/caesar168","html_url":"https://github.com/caesar168","followers_url":"https://api.github.com/users/caesar168/followers","following_url":"https://api.github.com/users/caesar168/following{/other_user}","gists_url":"https://api.github.com/users/caesar168/gists{/gist_id}","starred_url":"https://api.github.com/users/caesar168/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/caesar168/subscriptions","organizations_url":"https://api.github.com/users/caesar168/orgs","repos_url":"https://api.github.com/users/caesar168/repos","events_url":"https://api.github.com/users/caesar168/events{/privacy}","received_events_url":"https://api.github.com/users/caesar168/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T01:56:30Z","updated_at":"2022-05-11T02:00:13Z","author_association":"NONE","body":"my flink cluster running on k8s。\r\nHadoop was not deployed at all, and the hadoop runtime files were placed in the lib directory. Hive-metastore is working fine, and Hadoop 3.2.2 is deployed on the image. HMS running on k8s too.\r\n\r\nflink lib dir：\r\ncommons-logging-1.1.3.jar                  flink-shaded-zookeeper-3.4.14.jar               jdo-api-3.2.jar\r\ndatanucleus-api-jdo-5.2.7.jar              flink-sql-client_2.12-1.14.4.jar                log4j-1.2-api-2.17.1.jar\r\ndatanucleus-core-5.2.7.jar                 flink-sql-connector-hive-3.1.2_2.12-1.14.4.jar  log4j-api-2.17.1.jar\r\ndatanucleus-jdo-query-5.0.9.jar            flink-sql-connector-postgres-cdc-2.2.0.jar      log4j-core-2.17.1.jar\r\nflink-csv-1.14.4.jar                       flink-table_2.12-1.14.4.jar                     log4j-slf4j-impl-2.17.1.jar\r\nflink-dist_2.12-1.14.4.jar                 hadoop-client-api-3.2.2.jar                     metrics-core-3.2.2.jar\r\nflink-json-1.14.4.jar                      hadoop-client-runtime-3.2.2.jar                 sql-client-defaults.yaml\r\nflink-python_2.12-1.14.4.jar               iceberg-flink-runtime-1.14-0.13.1.jar\r\nflink-shaded-hadoop-2-uber-2.8.3-10.0.jar  iceberg-hive-runtime-0.13.1.jar","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123094275/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123145909","html_url":"https://github.com/apache/iceberg/issues/4735#issuecomment-1123145909","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4735","id":1123145909,"node_id":"IC_kwDOCW7NX85C8di1","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T03:39:06Z","updated_at":"2022-05-11T03:39:06Z","author_association":"CONTRIBUTOR","body":"- Drop Non empty table  can use `DROP TABLE prod.db.sample`\r\n- Drop empty table shoule must use `DROP TABLE prod.db.sample PURGE`\r\n\r\nI think we should add this description in spark-ddl/#drop-table","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123145909/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123154656","html_url":"https://github.com/apache/iceberg/issues/4735#issuecomment-1123154656","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4735","id":1123154656,"node_id":"IC_kwDOCW7NX85C8frg","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T03:53:48Z","updated_at":"2022-05-11T03:53:48Z","author_association":"CONTRIBUTOR","body":"@yittg @kbendick ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123154656/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123161762","html_url":"https://github.com/apache/iceberg/issues/4168#issuecomment-1123161762","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4168","id":1123161762,"node_id":"IC_kwDOCW7NX85C8hai","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T04:09:13Z","updated_at":"2022-05-11T04:09:13Z","author_association":"CONTRIBUTOR","body":"@krisdas do you have the complete stack trace?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123161762/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123231802","html_url":"https://github.com/apache/iceberg/pull/4725#issuecomment-1123231802","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4725","id":1123231802,"node_id":"IC_kwDOCW7NX85C8yg6","user":{"login":"wuwenchi","id":19755729,"node_id":"MDQ6VXNlcjE5NzU1NzI5","avatar_url":"https://avatars.githubusercontent.com/u/19755729?v=4","gravatar_id":"","url":"https://api.github.com/users/wuwenchi","html_url":"https://github.com/wuwenchi","followers_url":"https://api.github.com/users/wuwenchi/followers","following_url":"https://api.github.com/users/wuwenchi/following{/other_user}","gists_url":"https://api.github.com/users/wuwenchi/gists{/gist_id}","starred_url":"https://api.github.com/users/wuwenchi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wuwenchi/subscriptions","organizations_url":"https://api.github.com/users/wuwenchi/orgs","repos_url":"https://api.github.com/users/wuwenchi/repos","events_url":"https://api.github.com/users/wuwenchi/events{/privacy}","received_events_url":"https://api.github.com/users/wuwenchi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T06:21:12Z","updated_at":"2022-05-11T06:21:12Z","author_association":"CONTRIBUTOR","body":"Can you help check it ? Thx! @kbendick ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123231802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123240640","html_url":"https://github.com/apache/iceberg/pull/4670#issuecomment-1123240640","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4670","id":1123240640,"node_id":"IC_kwDOCW7NX85C80rA","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T06:33:53Z","updated_at":"2022-05-11T06:33:53Z","author_association":"COLLABORATOR","body":"@kbendick @rdblue , Can we include this in the 0.13.2 release? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123240640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123302319","html_url":"https://github.com/apache/iceberg/pull/4651#issuecomment-1123302319","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4651","id":1123302319,"node_id":"IC_kwDOCW7NX85C9Duv","user":{"login":"southernriver","id":20614350,"node_id":"MDQ6VXNlcjIwNjE0MzUw","avatar_url":"https://avatars.githubusercontent.com/u/20614350?v=4","gravatar_id":"","url":"https://api.github.com/users/southernriver","html_url":"https://github.com/southernriver","followers_url":"https://api.github.com/users/southernriver/followers","following_url":"https://api.github.com/users/southernriver/following{/other_user}","gists_url":"https://api.github.com/users/southernriver/gists{/gist_id}","starred_url":"https://api.github.com/users/southernriver/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/southernriver/subscriptions","organizations_url":"https://api.github.com/users/southernriver/orgs","repos_url":"https://api.github.com/users/southernriver/repos","events_url":"https://api.github.com/users/southernriver/events{/privacy}","received_events_url":"https://api.github.com/users/southernriver/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T07:44:58Z","updated_at":"2022-05-11T07:44:58Z","author_association":"CONTRIBUTOR","body":"@szehon-ho @kbendick  Thanks for the review, code has been updated.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123302319/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123452873","html_url":"https://github.com/apache/iceberg/pull/4011#issuecomment-1123452873","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4011","id":1123452873,"node_id":"IC_kwDOCW7NX85C9ofJ","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T09:43:03Z","updated_at":"2022-05-11T09:43:03Z","author_association":"CONTRIBUTOR","body":"Thanks, @SinghAsDev for providing the access! I will resolve the pending review comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123452873/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123727784","html_url":"https://github.com/apache/iceberg/pull/4011#issuecomment-1123727784","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4011","id":1123727784,"node_id":"IC_kwDOCW7NX85C-rmo","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T12:57:10Z","updated_at":"2022-05-11T12:57:10Z","author_association":"CONTRIBUTOR","body":"Ping @rdblue @kbendick @singhpk234 for review.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123727784/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123867490","html_url":"https://github.com/apache/iceberg/pull/4518#issuecomment-1123867490","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4518","id":1123867490,"node_id":"IC_kwDOCW7NX85C_Nti","user":{"login":"rizaon","id":6033430,"node_id":"MDQ6VXNlcjYwMzM0MzA=","avatar_url":"https://avatars.githubusercontent.com/u/6033430?v=4","gravatar_id":"","url":"https://api.github.com/users/rizaon","html_url":"https://github.com/rizaon","followers_url":"https://api.github.com/users/rizaon/followers","following_url":"https://api.github.com/users/rizaon/following{/other_user}","gists_url":"https://api.github.com/users/rizaon/gists{/gist_id}","starred_url":"https://api.github.com/users/rizaon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rizaon/subscriptions","organizations_url":"https://api.github.com/users/rizaon/orgs","repos_url":"https://api.github.com/users/rizaon/repos","events_url":"https://api.github.com/users/rizaon/events{/privacy}","received_events_url":"https://api.github.com/users/rizaon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T14:42:40Z","updated_at":"2022-05-11T14:42:40Z","author_association":"CONTRIBUTOR","body":"Hi @danielcweeks @rdblue , can I get a follow up review on this PR please?\r\n\r\nI think we have not fully agree on how to decide which file to cache (regex vs specific callsite). I decided to go with regex approach in [dec17e2](https://github.com/apache/iceberg/pull/4518/commits/dec17e2c7d88b972c7d1c817c2cbe66322482146) because there are many callsites in Iceberg core that open metadata files. Please let me know how I can improve this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123867490/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123946420","html_url":"https://github.com/apache/iceberg/pull/4674#issuecomment-1123946420","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4674","id":1123946420,"node_id":"IC_kwDOCW7NX85C_g-0","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T15:42:37Z","updated_at":"2022-05-11T15:42:37Z","author_association":"MEMBER","body":"@RussellSpitzer , @szehon-ho : What you guys think about this PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123946420/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123959424","html_url":"https://github.com/apache/iceberg/pull/4674#issuecomment-1123959424","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4674","id":1123959424,"node_id":"IC_kwDOCW7NX85C_kKA","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T15:55:26Z","updated_at":"2022-05-11T15:55:26Z","author_association":"MEMBER","body":"> @RussellSpitzer, @szehon-ho, @aokolnychyi: PR is ready for review.\r\n> \r\n> a) I tested with local file system and local test case in IDE, without cache (22ms), with cache (18ms) with 1000 manifest list files to read. Not so much difference, probably because it is local file system. As PR avoids reading manifest list files again (verified with logs), in S3 file system probably better difference can be seen with huge number of snapshots.\r\n> \r\n> ```\r\n> @Test\r\n>   public void testExpireSnapshotUsingNamedArgs() {\r\n>     sql(\"CREATE TABLE %s (id bigint NOT NULL, data string) USING iceberg\", tableName);\r\n> \r\n>     for (int i = 0; i < 1000; i++) {\r\n>       sql(\"INSERT INTO TABLE %s VALUES (1, 'a')\", tableName);\r\n>     }\r\n> \r\n>     Table table = validationCatalog.loadTable(tableIdent);\r\n> \r\n>     Assert.assertEquals(\"Should be 1000 snapshots\", 1000, Iterables.size(table.snapshots()));\r\n> \r\n>     waitUntilAfter(table.currentSnapshot().timestampMillis());\r\n> \r\n>     Timestamp currentTimestamp = Timestamp.from(Instant.ofEpochMilli(System.currentTimeMillis()));\r\n> \r\n>     long time = System.currentTimeMillis();\r\n> \r\n>     List<Object[]> output = sql(\r\n>         \"CALL %s.system.expire_snapshots(\" +\r\n>             \"older_than => TIMESTAMP '%s',\" +\r\n>             \"table => '%s',\" +\r\n>             \"retain_last => 999, use_caching => false)\",\r\n>         catalogName, currentTimestamp, tableIdent);\r\n> \r\n>     System.out.println(\"time taken in ms: \" + (System.currentTimeMillis() - time));\r\n>   }\r\n> \r\n>   time taken in ms: 18478  -- with cache\r\n>   time taken in ms: 22589  -- without cache\r\n> ```\r\n> \r\n> **b) Also in the base code I found we use caching for `RewriteManifestsProcedure`, so I used the same pattern and syntax (keeping cache as default).** Also found a bug in the base code and raised PR #4722\r\n> \r\n> c) I have some more plans for improving the `expire_snaphots` (different idea than #3457), I will work in the subsequent PR.\r\n> \r\n> Idea is that add a new column \"from_snapshot_id\" while preparing the actual files, then filter out (NOT IN filter) the expired snapshot ids rows from persisted output (without scanning again) and then same logic of df.except() to find the expired files.\r\n\r\nThe benchmarks really need to be on datasets that take in the \"minutes\" to run if we really want to see the difference. The key would be to setup a test with thousands or tens of thousands of manifests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123959424/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123985563","html_url":"https://github.com/apache/iceberg/pull/4710#issuecomment-1123985563","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4710","id":1123985563,"node_id":"IC_kwDOCW7NX85C_qib","user":{"login":"jzhuge","id":1883812,"node_id":"MDQ6VXNlcjE4ODM4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1883812?v=4","gravatar_id":"","url":"https://api.github.com/users/jzhuge","html_url":"https://github.com/jzhuge","followers_url":"https://api.github.com/users/jzhuge/followers","following_url":"https://api.github.com/users/jzhuge/following{/other_user}","gists_url":"https://api.github.com/users/jzhuge/gists{/gist_id}","starred_url":"https://api.github.com/users/jzhuge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzhuge/subscriptions","organizations_url":"https://api.github.com/users/jzhuge/orgs","repos_url":"https://api.github.com/users/jzhuge/repos","events_url":"https://api.github.com/users/jzhuge/events{/privacy}","received_events_url":"https://api.github.com/users/jzhuge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T16:21:01Z","updated_at":"2022-05-11T16:21:01Z","author_association":"MEMBER","body":"Ah, didn't know this is deliberate. My only goal is to make test code cleaner, especially not to use `Schema.toString`.\r\n\r\nI guest test code can use `sameSchema` or just compare `asStruct` outputs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123985563/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123987528","html_url":"https://github.com/apache/iceberg/pull/4710#issuecomment-1123987528","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4710","id":1123987528,"node_id":"IC_kwDOCW7NX85C_rBI","user":{"login":"jzhuge","id":1883812,"node_id":"MDQ6VXNlcjE4ODM4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1883812?v=4","gravatar_id":"","url":"https://api.github.com/users/jzhuge","html_url":"https://github.com/jzhuge","followers_url":"https://api.github.com/users/jzhuge/followers","following_url":"https://api.github.com/users/jzhuge/following{/other_user}","gists_url":"https://api.github.com/users/jzhuge/gists{/gist_id}","starred_url":"https://api.github.com/users/jzhuge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzhuge/subscriptions","organizations_url":"https://api.github.com/users/jzhuge/orgs","repos_url":"https://api.github.com/users/jzhuge/repos","events_url":"https://api.github.com/users/jzhuge/events{/privacy}","received_events_url":"https://api.github.com/users/jzhuge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T16:23:00Z","updated_at":"2022-05-11T16:23:00Z","author_association":"MEMBER","body":"Rejecting this PR in a few days if no further comment.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123987528/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123994197","html_url":"https://github.com/apache/iceberg/issues/4168#issuecomment-1123994197","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4168","id":1123994197,"node_id":"IC_kwDOCW7NX85C_spV","user":{"login":"krisdas","id":5305131,"node_id":"MDQ6VXNlcjUzMDUxMzE=","avatar_url":"https://avatars.githubusercontent.com/u/5305131?v=4","gravatar_id":"","url":"https://api.github.com/users/krisdas","html_url":"https://github.com/krisdas","followers_url":"https://api.github.com/users/krisdas/followers","following_url":"https://api.github.com/users/krisdas/following{/other_user}","gists_url":"https://api.github.com/users/krisdas/gists{/gist_id}","starred_url":"https://api.github.com/users/krisdas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/krisdas/subscriptions","organizations_url":"https://api.github.com/users/krisdas/orgs","repos_url":"https://api.github.com/users/krisdas/repos","events_url":"https://api.github.com/users/krisdas/events{/privacy}","received_events_url":"https://api.github.com/users/krisdas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T16:29:42Z","updated_at":"2022-05-11T16:29:42Z","author_association":"CONTRIBUTOR","body":"Unfortunately that's all we have now. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1123994197/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124035602","html_url":"https://github.com/apache/iceberg/pull/4750#issuecomment-1124035602","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4750","id":1124035602,"node_id":"IC_kwDOCW7NX85C_2wS","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T17:16:19Z","updated_at":"2022-05-11T18:15:37Z","author_association":"COLLABORATOR","body":"@rdblue can you see if this is what you meant in this comment https://github.com/apache/iceberg/pull/3015#discussion_r735838832?  Wasn't entirely sure","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124035602/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124043302","html_url":"https://github.com/apache/iceberg/issues/4749#issuecomment-1124043302","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4749","id":1124043302,"node_id":"IC_kwDOCW7NX85C_4om","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T17:20:39Z","updated_at":"2022-05-11T17:20:39Z","author_association":"COLLABORATOR","body":"Do you mean just add it to the ContentFile API?  Maybe it can be done without changing the spec much, like https://github.com/apache/iceberg/pull/1317 ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124043302/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124244241","html_url":"https://github.com/apache/iceberg/pull/4747#issuecomment-1124244241","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4747","id":1124244241,"node_id":"IC_kwDOCW7NX85DApsR","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T20:12:38Z","updated_at":"2022-05-11T20:12:38Z","author_association":"CONTRIBUTOR","body":"Looks like what's happening is that the snapshot is never added. It hits this check: https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/TableMetadata.java#L984-L985\r\n\r\nI think we can fix this by changing `SnapshotProducer`:\r\n\r\n```diff\r\n+ while (snapshotId == null || ops.current().snapshot(snapshotId) != null) {\r\n- if (snapshotId != null) {\r\n    this.snapshotId = ops.newSnapshotId();\r\n  }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124244241/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124296011","html_url":"https://github.com/apache/iceberg/pull/4745#issuecomment-1124296011","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4745","id":1124296011,"node_id":"IC_kwDOCW7NX85DA2VL","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T21:07:20Z","updated_at":"2022-05-11T21:07:59Z","author_association":"CONTRIBUTOR","body":"Looking at the function passed to the pool ([get_scans_for_manifest](https://github.com/apache/iceberg/blob/master/python_legacy/iceberg/core/data_table_scan.py#L79)) I can understand how this improves the parsing and evaluator logic. For the avro file reads, I'm not sure but I'd expect this would scale better with multithreading since that's I/O bound. @Fokko is it possible that threading may be better here beyond a certain number of files?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124296011/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124320264","html_url":"https://github.com/apache/iceberg/pull/4569#issuecomment-1124320264","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4569","id":1124320264,"node_id":"IC_kwDOCW7NX85DA8QI","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T21:41:13Z","updated_at":"2022-05-11T21:41:13Z","author_association":"COLLABORATOR","body":"@kbendick @rdblue can this backport go in for 0.13.2?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124320264/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124329911","html_url":"https://github.com/apache/iceberg/pull/4734#issuecomment-1124329911","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4734","id":1124329911,"node_id":"IC_kwDOCW7NX85DA-m3","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T21:54:59Z","updated_at":"2022-05-11T21:54:59Z","author_association":"MEMBER","body":"cc @openinx because he was reviewed there and gave some comments on that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124329911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124377865","html_url":"https://github.com/apache/iceberg/pull/4745#issuecomment-1124377865","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4745","id":1124377865,"node_id":"IC_kwDOCW7NX85DBKUJ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-11T23:21:47Z","updated_at":"2022-05-11T23:21:47Z","author_association":"CONTRIBUTOR","body":"Sorry, I didn't mean to close this. That was an accident.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124377865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124477315","html_url":"https://github.com/apache/iceberg/pull/4519#issuecomment-1124477315","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4519","id":1124477315,"node_id":"IC_kwDOCW7NX85DBimD","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T02:55:46Z","updated_at":"2022-05-12T02:55:46Z","author_association":"CONTRIBUTOR","body":"As Flink 1.12 has been removed form master, this should likely be cherry-picked directly onto the branch for Flink release-base-0.13 or generally only targeting 0.13.2 and any later patch releases in the 0.13.x series (which are not likely to happen).\r\n\r\ncc @rdblue @nastra throwing an exception in Flink for 0.13.2 has been changed to logging an error.\r\n\r\nPlease let me know if you'd like anything changed =)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124477315/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124479173","html_url":"https://github.com/apache/iceberg/pull/4726#issuecomment-1124479173","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4726","id":1124479173,"node_id":"IC_kwDOCW7NX85DBjDF","user":{"login":"ebyhr","id":6237050,"node_id":"MDQ6VXNlcjYyMzcwNTA=","avatar_url":"https://avatars.githubusercontent.com/u/6237050?v=4","gravatar_id":"","url":"https://api.github.com/users/ebyhr","html_url":"https://github.com/ebyhr","followers_url":"https://api.github.com/users/ebyhr/followers","following_url":"https://api.github.com/users/ebyhr/following{/other_user}","gists_url":"https://api.github.com/users/ebyhr/gists{/gist_id}","starred_url":"https://api.github.com/users/ebyhr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ebyhr/subscriptions","organizations_url":"https://api.github.com/users/ebyhr/orgs","repos_url":"https://api.github.com/users/ebyhr/repos","events_url":"https://api.github.com/users/ebyhr/events{/privacy}","received_events_url":"https://api.github.com/users/ebyhr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T03:00:23Z","updated_at":"2022-05-13T00:35:08Z","author_association":"CONTRIBUTOR","body":"@amogh-jahagirdar Could you run workflow if you have the permission? \r\n\r\ncc: @jackye1995 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124479173/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124479258","html_url":"https://github.com/apache/iceberg/pull/4246#issuecomment-1124479258","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4246","id":1124479258,"node_id":"IC_kwDOCW7NX85DBjEa","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T03:00:34Z","updated_at":"2022-05-12T03:00:34Z","author_association":"CONTRIBUTOR","body":"short-term, the transformation to ResolvedTable maintains certain compatibility in API.\r\nAs [FLIP-164](https://cwiki.apache.org/confluence/display/FLINK/FLIP-164%3A+Improve+Schema+Handling+in+Catalogs) mentioned by @kbendick said:\r\n> Since TableSchema is a hybrid of both, it would not be a smooth experience in any case.\r\n> It is saver and more user-friendly to build up a separate stack with better class hierarchy in correct package.\r\n\r\nIn order to better evolve in the future, in my humble opinion, it is necessary to add `ResolvedSchema` and related content support, . For ex, we currently have some PR that wants to add computed Colums and other new features to Iceberg-Flink.\r\n\r\nOf course, the updated related to `Schema`\\`ResolvedSchema` are more underlying architecture changes, is not directly visible.\r\n\r\nIn @Wuwenchi 's PR, try to perform the transition action early and explicitly. I think it's a good idea to try this transformation and it will give us some convenience, we can change very little code to provide better compatibility.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124479258/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124517496","html_url":"https://github.com/apache/iceberg/issues/4740#issuecomment-1124517496","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4740","id":1124517496,"node_id":"IC_kwDOCW7NX85DBsZ4","user":{"login":"myeh3","id":86508922,"node_id":"MDQ6VXNlcjg2NTA4OTIy","avatar_url":"https://avatars.githubusercontent.com/u/86508922?v=4","gravatar_id":"","url":"https://api.github.com/users/myeh3","html_url":"https://github.com/myeh3","followers_url":"https://api.github.com/users/myeh3/followers","following_url":"https://api.github.com/users/myeh3/following{/other_user}","gists_url":"https://api.github.com/users/myeh3/gists{/gist_id}","starred_url":"https://api.github.com/users/myeh3/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/myeh3/subscriptions","organizations_url":"https://api.github.com/users/myeh3/orgs","repos_url":"https://api.github.com/users/myeh3/repos","events_url":"https://api.github.com/users/myeh3/events{/privacy}","received_events_url":"https://api.github.com/users/myeh3/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T04:27:20Z","updated_at":"2022-05-12T04:27:20Z","author_association":"NONE","body":"Met the same issue today!!!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124517496/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124535536","html_url":"https://github.com/apache/iceberg/pull/4519#issuecomment-1124535536","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4519","id":1124535536,"node_id":"IC_kwDOCW7NX85DBwzw","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T05:10:02Z","updated_at":"2022-05-12T05:10:02Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @nastra the requested changes have been made =)\r\n\r\nI also ran `./gradlew clean -DflinkVersions=1.12,1.13,1.14  build -x javadoc -x integrationTest` and it ran to completion successfully (keep in mind 1.12 isn't in master CI - though it will be in your cherry-pick branch).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124535536/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124580527","html_url":"https://github.com/apache/iceberg/pull/4569#issuecomment-1124580527","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4569","id":1124580527,"node_id":"IC_kwDOCW7NX85DB7yv","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T06:29:46Z","updated_at":"2022-05-12T06:29:46Z","author_association":"CONTRIBUTOR","body":"Yes, at first glance I do think they both should be backported.\r\n\r\nThe release manager is @nastra fyi, but I personally think if people are encountering this and it’s an obvious bug, we backport it.\r\n\r\nI’d personally also like to see #3411 backported, as I’ve recently encountered issues on partition summaries using the void transform (which could be unrelated to both as I need to take a closer look): https://github.com/apache/iceberg/issues/4689\r\n\r\nBut if it’s ready I don’t see why not. Any ideas on a possible timeline for both? I know that’s highly dependent on things you can’t control, but we’ve admittedly delayed 0.13.2 for quite some time.\r\n\r\nTLDR - On first pass I would think to include both. But I do have some concerns around holding up the release too much.\r\n\r\nI’ll spend time on a proper pass over this tomorrow :)\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124580527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124581152","html_url":"https://github.com/apache/iceberg/pull/4519#issuecomment-1124581152","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4519","id":1124581152,"node_id":"IC_kwDOCW7NX85DB78g","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T06:30:51Z","updated_at":"2022-05-12T06:30:51Z","author_association":"CONTRIBUTOR","body":"I changed the base of this to be 0.13.x.\r\n\r\nWill work on fixes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124581152/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124582828","html_url":"https://github.com/apache/iceberg/pull/4519#issuecomment-1124582828","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4519","id":1124582828,"node_id":"IC_kwDOCW7NX85DB8Ws","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T06:33:31Z","updated_at":"2022-05-12T06:33:31Z","author_association":"CONTRIBUTOR","body":"> I changed the base of this to be 0.13.x.\r\n> Will work on fixes.\r\n\r\nJust kidding! Changing the target branch to `0.13.x` from `master` made the diff massive. I'll open a new PR and apply a patch from here to there.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124582828/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124596346","html_url":"https://github.com/apache/iceberg/pull/4745#issuecomment-1124596346","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4745","id":1124596346,"node_id":"IC_kwDOCW7NX85DB_p6","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T06:46:00Z","updated_at":"2022-05-12T06:46:00Z","author_association":"CONTRIBUTOR","body":"@samredai \r\n\r\n> Looking at the function passed to the pool ([get_scans_for_manifest](https://github.com/apache/iceberg/blob/master/python_legacy/iceberg/core/data_table_scan.py#L79)) I can understand how this improves the parsing and evaluator logic. For the avro file reads, I'm not sure but I'd expect this would scale better with multithreading since that's I/O bound. @Fokko is it possible that threading may be better here beyond a certain number of files?\r\n\r\nI think it would make sense to parallelize that as well to reduce the runtime of the function. Especially if we need to fetch files from external storage that introduces some latency, I would parallelize that kind of calls as well to improve overall throughput.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124596346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124658216","html_url":"https://github.com/apache/iceberg/pull/4755#issuecomment-1124658216","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4755","id":1124658216,"node_id":"IC_kwDOCW7NX85DCOwo","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T08:01:21Z","updated_at":"2022-05-12T08:01:21Z","author_association":"MEMBER","body":"Extracted from https://github.com/apache/iceberg/pull/4741 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124658216/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124663159","html_url":"https://github.com/apache/iceberg/pull/4537#issuecomment-1124663159","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4537","id":1124663159,"node_id":"IC_kwDOCW7NX85DCP93","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T08:06:24Z","updated_at":"2022-05-12T08:06:24Z","author_association":"MEMBER","body":"Reopened per discussion on slack: https://apache-iceberg.slack.com/archives/C02TZ3NMBRC/p1652299433000019","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124663159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124709680","html_url":"https://github.com/apache/iceberg/pull/4752#issuecomment-1124709680","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4752","id":1124709680,"node_id":"IC_kwDOCW7NX85DCbUw","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T08:53:53Z","updated_at":"2022-05-12T08:53:53Z","author_association":"CONTRIBUTOR","body":"This is more concise, I think if correct other version(v1.13 v1.14) should be also changed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124709680/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124741049","html_url":"https://github.com/apache/iceberg/pull/4537#issuecomment-1124741049","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4537","id":1124741049,"node_id":"IC_kwDOCW7NX85DCi-5","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T09:25:38Z","updated_at":"2022-05-12T09:25:38Z","author_association":"MEMBER","body":"Thanks @rdblue for a detailed review!\r\n\r\nApplied comments except for API change https://github.com/apache/iceberg/pull/4537#discussion_r870916478 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124741049/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124750138","html_url":"https://github.com/apache/iceberg/pull/4752#issuecomment-1124750138","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4752","id":1124750138,"node_id":"IC_kwDOCW7NX85DClM6","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T09:32:44Z","updated_at":"2022-05-12T09:33:14Z","author_association":"CONTRIBUTOR","body":"> This is more concise, I think if correct other version(v1.13 v1.14) should be also changed.\r\n\r\nYes, agree with you @felixYyu . However, I prefer one PR to focus on issues in the main version and another PR to migrate changes to other versions.  Of course, this change is minor, I can also include the modifications for all versions, thx. 😄 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124750138/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124769091","html_url":"https://github.com/apache/iceberg/pull/4747#issuecomment-1124769091","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4747","id":1124769091,"node_id":"IC_kwDOCW7NX85DCp1D","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T09:41:50Z","updated_at":"2022-05-12T09:41:50Z","author_association":"MEMBER","body":" > I think we can fix this by changing SnapshotProducer:\r\n\r\n@rdblue: Fixed it as per your suggestion. I too expected this kind of check initially.\r\n\r\nShould we do this check at the commit time and throw exception? Now, concurrent table operation getting (both are uncommitted) getting the same snapshot id is not handled I guess. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124769091/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124803124","html_url":"https://github.com/apache/iceberg/issues/4424#issuecomment-1124803124","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4424","id":1124803124,"node_id":"IC_kwDOCW7NX85DCyI0","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T10:02:56Z","updated_at":"2022-05-12T10:02:56Z","author_association":"CONTRIBUTOR","body":"hadoop catalog load with snapshot-id must use the format `prod.db.sample`, I'll close this issue.\r\n\r\n```\r\nval resultDF = spark.read.format(\"iceberg\").option(\"snapshot-id\", 6918368735882469773L)\r\n      .load(\"hadoop_prod.wmsb.wms_do\")\r\n    resultDF.show(false)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124803124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124806955","html_url":"https://github.com/apache/iceberg/issues/4563#issuecomment-1124806955","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4563","id":1124806955,"node_id":"IC_kwDOCW7NX85DCzEr","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T10:07:07Z","updated_at":"2022-05-12T10:07:46Z","author_association":"CONTRIBUTOR","body":"Could you test this case with the refer PR if you have time? @swapz-z @alexjo2144 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124806955/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124891437","html_url":"https://github.com/apache/iceberg/pull/4747#issuecomment-1124891437","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4747","id":1124891437,"node_id":"IC_kwDOCW7NX85DDHst","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T11:45:04Z","updated_at":"2022-05-12T11:45:04Z","author_association":"MEMBER","body":"> Now, concurrent table operation getting (both are uncommitted) getting the same snapshot id is not handled I guess.\r\n\r\nHandled concurrent scenario by throwing validation exception in TableMetadata preparation.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124891437/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124922465","html_url":"https://github.com/apache/iceberg/issues/4740#issuecomment-1124922465","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4740","id":1124922465,"node_id":"IC_kwDOCW7NX85DDPRh","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T12:19:38Z","updated_at":"2022-05-12T12:19:38Z","author_association":"CONTRIBUTOR","body":"Is there anything in the HMS logs for this timeframe?\r\n\r\nAlso Hive 2.3.9 would be recommended. I think I have seen several issues with Hive 2.1.0 already (but not specifically this one).\r\n\r\nAlso if you feel brave enough, you can try Hive 4.0.0-alpha-1, as it has more comprehensive Iceberg support,","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124922465/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124959842","html_url":"https://github.com/apache/iceberg/issues/4740#issuecomment-1124959842","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4740","id":1124959842,"node_id":"IC_kwDOCW7NX85DDYZi","user":{"login":"Niliria","id":39268464,"node_id":"MDQ6VXNlcjM5MjY4NDY0","avatar_url":"https://avatars.githubusercontent.com/u/39268464?v=4","gravatar_id":"","url":"https://api.github.com/users/Niliria","html_url":"https://github.com/Niliria","followers_url":"https://api.github.com/users/Niliria/followers","following_url":"https://api.github.com/users/Niliria/following{/other_user}","gists_url":"https://api.github.com/users/Niliria/gists{/gist_id}","starred_url":"https://api.github.com/users/Niliria/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Niliria/subscriptions","organizations_url":"https://api.github.com/users/Niliria/orgs","repos_url":"https://api.github.com/users/Niliria/repos","events_url":"https://api.github.com/users/Niliria/events{/privacy}","received_events_url":"https://api.github.com/users/Niliria/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T12:56:24Z","updated_at":"2022-05-12T12:56:24Z","author_association":"NONE","body":"> Is there anything in the HMS logs for this timeframe?\r\n> \r\n> Also Hive 2.3.9 would be recommended. I think I have seen several issues with Hive 2.1.0 already (but not specifically this one).\r\n> \r\n> Also if you feel brave enough, you can try Hive 4.0.0-alpha-1, as it has more comprehensive Iceberg support,\r\n\r\n\r\n\r\nThank you very much for your reply! \r\nToday I tried again in the current Hive version, but the result still failed; \r\nI can't find any more error messages. According to the HMS log information, all I can know is about metaStore connection failure, but if I directly create a hive table, it is successful, so I don't know what the problem is\r\nThe complete log is as follows:\r\n\r\n```\r\n2022-05-12T20:45:31,510 INFO  [HiveServer2-Handler-Pool: Thread-2423]: ql.Driver (:()) - Compiling command(queryId=root_20220512204531_9bce01ff-5a63-44fd-bc37-df442fed368f): CREATE TABLE test_5(\r\n    id INT\r\n    ,name STRING\r\n)\r\nSTORED BY 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'\r\n2022-05-12T20:45:31,510 INFO  [HiveServer2-Handler-Pool: Thread-2423]: parse.CalcitePlanner (:()) - Starting Semantic Analysis\r\n2022-05-12T20:45:31,510 INFO  [HiveServer2-Handler-Pool: Thread-2423]: parse.CalcitePlanner (:()) - Creating table iceberg_test.test_5 position=13\r\n2022-05-12T20:45:31,512 INFO  [HiveServer2-Handler-Pool: Thread-2423]: sqlstd.SQLStdHiveAccessController (:()) - Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=d7695262-4414-47af-8c29-58f99da236f3, clientType=HIVESERVER2]\r\n2022-05-12T20:45:31,512 INFO  [HiveServer2-Handler-Pool: Thread-2423]: ql.Driver (:()) - Semantic Analysis Completed\r\n2022-05-12T20:45:31,512 INFO  [HiveServer2-Handler-Pool: Thread-2423]: ql.Driver (:()) - Returning Hive schema: Schema(fieldSchemas:null, properties:null)\r\n2022-05-12T20:45:31,512 INFO  [HiveServer2-Handler-Pool: Thread-2423]: ql.Driver (:()) - Completed compiling command(queryId=root_20220512204531_9bce01ff-5a63-44fd-bc37-df442fed368f); Time taken: 0.002 seconds\r\n2022-05-12T20:45:31,516 INFO  [d7695262-4414-47af-8c29-58f99da236f3 HiveServer2-Handler-Pool: Thread-2423]: conf.HiveConf (HiveConf.java:getLogIdVar(3511)) - Using the default value passed in for log id: d7695262-4414-47af-8c29-58f99da236f3\r\n2022-05-12T20:45:31,516 INFO  [HiveServer2-Handler-Pool: Thread-2423]: session.SessionState (:()) - Resetting thread name to  HiveServer2-Handler-Pool: Thread-2423\r\n2022-05-12T20:45:31,522 INFO  [HiveServer2-Background-Pool: Thread-7328]: ql.Driver (:()) - Concurrency mode is disabled, not creating a lock manager\r\n2022-05-12T20:45:31,522 INFO  [HiveServer2-Background-Pool: Thread-7328]: ql.Driver (:()) - Executing command(queryId=root_20220512204531_9bce01ff-5a63-44fd-bc37-df442fed368f): CREATE TABLE test_5(\r\n    id INT\r\n    ,name STRING\r\n)\r\nSTORED BY 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'\r\n2022-05-12T20:45:31,522 INFO  [HiveServer2-Background-Pool: Thread-7328]: ql.Driver (:()) - Starting task [Stage-0:DDL] in serial mode\r\n2022-05-12T20:45:31,522 INFO  [HiveServer2-Background-Pool: Thread-7328]: plan.CreateTableDesc (:()) - Use StorageHandler-supplied org.apache.iceberg.mr.hive.HiveIcebergSerDe for table test_5\r\n2022-05-12T20:45:31,523 INFO  [HiveServer2-Background-Pool: Thread-7328]: exec.DDLTask (:()) - creating table iceberg_test.test_5 on null\r\n2022-05-12T20:45:31,637 WARN  [HiveServer2-Background-Pool: Thread-7328]: conf.HiveConf (HiveConf.java:initialize(3683)) - HiveConf of name hive.metastore.event.db.notification.api.auth does not exist\r\n2022-05-12T20:45:31,637 WARN  [HiveServer2-Background-Pool: Thread-7328]: conf.HiveConf (HiveConf.java:initialize(3683)) - HiveConf of name hive.internal.ss.authz.settings.applied.marker does not exist\r\n2022-05-12T20:45:31,653 INFO  [ForkJoinPool.commonPool-worker-1]: hive.metastore (:()) - Closed a connection to metastore, current connections: 4\r\n2022-05-12T20:45:31,679 INFO  [HiveServer2-Background-Pool: Thread-7328]: hive.metastore (:()) - Trying to connect to metastore with URI thrift://master:9083\r\n2022-05-12T20:45:31,679 INFO  [HiveServer2-Background-Pool: Thread-7328]: hive.metastore (:()) - Opened a connection to metastore, current connections: 5\r\n2022-05-12T20:45:31,686 INFO  [HiveServer2-Background-Pool: Thread-7328]: hive.metastore (:()) - Connected to metastore.\r\n2022-05-12T20:45:31,691 INFO  [HiveServer2-Background-Pool: Thread-7328]: hive.HiveIcebergSerDe (:()) - Using hive schema {\"type\":\"struct\",\"schema-id\":0,\"fields\":[{\"id\":0,\"name\":\"id\",\"required\":false,\"type\":\"int\"},{\"id\":1,\"name\":\"name\",\"required\":false,\"type\":\"string\"}]}\r\n2022-05-12T20:45:31,700 INFO  [HiveServer2-Background-Pool: Thread-7328]: hive.HiveIcebergSerDe (:()) - Using hive schema {\"type\":\"struct\",\"schema-id\":0,\"fields\":[{\"id\":0,\"name\":\"id\",\"required\":false,\"type\":\"int\"},{\"id\":1,\"name\":\"name\",\"required\":false,\"type\":\"string\"}]}\r\n2022-05-12T20:45:31,795 INFO  [HiveServer2-Background-Pool: Thread-7328]: hive.metastore (:()) - Closed a connection to metastore, current connections: 4\r\n2022-05-12T20:45:31,795 INFO  [HiveServer2-Background-Pool: Thread-7328]: hive.metastore (:()) - Trying to connect to metastore with URI thrift://master:9083\r\n2022-05-12T20:45:31,795 INFO  [HiveServer2-Background-Pool: Thread-7328]: hive.metastore (:()) - Opened a connection to metastore, current connections: 5\r\n2022-05-12T20:45:31,804 INFO  [HiveServer2-Background-Pool: Thread-7328]: hive.metastore (:()) - Connected to metastore.\r\n2022-05-12T20:45:31,807 ERROR [HiveServer2-Background-Pool: Thread-7328]: exec.DDLTask (:()) - org.apache.hadoop.hive.ql.metadata.HiveException: java.lang.RuntimeException: Metastore operation failed for iceberg_test.test_5\r\n    at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:840)\r\n    at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:845)\r\n    at org.apache.hadoop.hive.ql.exec.DDLTask.createTable(DDLTask.java:3979)\r\n    at org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:333)\r\n    at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:197)\r\n    at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:100)\r\n    at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1858)\r\n    at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1562)\r\n    at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1313)\r\n    at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1084)\r\n    at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1077)\r\n    at org.apache.hive.service.cli.operation.SQLOperation.runQuery(SQLOperation.java:235)\r\n    at org.apache.hive.service.cli.operation.SQLOperation.access$300(SQLOperation.java:90)\r\n    at org.apache.hive.service.cli.operation.SQLOperation$2$1.run(SQLOperation.java:299)\r\n    at java.security.AccessController.doPrivileged(Native Method)\r\n    at javax.security.auth.Subject.doAs(Subject.java:422)\r\n    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1698)\r\n    at org.apache.hive.service.cli.operation.SQLOperation$2.run(SQLOperation.java:312)\r\n    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n    at java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n    at java.lang.Thread.run(Thread.java:750)\r\nCaused by: java.lang.RuntimeException: Metastore operation failed for iceberg_test.test_5\r\n    at org.apache.iceberg.hive.HiveTableOperations.doCommit(HiveTableOperations.java:284)\r\n    at org.apache.iceberg.BaseMetastoreTableOperations.commit(BaseMetastoreTableOperations.java:126)\r\n    at org.apache.iceberg.BaseMetastoreCatalog$BaseMetastoreCatalogTableBuilder.create(BaseMetastoreCatalog.java:216)\r\n    at org.apache.iceberg.BaseMetastoreCatalog.createTable(BaseMetastoreCatalog.java:49)\r\n    at org.apache.iceberg.mr.Catalogs.createTable(Catalogs.java:165)\r\n    at org.apache.iceberg.mr.hive.HiveIcebergMetaHook.commitCreateTable(HiveIcebergMetaHook.java:147)\r\n    at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:738)\r\n    at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:724)\r\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n    at java.lang.reflect.Method.invoke(Method.java:498)\r\n    at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:154)\r\n    at com.sun.proxy.$Proxy22.createTable(Unknown Source)\r\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n    at java.lang.reflect.Method.invoke(Method.java:498)\r\n    at org.apache.hadoop.hive.metastore.HiveMetaStoreClient$SynchronizedHandler.invoke(HiveMetaStoreClient.java:2254)\r\n    at com.sun.proxy.$Proxy22.createTable(Unknown Source)\r\n    at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:830)\r\n    ... 22 more\r\nCaused by: org.apache.thrift.transport.TTransportException\r\n    at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:132)\r\n    at org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)\r\n    at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:429)\r\n    at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:318)\r\n    at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:219)\r\n    at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:77)\r\n    at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.recv_lock(ThriftHiveMetastore.java:4549)\r\n    at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.lock(ThriftHiveMetastore.java:4536)\r\n    at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.lock(HiveMetaStoreClient.java:2104)\r\n    at org.apache.iceberg.hive.HiveTableOperations.lambda$acquireLock$7(HiveTableOperations.java:413)\r\n    at org.apache.iceberg.ClientPoolImpl.run(ClientPoolImpl.java:62)\r\n    at org.apache.iceberg.hive.CachedClientPool.run(CachedClientPool.java:76)\r\n    at org.apache.iceberg.hive.HiveTableOperations.acquireLock(HiveTableOperations.java:413)\r\n    at org.apache.iceberg.hive.HiveTableOperations.doCommit(HiveTableOperations.java:217)\r\n    ... 42 more\r\n\r\n2022-05-12T20:45:31,807 ERROR [HiveServer2-Background-Pool: Thread-7328]: ql.Driver (:()) - FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. java.lang.RuntimeException: Metastore operation failed for iceberg_test.test_5\r\n2022-05-12T20:45:31,807 INFO  [HiveServer2-Background-Pool: Thread-7328]: ql.Driver (:()) - Completed executing command(queryId=root_20220512204531_9bce01ff-5a63-44fd-bc37-df442fed368f); Time taken: 0.285 seconds\r\n2022-05-12T20:45:31,808 ERROR [HiveServer2-Background-Pool: Thread-7328]: operation.Operation (:()) - Error running hive query: \r\norg.apache.hive.service.cli.HiveSQLException: Error while processing statement: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. java.lang.RuntimeException: Metastore operation failed for iceberg_test.test_5\r\n    at org.apache.hive.service.cli.operation.Operation.toSQLException(Operation.java:387)\r\n    at org.apache.hive.service.cli.operation.SQLOperation.runQuery(SQLOperation.java:237)\r\n    at org.apache.hive.service.cli.operation.SQLOperation.access$300(SQLOperation.java:90)\r\n    at org.apache.hive.service.cli.operation.SQLOperation$2$1.run(SQLOperation.java:299)\r\n    at java.security.AccessController.doPrivileged(Native Method)\r\n    at javax.security.auth.Subject.doAs(Subject.java:422)\r\n    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1698)\r\n    at org.apache.hive.service.cli.operation.SQLOperation$2.run(SQLOperation.java:312)\r\n    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n    at java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n    at java.lang.Thread.run(Thread.java:750)\r\nCaused by: org.apache.hadoop.hive.ql.metadata.HiveException: java.lang.RuntimeException: Metastore operation failed for iceberg_test.test_5\r\n    at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:840)\r\n    at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:845)\r\n    at org.apache.hadoop.hive.ql.exec.DDLTask.createTable(DDLTask.java:3979)\r\n    at org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:333)\r\n    at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:197)\r\n    at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:100)\r\n    at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1858)\r\n    at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1562)\r\n    at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1313)\r\n    at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1084)\r\n    at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1077)\r\n    at org.apache.hive.service.cli.operation.SQLOperation.runQuery(SQLOperation.java:235)\r\n    ... 11 more\r\nCaused by: java.lang.RuntimeException: Metastore operation failed for iceberg_test.test_5\r\n    at org.apache.iceberg.hive.HiveTableOperations.doCommit(HiveTableOperations.java:284)\r\n    at org.apache.iceberg.BaseMetastoreTableOperations.commit(BaseMetastoreTableOperations.java:126)\r\n    at org.apache.iceberg.BaseMetastoreCatalog$BaseMetastoreCatalogTableBuilder.create(BaseMetastoreCatalog.java:216)\r\n    at org.apache.iceberg.BaseMetastoreCatalog.createTable(BaseMetastoreCatalog.java:49)\r\n    at org.apache.iceberg.mr.Catalogs.createTable(Catalogs.java:165)\r\n    at org.apache.iceberg.mr.hive.HiveIcebergMetaHook.commitCreateTable(HiveIcebergMetaHook.java:147)\r\n    at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:738)\r\n    at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:724)\r\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n    at java.lang.reflect.Method.invoke(Method.java:498)\r\n    at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:154)\r\n    at com.sun.proxy.$Proxy22.createTable(Unknown Source)\r\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n    at java.lang.reflect.Method.invoke(Method.java:498)\r\n    at org.apache.hadoop.hive.metastore.HiveMetaStoreClient$SynchronizedHandler.invoke(HiveMetaStoreClient.java:2254)\r\n    at com.sun.proxy.$Proxy22.createTable(Unknown Source)\r\n    at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:830)\r\n    ... 22 more\r\nCaused by: org.apache.thrift.transport.TTransportException\r\n    at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:132)\r\n    at org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)\r\n    at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:429)\r\n    at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:318)\r\n    at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:219)\r\n    at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:77)\r\n    at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.recv_lock(ThriftHiveMetastore.java:4549)\r\n    at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.lock(ThriftHiveMetastore.java:4536)\r\n    at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.lock(HiveMetaStoreClient.java:2104)\r\n    at org.apache.iceberg.hive.HiveTableOperations.lambda$acquireLock$7(HiveTableOperations.java:413)\r\n    at org.apache.iceberg.ClientPoolImpl.run(ClientPoolImpl.java:62)\r\n    at org.apache.iceberg.hive.CachedClientPool.run(CachedClientPool.java:76)\r\n    at org.apache.iceberg.hive.HiveTableOperations.acquireLock(HiveTableOperations.java:413)\r\n    at org.apache.iceberg.hive.HiveTableOperations.doCommit(HiveTableOperations.java:217)\r\n    ... 42 more\r\n\r\n```\r\n\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124959842/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124960867","html_url":"https://github.com/apache/iceberg/issues/4740#issuecomment-1124960867","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4740","id":1124960867,"node_id":"IC_kwDOCW7NX85DDYpj","user":{"login":"Niliria","id":39268464,"node_id":"MDQ6VXNlcjM5MjY4NDY0","avatar_url":"https://avatars.githubusercontent.com/u/39268464?v=4","gravatar_id":"","url":"https://api.github.com/users/Niliria","html_url":"https://github.com/Niliria","followers_url":"https://api.github.com/users/Niliria/followers","following_url":"https://api.github.com/users/Niliria/following{/other_user}","gists_url":"https://api.github.com/users/Niliria/gists{/gist_id}","starred_url":"https://api.github.com/users/Niliria/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Niliria/subscriptions","organizations_url":"https://api.github.com/users/Niliria/orgs","repos_url":"https://api.github.com/users/Niliria/repos","events_url":"https://api.github.com/users/Niliria/events{/privacy}","received_events_url":"https://api.github.com/users/Niliria/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T12:57:30Z","updated_at":"2022-05-12T12:57:30Z","author_association":"NONE","body":"> Met the same issue today!!!\r\n\r\nThis is a bad problem, and I don't want to fix it by changing the Hive version\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124960867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124973804","html_url":"https://github.com/apache/iceberg/issues/4740#issuecomment-1124973804","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4740","id":1124973804,"node_id":"IC_kwDOCW7NX85DDbzs","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T13:09:17Z","updated_at":"2022-05-12T13:09:17Z","author_association":"CONTRIBUTOR","body":"@Niliria: The log you have provided is HiveServer2 logs. This part of the Exception shows, that there is an issue with communicating with the HiveMetastore. Specifically when calling the `lock` method in HMS. The `TransportException` shows that the issue is on transport level (or unexpected error on server side). You might get more info in the HMS logs.\r\n\r\n```\r\nCaused by: org.apache.thrift.transport.TTransportException\r\n    at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:132)\r\n    at org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)\r\n    at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:429)\r\n    at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:318)\r\n    at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:219)\r\n    at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:77)\r\n    at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.recv_lock(ThriftHiveMetastore.java:4549)\r\n    at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.lock(ThriftHiveMetastore.java:4536)\r\n    at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.lock(HiveMetaStoreClient.java:2104)\r\n    at org.apache.iceberg.hive.HiveTableOperations.lambda$acquireLock$7(HiveTableOperations.java:413)\r\n    at org.apache.iceberg.ClientPoolImpl.run(ClientPoolImpl.java:62)\r\n    at org.apache.iceberg.hive.CachedClientPool.run(CachedClientPool.java:76)\r\n    at org.apache.iceberg.hive.HiveTableOperations.acquireLock(HiveTableOperations.java:413)\r\n    at org.apache.iceberg.hive.HiveTableOperations.doCommit(HiveTableOperations.java:217)\r\n    ... 42 more\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1124973804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1125061308","html_url":"https://github.com/apache/iceberg/pull/4754#issuecomment-1125061308","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4754","id":1125061308,"node_id":"IC_kwDOCW7NX85DDxK8","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T14:24:41Z","updated_at":"2022-05-12T14:24:41Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1125061308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1125062111","html_url":"https://github.com/apache/iceberg/pull/4519#issuecomment-1125062111","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4519","id":1125062111,"node_id":"IC_kwDOCW7NX85DDxXf","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T14:25:23Z","updated_at":"2022-05-12T14:25:23Z","author_association":"CONTRIBUTOR","body":"I merged the warning PR, so I don't think there is any more to do here. I'll close this one. Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1125062111/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1125098416","html_url":"https://github.com/apache/iceberg/pull/4662#issuecomment-1125098416","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4662","id":1125098416,"node_id":"IC_kwDOCW7NX85DD6Ow","user":{"login":"szlta","id":40628386,"node_id":"MDQ6VXNlcjQwNjI4Mzg2","avatar_url":"https://avatars.githubusercontent.com/u/40628386?v=4","gravatar_id":"","url":"https://api.github.com/users/szlta","html_url":"https://github.com/szlta","followers_url":"https://api.github.com/users/szlta/followers","following_url":"https://api.github.com/users/szlta/following{/other_user}","gists_url":"https://api.github.com/users/szlta/gists{/gist_id}","starred_url":"https://api.github.com/users/szlta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szlta/subscriptions","organizations_url":"https://api.github.com/users/szlta/orgs","repos_url":"https://api.github.com/users/szlta/repos","events_url":"https://api.github.com/users/szlta/events{/privacy}","received_events_url":"https://api.github.com/users/szlta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-12T14:56:20Z","updated_at":"2022-05-12T14:56:20Z","author_association":"CONTRIBUTOR","body":"@szehon-ho I think we were probably talking about the same thing for generating no new ID for a PartitionField that was already seen. I have amended my change based on this. I looked into this question in some detail and have found that this is actually kind of already happening when we are removing part of the PartitionFields:\r\n\r\n- we start with\r\n`spec0: 1000: identity(a), 1001: identity(b)`\r\n- then if update the spec so that only `b` remains, `a` doesn't get reassigned a new fieldID, although we do create a new spec:\r\n`spec1: 1000: identity(a)`\r\n- now if we re-add `b` and `c`, then `b` would get assigned ID 1002 and `c` would get ID 1003\r\n- I propose we look through in the past specs to see if `b` as partition field already participated (based on transform function and source IDs) and recycle the old ID, so we end up with:\r\n`spec2: 1000: identity(a), 1001: identity(b), 1002: identity(c)`\r\n\r\nLooking at the tests this should work, there's only one failure I get now in `TestMetadataTableScans.testFilesTableScanWithDroppedPartition`:\r\n```\r\nExpected :struct<1000: data_bucket: optional int, 1001: data_bucket_16: optional int, 1002: data_trunc_2: optional string>\r\nActual   :struct<1000: data_bucket_16: optional int, 1001: data_trunc_2: optional string>\r\n```\r\n\r\nThis made me think though.. it seems like we have two different ways of generating the partition field column name:\r\nhttps://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/BaseUpdatePartitionSpec.java#L460 generates `data_bucket_16`, while\r\nhttps://github.com/apache/iceberg/blob/master/api/src/main/java/org/apache/iceberg/PartitionSpec.java#L484 generates `data_bucket`. Does anyone know why this discrepancy exists? My gut feeling is that the former would be the correct way.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1125098416/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]