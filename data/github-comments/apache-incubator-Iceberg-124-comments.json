[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/958552599","html_url":"https://github.com/apache/iceberg/pull/3456#issuecomment-958552599","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3456","id":958552599,"node_id":"IC_kwDOCW7NX845IloX","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T00:44:05Z","updated_at":"2021-11-03T00:44:05Z","author_association":"CONTRIBUTOR","body":"cc @wypoon @pan3793 @kbendick @flyrain @karuppayya @szehon-ho @rdblue @RussellSpitzer @jackye1995","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/958552599/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/958593759","html_url":"https://github.com/apache/iceberg/pull/3392#issuecomment-958593759","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3392","id":958593759,"node_id":"IC_kwDOCW7NX845Ivrf","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T01:51:39Z","updated_at":"2021-11-03T01:51:39Z","author_association":"MEMBER","body":"@pvary  thanks for your time to debug this. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/958593759/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/958596105","html_url":"https://github.com/apache/iceberg/pull/3457#issuecomment-958596105","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3457","id":958596105,"node_id":"IC_kwDOCW7NX845IwQJ","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T02:00:13Z","updated_at":"2021-11-03T02:00:26Z","author_association":"COLLABORATOR","body":"I'm going to try to do some simple benchmarks to validate it improves the perf, but putting the idea out here for any early feedback","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/958596105/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/958603988","html_url":"https://github.com/apache/iceberg/issues/3401#issuecomment-958603988","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3401","id":958603988,"node_id":"IC_kwDOCW7NX845IyLU","user":{"login":"yyanyy","id":71906210,"node_id":"MDQ6VXNlcjcxOTA2MjEw","avatar_url":"https://avatars.githubusercontent.com/u/71906210?v=4","gravatar_id":"","url":"https://api.github.com/users/yyanyy","html_url":"https://github.com/yyanyy","followers_url":"https://api.github.com/users/yyanyy/followers","following_url":"https://api.github.com/users/yyanyy/following{/other_user}","gists_url":"https://api.github.com/users/yyanyy/gists{/gist_id}","starred_url":"https://api.github.com/users/yyanyy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyanyy/subscriptions","organizations_url":"https://api.github.com/users/yyanyy/orgs","repos_url":"https://api.github.com/users/yyanyy/repos","events_url":"https://api.github.com/users/yyanyy/events{/privacy}","received_events_url":"https://api.github.com/users/yyanyy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T02:23:17Z","updated_at":"2021-11-03T02:23:17Z","author_association":"CONTRIBUTOR","body":"I think `write.data.path` is a new thing introduced in #3094 but we did not update table property related doc, potentially because this change is currently not in any official release yet","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/958603988/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/958686405","html_url":"https://github.com/apache/iceberg/pull/2642#issuecomment-958686405","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2642","id":958686405,"node_id":"IC_kwDOCW7NX845JGTF","user":{"login":"jshmchenxi","id":11854435,"node_id":"MDQ6VXNlcjExODU0NDM1","avatar_url":"https://avatars.githubusercontent.com/u/11854435?v=4","gravatar_id":"","url":"https://api.github.com/users/jshmchenxi","html_url":"https://github.com/jshmchenxi","followers_url":"https://api.github.com/users/jshmchenxi/followers","following_url":"https://api.github.com/users/jshmchenxi/following{/other_user}","gists_url":"https://api.github.com/users/jshmchenxi/gists{/gist_id}","starred_url":"https://api.github.com/users/jshmchenxi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jshmchenxi/subscriptions","organizations_url":"https://api.github.com/users/jshmchenxi/orgs","repos_url":"https://api.github.com/users/jshmchenxi/repos","events_url":"https://api.github.com/users/jshmchenxi/events{/privacy}","received_events_url":"https://api.github.com/users/jshmchenxi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T06:37:05Z","updated_at":"2021-11-03T06:38:30Z","author_association":"CONTRIBUTOR","body":"Sorry for the late reply, I was busy with something else. I've rebased the code and please help review it. I have time to complete the feature now. And thanks for reminding me! @huaxingao @ConeyLiu ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/958686405/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/958689208","html_url":"https://github.com/apache/iceberg/issues/3417#issuecomment-958689208","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3417","id":958689208,"node_id":"IC_kwDOCW7NX845JG-4","user":{"login":"hzluting","id":5558252,"node_id":"MDQ6VXNlcjU1NTgyNTI=","avatar_url":"https://avatars.githubusercontent.com/u/5558252?v=4","gravatar_id":"","url":"https://api.github.com/users/hzluting","html_url":"https://github.com/hzluting","followers_url":"https://api.github.com/users/hzluting/followers","following_url":"https://api.github.com/users/hzluting/following{/other_user}","gists_url":"https://api.github.com/users/hzluting/gists{/gist_id}","starred_url":"https://api.github.com/users/hzluting/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hzluting/subscriptions","organizations_url":"https://api.github.com/users/hzluting/orgs","repos_url":"https://api.github.com/users/hzluting/repos","events_url":"https://api.github.com/users/hzluting/events{/privacy}","received_events_url":"https://api.github.com/users/hzluting/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T06:45:46Z","updated_at":"2021-11-03T06:45:46Z","author_association":"CONTRIBUTOR","body":"what's the logic of the merge job? Did you expire and clean the old snapshot when your merge job completed?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/958689208/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/958691189","html_url":"https://github.com/apache/iceberg/pull/2642#issuecomment-958691189","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2642","id":958691189,"node_id":"IC_kwDOCW7NX845JHd1","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T06:51:57Z","updated_at":"2021-11-03T06:51:57Z","author_association":"CONTRIBUTOR","body":"Thanks for rebasing the code! @jshmchenxi \r\n\r\ncc @aokolnychyi @RussellSpitzer @flyrain Could you please take a look when you have time? Thanks a lot in advance!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/958691189/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/958774636","html_url":"https://github.com/apache/iceberg/issues/2676#issuecomment-958774636","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2676","id":958774636,"node_id":"IC_kwDOCW7NX845Jb1s","user":{"login":"kingeasternsun","id":5291739,"node_id":"MDQ6VXNlcjUyOTE3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/5291739?v=4","gravatar_id":"","url":"https://api.github.com/users/kingeasternsun","html_url":"https://github.com/kingeasternsun","followers_url":"https://api.github.com/users/kingeasternsun/followers","following_url":"https://api.github.com/users/kingeasternsun/following{/other_user}","gists_url":"https://api.github.com/users/kingeasternsun/gists{/gist_id}","starred_url":"https://api.github.com/users/kingeasternsun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingeasternsun/subscriptions","organizations_url":"https://api.github.com/users/kingeasternsun/orgs","repos_url":"https://api.github.com/users/kingeasternsun/repos","events_url":"https://api.github.com/users/kingeasternsun/events{/privacy}","received_events_url":"https://api.github.com/users/kingeasternsun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T09:24:17Z","updated_at":"2021-11-03T09:24:17Z","author_association":"CONTRIBUTOR","body":"Hello everyone, Is any basic docker-compose file We can try?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/958774636/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/958781107","html_url":"https://github.com/apache/iceberg/issues/3447#issuecomment-958781107","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3447","id":958781107,"node_id":"IC_kwDOCW7NX845Jdaz","user":{"login":"deepeye","id":1631876,"node_id":"MDQ6VXNlcjE2MzE4NzY=","avatar_url":"https://avatars.githubusercontent.com/u/1631876?v=4","gravatar_id":"","url":"https://api.github.com/users/deepeye","html_url":"https://github.com/deepeye","followers_url":"https://api.github.com/users/deepeye/followers","following_url":"https://api.github.com/users/deepeye/following{/other_user}","gists_url":"https://api.github.com/users/deepeye/gists{/gist_id}","starred_url":"https://api.github.com/users/deepeye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deepeye/subscriptions","organizations_url":"https://api.github.com/users/deepeye/orgs","repos_url":"https://api.github.com/users/deepeye/repos","events_url":"https://api.github.com/users/deepeye/events{/privacy}","received_events_url":"https://api.github.com/users/deepeye/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T09:33:24Z","updated_at":"2021-11-03T09:33:24Z","author_association":"NONE","body":"Thanks for your help！I guess the reason is that when compact data files ， equality deletes are ignored。Please focus on https://github.com/apache/iceberg/pull/2372#issuecomment-845514501 \r\n and https://github.com/apache/iceberg/projects/10 ，\r\nbut I am not sure that solved the problem。I will try your suggest，thanks！","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/958781107/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959180907","html_url":"https://github.com/apache/iceberg/issues/1667#issuecomment-959180907","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1667","id":959180907,"node_id":"IC_kwDOCW7NX845K_Br","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T14:10:15Z","updated_at":"2021-11-03T14:10:15Z","author_association":"MEMBER","body":"We should really get in my Medium Files PR first which would fix the\nsuggested layout ^ (if the blocks were the right sizes)\nhttps://github.com/apache/iceberg/pull/3292\n\nOn Wed, Nov 3, 2021 at 4:11 AM kingeasternsun ***@***.***>\nwrote:\n\n> It seems like a Knapsack problem\n>\n> —\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/iceberg/issues/1667#issuecomment-958765565>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AADE2YLKP7BZPIGYRMXAS6DUKD4EPANCNFSM4TALJMXA>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959180907/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959328714","html_url":"https://github.com/apache/iceberg/pull/3456#issuecomment-959328714","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3456","id":959328714,"node_id":"IC_kwDOCW7NX845LjHK","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T14:53:48Z","updated_at":"2021-11-03T14:53:48Z","author_association":"CONTRIBUTOR","body":"Looks good to me. I think this is going to be rare enough that we won't need another solution.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959328714/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959417005","html_url":"https://github.com/apache/iceberg/pull/2807#issuecomment-959417005","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2807","id":959417005,"node_id":"IC_kwDOCW7NX845L4qt","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T15:19:37Z","updated_at":"2021-11-03T15:19:37Z","author_association":"CONTRIBUTOR","body":"close the PR based on conversations above.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959417005/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959503175","html_url":"https://github.com/apache/iceberg/pull/3449#issuecomment-959503175","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3449","id":959503175,"node_id":"IC_kwDOCW7NX845MNtH","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T15:44:56Z","updated_at":"2021-11-03T15:44:56Z","author_association":"CONTRIBUTOR","body":"Thanks, @samredai!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959503175/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959665632","html_url":"https://github.com/apache/iceberg/pull/3120#issuecomment-959665632","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3120","id":959665632,"node_id":"IC_kwDOCW7NX845M1Xg","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T16:33:07Z","updated_at":"2021-11-03T16:33:07Z","author_association":"CONTRIBUTOR","body":"Does this comment need to be addressed for ORC? https://github.com/apache/iceberg/pull/3120/files#diff-a6641d31cdfd66835b3447bef04be87786849126b07761e47b852837f67a988aR241","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959665632/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959679064","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-959679064","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":959679064,"node_id":"IC_kwDOCW7NX845M4pY","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T16:36:57Z","updated_at":"2021-11-03T16:36:57Z","author_association":"CONTRIBUTOR","body":"@huaxingao, any update on getting AS OF syntax in Spark?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959679064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959695524","html_url":"https://github.com/apache/iceberg/issues/2738#issuecomment-959695524","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2738","id":959695524,"node_id":"IC_kwDOCW7NX845M8qk","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T16:41:46Z","updated_at":"2021-11-03T16:41:46Z","author_association":"CONTRIBUTOR","body":"This was fixed in #3240.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959695524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959728482","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-959728482","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":959728482,"node_id":"IC_kwDOCW7NX845NEti","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T16:55:33Z","updated_at":"2021-11-03T16:55:33Z","author_association":"CONTRIBUTOR","body":"@rdblue \r\nThey are OK with adding `AS OF` syntax as long as I make it exactly the same as Delta Lake's syntax. I updated in internal slack channel but forgot to update here. Sorry about that. I will start working on this.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959728482/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959744048","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-959744048","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":959744048,"node_id":"IC_kwDOCW7NX845NIgw","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T17:12:15Z","updated_at":"2021-11-03T17:12:15Z","author_association":"CONTRIBUTOR","body":"@rdblue\r\nI plan to pass the `as of` info using `CatalogV2Util.loadTable(catalog: CatalogPlugin, ident: Identifier)`.\r\nDoes it work if I just append the info after `Identifier.name`,  for example: `default.table.12345678`, or it's better to change the `Identifier` interface to add something like this\r\n```\r\n  static Identifier of(String[] namespace, String name, long versionInfo) {\r\n    return new IdentifierImpl(namespace, name, versionInfo);\r\n  }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959744048/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959749859","html_url":"https://github.com/apache/iceberg/pull/3432#issuecomment-959749859","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3432","id":959749859,"node_id":"IC_kwDOCW7NX845NJ7j","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T17:18:22Z","updated_at":"2021-11-03T17:18:22Z","author_association":"CONTRIBUTOR","body":"thanks for all the feedbacks! For anyone interested, we are discussing about preserving sequence number in Slack: https://apache-iceberg.slack.com/archives/C02JDAQF81E/p1635922079047800\r\n\r\nI will update this doc with all the comments after that discussion is finalized.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959749859/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959760807","html_url":"https://github.com/apache/iceberg/pull/3445#issuecomment-959760807","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3445","id":959760807,"node_id":"IC_kwDOCW7NX845NMmn","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T17:30:15Z","updated_at":"2021-11-03T17:30:15Z","author_association":"CONTRIBUTOR","body":"@rdblue can you take a look at this PR and merge if it looks good to you?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959760807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959766469","html_url":"https://github.com/apache/iceberg/pull/3460#issuecomment-959766469","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3460","id":959766469,"node_id":"IC_kwDOCW7NX845NN_F","user":{"login":"izchen","id":67534059,"node_id":"MDQ6VXNlcjY3NTM0MDU5","avatar_url":"https://avatars.githubusercontent.com/u/67534059?v=4","gravatar_id":"","url":"https://api.github.com/users/izchen","html_url":"https://github.com/izchen","followers_url":"https://api.github.com/users/izchen/followers","following_url":"https://api.github.com/users/izchen/following{/other_user}","gists_url":"https://api.github.com/users/izchen/gists{/gist_id}","starred_url":"https://api.github.com/users/izchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/izchen/subscriptions","organizations_url":"https://api.github.com/users/izchen/orgs","repos_url":"https://api.github.com/users/izchen/repos","events_url":"https://api.github.com/users/izchen/events{/privacy}","received_events_url":"https://api.github.com/users/izchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T17:36:53Z","updated_at":"2021-11-03T17:36:53Z","author_association":"CONTRIBUTOR","body":"Related issue: https://github.com/apache/iceberg/issues/2934","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959766469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959782628","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-959782628","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":959782628,"node_id":"IC_kwDOCW7NX845NR7k","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T17:56:39Z","updated_at":"2021-11-03T17:57:12Z","author_association":"CONTRIBUTOR","body":"@huaxingao please confirm the SQL syntax that is agreed to in Spark (I'm looking at some Databricks blog for Delta Lake time travel):\r\n```\r\nSELECT * FROM t TIMESTAMP AS OF <timestamp>;\r\nSELECT * FROM t VERSION AS OF <version>;\r\n```\r\nwhere `timestamp` is something like \"2019-01-01 01:30:00.000\" and `version` for us would be the snapshot id. Is that correct?\r\n@pvary unfortunately that will not match the syntax supported by Hive and Impala, but it will be similar.\r\n\r\n@rdblue given that support for AS OF in Spark will only be in a future Spark release, what do you think we can do to support identifying the snapshot (or timestamp) for loading a table in Iceberg now? We need this to support reading the snapshot using the correct schema (as is now done for Spark 2.4).\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959782628/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959799737","html_url":"https://github.com/apache/iceberg/pull/3460#issuecomment-959799737","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3460","id":959799737,"node_id":"IC_kwDOCW7NX845NWG5","user":{"login":"izchen","id":67534059,"node_id":"MDQ6VXNlcjY3NTM0MDU5","avatar_url":"https://avatars.githubusercontent.com/u/67534059?v=4","gravatar_id":"","url":"https://api.github.com/users/izchen","html_url":"https://github.com/izchen","followers_url":"https://api.github.com/users/izchen/followers","following_url":"https://api.github.com/users/izchen/following{/other_user}","gists_url":"https://api.github.com/users/izchen/gists{/gist_id}","starred_url":"https://api.github.com/users/izchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/izchen/subscriptions","organizations_url":"https://api.github.com/users/izchen/orgs","repos_url":"https://api.github.com/users/izchen/repos","events_url":"https://api.github.com/users/izchen/events{/privacy}","received_events_url":"https://api.github.com/users/izchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T18:17:46Z","updated_at":"2021-11-03T18:17:46Z","author_association":"CONTRIBUTOR","body":" @rdblue @kbendick , could you help to review this PR? :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959799737/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959801379","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-959801379","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":959801379,"node_id":"IC_kwDOCW7NX845NWgj","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T18:19:51Z","updated_at":"2021-11-03T18:19:51Z","author_association":"CONTRIBUTOR","body":"@wypoon \r\nHere is Delta Lake syntax https://docs.databricks.com/delta/quick-start.html#query-an-earlier-version-of-the-table-time-travel\r\n```\r\nSELECT * FROM default.people10m VERSION AS OF 0;\r\n\r\nSELECT * FROM default.people10m TIMESTAMP AS OF '2019-01-29 00:37:58';\r\n```\r\n\r\nI plan to do exactly the same as above.\r\nYes, timestamp is something like \"2019-01-01 01:30:00.000\" and version would be the snapshot id.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959801379/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959803004","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-959803004","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":959803004,"node_id":"IC_kwDOCW7NX845NW58","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T18:21:54Z","updated_at":"2021-11-03T18:30:57Z","author_association":"CONTRIBUTOR","body":"I think adding a `Long` or `Optional<Long>` to the `org.apache.spark.sql.connector.catalog.Identifier` interface could work for us:\r\n```\r\n  static Identifier of(String[] namespace, String name, Long version) {\r\n    return new IdentifierImpl(namespace, name, version);\r\n  }\r\n  ...\r\n  Long version();\r\n```\r\nUntil the change to this interface makes it into a released Spark 3 version, we could add this extension to Iceberg and use this internal extension of `Identifier` to load the table with the snapshot id, when reading it using `.option(\"snapshot-id\", ...)` or `.option(\"as-of-timestamp\", ...)`. When a Spark version is released with this change to `Identifier`, we can switch from our internal extension to the upstream `Identifier`.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959803004/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959826574","html_url":"https://github.com/apache/iceberg/pull/3459#issuecomment-959826574","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3459","id":959826574,"node_id":"IC_kwDOCW7NX845NcqO","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T18:52:57Z","updated_at":"2021-11-03T18:52:57Z","author_association":"MEMBER","body":"I agree with @szehon-ho , we should use the metadata table here, especially because it already has the code for dealing with multiple partition specs in it which is currently missing from this PR. I can do a more through review later","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959826574/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959830183","html_url":"https://github.com/apache/iceberg/pull/3455#issuecomment-959830183","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3455","id":959830183,"node_id":"IC_kwDOCW7NX845Ndin","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T18:57:31Z","updated_at":"2021-11-03T20:24:46Z","author_association":"CONTRIBUTOR","body":"> LGTM, nit , will just changing get() to getOrDefault(..., \"0\") be a bit less verbose?\r\n\r\nI initially thought that too. My one concern is that if there is an actual `null` stored in the map as the value for that key, we'll still get `null`.\r\n\r\nHowever, I added some tests that exercise Spark end to end and inspected the code. Using `getOrDefault` works so I've updated to that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959830183/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959847806","html_url":"https://github.com/apache/iceberg/pull/3095#issuecomment-959847806","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3095","id":959847806,"node_id":"IC_kwDOCW7NX845Nh1-","user":{"login":"xinbinhuang","id":27927454,"node_id":"MDQ6VXNlcjI3OTI3NDU0","avatar_url":"https://avatars.githubusercontent.com/u/27927454?v=4","gravatar_id":"","url":"https://api.github.com/users/xinbinhuang","html_url":"https://github.com/xinbinhuang","followers_url":"https://api.github.com/users/xinbinhuang/followers","following_url":"https://api.github.com/users/xinbinhuang/following{/other_user}","gists_url":"https://api.github.com/users/xinbinhuang/gists{/gist_id}","starred_url":"https://api.github.com/users/xinbinhuang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xinbinhuang/subscriptions","organizations_url":"https://api.github.com/users/xinbinhuang/orgs","repos_url":"https://api.github.com/users/xinbinhuang/repos","events_url":"https://api.github.com/users/xinbinhuang/events{/privacy}","received_events_url":"https://api.github.com/users/xinbinhuang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T19:21:18Z","updated_at":"2021-11-03T19:22:06Z","author_association":"CONTRIBUTOR","body":"Hi @hameizi, thanks for the great work! I'm really interested in this patch to support `overwrite` snapshots. In my company, 90% of the write to iceberg is `overwrite` by Spark, so it makes really hard/impossible to streaming read from these tables in Flink. I wonder if this patch requires Flink 1.13, or it'll also work for 1.12? \r\n\r\n@openinx do you know if this PR can make it to the next release? if so, roughly when will be the next release or does it depends on the progress on the priority 1 items in the roadmap?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959847806/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959880751","html_url":"https://github.com/apache/iceberg/pull/3458#issuecomment-959880751","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3458","id":959880751,"node_id":"IC_kwDOCW7NX845Np4v","user":{"login":"myandpr","id":20159351,"node_id":"MDQ6VXNlcjIwMTU5MzUx","avatar_url":"https://avatars.githubusercontent.com/u/20159351?v=4","gravatar_id":"","url":"https://api.github.com/users/myandpr","html_url":"https://github.com/myandpr","followers_url":"https://api.github.com/users/myandpr/followers","following_url":"https://api.github.com/users/myandpr/following{/other_user}","gists_url":"https://api.github.com/users/myandpr/gists{/gist_id}","starred_url":"https://api.github.com/users/myandpr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/myandpr/subscriptions","organizations_url":"https://api.github.com/users/myandpr/orgs","repos_url":"https://api.github.com/users/myandpr/repos","events_url":"https://api.github.com/users/myandpr/events{/privacy}","received_events_url":"https://api.github.com/users/myandpr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T19:41:19Z","updated_at":"2021-11-03T19:41:19Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer  , could you help to review this PR? :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959880751/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959897928","html_url":"https://github.com/apache/iceberg/pull/3445#issuecomment-959897928","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3445","id":959897928,"node_id":"IC_kwDOCW7NX845NuFI","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T19:50:00Z","updated_at":"2021-11-03T19:50:00Z","author_association":"CONTRIBUTOR","body":"Since the tests are running in both 1.12 and 1.13 jobs, we no longer need the `flink-common-tests` CI job. Can you remove it?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959897928/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959927842","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-959927842","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":959927842,"node_id":"IC_kwDOCW7NX845N1Yi","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T20:05:17Z","updated_at":"2021-11-03T20:05:17Z","author_association":"CONTRIBUTOR","body":"@wypoon @rdblue @huaxingao was there any consideration around the upcoming feature around branching?\r\n\r\nBased on the current syntax, it looks like we are assuming a linear history for time travel. Users can only:\r\n1. time travel on the main branch\r\n2. first switch the current branch to point to a different branch and then time travel in that branch\r\n\r\nThere is no way to appoint a different branch to time travel, unless I do something like:\r\n\r\n```\r\nSELECT * FROM table@my_branch TIMESTAMP AS OF '2019-01-29 00:37:58';\r\n```\r\n\r\nAny thoughts?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959927842/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959986863","html_url":"https://github.com/apache/iceberg/pull/3461#issuecomment-959986863","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3461","id":959986863,"node_id":"IC_kwDOCW7NX845ODyv","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T20:34:55Z","updated_at":"2021-11-03T20:34:55Z","author_association":"CONTRIBUTOR","body":"cc  @flyrain @karuppayya @szehon-ho @rdblue @RussellSpitzer @wypoon @pan3793 @kbendick","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959986863/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959989086","html_url":"https://github.com/apache/iceberg/pull/3462#issuecomment-959989086","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3462","id":959989086,"node_id":"IC_kwDOCW7NX845OEVe","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T20:35:53Z","updated_at":"2021-11-03T20:35:53Z","author_association":"MEMBER","body":"@rdblue Please let me know what you think about this for the removing unused specs / removing broken and unused specs from table utility","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/959989086/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960045466","html_url":"https://github.com/apache/iceberg/issues/3426#issuecomment-960045466","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3426","id":960045466,"node_id":"IC_kwDOCW7NX845OSGa","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T20:57:37Z","updated_at":"2021-11-03T20:57:37Z","author_association":"CONTRIBUTOR","body":"Thanks for the investigation! I can confirm the fix works, closing this issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960045466/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960124030","html_url":"https://github.com/apache/iceberg/pull/3404#issuecomment-960124030","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3404","id":960124030,"node_id":"IC_kwDOCW7NX845OlR-","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T21:34:13Z","updated_at":"2021-11-03T21:34:13Z","author_association":"CONTRIBUTOR","body":"Mostly look good to me, same comment for the tests so that we can have more specific tests running separately for each case.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960124030/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960143375","html_url":"https://github.com/apache/iceberg/pull/3292#issuecomment-960143375","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3292","id":960143375,"node_id":"IC_kwDOCW7NX845OqAP","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T21:43:18Z","updated_at":"2021-11-03T21:43:18Z","author_association":"MEMBER","body":"@rdblue if this is good to go I can make the identical changes to the other Spark modules and merge\r\n\r\n+ @zhangjun0x01 You may want to take a look at this as well\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960143375/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960219459","html_url":"https://github.com/apache/iceberg/pull/3387#issuecomment-960219459","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3387","id":960219459,"node_id":"IC_kwDOCW7NX845O8lD","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T22:13:03Z","updated_at":"2021-11-03T22:13:03Z","author_association":"CONTRIBUTOR","body":"@rdblue thanks for the input! Yes I think `actions.rewrite-files.xxx` sounds like a good idea, my original attempt of having prefix as `rewrite` was to serve that purpose. Let me think about how I can formalize that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960219459/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960243221","html_url":"https://github.com/apache/iceberg/pull/3463#issuecomment-960243221","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3463","id":960243221,"node_id":"IC_kwDOCW7NX845PCYV","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T22:26:59Z","updated_at":"2021-11-03T22:31:30Z","author_association":"CONTRIBUTOR","body":"> A few updates needed in the checkstyle descriptions and comments, but this is a good catch.\r\n> \r\n> Is there anything in `org.apache.arrow.util` we might ever need?\r\n> \r\n> I think it's safe to add this and then it can be reconsidered or made more explicit to the Preconditions check otherwise.\r\n> \r\n> I know that my Intellij autoimports `Preconditions` from all sorts of places and it's easy to miss.\r\n\r\nI went and checked the arrow library, and the only things I found in `org.apache.arrow.util` were `Preconditions` and something called `AutoCloseables` and something called `Collections2` (a test class). Doubt we'll need those and we can update this if we do.\r\n\r\nEDIT: I also went looking at `org.assertj.core.util`, and everything was copied from Guava or elsewhere. I think this is safe to do as well and we can also update it need be.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960243221/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960245419","html_url":"https://github.com/apache/iceberg/pull/3387#issuecomment-960245419","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3387","id":960245419,"node_id":"IC_kwDOCW7NX845PC6r","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T22:31:15Z","updated_at":"2021-11-03T22:31:15Z","author_association":"MEMBER","body":"As we discussed offline I think this is a good idea overall, I'll do a review when I have some free time. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960245419/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960246110","html_url":"https://github.com/apache/iceberg/pull/3463#issuecomment-960246110","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3463","id":960246110,"node_id":"IC_kwDOCW7NX845PDFe","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T22:32:33Z","updated_at":"2021-11-03T22:32:33Z","author_association":"CONTRIBUTOR","body":"cc @nastra who often updates the check style file, but I think this is safe and will help accidentally importing Preconditions and other Guava / google commons things from these libraries that also seem to have forked.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960246110/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960274222","html_url":"https://github.com/apache/iceberg/pull/3455#issuecomment-960274222","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3455","id":960274222,"node_id":"IC_kwDOCW7NX845PJ8u","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T23:07:00Z","updated_at":"2021-11-03T23:17:15Z","author_association":"CONTRIBUTOR","body":"> overall looks good to me.\r\n> \r\n> I see this directly fixes all the Spark versions. My understanding is that we should always first fix latest version, and have another PR as backport. Not sure if if we should enforce this as a general rule to follow as a community, maybe we can discuss in the devlist.\r\n\r\nOh I wasn't aware of that. Good catch. That makes sense to reduce review overhead. I'll open a discussion on the dev list (or look for an existing one).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960274222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960280887","html_url":"https://github.com/apache/iceberg/pull/3399#issuecomment-960280887","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3399","id":960280887,"node_id":"IC_kwDOCW7NX845PLk3","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-03T23:11:27Z","updated_at":"2021-11-03T23:11:27Z","author_association":"CONTRIBUTOR","body":"Rebased after the tox.ini changes were merged","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960280887/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960339408","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-960339408","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":960339408,"node_id":"IC_kwDOCW7NX845PZ3Q","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T00:40:16Z","updated_at":"2021-11-04T00:44:42Z","author_association":"CONTRIBUTOR","body":"@jackye1995 I have not been following the proposal/project to add snapshot tagging and branching, so I had not considered this question. I only just read the proposal [document](https://docs.google.com/document/d/1PvxK_0ebEoX3s7nS6-LOJJZdBYr_olTWH9oepNUfJ-A/edit) and your doc PR #3425. I did not see any discussion in them about the semantics of time travel by timestamp. What do you think the semantics should be? One possible option is:\r\n1. No branch is specified (I'm not sure if that is possible, but if it is), we default to the main branch. Time travel behaves as though only the main branch exists.\r\n2. A branch is specified. We go up the tree from the head of the branch, until we are at or before the timestamp. We select the snapshot we find there. There are two ways this might fail: a. We pass the beginning of the branch -- we can either say there is no snapshot or we can continue on the tree up another branch our branch is branched from. b. We do not find any snapshot at or before the timestamp -- we say there is no snapshot.\r\n\r\nThis assumes the history is really a tree. (Am I mistaken about it being a tree?)\r\n\r\nIn addition, we need a syntax for specifying a tag or a branch; I don't know if one is proposed -- I saw above an allusion to using `.` for specifying branch and tag as well. Or will we support a way to say \"SET BRANCH `<branch>`\" in SQL or in the DataFrame API using `.option(\"branch\", <branch>)`? It sounds like we would, since you consider the option to \"first switch the current branch to point to a different branch\".\r\n\r\nDo you think we need the `org.apache.spark.sql.connector.catalog.Identifier` to have enough information to load a table using the necessary branch/tag/snapshot-id? I think the answer depends on what syntax we intend to support for specifying branch and tag. Here are some things I can think of:\r\n1. Support using a tag instead of a snapshot id in the VERSION AS OF clause: `SELECT * from t VERSION AS OF <tag>`. Is that feasible technically, or do we need a different variant of AS OF?\r\n2. Support specifying a tag or a branch as part of the table identifier: `SELECT * from t.<tag>` or `SELECT * FROM t.<branch>` or `SELECT * from t.<branch> TIMESTAMP AS OF <timestamp>`. (Here I'm using `.` just for illustration.)\r\n\r\nI think that if we use the `.` syntax, then we do not need to pass a branch or tag field in the `Identifier`. We would resolve the branch/tag on the Iceberg side along the lines shown in this PR for snapshot-id. But we do need to pass the snapshot-id or timestamp that comes from the AS OF clause in the `Identifier`.\r\n@huaxingao without considering the branch/tag question, do you think we need the ability to pass either snapshot-id or timestamp in the `Identifier`? How do you propose to distinguish the two?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960339408/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960348960","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-960348960","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":960348960,"node_id":"IC_kwDOCW7NX845PcMg","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T00:58:51Z","updated_at":"2021-11-04T00:58:51Z","author_association":"CONTRIBUTOR","body":"@wypoon\r\nHow about we use type String for `version` and have different prefixes to differentiate between snapshot-id and timestamp?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960348960/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960351252","html_url":"https://github.com/apache/iceberg/issues/3464#issuecomment-960351252","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3464","id":960351252,"node_id":"IC_kwDOCW7NX845PcwU","user":{"login":"TGooch44","id":1591711,"node_id":"MDQ6VXNlcjE1OTE3MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1591711?v=4","gravatar_id":"","url":"https://api.github.com/users/TGooch44","html_url":"https://github.com/TGooch44","followers_url":"https://api.github.com/users/TGooch44/followers","following_url":"https://api.github.com/users/TGooch44/following{/other_user}","gists_url":"https://api.github.com/users/TGooch44/gists{/gist_id}","starred_url":"https://api.github.com/users/TGooch44/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TGooch44/subscriptions","organizations_url":"https://api.github.com/users/TGooch44/orgs","repos_url":"https://api.github.com/users/TGooch44/repos","events_url":"https://api.github.com/users/TGooch44/events{/privacy}","received_events_url":"https://api.github.com/users/TGooch44/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T01:04:48Z","updated_at":"2021-11-04T01:04:48Z","author_association":"CONTRIBUTOR","body":"short answer is that legacy was mostly implemented before pyarrow was v1 and before any datasets API was available.  At Netflix, These things were being delegated to an internal c-lib based off the arrow c-lib that handled low-level scanning and filtering. \r\n\r\nAdditionally, AFAIK, even in the current pyarrow datasets api there is still some special handling where schema evolution is needed that somewhat prevents using the full capability there. Last I checked you have to have a single schema across files scanned in the Dataset, which may not be the case in Iceberg.  \r\n\r\nHowever, strong agree that any new implementation should leverage arrow as much as possible and should strive to work with arrow community to shore up any functionality gaps(where it makes sense for their project to do so).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960351252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960351468","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-960351468","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":960351468,"node_id":"IC_kwDOCW7NX845Pczs","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T01:05:20Z","updated_at":"2021-11-04T01:05:20Z","author_association":"CONTRIBUTOR","body":"> @wypoon How about we use type String for `version` and have different prefixes to differentiate between snapshot-id and timestamp?\r\n\r\nI think that could work.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960351468/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960354617","html_url":"https://github.com/apache/iceberg/pull/3387#issuecomment-960354617","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3387","id":960354617,"node_id":"IC_kwDOCW7NX845Pdk5","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T01:12:50Z","updated_at":"2021-11-04T01:12:50Z","author_association":"CONTRIBUTOR","body":"@rdblue @RussellSpitzer updated the PR to introduce a framework in supporting action options as table property in general, please let me know what you think, thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960354617/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960363663","html_url":"https://github.com/apache/iceberg/pull/3459#issuecomment-960363663","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3459","id":960363663,"node_id":"IC_kwDOCW7NX845PfyP","user":{"login":"KnightChess","id":20125927,"node_id":"MDQ6VXNlcjIwMTI1OTI3","avatar_url":"https://avatars.githubusercontent.com/u/20125927?v=4","gravatar_id":"","url":"https://api.github.com/users/KnightChess","html_url":"https://github.com/KnightChess","followers_url":"https://api.github.com/users/KnightChess/followers","following_url":"https://api.github.com/users/KnightChess/following{/other_user}","gists_url":"https://api.github.com/users/KnightChess/gists{/gist_id}","starred_url":"https://api.github.com/users/KnightChess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KnightChess/subscriptions","organizations_url":"https://api.github.com/users/KnightChess/orgs","repos_url":"https://api.github.com/users/KnightChess/repos","events_url":"https://api.github.com/users/KnightChess/events{/privacy}","received_events_url":"https://api.github.com/users/KnightChess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T01:37:27Z","updated_at":"2021-11-04T01:37:27Z","author_association":"CONTRIBUTOR","body":"> Hi, thanks for this, but first of all I'm just wondering first of all, whether its possible to re-use the partitions metadata table? Then we can get some benefits like predicate pushdown and future work to make it parallel, instead of re-implementing in two places? @RussellSpitzer any thoughts ? Thanks\r\n\r\n@szehon-ho  thanks for advice, I'll view the relevant code and do some modifications","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960363663/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960373555","html_url":"https://github.com/apache/iceberg/pull/3459#issuecomment-960373555","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3459","id":960373555,"node_id":"IC_kwDOCW7NX845PiMz","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T02:04:02Z","updated_at":"2021-11-04T02:04:15Z","author_association":"CONTRIBUTOR","body":"+1 for reusing the metadata table, it will also help #3269 as we are changing the definition of `SparkTable` from table to table + snapshotId.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960373555/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960374866","html_url":"https://github.com/apache/iceberg/pull/3095#issuecomment-960374866","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3095","id":960374866,"node_id":"IC_kwDOCW7NX845PihS","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T02:07:16Z","updated_at":"2021-11-04T02:07:16Z","author_association":"CONTRIBUTOR","body":"> I wonder if this patch requires Flink 1.13, or it'll also work for 1.12?\r\n\r\n@xinbinhuang It work for both Flink 1.12 and 1.13.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960374866/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960380098","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-960380098","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":960380098,"node_id":"IC_kwDOCW7NX845PjzC","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T02:19:41Z","updated_at":"2021-11-04T02:19:41Z","author_association":"CONTRIBUTOR","body":">     1. No branch is specified (I'm not sure if that is possible, but if it is), we default to the main branch. Time travel behaves as though only the main branch exists.\r\n> \r\n>     2. A branch is specified. We go up the tree from the head of the branch, until we are at or before the timestamp. We select the snapshot we find there. There are two ways this might fail: a. We pass the beginning of the branch -- we can either say there is no snapshot or we can continue on the tree up another branch our branch is branched from. b. We do not find any snapshot at or before the timestamp -- we say there is no snapshot.\r\n\r\nYes I totally agree with this resolution strategy. The only question I have is around pure SQL support. \r\n\r\nFor branch: `SELECT * from t.<branch> TIMESTAMP AS OF <timestamp>` is also what I am considering, although it means we cannot use metadata table name as the branch name, but we can discuss on that. The question I have more is if we want to have a more \"formal\" support, like `SELECT * from table TIMESTAMP AS OF <timestamp> IN BRANCH <branch>` just to make things up.\r\n\r\nFor tag: I am okay with the `VERSION 'tag'` approach. String seems like a good way to define version as it is the most flexible across systems. We can also make it typed, so both `VERSION 123` and `VERSION '123'` work. This is the approach we are proposing in Trino right now, where the query engine can declare supported version types and parse them differently. But there might be some more complexity for Spark to implement this, and the benefit is not clear compared to using String.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960380098/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960380138","html_url":"https://github.com/apache/iceberg/issues/3464#issuecomment-960380138","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3464","id":960380138,"node_id":"IC_kwDOCW7NX845Pjzq","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T02:19:46Z","updated_at":"2021-11-04T02:19:46Z","author_association":"COLLABORATOR","body":"Thanks for the comments on the Types. There are two primitive types not fitting this, e.g. `FixedType`, which depends on instantiating attribute `length`, e.g. `FixedType(16)` and `FixedType(8)` are two different types, (similar to int32 vs int64). I don't see a clean way to provide a singular class for both two. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960380138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960422526","html_url":"https://github.com/apache/iceberg/pull/3056#issuecomment-960422526","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3056","id":960422526,"node_id":"IC_kwDOCW7NX845PuJ-","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T03:17:24Z","updated_at":"2021-11-04T03:17:24Z","author_association":"CONTRIBUTOR","body":"@rdblue @jackye1995 @wypoon the code has been rebased, please help to review when you have time. Thanks a lot.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960422526/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960433304","html_url":"https://github.com/apache/iceberg/pull/3287#issuecomment-960433304","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3287","id":960433304,"node_id":"IC_kwDOCW7NX845PwyY","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T03:50:10Z","updated_at":"2021-11-04T19:15:49Z","author_association":"CONTRIBUTOR","body":"Add more benchmarks. There are 3 benchmark suites in total. cc @RussellSpitzer \r\n1. Compare vectorized read vs non-vectorized read with multiple number of delete rows.  \r\n1.1 Without any deleted rows\r\n1.2 With only one delete rows\r\n1.3 With 5%, 25%, 50% and 100% deleted rows.\r\nOverall, vectorized read is consistently faster than non-vectorized read, about 55% faster.\r\n```\r\nBenchmark                                                          (percentageDeleteRow)  Mode  Cnt  Score   Error  Units\r\nIcebergSourceFlatParquetDataDeleteBenchmark.readIceberg                                0    ss    5  3.111 ± 0.227   s/op\r\nIcebergSourceFlatParquetDataDeleteBenchmark.readIceberg                         0.000001    ss    5  3.826 ± 0.153   s/op\r\nIcebergSourceFlatParquetDataDeleteBenchmark.readIceberg                             0.05    ss    5  3.841 ± 0.196   s/op\r\nIcebergSourceFlatParquetDataDeleteBenchmark.readIceberg                             0.25    ss    5  4.552 ± 0.320   s/op\r\nIcebergSourceFlatParquetDataDeleteBenchmark.readIceberg                              0.5    ss    5  5.530 ± 0.139   s/op\r\nIcebergSourceFlatParquetDataDeleteBenchmark.readIceberg                                1    ss    5  8.407 ± 0.222   s/op\r\nIcebergSourceFlatParquetDataDeleteBenchmark.readIcebergVectorized                      0    ss    5  1.671 ± 0.137   s/op\r\nIcebergSourceFlatParquetDataDeleteBenchmark.readIcebergVectorized               0.000001    ss    5  2.227 ± 0.205   s/op\r\nIcebergSourceFlatParquetDataDeleteBenchmark.readIcebergVectorized                   0.05    ss    5  2.323 ± 0.155   s/op\r\nIcebergSourceFlatParquetDataDeleteBenchmark.readIcebergVectorized                   0.25    ss    5  3.089 ± 0.211   s/op\r\nIcebergSourceFlatParquetDataDeleteBenchmark.readIcebergVectorized                    0.5    ss    5  4.216 ± 0.156   s/op\r\nIcebergSourceFlatParquetDataDeleteBenchmark.readIcebergVectorized                      1    ss    5  5.295 ± 0.198   s/op\r\n```\r\n![image](https://user-images.githubusercontent.com/1322359/140254438-686b5566-b91f-4528-9322-f546fb2be846.png)\r\n\r\n2. Compare vectorized read vs non-vectorized read with multiple delete files. Here is the result with 25% rows are deleted and distribute these deletes to 1, 2, 5, 10 delete files. The perf degradation is minor when num of delete files increase. \r\n```\r\nBenchmark                                                          (numDeleteFile)  (percentageDeleteRow)  Mode  Cnt  Score   Error  Units\r\nIcebergSourceFlatParquetDataDeleteBenchmark.readIceberg                          1                   0.25    ss    5  4.639 ± 0.153   s/op\r\nIcebergSourceFlatParquetDataDeleteBenchmark.readIceberg                          2                   0.25    ss    5  4.703 ± 0.319   s/op\r\nIcebergSourceFlatParquetDataDeleteBenchmark.readIceberg                          5                   0.25    ss    5  5.496 ± 2.550   s/op\r\nIcebergSourceFlatParquetDataDeleteBenchmark.readIceberg                         10                   0.25    ss    5  4.856 ± 0.605   s/op\r\nIcebergSourceFlatParquetDataDeleteBenchmark.readIcebergVectorized                1                   0.25    ss    5  3.074 ± 0.200   s/op\r\nIcebergSourceFlatParquetDataDeleteBenchmark.readIcebergVectorized                2                   0.25    ss    5  3.058 ± 0.176   s/op\r\nIcebergSourceFlatParquetDataDeleteBenchmark.readIcebergVectorized                5                   0.25    ss    5  3.181 ± 0.994   s/op\r\nIcebergSourceFlatParquetDataDeleteBenchmark.readIcebergVectorized               10                   0.25    ss    5  3.326 ± 0.692   s/op\r\n```\r\n![image](https://user-images.githubusercontent.com/1322359/140254878-62501fe9-2804-4d6d-b99a-ff811e7a0ef8.png)\r\n\r\n3. Compare vectorized read vs non-vectorized read with unrelated deleted rows for the data files. Here is the result that 5% rows are deleted with additional 0, 5%, 25%, 50% unrelated delete rows, all deletes are written into one delete file. With more unrelated deleted rows, the performance degradation is considerable. This may due to inefficiency of class `CharSeqComparator`. I will try to open another PR for this.\r\n```\r\nBenchmark                                                                 (percentageNoise)  Mode  Cnt  Score   Error  Units\r\nIcebergSourceParquetDeleteMixedPosDeletesBenchmark.readIceberg                            0    ss    5  3.872 ± 0.121   s/op\r\nIcebergSourceParquetDeleteMixedPosDeletesBenchmark.readIceberg                         0.05    ss    5  4.054 ± 0.176   s/op\r\nIcebergSourceParquetDeleteMixedPosDeletesBenchmark.readIceberg                         0.25    ss    5  5.008 ± 0.655   s/op\r\nIcebergSourceParquetDeleteMixedPosDeletesBenchmark.readIceberg                          0.5    ss    5  6.042 ± 0.338   s/op\r\nIcebergSourceParquetDeleteMixedPosDeletesBenchmark.readIcebergVectorized                  0    ss    5  2.372 ± 0.161   s/op\r\nIcebergSourceParquetDeleteMixedPosDeletesBenchmark.readIcebergVectorized               0.05    ss    5  2.523 ± 0.179   s/op\r\nIcebergSourceParquetDeleteMixedPosDeletesBenchmark.readIcebergVectorized               0.25    ss    5  3.411 ± 0.147   s/op\r\nIcebergSourceParquetDeleteMixedPosDeletesBenchmark.readIcebergVectorized                0.5    ss    5  4.493 ± 0.190   s/op\r\n```\r\n![image](https://user-images.githubusercontent.com/1322359/140253965-f1bb0447-6e4f-48b1-9f65-a81cc85dda05.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960433304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960433963","html_url":"https://github.com/apache/iceberg/pull/3287#issuecomment-960433963","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3287","id":960433963,"node_id":"IC_kwDOCW7NX845Pw8r","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T03:52:24Z","updated_at":"2021-11-04T03:52:24Z","author_association":"CONTRIBUTOR","body":"The test failure is unrelated.\r\n```\r\norg.apache.iceberg.flink.TestFlinkTableSink > testHashDistributeMode\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960433963/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960450019","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-960450019","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":960450019,"node_id":"IC_kwDOCW7NX845P03j","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T04:26:19Z","updated_at":"2021-11-04T04:26:19Z","author_association":"CONTRIBUTOR","body":"Seems I can't change `Identifier` because it is used by other code paths as well.\r\nI will overload `loadTable` method to pass in version:\r\n```\r\nCatalogV2Util\r\ndef loadTable(catalog: CatalogPlugin, ident: Identifier, version: String): Option[Table]\r\n\r\nTableCatalog\r\ndefault Table loadTable(Identifier ident, String version) {\r\n    throw new UnsupportedOperationException(\"Load table with version is not supported.\");\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960450019/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960457101","html_url":"https://github.com/apache/iceberg/pull/3292#issuecomment-960457101","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3292","id":960457101,"node_id":"IC_kwDOCW7NX845P2mN","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T04:50:00Z","updated_at":"2021-11-04T04:50:00Z","author_association":"CONTRIBUTOR","body":"@rdblue, could you take a look? You left comments and I am not sure they are resolved.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960457101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960459089","html_url":"https://github.com/apache/iceberg/pull/3301#issuecomment-960459089","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3301","id":960459089,"node_id":"IC_kwDOCW7NX845P3FR","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T04:56:13Z","updated_at":"2021-11-04T04:56:13Z","author_association":"CONTRIBUTOR","body":"@rdblue @RussellSpitzer @aokolnychyi @openinx @kbendick Please help to review when you have time. Thanks a lot.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960459089/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960492356","html_url":"https://github.com/apache/iceberg/issues/3465#issuecomment-960492356","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3465","id":960492356,"node_id":"IC_kwDOCW7NX845P_NE","user":{"login":"KnightChess","id":20125927,"node_id":"MDQ6VXNlcjIwMTI1OTI3","avatar_url":"https://avatars.githubusercontent.com/u/20125927?v=4","gravatar_id":"","url":"https://api.github.com/users/KnightChess","html_url":"https://github.com/KnightChess","followers_url":"https://api.github.com/users/KnightChess/followers","following_url":"https://api.github.com/users/KnightChess/following{/other_user}","gists_url":"https://api.github.com/users/KnightChess/gists{/gist_id}","starred_url":"https://api.github.com/users/KnightChess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KnightChess/subscriptions","organizations_url":"https://api.github.com/users/KnightChess/orgs","repos_url":"https://api.github.com/users/KnightChess/repos","events_url":"https://api.github.com/users/KnightChess/events{/privacy}","received_events_url":"https://api.github.com/users/KnightChess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T06:30:50Z","updated_at":"2021-11-04T06:30:50Z","author_association":"CONTRIBUTOR","body":"I'll supplement this doc this week, please assgin to me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960492356/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960514963","html_url":"https://github.com/apache/iceberg/pull/3249#issuecomment-960514963","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3249","id":960514963,"node_id":"IC_kwDOCW7NX845QEuT","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T07:25:19Z","updated_at":"2021-11-04T07:25:19Z","author_association":"CONTRIBUTOR","body":"@rdblue @nastra @pvary @kbendick Could you help to review when you have time? Thanks a lot.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960514963/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960543793","html_url":"https://github.com/apache/iceberg/pull/3377#issuecomment-960543793","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3377","id":960543793,"node_id":"IC_kwDOCW7NX845QLwx","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T08:21:57Z","updated_at":"2021-11-04T08:21:57Z","author_association":"COLLABORATOR","body":"@rdblue @aokolnychyi Makes sense! Thanks for reviewing, I'll close this PR.\r\nI'll open a new PR for enabling ORC tests in `TestPartitioningWriters`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960543793/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960797228","html_url":"https://github.com/apache/iceberg/issues/417#issuecomment-960797228","issue_url":"https://api.github.com/repos/apache/iceberg/issues/417","id":960797228,"node_id":"IC_kwDOCW7NX845RJos","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T12:24:40Z","updated_at":"2021-11-04T12:24:40Z","author_association":"CONTRIBUTOR","body":"> I've been considering the idea of custom transform functions to solve this. So we would be able to define and plug in transforms specific to our use cases. \r\n\r\nIs there any progress on this issue? @rdblue @ericsun2 We ran into the same problem as this one, so we want to know about the community’s plan on this issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/960797228/reactions","total_count":3,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":3},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961087360","html_url":"https://github.com/apache/iceberg/pull/3469#issuecomment-961087360","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3469","id":961087360,"node_id":"IC_kwDOCW7NX845SQeA","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T14:45:06Z","updated_at":"2021-11-04T14:45:06Z","author_association":"MEMBER","body":"cc: @RussellSpitzer , @aokolnychyi ,  @jackye1995, @rymurr ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961087360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961096400","html_url":"https://github.com/apache/iceberg/pull/3469#issuecomment-961096400","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3469","id":961096400,"node_id":"IC_kwDOCW7NX845SSrQ","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T14:49:24Z","updated_at":"2021-11-04T14:49:24Z","author_association":"MEMBER","body":"Looks like there are a lot of formatting changes here, can we undo all of those?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961096400/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961101564","html_url":"https://github.com/apache/iceberg/pull/3469#issuecomment-961101564","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3469","id":961101564,"node_id":"IC_kwDOCW7NX845ST78","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T14:51:58Z","updated_at":"2021-11-04T14:53:16Z","author_association":"MEMBER","body":"> Looks like there are a lot of formatting changes here, can we undo all of those?\r\n\r\n@RussellSpitzer: I see, something to do with recent code style Intellij problem I guess. I will manually check and undo it.\r\nAlso when I moved the file, It has done auto formatting I guess. \r\nBut why checkstyle is passing ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961101564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961111912","html_url":"https://github.com/apache/iceberg/pull/3392#issuecomment-961111912","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3392","id":961111912,"node_id":"IC_kwDOCW7NX845SWdo","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T14:56:51Z","updated_at":"2021-11-04T14:56:51Z","author_association":"CONTRIBUTOR","body":"The issue is reproducible with this:\r\n```\r\n  @Test\r\n  public void testBug() {\r\n    shell.setHiveSessionValue(\"hive.cbo.enable\", true);\r\n\r\n    String process_info = \"CREATE TABLE process_info (\\n\" +\r\n            \"   application_id STRING,\\n\" +\r\n            \"   engine STRING,\\n\" +\r\n            \"   node_type STRING,\\n\" +\r\n            \"   bytes_read BIGINT,\\n\" +\r\n            \"   bytes_write BIGINT,\\n\" +\r\n            \"   fd_count_avg BIGINT,\\n\" +\r\n            \"   thread_count_avg INT\\n\" +\r\n            \" )\\n\" +\r\n            \" STORED BY 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'\";\r\n    shell.executeStatement(process_info);\r\n    shell.executeStatement(\r\n            \"INSERT INTO process_info VALUES('APP-1','map', 'MR', 0, 0, 0, 0)\");\r\n\r\n    String mr_job_info = \"CREATE TABLE mr_job_info (\\n\" +\r\n            \"   application_id STRING,\\n\" +\r\n            \"   queue STRING,\\n\" +\r\n            \"   user_name STRING\\n\" +\r\n            \" )\\n\" +\r\n            \" STORED BY 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'\";\r\n    shell.executeStatement(mr_job_info);\r\n    shell.executeStatement(\"INSERT INTO mr_job_info VALUES ('APP-1','QUEUE-1', 'openinx')\");\r\n\r\n    String query = \"SELECT\\n\" +\r\n            \"    j.user_name\\n\" +\r\n            \"FROM\\n\" +\r\n            \"    process_info r\\n\" +\r\n            \"    JOIN mr_job_info j ON \\n\" +\r\n            \"        j.application_id = r.application_id\\n\";\r\n    shell.executeStatement(query);\r\n  }\r\n```\r\n\r\nThe explain plan is this:\r\n```\r\n\r\nSTAGE DEPENDENCIES:\r\n  Stage-1 is a root stage\r\n  Stage-0 depends on stages: Stage-1\r\n\r\nSTAGE PLANS:\r\n  Stage: Stage-1\r\n    Map Reduce\r\n      Map Operator Tree:\r\n          TableScan\r\n            alias: r\r\n            filterExpr: application_id is not null (type: boolean)\r\n            Statistics: Num rows: 1 Data size: 2055 Basic stats: COMPLETE Column stats: NONE\r\n            Filter Operator\r\n              predicate: application_id is not null (type: boolean)\r\n              Statistics: Num rows: 1 Data size: 2055 Basic stats: COMPLETE Column stats: NONE\r\n              Select Operator\r\n                expressions: application_id (type: string)\r\n                outputColumnNames: _col0\r\n                Statistics: Num rows: 1 Data size: 2055 Basic stats: COMPLETE Column stats: NONE\r\n                Reduce Output Operator\r\n                  key expressions: _col0 (type: string)\r\n                  sort order: +\r\n                  Map-reduce partition columns: _col0 (type: string)\r\n                  Statistics: Num rows: 1 Data size: 2055 Basic stats: COMPLETE Column stats: NONE\r\n          TableScan\r\n            alias: j\r\n            filterExpr: application_id is not null (type: boolean)\r\n            Statistics: Num rows: 1 Data size: 1014 Basic stats: COMPLETE Column stats: NONE\r\n            Filter Operator\r\n              predicate: application_id is not null (type: boolean)\r\n              Statistics: Num rows: 1 Data size: 1014 Basic stats: COMPLETE Column stats: NONE\r\n              Select Operator\r\n                expressions: application_id (type: string), user_name (type: string)\r\n                outputColumnNames: _col0, _col1\r\n                Statistics: Num rows: 1 Data size: 1014 Basic stats: COMPLETE Column stats: NONE\r\n                Reduce Output Operator\r\n                  key expressions: _col0 (type: string)\r\n                  sort order: +\r\n                  Map-reduce partition columns: _col0 (type: string)\r\n                  Statistics: Num rows: 1 Data size: 1014 Basic stats: COMPLETE Column stats: NONE\r\n                  value expressions: _col1 (type: string)\r\n      Reduce Operator Tree:\r\n        Join Operator\r\n          condition map:\r\n               Inner Join 0 to 1\r\n          keys:\r\n            0 _col0 (type: string)\r\n            1 _col0 (type: string)\r\n          outputColumnNames: _col2\r\n          Statistics: Num rows: 1 Data size: 2260 Basic stats: COMPLETE Column stats: NONE\r\n          Select Operator\r\n            expressions: _col2 (type: string)\r\n            outputColumnNames: _col0\r\n            Statistics: Num rows: 1 Data size: 2260 Basic stats: COMPLETE Column stats: NONE\r\n            File Output Operator\r\n              compressed: false\r\n              Statistics: Num rows: 1 Data size: 2260 Basic stats: COMPLETE Column stats: NONE\r\n              table:\r\n                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat\r\n                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\r\n                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\r\n\r\n  Stage: Stage-0\r\n    Fetch Operator\r\n      limit: -1\r\n      Processor Tree:\r\n        ListSink\r\n```\r\n\r\nThe issue is that 2 `TableScanOperator`s are running in the same `Map` and they are using the same HiveConf (which contains the column pruning information). This is the fix for Hive:\r\n```\r\ndiff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/MapOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/MapOperator.java\r\nindex ea8e634484..c921cf68e1 100644\r\n--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/MapOperator.java\r\n+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/MapOperator.java\r\n@@ -369,10 +369,13 @@ else if (partRawRowObjectInspector.equals(tblRawRowObjectInspector)) {\r\n         if (!tableNameToConf.containsKey(tableName)) {\r\n           Configuration clonedConf = new Configuration(hconf);\r\n           clonedConf.unset(ColumnProjectionUtils.READ_NESTED_COLUMN_PATH_CONF_STR);\r\n+          clonedConf.unset(ColumnProjectionUtils.READ_COLUMN_NAMES_CONF_STR);\r\n+          clonedConf.unset(ColumnProjectionUtils.READ_COLUMN_IDS_CONF_STR);\r\n           tableNameToConf.put(tableName, clonedConf);\r\n         }\r\n         Configuration newConf = tableNameToConf.get(tableName);\r\n-        ColumnProjectionUtils.appendNestedColumnPaths(newConf, nestedColumnPaths);\r\n+        ColumnProjectionUtils.appendReadColumns(newConf, tableScanDesc.getNeededColumnIDs(),\r\n+            tableScanDesc.getOutputColumnNames(), tableScanDesc.getNeededNestedColumnPaths());\r\n       }\r\n     }\r\n```\r\n\r\nHave to think about how to push the fix to Hive, as MR is deprecated there and the problem does not occur with Tez.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961111912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961114286","html_url":"https://github.com/apache/iceberg/pull/3301#issuecomment-961114286","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3301","id":961114286,"node_id":"IC_kwDOCW7NX845SXCu","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T14:57:57Z","updated_at":"2021-11-04T14:57:57Z","author_association":"MEMBER","body":"I'm not I'm comfortable with this approach, I feel like we are just adding another tuning parameter which will be very difficult to understand. I think we should focus more on automatic approaches. It would also help if we updated the title of this PR to reflect what it is attempting to do.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961114286/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961224474","html_url":"https://github.com/apache/iceberg/pull/3469#issuecomment-961224474","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3469","id":961224474,"node_id":"IC_kwDOCW7NX845Sx8a","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T16:44:44Z","updated_at":"2021-11-04T16:44:44Z","author_association":"MEMBER","body":"@RussellSpitzer : I think as discussion going on in slack. Indent was changed to 4 space instead of 2 space some how. I had to manually revert as reformatting whole code will change things again. \r\nI have finished. Please have a look at it again. Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961224474/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961269406","html_url":"https://github.com/apache/iceberg/issues/3447#issuecomment-961269406","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3447","id":961269406,"node_id":"IC_kwDOCW7NX845S86e","user":{"login":"myandpr","id":20159351,"node_id":"MDQ6VXNlcjIwMTU5MzUx","avatar_url":"https://avatars.githubusercontent.com/u/20159351?v=4","gravatar_id":"","url":"https://api.github.com/users/myandpr","html_url":"https://github.com/myandpr","followers_url":"https://api.github.com/users/myandpr/followers","following_url":"https://api.github.com/users/myandpr/following{/other_user}","gists_url":"https://api.github.com/users/myandpr/gists{/gist_id}","starred_url":"https://api.github.com/users/myandpr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/myandpr/subscriptions","organizations_url":"https://api.github.com/users/myandpr/orgs","repos_url":"https://api.github.com/users/myandpr/repos","events_url":"https://api.github.com/users/myandpr/events{/privacy}","received_events_url":"https://api.github.com/users/myandpr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T17:36:51Z","updated_at":"2021-11-04T17:36:51Z","author_association":"CONTRIBUTOR","body":"> A few things are possible that I can think of. First and foremost, you should check out the docs on:\r\n> \r\n> * table maintenance https://iceberg.apache.org/#maintenance/#table-maintenance\r\n> * streaming table maintenance: https://iceberg.apache.org/#spark-structured-streaming/#maintenance-for-streaming-tables\r\n> \r\n> If you're running the expire snapshots operation, keep in mind that there is the option for how many days worth of data do you want to retain. By default, the spark action to expire snapshots retains 5 days worth of snapshots, which would explain why no files are being removed.\r\n> \r\n> When you run the expire snapshots job, do you see any logs saying things are enabled? Some links that might help:\r\n> \r\n> * Javadoc for the action itself: https://iceberg.apache.org/#javadoc/0.12.0/org/apache/iceberg/ExpireSnapshots.html\r\n> * Docs for the options from the Spark maintenance actions: https://iceberg.apache.org/#spark-procedures/#metadata-management\r\n> \r\n> I'd also make sure that your table doesn't have `gc.enabled = true` as a table property. If that's set to `false` (default should be `true`), then files won't be removed regardless.\r\n> \r\n> Additionally, it's possible that you have orphan files from commits that did not succeed and needed to be retried. You should also run the `remove orphan files` action: https://iceberg.apache.org/#maintenance/#remove-orphan-files\r\n> \r\n> How are you running the actions? With Java code or with Spark? I don't believe that Flink presently supports all of the maintenance procedures. Either way, given that it's only 10 hours worth of data, you'll definitely need to pass in the timestamp you want to expire older than.\r\n> \r\n> Try it out, ensuring that you pass in something for the `older_than` field of the Spark procedure (or the equivalent method if using the Java API). Something like `now() - INTERVAL '4 hours'` or `System.currentTimeMillis - (Duration.ofHours(4).getSeconds() * 1000)` or something.\r\n> \r\n> Let us know if that solves your problem, particularly passing in a maximum age of files to keep. The default is well over 10 hours in all cases.\r\n\r\nHi, @kbendick ,I have been confused whether this action [RewriteDataFilesAction](https://github.com/apache/iceberg/blob/master/flink/src/main/java/org/apache/iceberg/flink/actions/RewriteDataFilesAction.java) in Flink supports v2 table?I mean that whether this action can rewrite equality delete files and position delete files in 'merge on read' mode.\r\n\r\nCould you explain to me？thinks very much!\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961269406/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961277912","html_url":"https://github.com/apache/iceberg/pull/3463#issuecomment-961277912","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3463","id":961277912,"node_id":"IC_kwDOCW7NX845S-_Y","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T17:46:46Z","updated_at":"2021-11-04T17:46:46Z","author_association":"CONTRIBUTOR","body":"> changes make sense, what about preventing usage of org.apache.parquet.Preconditions? I believe this is also being used unintentionally at a few places\r\n\r\nsounds good, I also want to block the use of `org.apache.commons.io.IOUtils` in favor of Guava `ByteStreams`, let me put up another PR for these 2 to avoid too many changes in a single PR.\r\n\r\nI will go ahead to merge this one, thanks for the reviews!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961277912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961283753","html_url":"https://github.com/apache/iceberg/pull/3468#issuecomment-961283753","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3468","id":961283753,"node_id":"IC_kwDOCW7NX845TAap","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T17:54:59Z","updated_at":"2021-11-04T17:54:59Z","author_association":"CONTRIBUTOR","body":"@yyanyy could you also take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961283753/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961297351","html_url":"https://github.com/apache/iceberg/issues/3465#issuecomment-961297351","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3465","id":961297351,"node_id":"IC_kwDOCW7NX845TDvH","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T18:13:14Z","updated_at":"2021-11-04T18:13:14Z","author_association":"CONTRIBUTOR","body":"@KnightChess thanks! assigned","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961297351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961298893","html_url":"https://github.com/apache/iceberg/pull/3454#issuecomment-961298893","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3454","id":961298893,"node_id":"IC_kwDOCW7NX845TEHN","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T18:15:28Z","updated_at":"2021-11-04T18:15:28Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi any additional comments? Otherwise I think this is mostly ready to be merged","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961298893/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961300390","html_url":"https://github.com/apache/iceberg/pull/3468#issuecomment-961300390","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3468","id":961300390,"node_id":"IC_kwDOCW7NX845TEem","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T18:17:33Z","updated_at":"2021-11-04T18:17:33Z","author_association":"CONTRIBUTOR","body":"Cool, will merge after CI passes","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961300390/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961308952","html_url":"https://github.com/apache/iceberg/pull/3326#issuecomment-961308952","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3326","id":961308952,"node_id":"IC_kwDOCW7NX845TGkY","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T18:29:22Z","updated_at":"2021-11-04T18:29:22Z","author_association":"CONTRIBUTOR","body":"Sorry I am a bit late to the whole conversation. @rymurr @rdblue I remember we went through the exact same lines of thoughts when we introduced Glue and Nessie catalogs, and there was an attempt to do exactly this, but ended up not merged because:\r\n1. difference between Flink and Spark, with the confusing term of `type`. Even with a unification, Trino itself has it's own `CatalogType` https://github.com/trinodb/trino/blob/master/plugin/trino-iceberg/src/main/java/io/trino/plugin/iceberg/CatalogType.java (PrestoDB as well) and we will never unify everything\r\n2. by enabling catalog type, we are forcing everyone to register the catalog as a type which is just more work without too much benefit compared to using `impl` for all new catalogs, and only keep `type` for backwards compatibility. There will always be private catalog implementations that you cannot express as an open source type and has to be loaded using `impl` anyway.\r\n\r\nAre we trying to revisit the decision made back then? if so, what are some new reasons to add types now?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961308952/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961362777","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-961362777","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":961362777,"node_id":"IC_kwDOCW7NX845TTtZ","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T19:45:12Z","updated_at":"2021-11-04T19:45:12Z","author_association":"CONTRIBUTOR","body":"@huaxingao I'm guessing that if there is an AS OF clause in the SQL query, you will call `CatalogV2Util.loadTable(CatalogPlugin, Identifier, String)` but if there isn't an AS OF clause, `CatalogV2Util.loadTable(CatalogPlugin, Identifier)` will be called. Is that right?\r\n\r\nThe problem is that we need to support using the DataFrame API with  `.option(\"snapshot-id\", ...)` or `.option(\"as-of-timestamp\", ...)` as well. In those cases, `CatalogV2Util.loadTable(CatalogPlugin, Identifier)` will be called. In this code path, the `Identifier` is provided by `IcebergSource` (which implements `SupportsCatalogOptions`) via `extractIdentifier`. Ideally, `Identifier` has a `version` field, so we can set it in the `Identifier` we return in `IcebergSource#extractIdentifier`. But if `Identifier` cannot be changed to support `version`, then this is less convenient for us. What I did previously in earlier iterations of #1508 is to create a `SnapshotAwareIdentifier` in Iceberg that extends `Identifier`, and return that in `IcebergSource#extractIdentifier`. (Then in `SparkCatalog#loadTable(Identifier)` use the `SnapshotAwareIdentifier` to identify the snapshot.)\r\n\r\n@rdblue what are your thoughts on this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961362777/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961365491","html_url":"https://github.com/apache/iceberg/pull/3301#issuecomment-961365491","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3301","id":961365491,"node_id":"IC_kwDOCW7NX845TUXz","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T19:49:22Z","updated_at":"2021-11-04T19:49:22Z","author_association":"CONTRIBUTOR","body":"I am a bit concerned with ignoring the delete file size. When planning tasks, it does make sense to include delete file size to calculation because each task takes resources from an executor to process and ignoring deletes would cause issue when there are very large delete files.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961365491/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961372753","html_url":"https://github.com/apache/iceberg/issues/3464#issuecomment-961372753","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3464","id":961372753,"node_id":"IC_kwDOCW7NX845TWJR","user":{"login":"CircArgs","id":35903677,"node_id":"MDQ6VXNlcjM1OTAzNjc3","avatar_url":"https://avatars.githubusercontent.com/u/35903677?v=4","gravatar_id":"","url":"https://api.github.com/users/CircArgs","html_url":"https://github.com/CircArgs","followers_url":"https://api.github.com/users/CircArgs/followers","following_url":"https://api.github.com/users/CircArgs/following{/other_user}","gists_url":"https://api.github.com/users/CircArgs/gists{/gist_id}","starred_url":"https://api.github.com/users/CircArgs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CircArgs/subscriptions","organizations_url":"https://api.github.com/users/CircArgs/orgs","repos_url":"https://api.github.com/users/CircArgs/repos","events_url":"https://api.github.com/users/CircArgs/events{/privacy}","received_events_url":"https://api.github.com/users/CircArgs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T19:59:55Z","updated_at":"2021-11-04T19:59:55Z","author_association":"CONTRIBUTOR","body":"@jun-he could you elaborate a little more? It seems these fixed types are just for raw bytes. What prevents a singular type like one having a `length` attribute?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961372753/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961384146","html_url":"https://github.com/apache/iceberg/issues/3281#issuecomment-961384146","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3281","id":961384146,"node_id":"IC_kwDOCW7NX845TY7S","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T20:16:23Z","updated_at":"2021-11-04T20:16:23Z","author_association":"MEMBER","body":"Marking this as another good first issue for anyone who wants to get started on Iceberg :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961384146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961403518","html_url":"https://github.com/apache/iceberg/pull/3392#issuecomment-961403518","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3392","id":961403518,"node_id":"IC_kwDOCW7NX845Tdp-","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T20:43:33Z","updated_at":"2021-11-04T20:43:33Z","author_association":"CONTRIBUTOR","body":"Proposed fix for Hive: https://github.com/apache/hive/pull/2765","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961403518/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961444567","html_url":"https://github.com/apache/iceberg/pull/3387#issuecomment-961444567","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3387","id":961444567,"node_id":"IC_kwDOCW7NX845TnrX","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T21:32:30Z","updated_at":"2021-11-04T21:32:30Z","author_association":"CONTRIBUTOR","body":"> I remember seeing comments in the past around creating configurations dynamically that it would be hard to find out how a config is used as we cannot search for the full config string\r\n\r\nYeah I actually said that lol. The issue here is that we already have options and their defaults all over the place, so I feel it's better in this case to just provide a systematic way to build table properties when people see an action's config option, rather than explicitly listing everything. Let's see how others think about this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961444567/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961447683","html_url":"https://github.com/apache/iceberg/pull/3207#issuecomment-961447683","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3207","id":961447683,"node_id":"IC_kwDOCW7NX845TocD","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T21:36:32Z","updated_at":"2021-11-04T21:36:32Z","author_association":"CONTRIBUTOR","body":"for people who follow this PR, I have not updated it because of the ongoing discussion on Slack: https://apache-iceberg.slack.com/archives/C02JDAQF81E/p1635922079047800","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961447683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961449718","html_url":"https://github.com/apache/iceberg/pull/3454#issuecomment-961449718","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3454","id":961449718,"node_id":"IC_kwDOCW7NX845To72","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T21:39:16Z","updated_at":"2021-11-04T21:39:16Z","author_association":"CONTRIBUTOR","body":"Looks like there are a few approvals here. Given that @RussellSpitzer who implemented this part of the code approved, I will wait until EOD today, if there is no additional comments, I will merge this, thanks everyone.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961449718/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961465752","html_url":"https://github.com/apache/iceberg/pull/3434#issuecomment-961465752","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3434","id":961465752,"node_id":"IC_kwDOCW7NX845Ts2Y","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T22:00:39Z","updated_at":"2021-11-04T22:11:58Z","author_association":"CONTRIBUTOR","body":"I am fine with copying all code to version specific module so that we don't have to decide which classes kept in common module vs version modules. This would be consistent with Spark version handling too.\r\n\r\nI would ask we also duplicate the code in 1.12 and 1.13 too. FLIP-27 Flink source will have different code in 1.13. We may even skip 1.12 for FLIP-27 source. Then I can start with the FLIP-27 source in 1.13 only. After it is done, we can copy code to 1.14 module.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961465752/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961510798","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-961510798","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":961510798,"node_id":"IC_kwDOCW7NX845T32O","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T23:36:38Z","updated_at":"2021-11-04T23:36:38Z","author_association":"CONTRIBUTOR","body":"@wypoon I understand the problem, but my proposal to add `version` in `Identifier ` was not accepted. There are some concerns that the change may affect other code paths.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961510798/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961513673","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-961513673","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":961513673,"node_id":"IC_kwDOCW7NX845T4jJ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T23:41:08Z","updated_at":"2021-11-04T23:42:52Z","author_association":"CONTRIBUTOR","body":"@huaxingao, I agree with the direction to not add a version to Identifier. Adding a method to the catalog that can load different versions is a good idea. If we have two different `AS OF` clauses, I think that we should have two separate ways of passing the version so that we know whether `VERSION AS OF` or `TIMESTAMP AS OF` was used.\r\n\r\nI agree that VERSION should be passed as a string (hopefully an arbitrary one!) and TIMESTAMP as a long in micros from epoch, just like the other timestamps.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961513673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961518873","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-961518873","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":961518873,"node_id":"IC_kwDOCW7NX845T50Z","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T23:48:53Z","updated_at":"2021-11-04T23:48:53Z","author_association":"CONTRIBUTOR","body":"For the branching and time travel discussion, I think it is valuable to be able to use `VERSION AS OF` to select a branch, like `SELECT * FROM db.table VERSION AS OF branch` in addition to `SELECT * FROM db.table VERSION AS OF 39874172309487` with a snapshot ID.\r\n\r\nTime travel by timestamp would then select from the main branch, as was suggested.\r\n\r\nTo support both time travel by timestamp _and_ branches at the same time, I think it is natural to use another level of multi-part identifier, like `db.table.branch`. I think that putting the branch name in the identifier is a more natural way to manage branches in the first place, so it works well with `AS OF` like this: `db.table.branch TIMESTAMP AS OF 2021-11-04T10:00:00`.\r\n\r\nThe reason why I think we should consider supporting a branch name in `VERSION AS OF` is so that we have something that may be portable across systems that don't support more than db and table in table identifiers, like Trino.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961518873/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961520437","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-961520437","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":961520437,"node_id":"IC_kwDOCW7NX845T6M1","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T23:53:07Z","updated_at":"2021-11-04T23:53:07Z","author_association":"CONTRIBUTOR","body":"@wypoon and others. For our next release, should we add something like this PR so that we can fix schemas with time travel in Spark 3.0? We don't have to document that we support time travel through table identifiers so that we can remove it later and replace it with the `AS OF` syntax. What do you think?\r\n\r\n@huaxingao, one more thing to consider on your PR is how to update `SupportsCatalogOptions` to be able to pass the time travel information. Otherwise, I don't think that @wypoon would be able to make the `DataFrameReader` API work with time travel and the snapshot's schema.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961520437/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961522740","html_url":"https://github.com/apache/iceberg/pull/3434#issuecomment-961522740","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3434","id":961522740,"node_id":"IC_kwDOCW7NX845T6w0","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-04T23:59:24Z","updated_at":"2021-11-04T23:59:24Z","author_association":"CONTRIBUTOR","body":"I don't have a preference about this for Flink. I think that copying will work well for Spark, but I think it's up to the people working on Flink whether to use the same strategy.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961522740/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961526828","html_url":"https://github.com/apache/iceberg/pull/3455#issuecomment-961526828","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3455","id":961526828,"node_id":"IC_kwDOCW7NX845T7ws","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T00:08:21Z","updated_at":"2021-11-05T00:08:21Z","author_association":"CONTRIBUTOR","body":"> I'll open a discussion on the dev list (or look for an existing one).\r\n\r\nThank you, I have replied in the thread. This PR looks good to me overall, I will merge by EOD if there is no additional concern.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961526828/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961533148","html_url":"https://github.com/apache/iceberg/pull/3448#issuecomment-961533148","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3448","id":961533148,"node_id":"IC_kwDOCW7NX845T9Tc","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T00:22:31Z","updated_at":"2021-11-05T00:25:24Z","author_association":"CONTRIBUTOR","body":"Question: If you add `engine.hive.enabled = true` as a table property via `ALTER TBABLE glue_catalog.db.tbl_name SET TBLPROPERTIES('engine.hive.enabled'='true')`, does that resolve this issue?\r\n\r\nIf that resolves the issue, I'd personally prefer that as that is already part of the Iceberg library and it's one less difference to have to think about (it's needed to use Hive at all anyway so I think that might be the issue).\r\n\r\nRelevant docs: https://iceberg.apache.org/hive/#table-property-configuration\r\n\r\nThanks for the code link to where you found those. I'm not well versed enough in Glue to make a comment on this, but I'd check if `engine.hive.enabled` works first and foremost.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961533148/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961563492","html_url":"https://github.com/apache/iceberg/pull/3287#issuecomment-961563492","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3287","id":961563492,"node_id":"IC_kwDOCW7NX845UEtk","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T01:45:59Z","updated_at":"2021-11-05T05:47:03Z","author_association":"CONTRIBUTOR","body":"Hi @aokolnychyi, shaded it in Spark3.2. I'm not sure why Spark3 failed without roaringbitmap, 3.1 doesn't, so I removed the dependent in 3.1. I have compared both build.gradle and setting.gradle between 3.0 and 3.1. No suspicious place is found. There could be a bug in gradle, or an hidden config issue. And it may be not directly related to this change.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961563492/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961582176","html_url":"https://github.com/apache/iceberg/pull/3301#issuecomment-961582176","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3301","id":961582176,"node_id":"IC_kwDOCW7NX845UJRg","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T02:36:20Z","updated_at":"2021-11-05T02:36:20Z","author_association":"CONTRIBUTOR","body":"> I'm not I'm comfortable with this approach, I feel like we are just adding another tuning parameter which will be very difficult to understand. I think we should focus more on automatic approaches. It would also help if we updated the title of this PR to reflect what it is attempting to do. \r\n\r\n@RussellSpitzer `plan-tasks-ignore-delete-files-weight` is only used internally, just like `file-scan-task-set-id`. And also thanks for the suggestion.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961582176/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961584838","html_url":"https://github.com/apache/iceberg/pull/3448#issuecomment-961584838","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3448","id":961584838,"node_id":"IC_kwDOCW7NX845UJ7G","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T02:43:42Z","updated_at":"2021-11-05T02:46:40Z","author_association":"CONTRIBUTOR","body":"@kbendick thanks for the comment, I somehow ignored this PR, my bad.\r\n\r\nI believe we have merged the correct fix you made in #3468, so we can close this one @tomtongue \r\n\r\nFor anyone with the same line of thought, there were a few attempts to add this already in the past. However, as you see the input and out format and serdes you set here are really just \"hacks\" to make Hive happy, they are not actually the correct information in the table, adding that would just mislead users. \r\n\r\nBy not setting these values, we are trying to ask people to follow the right way to use an Iceberg catalog in the Hive engine, and Glue here is just an implementation of that Iceberg catalog interface similar to any other implementations out there. I don't want to create this backdoor for only GlueCatalog simply based on the argument that Glue is \"Hive compatible\", as in fact it is not Hive 2 and 3 compatible especially in the write path.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961584838/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961585446","html_url":"https://github.com/apache/iceberg/pull/3301#issuecomment-961585446","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3301","id":961585446,"node_id":"IC_kwDOCW7NX845UKEm","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T02:45:27Z","updated_at":"2021-11-05T02:45:27Z","author_association":"CONTRIBUTOR","body":"> I am a bit concerned with ignoring the delete file size. When planning tasks, it does make sense to include delete file size to calculation because each task takes resources from an executor to process and ignoring deletes would cause issue when there are very large delete files.\r\n\r\nYeah, I agree that. Maybe we should take into the delete files when calculating the `split file size`. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961585446/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961587324","html_url":"https://github.com/apache/iceberg/pull/3434#issuecomment-961587324","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3434","id":961587324,"node_id":"IC_kwDOCW7NX845UKh8","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T02:51:21Z","updated_at":"2021-11-05T03:01:35Z","author_association":"MEMBER","body":"> I would ask we also duplicate the code in 1.12 and 1.13 too. FLIP-27 Flink source will have different code in 1.13. We may even skip 1.12 for FLIP-27 source. Then I can start with the FLIP-27 source in 1.13 only.\r\n\r\nThe FLIP-27 API changes between 1.12 and 1.13 is caused by this [FLINK-22133](https://issues.apache.org/jira/browse/FLINK-22133),  the flink changed the basic snapshotState API, that means when  @stevenzwu develop the flip-27 source reader , he will encounter the same problem as I have encountered in this issue.  If we plan to keep the flink common codes in `iceberg-flink`,  then we need to pick up all the upper layer classes which is built on top of `snapshotState` API to the `:iceberg-flink:iceberg-flink-1.12` and `:iceberg-flink:iceberg-flink-1.13`.  I have tried to do the pick up when supporting flink 1.14, this is a very tedious and error-prone work.   so finally,  I gave up the picking up work and turned to clone a same code base for flink 1.14.\r\n\r\nAs the increase of newly introduced features for flink+iceberg integration work,  I think we will encounter more and more under layer API changes ,  that means we will need to copy more and more classes from the common flink module to the specific versioned module.  Rather than splitting the work among different Flink contributors (It is very easy to miss classes during development and review, resulting in missing tests and features), I will prefer to clone the separate code base for each flink specified version. \r\n\r\nIn last week, I prefer to share the common code for flink 1.12 & flink1.13. But I changed my mind when I port the integration work for flink1.14 and realize that @stevenzwu 's flip-27 is encountering the similar issue.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961587324/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961604192","html_url":"https://github.com/apache/iceberg/pull/3448#issuecomment-961604192","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3448","id":961604192,"node_id":"IC_kwDOCW7NX845UOpg","user":{"login":"tomtongue","id":43331405,"node_id":"MDQ6VXNlcjQzMzMxNDA1","avatar_url":"https://avatars.githubusercontent.com/u/43331405?v=4","gravatar_id":"","url":"https://api.github.com/users/tomtongue","html_url":"https://github.com/tomtongue","followers_url":"https://api.github.com/users/tomtongue/followers","following_url":"https://api.github.com/users/tomtongue/following{/other_user}","gists_url":"https://api.github.com/users/tomtongue/gists{/gist_id}","starred_url":"https://api.github.com/users/tomtongue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomtongue/subscriptions","organizations_url":"https://api.github.com/users/tomtongue/orgs","repos_url":"https://api.github.com/users/tomtongue/repos","events_url":"https://api.github.com/users/tomtongue/events{/privacy}","received_events_url":"https://api.github.com/users/tomtongue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T03:39:47Z","updated_at":"2021-11-05T03:51:08Z","author_association":"CONTRIBUTOR","body":"Thanks for your suggestion and comment for this, @kbendick @jackye1995 .\r\nActually I tried using hive engine enabled option, however it didn't work well, failed with ` org.apache.hadoop.hive.ql.metadata.HiveException: Unable to fetch table iceberg_1636005278. StorageDescriptor#InputFormat cannot be null for table: iceberg_1636005278 (Service: null; Status Code: 0; Error Code: null; Request ID: null; Proxy: null)`. Also the #3468 still doesn't fix this.\r\n\r\nIt's because that renaming a Glue Data Catalog table with SparkSQL itself (not through Iceberg renaming) needs the input/outformat and serdelib in the StorageDescriptor part at least. \r\n\r\nThe Glue Data Catalog doesn't support renaming a table. So if we try renaming the table whose input/output format and serdelib part is filled in, `java.lang.UnsupportedOperationException: Table rename is not supported` error will be thrown. I think this message be expected for users.\r\n\r\nI totally agree your comment on this change, the problem is not critical and the change might not be flexible for the future. However the error message is also a bit misleading and I will think about a better solution.\r\n\r\nClosing this. Thanks for your kind discussion.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961604192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961608528","html_url":"https://github.com/apache/iceberg/pull/3448#issuecomment-961608528","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3448","id":961608528,"node_id":"IC_kwDOCW7NX845UPtQ","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T03:55:06Z","updated_at":"2021-11-05T03:55:06Z","author_association":"CONTRIBUTOR","body":"> Thanks for your suggestion and comment for this, @kbendick @jackye1995 . Actually I tried using hive engine enabled option, however it didn't work well, failed with ` org.apache.hadoop.hive.ql.metadata.HiveException: Unable to fetch table iceberg_1636005278. StorageDescriptor#InputFormat cannot be null for table: iceberg_1636005278 (Service: null; Status Code: 0; Error Code: null; Request ID: null; Proxy: null)`. Also the #3468 still doesn't fix this.\r\n> \r\n> It's because that renaming a Glue Data Catalog table with SparkSQL itself (not through Iceberg renaming) needs the input/outformat and serdelib in the StorageDescriptor part at least.\r\n> \r\n> The Glue Data Catalog doesn't support renaming a table. So if we try renaming the table whose input/output format and serdelib part is filled in, `java.lang.UnsupportedOperationException: Table rename is not supported` error will be thrown. I think this message be expected for users.\r\n> \r\n> I totally agree your comment on this change, the problem is not critical and the change might not be flexible for the future. However the error message is also misleading and I will think about a better solution.\r\n> \r\n> Closing this. Thanks for your kind discussion.\r\n\r\nThank you for your contribution @tomtongue, even if ultimately it wasn’t the right direction as @jackye1995 mentioned. I agree with Jack’s assessment that we should stick to using the Iceberg catalogs as they’re intended and avoid any hacks that might confuse other users. While the error message for Glue users would arguably be a bit more clear (though still an error), people looking through the Iceberg code and people looking to contribute to Iceberg could get very confused about adding in this unnecessary SerDe information. As Jack mentioned, it might also confuse Glue users into thinking that it’s fully Hive compatible (which I can’t speak to personally but can easily know that we should defer to Jack’s expertise in this area).\r\n\r\nThanks for taking the time to submit a patch and for your overall interest in Iceberg. While this patch wasn’t right for the project, we’d absolutely love to have more contributions from you in the future!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961608528/reactions","total_count":2,"+1":1,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961611627","html_url":"https://github.com/apache/iceberg/pull/3445#issuecomment-961611627","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3445","id":961611627,"node_id":"IC_kwDOCW7NX845UQdr","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T04:05:01Z","updated_at":"2021-11-05T04:05:01Z","author_association":"MEMBER","body":"As we are planning to separate the code base for flink 1.12 , flink 1.13, flink 1.14 ( From this [comment1](https://github.com/apache/iceberg/pull/3434#issuecomment-961465752), [comment2](https://github.com/apache/iceberg/pull/3434#issuecomment-961522740), [comment3](https://github.com/apache/iceberg/pull/3434#issuecomment-961587324) ).  We don't need this unit tests change now. Let's close it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961611627/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961655771","html_url":"https://github.com/apache/iceberg/issues/3464#issuecomment-961655771","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3464","id":961655771,"node_id":"IC_kwDOCW7NX845UbPb","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-05T06:26:34Z","updated_at":"2021-11-05T06:27:03Z","author_association":"COLLABORATOR","body":"Sure, following your snippet to define fixed type as follows\r\n```\r\n@handle_null\r\n@dataclass(order=True)\r\nclass Fixed(Type):\r\n    value: bytes\r\n    length: int\r\n...\r\n\r\nfixed = Fixed(string.encode(encoding), 8)\r\n```\r\nwhich is an object with type info and data as well.\r\n\r\nBut we also need a way to indicate `Fixed(8)` type/class without data for many cases. \r\nI am curious if there is a clean way to provide a singular class for this.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/961655771/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]