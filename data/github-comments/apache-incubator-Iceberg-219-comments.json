[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1355443482","html_url":"https://github.com/apache/iceberg/pull/6324#issuecomment-1355443482","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6324","id":1355443482,"node_id":"IC_kwDOCW7NX85Qym0a","user":{"login":"haizhou-zhao","id":6187287,"node_id":"MDQ6VXNlcjYxODcyODc=","avatar_url":"https://avatars.githubusercontent.com/u/6187287?v=4","gravatar_id":"","url":"https://api.github.com/users/haizhou-zhao","html_url":"https://github.com/haizhou-zhao","followers_url":"https://api.github.com/users/haizhou-zhao/followers","following_url":"https://api.github.com/users/haizhou-zhao/following{/other_user}","gists_url":"https://api.github.com/users/haizhou-zhao/gists{/gist_id}","starred_url":"https://api.github.com/users/haizhou-zhao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haizhou-zhao/subscriptions","organizations_url":"https://api.github.com/users/haizhou-zhao/orgs","repos_url":"https://api.github.com/users/haizhou-zhao/repos","events_url":"https://api.github.com/users/haizhou-zhao/events{/privacy}","received_events_url":"https://api.github.com/users/haizhou-zhao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-16T19:04:31Z","updated_at":"2022-12-16T19:04:31Z","author_association":"CONTRIBUTOR","body":"> > Hey folks, comments from last round of review all taken and implemented.\r\n> > Specifically, on one comment: @gaborkaszab @szehon-ho I removed support for changing ownership for tables from this PR. But before I committed to create a follow up PR on that, I want to double check and make sure if you guys feel these worth implementing (which are something we do not have today):\r\n> > \r\n> > 1. When user remove ownership on a table, revert the owner of the table to default owner (current UGI)\r\n> > 2. When user alter the ownership on a table, change the owner of table accordingly\r\n> \r\n> I think it does make sense to have a support for altering ownership. Impala has \"ALTER TABLE xy SET OWNER\" for this purpose, and I guess Hive also has something similar. Yes, the use-cases 1) and 2) you mention make sense for me.\r\n\r\nThank you @gaborkaszab , I create a follow up PR for those use cases.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1355443482/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1355516952","html_url":"https://github.com/apache/iceberg/issues/6397#issuecomment-1355516952","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6397","id":1355516952,"node_id":"IC_kwDOCW7NX85Qy4wY","user":{"login":"rubenvdg","id":37443208,"node_id":"MDQ6VXNlcjM3NDQzMjA4","avatar_url":"https://avatars.githubusercontent.com/u/37443208?v=4","gravatar_id":"","url":"https://api.github.com/users/rubenvdg","html_url":"https://github.com/rubenvdg","followers_url":"https://api.github.com/users/rubenvdg/followers","following_url":"https://api.github.com/users/rubenvdg/following{/other_user}","gists_url":"https://api.github.com/users/rubenvdg/gists{/gist_id}","starred_url":"https://api.github.com/users/rubenvdg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rubenvdg/subscriptions","organizations_url":"https://api.github.com/users/rubenvdg/orgs","repos_url":"https://api.github.com/users/rubenvdg/repos","events_url":"https://api.github.com/users/rubenvdg/events{/privacy}","received_events_url":"https://api.github.com/users/rubenvdg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-16T19:57:45Z","updated_at":"2022-12-16T19:57:45Z","author_association":"CONTRIBUTOR","body":"Yes agreed! It's already part of https://github.com/apache/iceberg/pull/6438, right?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1355516952/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1355517950","html_url":"https://github.com/apache/iceberg/issues/6397#issuecomment-1355517950","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6397","id":1355517950,"node_id":"IC_kwDOCW7NX85Qy4_-","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-16T19:59:00Z","updated_at":"2022-12-16T19:59:00Z","author_association":"CONTRIBUTOR","body":"@rubenvdg Yes, I was doing some refactoring yesterday, and also included it in there üëçüèª  Feel free to review the PR :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1355517950/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1355564692","html_url":"https://github.com/apache/iceberg/pull/6445#issuecomment-1355564692","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6445","id":1355564692,"node_id":"IC_kwDOCW7NX85QzEaU","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-16T20:33:13Z","updated_at":"2022-12-16T20:33:13Z","author_association":"CONTRIBUTOR","body":"Looks good to me! @Fokko, can you take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1355564692/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1355565531","html_url":"https://github.com/apache/iceberg/pull/6444#issuecomment-1355565531","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6444","id":1355565531,"node_id":"IC_kwDOCW7NX85QzEnb","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-16T20:34:06Z","updated_at":"2022-12-16T20:34:06Z","author_association":"CONTRIBUTOR","body":"Thanks, @lvyanquan! This looks great.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1355565531/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1355567338","html_url":"https://github.com/apache/iceberg/pull/6441#issuecomment-1355567338","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6441","id":1355567338,"node_id":"IC_kwDOCW7NX85QzFDq","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-16T20:35:30Z","updated_at":"2022-12-16T20:35:30Z","author_association":"CONTRIBUTOR","body":"Thanks, @nastra!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1355567338/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1355572986","html_url":"https://github.com/apache/iceberg/pull/6438#issuecomment-1355572986","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6438","id":1355572986,"node_id":"IC_kwDOCW7NX85QzGb6","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-16T20:38:55Z","updated_at":"2022-12-16T20:38:55Z","author_association":"CONTRIBUTOR","body":"Looks good to me! I'm not merging in case you want to move/rename `AvroStruct` since it is really a generic class and not specific to Avro.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1355572986/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1355946472","html_url":"https://github.com/apache/iceberg/pull/6440#issuecomment-1355946472","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6440","id":1355946472,"node_id":"IC_kwDOCW7NX85Q0hno","user":{"login":"xwmr-max","id":61017037,"node_id":"MDQ6VXNlcjYxMDE3MDM3","avatar_url":"https://avatars.githubusercontent.com/u/61017037?v=4","gravatar_id":"","url":"https://api.github.com/users/xwmr-max","html_url":"https://github.com/xwmr-max","followers_url":"https://api.github.com/users/xwmr-max/followers","following_url":"https://api.github.com/users/xwmr-max/following{/other_user}","gists_url":"https://api.github.com/users/xwmr-max/gists{/gist_id}","starred_url":"https://api.github.com/users/xwmr-max/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xwmr-max/subscriptions","organizations_url":"https://api.github.com/users/xwmr-max/orgs","repos_url":"https://api.github.com/users/xwmr-max/repos","events_url":"https://api.github.com/users/xwmr-max/events{/privacy}","received_events_url":"https://api.github.com/users/xwmr-max/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-17T01:43:54Z","updated_at":"2022-12-17T01:43:54Z","author_association":"CONTRIBUTOR","body":"cc @stevenzwu @hililiwei ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1355946472/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356015002","html_url":"https://github.com/apache/iceberg/pull/6428#issuecomment-1356015002","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6428","id":1356015002,"node_id":"IC_kwDOCW7NX85Q0yWa","user":{"login":"dennishuo","id":7410123,"node_id":"MDQ6VXNlcjc0MTAxMjM=","avatar_url":"https://avatars.githubusercontent.com/u/7410123?v=4","gravatar_id":"","url":"https://api.github.com/users/dennishuo","html_url":"https://github.com/dennishuo","followers_url":"https://api.github.com/users/dennishuo/followers","following_url":"https://api.github.com/users/dennishuo/following{/other_user}","gists_url":"https://api.github.com/users/dennishuo/gists{/gist_id}","starred_url":"https://api.github.com/users/dennishuo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dennishuo/subscriptions","organizations_url":"https://api.github.com/users/dennishuo/orgs","repos_url":"https://api.github.com/users/dennishuo/repos","events_url":"https://api.github.com/users/dennishuo/events{/privacy}","received_events_url":"https://api.github.com/users/dennishuo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-17T03:55:16Z","updated_at":"2022-12-17T03:55:16Z","author_association":"CONTRIBUTOR","body":"@nastra Thanks for the thorough review and suggestions! Finished applying all your suggestions, including fully converting to `assertj`/`Assertions` and refactoring out the Namespace<->SnowflakeIdentifier parsing to better encapsulate all the argument-checking/parsing into one place.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356015002/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356061017","html_url":"https://github.com/apache/iceberg/issues/6370#issuecomment-1356061017","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6370","id":1356061017,"node_id":"IC_kwDOCW7NX85Q09lZ","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-17T06:10:17Z","updated_at":"2022-12-17T06:10:17Z","author_association":"CONTRIBUTOR","body":"@InvisibleProgrammer, @TuroczyX: any news about the atomic lock?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356061017/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356083642","html_url":"https://github.com/apache/iceberg/issues/6224#issuecomment-1356083642","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6224","id":1356083642,"node_id":"IC_kwDOCW7NX85Q1DG6","user":{"login":"shardulm94","id":6961317,"node_id":"MDQ6VXNlcjY5NjEzMTc=","avatar_url":"https://avatars.githubusercontent.com/u/6961317?v=4","gravatar_id":"","url":"https://api.github.com/users/shardulm94","html_url":"https://github.com/shardulm94","followers_url":"https://api.github.com/users/shardulm94/followers","following_url":"https://api.github.com/users/shardulm94/following{/other_user}","gists_url":"https://api.github.com/users/shardulm94/gists{/gist_id}","starred_url":"https://api.github.com/users/shardulm94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shardulm94/subscriptions","organizations_url":"https://api.github.com/users/shardulm94/orgs","repos_url":"https://api.github.com/users/shardulm94/repos","events_url":"https://api.github.com/users/shardulm94/events{/privacy}","received_events_url":"https://api.github.com/users/shardulm94/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-17T07:22:01Z","updated_at":"2022-12-17T07:22:01Z","author_association":"CONTRIBUTOR","body":"Hey @maximethebault!\r\nThanks for the report. I investigated this and found that that it is actually a bug in Spark 3.3.1+. I have created [SPARK-41557](https://issues.apache.org/jira/browse/SPARK-41557) against the Spark project to track this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356083642/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356124377","html_url":"https://github.com/apache/iceberg/issues/6370#issuecomment-1356124377","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6370","id":1356124377,"node_id":"IC_kwDOCW7NX85Q1NDZ","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-17T08:53:31Z","updated_at":"2022-12-17T08:53:31Z","author_association":"CONTRIBUTOR","body":"Maybe something like this:\r\n```\r\ndiff --git a/standalone-metastore/metastore-common/src/main/thrift/hive_metastore.thrift b/standalone-metastore/metastore-common/src/main/thrift/hive_metastore.thrift\r\nindex 179a4960b9..6a3f9e40fa 100644\r\n--- a/standalone-metastore/metastore-common/src/main/thrift/hive_metastore.thrift\r\n+++ b/standalone-metastore/metastore-common/src/main/thrift/hive_metastore.thrift\r\n@@ -22,7 +22,7 @@\r\n # Thrift Service that the MetaStore is built on\r\n #\r\n \r\n-include \"share/fb303/if/fb303.thrift\"\r\n+include \"/Users/petervary/tmp/fb303.thrift\"\r\n \r\n namespace java org.apache.hadoop.hive.metastore.api\r\n namespace php metastore\r\n@@ -2165,7 +2165,9 @@ struct AlterTableRequest {\r\n   6: optional i64 writeId=-1,\r\n   7: optional string validWriteIdList\r\n   8: optional list<string> processorCapabilities,\r\n-  9: optional string processorIdentifier\r\n+  9: optional string processorIdentifier,\r\n+  10: optional string expectedPropertyKey,\r\n+  12: optional string expectedPropertyValue\r\n // TODO: also add cascade here, out of envCtx\r\n }\r\n\r\ndiff --git a/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java b/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java\r\nindex 1226cd1a1a..0b12e68401 100644\r\n--- a/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java\r\n+++ b/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java\r\n@@ -102,7 +102,7 @@ public void setConf(Configuration conf) {\r\n   @Override\r\n   public void alterTable(RawStore msdb, Warehouse wh, String catName, String dbname,\r\n       String name, Table newt, EnvironmentContext environmentContext,\r\n-      IHMSHandler handler, String writeIdList)\r\n+      IHMSHandler handler, String writeIdList, String expectedKey, String expectedValue)\r\n           throws InvalidOperationException, MetaException {\r\n     catName = normalizeIdentifier(catName);\r\n     name = name.toLowerCase();\r\n@@ -187,6 +187,11 @@ public void alterTable(RawStore msdb, Warehouse wh, String catName, String dbnam\r\n             TableName.getQualified(catName, dbname, name) + \" doesn't exist\");\r\n       }\r\n \r\n+      if (expectedKey != null && !oldt.getParameters().get(expectedKey).equals(expectedValue)) {\r\n+        throw new MetaException(\"The table already modified. The parameter value for key: \" + expectedKey + \" is \"\r\n+                + oldt.getParameters().get(expectedKey) + \". The expected was value was \" + expectedValue);\r\n+      }\r\n+\r\n       validateTableChangesOnReplSource(olddb, oldt, newt, environmentContext);\r\n \r\n       // On a replica this alter table will be executed only if old and new both the databases are\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356124377/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356227315","html_url":"https://github.com/apache/iceberg/pull/4465#issuecomment-1356227315","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4465","id":1356227315,"node_id":"IC_kwDOCW7NX85Q1mLz","user":{"login":"blcksrx","id":35199552,"node_id":"MDQ6VXNlcjM1MTk5NTUy","avatar_url":"https://avatars.githubusercontent.com/u/35199552?v=4","gravatar_id":"","url":"https://api.github.com/users/blcksrx","html_url":"https://github.com/blcksrx","followers_url":"https://api.github.com/users/blcksrx/followers","following_url":"https://api.github.com/users/blcksrx/following{/other_user}","gists_url":"https://api.github.com/users/blcksrx/gists{/gist_id}","starred_url":"https://api.github.com/users/blcksrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blcksrx/subscriptions","organizations_url":"https://api.github.com/users/blcksrx/orgs","repos_url":"https://api.github.com/users/blcksrx/repos","events_url":"https://api.github.com/users/blcksrx/events{/privacy}","received_events_url":"https://api.github.com/users/blcksrx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-17T12:05:07Z","updated_at":"2022-12-17T12:05:07Z","author_association":"NONE","body":"Any plan to merge this PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356227315/reactions","total_count":4,"+1":4,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356327476","html_url":"https://github.com/apache/iceberg/pull/6379#issuecomment-1356327476","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6379","id":1356327476,"node_id":"IC_kwDOCW7NX85Q1-o0","user":{"login":"InvisibleProgrammer","id":1486749,"node_id":"MDQ6VXNlcjE0ODY3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1486749?v=4","gravatar_id":"","url":"https://api.github.com/users/InvisibleProgrammer","html_url":"https://github.com/InvisibleProgrammer","followers_url":"https://api.github.com/users/InvisibleProgrammer/followers","following_url":"https://api.github.com/users/InvisibleProgrammer/following{/other_user}","gists_url":"https://api.github.com/users/InvisibleProgrammer/gists{/gist_id}","starred_url":"https://api.github.com/users/InvisibleProgrammer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/InvisibleProgrammer/subscriptions","organizations_url":"https://api.github.com/users/InvisibleProgrammer/orgs","repos_url":"https://api.github.com/users/InvisibleProgrammer/repos","events_url":"https://api.github.com/users/InvisibleProgrammer/events{/privacy}","received_events_url":"https://api.github.com/users/InvisibleProgrammer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-17T16:32:10Z","updated_at":"2022-12-17T16:32:10Z","author_association":"CONTRIBUTOR","body":"Hey there!\r\n\r\nWith the help of @pvary , all updates for the older releases are merged. \r\n\r\nI wonder, do you know what is the process of releasing the merged changes? \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356327476/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356353314","html_url":"https://github.com/apache/iceberg/issues/6224#issuecomment-1356353314","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6224","id":1356353314,"node_id":"IC_kwDOCW7NX85Q2E8i","user":{"login":"maximethebault","id":5207923,"node_id":"MDQ6VXNlcjUyMDc5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/5207923?v=4","gravatar_id":"","url":"https://api.github.com/users/maximethebault","html_url":"https://github.com/maximethebault","followers_url":"https://api.github.com/users/maximethebault/followers","following_url":"https://api.github.com/users/maximethebault/following{/other_user}","gists_url":"https://api.github.com/users/maximethebault/gists{/gist_id}","starred_url":"https://api.github.com/users/maximethebault/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maximethebault/subscriptions","organizations_url":"https://api.github.com/users/maximethebault/orgs","repos_url":"https://api.github.com/users/maximethebault/repos","events_url":"https://api.github.com/users/maximethebault/events{/privacy}","received_events_url":"https://api.github.com/users/maximethebault/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-17T17:49:42Z","updated_at":"2022-12-17T17:49:42Z","author_association":"NONE","body":"Thanks for investigating this issue further!\r\nI'll go ahead and close this issue since it isn't Iceberg-related. I'll make sure to keep an eye on the Spark issue you created.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356353314/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356445009","html_url":"https://github.com/apache/iceberg/pull/6428#issuecomment-1356445009","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6428","id":1356445009,"node_id":"IC_kwDOCW7NX85Q2bVR","user":{"login":"dennishuo","id":7410123,"node_id":"MDQ6VXNlcjc0MTAxMjM=","avatar_url":"https://avatars.githubusercontent.com/u/7410123?v=4","gravatar_id":"","url":"https://api.github.com/users/dennishuo","html_url":"https://github.com/dennishuo","followers_url":"https://api.github.com/users/dennishuo/followers","following_url":"https://api.github.com/users/dennishuo/following{/other_user}","gists_url":"https://api.github.com/users/dennishuo/gists{/gist_id}","starred_url":"https://api.github.com/users/dennishuo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dennishuo/subscriptions","organizations_url":"https://api.github.com/users/dennishuo/orgs","repos_url":"https://api.github.com/users/dennishuo/repos","events_url":"https://api.github.com/users/dennishuo/events{/privacy}","received_events_url":"https://api.github.com/users/dennishuo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-17T19:56:00Z","updated_at":"2022-12-17T19:56:00Z","author_association":"CONTRIBUTOR","body":"Interesting, not sure why it removed @danielcweeks when I re-requested review from @nastra (definitely wasn't intentional -- as far as I can tell my repository permissions don't even provide the ability to remove reviewer requests). I wonder if this is possibly another manifestation of https://github.com/community/community/discussions/8939","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356445009/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356511133","html_url":"https://github.com/apache/iceberg/issues/5086#issuecomment-1356511133","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5086","id":1356511133,"node_id":"IC_kwDOCW7NX85Q2red","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T00:11:32Z","updated_at":"2022-12-18T00:11:32Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356511133/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356511150","html_url":"https://github.com/apache/iceberg/issues/4971#issuecomment-1356511150","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4971","id":1356511150,"node_id":"IC_kwDOCW7NX85Q2reu","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T00:11:36Z","updated_at":"2022-12-18T00:11:36Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356511150/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356866645","html_url":"https://github.com/apache/iceberg/pull/6446#issuecomment-1356866645","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6446","id":1356866645,"node_id":"IC_kwDOCW7NX85Q4CRV","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T20:10:51Z","updated_at":"2022-12-18T20:10:51Z","author_association":"CONTRIBUTOR","body":"Thanks, @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356866645/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356866813","html_url":"https://github.com/apache/iceberg/pull/6438#issuecomment-1356866813","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6438","id":1356866813,"node_id":"IC_kwDOCW7NX85Q4CT9","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T20:11:41Z","updated_at":"2022-12-18T20:11:41Z","author_association":"CONTRIBUTOR","body":"Looks like this needs to be rebased.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356866813/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356867159","html_url":"https://github.com/apache/iceberg/pull/6436#issuecomment-1356867159","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6436","id":1356867159,"node_id":"IC_kwDOCW7NX85Q4CZX","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T20:14:01Z","updated_at":"2022-12-18T20:14:01Z","author_association":"CONTRIBUTOR","body":"Looks like this also adds support for the metrics-impl property. Does this replace the other PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356867159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356869306","html_url":"https://github.com/apache/iceberg/pull/6438#issuecomment-1356869306","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6438","id":1356869306,"node_id":"IC_kwDOCW7NX85Q4C66","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T20:27:56Z","updated_at":"2022-12-18T20:27:56Z","author_association":"CONTRIBUTOR","body":"@rdblue rebased! üëçüèª ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356869306/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356891084","html_url":"https://github.com/apache/iceberg/pull/6432#issuecomment-1356891084","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6432","id":1356891084,"node_id":"IC_kwDOCW7NX85Q4IPM","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T22:33:41Z","updated_at":"2022-12-18T22:33:41Z","author_association":"CONTRIBUTOR","body":"I think this looks good. I like how small the change is. Do you think it would be easy to also add a config flag to enable/disable this? I think it technically violates Spark's threading model (where tasks use a single thread) but it does seem useful as an option that can be controlled by admins.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356891084/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356891779","html_url":"https://github.com/apache/iceberg/issues/3220#issuecomment-1356891779","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3220","id":1356891779,"node_id":"IC_kwDOCW7NX85Q4IaD","user":{"login":"srilman","id":17444967,"node_id":"MDQ6VXNlcjE3NDQ0OTY3","avatar_url":"https://avatars.githubusercontent.com/u/17444967?v=4","gravatar_id":"","url":"https://api.github.com/users/srilman","html_url":"https://github.com/srilman","followers_url":"https://api.github.com/users/srilman/followers","following_url":"https://api.github.com/users/srilman/following{/other_user}","gists_url":"https://api.github.com/users/srilman/gists{/gist_id}","starred_url":"https://api.github.com/users/srilman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srilman/subscriptions","organizations_url":"https://api.github.com/users/srilman/orgs","repos_url":"https://api.github.com/users/srilman/repos","events_url":"https://api.github.com/users/srilman/events{/privacy}","received_events_url":"https://api.github.com/users/srilman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T22:37:48Z","updated_at":"2022-12-18T22:41:12Z","author_association":"CONTRIBUTOR","body":"@Fokko Didn't realize that there was a Docker image for REST catalog! We use a very similar Docker Compose setup to test for Hive catalog support, which is great for testing catalog integration. Will definitely look into using this once we add REST catalog support.\r\n\r\nHowever, I think Docker Compose might be a bit too _much_ for our Iceberg unit tests due to start-up times and difficulty to read and modify metadata on the fly. Those were two big benefits of Hadoop tables. If there is a simpler REST catalog server implementation, like as a Python or Node script, that'd be great. Otherwise, I think JDBCCatalog is better for unit testing. Are there plans to add that catalog to PyIceberg?\r\n\r\nEDIT: Looks like there is an issue for it: https://github.com/apache/iceberg/issues/3221\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356891779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356899972","html_url":"https://github.com/apache/iceberg/pull/6426#issuecomment-1356899972","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6426","id":1356899972,"node_id":"IC_kwDOCW7NX85Q4KaE","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T23:15:43Z","updated_at":"2022-12-18T23:15:43Z","author_association":"CONTRIBUTOR","body":"Looks reasonable to me, but I don't have context on the rest of the discussion. Feel free to merge when you both are happy with this, @pvary and @stevenzwu.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356899972/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356901600","html_url":"https://github.com/apache/iceberg/pull/6404#issuecomment-1356901600","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6404","id":1356901600,"node_id":"IC_kwDOCW7NX85Q4Kzg","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T23:23:55Z","updated_at":"2022-12-18T23:23:55Z","author_association":"CONTRIBUTOR","body":"Thanks, @nastra!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356901600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356903295","html_url":"https://github.com/apache/iceberg/pull/6392#issuecomment-1356903295","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6392","id":1356903295,"node_id":"IC_kwDOCW7NX85Q4LN_","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T23:33:55Z","updated_at":"2022-12-18T23:33:55Z","author_association":"CONTRIBUTOR","body":"@cccs-eric, looks like this was out of date. I tried to fix conflicts, but it is failing tests. Can you fix and then we'll merge?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356903295/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356903474","html_url":"https://github.com/apache/iceberg/pull/6369#issuecomment-1356903474","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6369","id":1356903474,"node_id":"IC_kwDOCW7NX85Q4LQy","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T23:34:58Z","updated_at":"2022-12-18T23:34:58Z","author_association":"CONTRIBUTOR","body":"Any update on this? Should we keep it open or are we pursuing other solutions?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356903474/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356903838","html_url":"https://github.com/apache/iceberg/pull/6419#issuecomment-1356903838","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6419","id":1356903838,"node_id":"IC_kwDOCW7NX85Q4LWe","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T23:37:01Z","updated_at":"2022-12-18T23:37:01Z","author_association":"CONTRIBUTOR","body":"@szehon-ho, you're right that Iceberg accepts both. But in Spark, the correct one is to put the width first because that's how Spark validates the function call.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356903838/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356903901","html_url":"https://github.com/apache/iceberg/pull/6419#issuecomment-1356903901","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6419","id":1356903901,"node_id":"IC_kwDOCW7NX85Q4LXd","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T23:37:24Z","updated_at":"2022-12-18T23:37:24Z","author_association":"CONTRIBUTOR","body":"Thanks, @jiamin13579!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356903901/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356904257","html_url":"https://github.com/apache/iceberg/pull/6297#issuecomment-1356904257","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6297","id":1356904257,"node_id":"IC_kwDOCW7NX85Q4LdB","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T23:39:08Z","updated_at":"2022-12-18T23:39:08Z","author_association":"CONTRIBUTOR","body":"@Fokko can you rebase?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356904257/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356904359","html_url":"https://github.com/apache/iceberg/issues/3221#issuecomment-1356904359","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3221","id":1356904359,"node_id":"IC_kwDOCW7NX85Q4Len","user":{"login":"srilman","id":17444967,"node_id":"MDQ6VXNlcjE3NDQ0OTY3","avatar_url":"https://avatars.githubusercontent.com/u/17444967?v=4","gravatar_id":"","url":"https://api.github.com/users/srilman","html_url":"https://github.com/srilman","followers_url":"https://api.github.com/users/srilman/followers","following_url":"https://api.github.com/users/srilman/following{/other_user}","gists_url":"https://api.github.com/users/srilman/gists{/gist_id}","starred_url":"https://api.github.com/users/srilman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srilman/subscriptions","organizations_url":"https://api.github.com/users/srilman/orgs","repos_url":"https://api.github.com/users/srilman/repos","events_url":"https://api.github.com/users/srilman/events{/privacy}","received_events_url":"https://api.github.com/users/srilman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T23:39:43Z","updated_at":"2022-12-18T23:39:43Z","author_association":"CONTRIBUTOR","body":"Will this catalog be based off the JDBC interface like the Java implementation or will it use Python's DB API (https://peps.python.org/pep-0249, many DB libraries follow this API)? I think the latter would be preferable.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356904359/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356905016","html_url":"https://github.com/apache/iceberg/pull/6335#issuecomment-1356905016","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6335","id":1356905016,"node_id":"IC_kwDOCW7NX85Q4Lo4","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T23:43:18Z","updated_at":"2022-12-18T23:43:18Z","author_association":"CONTRIBUTOR","body":"This seems like a reasonable thing to add to me. I'm actually more concerned about the use case that caused this.\r\n\r\n@ConeyLiu, what was the case where you were creating huge manifests? How many data files were committed?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356905016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356905240","html_url":"https://github.com/apache/iceberg/pull/6274#issuecomment-1356905240","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6274","id":1356905240,"node_id":"IC_kwDOCW7NX85Q4LsY","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T23:44:48Z","updated_at":"2022-12-18T23:44:48Z","author_association":"CONTRIBUTOR","body":"Thanks, @nastra!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356905240/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356906835","html_url":"https://github.com/apache/iceberg/pull/6223#issuecomment-1356906835","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6223","id":1356906835,"node_id":"IC_kwDOCW7NX85Q4MFT","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T23:53:28Z","updated_at":"2022-12-18T23:53:28Z","author_association":"CONTRIBUTOR","body":"Running CI.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356906835/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356907182","html_url":"https://github.com/apache/iceberg/pull/6293#issuecomment-1356907182","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6293","id":1356907182,"node_id":"IC_kwDOCW7NX85Q4MKu","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T23:55:38Z","updated_at":"2022-12-18T23:55:38Z","author_association":"CONTRIBUTOR","body":"Thanks, @pavibhai! Great to have this fixed, even if it's a hack :sweat_smile:.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356907182/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356907875","html_url":"https://github.com/apache/iceberg/pull/6190#issuecomment-1356907875","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6190","id":1356907875,"node_id":"IC_kwDOCW7NX85Q4MVj","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-18T23:59:22Z","updated_at":"2022-12-18T23:59:22Z","author_association":"CONTRIBUTOR","body":"Thanks, @singhpk234!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356907875/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356908254","html_url":"https://github.com/apache/iceberg/pull/6250#issuecomment-1356908254","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6250","id":1356908254,"node_id":"IC_kwDOCW7NX85Q4Mbe","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T00:00:59Z","updated_at":"2022-12-19T00:00:59Z","author_association":"CONTRIBUTOR","body":"I don't think this is a good idea and is pretty minor either way. I'm going to close it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356908254/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356908424","html_url":"https://github.com/apache/iceberg/pull/6234#issuecomment-1356908424","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6234","id":1356908424,"node_id":"IC_kwDOCW7NX85Q4MeI","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T00:01:33Z","updated_at":"2022-12-19T00:01:33Z","author_association":"CONTRIBUTOR","body":"Thanks, @ajantha-bhat!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356908424/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356908698","html_url":"https://github.com/apache/iceberg/pull/6348#issuecomment-1356908698","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6348","id":1356908698,"node_id":"IC_kwDOCW7NX85Q4Mia","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T00:02:21Z","updated_at":"2022-12-19T00:02:21Z","author_association":"CONTRIBUTOR","body":"@Fokko, what do you think about using the same license check script (copied) that we do in the Java version?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356908698/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356910794","html_url":"https://github.com/apache/iceberg/pull/6267#issuecomment-1356910794","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6267","id":1356910794,"node_id":"IC_kwDOCW7NX85Q4NDK","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T00:08:22Z","updated_at":"2022-12-19T00:08:22Z","author_association":"CONTRIBUTOR","body":"Thanks, @ajantha-bhat! Merging this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356910794/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356911365","html_url":"https://github.com/apache/iceberg/pull/6246#issuecomment-1356911365","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6246","id":1356911365,"node_id":"IC_kwDOCW7NX85Q4NMF","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T00:09:55Z","updated_at":"2022-12-19T00:09:55Z","author_association":"CONTRIBUTOR","body":"@nastra looks like this is out of date. Can you rebase?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356911365/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356911707","html_url":"https://github.com/apache/iceberg/issues/5103#issuecomment-1356911707","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5103","id":1356911707,"node_id":"IC_kwDOCW7NX85Q4NRb","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T00:11:01Z","updated_at":"2022-12-19T00:11:01Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356911707/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356911714","html_url":"https://github.com/apache/iceberg/issues/5098#issuecomment-1356911714","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5098","id":1356911714,"node_id":"IC_kwDOCW7NX85Q4NRi","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T00:11:02Z","updated_at":"2022-12-19T00:11:02Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356911714/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356946191","html_url":"https://github.com/apache/iceberg/pull/6405#issuecomment-1356946191","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6405","id":1356946191,"node_id":"IC_kwDOCW7NX85Q4VsP","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T01:14:14Z","updated_at":"2022-12-19T01:14:14Z","author_association":"CONTRIBUTOR","body":"@rdblue Thank you very much for the PR! The changes are much cleaner and more generic now.  These can be wrapped cleanly in Spark. Once your PR is in, I will make Spark changes on top of your changes. Thanks a lot!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356946191/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356970169","html_url":"https://github.com/apache/iceberg/pull/6392#issuecomment-1356970169","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6392","id":1356970169,"node_id":"IC_kwDOCW7NX85Q4bi5","user":{"login":"cccs-eric","id":56447460,"node_id":"MDQ6VXNlcjU2NDQ3NDYw","avatar_url":"https://avatars.githubusercontent.com/u/56447460?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-eric","html_url":"https://github.com/cccs-eric","followers_url":"https://api.github.com/users/cccs-eric/followers","following_url":"https://api.github.com/users/cccs-eric/following{/other_user}","gists_url":"https://api.github.com/users/cccs-eric/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-eric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-eric/subscriptions","organizations_url":"https://api.github.com/users/cccs-eric/orgs","repos_url":"https://api.github.com/users/cccs-eric/repos","events_url":"https://api.github.com/users/cccs-eric/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-eric/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T01:47:58Z","updated_at":"2022-12-19T01:47:58Z","author_association":"CONTRIBUTOR","body":"@rdblue All clear now","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1356970169/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357175669","html_url":"https://github.com/apache/iceberg/pull/6246#issuecomment-1357175669","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6246","id":1357175669,"node_id":"IC_kwDOCW7NX85Q5Nt1","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T06:53:21Z","updated_at":"2022-12-19T06:53:21Z","author_association":"CONTRIBUTOR","body":"@rdblue I've just rebased and pushed the branch","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357175669/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357204759","html_url":"https://github.com/apache/iceberg/pull/6335#issuecomment-1357204759","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6335","id":1357204759,"node_id":"IC_kwDOCW7NX85Q5U0X","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T07:21:17Z","updated_at":"2022-12-19T07:21:17Z","author_association":"CONTRIBUTOR","body":"@rdblue thanks for the reviewing. It happens for the larger table (has several PBs data) and with many columns(thousand columns which is very common for log data or feature data). And the size of the DataFile metrics' is increased with the number of columns. So the manifest file could be really large when the user adds into/overwrites a larger number of data (eg, sync hourly data).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357204759/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357206614","html_url":"https://github.com/apache/iceberg/pull/3471#issuecomment-1357206614","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3471","id":1357206614,"node_id":"IC_kwDOCW7NX85Q5VRW","user":{"login":"ggershinsky","id":12033212,"node_id":"MDQ6VXNlcjEyMDMzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/12033212?v=4","gravatar_id":"","url":"https://api.github.com/users/ggershinsky","html_url":"https://github.com/ggershinsky","followers_url":"https://api.github.com/users/ggershinsky/followers","following_url":"https://api.github.com/users/ggershinsky/following{/other_user}","gists_url":"https://api.github.com/users/ggershinsky/gists{/gist_id}","starred_url":"https://api.github.com/users/ggershinsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggershinsky/subscriptions","organizations_url":"https://api.github.com/users/ggershinsky/orgs","repos_url":"https://api.github.com/users/ggershinsky/repos","events_url":"https://api.github.com/users/ggershinsky/events{/privacy}","received_events_url":"https://api.github.com/users/ggershinsky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T07:23:30Z","updated_at":"2022-12-19T07:23:30Z","author_association":"CONTRIBUTOR","body":"Given the significant changes in envelope key metadata format \r\nhttps://docs.google.com/document/d/1HPobEb2e4ML12Q9qthkbbsu47ziMQsb-sHfTFsVTIss/edit?usp=sharing, \r\nreplacing this PR with https://github.com/apache/iceberg/pull/6450","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357206614/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357218106","html_url":"https://github.com/apache/iceberg/pull/6436#issuecomment-1357218106","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6436","id":1357218106,"node_id":"IC_kwDOCW7NX85Q5YE6","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T07:38:32Z","updated_at":"2022-12-19T07:38:32Z","author_association":"CONTRIBUTOR","body":"@rdblue I've rebased the PR, so the old commits with the metrics-impl property are gone (since they are merged already).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357218106/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357221410","html_url":"https://github.com/apache/iceberg/issues/6442#issuecomment-1357221410","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6442","id":1357221410,"node_id":"IC_kwDOCW7NX85Q5Y4i","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T07:43:27Z","updated_at":"2022-12-19T07:46:17Z","author_association":"MEMBER","body":"> but some query engines (like Trino) can collect stats on the fly, when writing to a table (INSERT, CREATE TABLE AS ...).\r\n\r\nI think we have discussed this for partitions stats too. \r\n@rdblue mentioned we cannot have writers to write stats on the fly (with insert, CTAS, update), because it needs bumping the Iceberg spec to V3 as some writers will write stats and some writer will not write stats and it can cause inconsistency. \r\n\r\nwe agreed on using ANALYZE syntax or CALL procedure for generating stats until V3 format is ready.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357221410/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357223293","html_url":"https://github.com/apache/iceberg/issues/6443#issuecomment-1357223293","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6443","id":1357223293,"node_id":"IC_kwDOCW7NX85Q5ZV9","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T07:46:02Z","updated_at":"2022-12-19T07:46:02Z","author_association":"MEMBER","body":"> When a query engine wants to add new stats to a snapshot that already has some stats, it currently needs to merge existing stats file' blobs with new ones.\r\n\r\nCan you please explain about when a \"query engine wants to add new stats to a snapshot that already has some stats\" ? \r\n\r\nAren't stats computed once for the snapshot (using ANALYZE command). Are we planning that each column can generate stats independently? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357223293/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357228866","html_url":"https://github.com/apache/iceberg/issues/6443#issuecomment-1357228866","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6443","id":1357228866,"node_id":"IC_kwDOCW7NX85Q5atC","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T07:54:02Z","updated_at":"2022-12-19T07:54:02Z","author_association":"MEMBER","body":"@ajantha-bhat there may be many different types of stats, and stats can be computed for subset of columns.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357228866/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357538870","html_url":"https://github.com/apache/iceberg/pull/3249#issuecomment-1357538870","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3249","id":1357538870,"node_id":"IC_kwDOCW7NX85Q6mY2","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T11:51:57Z","updated_at":"2022-12-19T11:52:51Z","author_association":"CONTRIBUTOR","body":"@ConeyLiu it looks like there are some merge conflicts. Could you rebase+squash the PR please? Would be great to get this eventually in.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357538870/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357584071","html_url":"https://github.com/apache/iceberg/pull/6392#issuecomment-1357584071","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6392","id":1357584071,"node_id":"IC_kwDOCW7NX85Q6xbH","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T12:17:38Z","updated_at":"2022-12-19T12:17:38Z","author_association":"CONTRIBUTOR","body":"Awesome, thanks @cccs-eric for working on this üöÄ ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357584071/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357737149","html_url":"https://github.com/apache/iceberg/pull/6296#issuecomment-1357737149","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6296","id":1357737149,"node_id":"IC_kwDOCW7NX85Q7Wy9","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T14:14:38Z","updated_at":"2022-12-19T14:14:38Z","author_association":"MEMBER","body":"Thanks @ajantha-bhat !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357737149/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357748925","html_url":"https://github.com/apache/iceberg/issues/6442#issuecomment-1357748925","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6442","id":1357748925,"node_id":"IC_kwDOCW7NX85Q7Zq9","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T14:23:12Z","updated_at":"2022-12-19T14:23:12Z","author_association":"MEMBER","body":"@findepi shouldn't you be able to just change any write only commit into a transaction with both updates the append and updates the statistics?\r\n\r\nLike\r\n```\r\nAppendFiles(A, B, C)\r\n```\r\nbecomes\r\n```\r\nTransaction Begin\r\n  AppendFiles(A, B, C)\r\n  Update Statistics (A, B ,C)\r\nTransaction End\r\nCommit Transaction // Creates one Snapshot which both appends files and updates statistics\r\n```\r\n\r\nThen it's up to the framework to build those transactions when required. This would be similar to the mergeSchema functions in Spark.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357748925/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357835565","html_url":"https://github.com/apache/iceberg/issues/6453#issuecomment-1357835565","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6453","id":1357835565,"node_id":"IC_kwDOCW7NX85Q7u0t","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T15:21:49Z","updated_at":"2022-12-19T15:21:49Z","author_association":"MEMBER","body":"It's not clear to me what you are trying to do, `input_df` is unused.  I'm not sure how \"inflate_df\" is being used either. The Delete statement appears to be looking for rows in a deflate table?\r\n\r\nI am most confused about what \r\n```inflated_df.writeTo(\"glue_dev.datalakectxsort.clinicalprescription\").append()``` \r\n\r\nIs meant to accomplish.\r\n\r\nThe time travel error seems to be a bug in the \"as of\" functionality though since you shouldn't have an error just from reading from an old timestamp. This may be because you are both reading and writing to the same table and there is a bug there.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357835565/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357910955","html_url":"https://github.com/apache/iceberg/issues/6453#issuecomment-1357910955","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6453","id":1357910955,"node_id":"IC_kwDOCW7NX85Q8BOr","user":{"login":"arunb2w","id":38204827,"node_id":"MDQ6VXNlcjM4MjA0ODI3","avatar_url":"https://avatars.githubusercontent.com/u/38204827?v=4","gravatar_id":"","url":"https://api.github.com/users/arunb2w","html_url":"https://github.com/arunb2w","followers_url":"https://api.github.com/users/arunb2w/followers","following_url":"https://api.github.com/users/arunb2w/following{/other_user}","gists_url":"https://api.github.com/users/arunb2w/gists{/gist_id}","starred_url":"https://api.github.com/users/arunb2w/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arunb2w/subscriptions","organizations_url":"https://api.github.com/users/arunb2w/orgs","repos_url":"https://api.github.com/users/arunb2w/repos","events_url":"https://api.github.com/users/arunb2w/events{/privacy}","received_events_url":"https://api.github.com/users/arunb2w/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T16:19:03Z","updated_at":"2022-12-19T16:23:01Z","author_association":"NONE","body":"`Input_df` is used in both delete_sql and inflate_sql. Basically, I am just creating the temp view from my input events that needs to be updated to the iceberg table which i aliased it as **source**.\r\nInstead of merge am trying to perform delete and insert for the update events am getting(which is in input_df)\r\n\r\nSo, am joining the input_df with target to delete the matching rows in target and then i will insert the deleted rows using append with latest values so that it will be similar to merge.\r\n\r\nBefore delete, I will prepare a dataframe with full row representation of target with latest values. The inflate_sql portion is doing that by joining with the target again but the precedence to choose a field value whether from the target or source will be decided based on changed_cols field which keep track of list of fields that got changed for a particular record.\r\n\r\nFor example, if my target iceberg has\r\n```\r\nid, name, key, value\r\n1 name1 key1 value1\r\n2 name2 key2 value2\r\n3 name3 key3 value3\r\n```\r\n\r\nAnd my input_df has\r\n```\r\n1 newname1 newvalue1\r\n2 newvalue2\r\n```\r\n\r\nUsing the inflate_sql, I will prepare a dataframe(inflated_df) like this\r\n```\r\n1 newname1 key1 newvalue1\r\n2 name2 key2 newvalue2\r\n```\r\n\r\nThen, I will delete the same 2 rows with id 1 and 2. And then I will call append using the inflated_df dataframe which will add the records with latest value so that it will be similar to merge.\r\n\r\nThe problem am facing here is that the rows got deleted but it is not getting inserted and the reason for the might be due to spark lazy execution. Even though am preparing my inflated_df well before delete but looks like it is getting executed only during the last append call and thats causing the insert to not add the records properly as they already got deleted.\r\n\r\nTo overcome this, i used timetravel while preparing the inflated_df so that even though the current version of table dont have  those records the version before delete should definitely have it but thats causing the snapshot error.\r\n\r\nAs you mentioned, yes am reading and writing to the same table. While reading, am reading from the different snapshot of the same table by specifying time travel and while writing am writing to the current snapshot without any specification of time travel, but not sure why it is throwing that error as i am not writing to a older snapshot\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357910955/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357926286","html_url":"https://github.com/apache/iceberg/issues/6442#issuecomment-1357926286","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6442","id":1357926286,"node_id":"IC_kwDOCW7NX85Q8E-O","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T16:29:56Z","updated_at":"2022-12-19T16:29:56Z","author_association":"MEMBER","body":"Update Statistics API requires to pass a snapshot ID.\r\n@RussellSpitzer  Is the snapshot ID known before transaction commits?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357926286/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357940593","html_url":"https://github.com/apache/iceberg/issues/6442#issuecomment-1357940593","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6442","id":1357940593,"node_id":"IC_kwDOCW7NX85Q8Idx","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T16:42:57Z","updated_at":"2022-12-19T16:42:57Z","author_association":"MEMBER","body":"Hmm that is probably not possible, but I guess that's were we should modify the api? We do know the snapshot ID before we actually do the commit, so we should be able to just fill it in.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357940593/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357951207","html_url":"https://github.com/apache/iceberg/issues/6249#issuecomment-1357951207","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6249","id":1357951207,"node_id":"IC_kwDOCW7NX85Q8LDn","user":{"login":"InvisibleProgrammer","id":1486749,"node_id":"MDQ6VXNlcjE0ODY3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1486749?v=4","gravatar_id":"","url":"https://api.github.com/users/InvisibleProgrammer","html_url":"https://github.com/InvisibleProgrammer","followers_url":"https://api.github.com/users/InvisibleProgrammer/followers","following_url":"https://api.github.com/users/InvisibleProgrammer/following{/other_user}","gists_url":"https://api.github.com/users/InvisibleProgrammer/gists{/gist_id}","starred_url":"https://api.github.com/users/InvisibleProgrammer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/InvisibleProgrammer/subscriptions","organizations_url":"https://api.github.com/users/InvisibleProgrammer/orgs","repos_url":"https://api.github.com/users/InvisibleProgrammer/repos","events_url":"https://api.github.com/users/InvisibleProgrammer/events{/privacy}","received_events_url":"https://api.github.com/users/InvisibleProgrammer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T16:52:31Z","updated_at":"2022-12-19T16:52:31Z","author_association":"CONTRIBUTOR","body":"Hey, @rdblue : \r\n\r\nFirst of all, thank you for your feedback. I'll get the necessary information to answer your questions.\r\n\r\nAs all the PRs are merged, to do any changes, we will have to raise a new PR. \r\n\r\nWhat do you think if I put your questions into the issue, move the conversation there and close that PR?\r\nIssue: https://github.com/apache/iceberg/issues/6249\r\n\r\nThank you, \r\nZsolt","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357951207/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357956308","html_url":"https://github.com/apache/iceberg/pull/6454#issuecomment-1357956308","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6454","id":1357956308,"node_id":"IC_kwDOCW7NX85Q8MTU","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T16:56:57Z","updated_at":"2022-12-19T16:56:57Z","author_association":"CONTRIBUTOR","body":"Thanks, @ajantha-bhat!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1357956308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358011325","html_url":"https://github.com/apache/iceberg/pull/6411#issuecomment-1358011325","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6411","id":1358011325,"node_id":"IC_kwDOCW7NX85Q8Zu9","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T17:37:22Z","updated_at":"2022-12-19T17:37:22Z","author_association":"CONTRIBUTOR","body":"Merged! Thanks, @nastra.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358011325/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358021370","html_url":"https://github.com/apache/iceberg/pull/6392#issuecomment-1358021370","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6392","id":1358021370,"node_id":"IC_kwDOCW7NX85Q8cL6","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T17:47:39Z","updated_at":"2022-12-19T17:47:39Z","author_association":"CONTRIBUTOR","body":"Thanks, @cccs-eric!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358021370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358021713","html_url":"https://github.com/apache/iceberg/pull/6223#issuecomment-1358021713","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6223","id":1358021713,"node_id":"IC_kwDOCW7NX85Q8cRR","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T17:48:04Z","updated_at":"2022-12-19T17:48:04Z","author_association":"CONTRIBUTOR","body":"Thanks, @grbinho!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358021713/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358081664","html_url":"https://github.com/apache/iceberg/pull/6419#issuecomment-1358081664","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6419","id":1358081664,"node_id":"IC_kwDOCW7NX85Q8q6A","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-19T18:36:17Z","updated_at":"2022-12-19T18:36:17Z","author_association":"COLLABORATOR","body":"Hm I was trying both commands in Spark 3.2 and they did the same thing for me.  Not sure if there's any changes since then.  Anyway if thats the official way , fine with me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358081664/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358725441","html_url":"https://github.com/apache/iceberg/pull/6440#issuecomment-1358725441","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6440","id":1358725441,"node_id":"IC_kwDOCW7NX85Q_IFB","user":{"login":"zinking","id":118241,"node_id":"MDQ6VXNlcjExODI0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/118241?v=4","gravatar_id":"","url":"https://api.github.com/users/zinking","html_url":"https://github.com/zinking","followers_url":"https://api.github.com/users/zinking/followers","following_url":"https://api.github.com/users/zinking/following{/other_user}","gists_url":"https://api.github.com/users/zinking/gists{/gist_id}","starred_url":"https://api.github.com/users/zinking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zinking/subscriptions","organizations_url":"https://api.github.com/users/zinking/orgs","repos_url":"https://api.github.com/users/zinking/repos","events_url":"https://api.github.com/users/zinking/events{/privacy}","received_events_url":"https://api.github.com/users/zinking/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T01:52:49Z","updated_at":"2022-12-20T01:52:49Z","author_association":"CONTRIBUTOR","body":"is it actually a good idea to use iceberg table as a LOOK UP JOIN candidate? will it be fast enough?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358725441/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358756220","html_url":"https://github.com/apache/iceberg/pull/6365#issuecomment-1358756220","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6365","id":1358756220,"node_id":"IC_kwDOCW7NX85Q_Pl8","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T02:31:13Z","updated_at":"2022-12-20T02:31:13Z","author_association":"CONTRIBUTOR","body":"I'll have time to take a look tomorrow too.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358756220/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358800244","html_url":"https://github.com/apache/iceberg/issues/5671#issuecomment-1358800244","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5671","id":1358800244,"node_id":"IC_kwDOCW7NX85Q_aV0","user":{"login":"chenwyi2","id":19389434,"node_id":"MDQ6VXNlcjE5Mzg5NDM0","avatar_url":"https://avatars.githubusercontent.com/u/19389434?v=4","gravatar_id":"","url":"https://api.github.com/users/chenwyi2","html_url":"https://github.com/chenwyi2","followers_url":"https://api.github.com/users/chenwyi2/followers","following_url":"https://api.github.com/users/chenwyi2/following{/other_user}","gists_url":"https://api.github.com/users/chenwyi2/gists{/gist_id}","starred_url":"https://api.github.com/users/chenwyi2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenwyi2/subscriptions","organizations_url":"https://api.github.com/users/chenwyi2/orgs","repos_url":"https://api.github.com/users/chenwyi2/repos","events_url":"https://api.github.com/users/chenwyi2/events{/privacy}","received_events_url":"https://api.github.com/users/chenwyi2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T03:47:23Z","updated_at":"2022-12-20T03:47:23Z","author_association":"NONE","body":"thie problem is write.metadata.metrics.default=fullÔºü","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358800244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358855539","html_url":"https://github.com/apache/iceberg/issues/6455#issuecomment-1358855539","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6455","id":1358855539,"node_id":"IC_kwDOCW7NX85Q_n1z","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T05:20:15Z","updated_at":"2022-12-20T05:20:15Z","author_association":"CONTRIBUTOR","body":"@MurderWind if you can reproduce it in IDE, you may be able to troubleshoot it with debugger.\r\n\r\n`IcebergSource` should use a new thread pool \r\n```\r\n  public ContinuousSplitPlannerImpl(Table table, ScanContext scanContext, String threadName) {\r\n    this.table = table;\r\n    this.scanContext = scanContext;\r\n    this.isSharedPool = threadName == null;\r\n    this.workerPool =\r\n        isSharedPool\r\n            ? ThreadPools.getWorkerPool()\r\n            : ThreadPools.newWorkerPool(\r\n                \"iceberg-plan-worker-pool-\" + threadName, scanContext.planParallelism());\r\n  }\r\n```\r\n\r\nAs the threadName is non-null passed in from `IcebergSource`\r\n```\r\n    // Ideally, operatorId should be used as the threadPoolName as Flink guarantees its uniqueness\r\n    // within a job. SplitEnumeratorContext doesn't expose the OperatorCoordinator.Context, which\r\n    // would contain the OperatorID. Need to discuss with Flink community whether it is ok to expose\r\n    // a public API like the protected method \"OperatorCoordinator.Context getCoordinatorContext()\"\r\n    // from SourceCoordinatorContext implementation. For now, <table name>-<random UUID> is used as\r\n    // the unique thread pool name.\r\n    return lazyTable().name() + \"-\" + UUID.randomUUID();\r\n  }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358855539/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358858648","html_url":"https://github.com/apache/iceberg/issues/6456#issuecomment-1358858648","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6456","id":1358858648,"node_id":"IC_kwDOCW7NX85Q_omY","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T05:25:44Z","updated_at":"2022-12-20T05:25:44Z","author_association":"CONTRIBUTOR","body":"can you please elaborate on `TPC-DS refresh benchmark` what are the queries used and share any literature around it, apologies didn't find much.\r\n\r\nAlso can you please attach the spark plans for before vs after merge query plans, happy to take a look and debug.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358858648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358863100","html_url":"https://github.com/apache/iceberg/issues/6406#issuecomment-1358863100","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6406","id":1358863100,"node_id":"IC_kwDOCW7NX85Q_pr8","user":{"login":"arunb2w","id":38204827,"node_id":"MDQ6VXNlcjM4MjA0ODI3","avatar_url":"https://avatars.githubusercontent.com/u/38204827?v=4","gravatar_id":"","url":"https://api.github.com/users/arunb2w","html_url":"https://github.com/arunb2w","followers_url":"https://api.github.com/users/arunb2w/followers","following_url":"https://api.github.com/users/arunb2w/following{/other_user}","gists_url":"https://api.github.com/users/arunb2w/gists{/gist_id}","starred_url":"https://api.github.com/users/arunb2w/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arunb2w/subscriptions","organizations_url":"https://api.github.com/users/arunb2w/orgs","repos_url":"https://api.github.com/users/arunb2w/repos","events_url":"https://api.github.com/users/arunb2w/events{/privacy}","received_events_url":"https://api.github.com/users/arunb2w/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T05:34:36Z","updated_at":"2022-12-20T05:34:36Z","author_association":"NONE","body":"Issue resolved based on the inputs from @RussellSpitzer and @ajantha-bhat - https://apache-iceberg.slack.com/archives/C025PH0G1D4/p1670827665482209. Closing this ticket","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358863100/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358934607","html_url":"https://github.com/apache/iceberg/issues/6230#issuecomment-1358934607","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6230","id":1358934607,"node_id":"IC_kwDOCW7NX85Q_7JP","user":{"login":"rubenvdg","id":37443208,"node_id":"MDQ6VXNlcjM3NDQzMjA4","avatar_url":"https://avatars.githubusercontent.com/u/37443208?v=4","gravatar_id":"","url":"https://api.github.com/users/rubenvdg","html_url":"https://github.com/rubenvdg","followers_url":"https://api.github.com/users/rubenvdg/followers","following_url":"https://api.github.com/users/rubenvdg/following{/other_user}","gists_url":"https://api.github.com/users/rubenvdg/gists{/gist_id}","starred_url":"https://api.github.com/users/rubenvdg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rubenvdg/subscriptions","organizations_url":"https://api.github.com/users/rubenvdg/orgs","repos_url":"https://api.github.com/users/rubenvdg/repos","events_url":"https://api.github.com/users/rubenvdg/events{/privacy}","received_events_url":"https://api.github.com/users/rubenvdg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T07:17:22Z","updated_at":"2022-12-20T07:17:22Z","author_association":"CONTRIBUTOR","body":"Is this one still open?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358934607/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358941935","html_url":"https://github.com/apache/iceberg/pull/6344#issuecomment-1358941935","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6344","id":1358941935,"node_id":"IC_kwDOCW7NX85Q_87v","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T07:25:51Z","updated_at":"2022-12-20T07:25:51Z","author_association":"CONTRIBUTOR","body":"Thanks @szehon-ho's suggestion. Made the changes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358941935/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358945389","html_url":"https://github.com/apache/iceberg/issues/6230#issuecomment-1358945389","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6230","id":1358945389,"node_id":"IC_kwDOCW7NX85Q_9xt","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T07:30:01Z","updated_at":"2022-12-20T07:30:01Z","author_association":"CONTRIBUTOR","body":"@rubenvdg Yes it is :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1358945389/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359000800","html_url":"https://github.com/apache/iceberg/issues/6406#issuecomment-1359000800","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6406","id":1359000800,"node_id":"IC_kwDOCW7NX85RALTg","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T08:31:36Z","updated_at":"2022-12-20T08:31:36Z","author_association":"MEMBER","body":"Just so no one has to click the link to slack, there is a property called \"max file group size\", it defaults to 100GB. Any partition larger than this threshold will be split into independent compaction jobs. For Sorts this would result in overlapping files but we have the default low because larger shuffles than this tend to be problematic without powerful clusters. Increasing this property to the size of the data being compacted will ensure a full single shuffle of all the data in the partition.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359000800/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359269639","html_url":"https://github.com/apache/iceberg/pull/6410#issuecomment-1359269639","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6410","id":1359269639,"node_id":"IC_kwDOCW7NX85RBM8H","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T12:11:33Z","updated_at":"2022-12-20T12:11:33Z","author_association":"CONTRIBUTOR","body":"@kmozaid now that #6404 is merged, can you please rebase this PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359269639/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359315864","html_url":"https://github.com/apache/iceberg/pull/6461#issuecomment-1359315864","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6461","id":1359315864,"node_id":"IC_kwDOCW7NX85RBYOY","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T12:58:14Z","updated_at":"2022-12-20T12:58:14Z","author_association":"MEMBER","body":"cc: @RussellSpitzer, @aokolnychyi, @rdblue   ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359315864/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359346478","html_url":"https://github.com/apache/iceberg/pull/6451#issuecomment-1359346478","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6451","id":1359346478,"node_id":"IC_kwDOCW7NX85RBfsu","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T13:26:11Z","updated_at":"2022-12-20T13:26:11Z","author_association":"CONTRIBUTOR","body":"I am not sure who is on PTO, or who is still working, so I tagged @RussellSpitzer, @szehon-ho and @stevenzwu who might be interested in this patch ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359346478/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359359424","html_url":"https://github.com/apache/iceberg/pull/6222#issuecomment-1359359424","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6222","id":1359359424,"node_id":"IC_kwDOCW7NX85RBi3A","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T13:35:58Z","updated_at":"2022-12-20T13:35:58Z","author_association":"CONTRIBUTOR","body":"Added test case for StructRowData. @stevenzwu please take a look, thx.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359359424/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359461583","html_url":"https://github.com/apache/iceberg/issues/6361#issuecomment-1359461583","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6361","id":1359461583,"node_id":"IC_kwDOCW7NX85RB7zP","user":{"login":"rubenvdg","id":37443208,"node_id":"MDQ6VXNlcjM3NDQzMjA4","avatar_url":"https://avatars.githubusercontent.com/u/37443208?v=4","gravatar_id":"","url":"https://api.github.com/users/rubenvdg","html_url":"https://github.com/rubenvdg","followers_url":"https://api.github.com/users/rubenvdg/followers","following_url":"https://api.github.com/users/rubenvdg/following{/other_user}","gists_url":"https://api.github.com/users/rubenvdg/gists{/gist_id}","starred_url":"https://api.github.com/users/rubenvdg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rubenvdg/subscriptions","organizations_url":"https://api.github.com/users/rubenvdg/orgs","repos_url":"https://api.github.com/users/rubenvdg/repos","events_url":"https://api.github.com/users/rubenvdg/events{/privacy}","received_events_url":"https://api.github.com/users/rubenvdg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T14:36:34Z","updated_at":"2022-12-20T14:36:34Z","author_association":"CONTRIBUTOR","body":"@Fokko this one can be closed. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359461583/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359525244","html_url":"https://github.com/apache/iceberg/pull/6182#issuecomment-1359525244","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6182","id":1359525244,"node_id":"IC_kwDOCW7NX85RCLV8","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T15:02:06Z","updated_at":"2022-12-20T15:02:06Z","author_association":"CONTRIBUTOR","body":"@Reo-LEI @aokolnychyi any updates on this one? Would be great to get this in","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359525244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359533924","html_url":"https://github.com/apache/iceberg/pull/6458#issuecomment-1359533924","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6458","id":1359533924,"node_id":"IC_kwDOCW7NX85RCNdk","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T15:07:12Z","updated_at":"2022-12-20T15:07:12Z","author_association":"MEMBER","body":"Thanks @fwessels and @Fokko + @ajantha-bhat for reviews","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359533924/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359538218","html_url":"https://github.com/apache/iceberg/pull/6449#issuecomment-1359538218","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6449","id":1359538218,"node_id":"IC_kwDOCW7NX85RCOgq","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T15:09:53Z","updated_at":"2022-12-20T15:09:53Z","author_association":"MEMBER","body":"I love seeing this functionality but I'm not sure it should be a first class citizen in the repo. The issue being this would require us to pull in all Delta Dependencies which would increase the complexity of our build as well as keeping up versioning. Is there a way to accomplish this without as heavy a dependency requirement?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359538218/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359556823","html_url":"https://github.com/apache/iceberg/issues/6463#issuecomment-1359556823","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6463","id":1359556823,"node_id":"IC_kwDOCW7NX85RCTDX","user":{"login":"sristiraj","id":8859359,"node_id":"MDQ6VXNlcjg4NTkzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/8859359?v=4","gravatar_id":"","url":"https://api.github.com/users/sristiraj","html_url":"https://github.com/sristiraj","followers_url":"https://api.github.com/users/sristiraj/followers","following_url":"https://api.github.com/users/sristiraj/following{/other_user}","gists_url":"https://api.github.com/users/sristiraj/gists{/gist_id}","starred_url":"https://api.github.com/users/sristiraj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sristiraj/subscriptions","organizations_url":"https://api.github.com/users/sristiraj/orgs","repos_url":"https://api.github.com/users/sristiraj/repos","events_url":"https://api.github.com/users/sristiraj/events{/privacy}","received_events_url":"https://api.github.com/users/sristiraj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T15:22:03Z","updated_at":"2022-12-20T15:22:03Z","author_association":"NONE","body":"Also, running describe extended gives below:\r\n![Screenshot_2022-12-20_20-51-08](https://user-images.githubusercontent.com/8859359/208702154-2295ef98-9cc5-4524-9404-77b30ff1f84e.png)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359556823/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359598389","html_url":"https://github.com/apache/iceberg/issues/6463#issuecomment-1359598389","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6463","id":1359598389,"node_id":"IC_kwDOCW7NX85RCdM1","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T15:51:06Z","updated_at":"2022-12-20T15:51:06Z","author_association":"CONTRIBUTOR","body":"@sristiraj could you provide the list of dependencies you're using for this code? Those might be potentially causing an issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359598389/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359600051","html_url":"https://github.com/apache/iceberg/issues/6423#issuecomment-1359600051","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6423","id":1359600051,"node_id":"IC_kwDOCW7NX85RCdmz","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T15:52:26Z","updated_at":"2022-12-20T15:52:26Z","author_association":"CONTRIBUTOR","body":"fixed by #6441 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359600051/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359601146","html_url":"https://github.com/apache/iceberg/issues/6463#issuecomment-1359601146","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6463","id":1359601146,"node_id":"IC_kwDOCW7NX85RCd36","user":{"login":"sristiraj","id":8859359,"node_id":"MDQ6VXNlcjg4NTkzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/8859359?v=4","gravatar_id":"","url":"https://api.github.com/users/sristiraj","html_url":"https://github.com/sristiraj","followers_url":"https://api.github.com/users/sristiraj/followers","following_url":"https://api.github.com/users/sristiraj/following{/other_user}","gists_url":"https://api.github.com/users/sristiraj/gists{/gist_id}","starred_url":"https://api.github.com/users/sristiraj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sristiraj/subscriptions","organizations_url":"https://api.github.com/users/sristiraj/orgs","repos_url":"https://api.github.com/users/sristiraj/repos","events_url":"https://api.github.com/users/sristiraj/events{/privacy}","received_events_url":"https://api.github.com/users/sristiraj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T15:53:21Z","updated_at":"2022-12-20T15:53:21Z","author_association":"NONE","body":"@nastra Here is the build file\r\n\r\n```\r\nname := \"nessietest\"\r\n\r\nscalaVersion := \"2.12.1\"\r\n\r\nversion := \"1.0.0\"\r\n\r\n// https://mvnrepository.com/artifact/org.apache.spark/spark-core\r\nlibraryDependencies += \"org.apache.spark\" %% \"spark-core\" % \"3.3.0\" \r\n\r\n// https://mvnrepository.com/artifact/org.apache.spark/spark-sql\r\nlibraryDependencies += \"org.apache.spark\" %% \"spark-sql\" % \"3.3.0\" \r\n\r\n// https://mvnrepository.com/artifact/org.apache.spark/spark-sql\r\nlibraryDependencies += \"org.apache.iceberg\" %% \"iceberg-spark-runtime-3.3\" % \"1.1.0\" \r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359601146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359610706","html_url":"https://github.com/apache/iceberg/issues/6463#issuecomment-1359610706","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6463","id":1359610706,"node_id":"IC_kwDOCW7NX85RCgNS","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T15:59:44Z","updated_at":"2022-12-20T15:59:44Z","author_association":"CONTRIBUTOR","body":"Is it possible that your Spark libs folder contains libraries that conflict with the ones used here? Also maybe try and add `\"org.scala-lang.modules\" %% \"scala-collection-compat\"` as a dependency","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359610706/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359630326","html_url":"https://github.com/apache/iceberg/issues/6463#issuecomment-1359630326","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6463","id":1359630326,"node_id":"IC_kwDOCW7NX85RCk_2","user":{"login":"sristiraj","id":8859359,"node_id":"MDQ6VXNlcjg4NTkzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/8859359?v=4","gravatar_id":"","url":"https://api.github.com/users/sristiraj","html_url":"https://github.com/sristiraj","followers_url":"https://api.github.com/users/sristiraj/followers","following_url":"https://api.github.com/users/sristiraj/following{/other_user}","gists_url":"https://api.github.com/users/sristiraj/gists{/gist_id}","starred_url":"https://api.github.com/users/sristiraj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sristiraj/subscriptions","organizations_url":"https://api.github.com/users/sristiraj/orgs","repos_url":"https://api.github.com/users/sristiraj/repos","events_url":"https://api.github.com/users/sristiraj/events{/privacy}","received_events_url":"https://api.github.com/users/sristiraj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T16:09:01Z","updated_at":"2022-12-20T16:09:01Z","author_association":"NONE","body":"@nastra Thanks for coming back. Just added the depedency.\r\n\r\n```\r\nname := \"nessie\"\r\n\r\nscalaVersion := \"2.12.1\"\r\n\r\nversion := \"1.0.0\"\r\n\r\n// https://mvnrepository.com/artifact/org.apache.spark/spark-core\r\nlibraryDependencies += \"org.apache.spark\" %% \"spark-core\" % \"3.3.0\" \r\n\r\n// https://mvnrepository.com/artifact/org.apache.spark/spark-sql\r\nlibraryDependencies += \"org.apache.spark\" %% \"spark-sql\" % \"3.3.0\" \r\n\r\n// https://mvnrepository.com/artifact/org.apache.spark/spark-sql\r\nlibraryDependencies += \"org.apache.iceberg\" %% \"iceberg-spark-runtime-3.3\" % \"1.1.0\" \r\n\r\n// https://mvnrepository.com/artifact/org.scala-lang.modules/scala-collection-compat\r\nlibraryDependencies += \"org.scala-lang.modules\" %% \"scala-collection-compat\" % \"2.2.0\"\r\n\r\n```\r\n\r\nStill the same error:\r\n\r\n```\r\n\r\nException in thread \"sbt-bg-threads-5\" java.lang.NoClassDefFoundError: scala/jdk/CollectionConverters$\r\n        at org.apache.spark.sql.catalyst.parser.extensions.IcebergSparkSqlExtensionsParser$UnresolvedIcebergTable$.isIcebergTable(IcebergSparkSqlExtensionsParser.scala:170)\r\n        at org.apache.spark.sql.catalyst.parser.extensions.IcebergSparkSqlExtensionsParser$UnresolvedIcebergTable$.unapply(IcebergSparkSqlExtensionsParser.scala:162)\r\n        at org.apache.spark.sql.catalyst.parser.extensions.IcebergSparkSqlExtensionsParser$$anonfun$replaceRowLevelCommands$1.applyOrElse(IcebergSparkSqlExtensionsParser.scala:144)\r\n        at org.apache.spark.sql.catalyst.parser.extensions.IcebergSparkSqlExtensionsParser$$anonfun$replaceRowLevelCommands$1.applyOrElse(IcebergSparkSqlExtensionsParser.scala:143)\r\n        at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsDownWithPruning$2(AnalysisHelper.scala:170)\r\n        at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:176)\r\n        at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsDownWithPruning$1(AnalysisHelper.scala:170)\r\n        at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:323)\r\n        at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsDownWithPruning(AnalysisHelper.scala:168)\r\n        at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsDownWithPruning$(AnalysisHelper.scala:164)\r\n        at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsDownWithPruning(LogicalPlan.scala:30)\r\n        at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsDown(AnalysisHelper.scala:160)\r\n        at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsDown$(AnalysisHelper.scala:159)\r\n        at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsDown(LogicalPlan.scala:30)\r\n        at org.apache.spark.sql.catalyst.parser.extensions.IcebergSparkSqlExtensionsParser.replaceRowLevelCommands(IcebergSparkSqlExtensionsParser.scala:143)\r\n        at org.apache.spark.sql.catalyst.parser.extensions.IcebergSparkSqlExtensionsParser.parsePlan(IcebergSparkSqlExtensionsParser.scala:138)\r\n        at org.apache.spark.sql.SparkSession.$anonfun$sql$2(SparkSession.scala:620)\r\n        at org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:111)\r\n        at org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:620)\r\n        at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)\r\n        at org.apache.spark.sql.SparkSession.sql(SparkSession.scala:617)\r\n        at NessieTest$.main(app.scala:22)\r\n        at NessieTest.main(app.scala)\r\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n        at sbt.Run.invokeMain(Run.scala:143)\r\n        at sbt.Run.execute$1(Run.scala:93)\r\n        at sbt.Run.$anonfun$runWithLoader$5(Run.scala:120)\r\n        at sbt.Run$.executeSuccess(Run.scala:186)\r\n        at sbt.Run.runWithLoader(Run.scala:120)\r\n        at sbt.Defaults$.$anonfun$bgRunTask$6(Defaults.scala:1981)\r\n        at sbt.Defaults$.$anonfun$termWrapper$2(Defaults.scala:1920)\r\n        at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\r\n        at scala.util.Try$.apply(Try.scala:213)\r\n        at sbt.internal.BackgroundThreadPool$BackgroundRunnable.run(DefaultBackgroundJobService.scala:369)\r\n        at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\r\n        at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\r\n        at java.base/java.lang.Thread.run(Thread.java:829)\r\nCaused by: java.lang.ClassNotFoundException: scala.jdk.CollectionConverters$\r\n        at java.base/java.net.URLClassLoader.findClass(URLClassLoader.java:476)\r\n        at sbt.internal.ManagedClassLoader.findClass(ManagedClassLoader.java:102)\r\n        at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:589)\r\n        at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:522)\r\n        ... 40 more\r\n[success] Total time: 6 s, completed 20 Dec 2022, 21:34:01\r\n\r\n```\r\n\r\nAlso, tried changing the spark dependencies to provided scope just to see. That as well does not resolve the issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359630326/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359711616","html_url":"https://github.com/apache/iceberg/pull/6460#issuecomment-1359711616","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6460","id":1359711616,"node_id":"IC_kwDOCW7NX85RC42A","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T16:52:11Z","updated_at":"2022-12-20T16:52:11Z","author_association":"CONTRIBUTOR","body":"Thanks for the reviews, everyone!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359711616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359913918","html_url":"https://github.com/apache/iceberg/issues/6456#issuecomment-1359913918","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6456","id":1359913918,"node_id":"IC_kwDOCW7NX85RDqO-","user":{"login":"parasj","id":453850,"node_id":"MDQ6VXNlcjQ1Mzg1MA==","avatar_url":"https://avatars.githubusercontent.com/u/453850?v=4","gravatar_id":"","url":"https://api.github.com/users/parasj","html_url":"https://github.com/parasj","followers_url":"https://api.github.com/users/parasj/followers","following_url":"https://api.github.com/users/parasj/following{/other_user}","gists_url":"https://api.github.com/users/parasj/gists{/gist_id}","starred_url":"https://api.github.com/users/parasj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/parasj/subscriptions","organizations_url":"https://api.github.com/users/parasj/orgs","repos_url":"https://api.github.com/users/parasj/repos","events_url":"https://api.github.com/users/parasj/events{/privacy}","received_events_url":"https://api.github.com/users/parasj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T17:58:55Z","updated_at":"2022-12-20T17:58:55Z","author_association":"NONE","body":"Thanks for looking into this @singhpk234. The benchmark is Section 5 from the [TPC-DS spec](https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-ds_v3.2.0.pdf). There isn't a need to review this most likely since I can share the specific query that causes an issue (MERGE INTO aka MergeIntoIcebergTable).\r\n\r\nIf I use the default `fs.s3.maxConnections` value, I receive the `Timeout waiting for connection from pool` error. Following [EMR documentation](https://aws.amazon.com/premiumsupport/knowledge-center/emr-timeout-connection-wait/), I increase that value to at least 400 which resolves the error. However, task runtime increases substantially on the 9th or 10th MERGE INTO iteration.\r\n\r\nThis is the query plan for the slow MERGE operation\r\n![screencapture-p-1q6rmnav5mkct-emrappui-prod-us-west-2-amazonaws-shs-history-application-1670734820778-0002-SQL-execution-2022-12-20-09_52_35](https://user-images.githubusercontent.com/453850/208733531-d8a4967c-a1aa-40d2-af4f-eb7966466972.png)\r\n\r\nLooking at the relevant job, we can see that a single worker is creating an issue. However, this issue occurs consistently across many different EMR clusters, so this is not caused by a bad worker.\r\n\r\n![screencapture-p-1q6rmnav5mkct-emrappui-prod-us-west-2-amazonaws-shs-history-application-1670734820778-0002-stages-stage-2022-12-20-09_54_28](https://user-images.githubusercontent.com/453850/208734202-0e051612-ac44-4347-a5dc-b1b63161c420.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1359913918/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1360027661","html_url":"https://github.com/apache/iceberg/pull/6462#issuecomment-1360027661","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6462","id":1360027661,"node_id":"IC_kwDOCW7NX85REGAN","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T19:04:51Z","updated_at":"2022-12-20T19:04:51Z","author_association":"CONTRIBUTOR","body":"Thanks @rubenvdg for fixing this üëèüèª ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1360027661/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1360077027","html_url":"https://github.com/apache/iceberg/issues/6456#issuecomment-1360077027","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6456","id":1360077027,"node_id":"IC_kwDOCW7NX85RESDj","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-20T19:53:05Z","updated_at":"2022-12-20T19:53:05Z","author_association":"CONTRIBUTOR","body":"It looks like for some reason, the splits created for the left side source are very skewed, and this skewness, as per my understanding is the main reason for slow down. plz. refer the min / 25th percentile / median / 75th take KB's of data where as Max has 100's of MB of data, and also spilling is happening for that task. \r\n\r\nP.S : It would be really nice to see what was the distribution prior to 1.1 release, can you please also attach that.\r\n\r\n![Screen Shot 2022-12-20 at 11 45 18 AM](https://user-images.githubusercontent.com/35593236/208753629-28e0c31a-8f14-4d1d-8f98-5cdbd4d552b2.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1360077027/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1360535954","html_url":"https://github.com/apache/iceberg/issues/5119#issuecomment-1360535954","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5119","id":1360535954,"node_id":"IC_kwDOCW7NX85RGCGS","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-12-21T00:10:42Z","updated_at":"2022-12-21T00:10:42Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1360535954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1360718909","html_url":"https://github.com/apache/iceberg/issues/6455#issuecomment-1360718909","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6455","id":1360718909,"node_id":"IC_kwDOCW7NX85RGuw9","user":{"login":"MurderWind","id":15045209,"node_id":"MDQ6VXNlcjE1MDQ1MjA5","avatar_url":"https://avatars.githubusercontent.com/u/15045209?v=4","gravatar_id":"","url":"https://api.github.com/users/MurderWind","html_url":"https://github.com/MurderWind","followers_url":"https://api.github.com/users/MurderWind/followers","following_url":"https://api.github.com/users/MurderWind/following{/other_user}","gists_url":"https://api.github.com/users/MurderWind/gists{/gist_id}","starred_url":"https://api.github.com/users/MurderWind/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MurderWind/subscriptions","organizations_url":"https://api.github.com/users/MurderWind/orgs","repos_url":"https://api.github.com/users/MurderWind/repos","events_url":"https://api.github.com/users/MurderWind/events{/privacy}","received_events_url":"https://api.github.com/users/MurderWind/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-21T02:23:18Z","updated_at":"2022-12-21T02:23:18Z","author_association":"NONE","body":"> @MurderWind if you can reproduce it in IDE, you may be able to troubleshoot it with debugger.\r\n> \r\n> `IcebergSource` should use a new thread pool\r\n> \r\n> ```\r\n>   public ContinuousSplitPlannerImpl(Table table, ScanContext scanContext, String threadName) {\r\n>     this.table = table;\r\n>     this.scanContext = scanContext;\r\n>     this.isSharedPool = threadName == null;\r\n>     this.workerPool =\r\n>         isSharedPool\r\n>             ? ThreadPools.getWorkerPool()\r\n>             : ThreadPools.newWorkerPool(\r\n>                 \"iceberg-plan-worker-pool-\" + threadName, scanContext.planParallelism());\r\n>   }\r\n> ```\r\n> \r\n> As the threadName is non-null passed in from `IcebergSource`\r\n> \r\n> ```\r\n>     // Ideally, operatorId should be used as the threadPoolName as Flink guarantees its uniqueness\r\n>     // within a job. SplitEnumeratorContext doesn't expose the OperatorCoordinator.Context, which\r\n>     // would contain the OperatorID. Need to discuss with Flink community whether it is ok to expose\r\n>     // a public API like the protected method \"OperatorCoordinator.Context getCoordinatorContext()\"\r\n>     // from SourceCoordinatorContext implementation. For now, <table name>-<random UUID> is used as\r\n>     // the unique thread pool name.\r\n>     return lazyTable().name() + \"-\" + UUID.randomUUID();\r\n>   }\r\n> ```\r\n\r\ni found the issues  .\r\n\r\n\r\n`   protected JdbcTableOperations(\r\n            JdbcClientPool dbConnPool,\r\n            FileIO fileIO,\r\n            String catalogName,\r\n            TableIdentifier tableIdentifier,\r\n            Map<String, String> catalogProperties) {\r\n        this.catalogName = catalogName;\r\n        this.tableIdentifier = tableIdentifier;\r\n        this.fileIO = fileIO;\r\n        this.connections = dbConnPool;\r\n        this.catalogProperties = catalogProperties;\r\n    }`\r\nthe dbConnPool has initialize.  but  org.apache.iceberg.jdbc.JdbcCatalog#close   this.closed =true .  when  org.apache.iceberg.ClientPoolImpl#get          Preconditions.checkState(!this.closed, \"Cannot get a client from a closed pool\");\r\n  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1360718909/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1360719148","html_url":"https://github.com/apache/iceberg/issues/5119#issuecomment-1360719148","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5119","id":1360719148,"node_id":"IC_kwDOCW7NX85RGu0s","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-21T02:23:48Z","updated_at":"2022-12-21T02:23:48Z","author_association":"CONTRIBUTOR","body":"im working on it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1360719148/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1360831473","html_url":"https://github.com/apache/iceberg/pull/6410#issuecomment-1360831473","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6410","id":1360831473,"node_id":"IC_kwDOCW7NX85RHKPx","user":{"login":"kmozaid","id":8354145,"node_id":"MDQ6VXNlcjgzNTQxNDU=","avatar_url":"https://avatars.githubusercontent.com/u/8354145?v=4","gravatar_id":"","url":"https://api.github.com/users/kmozaid","html_url":"https://github.com/kmozaid","followers_url":"https://api.github.com/users/kmozaid/followers","following_url":"https://api.github.com/users/kmozaid/following{/other_user}","gists_url":"https://api.github.com/users/kmozaid/gists{/gist_id}","starred_url":"https://api.github.com/users/kmozaid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kmozaid/subscriptions","organizations_url":"https://api.github.com/users/kmozaid/orgs","repos_url":"https://api.github.com/users/kmozaid/repos","events_url":"https://api.github.com/users/kmozaid/events{/privacy}","received_events_url":"https://api.github.com/users/kmozaid/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-21T04:10:43Z","updated_at":"2022-12-21T04:10:43Z","author_association":"CONTRIBUTOR","body":"> @kmozaid now that #6404 is merged, can you please rebase this PR?\r\n\r\nHi @nastra I have rebased and updated PR with feedbacks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1360831473/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1360834131","html_url":"https://github.com/apache/iceberg/pull/6466#issuecomment-1360834131","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6466","id":1360834131,"node_id":"IC_kwDOCW7NX85RHK5T","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-12-21T04:15:11Z","updated_at":"2022-12-21T04:15:11Z","author_association":"MEMBER","body":"The build failed with this error. But not pointing to the exact line. Hence, restarted the build as the local build was passing with the same command (`./gradlew -DallVersions build -x test -x javadoc -x integrationTest`)\r\n\r\n```\r\n2022-12-21T02:31:52.2848414Z > Task :iceberg-spark:iceberg-spark-runtime-3.2_2.12:shadowJar\r\n2022-12-21T02:31:52.2849004Z FAILURE: Build failed with an exception.\r\n2022-12-21T02:31:52.2853804Z \r\n2022-12-21T02:31:52.2853965Z * What went wrong:\r\n2022-12-21T02:31:52.2854602Z Execution failed for task ':iceberg-spark:iceberg-spark-3.2_2.12:checkstyleMain'.\r\n2022-12-21T02:31:52.2857459Z > A failure occurred while executing org.gradle.api.plugins.quality.internal.CheckstyleAction\r\n2022-12-21T02:31:52.2857978Z    > An unexpected error occurred configuring and executing Checkstyle.\r\n2022-12-21T02:31:52.2858548Z       > java.lang.Error: Error was thrown while processing /home/runner/work/iceberg/iceberg/spark/v3.2/spark/src/main/java/org/apache/iceberg/spark/source/StructInternalRow.java\r\n2022-12-21T02:31:52.2861237Z \r\n2022-12-21T02:31:52.2861358Z * Try:\r\n2022-12-21T02:31:52.2864179Z > Run with --stacktrace option to get the stack trace.\r\n2022-12-21T02:31:52.2866189Z > Run with --info or --debug option to get more log output.\r\n2022-12-21T02:31:52.2868072Z > Run with --scan to get full insights.\r\n2022-12-21T02:31:52.2868304Z \r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1360834131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]