[{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2505648947","html_url":"https://github.com/apache/accumulo/issues/4817#issuecomment-2505648947","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4817","id":2505648947,"node_id":"IC_kwDOACaFSM6VWSsz","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-28T09:30:13Z","updated_at":"2024-11-28T09:30:13Z","author_association":"MEMBER","body":"This is further duplicated by #5091, so I'll close this issue to simplify things.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2505648947/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2505651871","html_url":"https://github.com/apache/accumulo/pull/5019#issuecomment-2505651871","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5019","id":2505651871,"node_id":"IC_kwDOACaFSM6VWTaf","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-28T09:31:31Z","updated_at":"2024-11-28T09:31:31Z","author_association":"MEMBER","body":"Since this is being backported to 3.1 in #5118 as part of #5091, I'm going to close this PR.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2505651871/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2508178300","html_url":"https://github.com/apache/accumulo/pull/1660#issuecomment-2508178300","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1660","id":2508178300,"node_id":"IC_kwDOACaFSM6Vf8N8","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-29T17:17:52Z","updated_at":"2024-11-29T17:17:52Z","author_association":"MEMBER","body":"> I was using this, I guess I can re-instate it on my own though.\r\n\r\n@andrewglowacki We could possibly reintroduce this if a case can be made for keeping it around. If we were to reintroduce it, though, we'd do it properly as documented SPI, though.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2508178300/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2509100859","html_url":"https://github.com/apache/accumulo/pull/5116#issuecomment-2509100859","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5116","id":2509100859,"node_id":"IC_kwDOACaFSM6Vjdc7","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-30T17:55:54Z","updated_at":"2024-11-30T17:56:05Z","author_association":"MEMBER","body":"This is a substantial rewrite. It's going to take me a bit of time to review it. But my initial question is: does this include main branch specific features, or could this also be applied to the 3.1 branch, to reduce future maintenance burden there by eliminating one difference between the branches?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2509100859/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2511755519","html_url":"https://github.com/apache/accumulo/pull/5116#issuecomment-2511755519","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5116","id":2511755519,"node_id":"IC_kwDOACaFSM6Vtlj_","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-02T14:53:23Z","updated_at":"2024-12-02T14:53:44Z","author_association":"CONTRIBUTOR","body":"> This is a substantial rewrite. It's going to take me a bit of time to review it. But my initial question is: does this include main branch specific features, or could this also be applied to the 3.1 branch, to reduce future maintenance burden there by eliminating one difference between the branches?\r\n\r\nBefore this change the `accumulo-cluster` script was sufficiently different that making changes in an earlier version and merging them up required a good amount of time. I think merging changes to the accumulo-cluster script in main at this point is going to be a pain regardless. I don't think that moving the changes upstream are going to make it much easier because of the new features in main. At the very least, the tserver and sserver group options would need to be removed for a 3.1 version, and added back in for main.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2511755519/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2512281594","html_url":"https://github.com/apache/accumulo/pull/4986#issuecomment-2512281594","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4986","id":2512281594,"node_id":"IC_kwDOACaFSM6Vvl_6","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-02T17:51:41Z","updated_at":"2024-12-02T17:51:41Z","author_association":"CONTRIBUTOR","body":"I wonder if we should close this, or at least change it to draft, considering that we are looking to overhaul the Monitor and specifically for external compactions looking at showing a topN view and not all of them.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2512281594/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2512473027","html_url":"https://github.com/apache/accumulo/pull/4986#issuecomment-2512473027","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4986","id":2512473027,"node_id":"IC_kwDOACaFSM6VwUvD","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-02T19:00:17Z","updated_at":"2024-12-02T19:00:17Z","author_association":"MEMBER","body":"> I wonder if we should close this, or at least change it to draft, considering that we are looking to overhaul the Monitor and specifically for external compactions looking at showing a topN view and not all of them.\r\n\r\nYea could convert it to draft. As far as I can tell though this is ready to be merged so thats another option.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2512473027/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2512631095","html_url":"https://github.com/apache/accumulo/pull/5118#issuecomment-2512631095","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5118","id":2512631095,"node_id":"IC_kwDOACaFSM6Vw7U3","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-02T19:52:15Z","updated_at":"2024-12-02T19:52:15Z","author_association":"MEMBER","body":"> It looks like this PR omitted the upgrade changes needed to remove the existing problem reports from ZK and the metadata table. That should be included, either in this PR, or as an immediate follow-on.\r\n\r\nadded back the upgrade code from the original PR","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2512631095/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2512650852","html_url":"https://github.com/apache/accumulo/pull/4986#issuecomment-2512650852","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4986","id":2512650852,"node_id":"IC_kwDOACaFSM6VxAJk","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-02T19:58:30Z","updated_at":"2024-12-02T19:58:41Z","author_association":"CONTRIBUTOR","body":"> As far as I can tell though this is ready to be merged so thats another option.\r\n \r\n or that :-)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2512650852/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2512737775","html_url":"https://github.com/apache/accumulo/issues/5128#issuecomment-2512737775","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5128","id":2512737775,"node_id":"IC_kwDOACaFSM6VxVXv","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-02T20:26:31Z","updated_at":"2024-12-02T20:26:31Z","author_association":"CONTRIBUTOR","body":"I have been seeing random failures as well, I have been re-running the actions.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2512737775/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2515086129","html_url":"https://github.com/apache/accumulo/pull/5129#issuecomment-2515086129","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5129","id":2515086129,"node_id":"IC_kwDOACaFSM6V6Ssx","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-03T16:49:47Z","updated_at":"2024-12-03T16:49:47Z","author_association":"CONTRIBUTOR","body":"This could easily be introduced in 2.1.4 I think, but it's not a bugfix. It could also be easily introduced in 3.1, but I'm not sure it's needed there as the major Fate changes are in 4.0. This PR is a compromise of my suggestion [here](https://github.com/apache/accumulo/pull/5105#issuecomment-2498298528) and @keith-turner's response.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2515086129/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2515182297","html_url":"https://github.com/apache/accumulo/issues/5130#issuecomment-2515182297","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5130","id":2515182297,"node_id":"IC_kwDOACaFSM6V6qLZ","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-03T17:32:20Z","updated_at":"2024-12-03T17:32:20Z","author_association":"CONTRIBUTOR","body":"It might be useful for COMPACTION_COMMIT to be it's own type with it's own dedicated resources.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2515182297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2517856600","html_url":"https://github.com/apache/accumulo/issues/5132#issuecomment-2517856600","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5132","id":2517856600,"node_id":"IC_kwDOACaFSM6WE3FY","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-04T15:56:18Z","updated_at":"2024-12-04T15:56:18Z","author_association":"CONTRIBUTOR","body":"Would be good if the tsever did a check of its lock after experiencing an error writing to its walog.  Currently the following can happen.\r\n\r\n 1. Manager revokes lease on a tservers walog when it determines a tserver is dead.\r\n 2. If the tserver is still alive this will cause it to have  a write error when writing to its walog.\r\n 3. When the tserver has a write error it jsut creates a new walog.\r\n\r\nWould be nice to have the tserver check its lock between steps 2 and 3 above. That could be done by calling the same code that is used for periodic check.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2517856600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2517867512","html_url":"https://github.com/apache/accumulo/issues/5132#issuecomment-2517867512","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5132","id":2517867512,"node_id":"IC_kwDOACaFSM6WE5v4","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-04T15:59:46Z","updated_at":"2024-12-04T16:02:11Z","author_association":"CONTRIBUTOR","body":"An alternative to a dedicated thread that periodically checks is to have a dedicated zookeeper object for lock acquisition. Not sure if this is better or worse overall.  It would create an extra zookeeper connection per server, but would avoid the constant pings to zookeeper allowing Accumulo to rely on the zookeeper notification mechanisms. \r\n\r\nThis periodic check may not be needed on all server type.  Its the most important on tablet servers and the manager.  Compactors and scan servers could forgo this check in order to avoid introducing extra load on zookeeper.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2517867512/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2517958832","html_url":"https://github.com/apache/accumulo/issues/5117#issuecomment-2517958832","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5117","id":2517958832,"node_id":"IC_kwDOACaFSM6WFQCw","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-04T16:30:12Z","updated_at":"2024-12-04T16:30:12Z","author_association":"CONTRIBUTOR","body":"I can take a look at this issue later this week","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2517958832/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518079371","html_url":"https://github.com/apache/accumulo/issues/5130#issuecomment-2518079371","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5130","id":2518079371,"node_id":"IC_kwDOACaFSM6WFteL","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-04T17:21:22Z","updated_at":"2024-12-04T17:21:22Z","author_association":"CONTRIBUTOR","body":"One other idea I thought of is if we could configure the fate thread pool be to use a [PriorityBlockingQueue](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/PriorityBlockingQueue.html) and then write a comparator to bump the priority of certain fate operation types higher than others so they run first.\r\n\r\nThis option may not work though because it is not going to be as good as having separate dedicated thread pools to run fate operations by type because if the thread pool is saturated and tied up with long running fate jobs then it still blocks jobs from running, but it at least would bump certain things to the front to run as soon as there are free threads.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518079371/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518104324","html_url":"https://github.com/apache/accumulo/issues/5131#issuecomment-2518104324","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5131","id":2518104324,"node_id":"IC_kwDOACaFSM6WFzkE","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-04T17:32:43Z","updated_at":"2024-12-04T17:32:43Z","author_association":"MEMBER","body":"Currently, we build with 3.4.0 (now that 3.4.1 is out, we'll be bumping to that, since we try to build with the latest). But, we do have a GitHub Actions check to ensure we still are compatible with the oldest one we support. That's currently checking 3.0.3. We can bump the minimum required Hadoop version to 3.4.1 to do this, but it should be well-documented, and once the change is merged forward into the main branch, any cluster testing of the elasticity work would only be able to be done on a 3.4.1 HDFS cluster (which is fine... just something to keep in mind).","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518104324/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518109792","html_url":"https://github.com/apache/accumulo/issues/5131#issuecomment-2518109792","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5131","id":2518109792,"node_id":"IC_kwDOACaFSM6WF05g","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-04T17:35:32Z","updated_at":"2024-12-04T17:35:32Z","author_association":"MEMBER","body":"The one big downside to bumping to 3.4.1 as the minimum supported version is that it is currently also the latest version. So, that restricts users to only a single possible HDFS version to run for now. That can be a big problem for users if there's any serious bugs in 3.4.1 that users want to avoid. Right now, they can use any version between 3.0.3 and 3.4.1, so it's easy to avoid versions that have bugs that users want to avoid. That wouldn't be the case after this change.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518109792/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518118825","html_url":"https://github.com/apache/accumulo/issues/5132#issuecomment-2518118825","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5132","id":2518118825,"node_id":"IC_kwDOACaFSM6WF3Gp","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-04T17:39:58Z","updated_at":"2024-12-04T17:39:58Z","author_association":"CONTRIBUTOR","body":"This is an example of code that does a lot of stuff when processing a zookeeper event.  This code reads from zookeeper when processing a zookeeper event.  This type of activity could tie up the single thread and prevent processing other events like the one for lost lock.  Posting this as an example of why this change could be useful.\r\n\r\nhttps://github.com/apache/accumulo/blob/c6ec9697da2cfa517eb028d8937ecf10b31c9d6a/server/base/src/main/java/org/apache/accumulo/server/manager/LiveTServerSet.java#L307","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518118825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518339983","html_url":"https://github.com/apache/accumulo/issues/5132#issuecomment-2518339983","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5132","id":2518339983,"node_id":"IC_kwDOACaFSM6WGtGP","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-04T19:09:54Z","updated_at":"2024-12-04T19:09:54Z","author_association":"MEMBER","body":"> It would create an extra zookeeper connection per server, but would avoid the constant pings to zookeeper allowing Accumulo to rely on the zookeeper notification mechanisms.\r\n\r\nI think that we are already creating more ZK client objects than we need to anyway, which is something I'm addressing as part of #5124, so it may not be so bad to have the separate one just for this purpose.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518339983/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518345645","html_url":"https://github.com/apache/accumulo/issues/5136#issuecomment-2518345645","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5136","id":2518345645,"node_id":"IC_kwDOACaFSM6WGuet","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-04T19:12:32Z","updated_at":"2024-12-04T19:12:32Z","author_association":"CONTRIBUTOR","body":"I tried to find where this is defined in the code with a few different greps and was unable to find anything.  So this is probably being composed from constants or something like that.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518345645/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518357711","html_url":"https://github.com/apache/accumulo/issues/5134#issuecomment-2518357711","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5134","id":2518357711,"node_id":"IC_kwDOACaFSM6WGxbP","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-04T19:18:54Z","updated_at":"2024-12-04T19:18:54Z","author_association":"CONTRIBUTOR","body":"Accumulo will select random servers for some client operations.  If there are lot of servers and client is making lots of API calls that select a random servers then what happens w/ ZK watches in that client over time?  This is an example of a scenario where it would be nice to have data for clients in addition to servers.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518357711/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518542540","html_url":"https://github.com/apache/accumulo/issues/5117#issuecomment-2518542540","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5117","id":2518542540,"node_id":"IC_kwDOACaFSM6WHejM","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-04T20:55:56Z","updated_at":"2024-12-04T20:55:56Z","author_association":"CONTRIBUTOR","body":"In addition to causing thread contention this issue has the potential to cause memory problems.  Ran into the following problem.\r\n\r\nWas using the changes in https://github.com/apache/accumulo-testing/pull/287 to generate bulk imports.  This bug in 287 https://github.com/apache/accumulo-testing/pull/288 caused some bulk imports to a single tablet to have lots of files.  Did not have the 288 bug fix in testing and ended up with a tablet w/ 25K files.  There were lots of concurrent compactions running against this tablet.  When these finished they would create a conditional mutation which included the 25k files in a condition.   These conditional mutations would cause lots of memory pressure on the tablet server.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518542540/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518569614","html_url":"https://github.com/apache/accumulo/issues/5138#issuecomment-2518569614","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5138","id":2518569614,"node_id":"IC_kwDOACaFSM6WHlKO","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-04T21:11:06Z","updated_at":"2024-12-04T21:11:44Z","author_association":"CONTRIBUTOR","body":"https://github.com/apache/accumulo/issues/5117#issuecomment-2518542540  this is an example of one problem that could happen w/ too many files in tablet.  Most Accumulo code assumes that all tablet metadata can be read into memory.  When a tablet has 25K files and many threads reading that tablets metadata into memory it can cause a lot of memory pressure.  There are other problems too many files can cause for merge, split, scan, and compaction also.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518569614/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518618654","html_url":"https://github.com/apache/accumulo/issues/5047#issuecomment-2518618654","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5047","id":2518618654,"node_id":"IC_kwDOACaFSM6WHxIe","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-04T21:41:49Z","updated_at":"2024-12-04T21:41:49Z","author_association":"CONTRIBUTOR","body":"Examining jstacks of a running manager I was seeing lots of threads stuck in ZooCache waiting to resolve if a tablet server currently had its lock.  Things were getting stuck in zoocache because it was continually having to go to zookeeper.  There were only a few tablet servers, so it was not clear why they were getting stuck. After apply the change in #5133 was able to see why zoocache was continually missing and it was because of this issue plus there being multiple tserver resource groups.  This problem results in every scan or write to accumulo hitting zookeeper.  The following is what happened.\r\n\r\n\r\n 1. A scan or write does a check using zoocache to see if the tablet server is currently holding its lock in zookeeper.\r\n 2. When there are multiple resource groups the check will look for the tserver in each resource group calling `zooCache.getChildren(\"<zkroot>/tservers/<resource group>/<tserver>`. \r\n 3. The tservers only exists in one RG and for the ones it does not getChildren does not cache non-existence so it will fall back to zookeeper.\r\n 4. While the getChildren call is made to zookeeper all other threads block for the same path.\r\n\r\nIf there was a single resource group for tablet servers then this problem would not be seen.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518618654/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518683136","html_url":"https://github.com/apache/accumulo/issues/5047#issuecomment-2518683136","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5047","id":2518683136,"node_id":"IC_kwDOACaFSM6WIA4A","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-04T22:24:24Z","updated_at":"2024-12-04T22:24:24Z","author_association":"CONTRIBUTOR","body":"> 1. A scan or write does a check using zoocache to see if the tablet server is currently holding its lock in zookeeper.\r\n> 2. When there are multiple resource groups the check will look for the tserver in each resource group calling `zooCache.getChildren(\"<zkroot>/tservers/<resource group>/<tserver>`.\r\n> 3. The tservers only exists in one RG and for the ones it does not getChildren does not cache non-existence so it will fall back to zookeeper.\r\n> 4. While the getChildren call is made to zookeeper all other threads block for the same path.\r\n> \r\n> If there was a single resource group for tablet servers then this problem would not be seen.\r\n\r\nIs this check originating in the TabletServer to check it's own lock? If so, each process knows which resource group it is in, there is no need to check them all.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518683136/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518695109","html_url":"https://github.com/apache/accumulo/issues/5136#issuecomment-2518695109","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5136","id":2518695109,"node_id":"IC_kwDOACaFSM6WIDzF","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-04T22:32:56Z","updated_at":"2024-12-04T22:32:56Z","author_association":"CONTRIBUTOR","body":"I think it's here:\r\n\r\nhttps://github.com/apache/accumulo/blob/cd07dc60360b3c14009380b0b0d96f2197757b26/server/base/src/main/java/org/apache/accumulo/server/rpc/TServerUtils.java#L309","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2518695109/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2520255717","html_url":"https://github.com/apache/accumulo/pull/5140#issuecomment-2520255717","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5140","id":2520255717,"node_id":"IC_kwDOACaFSM6WOAzl","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-05T12:58:04Z","updated_at":"2024-12-05T12:58:04Z","author_association":"CONTRIBUTOR","body":"Full IT build passed","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2520255717/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2520526499","html_url":"https://github.com/apache/accumulo/issues/5130#issuecomment-2520526499","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5130","id":2520526499,"node_id":"IC_kwDOACaFSM6WPC6j","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-05T14:48:05Z","updated_at":"2024-12-05T14:48:45Z","author_association":"CONTRIBUTOR","body":"@kevinrr888 - Is this something you wanted to take a look at? I figure we were involved with the recent FATE changes and updates so one of us could probably work on this and feel free to grab it if you want to but if you were not interested or working on something else I could take a look as well.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2520526499/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2520606151","html_url":"https://github.com/apache/accumulo/issues/5047#issuecomment-2520606151","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5047","id":2520606151,"node_id":"IC_kwDOACaFSM6WPWXH","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-05T15:18:54Z","updated_at":"2024-12-05T15:21:00Z","author_association":"CONTRIBUTOR","body":"> Is this check originating in the TabletServer to check it's own lock? If so, each process knows which resource group it is in, there is no need to check them all.\r\n\r\nNot in this case.  I observed the problem happening in the tablet location cache which checks the lock in zoo cache prio to returning a location. The tablet location cache gets the tserver location from the metadata table where the RG is unknown.  This was causing every scan/write in accumulo to make a read to zookeeper as all RGs were checked.  Not sure if this is workable or worthwhile but wondering about adding the RG to the tsever location stored in the metadata table.  Then the tablet location cache would know of it.  Also scans of the metadata table would know of it and it could be exposed via TabletInformation.  The RG is invariant for the lifetime of the tserver process so storing it there seems like it would be safe.  The downside is its just reduntant data.  If we did this the location entry in the metadata table might look like `<RG>:<host>:<port>[<session>]`\r\n\r\nIf there are places in the code that are doing a lock check and the RG is known then it would be nice to pass it along.  Need to survey the code and see if there are any places like this.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2520606151/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2520632400","html_url":"https://github.com/apache/accumulo/issues/5130#issuecomment-2520632400","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5130","id":2520632400,"node_id":"IC_kwDOACaFSM6WPcxQ","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-05T15:29:16Z","updated_at":"2024-12-05T15:36:21Z","author_association":"MEMBER","body":"@cshannon - Yeah, I would be interested in looking at this. Currently working on some end of year stuff right now, so if you're free feel free to pick this up if you would like. I probably wouldn't be able to get to this until next week","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2520632400/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2520890066","html_url":"https://github.com/apache/accumulo/issues/5139#issuecomment-2520890066","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5139","id":2520890066,"node_id":"IC_kwDOACaFSM6WQbrS","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-05T16:43:53Z","updated_at":"2024-12-05T16:43:53Z","author_association":"CONTRIBUTOR","body":"I can revisit this and see what I come up with, it would be nice if we just needed to add a new java module option, etc but I'll try and find out if there's a bigger issue preventing JDK 17 from being used.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2520890066/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2520907682","html_url":"https://github.com/apache/accumulo/issues/5047#issuecomment-2520907682","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5047","id":2520907682,"node_id":"IC_kwDOACaFSM6WQf-i","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-05T16:51:41Z","updated_at":"2024-12-05T16:51:41Z","author_association":"CONTRIBUTOR","body":"> I observed the problem happening in the tablet location cache which checks the lock in zoo cache prio to returning a location. The tablet location cache gets the tserver location from the metadata table where the RG is unknown.\r\n\r\nThere could be an alternate way to determine the resource group of a tserver that is hosting the tablet - the value of `table.custom.assignment.group` in the tables' configuration. I'm not sure if you have access to this in the TabletLocationCache code or not, but in theory this should help.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2520907682/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2520915554","html_url":"https://github.com/apache/accumulo/issues/5130#issuecomment-2520915554","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5130","id":2520915554,"node_id":"IC_kwDOACaFSM6WQh5i","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-05T16:55:16Z","updated_at":"2024-12-05T16:55:16Z","author_association":"CONTRIBUTOR","body":"> @cshannon - Yeah, I would be interested in looking at this. Currently working on some end of year stuff right now, so if you're free feel free to pick this up if you would like. I probably wouldn't be able to get to this until next week\r\n\r\n@kevinrr888 - Alright, I am planning to work on #5117 and to take a look into #5139 this week (and i will also look to see if there are any other issues that need to be worked on) so not sure yet if i I will have time either this week but i'll let you know if i start looking at it first","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2520915554/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2520926820","html_url":"https://github.com/apache/accumulo/issues/5130#issuecomment-2520926820","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5130","id":2520926820,"node_id":"IC_kwDOACaFSM6WQkpk","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-05T17:00:29Z","updated_at":"2024-12-05T17:00:29Z","author_association":"MEMBER","body":"@cshannon - Cool, sounds good","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2520926820/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2520961096","html_url":"https://github.com/apache/accumulo/issues/5047#issuecomment-2520961096","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5047","id":2520961096,"node_id":"IC_kwDOACaFSM6WQtBI","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-05T17:16:50Z","updated_at":"2024-12-05T17:16:50Z","author_association":"CONTRIBUTOR","body":"> There could be an alternate way to determine the resource group of a tserver that is hosting the tablet - the value of table.custom.assignment.group in the tables' configuration. I'm not sure if you have access to this in the TabletLocationCache code or not, but in theory this should help.\r\n\r\nThat may not always be a reliable way to determine the RG.  Interpreting that property depends on the configured balancer, so that could lead to differences in the property and what is actually happening.  Also if the config changes then there is a time where the current tserver RG and the desired tserver RG could differ.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2520961096/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2521323674","html_url":"https://github.com/apache/accumulo/pull/5144#issuecomment-2521323674","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5144","id":2521323674,"node_id":"IC_kwDOACaFSM6WSFia","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-05T20:25:24Z","updated_at":"2024-12-05T20:25:24Z","author_association":"CONTRIBUTOR","body":"If this is approved then #5142 can be closed","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2521323674/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2521583218","html_url":"https://github.com/apache/accumulo/pull/5028#issuecomment-2521583218","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5028","id":2521583218,"node_id":"IC_kwDOACaFSM6WTE5y","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-05T22:18:41Z","updated_at":"2024-12-05T22:18:41Z","author_association":"CONTRIBUTOR","body":">  It seems strange to me that a worker would still be running... there is only one transaction which is even attempted to be reserved (the one we seed in the test) and that is always followed by an unreserve (verified with logs). @keith-turner \r\nmaybe you have some ideas?\r\n\r\nI tried running these test and did not see a problem. I saw an unrelated problem and made a comment about that.  If I could see the problem I think I would try to jstack the process and see what the thread was doing.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2521583218/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2523535430","html_url":"https://github.com/apache/accumulo/issues/5139#issuecomment-2523535430","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5139","id":2523535430,"node_id":"IC_kwDOACaFSM6WahhG","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-06T15:47:10Z","updated_at":"2024-12-06T15:48:52Z","author_association":"CONTRIBUTOR","body":"I tested this out with main (4.0.0-SNAPSHOT), Uno, and accumulo-testing and it seems to be working. Based on the Hadoop Jira ticket it seems like there are some incompatibilities with libraries such as Guice 4.x but testing with the extra java arguments seems to work in my testing. I didn't see any map reduce failures as noted in slack.\r\n\r\nI made the following changes to get things to work:\r\n\r\n1. Bumped the required target JDK to 17 for accumulo and I built a new 4.0.0-SNAPSHOT off main.\r\n2. Set up a new accumulo install with Uno using 4.0.0-SNAPSHOT\r\n3. Modified hadoop.sh to no longer skip yarn when using JDK 17 and to start it up\r\n4. Tried to start up the instance and verified the same errors we saw before were in the resource manager and node manager logs as shown in the Slack [chat](https://the-asf.slack.com/archives/CERNB8NDC/p1712870215519739).\r\n5. Added the following to yarn-env.sh: \r\n```\r\nexport YARN_RESOURCEMANAGER_OPTS=\"--add-opens java.base/java.lang=ALL-UNNAMED\"\r\nexport YARN_NODEMANAGER_OPTS=\"--add-opens java.base/java.lang=ALL-UNNAMED\"\r\n```\r\n6. Restarted Uno and verified all the errors were gone out of the hadoop logs\r\n7. I bumped the required JDK target to 17 for accumulo-testing project and updated the accumulo dependency to 4.0.0-SNAPSHOT and rebuilt the project.\r\n8. I ran the continuous ingest test and ingested some data for a few minutes and then i ran the verify test which submits a map/reduce job and it completed successfully. I ran this a few times. Both the hadoop resource manager web page and the output from the logs and console show it completed without error.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2523535430/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2523557023","html_url":"https://github.com/apache/accumulo/issues/5139#issuecomment-2523557023","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5139","id":2523557023,"node_id":"IC_kwDOACaFSM6Wamyf","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-06T15:54:28Z","updated_at":"2024-12-06T15:54:28Z","author_association":"CONTRIBUTOR","body":"I had a bunch of weird issues at first trying to test until I realized I had to also update accumulo-testing to target JDK 17 and depend on accumulo 4.0 and once I did that (and removed some of the deprecated features that were removed in 4.0) things worked without issue","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2523557023/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2523828025","html_url":"https://github.com/apache/accumulo/pull/5144#issuecomment-2523828025","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5144","id":2523828025,"node_id":"IC_kwDOACaFSM6Wbo85","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-06T17:40:05Z","updated_at":"2024-12-06T17:40:05Z","author_association":"MEMBER","body":"Oh, the main reason I didn't do these changes before, was that I wasn't sure what the implication was of clearing the cache for one use case (like table config) on the other use cases (watching locks, or checking permissions). I think that's the main risk of sharing a ZooCache... that one cache eviction for correctness may result in poor performance in another piece of code using the same cache.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2523828025/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2523829177","html_url":"https://github.com/apache/accumulo/issues/5130#issuecomment-2523829177","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5130","id":2523829177,"node_id":"IC_kwDOACaFSM6WbpO5","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-06T17:40:48Z","updated_at":"2024-12-06T17:40:48Z","author_association":"CONTRIBUTOR","body":"> One other idea I thought of is if we could configure the fate thread pool be to use a [PriorityBlockingQueue](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/PriorityBlockingQueue.html) and then write a comparator to bump the priority of certain fate operation types higher than others so they run first.\r\n\r\nA prioq would not work w/ current code structure.  Currently fate has a single thread that scans looking for work.  When it finds work it use a transfer queue to directly pass what it found to any of the idle fate threads that are looking for work.  The code is structured this way to avoid queuing the same fate op over and over as the work finder thread keeps repeatedly scanning looking for work.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2523829177/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2523832374","html_url":"https://github.com/apache/accumulo/issues/5130#issuecomment-2523832374","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5130","id":2523832374,"node_id":"IC_kwDOACaFSM6WbqA2","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-06T17:42:43Z","updated_at":"2024-12-06T17:42:43Z","author_association":"CONTRIBUTOR","body":"> A prioq would not work w/ current code structure. Currently fate has a single thread that scans looking for work. When it finds work it use a transfer queue to directly pass what it found to any of the idle fate threads that are looking for work. The code is structured this way to avoid queuing the same fate op over and over as the work finder thread keeps repeatedly scanning looking for work.\r\n\r\nI completely forgot that we changed that code to use a transfer queue so yeah that would definitely not work.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2523832374/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2523931449","html_url":"https://github.com/apache/accumulo/issues/5134#issuecomment-2523931449","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5134","id":2523931449,"node_id":"IC_kwDOACaFSM6WcCM5","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-06T18:39:30Z","updated_at":"2024-12-06T18:39:30Z","author_association":"CONTRIBUTOR","body":"This zookeeper client has class for inspecting a clients watches.  Maybe accumulo processes could be made to call that and dump their watches.   Could also setup metrics in each process to report the number of watches it has.\r\n\r\nhttps://zookeeper.apache.org/doc/current/apidocs/zookeeper-server/org/apache/zookeeper/server/watch/WatchManager.html ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2523931449/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2524004630","html_url":"https://github.com/apache/accumulo/pull/5142#issuecomment-2524004630","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5142","id":2524004630,"node_id":"IC_kwDOACaFSM6WcUEW","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-06T19:25:47Z","updated_at":"2024-12-06T19:25:47Z","author_association":"CONTRIBUTOR","body":"Closed in favor of #5144 targeting the 2.1 branch ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2524004630/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2524059831","html_url":"https://github.com/apache/accumulo/pull/5073#issuecomment-2524059831","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5073","id":2524059831,"node_id":"IC_kwDOACaFSM6Wchi3","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-06T20:01:34Z","updated_at":"2024-12-06T20:01:34Z","author_association":"MEMBER","body":"Thanks for the reviews @dlmarion @ctubbsii \r\nIf I could get a final approval from you Christopher, I'll get this merged in. Thanks","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2524059831/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2524085057","html_url":"https://github.com/apache/accumulo/issues/5137#issuecomment-2524085057","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5137","id":2524085057,"node_id":"IC_kwDOACaFSM6WcntB","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-06T20:18:56Z","updated_at":"2024-12-06T20:18:56Z","author_association":"CONTRIBUTOR","body":"If #5145 is merged, then this could call `ServiceLock.verifyLockAtSource()` and halt the VM if it returns false. If it returns true, maybe retry.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2524085057/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2524217370","html_url":"https://github.com/apache/accumulo/issues/5137#issuecomment-2524217370","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5137","id":2524217370,"node_id":"IC_kwDOACaFSM6WdIAa","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-06T21:34:39Z","updated_at":"2024-12-06T21:34:39Z","author_association":"CONTRIBUTOR","body":"> If https://github.com/apache/accumulo/pull/5145 is merged, then this could call ServiceLock.verifyLockAtSource() and halt the VM if it returns false. If it returns true, maybe retry.\r\n\r\nThat sounds good.  Also opened #5146 about checking after walog failures.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2524217370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2524568324","html_url":"https://github.com/apache/accumulo/issues/5134#issuecomment-2524568324","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5134","id":2524568324,"node_id":"IC_kwDOACaFSM6WedsE","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-06T23:00:47Z","updated_at":"2024-12-06T23:00:47Z","author_association":"CONTRIBUTOR","body":"Discovered WatchManager is not public API for zookeeper.  So may not be able to get a count of watches for a zookeeper object.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2524568324/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2525192277","html_url":"https://github.com/apache/accumulo/pull/5102#issuecomment-2525192277","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5102","id":2525192277,"node_id":"IC_kwDOACaFSM6Wg2BV","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-07T14:41:43Z","updated_at":"2024-12-07T14:41:43Z","author_association":"CONTRIBUTOR","body":"InstanceOperationsIT is failing after this merge, may be due to this change.\r\n\r\n```\r\norg.opentest4j.AssertionFailedError: Unexpected exception type thrown, expected: <java.lang.IllegalArgumentException> but was: <org.apache.accumulo.core.client.AccumuloException>\r\n\tat org.junit.jupiter.api.AssertionFailureBuilder.build(AssertionFailureBuilder.java:151)\r\n\tat org.junit.jupiter.api.AssertThrows.assertThrows(AssertThrows.java:67)\r\n\tat org.junit.jupiter.api.AssertThrows.assertThrows(AssertThrows.java:35)\r\n\tat org.junit.jupiter.api.Assertions.assertThrows(Assertions.java:3115)\r\n\tat org.apache.accumulo.test.InstanceOperationsIT.testGetServers(InstanceOperationsIT.java:158)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:569)\r\n\tat java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n\tat java.base/java.lang.Thread.run(Thread.java:840)\r\nCaused by: org.apache.accumulo.core.client.AccumuloException: java.util.concurrent.ExecutionException: java.lang.IllegalArgumentException: Server type COMPACTOR is not SCAN_SERVER or TABLET_SERVER.\r\n\tat org.apache.accumulo.core.clientImpl.InstanceOperationsImpl.queryServers(InstanceOperationsImpl.java:424)\r\n\tat org.apache.accumulo.core.clientImpl.InstanceOperationsImpl.getActiveScans(InstanceOperationsImpl.java:281)\r\n\tat org.apache.accumulo.test.InstanceOperationsIT.lambda$testGetServers$5(InstanceOperationsIT.java:158)\r\n\tat org.junit.jupiter.api.AssertThrows.assertThrows(AssertThrows.java:53)\r\n\t... 8 more\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2525192277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2525194852","html_url":"https://github.com/apache/accumulo/pull/5104#issuecomment-2525194852","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5104","id":2525194852,"node_id":"IC_kwDOACaFSM6Wg2pk","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-07T14:50:42Z","updated_at":"2024-12-07T14:50:42Z","author_association":"CONTRIBUTOR","body":"New failure in SplitiT after this change, may be due to this:\r\n\r\n```\r\norg.opentest4j.AssertionFailedError: expected: <0> but was: <1>\r\n\tat org.junit.jupiter.api.AssertionFailureBuilder.build(AssertionFailureBuilder.java:151)\r\n\tat org.junit.jupiter.api.AssertionFailureBuilder.buildAndThrow(AssertionFailureBuilder.java:132)\r\n\tat org.junit.jupiter.api.AssertEquals.failNotEqual(AssertEquals.java:197)\r\n\tat org.junit.jupiter.api.AssertEquals.assertEquals(AssertEquals.java:150)\r\n\tat org.junit.jupiter.api.AssertEquals.assertEquals(AssertEquals.java:145)\r\n\tat org.junit.jupiter.api.Assertions.assertEquals(Assertions.java:531)\r\n\tat org.apache.accumulo.test.functional.SplitIT.bulkImportThatCantSplitHangsCompaction(SplitIT.java:515)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:569)\r\n\tat java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n\tat java.base/java.lang.Thread.run(Thread.java:840)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2525194852/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2525244532","html_url":"https://github.com/apache/accumulo/pull/5104#issuecomment-2525244532","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5104","id":2525244532,"node_id":"IC_kwDOACaFSM6WhCx0","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-07T16:56:11Z","updated_at":"2024-12-07T16:56:11Z","author_association":"CONTRIBUTOR","body":"Opened #5148 to fix that test issue, seems like that test had a preexisting problem and was just flaky.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2525244532/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2525255467","html_url":"https://github.com/apache/accumulo/pull/5145#issuecomment-2525255467","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5145","id":2525255467,"node_id":"IC_kwDOACaFSM6WhFcr","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-07T17:35:39Z","updated_at":"2024-12-07T17:35:39Z","author_association":"CONTRIBUTOR","body":"Merged up to main. Changed property default value to 2m in 3.1 branch.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2525255467/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2526170843","html_url":"https://github.com/apache/accumulo/pull/5152#issuecomment-2526170843","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5152","id":2526170843,"node_id":"IC_kwDOACaFSM6Wkk7b","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-08T15:06:09Z","updated_at":"2024-12-08T15:08:09Z","author_association":"CONTRIBUTOR","body":"@dlmarion and @keith-turner  - This fixes the failed test mentioned [here](https://github.com/apache/accumulo/pull/5102#issuecomment-2525192277)\r\n\r\nThe cause was that with the refactoring to make everything multi-threaded all the validation was being done for each server in a new thread and the exception was being wrapped in ExecutionException and then caught and unwrapped and rethrown as AccumuloException.\r\n\r\nI could have fixed the test to handle this but instead I thought it made a lot more sense to do a pre-validation before the thread pool was constructed and any RPC calls are made. The time it takes to iterate through even a few thousand servers just to check the type and fail fast before making any RPC calls is going to be trivial and it prevents the case where all the requests get made and eat up a bunch of resources when one of the servers are invalid which causes the whole thing to eventually fail anyways. \r\n\r\nBesides this new validation potentially saving resources, it also has the nice side effect of fixing the test failure as the IllegalArgumentException is now properly thrown again and not wrapped.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2526170843/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2526213695","html_url":"https://github.com/apache/accumulo/pull/5150#issuecomment-2526213695","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5150","id":2526213695,"node_id":"IC_kwDOACaFSM6WkvY_","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-08T16:44:25Z","updated_at":"2024-12-08T16:44:25Z","author_association":"CONTRIBUTOR","body":"Oops, I didn't see this PR before I submitted #5152. It looks like both PRs more or less do the same thing so I will close mine.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2526213695/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2526213960","html_url":"https://github.com/apache/accumulo/pull/5152#issuecomment-2526213960","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5152","id":2526213960,"node_id":"IC_kwDOACaFSM6WkvdI","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-08T16:45:06Z","updated_at":"2024-12-08T16:45:06Z","author_association":"CONTRIBUTOR","body":"Closing as I didn't realize #5150 was opened and this is basically a duplicate","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2526213960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2526223833","html_url":"https://github.com/apache/accumulo/issues/5130#issuecomment-2526223833","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5130","id":2526223833,"node_id":"IC_kwDOACaFSM6Wkx3Z","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-08T17:00:16Z","updated_at":"2024-12-08T17:00:16Z","author_association":"CONTRIBUTOR","body":"@kevinrr888 - I didn't get a chance to look at this so you can go ahead and grab it this week, I'll be working on #5014","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2526223833/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2528083469","html_url":"https://github.com/apache/accumulo/issues/5130#issuecomment-2528083469","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5130","id":2528083469,"node_id":"IC_kwDOACaFSM6Wr34N","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-09T14:16:16Z","updated_at":"2024-12-09T14:16:16Z","author_association":"MEMBER","body":"@cshannon sounds good, thanks","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2528083469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2528912273","html_url":"https://github.com/apache/accumulo/issues/5134#issuecomment-2528912273","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5134","id":2528912273,"node_id":"IC_kwDOACaFSM6WvCOR","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-09T17:54:20Z","updated_at":"2024-12-09T17:54:20Z","author_association":"CONTRIBUTOR","body":"This comment proposed a potential way for zoocache to deal with entries read from zoocache only once.   This may or may not actually be a problem.  Need to collect data on how much this happens in a live Accumulo system and go from there.  That data collection could possibly be done as part of this issue.\r\n\r\nhttps://github.com/apache/accumulo/pull/5143#discussion_r1873997910","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2528912273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2529399255","html_url":"https://github.com/apache/accumulo/pull/5127#issuecomment-2529399255","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5127","id":2529399255,"node_id":"IC_kwDOACaFSM6Ww5HX","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-09T20:39:36Z","updated_at":"2024-12-09T20:39:36Z","author_association":"MEMBER","body":"Addressed in 29edaa2cd79ab2920edc9d2a4355e9f761ff78d8:\r\n- Got rid of END_REPO_DATA marker, replacing with simply writing the number of repos to read\r\n- Avoid AtomicBoolean in `MetaFateStore.FateTxStoreImpl.push(repo)` by changing StackOverflowException to instead be a RuntimeException (previously Exception)\r\n- Deleted unnecessary preexisting catch and immediate re-throw of a StackOverflowException in `MetaFateStore.FateTxStoreImpl.push(repo)`\r\n- Cleaned up and refactored `MetaFateStore` methods which mutate existing FateData; now reuse same pattern across these methods: all call new method `MetaFateStore.mutate()`","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2529399255/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2529777620","html_url":"https://github.com/apache/accumulo/pull/5158#issuecomment-2529777620","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5158","id":2529777620,"node_id":"IC_kwDOACaFSM6WyVfU","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-09T23:28:27Z","updated_at":"2024-12-09T23:28:27Z","author_association":"MEMBER","body":"This won't merge cleanly to 3.1 or main, because the scripts have been modified too much in each. I can reimplement it in each branch, but in future, it would be nice to try to see if we can bring the scripts from the main branch into the 3.1 branch, so we only have one set of scripts to maintain in 3.1 and 4.0. I don't think 4.0 contains accumulo-cluster features that are specific to 4.0, and would apply equally well to 3.1, but that's out of scope of this issue... it just would have made this issue easier to merge forward.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2529777620/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2529804277","html_url":"https://github.com/apache/accumulo/pull/5158#issuecomment-2529804277","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5158","id":2529804277,"node_id":"IC_kwDOACaFSM6Wyb_1","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-09T23:45:24Z","updated_at":"2024-12-09T23:58:08Z","author_association":"MEMBER","body":"For additional background, the reason why eval was being used at all was because setting a variable for a specific execution of a command does not work when calling it directly, as in:\r\n\r\n```bash\r\n# this works fine, but we might want to execute using a function that logs the command instead of executes, for debugging purposes\r\nSOMETHING=foo env | grep SOMETHING\r\n\r\ndebug() { \"$@\"; }\r\ndebug SOMETHING=foo env | grep SOMETHING # causes error - bash: SOMETHING=foo: command not found\r\n\r\ndebug2() { eval \"$@\"; }\r\ndebug2 SOMETHING=foo env | grep SOMETHING # this works, but requires complicated nested quoting of arguments\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2529804277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2531759436","html_url":"https://github.com/apache/accumulo/pull/5158#issuecomment-2531759436","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5158","id":2531759436,"node_id":"IC_kwDOACaFSM6W55VM","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-10T14:16:19Z","updated_at":"2024-12-10T14:16:19Z","author_association":"CONTRIBUTOR","body":"> This won't merge cleanly to 3.1 or main, because the scripts have been modified too much in each. I can reimplement it in each branch, but in future, it would be nice to try to see if we can bring the scripts from the main branch into the 3.1 branch, so we only have one set of scripts to maintain in 3.1 and 4.0. I don't think 4.0 contains accumulo-cluster features that are specific to 4.0, and would apply equally well to 3.1, but that's out of scope of this issue... it just would have made this issue easier to merge forward.\r\n\r\ntserver resource groups are a change specific to 4.0 which does help simplify the accumulo-cluster logic.\r\nWe could introduce the concept internally to the cluster script in 3.1, but that may lead to confusion and additional complexity to handle not setting the resource group override prop for tservers.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2531759436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2531830387","html_url":"https://github.com/apache/accumulo/pull/5127#issuecomment-2531830387","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5127","id":2531830387,"node_id":"IC_kwDOACaFSM6W6Kpz","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-10T14:43:25Z","updated_at":"2024-12-10T14:43:25Z","author_association":"MEMBER","body":"Resolved the conflicts from the recent seed transaction speedup. Thankfully, those changes were mostly for UserFateStore and these are for MetaFateStore, so conflicts were very easy","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2531830387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2532511644","html_url":"https://github.com/apache/accumulo/issues/5163#issuecomment-2532511644","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5163","id":2532511644,"node_id":"IC_kwDOACaFSM6W8w-c","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-10T18:13:30Z","updated_at":"2024-12-10T18:13:30Z","author_association":"MEMBER","body":"closing this in favor of just adding it to the checklist in https://github.com/apache/accumulo/issues/4892","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2532511644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2532692048","html_url":"https://github.com/apache/accumulo/pull/5164#issuecomment-2532692048","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5164","id":2532692048,"node_id":"IC_kwDOACaFSM6W9dBQ","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-10T19:33:19Z","updated_at":"2024-12-10T19:33:19Z","author_association":"CONTRIBUTOR","body":"I started testing this changes against main and there are some issues with starting accumulo still present. \r\n\r\nMarking this as draft until that is resolved.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2532692048/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2532936125","html_url":"https://github.com/apache/accumulo/pull/5028#issuecomment-2532936125","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5028","id":2532936125,"node_id":"IC_kwDOACaFSM6W-Ym9","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-10T21:33:00Z","updated_at":"2024-12-10T21:33:00Z","author_association":"MEMBER","body":"> I tried running these test and did not see a problem. I saw an unrelated problem and made a comment about that. If I could see the problem I think I would try to jstack the process and see what the thread was doing.\r\n\r\n@keith-turner - I don't see the problem/comment you are referring to. I did notice the exit status when Admin loses the lock caused some test failures (noticed when resolving conflicts), so I fixed that in 8cc7b39908d290b353b60ea65a94b9b300090c80\r\n\r\nI'm going to try to figure out the worker issue with your jstack suggestion.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2532936125/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2533008175","html_url":"https://github.com/apache/accumulo/pull/5158#issuecomment-2533008175","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5158","id":2533008175,"node_id":"IC_kwDOACaFSM6W-qMv","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-10T22:01:28Z","updated_at":"2024-12-10T22:01:28Z","author_association":"MEMBER","body":"@ddanielr wrote:\r\n> I don't think the readability is great with these changes.\r\n\r\nAgreed, but it's nearly impossible to get readability when you want to print quotes. We can pull those out, and the readability will improve, but the printed result will (probably) not be copy-and-paste-able. I'm okay with that, if others are.\r\n\r\n> If the script was extremely static then that is less of an issue. However we've been modifying these scripts pretty frequently across the different accumulo versions.\r\n\r\nThe latest iteration in the main branch (aside from a few breakages that this attempts to fix) are quite nice. It'd be easier if we could adopt the same scripts across all branches, instead of them having different versions of the script. I understand some differences are needed, but I think the actual required differences are probably pretty small, and we could use the same version of the scripts (mostly) in all branches.\r\n\r\n> Using the `&&` `||` logic is harder to parse as commends start to become nested.\r\n\r\nTrue, but I don't think I have any complicated nesting here. I didn't even have to use curly braces. The uses I used were very simple cases. Those can certainly be converted to if-then-else-fi blocks, though, if they are hard to read like this. I had them as if-then-else-fi blocks to begin with, but it actually looked a little more complicated. This pattern is a simple \"if debug print || execute\".\r\n\r\n> However I do understand the confusion about what the command actually looks like when it gets run vs being echo'd out.\r\n> \r\n> To help troubleshoot this I was using the `set -v` bash option to determine what the script was doing.\r\n\r\n`set -v` can be used for troubleshooting, sure. It can't be used to avoid execution, though... which is the purpose of the debug function, in support of the `--dry-run` flag. Similarly, you can't use `set -x` to show the expanded command to be executed. If the goal is just to debug while executing, either of those would be fine, but as originally written, it was to support a `--dry-run` flag, which means do not execute.\r\n\r\n> I created #5164 to remove the reliance on the bash version. But I tried testing those changes on `main` and it did not solely solve the issue.\r\n> \r\n> If this code is currently functional in 2.1 then I would prefer to not merge these changes and pursue #5164 if the reasoning is due to the reliance on newer bash features.\r\n\r\nNo, #5164 is not sufficient. The problem isn't the reliance on the newer bash feature. The problem is the nested quoting due to indirect execution. The way it is currently implemented, it is *not* functioning correctly. Having the function do the optional printing or executing means an extra layer of quoting, and that makes it *very* difficult to reason about. Getting it to work with the extra layer of quoting for the indirect execution via the function means that the readability of the actual command being executed is poor. In my version, for this PR, only the printed message's readability is poor, but at least the correctness of the printed message is easy to verify from running with `--dry-run`. It is far less easy to verify the correctness of a poorly readable command that is actually being executed.\r\n\r\nI don't mind using the printf solution in #5164 to help print the commands without needing to make them so hard to read. However, to ensure correctness of the command actually being executed, and to ensure we have the ability to reason about those commands, I strongly thing we should avoid using a function to indirectly execute the actual commands. And that's the core part of this PR that I'd want to keep.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2533008175/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2533033360","html_url":"https://github.com/apache/accumulo/pull/4523#issuecomment-2533033360","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4523","id":2533033360,"node_id":"IC_kwDOACaFSM6W-wWQ","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-10T22:08:16Z","updated_at":"2024-12-10T22:08:16Z","author_association":"MEMBER","body":"I removed 2.1.4 milestone, since it looks like this PR was closed due to the branch being deleted, but was not merged.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2533033360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2533047462","html_url":"https://github.com/apache/accumulo/issues/5139#issuecomment-2533047462","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5139","id":2533047462,"node_id":"IC_kwDOACaFSM6W-zym","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-10T22:11:49Z","updated_at":"2024-12-10T22:11:49Z","author_association":"MEMBER","body":"Awesome! Thanks, @cshannon . I think that unblocks us from targeting Java 17, but to help with development, we need some changes in the accumulo-testing repo and in the fluo-uno repo.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2533047462/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2533050647","html_url":"https://github.com/apache/accumulo/pull/4523#issuecomment-2533050647","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4523","id":2533050647,"node_id":"IC_kwDOACaFSM6W-0kX","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-10T22:12:45Z","updated_at":"2024-12-10T22:12:45Z","author_association":"CONTRIBUTOR","body":"Oops I was cleaning up stale branches and deleted this by mistake so I can restore it, either way it may not be merged at this point so best to take off 2.1.4.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2533050647/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2535962587","html_url":"https://github.com/apache/accumulo/issues/5154#issuecomment-2535962587","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5154","id":2535962587,"node_id":"IC_kwDOACaFSM6XJ7fb","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-11T13:15:57Z","updated_at":"2024-12-11T13:15:57Z","author_association":"CONTRIBUTOR","body":"@keith-turner  - did you see that WatchTheWatchCountIT is also failing in `main`? I added the following to see what was being watched. It seems as if every ZooKeeper session (Accumulo process?) has a Watcher set on every tserver. Seemed odd to me.\r\n\r\n```\r\ndiff --git a/minicluster/src/main/java/org/apache/accumulo/miniclusterImpl/MiniAccumuloClusterImpl.java b/minicluster/src/main/java/org/apache/accumulo/miniclusterImpl/MiniAccumuloClusterImpl.java\r\nindex e8a55081c3..2308e774ee 100644\r\n--- a/minicluster/src/main/java/org/apache/accumulo/miniclusterImpl/MiniAccumuloClusterImpl.java\r\n+++ b/minicluster/src/main/java/org/apache/accumulo/miniclusterImpl/MiniAccumuloClusterImpl.java\r\n@@ -291,7 +291,7 @@ public class MiniAccumuloClusterImpl implements AccumuloCluster {\r\n       zooCfg.setProperty(\"clientPort\", config.getZooKeeperPort() + \"\");\r\n       zooCfg.setProperty(\"maxClientCnxns\", \"1000\");\r\n       zooCfg.setProperty(\"dataDir\", config.getZooKeeperDir().getAbsolutePath());\r\n-      zooCfg.setProperty(\"4lw.commands.whitelist\", \"ruok,wchs\");\r\n+      zooCfg.setProperty(\"4lw.commands.whitelist\", \"ruok,wchs,wchp\");\r\n       zooCfg.setProperty(\"admin.enableServer\", \"false\");\r\n       zooCfg.store(fileWriter, null);\r\n \r\ndiff --git a/test/src/main/java/org/apache/accumulo/test/functional/WatchTheWatchCountIT.java b/test/src/main/java/org/apache/accumulo/test/functional/WatchTheWatchCountIT.java\r\nindex b90d8b7c6e..fd89e21612 100644\r\n--- a/test/src/main/java/org/apache/accumulo/test/functional/WatchTheWatchCountIT.java\r\n+++ b/test/src/main/java/org/apache/accumulo/test/functional/WatchTheWatchCountIT.java\r\n@@ -88,6 +88,15 @@ public class WatchTheWatchCountIT extends ConfigurableMacBase {\r\n       log.info(\"Number of watchers to be expected in range: ({}, {}), currently have {}\", MIN, MAX,\r\n           total);\r\n \r\n+      if (total >= MAX) {\r\n+        try (Socket socket = new Socket(hostAndPort.getHost(), hostAndPort.getPort())) {\r\n+          socket.getOutputStream().write(\"wchp\\n\".getBytes(UTF_8), 0, 5);\r\n+          byte[] buffer = new byte[10485760];\r\n+          int n = socket.getInputStream().read(buffer);\r\n+          String response = new String(buffer, 0, n, UTF_8);\r\n+          System.out.println(response);\r\n+        }        \r\n+      }\r\n       assertTrue(total > MIN && total < MAX, \"Expected number of watchers to be contained in (\"\r\n           + MIN + \", \" + MAX + \"), but actually was \" + total);\r\n \r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2535962587/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2536341409","html_url":"https://github.com/apache/accumulo/issues/5154#issuecomment-2536341409","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5154","id":2536341409,"node_id":"IC_kwDOACaFSM6XLX-h","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-11T15:38:16Z","updated_at":"2024-12-11T15:38:16Z","author_association":"CONTRIBUTOR","body":"> @keith-turner - did you see that WatchTheWatchCountIT is also failing in main? I added the following to see what was being watched. It seems as if every ZooKeeper session (Accumulo process?) has a Watcher set on every tserver. Seemed odd to me.\r\n\r\nNo I had not seen that, I can look into it.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2536341409/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2536791070","html_url":"https://github.com/apache/accumulo/pull/5028#issuecomment-2536791070","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5028","id":2536791070,"node_id":"IC_kwDOACaFSM6XNFwe","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-11T18:17:41Z","updated_at":"2024-12-11T18:21:46Z","author_association":"MEMBER","body":"So, I was testing this yesterday, and was able to reproduce the same issue running `UserFateOpsCommandsIT.testFateFailCommandTimeout()`. I got a jstack trace of the thread:\r\n```\r\n\"accumulo.pool.manager.fate-Worker-3\" #64 daemon prio=5 os_prio=0 cpu=130772.51ms elapsed=138.20s tid=0x000075971000c9b0 nid=0x610aa runnable  [0x0000759863ffd000]\r\n   java.lang.Thread.State: RUNNABLE\r\n\tat java.util.concurrent.LinkedTransferQueue.awaitMatch(java.base@17.0.12/LinkedTransferQueue.java:652)\r\n\tat java.util.concurrent.LinkedTransferQueue.xfer(java.base@17.0.12/LinkedTransferQueue.java:616)\r\n\tat java.util.concurrent.LinkedTransferQueue.poll(java.base@17.0.12/LinkedTransferQueue.java:1294)\r\n\tat org.apache.accumulo.core.fate.Fate$TransactionRunner.reserveFateTx(Fate.java:134)\r\n\tat org.apache.accumulo.core.fate.Fate$TransactionRunner.run(Fate.java:154)\r\n\tat org.apache.accumulo.core.trace.TraceWrappedRunnable.run(TraceWrappedRunnable.java:52)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.12/ThreadPoolExecutor.java:1136)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.12/ThreadPoolExecutor.java:635)\r\n\tat org.apache.accumulo.core.trace.TraceWrappedRunnable.run(TraceWrappedRunnable.java:52)\r\n\tat java.lang.Thread.run(java.base@17.0.12/Thread.java:840)\r\n```\r\nAnd this is seen again with this repeatedly printed (statement printed from `Fate.shutdown()`):\r\n```\r\nFate USER is waiting for worker threads to terminate\r\n```\r\nI tried to reproduce again today with some debugging statements to better figure out why the worker would still be running, but after many, many attempts, I did not see the same failure again. Without being able to consistently reproduce the bug and without understanding based on the code how this could be occurring, I'm out of ideas and things to do to figure this out. \r\n\r\nI'm not sure if this is a bug with my testing logic for the tests where I have seen this bug (`testFateFailCommandTimeout`, `testFateDeleteCommandTimeout`) (in which case, the bug doesn't matter), or if this is a bug with the preexisting `Fate.java` code (and is unrelated to these tests and PR and just happened to show up here).\r\n\r\nAnyways, I'm out of things to try. Whenever you get the chance @keith-turner maybe you could look at the test logic, `Fate.java` code, and above stack trace and see if something sticks out to you. Or if you think this potential bug with `Fate.java` is not really something to worry about, we can just move on.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2536791070/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2536841737","html_url":"https://github.com/apache/accumulo/pull/5028#issuecomment-2536841737","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5028","id":2536841737,"node_id":"IC_kwDOACaFSM6XNSIJ","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-11T18:42:58Z","updated_at":"2024-12-11T18:42:58Z","author_association":"MEMBER","body":"One thing I am considering is maybe this order of shutdown in `Fate.shutdown` is the source of the problem:\r\n```\r\nif (keepRunning.compareAndSet(true, false)) {\r\n      fatePoolWatcher.shutdown();\r\n      transactionExecutor.shutdown();\r\n      workFinder.interrupt();\r\n```\r\nwork finder is interrupted after the workers are shutdown... I think it makes more sense to interrupt the work finder then shutdown the worker pool ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2536841737/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2536975878","html_url":"https://github.com/apache/accumulo/pull/5165#issuecomment-2536975878","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5165","id":2536975878,"node_id":"IC_kwDOACaFSM6XNy4G","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-11T19:51:19Z","updated_at":"2024-12-11T19:51:19Z","author_association":"MEMBER","body":"This is probably not any news to you but when trying to set up an instance via fluo-uno, on main (9b283488c4) no accumulo components are successfully started up, but on this branch (2d316b3200) I at least see a tserver, sserver and compactor start up.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2536975878/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2537204723","html_url":"https://github.com/apache/accumulo/pull/5158#issuecomment-2537204723","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5158","id":2537204723,"node_id":"IC_kwDOACaFSM6XOqvz","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-11T21:14:10Z","updated_at":"2024-12-11T21:14:10Z","author_association":"MEMBER","body":"Closing this in favor of #5167 (for the main branch). It's changes will need to be subsequently backported to 2.1 and 3.1","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2537204723/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2537207002","html_url":"https://github.com/apache/accumulo/pull/5164#issuecomment-2537207002","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5164","id":2537207002,"node_id":"IC_kwDOACaFSM6XOrTa","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-11T21:14:55Z","updated_at":"2024-12-11T21:14:55Z","author_association":"MEMBER","body":"Closing in favor of #5167 for the main branch (will need to be backported to 2.1 and 3.1)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2537207002/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2537224008","html_url":"https://github.com/apache/accumulo/pull/5165#issuecomment-2537224008","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5165","id":2537224008,"node_id":"IC_kwDOACaFSM6XOvdI","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-11T21:25:26Z","updated_at":"2024-12-11T21:25:26Z","author_association":"MEMBER","body":"The changes from this PR were incorporated into #5167","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2537224008/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2537332133","html_url":"https://github.com/apache/accumulo/issues/5014#issuecomment-2537332133","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5014","id":2537332133,"node_id":"IC_kwDOACaFSM6XPJ2l","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-11T22:28:07Z","updated_at":"2025-01-10T18:15:39Z","author_association":"CONTRIBUTOR","body":"Several of us talked and came up with a path forward for now, the tentative plan to try is:\r\n\r\n1. There will be a new property created that is a percentage or ratio of the split threshold that can be used for automatic merges. The intent is that tablets can be merged together once they are below the threshold (ie maybe 10% or 25% of the split threshold). This prevents automatic merging from creating a tablet too big that will just immediately split.\r\n2. A new column in metadata for the tablet that will store mergeability state of a table (if a tablet is eligible to be automatically merged). There will be 3 possible states and these will be represented by a duration that is relative to manager steady time. The exact names are still to be determined but we could represent it with something like NEVER (no duration set), NOW (0), FUTURE (timestamp). Future would mean that the tablet is eligible after some period of time for merging relative to the steady time.\r\n3. There will need to be an updated API to set the mergeability information. A new method in the API called putSplits() can be created that will either create or update existing splits to set the mergeability. The existing addSplits() method can be deprecated and just default to never. The create table API can also be created with splits and this will also be able to set it.\r\n4. There would need to be some way for a user to read the mergeability state of the tablet so needs to be returned as part of a new API call or modify an existing API.\r\n5. By default, all user created tablets could be marked with a state of NEVER and system spits would be marked as NOW (or whatever we call it) so they can automatically merge. Pre-created splits for system tables like Fate, and Metadata, etc would be marked as NEVER by default.\r\n6. On upgrade we would mark all existing tablets as NEVER.\r\n\r\nOne thing I am still trying to figure out is how the automatic merging should work if we reach the threshold we set (say smaller than 10% of the split threshold) and if we should only ever merge together 2 tablets or try and merge as many as possible etc.\r\n\r\n@keith-turner - Is there anything I missed or got wrong after the conversation and conclusions we came to?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2537332133/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2537341833","html_url":"https://github.com/apache/accumulo/issues/5014#issuecomment-2537341833","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5014","id":2537341833,"node_id":"IC_kwDOACaFSM6XPMOJ","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-11T22:35:25Z","updated_at":"2024-12-11T22:35:25Z","author_association":"CONTRIBUTOR","body":"> One thing I am still trying to figure out is how the automatic merging should work if we reach the threshold we set (say smaller than 10% of the split threshold) and if we should only ever merge together 2 tablets or try and merge as many as possible etc.\r\n\r\nI like merging as many tablets that fit into the merge threshold. So if we have five tablets and the sum of their existing sizes is less than the merge threshold then can merge all five of them.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2537341833/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2539389401","html_url":"https://github.com/apache/accumulo/issues/5162#issuecomment-2539389401","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5162","id":2539389401,"node_id":"IC_kwDOACaFSM6XXAHZ","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-12T16:09:13Z","updated_at":"2024-12-12T16:09:13Z","author_association":"CONTRIBUTOR","body":"From what I can tell, the logic in `LiveTServerSet.checkServer` only adds the tablet server to the dead list if the tablet server path in ZooKeeper exists but there is no lock data, or if the instance does not match (like the tserver was restarted at the same host/port location). The ZooKeeper node for the tserver is deleted after 10 minutes if there is no lock data.\r\n\r\nThis information is only shown on the Monitor. We could add a Monitor property that is a list of resource groups to ignore, then use that when calling `DeadServerList.getList` to skip dead servers with a matching resource group in the ServiceLockPath.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2539389401/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2539410566","html_url":"https://github.com/apache/accumulo/pull/5167#issuecomment-2539410566","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5167","id":2539410566,"node_id":"IC_kwDOACaFSM6XXFSG","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-12T16:18:11Z","updated_at":"2024-12-12T16:18:11Z","author_association":"MEMBER","body":"I'm working on backporting these fixes to 2.1 and 3.1, along with the other recent changes to the scripts, so that they are more similar across branches, and easier to maintain.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2539410566/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2539562639","html_url":"https://github.com/apache/accumulo/issues/5157#issuecomment-2539562639","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5157","id":2539562639,"node_id":"IC_kwDOACaFSM6XXqaP","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-12T17:22:32Z","updated_at":"2024-12-12T17:22:32Z","author_association":"CONTRIBUTOR","body":"From what I can tell LiveTServerSet implements Watcher so that it can be passed to ZooCache and so ZooCache can call `processEvent`. The external watcher (LiveTServerSet) is never set on ZooKeeper, it's just using the interface so that it can do the callback. We could change the interface if we wanted to avoid confusion.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2539562639/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2540106877","html_url":"https://github.com/apache/accumulo/pull/5174#issuecomment-2540106877","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5174","id":2540106877,"node_id":"IC_kwDOACaFSM6XZvR9","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-12T22:06:41Z","updated_at":"2024-12-12T22:06:41Z","author_association":"MEMBER","body":"The diffs here are probably not going to be very helpful. The more relevant diff is between these changed files and the current contents of 3.1 and main. Some of these differences go away when merging into 3.1, and most of the rest goes away when merging into main. There are a few small improvements in here that I do expect to include in the main branch, though. Those are specifically:\r\n\r\n```patch\r\ndiff --git a/assemble/bin/accumulo-cluster b/assemble/bin/accumulo-cluster\r\nindex a87ad4938a..31dff57d81 100755\r\n--- a/assemble/bin/accumulo-cluster\r\n+++ b/assemble/bin/accumulo-cluster\r\n@@ -38,7 +38,7 @@ Commands:\r\n   start-here                 Deprecated. Alias for \"start --local --all\"\r\n   stop-here                  Deprecated. Alias for \"stop --local --all\"\r\n   restart [--local] [--all | [--manager] [--gc] [--monitor] [--tservers[=group]] [--sservers[=group]] [--compactors[=group]]\r\n-                             Restarts the Accumulo cluster\r\n+                             Restarts Accumulo cluster services\r\n   start [--local] [--all | [--manager] [--gc] [--monitor] [--tservers[=group]] [--sservers[=group]] [--compactors[=group]]\r\n                              Starts Accumulo cluster services\r\n   stop [--local] [--all | [--manager] [--gc] [--monitor] [--tservers[=group]] [--sservers[=group]] [--compactors[=group]]\r\n@@ -53,7 +53,7 @@ Commands:\r\n   accumulo-cluster start --local                           # start all local services\r\n   accumulo-cluster start --local --manager                 # start local manager services\r\n   accumulo-cluster start --tservers                        # start all tservers\r\n-  accumulo-cluster start --tservers=group1                 # start all group1 tservers\r\n+  accumulo-cluster start --sservers=group1                 # start all group1 sservers\r\n   accumulo-cluster start --local --manager --tservers      # Start the local manager and local tservers\r\n \r\n EOF\r\n@@ -140,7 +140,7 @@ function parse_args {\r\n   if [[ $ARG_ALL == 1 && ($ARG_MANAGER == 1 ||\r\n     $ARG_GC == 1 || $ARG_MONITOR == 1 || $ARG_TSERVER == 1 ||\r\n     $ARG_SSERVER == 1 || $ARG_COMPACTOR == 1) ]]; then\r\n-    echo \"--all cannot be used with other options\"\r\n+    echo -- \"--all cannot be used with other options\"\r\n     print_usage\r\n     exit 1\r\n   fi\r\n@@ -152,20 +152,17 @@ function parse_args {\r\n     ARG_ALL=1\r\n   fi\r\n \r\n-  if isDebug; then\r\n-    echo \"DEBUG=$DEBUG\"\r\n-    echo \"ARG_ALL=$ARG_ALL\"\r\n-    echo \"ARG_LOCAL=$ARG_LOCAL\"\r\n-    echo \"ARG_MANAGER=$ARG_MANAGER\"\r\n-    echo \"ARG_GC=$ARG_GC\"\r\n-    echo \"ARG_MONITOR=$ARG_MONITOR\"\r\n-    echo \"ARG_TSERVER=$ARG_TSERVER\"\r\n-    echo \"ARG_TSERVER_GROUP=$ARG_TSERVER_GROUP\"\r\n-    echo \"ARG_SSERVER=$ARG_SSERVER\"\r\n-    echo \"ARG_SSERVER_GROUP=$ARG_SSERVER_GROUP\"\r\n-    echo \"ARG_COMPACTOR=$ARG_COMPACTOR\"\r\n-    echo \"ARG_COMPACTOR_GROUP=$ARG_COMPACTOR_GROUP\"\r\n-  fi\r\n+  debug \"ARG_ALL=$ARG_ALL\"\r\n+  debug \"ARG_LOCAL=$ARG_LOCAL\"\r\n+  debug \"ARG_MANAGER=$ARG_MANAGER\"\r\n+  debug \"ARG_GC=$ARG_GC\"\r\n+  debug \"ARG_MONITOR=$ARG_MONITOR\"\r\n+  debug \"ARG_TSERVER=$ARG_TSERVER\"\r\n+  debug \"ARG_TSERVER_GROUP=$ARG_TSERVER_GROUP\"\r\n+  debug \"ARG_SSERVER=$ARG_SSERVER\"\r\n+  debug \"ARG_SSERVER_GROUP=$ARG_SSERVER_GROUP\"\r\n+  debug \"ARG_COMPACTOR=$ARG_COMPACTOR\"\r\n+  debug \"ARG_COMPACTOR_GROUP=$ARG_COMPACTOR_GROUP\"\r\n }\r\n \r\n function invalid_args {\r\ndiff --git a/assemble/bin/accumulo-service b/assemble/bin/accumulo-service\r\nindex ae5c424de8..e56e647227 100755\r\n--- a/assemble/bin/accumulo-service\r\n+++ b/assemble/bin/accumulo-service\r\n@@ -111,7 +111,7 @@ function start_service() {\r\n     rotate_log \"$outfile\"\r\n     rotate_log \"$errfile\"\r\n \r\n-    nohup \"${bin}/accumulo\" \"$service_type\" \"$@\" \"${PROPERTY_OVERRIDES[@]}\" >\"$outfile\" 2>\"$errfile\" </dev/null &\r\n+    nohup \"${bin}/accumulo\" \"$service_type\" \"$@\" >\"$outfile\" 2>\"$errfile\" </dev/null &\r\n     echo \"$!\" >\"${pid_file}\"\r\n \r\n   done\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2540106877/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2540134960","html_url":"https://github.com/apache/accumulo/pull/5167#issuecomment-2540134960","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5167","id":2540134960,"node_id":"IC_kwDOACaFSM6XZ2Iw","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-12T22:26:43Z","updated_at":"2024-12-12T22:26:43Z","author_association":"MEMBER","body":"Backport to 2.1 available in #5174 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2540134960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2540218967","html_url":"https://github.com/apache/accumulo/issues/5175#issuecomment-2540218967","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5175","id":2540218967,"node_id":"IC_kwDOACaFSM6XaKpX","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-12T23:36:15Z","updated_at":"2024-12-12T23:36:15Z","author_association":"CONTRIBUTOR","body":"In 3.1 and 2.1 these loaded markers could be left behid because of race conditions.  Because of this there was a mechanism in 3.1 and 2.1 to clean them up.   In 4.0 that race condition should be gone, so do not want to automatically clean up.  Thinking the check command can be used to find these and then they can be investigated and cleaned up.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2540218967/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2540234736","html_url":"https://github.com/apache/accumulo/issues/5175#issuecomment-2540234736","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5175","id":2540234736,"node_id":"IC_kwDOACaFSM6XaOfw","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-12T23:50:24Z","updated_at":"2024-12-12T23:50:24Z","author_association":"CONTRIBUTOR","body":"Could also look for selected columns for which there is no live fate operation. These columns are placed by the fate operation that drives user compactions.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2540234736/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2541844144","html_url":"https://github.com/apache/accumulo/issues/5139#issuecomment-2541844144","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5139","id":2541844144,"node_id":"IC_kwDOACaFSM6XgXaw","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-13T16:45:32Z","updated_at":"2024-12-13T16:45:32Z","author_association":"CONTRIBUTOR","body":"> Awesome! Thanks, @cshannon . I think that unblocks us from targeting Java 17, but to help with development, we need some changes in the accumulo-testing repo and in the fluo-uno repo.\r\n\r\nfluo-uno should now correctly start up Yarn when running with JDK 17 and execute map reduce correctly after merging https://github.com/apache/fluo-uno/pull/305 . \r\n\r\nI think we need to wait on changes to accumulo-testing for changes to the main branch in accumulo first. The biggest thing to change in the testing repo is to bump the target JDK to 17 to be in sync with the target JDK of 17 in accumulo when ti's time.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2541844144/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2541853708","html_url":"https://github.com/apache/accumulo/pull/5171#issuecomment-2541853708","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5171","id":2541853708,"node_id":"IC_kwDOACaFSM6XgZwM","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-13T16:51:10Z","updated_at":"2024-12-13T16:53:40Z","author_association":"MEMBER","body":"> LGTM, I'm not sure how doable it is but looking at this I'm wondering if it would be possible to write a test that verifies the correct number of transaction runners are started if the pool is resized. That could always be done as a follow on or maybe just added as part of #5130 as that will be refactoring all the thread pool stuff anyways\r\n\r\nYeah, I considered that as well. I think it would be a doable test. I think most likely I'll be adding tests for all the changes for #5130 anyways so would probably be easiest to include with those changes (would have the downside of only testing in 4.0+ though). Or, could just add the test here or as a follow on later like you mentioned","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2541853708/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2542204071","html_url":"https://github.com/apache/accumulo/issues/5178#issuecomment-2542204071","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5178","id":2542204071,"node_id":"IC_kwDOACaFSM6XhvSn","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-13T19:58:37Z","updated_at":"2024-12-13T19:58:37Z","author_association":"CONTRIBUTOR","body":"This is blocked by the merging of #5174 into 2.1 and 2.1 into 3.1 and main","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2542204071/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2542279760","html_url":"https://github.com/apache/accumulo/issues/5177#issuecomment-2542279760","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5177","id":2542279760,"node_id":"IC_kwDOACaFSM6XiBxQ","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-13T20:35:13Z","updated_at":"2024-12-13T20:36:45Z","author_association":"CONTRIBUTOR","body":"The Jetty solution (or another async solution like gRPC) would be interesting to try because you'd get the performance benefits as well. As you pointed out, we'd need to make sure to limit things by passing in a thread pool when there is a job available [here](https://github.com/apache/accumulo/pull/5018/files#diff-f7cd33f7e1f9321ed285551c95577effc1f35880f80dcaa6e1c74d1ccae8987eR391-R395) and that should prevent trying to reserve too many jobs at once.\r\n\r\nAnother thing that would help solve this problem would be #4978 because if those changes were made then the compaction coordinator would no longer be handling the job reservations as that responsibility would be moved to the compactor itself","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2542279760/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2542323943","html_url":"https://github.com/apache/accumulo/issues/5123#issuecomment-2542323943","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5123","id":2542323943,"node_id":"IC_kwDOACaFSM6XiMjn","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-13T20:48:11Z","updated_at":"2024-12-13T20:48:11Z","author_association":"MEMBER","body":"#5148 addressed the flaky SplitIT","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2542323943/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2542430067","html_url":"https://github.com/apache/accumulo/pull/5174#issuecomment-2542430067","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5174","id":2542430067,"node_id":"IC_kwDOACaFSM6Ximdz","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-13T21:44:01Z","updated_at":"2024-12-13T21:44:01Z","author_association":"MEMBER","body":"Ah, right, I thought we might run into this. The bash variable is based on the service name, and the coordinator has a dash in the service name, which you can't have in a bash variable. I'll work around that.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2542430067/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2542436212","html_url":"https://github.com/apache/accumulo/issues/5130#issuecomment-2542436212","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5130","id":2542436212,"node_id":"IC_kwDOACaFSM6Xin90","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-13T21:49:05Z","updated_at":"2024-12-13T21:49:05Z","author_association":"CONTRIBUTOR","body":"The current fate code creates two thread pools one for meta and one for user.  Both thread pools give threads the same name in jstack.  Would be nice if work around this gave any new threads pools different names in jstack.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2542436212/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2543168806","html_url":"https://github.com/apache/accumulo/issues/4978#issuecomment-2543168806","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4978","id":2543168806,"node_id":"IC_kwDOACaFSM6Xla0m","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-14T16:06:36Z","updated_at":"2024-12-14T16:06:36Z","author_association":"CONTRIBUTOR","body":"I suspect this approach would be more workable it tablet servers used async processing.  Then they could gracefully handle a large number of compactor processes submitting conditional mutations for compaction reservation and compaction commit.  But that may not be needed given that the current thrift thread pool just grows as needed which kinda works but is not ideal.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2543168806/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2543169390","html_url":"https://github.com/apache/accumulo/issues/5177#issuecomment-2543169390","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5177","id":2543169390,"node_id":"IC_kwDOACaFSM6Xla9u","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-14T16:08:01Z","updated_at":"2024-12-14T16:08:01Z","author_association":"CONTRIBUTOR","body":"> Another thing that would help solve this problem would be https://github.com/apache/accumulo/issues/4978 because if those changes were made then the compaction coordinator would no longer be handling the job reservations as that responsibility would be moved to the compactor itself\r\n\r\nThat is a good point.  I made a comment on 4978 about async processing for tserver conditional mutation processing.  I think that would make that change work really smoothly, but may not be required for it work smoothly.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2543169390/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2543171138","html_url":"https://github.com/apache/accumulo/issues/5177#issuecomment-2543171138","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5177","id":2543171138,"node_id":"IC_kwDOACaFSM6XlbZC","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-14T16:13:23Z","updated_at":"2024-12-14T16:13:23Z","author_association":"CONTRIBUTOR","body":"> That is a good point. I made a comment on 4978 about async processing for tserver conditional mutation processing. I think that would make that change work really smoothly, but may not be required for it work smoothly.\r\n\r\nI think the final solution will probably be both changes working together to make it very fast and lower the required resources. if we move the compaction job request to async then that keeps the request threadpool free so we don't block other requests, it allows us to bound the number job we requests we process to at one time with a worker thread pool, and it moves the reservation to the compactor which reduces the load even further on the manager.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2543171138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2543320311","html_url":"https://github.com/apache/accumulo/issues/4978#issuecomment-2543320311","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4978","id":2543320311,"node_id":"IC_kwDOACaFSM6Xl_z3","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-14T19:29:02Z","updated_at":"2024-12-14T19:30:05Z","author_association":"CONTRIBUTOR","body":"The changes in #5184 make this change safer to make.  Arsync server side RPC processing plus #5184 would be even better though for lots of compactor processes interacting directly with tservers.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2543320311/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2543353424","html_url":"https://github.com/apache/accumulo/pull/5184#issuecomment-2543353424","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5184","id":2543353424,"node_id":"IC_kwDOACaFSM6XmH5Q","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-14T21:45:31Z","updated_at":"2024-12-14T21:45:31Z","author_association":"CONTRIBUTOR","body":"> LGTM, in terms of a default size, picking a static number is fine but I'm also wondering if it would be possible to make the default dynamic. There's going to be a wide range of servers in terms of how much cpu/memory they have so having the default scale up or down by detecting the resources could be nice. But it's definitely simpler to just make users configure what they want.\r\n\r\nAdjusted the defaults from 16 threads to 64 threads since it used to be unlimited thought a higher default would be good.  Can use the metrics to monitor the utilization of the thread pool and adjust it based on those.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2543353424/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]