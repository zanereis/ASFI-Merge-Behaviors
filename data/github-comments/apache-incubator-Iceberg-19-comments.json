[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547097687","html_url":"https://github.com/apache/iceberg/pull/580#issuecomment-547097687","issue_url":"https://api.github.com/repos/apache/iceberg/issues/580","id":547097687,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzA5NzY4Nw==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-28T19:00:37Z","updated_at":"2019-10-28T19:00:37Z","author_association":"CONTRIBUTOR","body":"@rdblue, thanks for taking a look. I've addressed your comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547097687/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547105037","html_url":"https://github.com/apache/iceberg/pull/587#issuecomment-547105037","issue_url":"https://api.github.com/repos/apache/iceberg/issues/587","id":547105037,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzEwNTAzNw==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-28T19:19:23Z","updated_at":"2019-10-28T19:19:23Z","author_association":"CONTRIBUTOR","body":"learned a new word today! :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547105037/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547273725","html_url":"https://github.com/apache/iceberg/issues/504#issuecomment-547273725","issue_url":"https://api.github.com/repos/apache/iceberg/issues/504","id":547273725,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzI3MzcyNQ==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-29T06:17:26Z","updated_at":"2019-10-29T06:17:26Z","author_association":"COLLABORATOR","body":"@aokolnychyi, Thanks for your explanation.\r\n\r\nI think I didn't understand the use case you mentioned.  I thought a new manifest should always have a new snapshot ID whatever entries it takes.  While you were considering the checkpoint or compacting thing so that the manifest should contain the same snapshot as its original manifest. Do I understand correctly now?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547273725/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547329482","html_url":"https://github.com/apache/iceberg/pull/514#issuecomment-547329482","issue_url":"https://api.github.com/repos/apache/iceberg/issues/514","id":547329482,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzMyOTQ4Mg==","user":{"login":"andrei-ionescu","id":3389505,"node_id":"MDQ6VXNlcjMzODk1MDU=","avatar_url":"https://avatars.githubusercontent.com/u/3389505?v=4","gravatar_id":"","url":"https://api.github.com/users/andrei-ionescu","html_url":"https://github.com/andrei-ionescu","followers_url":"https://api.github.com/users/andrei-ionescu/followers","following_url":"https://api.github.com/users/andrei-ionescu/following{/other_user}","gists_url":"https://api.github.com/users/andrei-ionescu/gists{/gist_id}","starred_url":"https://api.github.com/users/andrei-ionescu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrei-ionescu/subscriptions","organizations_url":"https://api.github.com/users/andrei-ionescu/orgs","repos_url":"https://api.github.com/users/andrei-ionescu/repos","events_url":"https://api.github.com/users/andrei-ionescu/events{/privacy}","received_events_url":"https://api.github.com/users/andrei-ionescu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-29T09:23:08Z","updated_at":"2019-10-29T09:23:08Z","author_association":"CONTRIBUTOR","body":"@rdblue Congrats for the `0.7` version release! Can you have a look into this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547329482/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547382887","html_url":"https://github.com/apache/iceberg/pull/467#issuecomment-547382887","issue_url":"https://api.github.com/repos/apache/iceberg/issues/467","id":547382887,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzM4Mjg4Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-29T11:49:16Z","updated_at":"2019-10-29T11:49:16Z","author_association":"CONTRIBUTOR","body":"I think we can merge this PR now. @rdblue, what do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547382887/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547471806","html_url":"https://github.com/apache/iceberg/pull/512#issuecomment-547471806","issue_url":"https://api.github.com/repos/apache/iceberg/issues/512","id":547471806,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzQ3MTgwNg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-29T15:13:44Z","updated_at":"2019-10-29T15:13:44Z","author_association":"CONTRIBUTOR","body":"@bryanck @rdblue I've updated the PR and put the logic into a separate class as it seems reasonable to me. I still assume utilities will convert manifest entry statuses from `ADDED` to `EXISTING` themselves as it will allow us to avoid copying manifests in the future.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547471806/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547472678","html_url":"https://github.com/apache/iceberg/pull/588#issuecomment-547472678","issue_url":"https://api.github.com/repos/apache/iceberg/issues/588","id":547472678,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzQ3MjY3OA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-29T15:15:23Z","updated_at":"2019-10-29T15:15:23Z","author_association":"CONTRIBUTOR","body":"@chenjunjiedada, thanks for working on this! I'll be interested to review whenever I have a bit of time.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547472678/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547481132","html_url":"https://github.com/apache/iceberg/issues/575#issuecomment-547481132","issue_url":"https://api.github.com/repos/apache/iceberg/issues/575","id":547481132,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzQ4MTEzMg==","user":{"login":"andrei-ionescu","id":3389505,"node_id":"MDQ6VXNlcjMzODk1MDU=","avatar_url":"https://avatars.githubusercontent.com/u/3389505?v=4","gravatar_id":"","url":"https://api.github.com/users/andrei-ionescu","html_url":"https://github.com/andrei-ionescu","followers_url":"https://api.github.com/users/andrei-ionescu/followers","following_url":"https://api.github.com/users/andrei-ionescu/following{/other_user}","gists_url":"https://api.github.com/users/andrei-ionescu/gists{/gist_id}","starred_url":"https://api.github.com/users/andrei-ionescu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrei-ionescu/subscriptions","organizations_url":"https://api.github.com/users/andrei-ionescu/orgs","repos_url":"https://api.github.com/users/andrei-ionescu/repos","events_url":"https://api.github.com/users/andrei-ionescu/events{/privacy}","received_events_url":"https://api.github.com/users/andrei-ionescu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-29T15:31:26Z","updated_at":"2019-10-29T15:31:26Z","author_association":"CONTRIBUTOR","body":"The steps are:\r\n\r\n1. Have a schema and its json data\r\n2. Add a simple partition and a nested partition\r\n3. Write the data in `iceberg` format using Iceberg data frame writer \r\n4. Read the data into a new Iceberg dataset\r\n\r\nThe last step fails with the error above. \r\n\r\nHere is some code to explain the issue (extracted from the [gist above](https://gist.github.com/andrei-ionescu/b3e5f5345df3166af7562a830d3dc57d)).\r\n\r\n```scala\r\nSchema nestedSchema = new Schema(\r\n    optional(1, \"id\", Types.IntegerType.get()),\r\n    optional(2, \"data\", Types.StringType.get()),\r\n    optional(3, \"nestedData\", Types.StructType.of(\r\n        optional(4, \"id\", Types.IntegerType.get()),\r\n        optional(5, \"moreData\", Types.StringType.get())))\r\n);\r\n\r\nFile parent = temp.newFolder(\"parquet\");\r\nFile location = new File(parent, \"test\");\r\n\r\nHadoopTables tables = new HadoopTables(new Configuration());\r\nPartitionSpec spec = PartitionSpec.builderFor(nestedSchema)\r\n    .identity(\"id\")\r\n    .identity(\"nestedData.moreData\")\r\n    .build();\r\nTable table = tables.create(nestedSchema, spec, location.toString());\r\n\r\nList<String> jsons = Lists.newArrayList(\r\n    \"{ \\\"id\\\": 1, \\\"data\\\": \\\"a\\\", \\\"nestedData\\\": { \\\"id\\\": 100, \\\"moreData\\\": \\\"p1\\\"} }\",\r\n    \"{ \\\"id\\\": 2, \\\"data\\\": \\\"b\\\", \\\"nestedData\\\": { \\\"id\\\": 200, \\\"moreData\\\": \\\"p1\\\"} }\",\r\n    \"{ \\\"id\\\": 3, \\\"data\\\": \\\"c\\\", \\\"nestedData\\\": { \\\"id\\\": 300, \\\"moreData\\\": \\\"p2\\\"} }\",\r\n    \"{ \\\"id\\\": 4, \\\"data\\\": \\\"d\\\", \\\"nestedData\\\": { \\\"id\\\": 400, \\\"moreData\\\": \\\"p2\\\"} }\"\r\n);\r\nDataset<Row> df = spark\r\n    .read()\r\n    .schema(SparkSchemaUtil.convert(nestedSchema))\r\n    .json(spark.createDataset(jsons, Encoders.STRING()));\r\n\r\n// TODO: incoming columns must be ordered according to the table's schema\r\ndf.select(\"id\", \"data\", \"nestedData\").write()\r\n    .format(\"iceberg\")\r\n    .mode(\"append\")\r\n    .save(location.toString());\r\n\r\ntable.refresh();\r\n\r\nDataset<Row> result = spark.read()\r\n    .format(\"iceberg\")\r\n    .load(location.toString());\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547481132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547482859","html_url":"https://github.com/apache/iceberg/issues/575#issuecomment-547482859","issue_url":"https://api.github.com/repos/apache/iceberg/issues/575","id":547482859,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzQ4Mjg1OQ==","user":{"login":"andrei-ionescu","id":3389505,"node_id":"MDQ6VXNlcjMzODk1MDU=","avatar_url":"https://avatars.githubusercontent.com/u/3389505?v=4","gravatar_id":"","url":"https://api.github.com/users/andrei-ionescu","html_url":"https://github.com/andrei-ionescu","followers_url":"https://api.github.com/users/andrei-ionescu/followers","following_url":"https://api.github.com/users/andrei-ionescu/following{/other_user}","gists_url":"https://api.github.com/users/andrei-ionescu/gists{/gist_id}","starred_url":"https://api.github.com/users/andrei-ionescu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrei-ionescu/subscriptions","organizations_url":"https://api.github.com/users/andrei-ionescu/orgs","repos_url":"https://api.github.com/users/andrei-ionescu/repos","events_url":"https://api.github.com/users/andrei-ionescu/events{/privacy}","received_events_url":"https://api.github.com/users/andrei-ionescu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-29T15:34:50Z","updated_at":"2019-10-29T15:34:50Z","author_association":"CONTRIBUTOR","body":"I updated the issue description too so it would be easier to understand.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547482859/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547487756","html_url":"https://github.com/apache/iceberg/issues/317#issuecomment-547487756","issue_url":"https://api.github.com/repos/apache/iceberg/issues/317","id":547487756,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzQ4Nzc1Ng==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-29T15:44:04Z","updated_at":"2019-10-29T15:44:04Z","author_association":"CONTRIBUTOR","body":"@waterlx I agree that sort orders should be immutable. If we change the sort order for a table, we should produce a new sort order with a fresh id.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547487756/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547601300","html_url":"https://github.com/apache/iceberg/pull/467#issuecomment-547601300","issue_url":"https://api.github.com/repos/apache/iceberg/issues/467","id":547601300,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzYwMTMwMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-29T19:54:58Z","updated_at":"2019-10-29T19:54:58Z","author_association":"CONTRIBUTOR","body":"Sounds good to me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547601300/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547620499","html_url":"https://github.com/apache/iceberg/pull/467#issuecomment-547620499","issue_url":"https://api.github.com/repos/apache/iceberg/issues/467","id":547620499,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzYyMDQ5OQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-29T20:42:58Z","updated_at":"2019-10-29T20:42:58Z","author_association":"CONTRIBUTOR","body":"@lxynov I had only one minor comment. Could you also rebase this PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547620499/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547632356","html_url":"https://github.com/apache/iceberg/pull/467#issuecomment-547632356","issue_url":"https://api.github.com/repos/apache/iceberg/issues/467","id":547632356,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzYzMjM1Ng==","user":{"login":"lxynov","id":47990574,"node_id":"MDQ6VXNlcjQ3OTkwNTc0","avatar_url":"https://avatars.githubusercontent.com/u/47990574?v=4","gravatar_id":"","url":"https://api.github.com/users/lxynov","html_url":"https://github.com/lxynov","followers_url":"https://api.github.com/users/lxynov/followers","following_url":"https://api.github.com/users/lxynov/following{/other_user}","gists_url":"https://api.github.com/users/lxynov/gists{/gist_id}","starred_url":"https://api.github.com/users/lxynov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lxynov/subscriptions","organizations_url":"https://api.github.com/users/lxynov/orgs","repos_url":"https://api.github.com/users/lxynov/repos","events_url":"https://api.github.com/users/lxynov/events{/privacy}","received_events_url":"https://api.github.com/users/lxynov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-29T21:14:17Z","updated_at":"2019-10-29T21:14:17Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi Sure, updated.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547632356/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547639622","html_url":"https://github.com/apache/iceberg/pull/467#issuecomment-547639622","issue_url":"https://api.github.com/repos/apache/iceberg/issues/467","id":547639622,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzYzOTYyMg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-29T21:34:10Z","updated_at":"2019-10-29T21:34:10Z","author_association":"CONTRIBUTOR","body":"@lxynov, thanks! I kept the issue open as this PR is the first step.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547639622/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547667454","html_url":"https://github.com/apache/iceberg/pull/590#issuecomment-547667454","issue_url":"https://api.github.com/repos/apache/iceberg/issues/590","id":547667454,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzY2NzQ1NA==","user":{"login":"xabriel","id":218555,"node_id":"MDQ6VXNlcjIxODU1NQ==","avatar_url":"https://avatars.githubusercontent.com/u/218555?v=4","gravatar_id":"","url":"https://api.github.com/users/xabriel","html_url":"https://github.com/xabriel","followers_url":"https://api.github.com/users/xabriel/followers","following_url":"https://api.github.com/users/xabriel/following{/other_user}","gists_url":"https://api.github.com/users/xabriel/gists{/gist_id}","starred_url":"https://api.github.com/users/xabriel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xabriel/subscriptions","organizations_url":"https://api.github.com/users/xabriel/orgs","repos_url":"https://api.github.com/users/xabriel/repos","events_url":"https://api.github.com/users/xabriel/events{/privacy}","received_events_url":"https://api.github.com/users/xabriel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-29T23:03:37Z","updated_at":"2019-10-29T23:03:37Z","author_association":"CONTRIBUTOR","body":"Failures seem unrelated, around:\r\n```\r\norg.apache.iceberg.hive.TestHiveTableConcurrency > testConcurrentConnections FAILED\r\n5415    java.lang.AssertionError at TestHiveTableConcurrency.java:106\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547667454/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547702930","html_url":"https://github.com/apache/iceberg/pull/227#issuecomment-547702930","issue_url":"https://api.github.com/repos/apache/iceberg/issues/227","id":547702930,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzcwMjkzMA==","user":{"login":"omalley","id":206536,"node_id":"MDQ6VXNlcjIwNjUzNg==","avatar_url":"https://avatars.githubusercontent.com/u/206536?v=4","gravatar_id":"","url":"https://api.github.com/users/omalley","html_url":"https://github.com/omalley","followers_url":"https://api.github.com/users/omalley/followers","following_url":"https://api.github.com/users/omalley/following{/other_user}","gists_url":"https://api.github.com/users/omalley/gists{/gist_id}","starred_url":"https://api.github.com/users/omalley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omalley/subscriptions","organizations_url":"https://api.github.com/users/omalley/orgs","repos_url":"https://api.github.com/users/omalley/repos","events_url":"https://api.github.com/users/omalley/events{/privacy}","received_events_url":"https://api.github.com/users/omalley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T01:46:01Z","updated_at":"2019-10-30T01:46:01Z","author_association":"CONTRIBUTOR","body":"There were a couple of bug fixes that went into ORC 1.6.1, so this PR should upgrade.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547702930/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547707260","html_url":"https://github.com/apache/iceberg/issues/567#issuecomment-547707260","issue_url":"https://api.github.com/repos/apache/iceberg/issues/567","id":547707260,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzcwNzI2MA==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T02:07:29Z","updated_at":"2019-10-30T02:07:29Z","author_association":"CONTRIBUTOR","body":"As for open sourcing Flink Iceberg sink that @rdblue mentioned, it seems that we probably can only get to it on later Q1 or early Q2 due to resource constrains. Need to figure out how to untangle the Netflix specific logics. Goal is to make the open-source Flink sink connector generic and extensible","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547707260/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547767287","html_url":"https://github.com/apache/iceberg/issues/459#issuecomment-547767287","issue_url":"https://api.github.com/repos/apache/iceberg/issues/459","id":547767287,"node_id":"MDEyOklzc3VlQ29tbWVudDU0Nzc2NzI4Nw==","user":{"login":"lxynov","id":47990574,"node_id":"MDQ6VXNlcjQ3OTkwNTc0","avatar_url":"https://avatars.githubusercontent.com/u/47990574?v=4","gravatar_id":"","url":"https://api.github.com/users/lxynov","html_url":"https://github.com/lxynov","followers_url":"https://api.github.com/users/lxynov/followers","following_url":"https://api.github.com/users/lxynov/following{/other_user}","gists_url":"https://api.github.com/users/lxynov/gists{/gist_id}","starred_url":"https://api.github.com/users/lxynov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lxynov/subscriptions","organizations_url":"https://api.github.com/users/lxynov/orgs","repos_url":"https://api.github.com/users/lxynov/repos","events_url":"https://api.github.com/users/lxynov/events{/privacy}","received_events_url":"https://api.github.com/users/lxynov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T07:13:00Z","updated_at":"2019-10-30T07:13:00Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi @rdblue Thanks for the review on #467 . I've created another PR #591 which finishes the decoupling work.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547767287/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547950809","html_url":"https://github.com/apache/iceberg/issues/592#issuecomment-547950809","issue_url":"https://api.github.com/repos/apache/iceberg/issues/592","id":547950809,"node_id":"MDEyOklzc3VlQ29tbWVudDU0Nzk1MDgwOQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T15:02:55Z","updated_at":"2019-10-30T15:02:55Z","author_association":"CONTRIBUTOR","body":"@rdblue is there a particular reason to use the Hive client directly in `SparkTableUtil`?\r\nWhat about this?\r\n\r\n```\r\nspark.sessionState.catalog\r\n  .listPartitions(tableIdentifier)\r\n  .map(p => (p.spec, p.storage.locationUri.map(String.valueOf(_)), p.storage.serde))\r\n  .toDF(\"partition\", \"uri\", \"format\")\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547950809/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547974410","html_url":"https://github.com/apache/iceberg/pull/357#issuecomment-547974410","issue_url":"https://api.github.com/repos/apache/iceberg/issues/357","id":547974410,"node_id":"MDEyOklzc3VlQ29tbWVudDU0Nzk3NDQxMA==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T15:48:29Z","updated_at":"2019-10-30T15:50:07Z","author_association":"COLLABORATOR","body":"Looks like deleting the forked repo causing the PR becomes an orphan due to a github issue (https://github.com/isaacs/github/issues/168).\r\n\r\nI will open another PR to address the comments.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547974410/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547997722","html_url":"https://github.com/apache/iceberg/issues/592#issuecomment-547997722","issue_url":"https://api.github.com/repos/apache/iceberg/issues/592","id":547997722,"node_id":"MDEyOklzc3VlQ29tbWVudDU0Nzk5NzcyMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T16:36:05Z","updated_at":"2019-10-30T16:36:05Z","author_association":"CONTRIBUTOR","body":"Sounds good to me!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/547997722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548041011","html_url":"https://github.com/apache/iceberg/issues/592#issuecomment-548041011","issue_url":"https://api.github.com/repos/apache/iceberg/issues/592","id":548041011,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODA0MTAxMQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T18:04:55Z","updated_at":"2019-10-30T18:04:55Z","author_association":"CONTRIBUTOR","body":"@rdblue, we are also constructing a `DataFrame` in `partitionDF`. What about using a simple case class as we have for manifests and data files? For example, we can have: \r\n\r\n```\r\ncase class TablePartition(partition: Map[String, String], uri: String, format: String)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548041011/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548102722","html_url":"https://github.com/apache/iceberg/issues/592#issuecomment-548102722","issue_url":"https://api.github.com/repos/apache/iceberg/issues/592","id":548102722,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODEwMjcyMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T20:40:07Z","updated_at":"2019-10-30T20:40:07Z","author_association":"CONTRIBUTOR","body":"Is it possible to use our own HiveCatalog for this instead of using Spark? It would be great to avoid using non-public Spark classes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548102722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548110334","html_url":"https://github.com/apache/iceberg/pull/580#issuecomment-548110334","issue_url":"https://api.github.com/repos/apache/iceberg/issues/580","id":548110334,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODExMDMzNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T21:00:31Z","updated_at":"2019-10-30T21:00:31Z","author_association":"CONTRIBUTOR","body":"Thanks @rdsr! I merged this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548110334/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548111126","html_url":"https://github.com/apache/iceberg/issues/592#issuecomment-548111126","issue_url":"https://api.github.com/repos/apache/iceberg/issues/592","id":548111126,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODExMTEyNg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T21:02:49Z","updated_at":"2019-10-30T21:02:49Z","author_association":"CONTRIBUTOR","body":"Could you elaborate a bit? Not sure I got.\r\n\r\nI am proposing to move to `SessionCatalog` in order to get rid of Hive hacks we currently use. In addition, we will get support for the in-memory catalog for free. It also seems reasonable to introduce a case class `TablePartition` like we have `SparkDataFile` as most of the operations in `SparkTableUtil` use typed `Dataset`s. That way, calling `listPartition` will be more readable.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548111126/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548115346","html_url":"https://github.com/apache/iceberg/issues/592#issuecomment-548115346","issue_url":"https://api.github.com/repos/apache/iceberg/issues/592","id":548115346,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODExNTM0Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T21:14:50Z","updated_at":"2019-10-30T21:14:50Z","author_association":"CONTRIBUTOR","body":"Yeah, those changes make sense to me.\r\n\r\nWhat I was suggesting is maybe to try updating to use the Iceberg HiveCatalog instead of SessionCatalog. Then we wouldn't be relying on an internal API that is not public in Spark (SessionState to get the external catalog).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548115346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548123812","html_url":"https://github.com/apache/iceberg/pull/585#issuecomment-548123812","issue_url":"https://api.github.com/repos/apache/iceberg/issues/585","id":548123812,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODEyMzgxMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T21:38:25Z","updated_at":"2019-10-30T21:38:25Z","author_association":"CONTRIBUTOR","body":"I don't think that this fix is correct. It looks like this allows creating a projection schema with a `.` in the name, but that isn't actually returning the data as it would be.\r\n\r\nSay I have records like this: `{\"id\": 1, \"info\": {\"type\": \"x\", ...} }` and I want to store those records by `identity(info.type)` and `bucket(id, 16)`. When I read the data, I should get the original record back, with \"type\" nested within \"info\". But this approach instead would return `{\"id\": 1, \"info.type\": \"x\", \"type\": ...}`. Right?\r\n\r\nI think the solution is to update the Spark code to use constant readers, like we recently added to Pig.\r\n\r\nThe current Spark implementation creates a join row of partition data that must be flat, and then combines it with a row that is materialized from the data file. Instead, we need to materialize the entire record, but instead of reading the partition values, we want to set them to constants instead. That's what the ConstantReader in Pig does. Instead of performing a read from the file to get the data, it just returns the known partition value. This works to fix the current problem because the constant reader is at the right place in the value reader tree, so it looks like this:\r\n\r\n```\r\nStructReader(\r\n  LongReader(pos=0, name=\"id\", decoder=...),\r\n  StructReader(name=\"info\",\r\n    ConstantReader(pos=0, name=\"type\", value=\"x\"),\r\n    StringReader(pos=1, decoder=...),\r\n    ...\r\n  )\r\n);\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548123812/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548124055","html_url":"https://github.com/apache/iceberg/pull/585#issuecomment-548124055","issue_url":"https://api.github.com/repos/apache/iceberg/issues/585","id":548124055,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODEyNDA1NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T21:39:07Z","updated_at":"2019-10-30T21:39:07Z","author_association":"CONTRIBUTOR","body":"Here's where the constant readers were added to Pig: https://github.com/apache/incubator-iceberg/commit/d158818cb90beed3298be48a0a9de2366ba3cdb5\r\n\r\nThat approach should work for Spark as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548124055/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548125375","html_url":"https://github.com/apache/iceberg/pull/590#issuecomment-548125375","issue_url":"https://api.github.com/repos/apache/iceberg/issues/590","id":548125375,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODEyNTM3NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T21:42:54Z","updated_at":"2019-10-30T21:42:54Z","author_association":"CONTRIBUTOR","body":"I don't think this is a correct use of the `schema` method. That is intended for formats that don't have type information, like CSV, so you can set the type instead of getting nothing but strings back.\r\n\r\nBut Iceberg keeps type information, so it doesn't make sense to use the schema method. Instead, you should use normal cast and select methods to convert to different types and select columns in your dataframe. Usually when people want to use this `schema` method, the intent is actually to configure a projection, but using Spark's dataframe methods for that is the right way to go so that you get the benefit of the planner handling it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548125375/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548129502","html_url":"https://github.com/apache/iceberg/pull/514#issuecomment-548129502","issue_url":"https://api.github.com/repos/apache/iceberg/issues/514","id":548129502,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODEyOTUwMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T21:55:30Z","updated_at":"2019-10-30T21:55:30Z","author_association":"CONTRIBUTOR","body":"@andrei-ionescu, can you update the PR description with information about how your proposed solution works and what configuration it exposes?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548129502/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548137078","html_url":"https://github.com/apache/iceberg/pull/569#issuecomment-548137078","issue_url":"https://api.github.com/repos/apache/iceberg/issues/569","id":548137078,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODEzNzA3OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T22:19:54Z","updated_at":"2019-10-30T22:19:54Z","author_association":"CONTRIBUTOR","body":"This looks good to me. Is the remaining concern that it uses Iceberg's SerializableConfiguration that isn't correctly handled by Kryo?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548137078/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548141796","html_url":"https://github.com/apache/iceberg/pull/357#issuecomment-548141796","issue_url":"https://api.github.com/repos/apache/iceberg/issues/357","id":548141796,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODE0MTc5Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T22:36:42Z","updated_at":"2019-10-30T22:36:50Z","author_association":"CONTRIBUTOR","body":"@jun-he, can you rebase this? I'd like to get it in so we can start working on the other pushdown implementations. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548141796/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548142300","html_url":"https://github.com/apache/iceberg/pull/569#issuecomment-548142300","issue_url":"https://api.github.com/repos/apache/iceberg/issues/569","id":548142300,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODE0MjMwMA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T22:38:31Z","updated_at":"2019-10-30T22:38:31Z","author_association":"CONTRIBUTOR","body":"Yes, I've decided to wait until we arrive to a solution in #549 and then update this PR accordingly. I'd want to avoid hijacking depending on `FileIO` implementation, but don't see an easy way without a custom registrator.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548142300/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548144019","html_url":"https://github.com/apache/iceberg/issues/592#issuecomment-548144019","issue_url":"https://api.github.com/repos/apache/iceberg/issues/592","id":548144019,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODE0NDAxOQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T22:44:52Z","updated_at":"2019-10-30T22:44:52Z","author_association":"CONTRIBUTOR","body":"I hope we won't be using any internal Spark classes to import existing tables at some point. However, that will mean implementing more logic in Iceberg. Also, there are a lot of users who don't use HMS to track partitions. We will also need to cover that use case as well, I believe.\r\n\r\nMy suggestion is to update `SparkTableUtil` as an intermediate step and create issues to move from internal Spark classes in the future.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548144019/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548144426","html_url":"https://github.com/apache/iceberg/issues/592#issuecomment-548144426","issue_url":"https://api.github.com/repos/apache/iceberg/issues/592","id":548144426,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODE0NDQyNg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T22:46:10Z","updated_at":"2019-10-30T22:46:10Z","author_association":"CONTRIBUTOR","body":"That sounds good to me. I just though it might be a good time to take a look if you're changing that area. Thanks for looking into it!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548144426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548158336","html_url":"https://github.com/apache/iceberg/pull/590#issuecomment-548158336","issue_url":"https://api.github.com/repos/apache/iceberg/issues/590","id":548158336,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODE1ODMzNg==","user":{"login":"xabriel","id":218555,"node_id":"MDQ6VXNlcjIxODU1NQ==","avatar_url":"https://avatars.githubusercontent.com/u/218555?v=4","gravatar_id":"","url":"https://api.github.com/users/xabriel","html_url":"https://github.com/xabriel","followers_url":"https://api.github.com/users/xabriel/followers","following_url":"https://api.github.com/users/xabriel/following{/other_user}","gists_url":"https://api.github.com/users/xabriel/gists{/gist_id}","starred_url":"https://api.github.com/users/xabriel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xabriel/subscriptions","organizations_url":"https://api.github.com/users/xabriel/orgs","repos_url":"https://api.github.com/users/xabriel/repos","events_url":"https://api.github.com/users/xabriel/events{/privacy}","received_events_url":"https://api.github.com/users/xabriel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-30T23:44:54Z","updated_at":"2019-10-30T23:46:12Z","author_association":"CONTRIBUTOR","body":"You are correct that the use case we have is for projection. In practice, what we've found is that for nested data, coming up with a `schema` is significantly easier than using `select`.\r\n\r\nHere is an example:\r\n\r\niceberg schema: ```{ \"location\": {\"lat\": ..., \"lon\": ..., \"foo\": ...}, \"id\" }```\r\n\r\nI want to read location.lat and location.lon.\r\n\r\nHow can I express this with `schema` method?\r\nPass this schema down: ```{ \"location\": {\"lat\": ..., \"lon\": ...} }```\r\n\r\nHow can I express this with `select` on DataFrame?\r\nPerhaps `df.selectExpr(\"struct(location.lat, location.lon) as location\")` ?\r\n\r\nI speculate that that phrasing will also have a performance hit since I'm creating a new `struct`.\r\n\r\nWhat if we had two levels of nesting? It quickly gets complex. So our users prefer to use `schema`, which is, in practice, more natural for nested data.\r\n\r\nAs a side note, `spark.read.schema(...).parquet(...)` is supported in Spark.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548158336/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548211096","html_url":"https://github.com/apache/iceberg/pull/357#issuecomment-548211096","issue_url":"https://api.github.com/repos/apache/iceberg/issues/357","id":548211096,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODIxMTA5Ng==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-31T04:21:26Z","updated_at":"2019-10-31T04:21:26Z","author_association":"COLLABORATOR","body":"@rdblue Rebased it and fixed few minor issues. I created a new PR (https://github.com/apache/incubator-iceberg/pull/594). Thanks!\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548211096/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548211122","html_url":"https://github.com/apache/iceberg/pull/594#issuecomment-548211122","issue_url":"https://api.github.com/repos/apache/iceberg/issues/594","id":548211122,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODIxMTEyMg==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-31T04:21:37Z","updated_at":"2019-10-31T04:21:37Z","author_association":"COLLABORATOR","body":"@rdblue Here is the new PR for #39 . \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548211122/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548311196","html_url":"https://github.com/apache/iceberg/pull/585#issuecomment-548311196","issue_url":"https://api.github.com/repos/apache/iceberg/issues/585","id":548311196,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODMxMTE5Ng==","user":{"login":"andrei-ionescu","id":3389505,"node_id":"MDQ6VXNlcjMzODk1MDU=","avatar_url":"https://avatars.githubusercontent.com/u/3389505?v=4","gravatar_id":"","url":"https://api.github.com/users/andrei-ionescu","html_url":"https://github.com/andrei-ionescu","followers_url":"https://api.github.com/users/andrei-ionescu/followers","following_url":"https://api.github.com/users/andrei-ionescu/following{/other_user}","gists_url":"https://api.github.com/users/andrei-ionescu/gists{/gist_id}","starred_url":"https://api.github.com/users/andrei-ionescu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrei-ionescu/subscriptions","organizations_url":"https://api.github.com/users/andrei-ionescu/orgs","repos_url":"https://api.github.com/users/andrei-ionescu/repos","events_url":"https://api.github.com/users/andrei-ionescu/events{/privacy}","received_events_url":"https://api.github.com/users/andrei-ionescu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-31T10:45:25Z","updated_at":"2019-10-31T10:56:56Z","author_association":"CONTRIBUTOR","body":"@rdblue If you look at this line (https://github.com/apache/incubator-iceberg/pull/585/files#diff-e6baf84fa0dea08f3457433c123f784fR393) in the test  added you'll see that the partition is not flattened as you expected.\r\n\r\nGiven your example the output would be: `{\"id\": 1, \"info\": {\"type\": \"x\"} }`. The test checks exactly this - it make sure that we keep the nesting as it is.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548311196/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548316088","html_url":"https://github.com/apache/iceberg/pull/514#issuecomment-548316088","issue_url":"https://api.github.com/repos/apache/iceberg/issues/514","id":548316088,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODMxNjA4OA==","user":{"login":"andrei-ionescu","id":3389505,"node_id":"MDQ6VXNlcjMzODk1MDU=","avatar_url":"https://avatars.githubusercontent.com/u/3389505?v=4","gravatar_id":"","url":"https://api.github.com/users/andrei-ionescu","html_url":"https://github.com/andrei-ionescu","followers_url":"https://api.github.com/users/andrei-ionescu/followers","following_url":"https://api.github.com/users/andrei-ionescu/following{/other_user}","gists_url":"https://api.github.com/users/andrei-ionescu/gists{/gist_id}","starred_url":"https://api.github.com/users/andrei-ionescu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrei-ionescu/subscriptions","organizations_url":"https://api.github.com/users/andrei-ionescu/orgs","repos_url":"https://api.github.com/users/andrei-ionescu/repos","events_url":"https://api.github.com/users/andrei-ionescu/events{/privacy}","received_events_url":"https://api.github.com/users/andrei-ionescu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-31T10:59:12Z","updated_at":"2019-10-31T10:59:12Z","author_association":"CONTRIBUTOR","body":"@rdblue Addressed the comments... when you have some time please have another look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548316088/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548418104","html_url":"https://github.com/apache/iceberg/issues/597#issuecomment-548418104","issue_url":"https://api.github.com/repos/apache/iceberg/issues/597","id":548418104,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODQxODEwNA==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-31T15:01:21Z","updated_at":"2019-10-31T15:01:21Z","author_association":"COLLABORATOR","body":"Sounds good. \r\n\r\nNow it is easy to remove all staged manifests since `appendManifest` rewrite staged manifests. Do want need to remove them when `appendManifest` just update the snapshotId?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548418104/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548420825","html_url":"https://github.com/apache/iceberg/issues/597#issuecomment-548420825","issue_url":"https://api.github.com/repos/apache/iceberg/issues/597","id":548420825,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODQyMDgyNQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-31T15:07:13Z","updated_at":"2019-10-31T15:07:13Z","author_association":"CONTRIBUTOR","body":"I have a prototype for #592 where I have the following snippet:\r\n\r\n```\r\n    try {\r\n      val append = targetTable.newAppend()\r\n      manifests.foreach(manifest => append.appendManifest(manifest.toManifestFile))\r\n      append.commit()\r\n    } finally {\r\n      val io = new HadoopFileIO(conf)\r\n      manifests.foreach { manifest =>\r\n        Try(io.deleteFile(manifest.location))\r\n      }\r\n    }\r\n```\r\n\r\nLet me submit that for review.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548420825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548426389","html_url":"https://github.com/apache/iceberg/issues/597#issuecomment-548426389","issue_url":"https://api.github.com/repos/apache/iceberg/issues/597","id":548426389,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODQyNjM4OQ==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-31T15:18:58Z","updated_at":"2019-10-31T15:18:58Z","author_association":"COLLABORATOR","body":"Great, thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548426389/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548497847","html_url":"https://github.com/apache/iceberg/issues/598#issuecomment-548497847","issue_url":"https://api.github.com/repos/apache/iceberg/issues/598","id":548497847,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODQ5Nzg0Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-31T18:00:26Z","updated_at":"2019-10-31T18:00:26Z","author_association":"CONTRIBUTOR","body":"Right now, we use a column key to do this to avoid traversing the schema. The field name array should be converted to dot notation: `[\"a\", \"b.c\"]` gets converted to `\"a.b.c\"` and that key is looked up in the field index.\r\n\r\nI don't think we need to add an array version. There isn't much value and that makes the API more confusing. For example, users may think it is better to use the array version and attempt to parse identifiers, when there is no need to do it. The point of this simplification is to avoid needing to parse identifiers.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548497847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548521505","html_url":"https://github.com/apache/iceberg/pull/357#issuecomment-548521505","issue_url":"https://api.github.com/repos/apache/iceberg/issues/357","id":548521505,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODUyMTUwNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-31T18:58:12Z","updated_at":"2019-10-31T18:58:12Z","author_association":"CONTRIBUTOR","body":"Thanks @jun-he! I'll close this one.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548521505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548544066","html_url":"https://github.com/apache/iceberg/issues/39#issuecomment-548544066","issue_url":"https://api.github.com/repos/apache/iceberg/issues/39","id":548544066,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODU0NDA2Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-31T19:58:25Z","updated_at":"2019-10-31T19:58:25Z","author_association":"CONTRIBUTOR","body":"Merged #594. Thanks @jun-he!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548544066/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548549559","html_url":"https://github.com/apache/iceberg/pull/590#issuecomment-548549559","issue_url":"https://api.github.com/repos/apache/iceberg/issues/590","id":548549559,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODU0OTU1OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-31T20:13:21Z","updated_at":"2019-10-31T20:13:21Z","author_association":"CONTRIBUTOR","body":"What I meant is that the normal way to do this selection is implicit. For example, if you're looking for events in a bounding box you might have this:\r\n\r\n```scala\r\nval df = spark.table(\"objects\")\r\nval counts = df.filter($\"location.lat\" >= x1).filter($\"location.lat\" < x2)\r\n  .filter($\"location.lon\" >= y1).filter($\"location.lon\" < y2)\r\n  .groupBy($\"location.foo\")\r\n  .agg(countDistinct($\"id\"))\r\n```\r\n\r\nSpark should be responsible for only loading the necessary columns... though it doesn't correctly do that push-down right now (I think @aokolnychyi or @holdenk is working on submitting their fix). Is this intended as a work-around for Spark not supporting nested column pruning?\r\n\r\n> As a side note, spark.read.schema(...).parquet(...) is supported in Spark.\r\n\r\nThis is supported as a way to avoid inferring the schema, but there are limitations. For example, when you load tables from SQL or using `spark.table` there is no way to pass this in. That's why I'd like to make sure your use case works with an API intended for it. Maybe we should add `project(StructType)` to the Dataset API?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548549559/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548554504","html_url":"https://github.com/apache/iceberg/pull/593#issuecomment-548554504","issue_url":"https://api.github.com/repos/apache/iceberg/issues/593","id":548554504,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODU1NDUwNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-31T20:26:45Z","updated_at":"2019-10-31T20:26:45Z","author_association":"CONTRIBUTOR","body":"Looks good to me once style issues are fixed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548554504/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548609730","html_url":"https://github.com/apache/iceberg/issues/598#issuecomment-548609730","issue_url":"https://api.github.com/repos/apache/iceberg/issues/598","id":548609730,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODYwOTczMA==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-31T23:35:04Z","updated_at":"2019-10-31T23:35:04Z","author_association":"COLLABORATOR","body":"The concern is if we convert array to dot notation, different column keys may have the same result. For example: `[\"a\", \"b.c\"], [\"a\", \"b\", \"c\"]` as well as other variants. How can we distinguish them?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548609730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548614238","html_url":"https://github.com/apache/iceberg/issues/598#issuecomment-548614238","issue_url":"https://api.github.com/repos/apache/iceberg/issues/598","id":548614238,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODYxNDIzOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-31T23:54:32Z","updated_at":"2019-10-31T23:54:32Z","author_association":"CONTRIBUTOR","body":"Iceberg doesn't allow conflicting names that have the same dot notation. You can have `[\"a\", \"b.c\"]` or `[\"a\", \"b\", \"c\"]`, but not both. I think this is a reasonable restriction because people never create schemas that are so hard for humans to understand because \"a.b.c\" could mean two different fields.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548614238/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548656440","html_url":"https://github.com/apache/iceberg/issues/598#issuecomment-548656440","issue_url":"https://api.github.com/repos/apache/iceberg/issues/598","id":548656440,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODY1NjQ0MA==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-01T03:50:58Z","updated_at":"2019-11-01T03:50:58Z","author_association":"COLLABORATOR","body":"It makes sense if Iceberg has the restriction. I checked that when adding a column, the restriction works. While I can still define a SCHEMA like below and use it to create a table:\r\n```java \r\n  Schema SIMPLE_SCHEMA = new Schema(\r\n      required(1, \"id\", Types.IntegerType.get()),\r\n      optional(2, \"data\", Types.StringType.get()),\r\n      required(3, \"a\", Types.StructType.of(\r\n          required(4, \"b\", Types.StructType.of(\r\n              required(5, \"c\", Types.BooleanType.get())\r\n          )),\r\n          required(6, \"b.c\", Types.BooleanType.get())\r\n      ), \"struct of named boolean options\")\r\n  );\r\n```\r\nDo we need a validator for schema? Though I think no one would intend to define schema like this. Or I may miss some checks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548656440/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548849910","html_url":"https://github.com/apache/iceberg/issues/598#issuecomment-548849910","issue_url":"https://api.github.com/repos/apache/iceberg/issues/598","id":548849910,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODg0OTkxMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-01T16:18:50Z","updated_at":"2019-11-01T16:18:50Z","author_association":"CONTRIBUTOR","body":"It's always a good idea to improve error messages. If you can create a schema like this and don't get an error or get a strange error message, we should fix it and throw an exception while creating the instance.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548849910/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548855944","html_url":"https://github.com/apache/iceberg/pull/599#issuecomment-548855944","issue_url":"https://api.github.com/repos/apache/iceberg/issues/599","id":548855944,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODg1NTk0NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-01T16:34:33Z","updated_at":"2019-11-01T16:34:33Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @aokolnychyi!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548855944/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548897878","html_url":"https://github.com/apache/iceberg/pull/577#issuecomment-548897878","issue_url":"https://api.github.com/repos/apache/iceberg/issues/577","id":548897878,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODg5Nzg3OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-01T18:22:23Z","updated_at":"2019-11-01T18:22:23Z","author_association":"CONTRIBUTOR","body":"Here's a branch that moves the Java 8 check and only enforces it for a release build: https://github.com/rdblue/iceberg/commit/146c22a74ef35aca53843cb2480b36b5dc49c69c\r\n\r\nThat allowed me to run with Java 11, but there are test failures to look into.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548897878/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548947670","html_url":"https://github.com/apache/iceberg/pull/601#issuecomment-548947670","issue_url":"https://api.github.com/repos/apache/iceberg/issues/601","id":548947670,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODk0NzY3MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-01T20:55:47Z","updated_at":"2019-11-01T20:55:47Z","author_association":"CONTRIBUTOR","body":"@rdsr, please have another look. I added tests to iceberg-data and ended up needing to fix a couple of things:\r\n\r\n* `BuildAvroProjection` couldn't project fields with special characters in the name because Avro would reject the projection schema. I added a couple calls to `makeCompatibleName` to fix this. It should be safe because special characters would cause failures in these cases before.\r\n* The generic `DataReader` created iceberg-data records with a schema converted from Avro. When using sanitized names, the records would not use the right field names for `getField`. The fix was to pass in the original Iceberg schema. To make this easy, I added a new visitor.\r\n\r\nI think the second fix also addresses the case introduced by #207 when the Avro names don't match because the shouldn't be projected. Next, we should be able to fix Avro reads by using a similar pattern to iceberg-data, but one that produces Avro generics.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548947670/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548956148","html_url":"https://github.com/apache/iceberg/pull/590#issuecomment-548956148","issue_url":"https://api.github.com/repos/apache/iceberg/issues/590","id":548956148,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODk1NjE0OA==","user":{"login":"xabriel","id":218555,"node_id":"MDQ6VXNlcjIxODU1NQ==","avatar_url":"https://avatars.githubusercontent.com/u/218555?v=4","gravatar_id":"","url":"https://api.github.com/users/xabriel","html_url":"https://github.com/xabriel","followers_url":"https://api.github.com/users/xabriel/followers","following_url":"https://api.github.com/users/xabriel/following{/other_user}","gists_url":"https://api.github.com/users/xabriel/gists{/gist_id}","starred_url":"https://api.github.com/users/xabriel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xabriel/subscriptions","organizations_url":"https://api.github.com/users/xabriel/orgs","repos_url":"https://api.github.com/users/xabriel/repos","events_url":"https://api.github.com/users/xabriel/events{/privacy}","received_events_url":"https://api.github.com/users/xabriel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-01T21:24:53Z","updated_at":"2019-11-01T21:24:53Z","author_association":"CONTRIBUTOR","body":"> Is this intended as a work-around for Spark not supporting nested column pruning?\r\n\r\n@aokolnychyi graciously shared their code for nested column pruning with us, so in our environment nested column pruning works as expected.\r\n\r\nBut the case I'm trying to solve for in this PR is projection of partial nested columns, which would still need me to somehow specify the set of nested columns that I want.\r\n\r\n> For example, when you load tables from SQL or using spark.table there is no way to pass this in. \r\n\r\nAgreed, although you could do a preliminary projection before moving to SparkSQL:\r\n```\r\nval df = spark.read\r\n  .schema(preliminaryProjectionOnNestedColumns)\r\n  .format(\"iceberg\")\r\n  .load(...)\r\n\r\ndf.createOrReplaceTempView(\"dfView\")\r\nspark.sql(\"SELECT ...\")\r\n```\r\n\r\nOur need for projecting with a schema is given by the fact that our data sets are highly nested, and those nested levels can also be quite wide. And so when `location.*` includes, say, 100 fields, and we only want to project 2 of them while still having the original hierarchy, we want to have a mechanism to not pay the I/O cost of loading all 100 fields.\r\n\r\n`df.select(\"location.lat\", \"location.lon)` doesn't work since that changes the shape of the data.\r\n`df.selectExpr(\"struct(location.lat, location.lon) as location\")` doesn't work either as per discussion on previous comment.\r\n\r\nAnd so that leaves us with `schema`.\r\n\r\n> Maybe we should add project(StructType) to the Dataset API?\r\n\r\nThat would work, and to your point, it would be the ideal solution as it would be purpose built. But we'd have to wait for Spark 3.x.  :)\r\n\r\nI do understand that allowing this PR now means we will have to support it indefinitely, but I still feel it is a use case that, today, can only be achieved by the `schema` API.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/548956148/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/549003142","html_url":"https://github.com/apache/iceberg/pull/601#issuecomment-549003142","issue_url":"https://api.github.com/repos/apache/iceberg/issues/601","id":549003142,"node_id":"MDEyOklzc3VlQ29tbWVudDU0OTAwMzE0Mg==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-02T02:42:53Z","updated_at":"2019-11-02T02:42:53Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue . I'll have a look over the weekend","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/549003142/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/549030650","html_url":"https://github.com/apache/iceberg/pull/514#issuecomment-549030650","issue_url":"https://api.github.com/repos/apache/iceberg/issues/514","id":549030650,"node_id":"MDEyOklzc3VlQ29tbWVudDU0OTAzMDY1MA==","user":{"login":"andrei-ionescu","id":3389505,"node_id":"MDQ6VXNlcjMzODk1MDU=","avatar_url":"https://avatars.githubusercontent.com/u/3389505?v=4","gravatar_id":"","url":"https://api.github.com/users/andrei-ionescu","html_url":"https://github.com/andrei-ionescu","followers_url":"https://api.github.com/users/andrei-ionescu/followers","following_url":"https://api.github.com/users/andrei-ionescu/following{/other_user}","gists_url":"https://api.github.com/users/andrei-ionescu/gists{/gist_id}","starred_url":"https://api.github.com/users/andrei-ionescu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrei-ionescu/subscriptions","organizations_url":"https://api.github.com/users/andrei-ionescu/orgs","repos_url":"https://api.github.com/users/andrei-ionescu/repos","events_url":"https://api.github.com/users/andrei-ionescu/events{/privacy}","received_events_url":"https://api.github.com/users/andrei-ionescu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-02T10:25:46Z","updated_at":"2019-11-02T10:25:46Z","author_association":"CONTRIBUTOR","body":"@rdblue I addressed the comments, when you have some time please have another look. Thank you.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/549030650/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/549127157","html_url":"https://github.com/apache/iceberg/pull/602#issuecomment-549127157","issue_url":"https://api.github.com/repos/apache/iceberg/issues/602","id":549127157,"node_id":"MDEyOklzc3VlQ29tbWVudDU0OTEyNzE1Nw==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-03T11:26:31Z","updated_at":"2019-11-03T11:26:31Z","author_association":"CONTRIBUTOR","body":"For local testing I was thinking of building a Docker container which spins up a Hive metastore. This will also enable you to actually create tables locally. We could use the same docker container for running the hive tests, so we don't have to run an in-process hive metastore and this would solve the problem as well. WDYT @rdblue ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/549127157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/549167796","html_url":"https://github.com/apache/iceberg/pull/577#issuecomment-549167796","issue_url":"https://api.github.com/repos/apache/iceberg/issues/577","id":549167796,"node_id":"MDEyOklzc3VlQ29tbWVudDU0OTE2Nzc5Ng==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-03T19:02:02Z","updated_at":"2019-11-03T21:50:45Z","author_association":"CONTRIBUTOR","body":"Looks like there are issues with older versions of Datanucleaus (3.x branch) which ships with Hive test artifacts:\r\n```\r\njava.lang.RuntimeException: Cannot start TestHiveMetastore\r\n\tat org.apache.iceberg.hive.TestHiveMetastore.start(TestHiveMetastore.java:69)\r\n\tat org.apache.iceberg.hive.HiveMetastoreTest.startMetastore(HiveMetastoreTest.java:41)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n\tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)\r\n\tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n\tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)\r\n\tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)\r\n\tat org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n\tat org.junit.runners.ParentRunner.run(ParentRunner.java:363)\r\n\tat org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.runTestClass(JUnitTestClassExecutor.java:110)\r\n\tat org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:58)\r\n\tat org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecutor.execute(JUnitTestClassExecutor.java:38)\r\n\tat org.gradle.api.internal.tasks.testing.junit.AbstractJUnitTestClassProcessor.processTestClass(AbstractJUnitTestClassProcessor.java:62)\r\n\tat org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n\tat org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)\r\n\tat org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n\tat org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)\r\n\tat org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)\r\n\tat com.sun.proxy.$Proxy2.processTestClass(Unknown Source)\r\n\tat org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:118)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n\tat org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)\r\n\tat org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n\tat org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:175)\r\n\tat org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:157)\r\n\tat org.gradle.internal.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:404)\r\n\tat org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:63)\r\n\tat org.gradle.internal.concurrent.ManagedExecutorImpl$1.run(ManagedExecutorImpl.java:46)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\r\n\tat org.gradle.internal.concurrent.ThreadFactoryImpl$ManagedThreadRunnable.run(ThreadFactoryImpl.java:55)\r\n\tat java.base/java.lang.Thread.run(Thread.java:834)\r\nCaused by: javax.jdo.JDOFatalInternalException: The java type java.lang.Long (jdbc-type=\"\", sql-type=\"\") cant be mapped for this datastore. No mapping is available.\r\nNestedThrowables:\r\norg.datanucleus.exceptions.NucleusException: The java type java.lang.Long (jdbc-type=\"\", sql-type=\"\") cant be mapped for this datastore. No mapping is available.\r\n\tat org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:591)\r\n\tat org.datanucleus.api.jdo.JDOPersistenceManager.jdoMakePersistent(JDOPersistenceManager.java:732)\r\n\tat org.datanucleus.api.jdo.JDOPersistenceManager.makePersistent(JDOPersistenceManager.java:752)\r\n\tat org.apache.hadoop.hive.metastore.ObjectStore.setMetaStoreSchemaVersion(ObjectStore.java:6773)\r\n\tat org.apache.hadoop.hive.metastore.ObjectStore.checkSchema(ObjectStore.java:6670)\r\n\tat org.apache.hadoop.hive.metastore.ObjectStore.verifySchema(ObjectStore.java:6645)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n\tat org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:114)\r\n\tat com.sun.proxy.$Proxy16.verifySchema(Unknown Source)\r\n\tat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:572)\r\n\tat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:624)\r\n\tat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:461)\r\n\tat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.<init>(HiveMetaStore.java:419)\r\n\tat org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.<init>(HiveMetaStore.java:412)\r\n\tat org.apache.iceberg.hive.TestHiveMetastore.newThriftServer(TestHiveMetastore.java:97)\r\n\tat org.apache.iceberg.hive.TestHiveMetastore.start(TestHiveMetastore.java:65)\r\n\t... 41 more\r\nCaused by: org.datanucleus.exceptions.NucleusException: The java type java.lang.Long (jdbc-type=\"\", sql-type=\"\") cant be mapped for this datastore. No mapping is available.\r\n\tat org.datanucleus.store.rdbms.mapping.RDBMSMappingManager.getDatastoreMappingClass(RDBMSMappingManager.java:1215)\r\n\tat org.datanucleus.store.rdbms.mapping.RDBMSMappingManager.createDatastoreMapping(RDBMSMappingManager.java:1378)\r\n\tat org.datanucleus.store.rdbms.table.AbstractClassTable.addDatastoreId(AbstractClassTable.java:392)\r\n\tat org.datanucleus.store.rdbms.table.ClassTable.initializePK(ClassTable.java:1087)\r\n\tat org.datanucleus.store.rdbms.table.ClassTable.preInitialize(ClassTable.java:247)\r\n\tat org.datanucleus.store.rdbms.RDBMSStoreManager$ClassAdder.addClassTable(RDBMSStoreManager.java:3118)\r\n\tat org.datanucleus.store.rdbms.RDBMSStoreManager$ClassAdder.addClassTables(RDBMSStoreManager.java:2909)\r\n\tat org.datanucleus.store.rdbms.RDBMSStoreManager$ClassAdder.addClassTablesAndValidate(RDBMSStoreManager.java:3182)\r\n\tat org.datanucleus.store.rdbms.RDBMSStoreManager$ClassAdder.run(RDBMSStoreManager.java:2841)\r\n\tat org.datanucleus.store.rdbms.AbstractSchemaTransaction.execute(AbstractSchemaTransaction.java:122)\r\n\tat org.datanucleus.store.rdbms.RDBMSStoreManager.addClasses(RDBMSStoreManager.java:1605)\r\n\tat org.datanucleus.store.AbstractStoreManager.addClass(AbstractStoreManager.java:954)\r\n\tat org.datanucleus.store.rdbms.RDBMSStoreManager.getDatastoreClass(RDBMSStoreManager.java:679)\r\n\tat org.datanucleus.store.rdbms.RDBMSStoreManager.getPropertiesForGenerator(RDBMSStoreManager.java:2045)\r\n\tat org.datanucleus.store.AbstractStoreManager.getStrategyValue(AbstractStoreManager.java:1365)\r\n\tat org.datanucleus.ExecutionContextImpl.newObjectId(ExecutionContextImpl.java:3827)\r\n\tat org.datanucleus.state.JDOStateManager.setIdentity(JDOStateManager.java:2571)\r\n\tat org.datanucleus.state.JDOStateManager.initialiseForPersistentNew(JDOStateManager.java:513)\r\n\tat org.datanucleus.state.ObjectProviderFactoryImpl.newForPersistentNew(ObjectProviderFactoryImpl.java:232)\r\n\tat org.datanucleus.ExecutionContextImpl.newObjectProviderForPersistentNew(ExecutionContextImpl.java:1414)\r\n\tat org.datanucleus.ExecutionContextImpl.persistObjectInternal(ExecutionContextImpl.java:2218)\r\n\tat org.datanucleus.ExecutionContextImpl.persistObjectWork(ExecutionContextImpl.java:2065)\r\n\tat org.datanucleus.ExecutionContextImpl.persistObject(ExecutionContextImpl.java:1913)\r\n\tat org.datanucleus.ExecutionContextThreadedImpl.persistObject(ExecutionContextThreadedImpl.java:217)\r\n\tat org.datanucleus.api.jdo.JDOPersistenceManager.jdoMakePersistent(JDOPersistenceManager.java:727)\r\n\t... 58 more\r\n```\r\n\r\nWe're using them in our testdependencies. https://github.com/apache/incubator-iceberg/blob/master/versions.props#L19-L20\r\nIt looks like for Spark, they've disabled the tests:\r\nhttps://github.com/cenyuhai/spark/commit/58cc0df59e3dd8b8fc46706050ac4ca437a3f18f\r\n\r\nAlso Spark 2.x Hive is on Datanucleaus 3.x: https://mvnrepository.com/artifact/org.apache.spark/spark-hive_2.12/2.4.4\r\n\r\nWe could run an external hive metastore instead of an embedded one? I have PoC here: https://github.com/godatadriven-dockerhub/hive-metastore#run-it-local-using-iceberg-incubating\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/549167796/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/549182671","html_url":"https://github.com/apache/iceberg/pull/602#issuecomment-549182671","issue_url":"https://api.github.com/repos/apache/iceberg/issues/602","id":549182671,"node_id":"MDEyOklzc3VlQ29tbWVudDU0OTE4MjY3MQ==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-03T21:51:18Z","updated_at":"2019-11-03T21:51:18Z","author_association":"CONTRIBUTOR","body":"Closed this one in favor of #577 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/549182671/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/549256692","html_url":"https://github.com/apache/iceberg/issues/603#issuecomment-549256692","issue_url":"https://api.github.com/repos/apache/iceberg/issues/603","id":549256692,"node_id":"MDEyOklzc3VlQ29tbWVudDU0OTI1NjY5Mg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-04T08:20:42Z","updated_at":"2019-11-04T08:20:42Z","author_association":"CONTRIBUTOR","body":"Sounds good to me, @shardulm94! I remember I had this issue at some point as well. Would you like to submit a PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/549256692/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/549315608","html_url":"https://github.com/apache/iceberg/issues/607#issuecomment-549315608","issue_url":"https://api.github.com/repos/apache/iceberg/issues/607","id":549315608,"node_id":"MDEyOklzc3VlQ29tbWVudDU0OTMxNTYwOA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-04T11:34:13Z","updated_at":"2019-11-04T11:34:13Z","author_association":"CONTRIBUTOR","body":"I'll fix together with #597.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/549315608/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/549671367","html_url":"https://github.com/apache/iceberg/issues/605#issuecomment-549671367","issue_url":"https://api.github.com/repos/apache/iceberg/issues/605","id":549671367,"node_id":"MDEyOklzc3VlQ29tbWVudDU0OTY3MTM2Nw==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-05T05:43:07Z","updated_at":"2019-11-05T05:43:07Z","author_association":"CONTRIBUTOR","body":"I have a fix for this. Will post it by tomorrow","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/549671367/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/549849361","html_url":"https://github.com/apache/iceberg/pull/569#issuecomment-549849361","issue_url":"https://api.github.com/repos/apache/iceberg/issues/569","id":549849361,"node_id":"MDEyOklzc3VlQ29tbWVudDU0OTg0OTM2MQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-05T14:35:04Z","updated_at":"2019-11-05T14:35:04Z","author_association":"CONTRIBUTOR","body":"@rdblue, it just occurred to me that `SerializableConfiguration` in Spark is not public and we cannot really use it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/549849361/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/549967793","html_url":"https://github.com/apache/iceberg/issues/617#issuecomment-549967793","issue_url":"https://api.github.com/repos/apache/iceberg/issues/617","id":549967793,"node_id":"MDEyOklzc3VlQ29tbWVudDU0OTk2Nzc5Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-05T18:56:40Z","updated_at":"2019-11-05T18:56:40Z","author_association":"CONTRIBUTOR","body":"I know @raptond has done some thinking. Could you share your thoughts?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/549967793/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550007700","html_url":"https://github.com/apache/iceberg/pull/590#issuecomment-550007700","issue_url":"https://api.github.com/repos/apache/iceberg/issues/590","id":550007700,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MDAwNzcwMA==","user":{"login":"xabriel","id":218555,"node_id":"MDQ6VXNlcjIxODU1NQ==","avatar_url":"https://avatars.githubusercontent.com/u/218555?v=4","gravatar_id":"","url":"https://api.github.com/users/xabriel","html_url":"https://github.com/xabriel","followers_url":"https://api.github.com/users/xabriel/followers","following_url":"https://api.github.com/users/xabriel/following{/other_user}","gists_url":"https://api.github.com/users/xabriel/gists{/gist_id}","starred_url":"https://api.github.com/users/xabriel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xabriel/subscriptions","organizations_url":"https://api.github.com/users/xabriel/orgs","repos_url":"https://api.github.com/users/xabriel/repos","events_url":"https://api.github.com/users/xabriel/events{/privacy}","received_events_url":"https://api.github.com/users/xabriel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-05T20:33:49Z","updated_at":"2019-11-05T20:33:49Z","author_association":"CONTRIBUTOR","body":"@rdblue Kindly let me know your final thoughts on whether this PR is viable?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550007700/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550147247","html_url":"https://github.com/apache/iceberg/pull/608#issuecomment-550147247","issue_url":"https://api.github.com/repos/apache/iceberg/issues/608","id":550147247,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MDE0NzI0Nw==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-06T05:12:03Z","updated_at":"2019-11-06T05:12:03Z","author_association":"COLLABORATOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550147247/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550151161","html_url":"https://github.com/apache/iceberg/pull/609#issuecomment-550151161","issue_url":"https://api.github.com/repos/apache/iceberg/issues/609","id":550151161,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MDE1MTE2MQ==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-06T05:30:30Z","updated_at":"2019-11-06T05:30:30Z","author_association":"COLLABORATOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550151161/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550152714","html_url":"https://github.com/apache/iceberg/pull/610#issuecomment-550152714","issue_url":"https://api.github.com/repos/apache/iceberg/issues/610","id":550152714,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MDE1MjcxNA==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-06T05:37:27Z","updated_at":"2019-11-06T05:37:27Z","author_association":"COLLABORATOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550152714/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550211533","html_url":"https://github.com/apache/iceberg/pull/514#issuecomment-550211533","issue_url":"https://api.github.com/repos/apache/iceberg/issues/514","id":550211533,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MDIxMTUzMw==","user":{"login":"andrei-ionescu","id":3389505,"node_id":"MDQ6VXNlcjMzODk1MDU=","avatar_url":"https://avatars.githubusercontent.com/u/3389505?v=4","gravatar_id":"","url":"https://api.github.com/users/andrei-ionescu","html_url":"https://github.com/andrei-ionescu","followers_url":"https://api.github.com/users/andrei-ionescu/followers","following_url":"https://api.github.com/users/andrei-ionescu/following{/other_user}","gists_url":"https://api.github.com/users/andrei-ionescu/gists{/gist_id}","starred_url":"https://api.github.com/users/andrei-ionescu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrei-ionescu/subscriptions","organizations_url":"https://api.github.com/users/andrei-ionescu/orgs","repos_url":"https://api.github.com/users/andrei-ionescu/repos","events_url":"https://api.github.com/users/andrei-ionescu/events{/privacy}","received_events_url":"https://api.github.com/users/andrei-ionescu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-06T08:57:38Z","updated_at":"2019-11-06T08:57:38Z","author_association":"CONTRIBUTOR","body":"@rdblue Could you have a look into this PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550211533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550220449","html_url":"https://github.com/apache/iceberg/pull/608#issuecomment-550220449","issue_url":"https://api.github.com/repos/apache/iceberg/issues/608","id":550220449,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MDIyMDQ0OQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-06T09:19:59Z","updated_at":"2019-11-06T09:19:59Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550220449/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550221120","html_url":"https://github.com/apache/iceberg/pull/606#issuecomment-550221120","issue_url":"https://api.github.com/repos/apache/iceberg/issues/606","id":550221120,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MDIyMTEyMA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-06T09:21:35Z","updated_at":"2019-11-06T09:21:35Z","author_association":"CONTRIBUTOR","body":"Tested this fix locally and it did solve the issue. Thanks, @shardulm94!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550221120/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550223612","html_url":"https://github.com/apache/iceberg/pull/608#issuecomment-550223612","issue_url":"https://api.github.com/repos/apache/iceberg/issues/608","id":550223612,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MDIyMzYxMg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-06T09:27:29Z","updated_at":"2019-11-06T09:27:29Z","author_association":"CONTRIBUTOR","body":"Thanks, @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550223612/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550437203","html_url":"https://github.com/apache/iceberg/pull/590#issuecomment-550437203","issue_url":"https://api.github.com/repos/apache/iceberg/issues/590","id":550437203,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MDQzNzIwMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-06T18:20:24Z","updated_at":"2019-11-06T18:20:24Z","author_association":"CONTRIBUTOR","body":"@xabriel, sorry for the delay, I was out for the last 4 days.\r\n\r\nI'm skeptical that it is important to keep the original shape of the data. One aspect of my example above was that the shape typically doesn't matter once you use those fields. But, since Spark is unable to really express what you want here, I think it is reasonable to go forward with this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550437203/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550442542","html_url":"https://github.com/apache/iceberg/pull/614#issuecomment-550442542","issue_url":"https://api.github.com/repos/apache/iceberg/issues/614","id":550442542,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MDQ0MjU0Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-06T18:34:26Z","updated_at":"2019-11-06T18:34:26Z","author_association":"CONTRIBUTOR","body":"Thanks, @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550442542/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550449462","html_url":"https://github.com/apache/iceberg/pull/544#issuecomment-550449462","issue_url":"https://api.github.com/repos/apache/iceberg/issues/544","id":550449462,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MDQ0OTQ2Mg==","user":{"login":"TGooch44","id":1591711,"node_id":"MDQ6VXNlcjE1OTE3MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1591711?v=4","gravatar_id":"","url":"https://api.github.com/users/TGooch44","html_url":"https://github.com/TGooch44","followers_url":"https://api.github.com/users/TGooch44/followers","following_url":"https://api.github.com/users/TGooch44/following{/other_user}","gists_url":"https://api.github.com/users/TGooch44/gists{/gist_id}","starred_url":"https://api.github.com/users/TGooch44/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TGooch44/subscriptions","organizations_url":"https://api.github.com/users/TGooch44/orgs","repos_url":"https://api.github.com/users/TGooch44/repos","events_url":"https://api.github.com/users/TGooch44/events{/privacy}","received_events_url":"https://api.github.com/users/TGooch44/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-06T18:51:58Z","updated_at":"2019-11-06T18:51:58Z","author_association":"CONTRIBUTOR","body":"@xhochy I just opened: \r\nhttps://issues.apache.org/jira/browse/ARROW-7080\r\n\r\nCan you let me know if there is any workaround you know of for this? or if it's possible to get in a future pyarrow release?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550449462/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550455137","html_url":"https://github.com/apache/iceberg/pull/577#issuecomment-550455137","issue_url":"https://api.github.com/repos/apache/iceberg/issues/577","id":550455137,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MDQ1NTEzNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-06T19:05:55Z","updated_at":"2019-11-06T19:05:55Z","author_association":"CONTRIBUTOR","body":"@Fokko, that project to bring up a metastore in Docker is great! We should point people to it from the Iceberg docs for people to be able to test tables.\r\n\r\nI'm not sure that a docker container would work for tests, though. Requiring a docker install to run tests is difficult. Is it possible to update Datanucleus and still have the 1.2.1 HMS work?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550455137/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550471024","html_url":"https://github.com/apache/iceberg/pull/608#issuecomment-550471024","issue_url":"https://api.github.com/repos/apache/iceberg/issues/608","id":550471024,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MDQ3MTAyNA==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-06T19:46:20Z","updated_at":"2019-11-06T19:46:20Z","author_association":"CONTRIBUTOR","body":"Thank you!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550471024/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550517019","html_url":"https://github.com/apache/iceberg/pull/514#issuecomment-550517019","issue_url":"https://api.github.com/repos/apache/iceberg/issues/514","id":550517019,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MDUxNzAxOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-06T21:52:19Z","updated_at":"2019-11-06T21:52:19Z","author_association":"CONTRIBUTOR","body":"Will do. I was out for a couple days, which is why I haven't gotten to it yet.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550517019/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550972205","html_url":"https://github.com/apache/iceberg/issues/621#issuecomment-550972205","issue_url":"https://api.github.com/repos/apache/iceberg/issues/621","id":550972205,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MDk3MjIwNQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-07T08:17:09Z","updated_at":"2019-11-07T09:32:31Z","author_association":"CONTRIBUTOR","body":"@asheeshgarg, could you provide more details on how you created Iceberg tables and what your table configs are? A small snippet to reproduce the issue without business logic would be extremely helpful. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/550972205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/551341908","html_url":"https://github.com/apache/iceberg/issues/522#issuecomment-551341908","issue_url":"https://api.github.com/repos/apache/iceberg/issues/522","id":551341908,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MTM0MTkwOA==","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-08T01:24:10Z","updated_at":"2019-11-08T01:24:10Z","author_association":"CONTRIBUTOR","body":"@anjalinorwood i'm thinking of taking this up. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/551341908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/551355139","html_url":"https://github.com/apache/iceberg/issues/604#issuecomment-551355139","issue_url":"https://api.github.com/repos/apache/iceberg/issues/604","id":551355139,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MTM1NTEzOQ==","user":{"login":"shardulm94","id":6961317,"node_id":"MDQ6VXNlcjY5NjEzMTc=","avatar_url":"https://avatars.githubusercontent.com/u/6961317?v=4","gravatar_id":"","url":"https://api.github.com/users/shardulm94","html_url":"https://github.com/shardulm94","followers_url":"https://api.github.com/users/shardulm94/followers","following_url":"https://api.github.com/users/shardulm94/following{/other_user}","gists_url":"https://api.github.com/users/shardulm94/gists{/gist_id}","starred_url":"https://api.github.com/users/shardulm94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shardulm94/subscriptions","organizations_url":"https://api.github.com/users/shardulm94/orgs","repos_url":"https://api.github.com/users/shardulm94/repos","events_url":"https://api.github.com/users/shardulm94/events{/privacy}","received_events_url":"https://api.github.com/users/shardulm94/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-08T02:21:35Z","updated_at":"2019-11-08T02:21:35Z","author_association":"CONTRIBUTOR","body":"@rdblue Thoughts on this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/551355139/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/551778855","html_url":"https://github.com/apache/iceberg/pull/512#issuecomment-551778855","issue_url":"https://api.github.com/repos/apache/iceberg/issues/512","id":551778855,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MTc3ODg1NQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-08T13:18:23Z","updated_at":"2019-11-08T13:18:23Z","author_association":"CONTRIBUTOR","body":"@rdblue @bryanck Ready for another review round.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/551778855/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/551865311","html_url":"https://github.com/apache/iceberg/pull/529#issuecomment-551865311","issue_url":"https://api.github.com/repos/apache/iceberg/issues/529","id":551865311,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MTg2NTMxMQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-08T15:11:45Z","updated_at":"2019-11-08T15:11:45Z","author_association":"CONTRIBUTOR","body":"I am planning to take a look at this PR next week.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/551865311/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/551866309","html_url":"https://github.com/apache/iceberg/pull/588#issuecomment-551866309","issue_url":"https://api.github.com/repos/apache/iceberg/issues/588","id":551866309,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MTg2NjMwOQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-08T15:14:16Z","updated_at":"2019-11-08T15:14:16Z","author_association":"CONTRIBUTOR","body":"@chenjunjiedada, sorry for the delay. I hope to have more time next week.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/551866309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/551878659","html_url":"https://github.com/apache/iceberg/issues/522#issuecomment-551878659","issue_url":"https://api.github.com/repos/apache/iceberg/issues/522","id":551878659,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MTg3ODY1OQ==","user":{"login":"anjalinorwood","id":52180099,"node_id":"MDQ6VXNlcjUyMTgwMDk5","avatar_url":"https://avatars.githubusercontent.com/u/52180099?v=4","gravatar_id":"","url":"https://api.github.com/users/anjalinorwood","html_url":"https://github.com/anjalinorwood","followers_url":"https://api.github.com/users/anjalinorwood/followers","following_url":"https://api.github.com/users/anjalinorwood/following{/other_user}","gists_url":"https://api.github.com/users/anjalinorwood/gists{/gist_id}","starred_url":"https://api.github.com/users/anjalinorwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anjalinorwood/subscriptions","organizations_url":"https://api.github.com/users/anjalinorwood/orgs","repos_url":"https://api.github.com/users/anjalinorwood/repos","events_url":"https://api.github.com/users/anjalinorwood/events{/privacy}","received_events_url":"https://api.github.com/users/anjalinorwood/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-08T15:46:09Z","updated_at":"2019-11-08T15:46:09Z","author_association":"CONTRIBUTOR","body":"Great @prodeezy. @samarthjain , can you please sync with Gautam to avoid any duplicate work? Thank you both.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/551878659/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/551879616","html_url":"https://github.com/apache/iceberg/pull/624#issuecomment-551879616","issue_url":"https://api.github.com/repos/apache/iceberg/issues/624","id":551879616,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MTg3OTYxNg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-08T15:48:42Z","updated_at":"2019-11-08T15:48:42Z","author_association":"CONTRIBUTOR","body":"@chenjunjiedada @rdblue @jerryshao could you take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/551879616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/551893834","html_url":"https://github.com/apache/iceberg/pull/624#issuecomment-551893834","issue_url":"https://api.github.com/repos/apache/iceberg/issues/624","id":551893834,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MTg5MzgzNA==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-08T16:24:10Z","updated_at":"2019-11-08T16:24:10Z","author_association":"COLLABORATOR","body":"@aokolnychyi, I will take a look next week.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/551893834/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/551921706","html_url":"https://github.com/apache/iceberg/issues/604#issuecomment-551921706","issue_url":"https://api.github.com/repos/apache/iceberg/issues/604","id":551921706,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MTkyMTcwNg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-08T17:37:42Z","updated_at":"2019-11-08T17:37:42Z","author_association":"CONTRIBUTOR","body":"Sounds reasonable to me. Want to work on a PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/551921706/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/551926733","html_url":"https://github.com/apache/iceberg/pull/227#issuecomment-551926733","issue_url":"https://api.github.com/repos/apache/iceberg/issues/227","id":551926733,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MTkyNjczMw==","user":{"login":"edgarRd","id":266670,"node_id":"MDQ6VXNlcjI2NjY3MA==","avatar_url":"https://avatars.githubusercontent.com/u/266670?v=4","gravatar_id":"","url":"https://api.github.com/users/edgarRd","html_url":"https://github.com/edgarRd","followers_url":"https://api.github.com/users/edgarRd/followers","following_url":"https://api.github.com/users/edgarRd/following{/other_user}","gists_url":"https://api.github.com/users/edgarRd/gists{/gist_id}","starred_url":"https://api.github.com/users/edgarRd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edgarRd/subscriptions","organizations_url":"https://api.github.com/users/edgarRd/orgs","repos_url":"https://api.github.com/users/edgarRd/repos","events_url":"https://api.github.com/users/edgarRd/events{/privacy}","received_events_url":"https://api.github.com/users/edgarRd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-08T17:52:19Z","updated_at":"2019-11-08T17:52:19Z","author_association":"CONTRIBUTOR","body":"ORC is updated now to 1.6.1 and `TestReadProjection` for ORC is implemented and passing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/551926733/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552035697","html_url":"https://github.com/apache/iceberg/pull/622#issuecomment-552035697","issue_url":"https://api.github.com/repos/apache/iceberg/issues/622","id":552035697,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjAzNTY5Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-08T23:53:40Z","updated_at":"2019-11-08T23:53:40Z","author_association":"CONTRIBUTOR","body":"Thanks for fixing this, @jun-he!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552035697/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552037555","html_url":"https://github.com/apache/iceberg/pull/625#issuecomment-552037555","issue_url":"https://api.github.com/repos/apache/iceberg/issues/625","id":552037555,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjAzNzU1NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-09T00:03:36Z","updated_at":"2019-11-09T00:03:36Z","author_association":"CONTRIBUTOR","body":"Mostly looking good, @shardulm94!\r\n\r\nDoes this also need to update schema conversion so that enum is converted to Iceberg's string type?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552037555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552044060","html_url":"https://github.com/apache/iceberg/pull/616#issuecomment-552044060","issue_url":"https://api.github.com/repos/apache/iceberg/issues/616","id":552044060,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjA0NDA2MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-09T00:36:48Z","updated_at":"2019-11-09T00:36:48Z","author_association":"CONTRIBUTOR","body":"Sounds reasonable to me, since this doesn't contain any source and is a relatively small change.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552044060/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552044942","html_url":"https://github.com/apache/iceberg/pull/574#issuecomment-552044942","issue_url":"https://api.github.com/repos/apache/iceberg/issues/574","id":552044942,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjA0NDk0Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-09T00:42:08Z","updated_at":"2019-11-09T00:42:08Z","author_association":"CONTRIBUTOR","body":"@rdsr, could you have another look at this one? Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552044942/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552047058","html_url":"https://github.com/apache/iceberg/pull/619#issuecomment-552047058","issue_url":"https://api.github.com/repos/apache/iceberg/issues/619","id":552047058,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjA0NzA1OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-09T00:55:18Z","updated_at":"2019-11-09T00:55:28Z","author_association":"CONTRIBUTOR","body":"I think this is actually easier to implement than the version here. Instead of running a new validator class, I think you can add this validation to the existing `IndexByName` class. Just change `addField` to include the validation:\r\n\r\n```java\r\n  private void addField(String name, int fieldId) {\r\n    String fullName = name;\r\n    if (!fieldNames().isEmpty()) {\r\n      fullName = DOT.join(DOT.join(fieldNames().descendingIterator()), name);\r\n    }\r\n\r\n    Integer existingFieldId = nameToId.put(fullName, fieldId);\r\n    if (existingFieldId != null) {\r\n      throw new ValidationException(\r\n          \"Invalid schema: multiple fields for name %s: %s and %s\", fullName, existingFieldId, fieldId);\r\n    }\r\n  }\r\n```\r\n\r\nThen all you'd need to do is to access `lazyNameToId()` in the constructor.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552047058/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552048851","html_url":"https://github.com/apache/iceberg/pull/625#issuecomment-552048851","issue_url":"https://api.github.com/repos/apache/iceberg/issues/625","id":552048851,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjA0ODg1MQ==","user":{"login":"shardulm94","id":6961317,"node_id":"MDQ6VXNlcjY5NjEzMTc=","avatar_url":"https://avatars.githubusercontent.com/u/6961317?v=4","gravatar_id":"","url":"https://api.github.com/users/shardulm94","html_url":"https://github.com/shardulm94","followers_url":"https://api.github.com/users/shardulm94/followers","following_url":"https://api.github.com/users/shardulm94/following{/other_user}","gists_url":"https://api.github.com/users/shardulm94/gists{/gist_id}","starred_url":"https://api.github.com/users/shardulm94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shardulm94/subscriptions","organizations_url":"https://api.github.com/users/shardulm94/orgs","repos_url":"https://api.github.com/users/shardulm94/repos","events_url":"https://api.github.com/users/shardulm94/events{/privacy}","received_events_url":"https://api.github.com/users/shardulm94/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-09T01:07:07Z","updated_at":"2019-11-09T01:07:07Z","author_association":"CONTRIBUTOR","body":"@rdblue Schema conversions already handle conversion of enums to strings.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552048851/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552050711","html_url":"https://github.com/apache/iceberg/pull/625#issuecomment-552050711","issue_url":"https://api.github.com/repos/apache/iceberg/issues/625","id":552050711,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjA1MDcxMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-09T01:21:38Z","updated_at":"2019-11-09T01:21:38Z","author_association":"CONTRIBUTOR","body":"+1\r\n\r\nThanks for fixing this, @shardulm94!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552050711/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552050964","html_url":"https://github.com/apache/iceberg/pull/618#issuecomment-552050964","issue_url":"https://api.github.com/repos/apache/iceberg/issues/618","id":552050964,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjA1MDk2NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-09T01:23:49Z","updated_at":"2019-11-09T01:23:49Z","author_association":"CONTRIBUTOR","body":"+1\r\n\r\nThanks for fixing this, @rdsr!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552050964/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552051191","html_url":"https://github.com/apache/iceberg/pull/601#issuecomment-552051191","issue_url":"https://api.github.com/repos/apache/iceberg/issues/601","id":552051191,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjA1MTE5MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-11-09T01:25:50Z","updated_at":"2019-11-09T01:25:50Z","author_association":"CONTRIBUTOR","body":"Merged. Thanks for reviewing, @Parth-Brahmbhatt and @rdsr!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/552051191/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]