[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947270011","html_url":"https://github.com/apache/iceberg/issues/3280#issuecomment-947270011","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3280","id":947270011,"node_id":"IC_kwDOCW7NX844djF7","user":{"login":"zhengxingmao","id":40750002,"node_id":"MDQ6VXNlcjQwNzUwMDAy","avatar_url":"https://avatars.githubusercontent.com/u/40750002?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengxingmao","html_url":"https://github.com/zhengxingmao","followers_url":"https://api.github.com/users/zhengxingmao/followers","following_url":"https://api.github.com/users/zhengxingmao/following{/other_user}","gists_url":"https://api.github.com/users/zhengxingmao/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengxingmao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengxingmao/subscriptions","organizations_url":"https://api.github.com/users/zhengxingmao/orgs","repos_url":"https://api.github.com/users/zhengxingmao/repos","events_url":"https://api.github.com/users/zhengxingmao/events{/privacy}","received_events_url":"https://api.github.com/users/zhengxingmao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T02:40:35Z","updated_at":"2021-10-20T02:40:35Z","author_association":"NONE","body":"+1，\r\nI temporarily circumvented this problem by reducing the parallelism. I guess the root cause is the lack of lock protection during concurrent commit.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947270011/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947282518","html_url":"https://github.com/apache/iceberg/pull/3273#issuecomment-947282518","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3273","id":947282518,"node_id":"IC_kwDOCW7NX844dmJW","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T03:09:12Z","updated_at":"2021-10-20T03:09:12Z","author_association":"COLLABORATOR","body":"@rdblue  @RussellSpitzer addressed the comments, if you guys have time for another round","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947282518/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947301754","html_url":"https://github.com/apache/iceberg/pull/3323#issuecomment-947301754","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3323","id":947301754,"node_id":"IC_kwDOCW7NX844dq16","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T03:54:04Z","updated_at":"2021-10-20T03:54:04Z","author_association":"CONTRIBUTOR","body":"I just finish the streaming rewrite function, and I will complete the unittest in these few days. Maybe you can take a quick look and leave some comments, I will keep improve this PR in this week. @rdblue @openinx @stevenzwu @jackye1995 @kbendick  :) ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947301754/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947328340","html_url":"https://github.com/apache/iceberg/pull/3324#issuecomment-947328340","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3324","id":947328340,"node_id":"IC_kwDOCW7NX844dxVU","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T04:56:30Z","updated_at":"2021-10-20T04:56:30Z","author_association":"MEMBER","body":"cc: @rdblue , @aokolnychyi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947328340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947347334","html_url":"https://github.com/apache/iceberg/issues/3299#issuecomment-947347334","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3299","id":947347334,"node_id":"IC_kwDOCW7NX844d1-G","user":{"login":"ashoksri0","id":14317595,"node_id":"MDQ6VXNlcjE0MzE3NTk1","avatar_url":"https://avatars.githubusercontent.com/u/14317595?v=4","gravatar_id":"","url":"https://api.github.com/users/ashoksri0","html_url":"https://github.com/ashoksri0","followers_url":"https://api.github.com/users/ashoksri0/followers","following_url":"https://api.github.com/users/ashoksri0/following{/other_user}","gists_url":"https://api.github.com/users/ashoksri0/gists{/gist_id}","starred_url":"https://api.github.com/users/ashoksri0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashoksri0/subscriptions","organizations_url":"https://api.github.com/users/ashoksri0/orgs","repos_url":"https://api.github.com/users/ashoksri0/repos","events_url":"https://api.github.com/users/ashoksri0/events{/privacy}","received_events_url":"https://api.github.com/users/ashoksri0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T05:45:22Z","updated_at":"2021-10-20T05:45:22Z","author_association":"NONE","body":"> From the test files `TestRewriteFiles.java` and `TestCreateActions.java`, you could figure out the following sample code:\r\n> \r\n> ```java\r\n> TestTables.TestTable table = TestTables.create(tableDir, \"test\", schema, spec, formatVersion);\r\n> // or you do not need create a new HiveCatalog, instead using the internal\r\n> // TableCatalog catalog = (TableCatalog) spark.sessionState().catalogManager().catalog(\"spark_catalog\");\r\n> // SparkTable table =  catalog.loadTable(\"SUBSCRIBER\");\r\n> table.newRewrite()\r\n>             .rewriteFiles(ImmutableSet.of(FILE_A), ImmutableSet.of(),\r\n>                 ImmutableSet.of(), ImmutableSet.of(FILE_A_DELETES))\r\n>             .apply()\r\n> ```\r\n> \r\n> I think you lose the `apply()` action here. Or you may code simply:\r\n> \r\n> ```java\r\n>       spark.read().parquet(\"/path.parquet\").writeTo(\"SUBSCRIBER\");\r\n> ```\r\n\r\nI added to apply to append still getting same no data directory found and unable to read from trino. I need a java solution from the spark side everything works well, but I can't use spark right now. I need to have the input parquet in my local directory or  inside hdfs file system ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947347334/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947383886","html_url":"https://github.com/apache/iceberg/pull/3276#issuecomment-947383886","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3276","id":947383886,"node_id":"IC_kwDOCW7NX844d-5O","user":{"login":"velctor","id":39006258,"node_id":"MDQ6VXNlcjM5MDA2MjU4","avatar_url":"https://avatars.githubusercontent.com/u/39006258?v=4","gravatar_id":"","url":"https://api.github.com/users/velctor","html_url":"https://github.com/velctor","followers_url":"https://api.github.com/users/velctor/followers","following_url":"https://api.github.com/users/velctor/following{/other_user}","gists_url":"https://api.github.com/users/velctor/gists{/gist_id}","starred_url":"https://api.github.com/users/velctor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/velctor/subscriptions","organizations_url":"https://api.github.com/users/velctor/orgs","repos_url":"https://api.github.com/users/velctor/repos","events_url":"https://api.github.com/users/velctor/events{/privacy}","received_events_url":"https://api.github.com/users/velctor/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T07:00:02Z","updated_at":"2021-10-20T07:00:31Z","author_association":"NONE","body":"\r\n\r\n> @velctor, can you post the problem that you're seeing? If you have a stream that was closed by the finalizer, how is anything still using it to hit the `Stream closed` error?\r\n\r\nThe error `Stream closed`  occurs when the created `stream` is used to read the deletefile. The specific error is as follows:\r\n```\r\nCaused by: org.apache.iceberg.exceptions.RuntimeIOException: java.io.IOException: Stream is closed!\r\n        at org.apache.iceberg.parquet.ParquetReader$FileIterator.advance(ParquetReader.java:135)\r\n        at org.apache.iceberg.parquet.ParquetReader$FileIterator.next(ParquetReader.java:112)\r\n        at org.apache.iceberg.io.CloseableIterable$ConcatCloseableIterable$ConcatCloseableIterator.next(CloseableIterable.java:206)\r\n        at org.apache.iceberg.io.CloseableIterable$4$1.next(CloseableIterable.java:113)\r\n        at org.apache.iceberg.relocated.com.google.common.collect.Iterators.addAll(Iterators.java:356)\r\n        at org.apache.iceberg.relocated.com.google.common.collect.Iterables.addAll(Iterables.java:320)\r\n        at org.apache.iceberg.deletes.Deletes.toEqualitySet(Deletes.java:83)\r\n        at org.apache.iceberg.data.DeleteFilter.applyEqDeletes(DeleteFilter.java:137)\r\n        at org.apache.iceberg.data.DeleteFilter.applyEqDeletes(DeleteFilter.java:166)\r\n        at org.apache.iceberg.data.DeleteFilter.filter(DeleteFilter.java:112)\r\n        at io.trino.plugin.iceberg.IcebergPageSource.getNextPage(IcebergPageSource.java:125)\r\n        ... 12 more\r\nCaused by: java.io.IOException: Stream is closed!\r\n        at org.apache.hadoop.hdfs.DFSInputStream.seek(DFSInputStream.java:1453)\r\n        at org.apache.hadoop.fs.FSDataInputStream.seek(FSDataInputStream.java:65)\r\n        at org.apache.hadoop.fs.FSDataInputStream.seek(FSDataInputStream.java:65)\r\n        at org.apache.parquet.hadoop.util.H2SeekableInputStream.seek(H2SeekableInputStream.java:60)\r\n        at org.apache.parquet.hadoop.ParquetFileReader$ConsecutivePartList.readAll(ParquetFileReader.java:1687)\r\n        at org.apache.parquet.hadoop.ParquetFileReader.readNextRowGroup(ParquetFileReader.java:925)\r\n        at org.apache.iceberg.parquet.ParquetReader$FileIterator.advance(ParquetReader.java:133)\r\n        ... 22 more\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947383886/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947441885","html_url":"https://github.com/apache/iceberg/issues/3157#issuecomment-947441885","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3157","id":947441885,"node_id":"IC_kwDOCW7NX844eNDd","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T08:25:57Z","updated_at":"2021-10-20T08:25:57Z","author_association":"CONTRIBUTOR","body":"Attaching the full dump: [sparkprocessdump.txt](https://github.com/apache/iceberg/files/7379451/sparkprocessdump.txt)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947441885/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947503686","html_url":"https://github.com/apache/iceberg/issues/3299#issuecomment-947503686","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3299","id":947503686,"node_id":"IC_kwDOCW7NX844ecJG","user":{"login":"KnightChess","id":20125927,"node_id":"MDQ6VXNlcjIwMTI1OTI3","avatar_url":"https://avatars.githubusercontent.com/u/20125927?v=4","gravatar_id":"","url":"https://api.github.com/users/KnightChess","html_url":"https://github.com/KnightChess","followers_url":"https://api.github.com/users/KnightChess/followers","following_url":"https://api.github.com/users/KnightChess/following{/other_user}","gists_url":"https://api.github.com/users/KnightChess/gists{/gist_id}","starred_url":"https://api.github.com/users/KnightChess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KnightChess/subscriptions","organizations_url":"https://api.github.com/users/KnightChess/orgs","repos_url":"https://api.github.com/users/KnightChess/repos","events_url":"https://api.github.com/users/KnightChess/events{/privacy}","received_events_url":"https://api.github.com/users/KnightChess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T09:43:58Z","updated_at":"2021-10-20T09:43:58Z","author_association":"CONTRIBUTOR","body":"you can view the manifest file, the data file path will point to xxxx.snappy.parquet\r\nappendFile I think is update metadata","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947503686/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947534882","html_url":"https://github.com/apache/iceberg/issues/3299#issuecomment-947534882","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3299","id":947534882,"node_id":"IC_kwDOCW7NX844ejwi","user":{"login":"fengguangyuan","id":10569747,"node_id":"MDQ6VXNlcjEwNTY5NzQ3","avatar_url":"https://avatars.githubusercontent.com/u/10569747?v=4","gravatar_id":"","url":"https://api.github.com/users/fengguangyuan","html_url":"https://github.com/fengguangyuan","followers_url":"https://api.github.com/users/fengguangyuan/followers","following_url":"https://api.github.com/users/fengguangyuan/following{/other_user}","gists_url":"https://api.github.com/users/fengguangyuan/gists{/gist_id}","starred_url":"https://api.github.com/users/fengguangyuan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fengguangyuan/subscriptions","organizations_url":"https://api.github.com/users/fengguangyuan/orgs","repos_url":"https://api.github.com/users/fengguangyuan/repos","events_url":"https://api.github.com/users/fengguangyuan/events{/privacy}","received_events_url":"https://api.github.com/users/fengguangyuan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T10:26:54Z","updated_at":"2021-10-20T10:26:54Z","author_association":"NONE","body":"> > From the test files `TestRewriteFiles.java` and `TestCreateActions.java`, you could figure out the following sample code:\r\n> > ```java\r\n> > TestTables.TestTable table = TestTables.create(tableDir, \"test\", schema, spec, formatVersion);\r\n> > // or you do not need create a new HiveCatalog, instead using the internal\r\n> > // TableCatalog catalog = (TableCatalog) spark.sessionState().catalogManager().catalog(\"spark_catalog\");\r\n> > // SparkTable table =  catalog.loadTable(\"SUBSCRIBER\");\r\n> > table.newRewrite()\r\n> >             .rewriteFiles(ImmutableSet.of(FILE_A), ImmutableSet.of(),\r\n> >                 ImmutableSet.of(), ImmutableSet.of(FILE_A_DELETES))\r\n> >             .apply()\r\n> > ```\r\n> > \r\n> > \r\n> >     \r\n> >       \r\n> >     \r\n> > \r\n> >       \r\n> >     \r\n> > \r\n> >     \r\n> >   \r\n> > I think you lose the `apply()` action here. Or you may code simply:\r\n> > ```java\r\n> >       spark.read().parquet(\"/path.parquet\").writeTo(\"SUBSCRIBER\");\r\n> > ```\r\n> \r\n> I added to apply to append still getting same no data directory found and unable to read from trino. I need a java solution from the spark side everything works well, but I can't use spark right now. I need to have the input parquet in my local directory or inside hdfs file system\r\n\r\nSorry about my previous reply, `apply()` just returns a BaseSnapshot instance, `commit()` is actually persisting the metadata and data file.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947534882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947583746","html_url":"https://github.com/apache/iceberg/issues/3306#issuecomment-947583746","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3306","id":947583746,"node_id":"IC_kwDOCW7NX844evsC","user":{"login":"KnightChess","id":20125927,"node_id":"MDQ6VXNlcjIwMTI1OTI3","avatar_url":"https://avatars.githubusercontent.com/u/20125927?v=4","gravatar_id":"","url":"https://api.github.com/users/KnightChess","html_url":"https://github.com/KnightChess","followers_url":"https://api.github.com/users/KnightChess/followers","following_url":"https://api.github.com/users/KnightChess/following{/other_user}","gists_url":"https://api.github.com/users/KnightChess/gists{/gist_id}","starred_url":"https://api.github.com/users/KnightChess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KnightChess/subscriptions","organizations_url":"https://api.github.com/users/KnightChess/orgs","repos_url":"https://api.github.com/users/KnightChess/repos","events_url":"https://api.github.com/users/KnightChess/events{/privacy}","received_events_url":"https://api.github.com/users/KnightChess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T11:42:20Z","updated_at":"2021-10-20T11:42:20Z","author_association":"CONTRIBUTOR","body":"I have a crazy idea.\r\nI test in hadoop catalog.type. when you alter table, only xxx.metadata.json be changed (make sure you did not do any action). and there is two ways get the drop cloumn data.\r\n\r\nbecause only metadata change:\r\n- first method: you can update the vX.metadata.json file, change column id: shema.fileld.id、shemas[].fileld.id which change. finally remove the vX.metadata.json.crc file\r\n- second method: update the version-hint.text, and delete recent metadata.json include version-hint.text.crc\r\n> Either way can be successful\r\n\r\nhive type maybe need update metastore...","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947583746/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947625169","html_url":"https://github.com/apache/iceberg/issues/3306#issuecomment-947625169","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3306","id":947625169,"node_id":"IC_kwDOCW7NX844e5zR","user":{"login":"ChenLinL","id":29078318,"node_id":"MDQ6VXNlcjI5MDc4MzE4","avatar_url":"https://avatars.githubusercontent.com/u/29078318?v=4","gravatar_id":"","url":"https://api.github.com/users/ChenLinL","html_url":"https://github.com/ChenLinL","followers_url":"https://api.github.com/users/ChenLinL/followers","following_url":"https://api.github.com/users/ChenLinL/following{/other_user}","gists_url":"https://api.github.com/users/ChenLinL/gists{/gist_id}","starred_url":"https://api.github.com/users/ChenLinL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ChenLinL/subscriptions","organizations_url":"https://api.github.com/users/ChenLinL/orgs","repos_url":"https://api.github.com/users/ChenLinL/repos","events_url":"https://api.github.com/users/ChenLinL/events{/privacy}","received_events_url":"https://api.github.com/users/ChenLinL/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T12:40:04Z","updated_at":"2021-10-20T12:40:04Z","author_association":"NONE","body":"Cool! I noticed what you mentioned on the metadata, but I didn't try that. It can be a solution. I will try it later. Thanks for sharing it. @KnightChess \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947625169/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947628827","html_url":"https://github.com/apache/iceberg/issues/3325#issuecomment-947628827","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3325","id":947628827,"node_id":"IC_kwDOCW7NX844e6sb","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T12:43:54Z","updated_at":"2021-10-20T12:43:54Z","author_association":"CONTRIBUTOR","body":"I will take a look at this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947628827/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947680038","html_url":"https://github.com/apache/iceberg/issues/3299#issuecomment-947680038","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3299","id":947680038,"node_id":"IC_kwDOCW7NX844fHMm","user":{"login":"ashoksri0","id":14317595,"node_id":"MDQ6VXNlcjE0MzE3NTk1","avatar_url":"https://avatars.githubusercontent.com/u/14317595?v=4","gravatar_id":"","url":"https://api.github.com/users/ashoksri0","html_url":"https://github.com/ashoksri0","followers_url":"https://api.github.com/users/ashoksri0/followers","following_url":"https://api.github.com/users/ashoksri0/following{/other_user}","gists_url":"https://api.github.com/users/ashoksri0/gists{/gist_id}","starred_url":"https://api.github.com/users/ashoksri0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashoksri0/subscriptions","organizations_url":"https://api.github.com/users/ashoksri0/orgs","repos_url":"https://api.github.com/users/ashoksri0/repos","events_url":"https://api.github.com/users/ashoksri0/events{/privacy}","received_events_url":"https://api.github.com/users/ashoksri0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T13:41:49Z","updated_at":"2021-10-20T13:41:49Z","author_association":"NONE","body":"> you can view the manifest file, the data file path will point to xxxx.snappy.parquet appendFile I think is update metadata\r\n\r\ncan you please give me sample code for  ingestion with  java i tired many ways none worked i need to know where i'm wrong","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947680038/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947684021","html_url":"https://github.com/apache/iceberg/issues/3299#issuecomment-947684021","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3299","id":947684021,"node_id":"IC_kwDOCW7NX844fIK1","user":{"login":"ashoksri0","id":14317595,"node_id":"MDQ6VXNlcjE0MzE3NTk1","avatar_url":"https://avatars.githubusercontent.com/u/14317595?v=4","gravatar_id":"","url":"https://api.github.com/users/ashoksri0","html_url":"https://github.com/ashoksri0","followers_url":"https://api.github.com/users/ashoksri0/followers","following_url":"https://api.github.com/users/ashoksri0/following{/other_user}","gists_url":"https://api.github.com/users/ashoksri0/gists{/gist_id}","starred_url":"https://api.github.com/users/ashoksri0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashoksri0/subscriptions","organizations_url":"https://api.github.com/users/ashoksri0/orgs","repos_url":"https://api.github.com/users/ashoksri0/repos","events_url":"https://api.github.com/users/ashoksri0/events{/privacy}","received_events_url":"https://api.github.com/users/ashoksri0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T13:46:18Z","updated_at":"2021-10-20T13:46:18Z","author_association":"NONE","body":"> > > From the test files `TestRewriteFiles.java` and `TestCreateActions.java`, you could figure out the following sample code:\r\n> > > ```java\r\n> > > TestTables.TestTable table = TestTables.create(tableDir, \"test\", schema, spec, formatVersion);\r\n> > > // or you do not need create a new HiveCatalog, instead using the internal\r\n> > > // TableCatalog catalog = (TableCatalog) spark.sessionState().catalogManager().catalog(\"spark_catalog\");\r\n> > > // SparkTable table =  catalog.loadTable(\"SUBSCRIBER\");\r\n> > > table.newRewrite()\r\n> > >             .rewriteFiles(ImmutableSet.of(FILE_A), ImmutableSet.of(),\r\n> > >                 ImmutableSet.of(), ImmutableSet.of(FILE_A_DELETES))\r\n> > >             .apply()\r\n> > > ```\r\n> > > \r\n> > > \r\n> > >     \r\n> > >       \r\n> > >     \r\n> > > \r\n> > >       \r\n> > >     \r\n> > > \r\n> > >     \r\n> > >   \r\n> > > I think you lose the `apply()` action here. Or you may code simply:\r\n> > > ```java\r\n> > >       spark.read().parquet(\"/path.parquet\").writeTo(\"SUBSCRIBER\");\r\n> > > ```\r\n> > \r\n> > \r\n> > I added to apply to append still getting same no data directory found and unable to read from trino. I need a java solution from the spark side everything works well, but I can't use spark right now. I need to have the input parquet in my local directory or inside hdfs file system\r\n> \r\n> Sorry about my previous reply, `apply()` just returns a BaseSnapshot instance, `commit()` is actually persisting the metadata and data file.\r\n\r\nI tried with commit I get many versions of metadata and Avro files, not the data, I don't know will I need to get the input from file path from HDFS or from my local ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947684021/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947707026","html_url":"https://github.com/apache/iceberg/issues/3299#issuecomment-947707026","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3299","id":947707026,"node_id":"IC_kwDOCW7NX844fNyS","user":{"login":"KnightChess","id":20125927,"node_id":"MDQ6VXNlcjIwMTI1OTI3","avatar_url":"https://avatars.githubusercontent.com/u/20125927?v=4","gravatar_id":"","url":"https://api.github.com/users/KnightChess","html_url":"https://github.com/KnightChess","followers_url":"https://api.github.com/users/KnightChess/followers","following_url":"https://api.github.com/users/KnightChess/following{/other_user}","gists_url":"https://api.github.com/users/KnightChess/gists{/gist_id}","starred_url":"https://api.github.com/users/KnightChess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KnightChess/subscriptions","organizations_url":"https://api.github.com/users/KnightChess/orgs","repos_url":"https://api.github.com/users/KnightChess/repos","events_url":"https://api.github.com/users/KnightChess/events{/privacy}","received_events_url":"https://api.github.com/users/KnightChess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T14:11:42Z","updated_at":"2021-10-20T14:11:42Z","author_association":"CONTRIBUTOR","body":"```java\r\ntable.newAppend().appendFile(dataFile).commit();\r\n```\r\nIt only update metadata when you commit it. won't mv parquet file to default data directory.\r\nlike: if the parquet file in /usr/data/xxx.parquet,  the metadata manifect file will add datafile uri to /usr/data/xxx.parquet, etc. if the parquet file in /tmp/my/xxx.parquet, the metadata manifect file will add datafile uri to /tmp/my/xxx.parquet. won't mv the parquet file to /user/hive/warehouse/claims_sys.db/SUBSCRIBER/data/xxx.parquet.\r\n\r\nso, you can make a data directory and mv datafile to the data directory.\r\n\r\nor, like @fengguangyuan say, before ```java table.newAppend().appendFile(dataFile).commit(); ``` update datafile, you need ```java spark.read().parquet(\"/path.parquet\").writeTo(\"SUBSCRIBER\"); ``` it may mv data file to the target directory\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947707026/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947732293","html_url":"https://github.com/apache/iceberg/issues/3299#issuecomment-947732293","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3299","id":947732293,"node_id":"IC_kwDOCW7NX844fT9F","user":{"login":"ashoksri0","id":14317595,"node_id":"MDQ6VXNlcjE0MzE3NTk1","avatar_url":"https://avatars.githubusercontent.com/u/14317595?v=4","gravatar_id":"","url":"https://api.github.com/users/ashoksri0","html_url":"https://github.com/ashoksri0","followers_url":"https://api.github.com/users/ashoksri0/followers","following_url":"https://api.github.com/users/ashoksri0/following{/other_user}","gists_url":"https://api.github.com/users/ashoksri0/gists{/gist_id}","starred_url":"https://api.github.com/users/ashoksri0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashoksri0/subscriptions","organizations_url":"https://api.github.com/users/ashoksri0/orgs","repos_url":"https://api.github.com/users/ashoksri0/repos","events_url":"https://api.github.com/users/ashoksri0/events{/privacy}","received_events_url":"https://api.github.com/users/ashoksri0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T14:37:40Z","updated_at":"2021-10-20T14:37:40Z","author_association":"NONE","body":"> ```java\r\n> table.newAppend().appendFile(dataFile).commit();\r\n> ```\r\n> \r\n> It only update metadata when you commit it. won't mv parquet file to default data directory. like: if the parquet file in /usr/data/xxx.parquet, the metadata manifect file will add datafile uri to /usr/data/xxx.parquet, etc. if the parquet file in /tmp/my/xxx.parquet, the metadata manifect file will add datafile uri to /tmp/my/xxx.parquet. won't mv the parquet file to /user/hive/warehouse/claims_sys.db/SUBSCRIBER/data/xxx.parquet.\r\n> \r\n> so, you can make a data directory and mv data file to the data directory.\r\n> \r\n> or, like @fengguangyuan say, before `java table.newAppend().appendFile(dataFile).commit(); ` update datafile, you need `java spark.read().parquet(\"/path.parquet\").writeTo(\"SUBSCRIBER\"); ` it may mv data file to the target directory\r\n\r\nas per my understanding, I need to move the parquet to the data folder programmatically or manually, then I need to add the URI of that file to dataFile, will get back to you by following above steps thanks for the help to all","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947732293/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947754585","html_url":"https://github.com/apache/iceberg/issues/3297#issuecomment-947754585","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3297","id":947754585,"node_id":"IC_kwDOCW7NX844fZZZ","user":{"login":"KnightChess","id":20125927,"node_id":"MDQ6VXNlcjIwMTI1OTI3","avatar_url":"https://avatars.githubusercontent.com/u/20125927?v=4","gravatar_id":"","url":"https://api.github.com/users/KnightChess","html_url":"https://github.com/KnightChess","followers_url":"https://api.github.com/users/KnightChess/followers","following_url":"https://api.github.com/users/KnightChess/following{/other_user}","gists_url":"https://api.github.com/users/KnightChess/gists{/gist_id}","starred_url":"https://api.github.com/users/KnightChess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KnightChess/subscriptions","organizations_url":"https://api.github.com/users/KnightChess/orgs","repos_url":"https://api.github.com/users/KnightChess/repos","events_url":"https://api.github.com/users/KnightChess/events{/privacy}","received_events_url":"https://api.github.com/users/KnightChess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T15:00:49Z","updated_at":"2021-10-20T15:00:49Z","author_association":"CONTRIBUTOR","body":"Hi, @RussellSpitzer  I am newbie to open source, not sure about the rules. Looked other issue, seems to need to assign issue...\r\nthis is the pr for this issue, #3317 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947754585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947762168","html_url":"https://github.com/apache/iceberg/issues/3299#issuecomment-947762168","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3299","id":947762168,"node_id":"IC_kwDOCW7NX844fbP4","user":{"login":"ashoksri0","id":14317595,"node_id":"MDQ6VXNlcjE0MzE3NTk1","avatar_url":"https://avatars.githubusercontent.com/u/14317595?v=4","gravatar_id":"","url":"https://api.github.com/users/ashoksri0","html_url":"https://github.com/ashoksri0","followers_url":"https://api.github.com/users/ashoksri0/followers","following_url":"https://api.github.com/users/ashoksri0/following{/other_user}","gists_url":"https://api.github.com/users/ashoksri0/gists{/gist_id}","starred_url":"https://api.github.com/users/ashoksri0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashoksri0/subscriptions","organizations_url":"https://api.github.com/users/ashoksri0/orgs","repos_url":"https://api.github.com/users/ashoksri0/repos","events_url":"https://api.github.com/users/ashoksri0/events{/privacy}","received_events_url":"https://api.github.com/users/ashoksri0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T15:08:53Z","updated_at":"2021-10-20T15:08:53Z","author_association":"NONE","body":"how I will find the latest metadata JSON for the table from java API so that I can add in table properties that helps TRINO to read the table","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947762168/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947762583","html_url":"https://github.com/apache/iceberg/pull/3273#issuecomment-947762583","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3273","id":947762583,"node_id":"IC_kwDOCW7NX844fbWX","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T15:09:20Z","updated_at":"2021-10-20T15:09:20Z","author_association":"CONTRIBUTOR","body":"Thanks, @szehon-ho! Nice work.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947762583/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947802989","html_url":"https://github.com/apache/iceberg/issues/3297#issuecomment-947802989","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3297","id":947802989,"node_id":"IC_kwDOCW7NX844flNt","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T15:51:16Z","updated_at":"2021-10-20T15:51:16Z","author_association":"MEMBER","body":"We have no rules here :) But I can assign you if you like. Honestly we tend to just respect whoever wants to do the work should put up a pr, and then we go from there.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947802989/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947816252","html_url":"https://github.com/apache/iceberg/issues/3228#issuecomment-947816252","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3228","id":947816252,"node_id":"IC_kwDOCW7NX844foc8","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T16:06:58Z","updated_at":"2021-10-20T16:06:58Z","author_association":"COLLABORATOR","body":"Yep, working on #3216 and will ship it ASAP.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947816252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947841106","html_url":"https://github.com/apache/iceberg/pull/3273#issuecomment-947841106","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3273","id":947841106,"node_id":"IC_kwDOCW7NX844fuhS","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T16:38:25Z","updated_at":"2021-10-20T16:38:25Z","author_association":"COLLABORATOR","body":"Thanks for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947841106/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947842761","html_url":"https://github.com/apache/iceberg/pull/3155#issuecomment-947842761","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3155","id":947842761,"node_id":"IC_kwDOCW7NX844fu7J","user":{"login":"omarsmak","id":1190920,"node_id":"MDQ6VXNlcjExOTA5MjA=","avatar_url":"https://avatars.githubusercontent.com/u/1190920?v=4","gravatar_id":"","url":"https://api.github.com/users/omarsmak","html_url":"https://github.com/omarsmak","followers_url":"https://api.github.com/users/omarsmak/followers","following_url":"https://api.github.com/users/omarsmak/following{/other_user}","gists_url":"https://api.github.com/users/omarsmak/gists{/gist_id}","starred_url":"https://api.github.com/users/omarsmak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omarsmak/subscriptions","organizations_url":"https://api.github.com/users/omarsmak/orgs","repos_url":"https://api.github.com/users/omarsmak/repos","events_url":"https://api.github.com/users/omarsmak/events{/privacy}","received_events_url":"https://api.github.com/users/omarsmak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T16:40:33Z","updated_at":"2021-10-20T16:40:33Z","author_association":"MEMBER","body":"@rdblue I think this PR is a good candidate for 0.12.1 milestone","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947842761/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947845241","html_url":"https://github.com/apache/iceberg/issues/3157#issuecomment-947845241","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3157","id":947845241,"node_id":"IC_kwDOCW7NX844fvh5","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T16:43:40Z","updated_at":"2021-10-20T16:44:45Z","author_association":"MEMBER","body":"Solved with #3329  - I took a guess after @nastra debugged and tried a bunch of things out. By removing the \"when\" clauses and just working on base column functions I get the setup time down to ~ 1 minute. As for the actual regression in spark? no idea. Someone should check out the codegen between 2.4.5 and 2.4.6 if they really care :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947845241/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947861663","html_url":"https://github.com/apache/iceberg/pull/3329#issuecomment-947861663","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3329","id":947861663,"node_id":"IC_kwDOCW7NX844fzif","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T17:05:23Z","updated_at":"2021-10-20T17:05:23Z","author_association":"CONTRIBUTOR","body":"Good catch!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947861663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947862237","html_url":"https://github.com/apache/iceberg/pull/3329#issuecomment-947862237","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3329","id":947862237,"node_id":"IC_kwDOCW7NX844fzrd","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T17:06:07Z","updated_at":"2021-10-20T17:06:07Z","author_association":"CONTRIBUTOR","body":"I'm going to merge this before tests pass because it only modifies benchmark code that won't affect tests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947862237/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947864408","html_url":"https://github.com/apache/iceberg/pull/3320#issuecomment-947864408","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3320","id":947864408,"node_id":"IC_kwDOCW7NX844f0NY","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T17:08:53Z","updated_at":"2021-10-20T17:08:53Z","author_association":"CONTRIBUTOR","body":"Good point. I forgot to update max.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947864408/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947865701","html_url":"https://github.com/apache/iceberg/pull/3276#issuecomment-947865701","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3276","id":947865701,"node_id":"IC_kwDOCW7NX844f0hl","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T17:10:30Z","updated_at":"2021-10-20T17:10:30Z","author_association":"CONTRIBUTOR","body":"@velctor, why do you think that the stream was closed by the finalizer and not by a normal call to `close`?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947865701/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947867020","html_url":"https://github.com/apache/iceberg/pull/3329#issuecomment-947867020","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3329","id":947867020,"node_id":"IC_kwDOCW7NX844f02M","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T17:12:20Z","updated_at":"2021-10-20T17:12:20Z","author_association":"MEMBER","body":"Ahh it wasn't done :( I broke the spark2 jmh tests, just fixed and pushed\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947867020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947868710","html_url":"https://github.com/apache/iceberg/pull/3329#issuecomment-947868710","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3329","id":947868710,"node_id":"IC_kwDOCW7NX844f1Qm","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T17:14:30Z","updated_at":"2021-10-20T17:14:30Z","author_association":"MEMBER","body":"https://github.com/apache/iceberg/pull/3330","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947868710/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947869654","html_url":"https://github.com/apache/iceberg/pull/3293#issuecomment-947869654","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3293","id":947869654,"node_id":"IC_kwDOCW7NX844f1fW","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T17:15:47Z","updated_at":"2021-10-20T17:15:47Z","author_association":"CONTRIBUTOR","body":"@NeQuissimus, the problem is that the data directory is no longer created in the test. I think what's happening is that the Parquet writer no longer creates an empty file that later gets deleted. That file create is what creates the data directory, so when we go to list it and check that no files were created, the check fails. You should be able to update the test code to check whether the directory exists and handle this case.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947869654/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947881809","html_url":"https://github.com/apache/iceberg/pull/3155#issuecomment-947881809","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3155","id":947881809,"node_id":"IC_kwDOCW7NX844f4dR","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T17:25:35Z","updated_at":"2021-10-20T17:25:35Z","author_association":"CONTRIBUTOR","body":"Thanks, @omarsmak. I've added this to the 0.12.1 milestone.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947881809/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947887440","html_url":"https://github.com/apache/iceberg/pull/3330#issuecomment-947887440","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3330","id":947887440,"node_id":"IC_kwDOCW7NX844f51Q","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T17:33:00Z","updated_at":"2021-10-20T17:33:00Z","author_association":"CONTRIBUTOR","body":"Good catch I had forgotten to run these ones.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947887440/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947904955","html_url":"https://github.com/apache/iceberg/issues/2962#issuecomment-947904955","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2962","id":947904955,"node_id":"IC_kwDOCW7NX844f-G7","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T17:57:10Z","updated_at":"2021-10-20T17:57:10Z","author_association":"CONTRIBUTOR","body":"Thank you everybody for your reports and thank you Ryan for the fix!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947904955/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947918754","html_url":"https://github.com/apache/iceberg/pull/3284#issuecomment-947918754","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3284","id":947918754,"node_id":"IC_kwDOCW7NX844gBei","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T18:15:23Z","updated_at":"2021-10-20T18:15:23Z","author_association":"CONTRIBUTOR","body":"Based on this PR, is this no longer needed (at least for the Avro import path)? https://github.com/apache/iceberg/pull/3273/files @szehon-ho","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947918754/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947928954","html_url":"https://github.com/apache/iceberg/pull/3284#issuecomment-947928954","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3284","id":947928954,"node_id":"IC_kwDOCW7NX844gD96","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T18:28:43Z","updated_at":"2021-10-20T18:28:43Z","author_association":"CONTRIBUTOR","body":"Yeah, I think that fixing the Avro bug was the important thing. Let's close this. Thanks @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947928954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947959498","html_url":"https://github.com/apache/iceberg/pull/3293#issuecomment-947959498","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3293","id":947959498,"node_id":"IC_kwDOCW7NX844gLbK","user":{"login":"NeQuissimus","id":628342,"node_id":"MDQ6VXNlcjYyODM0Mg==","avatar_url":"https://avatars.githubusercontent.com/u/628342?v=4","gravatar_id":"","url":"https://api.github.com/users/NeQuissimus","html_url":"https://github.com/NeQuissimus","followers_url":"https://api.github.com/users/NeQuissimus/followers","following_url":"https://api.github.com/users/NeQuissimus/following{/other_user}","gists_url":"https://api.github.com/users/NeQuissimus/gists{/gist_id}","starred_url":"https://api.github.com/users/NeQuissimus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NeQuissimus/subscriptions","organizations_url":"https://api.github.com/users/NeQuissimus/orgs","repos_url":"https://api.github.com/users/NeQuissimus/repos","events_url":"https://api.github.com/users/NeQuissimus/events{/privacy}","received_events_url":"https://api.github.com/users/NeQuissimus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T19:11:37Z","updated_at":"2021-10-20T19:14:14Z","author_association":"CONTRIBUTOR","body":"@rdblue right, that's what I figured. Does that not mean the entire test is pointless now? The folder/files will not exist before or after calling `abort` since the (now) lazy writer never even created them. The file count will always be 0 and the folder will never exist.\r\nI can change the test to ensure that but it won't really check any of `abort`'s behaviour, will it?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947959498/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947967370","html_url":"https://github.com/apache/iceberg/pull/1508#issuecomment-947967370","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1508","id":947967370,"node_id":"IC_kwDOCW7NX844gNWK","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T19:22:57Z","updated_at":"2021-10-20T19:22:57Z","author_association":"CONTRIBUTOR","body":"I think this is almost ready. Just a few minor things to fix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947967370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947971006","html_url":"https://github.com/apache/iceberg/pull/3293#issuecomment-947971006","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3293","id":947971006,"node_id":"IC_kwDOCW7NX844gOO-","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T19:27:43Z","updated_at":"2021-10-20T19:27:43Z","author_association":"CONTRIBUTOR","body":"I think the test is still valid. An aborted commit should drop the data files. The way to fix it is probably to write some content to the Parquet file before aborting, if possible. That way it still tests what you want it to.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947971006/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947972674","html_url":"https://github.com/apache/iceberg/pull/3293#issuecomment-947972674","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3293","id":947972674,"node_id":"IC_kwDOCW7NX844gOpC","user":{"login":"NeQuissimus","id":628342,"node_id":"MDQ6VXNlcjYyODM0Mg==","avatar_url":"https://avatars.githubusercontent.com/u/628342?v=4","gravatar_id":"","url":"https://api.github.com/users/NeQuissimus","html_url":"https://github.com/NeQuissimus","followers_url":"https://api.github.com/users/NeQuissimus/followers","following_url":"https://api.github.com/users/NeQuissimus/following{/other_user}","gists_url":"https://api.github.com/users/NeQuissimus/gists{/gist_id}","starred_url":"https://api.github.com/users/NeQuissimus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NeQuissimus/subscriptions","organizations_url":"https://api.github.com/users/NeQuissimus/orgs","repos_url":"https://api.github.com/users/NeQuissimus/repos","events_url":"https://api.github.com/users/NeQuissimus/events{/privacy}","received_events_url":"https://api.github.com/users/NeQuissimus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T19:29:54Z","updated_at":"2021-10-20T19:29:54Z","author_association":"CONTRIBUTOR","body":"@rdblue Makes sense, I'll try to get to it tomorrow","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/947972674/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948002416","html_url":"https://github.com/apache/iceberg/pull/3320#issuecomment-948002416","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3320","id":948002416,"node_id":"IC_kwDOCW7NX844gV5w","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T20:14:41Z","updated_at":"2021-10-20T20:14:41Z","author_association":"CONTRIBUTOR","body":"> Good point. I forgot to update max.\r\n\r\nI'm applying the same changes to max in the branch I'm testing in. So far, the `min` fixes seem to work.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948002416/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948043033","html_url":"https://github.com/apache/iceberg/pull/3320#issuecomment-948043033","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3320","id":948043033,"node_id":"IC_kwDOCW7NX844gf0Z","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T21:16:10Z","updated_at":"2021-10-20T21:16:10Z","author_association":"CONTRIBUTOR","body":"I added tests for this here: https://github.com/apache/iceberg/pull/3332\r\n\r\nI first verified that I hit the error, then added in the min fix here, got the max error, and then added that fix as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948043033/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948059041","html_url":"https://github.com/apache/iceberg/pull/3334#issuecomment-948059041","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3334","id":948059041,"node_id":"IC_kwDOCW7NX844gjuh","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T21:44:26Z","updated_at":"2021-10-20T21:44:26Z","author_association":"MEMBER","body":"@samredai Since you are looking into docs I thought you may want to take a look at this PR","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948059041/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948070726","html_url":"https://github.com/apache/iceberg/pull/3320#issuecomment-948070726","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3320","id":948070726,"node_id":"IC_kwDOCW7NX844gmlG","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-20T22:01:39Z","updated_at":"2021-10-20T22:01:39Z","author_association":"CONTRIBUTOR","body":"Closing in favor of #3332.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948070726/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948149877","html_url":"https://github.com/apache/iceberg/pull/3333#issuecomment-948149877","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3333","id":948149877,"node_id":"IC_kwDOCW7NX844g551","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T01:00:32Z","updated_at":"2021-10-21T01:00:32Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948149877/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948163948","html_url":"https://github.com/apache/iceberg/pull/3331#issuecomment-948163948","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3331","id":948163948,"node_id":"IC_kwDOCW7NX844g9Vs","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T01:15:05Z","updated_at":"2021-10-21T01:15:05Z","author_association":"CONTRIBUTOR","body":"This looks mostly good to me. The only question is the removed constructor in `Metrics` that wasn't deprecated.\r\n\r\nAlso, we missed a few methods in `HadoopCatalog` and `HiveCatalog`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948163948/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948167788","html_url":"https://github.com/apache/iceberg/pull/3331#issuecomment-948167788","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3331","id":948167788,"node_id":"IC_kwDOCW7NX844g-Rs","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T01:17:03Z","updated_at":"2021-10-21T01:17:03Z","author_association":"CONTRIBUTOR","body":"We should also cover `OutputFileFactory`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948167788/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948172999","html_url":"https://github.com/apache/iceberg/pull/3333#issuecomment-948172999","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3333","id":948172999,"node_id":"IC_kwDOCW7NX844g_jH","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T01:20:00Z","updated_at":"2021-10-21T01:20:00Z","author_association":"CONTRIBUTOR","body":"Of course! Happy to help keep dev time as productive as possible whenever\npossible :)\n\nOn Wed, Oct 20, 2021 at 6:00 PM Anton Okolnychyi ***@***.***>\nwrote:\n\n> Thanks, @kbendick <https://github.com/kbendick>!\n>\n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/iceberg/pull/3333#issuecomment-948149877>, or\n> unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/ACLAXETSKW53WKFXBQZNMNTUH5Q3ZANCNFSM5GMTXYUA>\n> .\n> Triage notifications on the go with GitHub Mobile for iOS\n> <https://apps.apple.com/app/apple-store/id1477376905?ct=notification-email&mt=8&pt=524675>\n> or Android\n> <https://play.google.com/store/apps/details?id=com.github.android&referrer=utm_campaign%3Dnotification-email%26utm_medium%3Demail%26utm_source%3Dgithub>.\n>\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948172999/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948183868","html_url":"https://github.com/apache/iceberg/pull/3276#issuecomment-948183868","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3276","id":948183868,"node_id":"IC_kwDOCW7NX844hCM8","user":{"login":"velctor","id":39006258,"node_id":"MDQ6VXNlcjM5MDA2MjU4","avatar_url":"https://avatars.githubusercontent.com/u/39006258?v=4","gravatar_id":"","url":"https://api.github.com/users/velctor","html_url":"https://github.com/velctor","followers_url":"https://api.github.com/users/velctor/followers","following_url":"https://api.github.com/users/velctor/following{/other_user}","gists_url":"https://api.github.com/users/velctor/gists{/gist_id}","starred_url":"https://api.github.com/users/velctor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/velctor/subscriptions","organizations_url":"https://api.github.com/users/velctor/orgs","repos_url":"https://api.github.com/users/velctor/repos","events_url":"https://api.github.com/users/velctor/events{/privacy}","received_events_url":"https://api.github.com/users/velctor/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T01:51:15Z","updated_at":"2021-10-21T02:09:47Z","author_association":"NONE","body":"> @velctor, why do you think that the stream was closed by the finalizer and not by a normal call to `close`?\r\n\r\nIn order to determine that the stream closed by the `Finalizer thread` is the same as the stream in the error log, I add \r\nsome informations to the log and recompile the relevant jar package. The final log is as follows:\r\n```\r\n2021-*-*T14:47:43.211+0800\tDEBUG\t20210927_064723_00001_ajsi3.1.0-13-103\torg.apache.hadoop.fs.FileSystem\tBypassing cache to create filesystem ***00000-1-b5ccab76-0db2-4f2e-887f-f70b9833cb91-00227.parquet\r\n2021-*-*T14:47:43.381+0800\tDEBUG\tFinalizer\torg.apache.hadoop.hdfs.DFSClient\tclose DFSInputStream ***00000-1-b5ccab76-0db2-4f2e-887f-f70b9833cb91-00227.parquet  thread name:Finalizer  client:DFSClient_NONMAPREDUCE_373867554_103\r\n2021-*-*T14:47:43.382+0800\tDEBUG\t20210927_064723_00001_ajsi3.1.0-13-103\torg.apache.hadoop.hdfs.DFSClient\tDFSInputStream has been closed already ***00000-1-b5ccab76-0db2-4f2e-887f-f70b9833cb91-00227.parquet  thread name:20210927_064723_00001_ajsi3.1.0-13-103  client:DFSClient_NONMAPREDUCE_373867554_103\r\norg.apache.iceberg.exceptions.RuntimeIOException: Failed to open Parquet file: ***00000-1-b5ccab76-0db2-4f2e-887f-f70b9833cb91-00227.parquet, thread name: 20210927_064723_00001_ajsi3.1.0-13-103\r\n```\r\nFrom the `client: DFSClient_NONMAPREDUCE_373867554_103` field in the newly added log, it can be seen that the  file stream is indeed closed by the `Finalizer thread`.\r\n\r\nIn addition, when I applied the changes in this PR to iceberg, no related errors were reported after testing.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948183868/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948196321","html_url":"https://github.com/apache/iceberg/pull/3317#issuecomment-948196321","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3317","id":948196321,"node_id":"IC_kwDOCW7NX844hFPh","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T02:22:04Z","updated_at":"2021-10-21T02:22:04Z","author_association":"MEMBER","body":"I'll finish reviewing this tomorrow, got a bit busy :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948196321/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948196450","html_url":"https://github.com/apache/iceberg/pull/3334#issuecomment-948196450","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3334","id":948196450,"node_id":"IC_kwDOCW7NX844hFRi","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T02:22:26Z","updated_at":"2021-10-21T02:22:26Z","author_association":"MEMBER","body":"Thanks for all the feedback, I'll do my best to make the updates tomorrow","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948196450/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948205966","html_url":"https://github.com/apache/iceberg/pull/3317#issuecomment-948205966","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3317","id":948205966,"node_id":"IC_kwDOCW7NX844hHmO","user":{"login":"KnightChess","id":20125927,"node_id":"MDQ6VXNlcjIwMTI1OTI3","avatar_url":"https://avatars.githubusercontent.com/u/20125927?v=4","gravatar_id":"","url":"https://api.github.com/users/KnightChess","html_url":"https://github.com/KnightChess","followers_url":"https://api.github.com/users/KnightChess/followers","following_url":"https://api.github.com/users/KnightChess/following{/other_user}","gists_url":"https://api.github.com/users/KnightChess/gists{/gist_id}","starred_url":"https://api.github.com/users/KnightChess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KnightChess/subscriptions","organizations_url":"https://api.github.com/users/KnightChess/orgs","repos_url":"https://api.github.com/users/KnightChess/repos","events_url":"https://api.github.com/users/KnightChess/events{/privacy}","received_events_url":"https://api.github.com/users/KnightChess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T02:48:41Z","updated_at":"2021-10-21T02:48:41Z","author_association":"CONTRIBUTOR","body":"\r\n> I'll finish reviewing this tomorrow, got a bit busy :)\r\n\r\nhard :)\r\n\r\nupdate result, just like\r\n+-------------------+-----------------+\r\n|             snapshot_id|             timestamp|\r\n+-------------------+-----------------+\r\n|    90264174669670|  1634728573122|\r\n|    86396130075686|1634726568462|\r\n+-------------------+-----------------+\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948205966/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948217194","html_url":"https://github.com/apache/iceberg/pull/2844#issuecomment-948217194","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2844","id":948217194,"node_id":"IC_kwDOCW7NX844hKVq","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T03:06:37Z","updated_at":"2021-10-21T03:06:37Z","author_association":"COLLABORATOR","body":"I think this may not necessary anymore because of #3099, what do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948217194/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948219131","html_url":"https://github.com/apache/iceberg/issues/3327#issuecomment-948219131","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3327","id":948219131,"node_id":"IC_kwDOCW7NX844hKz7","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T03:08:41Z","updated_at":"2021-10-21T03:08:41Z","author_association":"MEMBER","body":"You can find demo from [TestNewRewriteDataFilesAction](https://github.com/apache/iceberg/blob/119d20d22e66655bce1590041e4ba25ae48874fb/spark/v3.0/spark3/src/test/java/org/apache/iceberg/spark/actions/TestNewRewriteDataFilesAction.java)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948219131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948230654","html_url":"https://github.com/apache/iceberg/pull/2844#issuecomment-948230654","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2844","id":948230654,"node_id":"IC_kwDOCW7NX844hNn-","user":{"login":"dengzhhu653","id":4394480,"node_id":"MDQ6VXNlcjQzOTQ0ODA=","avatar_url":"https://avatars.githubusercontent.com/u/4394480?v=4","gravatar_id":"","url":"https://api.github.com/users/dengzhhu653","html_url":"https://github.com/dengzhhu653","followers_url":"https://api.github.com/users/dengzhhu653/followers","following_url":"https://api.github.com/users/dengzhhu653/following{/other_user}","gists_url":"https://api.github.com/users/dengzhhu653/gists{/gist_id}","starred_url":"https://api.github.com/users/dengzhhu653/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dengzhhu653/subscriptions","organizations_url":"https://api.github.com/users/dengzhhu653/orgs","repos_url":"https://api.github.com/users/dengzhhu653/repos","events_url":"https://api.github.com/users/dengzhhu653/events{/privacy}","received_events_url":"https://api.github.com/users/dengzhhu653/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T03:40:43Z","updated_at":"2021-10-21T03:40:43Z","author_association":"MEMBER","body":"> I think this may not necessary anymore because of #3099, what do you think?\r\n\r\nyeap, it's much better to use the proxy client for retrying, thank you for the feedback and comment.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948230654/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948236687","html_url":"https://github.com/apache/iceberg/pull/3240#issuecomment-948236687","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3240","id":948236687,"node_id":"IC_kwDOCW7NX844hPGP","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T03:59:52Z","updated_at":"2021-10-21T03:59:52Z","author_association":"CONTRIBUTOR","body":"@rdblue @kbendick @openinx @stevenzwu Could you take a look of this again? 😄 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948236687/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948238409","html_url":"https://github.com/apache/iceberg/pull/2898#issuecomment-948238409","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2898","id":948238409,"node_id":"IC_kwDOCW7NX844hPhJ","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T04:04:01Z","updated_at":"2021-10-21T04:04:01Z","author_association":"CONTRIBUTOR","body":"@openinx @stevenzwu @kbendick Do you have another other concerns for this PR? Maybe we could merge this PR to fix this problem. 😄 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948238409/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948272261","html_url":"https://github.com/apache/iceberg/pull/3234#issuecomment-948272261","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3234","id":948272261,"node_id":"IC_kwDOCW7NX844hXyF","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T05:33:20Z","updated_at":"2021-10-21T05:33:20Z","author_association":"COLLABORATOR","body":"@rdblue @pdames @samredai I updated the PR and added tests. Can you take another look? Thanks.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948272261/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948274818","html_url":"https://github.com/apache/iceberg/issues/3277#issuecomment-948274818","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3277","id":948274818,"node_id":"IC_kwDOCW7NX844hYaC","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T05:40:25Z","updated_at":"2021-10-21T05:41:36Z","author_association":"CONTRIBUTOR","body":"@tuziling Currently Iceberg have not support incrementally read v2 table yet. There has a [patch](https://github.com/apache/iceberg/pull/3095) trying to support this feature, maybe that can help you. 😄 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948274818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948292263","html_url":"https://github.com/apache/iceberg/issues/2194#issuecomment-948292263","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2194","id":948292263,"node_id":"IC_kwDOCW7NX844hcqn","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T06:16:57Z","updated_at":"2021-10-21T06:16:57Z","author_association":"COLLABORATOR","body":"Yes, we are working on it now. The progress is tracked at https://github.com/apache/iceberg/projects/7.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948292263/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948360518","html_url":"https://github.com/apache/iceberg/pull/3338#issuecomment-948360518","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3338","id":948360518,"node_id":"IC_kwDOCW7NX844htVG","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T08:03:38Z","updated_at":"2021-10-21T08:03:38Z","author_association":"CONTRIBUTOR","body":"CC: @jackye1995, @marton-bod ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948360518/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948385754","html_url":"https://github.com/apache/iceberg/issues/3157#issuecomment-948385754","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3157","id":948385754,"node_id":"IC_kwDOCW7NX844hzfa","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T08:36:23Z","updated_at":"2021-10-21T08:36:23Z","author_association":"CONTRIBUTOR","body":"I can confirm that this is now fixed by #3329. I did a benchmark run [here](https://github.com/nastra/iceberg/actions/runs/1366744441) and it passes now :yay: ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948385754/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948386260","html_url":"https://github.com/apache/iceberg/pull/3329#issuecomment-948386260","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3329","id":948386260,"node_id":"IC_kwDOCW7NX844hznU","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T08:37:01Z","updated_at":"2021-10-21T08:37:01Z","author_association":"CONTRIBUTOR","body":"fixes #3157 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948386260/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948406775","html_url":"https://github.com/apache/iceberg/pull/3326#issuecomment-948406775","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3326","id":948406775,"node_id":"IC_kwDOCW7NX844h4n3","user":{"login":"harshm-dev","id":57615655,"node_id":"MDQ6VXNlcjU3NjE1NjU1","avatar_url":"https://avatars.githubusercontent.com/u/57615655?v=4","gravatar_id":"","url":"https://api.github.com/users/harshm-dev","html_url":"https://github.com/harshm-dev","followers_url":"https://api.github.com/users/harshm-dev/followers","following_url":"https://api.github.com/users/harshm-dev/following{/other_user}","gists_url":"https://api.github.com/users/harshm-dev/gists{/gist_id}","starred_url":"https://api.github.com/users/harshm-dev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/harshm-dev/subscriptions","organizations_url":"https://api.github.com/users/harshm-dev/orgs","repos_url":"https://api.github.com/users/harshm-dev/repos","events_url":"https://api.github.com/users/harshm-dev/events{/privacy}","received_events_url":"https://api.github.com/users/harshm-dev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T09:02:45Z","updated_at":"2021-10-21T09:10:05Z","author_association":"CONTRIBUTOR","body":"@kbendick Thanks for review! Really appreciate it. \r\n\r\n> See how both type and catalog-type are set? Can we please consider another term? Additionally, this definitely needs to go into the Flink docs as well. And likely the spec as well given how large of a change it is. I'm not one to use Request changes, but could you please ensure this works with Flink or just change the term name from type? I think it's going to cause a lot of headaches, even if it seems like the most appropriate name. It's already taken essentially.🙁\r\n\r\n[harsh] 'type' is an existing configuration for spark/hive. So, not introducing a new conf - https://iceberg.apache.org/spark-configuration/#catalog-configuration , previously defined in the code [[here](https://github.com/apache/iceberg/blob/119d20d22e66655bce1590041e4ba25ae48874fb/core/src/main/java/org/apache/iceberg/CatalogUtil.java#L58)]\r\nThis change is unlikely to impact Flink, because it's in a different code path. I'm planning to make a similar change in FlinkCatalogFactory in a different PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948406775/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948458848","html_url":"https://github.com/apache/iceberg/issues/3299#issuecomment-948458848","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3299","id":948458848,"node_id":"IC_kwDOCW7NX844iFVg","user":{"login":"ashoksri0","id":14317595,"node_id":"MDQ6VXNlcjE0MzE3NTk1","avatar_url":"https://avatars.githubusercontent.com/u/14317595?v=4","gravatar_id":"","url":"https://api.github.com/users/ashoksri0","html_url":"https://github.com/ashoksri0","followers_url":"https://api.github.com/users/ashoksri0/followers","following_url":"https://api.github.com/users/ashoksri0/following{/other_user}","gists_url":"https://api.github.com/users/ashoksri0/gists{/gist_id}","starred_url":"https://api.github.com/users/ashoksri0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashoksri0/subscriptions","organizations_url":"https://api.github.com/users/ashoksri0/orgs","repos_url":"https://api.github.com/users/ashoksri0/repos","events_url":"https://api.github.com/users/ashoksri0/events{/privacy}","received_events_url":"https://api.github.com/users/ashoksri0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T10:08:55Z","updated_at":"2021-10-21T10:08:55Z","author_association":"NONE","body":"by the above method everything working fine hence i close this issue thanks for the support","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948458848/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948522723","html_url":"https://github.com/apache/iceberg/pull/3328#issuecomment-948522723","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3328","id":948522723,"node_id":"IC_kwDOCW7NX844iU7j","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T11:34:31Z","updated_at":"2021-10-21T11:34:31Z","author_association":"CONTRIBUTOR","body":"I am not sure about the Hive 2.3, and 3.1, but we did this in Hive upstream to get stats:\r\n- https://issues.apache.org/jira/browse/HIVE-24928\r\n- https://issues.apache.org/jira/browse/HIVE-25276\r\n- https://issues.apache.org/jira/browse/HIVE-25286","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948522723/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948647856","html_url":"https://github.com/apache/iceberg/pull/3040#issuecomment-948647856","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3040","id":948647856,"node_id":"IC_kwDOCW7NX844izew","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T14:00:59Z","updated_at":"2021-10-21T14:00:59Z","author_association":"CONTRIBUTOR","body":"@rdblue @RussellSpitzer  I rebased the branch and ran benchmarks with the stuff from https://github.com/apache/iceberg/pull/3304. Updated PR description with the results from the relevant benchmarks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948647856/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948675715","html_url":"https://github.com/apache/iceberg/pull/3304#issuecomment-948675715","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3304","id":948675715,"node_id":"IC_kwDOCW7NX844i6SD","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T14:29:26Z","updated_at":"2021-10-21T14:29:26Z","author_association":"CONTRIBUTOR","body":"> My biggest concern is that the benchmarks can take a while to run and the stability of the GH Action hosted runners is somewhat unknown (in regards to variability in performance runs)\r\n\r\n@kbendick I agree and I share the same concern. However, I think it it still better to have a hosted way of running benchmarks, rather than having people to run them locally as the variability in performance will be equally bad, since you most likely will be still doing dev work while you run benchmarks locally.\r\n\r\nOne solution to that problem would be some dedicated GH runners with better CPUs and more memory. Would be interesting to know if that's possible to get from Apache INFRA","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948675715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948812772","html_url":"https://github.com/apache/iceberg/issues/3342#issuecomment-948812772","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3342","id":948812772,"node_id":"IC_kwDOCW7NX844jbvk","user":{"login":"ismailsimsek","id":6005685,"node_id":"MDQ6VXNlcjYwMDU2ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6005685?v=4","gravatar_id":"","url":"https://api.github.com/users/ismailsimsek","html_url":"https://github.com/ismailsimsek","followers_url":"https://api.github.com/users/ismailsimsek/followers","following_url":"https://api.github.com/users/ismailsimsek/following{/other_user}","gists_url":"https://api.github.com/users/ismailsimsek/gists{/gist_id}","starred_url":"https://api.github.com/users/ismailsimsek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ismailsimsek/subscriptions","organizations_url":"https://api.github.com/users/ismailsimsek/orgs","repos_url":"https://api.github.com/users/ismailsimsek/repos","events_url":"https://api.github.com/users/ismailsimsek/events{/privacy}","received_events_url":"https://api.github.com/users/ismailsimsek/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T17:01:35Z","updated_at":"2021-10-21T21:19:14Z","author_association":"CONTRIBUTOR","body":"@ashoksri0 i was experimenting with it, you can see example code here\r\n\r\nhttps://github.com/ismailsimsek/iceberg-examples/blob/master/src/main/java/IcebergJavaApiUpsert.java#L99","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948812772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948850563","html_url":"https://github.com/apache/iceberg/pull/3338#issuecomment-948850563","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3338","id":948850563,"node_id":"IC_kwDOCW7NX844jk-D","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T17:31:40Z","updated_at":"2021-10-21T17:31:40Z","author_association":"CONTRIBUTOR","body":"Hi @pvary. On the mailing list, when you said:\r\n> This breaks Hive queries, if no catalog is set, but this still needs to be reviewed before merge. \r\n\r\nDid you mean that this patch _will_ break hive queries if not catalog is set after it's applied, or does it fix hive queries breaking if no catalog is set?\r\n\r\nThanks as always for your contributions 🙂 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948850563/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948880260","html_url":"https://github.com/apache/iceberg/pull/3334#issuecomment-948880260","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3334","id":948880260,"node_id":"IC_kwDOCW7NX844jsOE","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T18:12:13Z","updated_at":"2021-10-21T18:12:13Z","author_association":"MEMBER","body":"Updates made, Thanks for the review @kbendrick + @szehon-ho + @viniolivieri ! Of course if you have more comments feel free to just raise some more PR's :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948880260/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948882251","html_url":"https://github.com/apache/iceberg/pull/3338#issuecomment-948882251","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3338","id":948882251,"node_id":"IC_kwDOCW7NX844jstL","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T18:14:45Z","updated_at":"2021-10-21T18:14:45Z","author_association":"CONTRIBUTOR","body":"> Did you mean that this patch _will_ break hive queries if not catalog is set after it's applied, or does it fix hive queries breaking if no catalog is set?\r\n\r\n@kbendick: My bad 😄 \r\nPorted #2565 to Hive, and the query tests started to break. In those tests we were not setting any catalogs, and the `getCatalog` returned a `HiveCatalog` but the `Catalogs.hiveCatalog` returned false. This is wrong, and also broke the tests, which started to fail when creating a table with `Table location not set` errors\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948882251/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948955948","html_url":"https://github.com/apache/iceberg/pull/3040#issuecomment-948955948","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3040","id":948955948,"node_id":"IC_kwDOCW7NX844j-ss","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T19:55:55Z","updated_at":"2021-10-21T19:55:55Z","author_association":"MEMBER","body":"![image](https://user-images.githubusercontent.com/413025/138346789-85ad7e70-13ff-4d3f-bcd4-211c62081f17.png)\r\n![image](https://user-images.githubusercontent.com/413025/138347816-c40321aa-4b6d-4ea8-aa81-c14fbcfd6008.png)\r\n\r\nLooks good to me","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948955948/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948958117","html_url":"https://github.com/apache/iceberg/pull/3040#issuecomment-948958117","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3040","id":948958117,"node_id":"IC_kwDOCW7NX844j_Ol","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T19:59:12Z","updated_at":"2021-10-21T19:59:12Z","author_association":"MEMBER","body":"Merged Thanks @nastra! Also thanks for getting benchmark's action working!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948958117/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948960615","html_url":"https://github.com/apache/iceberg/pull/3343#issuecomment-948960615","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3343","id":948960615,"node_id":"IC_kwDOCW7NX844j_1n","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T20:02:41Z","updated_at":"2021-10-21T20:02:41Z","author_association":"MEMBER","body":"Woop! Thanks @szehon-ho ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948960615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948963964","html_url":"https://github.com/apache/iceberg/pull/3040#issuecomment-948963964","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3040","id":948963964,"node_id":"IC_kwDOCW7NX844kAp8","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T20:07:23Z","updated_at":"2021-10-21T20:07:23Z","author_association":"CONTRIBUTOR","body":"Yes, thank you @nastra! Great to see this go in.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948963964/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948966157","html_url":"https://github.com/apache/iceberg/pull/1508#issuecomment-948966157","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1508","id":948966157,"node_id":"IC_kwDOCW7NX844kBMN","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T20:10:23Z","updated_at":"2021-10-21T20:10:23Z","author_association":"CONTRIBUTOR","body":"@rdblue are we gating changes to spark/v3.0 until v3.2 is added? If so, I can remove the v3.0 changes here. If you really want, I can remove the fix for `TestIcebergSourceHiveTables` altogether and submit a separate PR for it after the dust settles on the Spark 3 reorg. I'd really like this change to go in sooner than later.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948966157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948983140","html_url":"https://github.com/apache/iceberg/pull/3292#issuecomment-948983140","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3292","id":948983140,"node_id":"IC_kwDOCW7NX844kFVk","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T20:34:57Z","updated_at":"2021-10-21T20:34:57Z","author_association":"MEMBER","body":"@rdblue fixed up and rebased","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948983140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948988732","html_url":"https://github.com/apache/iceberg/pull/3339#issuecomment-948988732","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3339","id":948988732,"node_id":"IC_kwDOCW7NX844kGs8","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T20:43:53Z","updated_at":"2021-10-21T20:43:53Z","author_association":"CONTRIBUTOR","body":"Awesome, thanks @ismailsimsek!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/948988732/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949002485","html_url":"https://github.com/apache/iceberg/pull/3331#issuecomment-949002485","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3331","id":949002485,"node_id":"IC_kwDOCW7NX844kKD1","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T21:05:47Z","updated_at":"2021-10-21T21:05:47Z","author_association":"CONTRIBUTOR","body":"Thanks @aokolnychyi for the review. I will remove the deprecated methods in 0.13 in a follow-up PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949002485/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949003346","html_url":"https://github.com/apache/iceberg/pull/3331#issuecomment-949003346","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3331","id":949003346,"node_id":"IC_kwDOCW7NX844kKRS","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T21:06:59Z","updated_at":"2021-10-21T21:06:59Z","author_association":"MEMBER","body":"@flyrain While we are at it you may want to remove TestNewRewriteAction for Spark 2 since it is currently dead code","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949003346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949007874","html_url":"https://github.com/apache/iceberg/pull/3331#issuecomment-949007874","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3331","id":949007874,"node_id":"IC_kwDOCW7NX844kLYC","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T21:13:36Z","updated_at":"2021-10-21T21:13:36Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer, we may remove TestNewRewriteAction in another PR since this one is for removing deprecated APIs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949007874/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949020334","html_url":"https://github.com/apache/iceberg/pull/3234#issuecomment-949020334","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3234","id":949020334,"node_id":"IC_kwDOCW7NX844kOau","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T21:33:33Z","updated_at":"2021-10-21T21:33:33Z","author_association":"CONTRIBUTOR","body":"Should we add the auto formatting stuff in this PR to prevent having to do a huge auto format later? (It's also fine to do in a follow up PR). I was thinking something like:\r\n\r\n```ini\r\n[testenv:format]\r\ndescription = reformat all source code\r\nbasepython = python3\r\ndeps =\r\n    black\r\n    isort\r\n    flake8\r\nskip_install = true\r\ncommands =\r\n    isort --recursive --project iceberg --profile black setup.py src tests\r\n    black setup.py src tests\r\n    flake8 setup.py src tests\r\n\r\n[testenv:linters]\r\nbasepython = python3\r\nskip_install = true\r\ndeps =\r\n    .\r\n    {[testenv:isort]deps}\r\n    {[testenv:black]deps}\r\n    {[testenv:flake8]deps}\r\n    {[testenv:bandit]deps}\r\n    {[testenv:mypy]deps}\r\ncommands =\r\n    {[testenv:isort]deps}\r\n    {[testenv:black]deps}\r\n    {[testenv:flake8]commands}\r\n    {[testenv:bandit]commands}\r\n    {[testenv:mypy]commands}\r\n\r\n[testenv:isort]\r\nbasepython = python3\r\nskip_install = true\r\ndeps =\r\n    isort\r\ncommands =\r\n    isort --recursive --project iceberg --profile black --check-only setup.py src tests\r\n\r\n[testenv:black]\r\nbasepython = python3\r\nskip_install = true\r\ndeps =\r\n    black\r\ncommands =\r\n    black --check --diff src setup.py tests\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949020334/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949022326","html_url":"https://github.com/apache/iceberg/pull/3341#issuecomment-949022326","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3341","id":949022326,"node_id":"IC_kwDOCW7NX844kO52","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T21:36:47Z","updated_at":"2021-10-21T21:36:47Z","author_association":"CONTRIBUTOR","body":"Linking the issue here for others to see: https://github.com/apache/iceberg/issues/3340","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949022326/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949050782","html_url":"https://github.com/apache/iceberg/pull/3234#issuecomment-949050782","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3234","id":949050782,"node_id":"IC_kwDOCW7NX844kV2e","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T22:31:16Z","updated_at":"2021-10-21T22:31:16Z","author_association":"CONTRIBUTOR","body":"@samredai, if we can format the code here, let's do that. But I wouldn't say let's update the config for formatting, since that's a separate change.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949050782/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949053902","html_url":"https://github.com/apache/iceberg/pull/3234#issuecomment-949053902","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3234","id":949053902,"node_id":"IC_kwDOCW7NX844kWnO","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T22:38:38Z","updated_at":"2021-10-21T22:38:38Z","author_association":"CONTRIBUTOR","body":"Nice work, @jun-he! There are only nits left, so I'm going to commit this to keep it moving. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949053902/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949055449","html_url":"https://github.com/apache/iceberg/pull/3015#issuecomment-949055449","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3015","id":949055449,"node_id":"IC_kwDOCW7NX844kW_Z","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T22:42:31Z","updated_at":"2021-10-21T22:42:31Z","author_association":"CONTRIBUTOR","body":"Looks like there's a checkstyle failure:\r\n```\r\n[ERROR] /home/runner/work/iceberg/iceberg/spark/v3.0/spark3/src/test/java/org/apache/iceberg/spark/source/TestIcebergSourceTablesBase.java:26:1: Extra separation in import group before 'org.apache.avro.generic.GenericData' [ImportOrder]\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949055449/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949055493","html_url":"https://github.com/apache/iceberg/pull/3335#issuecomment-949055493","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3335","id":949055493,"node_id":"IC_kwDOCW7NX844kXAF","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T22:42:38Z","updated_at":"2021-10-21T22:43:26Z","author_association":"CONTRIBUTOR","body":"Can we please keep the subdirectory naming the same? i.e.,\r\n```\r\nspark/\r\n  v3.0/\r\n    spark3/\r\n    spark3-extensions/\r\n    spark3-runtime/\r\n  v3.2/\r\n    spark3/\r\n    spark3-extensions/\r\n    spark3-runtime/\r\n```\r\nThe project names can be different (`:iceberg-spark:iceberg-spark3` and `:iceberg-spark:iceberg-spark32`, etc).\r\nIt'd be simpler to port as well as to diff code between Spark 3 versions.\r\n(For consistency, I also prefer `:iceberg-spark:iceberg-spark32`, `:iceberg-spark:iceberg-spark32-extensions` and `:iceberg-spark:iceberg-spark32-runtime` to `:iceberg-spark:iceberg-spark-32`, `:iceberg-spark:iceberg-spark-32-extensions` and `:iceberg-spark:iceberg-spark-32-runtime`, but that's a minor suggestion.)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949055493/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949059261","html_url":"https://github.com/apache/iceberg/pull/3015#issuecomment-949059261","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3015","id":949059261,"node_id":"IC_kwDOCW7NX844kX69","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T22:51:44Z","updated_at":"2021-10-21T22:51:44Z","author_association":"COLLABORATOR","body":"Yea beat me to it, just fixed :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949059261/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949074817","html_url":"https://github.com/apache/iceberg/pull/1508#issuecomment-949074817","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1508","id":949074817,"node_id":"IC_kwDOCW7NX844kbuB","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T23:24:41Z","updated_at":"2021-10-21T23:24:41Z","author_association":"CONTRIBUTOR","body":"Thanks @wypoon! Looks great.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949074817/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949077021","html_url":"https://github.com/apache/iceberg/pull/3331#issuecomment-949077021","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3331","id":949077021,"node_id":"IC_kwDOCW7NX844kcQd","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T23:30:24Z","updated_at":"2021-10-21T23:30:24Z","author_association":"CONTRIBUTOR","body":"Thanks, @flyrain!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949077021/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949084295","html_url":"https://github.com/apache/iceberg/pull/3317#issuecomment-949084295","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3317","id":949084295,"node_id":"IC_kwDOCW7NX844keCH","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-21T23:52:15Z","updated_at":"2021-10-21T23:52:15Z","author_association":"MEMBER","body":"This all looks good to me, I think if we fix up some of those performance nits we can merge this in. My only thought would be also doing the doc changes at the same time but I think we can put that off to another pr.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949084295/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949096834","html_url":"https://github.com/apache/iceberg/pull/3015#issuecomment-949096834","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3015","id":949096834,"node_id":"IC_kwDOCW7NX844khGC","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-22T00:19:46Z","updated_at":"2021-10-22T00:19:46Z","author_association":"COLLABORATOR","body":"rebased the patch, @RussellSpitzer @rdblue can you see if this patch is ok  ?  \r\n\r\nThere's a break in the schema order based on the review comment to co-locate it with partition field, but on other hand metadata tables are not yet documented: ref: https://github.com/apache/iceberg/pull/3159","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949096834/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949113384","html_url":"https://github.com/apache/iceberg/pull/3335#issuecomment-949113384","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3335","id":949113384,"node_id":"IC_kwDOCW7NX844klIo","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-22T00:37:33Z","updated_at":"2021-10-22T00:37:33Z","author_association":"CONTRIBUTOR","body":"I created #3345 simply to enable easier visualization of the diff between the v3.0 code and the v3.2 code. Changes in the build are not reflected (the build change in #3345 is just a quick hack to enable building v3.0 against Spark 3.2).\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949113384/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949152880","html_url":"https://github.com/apache/iceberg/pull/3275#issuecomment-949152880","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3275","id":949152880,"node_id":"IC_kwDOCW7NX844kuxw","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-22T01:12:59Z","updated_at":"2021-10-22T01:21:24Z","author_association":"CONTRIBUTOR","body":"@rdblue added the changes we discussed.\r\n1. Made a properties table \r\n2. Updated namespaceExists to the original behavior - I don't see the strictness being needed at the moment.\r\n\r\nQuestion:\r\n1. Should I handle namespace properties (set and get) and dropNamespace in this PR or open a separate PR for it?\r\n2. Also, some of the workflows don't seem to be triggering, how does one run tests on PRs?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949152880/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949163005","html_url":"https://github.com/apache/iceberg/pull/3307#issuecomment-949163005","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3307","id":949163005,"node_id":"IC_kwDOCW7NX844kxP9","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-22T01:21:44Z","updated_at":"2021-10-22T01:23:35Z","author_association":"COLLABORATOR","body":"@stevenzwu i think @openinx 's theory makes sense, when you merge manifest files on commit, I believe the entries for [data-file-1, data-file-2, data-file-3] has status: EXISTING, whereas new data files like [data-file-4], [data-file-5], [data-file-6] are ADDED.\r\n\r\nMy original thought was along this line when I made https://github.com/apache/iceberg/pull/2989, but missed that it was merging the manifest.\r\n\r\nI was looking to see if we can adapt that code to take this into account, but realize ManifestEntry is not public class , like DataFile.  There's no way to get whether a data-file is EXISTING or ADDED.  Though entries table is exposed via Spark.  Do you think we can expose it or maybe I'm missing another way to get this information.  @rdblue  any thoughts  ?  Thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949163005/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949182648","html_url":"https://github.com/apache/iceberg/pull/3317#issuecomment-949182648","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3317","id":949182648,"node_id":"IC_kwDOCW7NX844k2C4","user":{"login":"KnightChess","id":20125927,"node_id":"MDQ6VXNlcjIwMTI1OTI3","avatar_url":"https://avatars.githubusercontent.com/u/20125927?v=4","gravatar_id":"","url":"https://api.github.com/users/KnightChess","html_url":"https://github.com/KnightChess","followers_url":"https://api.github.com/users/KnightChess/followers","following_url":"https://api.github.com/users/KnightChess/following{/other_user}","gists_url":"https://api.github.com/users/KnightChess/gists{/gist_id}","starred_url":"https://api.github.com/users/KnightChess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KnightChess/subscriptions","organizations_url":"https://api.github.com/users/KnightChess/orgs","repos_url":"https://api.github.com/users/KnightChess/repos","events_url":"https://api.github.com/users/KnightChess/events{/privacy}","received_events_url":"https://api.github.com/users/KnightChess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-22T01:38:55Z","updated_at":"2021-10-22T01:38:55Z","author_association":"CONTRIBUTOR","body":"> This all looks good to me, I think if we fix up some of those performance nits we can merge this in. My only thought would be also doing the doc changes at the same time but I think we can put that off to another pr.\r\n\r\ntks for checking, I have fixed it, and I will update the doc in other pr. :) ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949182648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949214229","html_url":"https://github.com/apache/iceberg/issues/3228#issuecomment-949214229","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3228","id":949214229,"node_id":"IC_kwDOCW7NX844k9wV","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-22T02:06:27Z","updated_at":"2021-10-22T02:06:27Z","author_association":"CONTRIBUTOR","body":"Thanks @jun-he  for starting off the work on python with https://github.com/apache/iceberg/pull/3234. I'll use this to open a PR for the partition_spec.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949214229/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949243671","html_url":"https://github.com/apache/iceberg/issues/3346#issuecomment-949243671","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3346","id":949243671,"node_id":"IC_kwDOCW7NX844lE8X","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-22T02:51:12Z","updated_at":"2021-10-22T02:51:12Z","author_association":"MEMBER","body":"What version of spark are you running. We test with spark 3.0, 3.1, and 2.4.7￼ (different runtime jar) \n\n3.2 is in progress ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949243671/reactions","total_count":3,"+1":1,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949245250","html_url":"https://github.com/apache/iceberg/issues/3346#issuecomment-949245250","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3346","id":949245250,"node_id":"IC_kwDOCW7NX844lFVC","user":{"login":"cvasani","id":1733507,"node_id":"MDQ6VXNlcjE3MzM1MDc=","avatar_url":"https://avatars.githubusercontent.com/u/1733507?v=4","gravatar_id":"","url":"https://api.github.com/users/cvasani","html_url":"https://github.com/cvasani","followers_url":"https://api.github.com/users/cvasani/followers","following_url":"https://api.github.com/users/cvasani/following{/other_user}","gists_url":"https://api.github.com/users/cvasani/gists{/gist_id}","starred_url":"https://api.github.com/users/cvasani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cvasani/subscriptions","organizations_url":"https://api.github.com/users/cvasani/orgs","repos_url":"https://api.github.com/users/cvasani/repos","events_url":"https://api.github.com/users/cvasani/events{/privacy}","received_events_url":"https://api.github.com/users/cvasani/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-22T02:55:49Z","updated_at":"2021-10-22T02:55:49Z","author_association":"NONE","body":"> What version of spark are you running. We test with spark 3.0, 3.1, and 2.4.7￼ (different runtime jar)\r\n> \r\n> 3.2 is in progress\r\n\r\nI am using spark 3.2. Thank you . let me test with 3.1. Could you please help me find documentation link for certification matrix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/949245250/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]