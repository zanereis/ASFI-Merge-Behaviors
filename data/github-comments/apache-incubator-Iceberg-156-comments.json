[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069169829","html_url":"https://github.com/apache/iceberg/pull/4296#issuecomment-1069169829","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4296","id":1069169829,"node_id":"IC_kwDOCW7NX84_ujyl","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T14:07:42Z","updated_at":"2022-03-16T14:07:42Z","author_association":"MEMBER","body":"Thanks @felixYyu and @nastra !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069169829/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069261267","html_url":"https://github.com/apache/iceberg/pull/4294#issuecomment-1069261267","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4294","id":1069261267,"node_id":"IC_kwDOCW7NX84_u6HT","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T15:31:12Z","updated_at":"2022-03-16T15:31:12Z","author_association":"CONTRIBUTOR","body":"Thanks, @amogh-jahagirdar!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069261267/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069271146","html_url":"https://github.com/apache/iceberg/pull/4337#issuecomment-1069271146","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4337","id":1069271146,"node_id":"IC_kwDOCW7NX84_u8hq","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T15:40:12Z","updated_at":"2022-03-16T15:40:12Z","author_association":"CONTRIBUTOR","body":"> Will we differentiate between NamespaceDoesNotExist and TableDoesNotExist in the client or does it not matter? The catalog interface sort of implies it doesn't matter.\r\n\r\nIt doesn't matter. If the table did not exist for any reason, it should return false.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069271146/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069276549","html_url":"https://github.com/apache/iceberg/pull/4328#issuecomment-1069276549","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4328","id":1069276549,"node_id":"IC_kwDOCW7NX84_u92F","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T15:43:31Z","updated_at":"2022-03-16T15:43:31Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069276549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069277298","html_url":"https://github.com/apache/iceberg/pull/4345#issuecomment-1069277298","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4345","id":1069277298,"node_id":"IC_kwDOCW7NX84_u-By","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T15:44:08Z","updated_at":"2022-03-16T15:44:08Z","author_association":"CONTRIBUTOR","body":"Why remove `ParquetWriter`?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069277298/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069278703","html_url":"https://github.com/apache/iceberg/pull/4339#issuecomment-1069278703","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4339","id":1069278703,"node_id":"IC_kwDOCW7NX84_u-Xv","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T15:45:29Z","updated_at":"2022-03-16T15:45:29Z","author_association":"CONTRIBUTOR","body":"Thanks, @felixYyu!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069278703/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069281949","html_url":"https://github.com/apache/iceberg/pull/4341#issuecomment-1069281949","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4341","id":1069281949,"node_id":"IC_kwDOCW7NX84_u_Kd","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T15:48:48Z","updated_at":"2022-03-16T15:48:48Z","author_association":"CONTRIBUTOR","body":"Thanks, @yittg!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069281949/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069289902","html_url":"https://github.com/apache/iceberg/pull/4340#issuecomment-1069289902","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4340","id":1069289902,"node_id":"IC_kwDOCW7NX84_vBGu","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T15:56:09Z","updated_at":"2022-03-16T15:56:09Z","author_association":"CONTRIBUTOR","body":"I'm not sure that this is a good idea. We purposely don't run deletes in parallel in Spark.\r\n\r\n@jackye1995, what do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069289902/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069291663","html_url":"https://github.com/apache/iceberg/pull/4338#issuecomment-1069291663","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4338","id":1069291663,"node_id":"IC_kwDOCW7NX84_vBiP","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T15:57:55Z","updated_at":"2022-03-16T15:57:55Z","author_association":"CONTRIBUTOR","body":"@renshangtao, was this causing a problem in your environment? Won't the store get cleaned up by garbage collection?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069291663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069294185","html_url":"https://github.com/apache/iceberg/pull/4338#issuecomment-1069294185","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4338","id":1069294185,"node_id":"IC_kwDOCW7NX84_vCJp","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T16:00:36Z","updated_at":"2022-03-16T16:00:36Z","author_association":"CONTRIBUTOR","body":"Ah, looks like this eventually calls `CapacityByteArrayOutputStream.close`, which releases buffers back to the allocator. Looks like a good change to reduce memory consumption.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069294185/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069295623","html_url":"https://github.com/apache/iceberg/pull/4333#issuecomment-1069295623","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4333","id":1069295623,"node_id":"IC_kwDOCW7NX84_vCgH","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T16:02:03Z","updated_at":"2022-03-16T16:02:03Z","author_association":"CONTRIBUTOR","body":"I'm not clear on why this is needed. Can't Nessie run these tests with the vintage engine?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069295623/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069305175","html_url":"https://github.com/apache/iceberg/pull/4333#issuecomment-1069305175","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4333","id":1069305175,"node_id":"IC_kwDOCW7NX84_vE1X","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T16:12:06Z","updated_at":"2022-03-16T16:12:06Z","author_association":"CONTRIBUTOR","body":"> I'm not clear on why this is needed. Can't Nessie run these tests with the vintage engine?\r\n\r\nUnfortunately not. Nessie tests use Junit 5 extensions to bring up the nessie server for tests and so the tests themselves need to be actual Junit 5 tests","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069305175/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069389622","html_url":"https://github.com/apache/iceberg/issues/4346#issuecomment-1069389622","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4346","id":1069389622,"node_id":"IC_kwDOCW7NX84_vZc2","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T17:40:14Z","updated_at":"2022-03-16T17:40:14Z","author_association":"CONTRIBUTOR","body":"A few recent issues reported by the community: #4194, #4161. I know there were more issues and a few PRs too. Feel free to link anything that may be related.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069389622/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069404942","html_url":"https://github.com/apache/iceberg/pull/4280#issuecomment-1069404942","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4280","id":1069404942,"node_id":"IC_kwDOCW7NX84_vdMO","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T18:08:09Z","updated_at":"2022-03-16T18:08:09Z","author_association":"CONTRIBUTOR","body":"Synced offline, I think the following approach would work better and make the code cleaner in GlueCatalog:\r\n1. in Glue catalog, we only need the ability to determine if we need 1 FileIO per table, or a shared FileIO. The logic to determine this is currently controlled by `glue.lakeformation-enabled`, but can be extended later for some other use cases like write tags at table level.\r\n2. we need to pass in the table-related properties all the way down to S3FileIO and then to AwsClientFactories. There, we can initialize the `LakeFormationAwsClientFactory`\r\n3. in `LakeFormationAwsClientFactory`, when getting s3 client, we then ask Glue for lakeformation information to determine if a table is registered with it. If so, use `LakeFormationCredentialProvider`, otherwise use normal credential provider.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069404942/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069457384","html_url":"https://github.com/apache/iceberg/pull/4262#issuecomment-1069457384","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4262","id":1069457384,"node_id":"IC_kwDOCW7NX84_vp_o","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T18:43:53Z","updated_at":"2022-03-16T18:43:53Z","author_association":"CONTRIBUTOR","body":"Thank you @rdblue , I sent a new commit based on your review feedback, please let me know what do you think :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069457384/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069475469","html_url":"https://github.com/apache/iceberg/pull/4255#issuecomment-1069475469","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4255","id":1069475469,"node_id":"IC_kwDOCW7NX84_vuaN","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T18:52:50Z","updated_at":"2022-03-16T18:55:13Z","author_association":"COLLABORATOR","body":"Thanks, the link is fine with me if it works (did you double check it?)!  I added one more small rewording, then I think the change will be ok","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069475469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069484735","html_url":"https://github.com/apache/iceberg/issues/2326#issuecomment-1069484735","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2326","id":1069484735,"node_id":"IC_kwDOCW7NX84_vwq_","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T18:57:27Z","updated_at":"2022-03-16T18:57:27Z","author_association":"COLLABORATOR","body":"Closing as one fix was merged, can make a new one if more options open up","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069484735/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069541813","html_url":"https://github.com/apache/iceberg/pull/4338#issuecomment-1069541813","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4338","id":1069541813,"node_id":"IC_kwDOCW7NX84_v-m1","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T19:36:56Z","updated_at":"2022-03-16T19:36:56Z","author_association":"CONTRIBUTOR","body":"Thanks, @renshangtao!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069541813/reactions","total_count":1,"+1":0,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069561753","html_url":"https://github.com/apache/iceberg/issues/4346#issuecomment-1069561753","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4346","id":1069561753,"node_id":"IC_kwDOCW7NX84_wDeZ","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T20:01:17Z","updated_at":"2022-03-16T20:01:26Z","author_association":"CONTRIBUTOR","body":"One more point I forgot: I don't think we will be able to support symlinks. As far as I know, symlinks were never finished in HDFS and S3 does not support that either. Only local file system may hit this issue and I am not sure we should care about that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069561753/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069567047","html_url":"https://github.com/apache/iceberg/issues/4346#issuecomment-1069567047","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4346","id":1069567047,"node_id":"IC_kwDOCW7NX84_wExH","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T20:07:25Z","updated_at":"2022-03-16T20:07:25Z","author_association":"CONTRIBUTOR","body":"I think about this problem slightly differently. Rather than thinking about it as lacking normalization, the underlying file store may have multiple ways to refer to the same file. That's a bit more broad and covers the cases like schemes that mean the same thing (s3 and s3a) and authority issues.\r\n\r\nI think it's reasonable to have some way to normalize both sets of paths before comparing them. It is a little concerning to me that the proposal for doing that is to use Hadoop's path normalization and then optionally ignore certain parts. Delegating that to Hadoop doesn't seem like a good idea to me, but it is at least a start.\r\n\r\nI think we should also have strategies for this that depend on the file system scheme. s3 and s3a are essentially the same thing, but you can't ignore authority (bucket) for S3. HDFS may have different namenodes in the authority and whether they're equivalent depends on the Hadoop Configuration. I'd like to get more specific about the file systems that are supported and how each one will normalize and compare.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069567047/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069629988","html_url":"https://github.com/apache/iceberg/issues/4346#issuecomment-1069629988","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4346","id":1069629988,"node_id":"IC_kwDOCW7NX84_wUIk","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T21:03:12Z","updated_at":"2022-03-16T21:03:12Z","author_association":"CONTRIBUTOR","body":"> I think it's reasonable to have some way to normalize both sets of paths before comparing them. It is a little concerning to me that the proposal for doing that is to use Hadoop's path normalization and then optionally ignore certain parts. Delegating that to Hadoop doesn't seem like a good idea to me, but it is at least a start.\r\n\r\nThis is mainly because we use Hadoop `FileSystem` for listing. If we use proprietary logic to normalize paths, this may lead to handling edge cases differently. Normalization mostly solves cosmetic issues in the path part of URIs, it does not solve the scheme and authority mismatch.\r\n\r\nI am happy to consider alternatives. In the future, we can customize `DeleteOrphanFiles` so that listing via `FileSystem` just becomes one way to build a list of actual files. For now, using Hadoop for normalization when we are doing listing via Hadoop seems reasonable to me.\r\n\r\n> I think we should also have strategies for this that depend on the file system scheme. s3 and s3a are essentially the same thing, but you can't ignore authority (bucket) for S3. HDFS may have different namenodes in the authority and whether they're equivalent depends on the Hadoop Configuration. I'd like to get more specific about the file systems that are supported and how each one will normalize and compare.\r\n\r\nThis is when it gets tricky. Hadoop conf in jobs that write to the table can be different from Hadoop conf in jobs that delete orphan files. Users can define arbitrary schemes or use different yet equivalent authorities.\r\n\r\nMaybe, the default values for the ignore options can depend on the scheme of the location we clean. For example, if the location we scan for orphan files starts with `s3`, we can ignore the scheme but have to compare the authority and normalized path. We can discuss default values more but what about having `ignore-scheme` and `ignore-authority` in general? Do we consider that useful?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069629988/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069734908","html_url":"https://github.com/apache/iceberg/pull/4349#issuecomment-1069734908","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4349","id":1069734908,"node_id":"IC_kwDOCW7NX84_wtv8","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T23:18:24Z","updated_at":"2022-03-16T23:18:24Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @szehon-ho and @anuragmantri!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069734908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069735599","html_url":"https://github.com/apache/iceberg/pull/4349#issuecomment-1069735599","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4349","id":1069735599,"node_id":"IC_kwDOCW7NX84_wt6v","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T23:19:31Z","updated_at":"2022-03-16T23:19:31Z","author_association":"CONTRIBUTOR","body":"> a note in the [docs](https://iceberg.apache.org/docs/latest/aws/#object-store-file-layout) about this behavior\r\n\r\nThere's currently no discussion of how object storage paths are laid out and I'm not sure I'd over-complicate the page by describing it in enough detail to cover this. I think it is sufficient to say that we use a hash in the location to distribute files.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069735599/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069756964","html_url":"https://github.com/apache/iceberg/pull/4255#issuecomment-1069756964","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4255","id":1069756964,"node_id":"IC_kwDOCW7NX84_wzIk","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-16T23:57:20Z","updated_at":"2022-03-16T23:57:20Z","author_association":"COLLABORATOR","body":"Merged, thanks @wypoon for the doc, and all the reviewers @kbendick @RussellSpitzer @samredai ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069756964/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069758207","html_url":"https://github.com/apache/iceberg/pull/4255#issuecomment-1069758207","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4255","id":1069758207,"node_id":"IC_kwDOCW7NX84_wzb_","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-17T00:00:19Z","updated_at":"2022-03-17T00:00:19Z","author_association":"CONTRIBUTOR","body":"Thanks @szehon-ho!\r\n@samredai is it possible to get this update on the website? Iceberg 0.13 supports Spark 3.2, so this information is relevant and helpful to users of the current release.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069758207/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069765826","html_url":"https://github.com/apache/iceberg/pull/4255#issuecomment-1069765826","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4255","id":1069765826,"node_id":"IC_kwDOCW7NX84_w1TC","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-17T00:14:04Z","updated_at":"2022-03-17T00:14:04Z","author_association":"CONTRIBUTOR","body":"@wypoon if you open this change as a hotfix directly against the 0.13.1 branch in the apache/iceberg-docs repo, that will get auto-deployed once it's merged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069765826/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069766220","html_url":"https://github.com/apache/iceberg/pull/3844#issuecomment-1069766220","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3844","id":1069766220,"node_id":"IC_kwDOCW7NX84_w1ZM","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-17T00:14:45Z","updated_at":"2022-03-17T00:14:45Z","author_association":"COLLABORATOR","body":"I'm a bit conflicted, it makes sense to have fast truncate, but I think the presence of DELETED entries in manifest is also used in other places to check whether data has been deleted, like example:\r\n\r\n 1. checking serializable-isolation of concurrent operations (must fail if data they use is deleted)\r\n 2. CDC design (to mark row as deleted row)\r\n\r\nIf we truncate this way from Spark/Flink then any system using those wont work, is it a concern?  Or is it more like a drop -table operation where we dont care anymore about the table.  cc @aokolnychyi \r\n\r\nThe other thought is that we can achieve the same by doing DeleteFiles.deleteFromRowFilter(Expressions.alwaysTrue()), it is a bit slower in having to read each manifest file, but still faster than having to read data files, not sure what others think.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069766220/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069769469","html_url":"https://github.com/apache/iceberg/issues/3086#issuecomment-1069769469","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3086","id":1069769469,"node_id":"IC_kwDOCW7NX84_w2L9","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-17T00:20:23Z","updated_at":"2022-03-17T00:20:23Z","author_association":"COLLABORATOR","body":"Closing this issue as the first problem has been addressed in #4349.  The second is still kind of annoying to have to do , maybe we can still add the flag if there is interest to default the write-object-store-path to table's location ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069769469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069932950","html_url":"https://github.com/apache/iceberg/pull/4344#issuecomment-1069932950","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4344","id":1069932950,"node_id":"IC_kwDOCW7NX84_xeGW","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-17T02:37:20Z","updated_at":"2022-03-17T02:37:20Z","author_association":"MEMBER","body":"I see what happens, the `io.netty.buffer.PooledByteBufAllocatorL` comes from `arrow-memory-netty`, and I guess it use the package `io.netty.buffer` rather than `org.apache.arrow` may cause of class access permission, thus we can not relocated those classes, the only option should be shade and relocate all netty classes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1069932950/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1070265744","html_url":"https://github.com/apache/iceberg/pull/4344#issuecomment-1070265744","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4344","id":1070265744,"node_id":"IC_kwDOCW7NX84_yvWQ","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-17T03:50:01Z","updated_at":"2022-03-17T03:54:03Z","author_association":"MEMBER","body":"@pan3793 : Thanks for checking and approving the change. \r\n\r\n@rdblue , @openinx, @jackye1995 , @RussellSpitzer : Can you please help merge this PR ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1070265744/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1070352022","html_url":"https://github.com/apache/iceberg/issues/4346#issuecomment-1070352022","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4346","id":1070352022,"node_id":"IC_kwDOCW7NX84_zEaW","user":{"login":"anuragmantri","id":13743212,"node_id":"MDQ6VXNlcjEzNzQzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/13743212?v=4","gravatar_id":"","url":"https://api.github.com/users/anuragmantri","html_url":"https://github.com/anuragmantri","followers_url":"https://api.github.com/users/anuragmantri/followers","following_url":"https://api.github.com/users/anuragmantri/following{/other_user}","gists_url":"https://api.github.com/users/anuragmantri/gists{/gist_id}","starred_url":"https://api.github.com/users/anuragmantri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anuragmantri/subscriptions","organizations_url":"https://api.github.com/users/anuragmantri/orgs","repos_url":"https://api.github.com/users/anuragmantri/repos","events_url":"https://api.github.com/users/anuragmantri/events{/privacy}","received_events_url":"https://api.github.com/users/anuragmantri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-17T05:53:11Z","updated_at":"2022-03-17T05:53:11Z","author_association":"CONTRIBUTOR","body":"Thanks for reviving this issue @aokolnychyi. I've been thinking if having relative paths will help in this case. In my [relative paths change](https://github.com/apache/iceberg/pull/2658), I have separated out table location into a prefix and a location. For example\r\n\r\n```\r\n{\r\n  \"format-version\" : 2,\r\n  \"table-uuid\" : \"24f86bb2-3473-4352-b8fb-375a55b0267b\",\r\n  \"location\" : \"tbl\",\r\n  \"location-prefix\" : \"file:/var/folders/wr/q_40znsn3_b0n0hx08v15dzr0000gn/T/hive5023759931126715387/hivedb.db/\",\r\n  \"last-sequence-number\" : 2,\r\n  \"last-updated-ms\" : 1647492090039,\r\n  \"last-column-id\" : 1,\r\n  \"current-schema-id\" : 0,\r\n...\r\n}\r\n```\r\nSimilarly, location is also split into prefix and location in the catalog with the ability to switch prefix with an API.\r\n\r\nWould this change help in the problem described here if we always pass a relative path in `location => '...' ` in the `remove_orphan_files()` call and let the scheme and authority come from `location-prefix` property above?\r\n\r\nIn the meantime, having `ignore-*` makes sense to me. I also agree with @rdblue that we need to find consensus on which defaults apply to which schemes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1070352022/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1070361464","html_url":"https://github.com/apache/iceberg/issues/4346#issuecomment-1070361464","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4346","id":1070361464,"node_id":"IC_kwDOCW7NX84_zGt4","user":{"login":"anuragmantri","id":13743212,"node_id":"MDQ6VXNlcjEzNzQzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/13743212?v=4","gravatar_id":"","url":"https://api.github.com/users/anuragmantri","html_url":"https://github.com/anuragmantri","followers_url":"https://api.github.com/users/anuragmantri/followers","following_url":"https://api.github.com/users/anuragmantri/following{/other_user}","gists_url":"https://api.github.com/users/anuragmantri/gists{/gist_id}","starred_url":"https://api.github.com/users/anuragmantri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anuragmantri/subscriptions","organizations_url":"https://api.github.com/users/anuragmantri/orgs","repos_url":"https://api.github.com/users/anuragmantri/repos","events_url":"https://api.github.com/users/anuragmantri/events{/privacy}","received_events_url":"https://api.github.com/users/anuragmantri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-17T06:12:21Z","updated_at":"2022-03-17T06:12:21Z","author_association":"CONTRIBUTOR","body":"Thinking about the relative paths more, I can see some issues\r\n- It will not work for existing tables that do not use relative paths.\r\n- Relative paths itself is designed to be optional.\r\n\r\nSo this will not work in all cases.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1070361464/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1070370448","html_url":"https://github.com/apache/iceberg/pull/4350#issuecomment-1070370448","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4350","id":1070370448,"node_id":"IC_kwDOCW7NX84_zI6Q","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-17T06:29:19Z","updated_at":"2022-03-17T06:29:19Z","author_association":"CONTRIBUTOR","body":"Thanks, this was based on the discussion in https://github.com/apache/iceberg/pull/4334/files#r828411959 for some context","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1070370448/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1070374728","html_url":"https://github.com/apache/iceberg/pull/4293#issuecomment-1070374728","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4293","id":1070374728,"node_id":"IC_kwDOCW7NX84_zJ9I","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-17T06:38:20Z","updated_at":"2022-03-17T06:38:20Z","author_association":"CONTRIBUTOR","body":"Thanks, @szehon-ho! Sorry it took so long to get back to this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1070374728/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1070391507","html_url":"https://github.com/apache/iceberg/pull/4325#issuecomment-1070391507","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4325","id":1070391507,"node_id":"IC_kwDOCW7NX84_zODT","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-17T07:10:51Z","updated_at":"2022-03-17T07:10:51Z","author_association":"CONTRIBUTOR","body":"cc @kbendick @RussellSpitzer , PTAL, Thx.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1070391507/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1070397367","html_url":"https://github.com/apache/iceberg/pull/4330#issuecomment-1070397367","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4330","id":1070397367,"node_id":"IC_kwDOCW7NX84_zPe3","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-17T07:14:44Z","updated_at":"2022-03-17T07:14:44Z","author_association":"MEMBER","body":"Use reference at hash works with this change, but the subsequent insert is failing with this error `You can only mutate tables when using a branch without a hash or timestamp`\r\n\r\nSo, tried calling use reference without hash, but that is setting hash to null. (if I don't set hash to null, it uses previous hash which is wrong). But if I set to null refresh is not called.\r\n\r\nSo, not sure how to handle this, probably a change at nessie side should send the latest hash instead of null for use reference without hash.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1070397367/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1070448231","html_url":"https://github.com/apache/iceberg/issues/4305#issuecomment-1070448231","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4305","id":1070448231,"node_id":"IC_kwDOCW7NX84_zb5n","user":{"login":"renshangtao","id":53618158,"node_id":"MDQ6VXNlcjUzNjE4MTU4","avatar_url":"https://avatars.githubusercontent.com/u/53618158?v=4","gravatar_id":"","url":"https://api.github.com/users/renshangtao","html_url":"https://github.com/renshangtao","followers_url":"https://api.github.com/users/renshangtao/followers","following_url":"https://api.github.com/users/renshangtao/following{/other_user}","gists_url":"https://api.github.com/users/renshangtao/gists{/gist_id}","starred_url":"https://api.github.com/users/renshangtao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/renshangtao/subscriptions","organizations_url":"https://api.github.com/users/renshangtao/orgs","repos_url":"https://api.github.com/users/renshangtao/repos","events_url":"https://api.github.com/users/renshangtao/events{/privacy}","received_events_url":"https://api.github.com/users/renshangtao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-17T07:36:08Z","updated_at":"2022-03-17T07:36:08Z","author_association":"CONTRIBUTOR","body":"Install jemalloc on the every node of flink cluster can solve this problem\r\n\r\n1install jemalloc \r\n\r\n2Add the configuration below in /etc/profile\r\nexport LD_PRELOAD=/usr/local/lib/libjemalloc.so\r\n#export MALLOC_CONF=\"prof:true,prof_prefix:/home/bigdata/jeprof.out,lg_prof_interval:30,lg_prof_sample:20\"\r\n\r\n3The source /etc/profile    \r\n\r\n4And Then start flink cluster\r\n\r\n5execute the batch jobs\r\n\r\nI install jemalloc on two of five nodes then here are the result of test,  after seven times exec batch job the memory is increse to 50%+ who use glibc-malloc\r\n\r\n![1647448675433-20ce92b8-894a-4649-bf7f-0039072831cf](https://user-images.githubusercontent.com/53618158/158756660-f730b170-05c3-460a-bd41-e2c5294d3892.png)\r\n\r\n\r\nWhy change the glibc-malloc to jemalloc \r\n\r\nThe reason i think maybe the glibc-malloc casued plenty memory fragmentation\r\n\r\n@rdblue @openinx \r\n\r\ncan you help mei use flink to writer hive table don't have this problem\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1070448231/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1070508331","html_url":"https://github.com/apache/iceberg/issues/4346#issuecomment-1070508331","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4346","id":1070508331,"node_id":"IC_kwDOCW7NX84_zqkr","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-17T08:02:12Z","updated_at":"2022-03-17T08:02:12Z","author_association":"CONTRIBUTOR","body":"Not sure if we've already used crc file. I'd think it can increase the comparison reliability. Here is the reason:\r\n1. We can NOT tell two files are identical if their crc values are the same due to the high collision rate of crc. But we can tell two files are different if their crc are different, which is still useful. For example, we've known the crc values of valid file a, b, c under a dir. We then have the confidence to delete any files without crc or without a valid crc value.\r\n2. Each file generated by Spark has its crc file, so we don't have to calculate them on the fly. We can even preload them in manifest file if needed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1070508331/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1070538915","html_url":"https://github.com/apache/iceberg/issues/4305#issuecomment-1070538915","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4305","id":1070538915,"node_id":"IC_kwDOCW7NX84_zyCj","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-17T08:38:02Z","updated_at":"2022-03-17T08:38:02Z","author_association":"MEMBER","body":"I think the core reason is:  we have set the primary keys in iceberg table for flink DDL,  so the flink write job will think that we are trying to write all those results into an iceberg format v2 table.  see the following code piece: \r\n\r\n\r\nhttps://github.com/apache/iceberg/blob/master/flink/v1.14/flink/src/main/java/org/apache/iceberg/flink/IcebergTableSink.java#L62-L72\r\n\r\nDo you want to write all those records into an iceberg format v2 table to deduplicate those rows who has the same primary key ? If not , then I will suggest to remove the primary key definition in the flink sink table DDL. If sure, then I think we may need to port[ this PR](https://github.com/apache/iceberg/pull/4298) in your branch to fix the OutOfMemory issue. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1070538915/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1071233615","html_url":"https://github.com/apache/iceberg/issues/4356#issuecomment-1071233615","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4356","id":1071233615,"node_id":"IC_kwDOCW7NX84_2bpP","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-17T19:09:42Z","updated_at":"2022-03-17T19:09:42Z","author_association":"COLLABORATOR","body":"is it ok to change exception type here?  cc @aokolnychyi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1071233615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1071706951","html_url":"https://github.com/apache/iceberg/pull/4357#issuecomment-1071706951","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4357","id":1071706951,"node_id":"IC_kwDOCW7NX84_4PNH","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-17T22:42:20Z","updated_at":"2022-03-17T22:42:20Z","author_association":"CONTRIBUTOR","body":"FYI @rajarshisarkar, can you take a look at this follow up?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1071706951/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1071930979","html_url":"https://github.com/apache/iceberg/pull/4358#issuecomment-1071930979","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4358","id":1071930979,"node_id":"IC_kwDOCW7NX84_5F5j","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-18T01:25:19Z","updated_at":"2022-03-18T01:25:31Z","author_association":"CONTRIBUTOR","body":"cc @arminnajafi @rajarshisarkar @singhpk234 @amogh-jahagirdar @yyanyy","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1071930979/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1071957747","html_url":"https://github.com/apache/iceberg/issues/4305#issuecomment-1071957747","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4305","id":1071957747,"node_id":"IC_kwDOCW7NX84_5Mbz","user":{"login":"renshangtao","id":53618158,"node_id":"MDQ6VXNlcjUzNjE4MTU4","avatar_url":"https://avatars.githubusercontent.com/u/53618158?v=4","gravatar_id":"","url":"https://api.github.com/users/renshangtao","html_url":"https://github.com/renshangtao","followers_url":"https://api.github.com/users/renshangtao/followers","following_url":"https://api.github.com/users/renshangtao/following{/other_user}","gists_url":"https://api.github.com/users/renshangtao/gists{/gist_id}","starred_url":"https://api.github.com/users/renshangtao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/renshangtao/subscriptions","organizations_url":"https://api.github.com/users/renshangtao/orgs","repos_url":"https://api.github.com/users/renshangtao/repos","events_url":"https://api.github.com/users/renshangtao/events{/privacy}","received_events_url":"https://api.github.com/users/renshangtao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-18T02:19:25Z","updated_at":"2022-03-18T02:20:07Z","author_association":"CONTRIBUTOR","body":"@openinx \r\nFirst thanks a lot for  your reply, It was I who didn't describe the scene clearly\r\n\r\n\r\n1This is my source table:\r\n create table hive_catalog.iceberg_db.sourceTable (\r\n    step_id string,\r\n    param_id string,\r\n    wafer_id string,\r\n    chip_id string,\r\n    product_id1 string,\r\n    product_id2 string,\r\n    product_id3 string,     \r\n    product_id4 string,\r\n    product_id5 string,\r\n    num_item1 double,\r\n    num_item2 double,\r\n    num_item3 double,\r\n    num_item4 double,\r\n    num_item5 double,\r\n    num_item6 double,\r\n    start_date date,\r\n    PRIMARY KEY (chip_id, param_id, step_id, wafer_id) NOT ENFORCED)\r\nPARTITIONED BY (step_id, start_date)\r\nWITH ('format-version'='2');\r\n\r\n2This is Temp Table:\r\ncreate table hive_catalog.iceberg_db.temp_data (\r\n     step_id string,\r\n     param_id string,\r\n     wafer_id string,\r\n     chip_id string,\r\n     product_id1 string,\r\n     product_id2 string,\r\n     product_id3 string,     \r\n     product_id4 string,\r\n     product_id5 string,\r\n     num_item1 double,\r\n     num_item2 double,\r\n     num_item3 double,\r\n     num_item4 double,\r\n     num_item5 double,\r\n     num_item6 double,\r\n     start_date date,\r\n     part_id int)\r\n PARTITIONED BY (part_id)\r\n WITH ('format-version'='2', 'write.distribution-mode'='hash');\r\n\r\nThis is the sql which my batch job use.\r\n\r\n3insert into temp_data select \r\n     step_id,\r\n     param_id,\r\n     wafer_id,\r\n     chip_id,\r\n     product_id1,\r\n     product_id2,\r\n     product_id3,\r\n     product_id4,\r\n     product_id5,\r\n     num_item1,\r\n     num_item2,\r\n     num_item3,\r\n     num_item4,\r\n     num_item5,\r\n     num_item6,\r\n     start_date,\r\n     (HASH_CODE(step_id || param_id || step_id || wafer_id)) % 10 as part_id \r\n     from source;\r\n\r\nAfter i run this job seven or eight tims the memory of linux will be incresed to 80%And the memory which taskmanger used is 60%.\r\n\r\nBut if i use jemalloc to run several times of job, the memory is noraml , which is same as the flink cluster just started\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1071957747/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1071971319","html_url":"https://github.com/apache/iceberg/pull/4316#issuecomment-1071971319","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4316","id":1071971319,"node_id":"IC_kwDOCW7NX84_5Pv3","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-18T02:42:32Z","updated_at":"2022-03-18T02:42:58Z","author_association":"CONTRIBUTOR","body":"@kbendick  and I are trying to solve this, ref: https://github.com/kbendick/iceberg/pull/71\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1071971319/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1071999090","html_url":"https://github.com/apache/iceberg/pull/4359#issuecomment-1071999090","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4359","id":1071999090,"node_id":"IC_kwDOCW7NX84_5Why","user":{"login":"xloya","id":26177232,"node_id":"MDQ6VXNlcjI2MTc3MjMy","avatar_url":"https://avatars.githubusercontent.com/u/26177232?v=4","gravatar_id":"","url":"https://api.github.com/users/xloya","html_url":"https://github.com/xloya","followers_url":"https://api.github.com/users/xloya/followers","following_url":"https://api.github.com/users/xloya/following{/other_user}","gists_url":"https://api.github.com/users/xloya/gists{/gist_id}","starred_url":"https://api.github.com/users/xloya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xloya/subscriptions","organizations_url":"https://api.github.com/users/xloya/orgs","repos_url":"https://api.github.com/users/xloya/repos","events_url":"https://api.github.com/users/xloya/events{/privacy}","received_events_url":"https://api.github.com/users/xloya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-18T03:41:03Z","updated_at":"2022-03-18T03:41:03Z","author_association":"CONTRIBUTOR","body":"The single tests failed because the `Core`  module was modified and the historical spark versions were incompatible. The backports will be added after reviews","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1071999090/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072079818","html_url":"https://github.com/apache/iceberg/pull/3323#issuecomment-1072079818","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3323","id":1072079818,"node_id":"IC_kwDOCW7NX84_5qPK","user":{"login":"Initial-neko","id":40999666,"node_id":"MDQ6VXNlcjQwOTk5NjY2","avatar_url":"https://avatars.githubusercontent.com/u/40999666?v=4","gravatar_id":"","url":"https://api.github.com/users/Initial-neko","html_url":"https://github.com/Initial-neko","followers_url":"https://api.github.com/users/Initial-neko/followers","following_url":"https://api.github.com/users/Initial-neko/following{/other_user}","gists_url":"https://api.github.com/users/Initial-neko/gists{/gist_id}","starred_url":"https://api.github.com/users/Initial-neko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Initial-neko/subscriptions","organizations_url":"https://api.github.com/users/Initial-neko/orgs","repos_url":"https://api.github.com/users/Initial-neko/repos","events_url":"https://api.github.com/users/Initial-neko/events{/privacy}","received_events_url":"https://api.github.com/users/Initial-neko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-18T06:49:54Z","updated_at":"2022-03-18T06:49:54Z","author_association":"NONE","body":"a quick question, can this pr be used in flink1.13.1?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072079818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072162035","html_url":"https://github.com/apache/iceberg/pull/3323#issuecomment-1072162035","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3323","id":1072162035,"node_id":"IC_kwDOCW7NX84_5-Tz","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-18T08:31:25Z","updated_at":"2022-03-18T08:31:25Z","author_association":"CONTRIBUTOR","body":"> a quick question, can this pr be used in flink1.13.1?\r\n\r\nI have been port this featuer to flink 1.13 in branch flink-streaming-rewrite-for-flink0.13 before, but there have some conflicts need to be resloved, maybe you can use that. @Initial-neko ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072162035/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072508346","html_url":"https://github.com/apache/iceberg/pull/3983#issuecomment-1072508346","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3983","id":1072508346,"node_id":"IC_kwDOCW7NX84_7S26","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-18T15:14:41Z","updated_at":"2022-03-18T15:14:41Z","author_association":"MEMBER","body":"After changing the default size of all types to 8 bytes and randomizing the shuffle input I get some different perf results. It seems like the pattern of the data is more important to the sort times than the amount of data in the sort field?\r\n\r\nComit : 91a76010869e68633d598d718fb7929f6b531a71\r\n```\r\nBenchmark                                        Mode  Cnt    Score    Error  Units\r\nIcebergSortCompactionBenchmark.sortFourColumns     ss   10   86.675   8.177   s/op\r\nIcebergSortCompactionBenchmark.sortInt             ss   10   74.262   6.732   s/op\r\nIcebergSortCompactionBenchmark.sortInt2            ss   10   72.515   8.014   s/op\r\nIcebergSortCompactionBenchmark.sortInt3            ss   10   76.228   4.590   s/op\r\nIcebergSortCompactionBenchmark.sortInt4            ss   10   74.730   4.267   s/op\r\nIcebergSortCompactionBenchmark.sortSixColumns      ss   10   75.933   5.042   s/op\r\nIcebergSortCompactionBenchmark.sortString          ss   10   77.488   6.804   s/op\r\n\r\nIcebergSortCompactionBenchmark.zSortFourColumns    ss   10  277.954  73.324   s/op\r\nIcebergSortCompactionBenchmark.zSortInt            ss   10  327.105  17.098   s/op\r\nIcebergSortCompactionBenchmark.zSortInt2           ss   10  328.217  13.099   s/op\r\nIcebergSortCompactionBenchmark.zSortInt3           ss   10  342.404  15.660   s/op\r\nIcebergSortCompactionBenchmark.zSortInt4           ss   10  344.997  16.342   s/op\r\nIcebergSortCompactionBenchmark.zSortSixColumns     ss   10  295.686  62.866   s/op\r\nIcebergSortCompactionBenchmark.zSortString         ss   10  333.303  15.966   s/op\r\n```\r\n\r\nWhat is odd to me here is that the sort time for Strings is now ... basically the same as integers, all of our zorderings take about the same amount of time and so do all of our sortings without zorder. What is more interesting to me is that for ZOrdering this is basically increasing the ZORDER output byte size and have no effect on the comparison time. For Strings maybe this made sense ... but for ZSortInt 1,2,3,4 I would have expected things to take different amounts of times. Perhaps with a totally random layout of data the significant bits to compare on average always appear in the same location for ZOrder regardless of number of interleaved columns? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072508346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072537484","html_url":"https://github.com/apache/iceberg/pull/4316#issuecomment-1072537484","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4316","id":1072537484,"node_id":"IC_kwDOCW7NX84_7Z-M","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-18T15:47:03Z","updated_at":"2022-03-18T15:47:03Z","author_association":"CONTRIBUTOR","body":"Hi, @kbendick, based on our previous discussion, I've raised a preliminary solution. It deletes data based on the key. Please take a look at it. Thx. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072537484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072554875","html_url":"https://github.com/apache/iceberg/pull/4357#issuecomment-1072554875","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4357","id":1072554875,"node_id":"IC_kwDOCW7NX84_7eN7","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-18T16:04:18Z","updated_at":"2022-03-18T16:04:18Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072554875/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072696728","html_url":"https://github.com/apache/iceberg/pull/4272#issuecomment-1072696728","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4272","id":1072696728,"node_id":"IC_kwDOCW7NX84_8A2Y","user":{"login":"emkornfield","id":17869838,"node_id":"MDQ6VXNlcjE3ODY5ODM4","avatar_url":"https://avatars.githubusercontent.com/u/17869838?v=4","gravatar_id":"","url":"https://api.github.com/users/emkornfield","html_url":"https://github.com/emkornfield","followers_url":"https://api.github.com/users/emkornfield/followers","following_url":"https://api.github.com/users/emkornfield/following{/other_user}","gists_url":"https://api.github.com/users/emkornfield/gists{/gist_id}","starred_url":"https://api.github.com/users/emkornfield/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/emkornfield/subscriptions","organizations_url":"https://api.github.com/users/emkornfield/orgs","repos_url":"https://api.github.com/users/emkornfield/repos","events_url":"https://api.github.com/users/emkornfield/events{/privacy}","received_events_url":"https://api.github.com/users/emkornfield/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-18T18:38:26Z","updated_at":"2022-03-18T18:38:26Z","author_association":"CONTRIBUTOR","body":"@rdblue did you have a chance to look again?  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072696728/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072709489","html_url":"https://github.com/apache/iceberg/pull/4344#issuecomment-1072709489","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4344","id":1072709489,"node_id":"IC_kwDOCW7NX84_8D9x","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-18T18:57:18Z","updated_at":"2022-03-18T18:57:18Z","author_association":"MEMBER","body":"ping... @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072709489/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072727545","html_url":"https://github.com/apache/iceberg/pull/4344#issuecomment-1072727545","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4344","id":1072727545,"node_id":"IC_kwDOCW7NX84_8IX5","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-18T19:13:22Z","updated_at":"2022-03-18T19:13:22Z","author_association":"CONTRIBUTOR","body":"Reverted. Thanks for looking into this more, @pan3793 and @ajantha-bhat!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072727545/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072794581","html_url":"https://github.com/apache/iceberg/pull/4360#issuecomment-1072794581","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4360","id":1072794581,"node_id":"IC_kwDOCW7NX84_8YvV","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-18T21:04:43Z","updated_at":"2022-03-18T21:04:43Z","author_association":"CONTRIBUTOR","body":"Thanks, @danielcweeks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072794581/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072797548","html_url":"https://github.com/apache/iceberg/pull/4361#issuecomment-1072797548","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4361","id":1072797548,"node_id":"IC_kwDOCW7NX84_8Zds","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-18T21:09:52Z","updated_at":"2022-03-18T21:09:52Z","author_association":"CONTRIBUTOR","body":"Looks like we have some check failures (not sure if those are related)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072797548/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072798671","html_url":"https://github.com/apache/iceberg/pull/4360#issuecomment-1072798671","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4360","id":1072798671,"node_id":"IC_kwDOCW7NX84_8ZvP","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-18T21:11:54Z","updated_at":"2022-03-18T21:11:54Z","author_association":"CONTRIBUTOR","body":"Have been out sick but retroactive +1 as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072798671/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072838608","html_url":"https://github.com/apache/iceberg/issues/4363#issuecomment-1072838608","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4363","id":1072838608,"node_id":"IC_kwDOCW7NX84_8jfQ","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-18T21:43:07Z","updated_at":"2022-03-18T21:43:07Z","author_association":"MEMBER","body":"Looks right to me, and the code looks fine on the Spark Side\r\n\r\nhttps://github.com/apache/spark/blob/v3.1.2/sql/core/src/main/scala/org/apache/spark/sql/DataFrameWriterV2.scala#L83-L126\r\n\r\nProbably need to debug this later to find out exactly what is going wrong","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072838608/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072850541","html_url":"https://github.com/apache/iceberg/pull/3983#issuecomment-1072850541","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3983","id":1072850541,"node_id":"IC_kwDOCW7NX84_8mZt","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-18T22:07:55Z","updated_at":"2022-03-18T22:07:55Z","author_association":"MEMBER","body":"@szehon-ho Made fixes and added some new benchmarks as well, please take a look when you have time. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072850541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072885504","html_url":"https://github.com/apache/iceberg/pull/4280#issuecomment-1072885504","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4280","id":1072885504,"node_id":"IC_kwDOCW7NX84_8u8A","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-18T23:27:32Z","updated_at":"2022-03-18T23:27:32Z","author_association":"CONTRIBUTOR","body":"@amogh-jahagirdar @rajarshisarkar @singhpk234 @rdblue I think this is mostly good for review, could you take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072885504/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072911791","html_url":"https://github.com/apache/iceberg/pull/4316#issuecomment-1072911791","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4316","id":1072911791,"node_id":"IC_kwDOCW7NX84_81Wv","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-19T01:21:06Z","updated_at":"2022-03-19T01:21:06Z","author_association":"CONTRIBUTOR","body":"@rdblue Sorry for the late reply, I just got up for work due to jet lag. Fortunately @kbendick  is already working on it, he has raised new PR https://github.com/apache/iceberg/pull/4364, maybe we can continue on that, So I'm going to close this PR. Thank you.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072911791/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072911990","html_url":"https://github.com/apache/iceberg/pull/4364#issuecomment-1072911990","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4364","id":1072911990,"node_id":"IC_kwDOCW7NX84_81Z2","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-19T01:22:24Z","updated_at":"2022-03-19T01:22:24Z","author_association":"CONTRIBUTOR","body":"For more information about the reproduction, see :https://github.com/apache/iceberg/pull/4316#issuecomment-1067731623\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072911990/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072927466","html_url":"https://github.com/apache/iceberg/issues/4317#issuecomment-1072927466","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4317","id":1072927466,"node_id":"IC_kwDOCW7NX84_85Lq","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-19T03:12:12Z","updated_at":"2022-03-19T03:12:12Z","author_association":"CONTRIBUTOR","body":"@yittg Thank you for your feedback. Could you elaborate on what new features you would like to add? Maybe we can discuss it.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072927466/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072927935","html_url":"https://github.com/apache/iceberg/issues/4051#issuecomment-1072927935","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4051","id":1072927935,"node_id":"IC_kwDOCW7NX84_85S_","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-19T03:16:07Z","updated_at":"2022-03-19T03:16:07Z","author_association":"CONTRIBUTOR","body":"hi, guys, i have raised a PR for this. If you have available, could you please help to review? thx.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072927935/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072943877","html_url":"https://github.com/apache/iceberg/issues/4363#issuecomment-1072943877","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4363","id":1072943877,"node_id":"IC_kwDOCW7NX84_89MF","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-19T05:17:51Z","updated_at":"2022-03-19T05:17:51Z","author_association":"CONTRIBUTOR","body":"@krisvaz I debugged it locally and it works as expected, can you share more information? Like your test data?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072943877/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072945055","html_url":"https://github.com/apache/iceberg/issues/4362#issuecomment-1072945055","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4362","id":1072945055,"node_id":"IC_kwDOCW7NX84_89ef","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-19T05:25:47Z","updated_at":"2022-03-19T05:25:47Z","author_association":"CONTRIBUTOR","body":"This is a real problem in use, so we've even built a gadget that reads these values and converts them into a human-readable format. +1 for this issuse","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1072945055/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073020431","html_url":"https://github.com/apache/iceberg/issues/4305#issuecomment-1073020431","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4305","id":1073020431,"node_id":"IC_kwDOCW7NX84_9P4P","user":{"login":"renshangtao","id":53618158,"node_id":"MDQ6VXNlcjUzNjE4MTU4","avatar_url":"https://avatars.githubusercontent.com/u/53618158?v=4","gravatar_id":"","url":"https://api.github.com/users/renshangtao","html_url":"https://github.com/renshangtao","followers_url":"https://api.github.com/users/renshangtao/followers","following_url":"https://api.github.com/users/renshangtao/following{/other_user}","gists_url":"https://api.github.com/users/renshangtao/gists{/gist_id}","starred_url":"https://api.github.com/users/renshangtao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/renshangtao/subscriptions","organizations_url":"https://api.github.com/users/renshangtao/orgs","repos_url":"https://api.github.com/users/renshangtao/repos","events_url":"https://api.github.com/users/renshangtao/events{/privacy}","received_events_url":"https://api.github.com/users/renshangtao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-19T14:33:13Z","updated_at":"2022-03-19T14:33:13Z","author_association":"CONTRIBUTOR","body":"i find an article an solve this problem\r\n\r\nhttps://github.com/prestodb/presto/issues/8993","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073020431/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073071478","html_url":"https://github.com/apache/iceberg/pull/4262#issuecomment-1073071478","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4262","id":1073071478,"node_id":"IC_kwDOCW7NX84_9cV2","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-19T19:49:13Z","updated_at":"2022-03-19T19:56:43Z","author_association":"CONTRIBUTOR","body":"I did rebase from latest upstream and squash my commits together into a single one, have a better way to initialize the Decimal per @CircArgs  suggestion, define the `__str__` in type level `Literal` and removed the usage of `conftest.py` in unit tests.\r\n\r\n@rdblue @jun-he @samredai if you guys can take another look, that would be awesome!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073071478/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073298290","html_url":"https://github.com/apache/iceberg/pull/4342#issuecomment-1073298290","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4342","id":1073298290,"node_id":"IC_kwDOCW7NX84_-Tty","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-20T17:37:54Z","updated_at":"2022-03-20T17:37:54Z","author_association":"CONTRIBUTOR","body":"I'm not sure I really follow why we would do this.  It seems like we're trying to overlap use cases by highjacking delete behavior.\r\n\r\nThis also requires that the configuration of the bucket aligns with the tags to actually achieve the desired behavior.\r\n\r\nOverall, it feels like this is a bit of a reach in terms of functionality. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073298290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073300814","html_url":"https://github.com/apache/iceberg/pull/4337#issuecomment-1073300814","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4337","id":1073300814,"node_id":"IC_kwDOCW7NX84_-UVO","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-20T17:52:58Z","updated_at":"2022-03-20T17:52:58Z","author_association":"CONTRIBUTOR","body":"I think there's a distinction between what what the REST implementation should do and what the client behavior should be.  I'm not sure if the drop behavior is just extending from spark, but I think there's good reason that we should return the appropriate 404:\r\n\r\n1. Other endpoints return 404 for non-existent namespace/tables, which makes this behavior inconsistent\r\n2. Returning 200/false doesn't actually convey why it was not dropped, just that it was not dropped\r\n3. The client implementation can always handle the 404 and return false ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073300814/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073306515","html_url":"https://github.com/apache/iceberg/pull/4342#issuecomment-1073306515","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4342","id":1073306515,"node_id":"IC_kwDOCW7NX84_-VuT","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-20T18:26:46Z","updated_at":"2022-03-20T18:36:48Z","author_association":"CONTRIBUTOR","body":"> It seems like we're trying to overlap use cases by highjacking delete behavior.\r\n\r\nThanks for the feedback Daniel! I think this is not trying to highjack the delete behavior. Based on what we've heard from some key customers, tagging an object is now the preferred S3 delete implementation in many companies. It is typically a sev0 in a corporation for data loss, so the data platform team prefers to gradually retire the delete files to different tiers and let S3 handle the lifecycle transition.\r\n\r\nNote that this is not a discussion of table deletion/snapshot expiration with purge or not. For platforms that allow people to do table deletion with purge, I would imagine this feature to be preferred where users could accidentally run a DROP TABLE. And even for platform that does deletion without purge, eventually there is a team who does the \"purge\" part, and based on the customer discussions we have, this is typically what they do by tagging files and then define lifecycle policy so S3 takes care of the transition of files.\r\n\r\n> This also requires that the configuration of the bucket aligns with the tags to actually achieve the desired behavior.\r\n\r\nThis can be explained in 3 parts:\r\n\r\n1. ironically, to satisfy the use case i described, many teams today have to enable S3 object versioning to not hard-delete data files. However, it becomes a huge increase in cost and users have to implement custom workflows then to deal with versioned objects. So some sort of bucket configuration is always needed for enterprise data lake setup, and this tagged approach is going to save cost rather than increase cost for those users.\r\n\r\n2. there are many features that won't work with the default S3 behavior and need bucket level settings, some other features we plan to add like S3 acceleration mode, S3 dual stack are all like that. It's mostly done for backwards compatibility. We see a strong adoption of using a lifecycle policy to soft-delete data instead of doing a direct s3 object deletion. There are recently also threads in similar products like Hudi and Delta for such use cases. I would consider this feature to fall into such category of \"new features that users have to opt-in\" on S3 side.\r\n\r\n3. From Iceberg perspective, a file is no longer a part of the table if it is not a part of the Iceberg metadata tree. FileIO.delete is always used AFTER a table level commit that removes the file out of the metadata tree (in the full table deletion case it is also done after catalog operation that removes the table in catalog), so this semantic is still intact even if a file is not actually deleted for people would like to use such a feature.\r\n\r\n> Overall, it feels like this is a bit of a reach in terms of functionality.\r\n\r\nLet me know what do you think about this area of topic, if you have any better solutions than the proposed one. I think this is a small feature that could enable a lot of valuable use cases. Similar to the access point feature we are adding in S3FileIO, we consider that an intermediate solution which could be solved also at Iceberg level with larger spec change to support relative file path, I think there is value in offering this feature for people who knows how to use it, while we think of anything better that could solve such retention at Iceberg spec level.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073306515/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073347947","html_url":"https://github.com/apache/iceberg/pull/4342#issuecomment-1073347947","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4342","id":1073347947,"node_id":"IC_kwDOCW7NX84_-f1r","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-20T21:00:52Z","updated_at":"2022-03-20T21:00:52Z","author_association":"CONTRIBUTOR","body":"@danielcweeks, @jackye1995, I think there's definitely value in being able to add tags to let lifecycle policies handle this. But I find it really confusing that adding a delete tag prevents the object from being deleted and instead just tags it.\r\n\r\nI think that tagging an object before deleting it and skipping the delete because the tag takes care of it should be separate configurations. It's reasonable for someone to replace deletes with tags, or tag an object and still delete it. I can also imagine a situations where client-side deletes aren't allowed and the warehouse relies on an orphan files service. That means all of the combinations of \"skip delete\" and \"tag before delete\" are valid use cases, so we should separate those.\r\n\r\nHow about implementing this with a `s3.delete-enabled` flag and the `s3.delete.tags` config?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073347947/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073349996","html_url":"https://github.com/apache/iceberg/pull/4262#issuecomment-1073349996","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4262","id":1073349996,"node_id":"IC_kwDOCW7NX84_-gVs","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-20T21:12:54Z","updated_at":"2022-03-20T21:12:54Z","author_association":"CONTRIBUTOR","body":"Thanks, @dramaticlly! This is making great progress.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073349996/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073351526","html_url":"https://github.com/apache/iceberg/pull/4337#issuecomment-1073351526","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4337","id":1073351526,"node_id":"IC_kwDOCW7NX84_-gtm","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-20T21:22:28Z","updated_at":"2022-03-20T21:22:28Z","author_association":"CONTRIBUTOR","body":"@danielcweeks, thinking about this more, I agree with you. Looks like there's a fair amount of [debate](https://stackoverflow.com/questions/6439416/status-code-when-deleting-a-resource-using-http-delete-for-the-second-time) about this. Most people side with using 404 and I agree that the protocol doesn't necessarily need to go one way or another to have an idempotent API.\r\n\r\nWhat made me change my mind in the end is that we can use 204 and 404 for true/false cases rather than having a response object. That makes all the implementations simpler.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073351526/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073360434","html_url":"https://github.com/apache/iceberg/pull/4366#issuecomment-1073360434","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4366","id":1073360434,"node_id":"IC_kwDOCW7NX84_-i4y","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-20T22:21:21Z","updated_at":"2022-03-20T22:21:21Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @danielcweeks! I'll open a PR for this once #4348 is in.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073360434/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073360548","html_url":"https://github.com/apache/iceberg/pull/4348#issuecomment-1073360548","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4348","id":1073360548,"node_id":"IC_kwDOCW7NX84_-i6k","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-20T22:22:04Z","updated_at":"2022-03-20T22:22:04Z","author_association":"CONTRIBUTOR","body":"Since this is already large and close to being committed, I plan to update the code for #4366 once this is in.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073360548/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073367370","html_url":"https://github.com/apache/iceberg/pull/4342#issuecomment-1073367370","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4342","id":1073367370,"node_id":"IC_kwDOCW7NX84_-klK","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-20T23:03:10Z","updated_at":"2022-03-20T23:03:10Z","author_association":"CONTRIBUTOR","body":"> I can also imagine a situations where client-side deletes aren't allowed and the warehouse relies on an orphan files service. That means all of the combinations of \"skip delete\" and \"tag before delete\" are valid use cases, so we should separate those.\r\n\r\nYes totally agree. However, should it be `s3.delete-enabled`, or a broader `io.delete-enabled` feature? If a client-side delete is not allowed, it should be applied to all the FileIOs instead of just S3.\r\n\r\nI thought about the 4 possible combinations, and I did not ask for an additional `-enabled` flag because:\r\n1. delete enabled + tags set: this case does not really exist, because once the object is deleted in S3 there is no tag anymore.\r\n2. delete disabled + tags set: this is the feature in the PR\r\n3. delete enabled + no tag: this is the existing behavior\r\n4. delete disabled + no tag: this is the case we agree that an orphan file service would take care of everything, and goes back to my question of should this be a feature flag across all FileIOs? If so we can publish a follow-up PR for that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073367370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073369730","html_url":"https://github.com/apache/iceberg/pull/4342#issuecomment-1073369730","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4342","id":1073369730,"node_id":"IC_kwDOCW7NX84_-lKC","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-20T23:14:59Z","updated_at":"2022-03-20T23:14:59Z","author_association":"CONTRIBUTOR","body":"@jackye1995, for case 1, I thought tags would remain on objects in versioned buckets that are deleted with a delete marker. So you could use a tag to control when the old version gets cleaned up, but logically delete it immediately. Isn't that a valid case?\r\n\r\nFor the question about `s3.delete-enabled` or `io.delete-enabled`, I would go with `s3.delete-enabled` although I could be convinced otherwise.\r\n\r\nFirst, if the intent is to replace the S3 delete with a tag operation instead, then it seems like you wouldn't want to disable deletes across all storage for a table. If you have files stored across multiple schemes, then it doesn't make sense to disable deletes for other schemes.\r\n\r\nSecond, `io.delete-enabled` would address just use case 4. In that case, why delegate to `FileIO` to skip the delete rather than just not calling delete in the library? I don't think we would want `io.delete-enabled` because it would be impossible to make sure all of the `FileIO` implementations implement it consistently. Plus, you'd still have the problem where you probably don't want to turn it on in all object stores at once. You may have a different orphan file cleanup procedure for each one, or maybe for one you don't have a reliable prefix to list.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073369730/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073437238","html_url":"https://github.com/apache/iceberg/pull/4364#issuecomment-1073437238","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4364","id":1073437238,"node_id":"IC_kwDOCW7NX84_-1o2","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-21T03:05:44Z","updated_at":"2022-03-21T03:05:44Z","author_association":"CONTRIBUTOR","body":"It seems that one of the new tests might be flakey.\r\n\r\n```\r\norg.apache.iceberg.flink.TestFlinkUpsert > testCompoundPrimaryKey[catalogName=testhadoop_basenamespace, baseNamespace=l0.l1, format=ORC, isStreaming=true] FAILED\r\n[215](https://github.com/apache/iceberg/runs/5621154621?check_suite_focus=true#step:6:215)\r\n    java.lang.AssertionError: result should have the correct rows expected:<[+I[2, aaa, 2022-03-01], +I[3, bbb, 2022-03-01]]> but was:<[+I[1, aaa, 2022-03-01], +I[3, bbb, 2022-03-01]]>\r\n[216](https://github.com/apache/iceberg/runs/5621154621?check_suite_focus=true#step:6:216)\r\n        at org.junit.Assert.fail(Assert.java:89)\r\n[217](https://github.com/apache/iceberg/runs/5621154621?check_suite_focus=true#step:6:217)\r\n        at org.junit.Assert.failNotEquals(Assert.java:835)\r\n[218](https://github.com/apache/iceberg/runs/5621154621?check_suite_focus=true#step:6:218)\r\n        at org.junit.Assert.assertEquals(Assert.java:120)\r\n[219](https://github.com/apache/iceberg/runs/5621154621?check_suite_focus=true#step:6:219)\r\n        at org.apache.iceberg.flink.TestFlinkUpsert.testCompoundPrimaryKey(TestFlinkUpsert.java:218)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073437238/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073455440","html_url":"https://github.com/apache/iceberg/issues/4312#issuecomment-1073455440","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4312","id":1073455440,"node_id":"IC_kwDOCW7NX84_-6FQ","user":{"login":"Zhangg7723","id":18146312,"node_id":"MDQ6VXNlcjE4MTQ2MzEy","avatar_url":"https://avatars.githubusercontent.com/u/18146312?v=4","gravatar_id":"","url":"https://api.github.com/users/Zhangg7723","html_url":"https://github.com/Zhangg7723","followers_url":"https://api.github.com/users/Zhangg7723/followers","following_url":"https://api.github.com/users/Zhangg7723/following{/other_user}","gists_url":"https://api.github.com/users/Zhangg7723/gists{/gist_id}","starred_url":"https://api.github.com/users/Zhangg7723/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zhangg7723/subscriptions","organizations_url":"https://api.github.com/users/Zhangg7723/orgs","repos_url":"https://api.github.com/users/Zhangg7723/repos","events_url":"https://api.github.com/users/Zhangg7723/events{/privacy}","received_events_url":"https://api.github.com/users/Zhangg7723/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-21T03:43:24Z","updated_at":"2022-03-21T03:43:24Z","author_association":"CONTRIBUTOR","body":"The same problem in Spark when rewrite V2 table, we fixed this problem locally by bloomfilter in parquet filesour code will be committed after the bloomfilter feature be merged.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073455440/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073458285","html_url":"https://github.com/apache/iceberg/issues/4353#issuecomment-1073458285","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4353","id":1073458285,"node_id":"IC_kwDOCW7NX84_-6xt","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-21T03:51:48Z","updated_at":"2022-03-21T03:51:48Z","author_association":"CONTRIBUTOR","body":"Looks like it can be done with overwrite, IIUC, you can check out the example in UT https://github.com/apache/iceberg/blob/0f3e7c7badf47bd0e2178591082886cd47d94a1b/core/src/test/java/org/apache/iceberg/TestOverwriteWithValidation.java#L227-L242","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073458285/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073680947","html_url":"https://github.com/apache/iceberg/issues/4354#issuecomment-1073680947","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4354","id":1073680947,"node_id":"IC_kwDOCW7NX84__xIz","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-21T09:34:18Z","updated_at":"2022-03-21T09:34:18Z","author_association":"MEMBER","body":"CC @wang-x-xia ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073680947/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073705720","html_url":"https://github.com/apache/iceberg/pull/4291#issuecomment-1073705720","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4291","id":1073705720,"node_id":"IC_kwDOCW7NX84__3L4","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-21T10:01:35Z","updated_at":"2022-03-21T10:01:35Z","author_association":"MEMBER","body":"Got this merged, thanks @hililiwei for contribution, and thanks all for reviewing !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073705720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073710873","html_url":"https://github.com/apache/iceberg/issues/4354#issuecomment-1073710873","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4354","id":1073710873,"node_id":"IC_kwDOCW7NX84__4cZ","user":{"login":"wang-x-xia","id":83057695,"node_id":"MDQ6VXNlcjgzMDU3Njk1","avatar_url":"https://avatars.githubusercontent.com/u/83057695?v=4","gravatar_id":"","url":"https://api.github.com/users/wang-x-xia","html_url":"https://github.com/wang-x-xia","followers_url":"https://api.github.com/users/wang-x-xia/followers","following_url":"https://api.github.com/users/wang-x-xia/following{/other_user}","gists_url":"https://api.github.com/users/wang-x-xia/gists{/gist_id}","starred_url":"https://api.github.com/users/wang-x-xia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wang-x-xia/subscriptions","organizations_url":"https://api.github.com/users/wang-x-xia/orgs","repos_url":"https://api.github.com/users/wang-x-xia/repos","events_url":"https://api.github.com/users/wang-x-xia/events{/privacy}","received_events_url":"https://api.github.com/users/wang-x-xia/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-21T10:07:08Z","updated_at":"2022-03-21T10:07:08Z","author_association":"CONTRIBUTOR","body":"@BiuBiu2323 \r\nCan you give brief progress of operations? I want to know more details of your scenario.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073710873/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073792021","html_url":"https://github.com/apache/iceberg/pull/4221#issuecomment-1073792021","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4221","id":1073792021,"node_id":"IC_kwDOCW7NX85AAMQV","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-21T11:39:43Z","updated_at":"2022-03-21T11:39:43Z","author_association":"MEMBER","body":"Got this merged now, thanks @wang-x-xia for the contribution, and thanks all for reviewing !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073792021/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073822100","html_url":"https://github.com/apache/iceberg/pull/4342#issuecomment-1073822100","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4342","id":1073822100,"node_id":"IC_kwDOCW7NX85AATmU","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-21T12:16:04Z","updated_at":"2022-03-21T12:16:04Z","author_association":"CONTRIBUTOR","body":"I have implemented the `s3.delete-enabled` flag which is different from the `s3.delete.tags` config. This should satisfy the \"skip delete\" and \"tag before delete\" use cases.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073822100/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073924346","html_url":"https://github.com/apache/iceberg/issues/4368#issuecomment-1073924346","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4368","id":1073924346,"node_id":"IC_kwDOCW7NX85AAsj6","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-21T13:53:13Z","updated_at":"2022-03-21T13:53:13Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1073924346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074075702","html_url":"https://github.com/apache/iceberg/issues/4368#issuecomment-1074075702","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4368","id":1074075702,"node_id":"IC_kwDOCW7NX85ABRg2","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-21T15:57:43Z","updated_at":"2022-03-21T15:57:43Z","author_association":"CONTRIBUTOR","body":"I don't think I understand the question. Could you clarify what you mean?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074075702/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074156216","html_url":"https://github.com/apache/iceberg/issues/4368#issuecomment-1074156216","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4368","id":1074156216,"node_id":"IC_kwDOCW7NX85ABlK4","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-21T16:54:33Z","updated_at":"2022-03-21T16:54:33Z","author_association":"MEMBER","body":"I'm also a bit confused about the question here? I believe the code in question is just trying to find as many possible file locations as can be determined from the history. From most recent to oldest, it reads the metadata files listed in the log, it picks the first one (the most recent) which is readable.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074156216/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074163919","html_url":"https://github.com/apache/iceberg/pull/4359#issuecomment-1074163919","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4359","id":1074163919,"node_id":"IC_kwDOCW7NX85ABnDP","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-21T17:02:05Z","updated_at":"2022-03-21T17:02:05Z","author_association":"MEMBER","body":"I'm not sure I see the benefit to this change? Could you elaborate?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074163919/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074179530","html_url":"https://github.com/apache/iceberg/issues/4362#issuecomment-1074179530","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4362","id":1074179530,"node_id":"IC_kwDOCW7NX85ABq3K","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-21T17:16:03Z","updated_at":"2022-03-21T17:16:03Z","author_association":"MEMBER","body":"@szehon-ho as another option would it be to just change the output to JSON objects? So instead of map int -> buffer we do int-fieldid -> json representation?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074179530/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074209506","html_url":"https://github.com/apache/iceberg/issues/4362#issuecomment-1074209506","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4362","id":1074209506,"node_id":"IC_kwDOCW7NX85AByLi","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-21T17:33:26Z","updated_at":"2022-03-21T21:38:07Z","author_association":"COLLABORATOR","body":"@RussellSpitzer  why not just model as struct in this case for ease of sql?  (And overall question, can we change the type of these tables like that instead of making new tables/fields?\r\n\r\nEdited original issue to add this option","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074209506/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074448037","html_url":"https://github.com/apache/iceberg/issues/4362#issuecomment-1074448037","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4362","id":1074448037,"node_id":"IC_kwDOCW7NX85ACsal","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-21T21:40:25Z","updated_at":"2022-03-21T21:40:25Z","author_association":"COLLABORATOR","body":"Synced with @RussellSpitzer , the proposal was  similar.\r\n\r\nQuestion remains whether we want to change the existing field or not.  I'd prefer to keep existing as the map of field id -> binary may contain some information that the new field would not have (in case the field is removed in current schema), but i'm open. \r\n\r\n@rdblue @jackye1995 @aokolnychyi  fyi if you guys have any thoughts ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074448037/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074466914","html_url":"https://github.com/apache/iceberg/pull/4369#issuecomment-1074466914","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4369","id":1074466914,"node_id":"IC_kwDOCW7NX85ACxBi","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-21T22:06:30Z","updated_at":"2022-03-21T22:06:30Z","author_association":"COLLABORATOR","body":"Updated docs","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074466914/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074522805","html_url":"https://github.com/apache/iceberg/pull/4336#issuecomment-1074522805","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4336","id":1074522805,"node_id":"IC_kwDOCW7NX85AC-q1","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-21T23:28:56Z","updated_at":"2022-03-21T23:28:56Z","author_association":"CONTRIBUTOR","body":"Let me take a look today.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074522805/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074552054","html_url":"https://github.com/apache/iceberg/pull/4364#issuecomment-1074552054","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4364","id":1074552054,"node_id":"IC_kwDOCW7NX85ADFz2","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T00:24:03Z","updated_at":"2022-03-22T00:24:03Z","author_association":"CONTRIBUTOR","body":"Closing and reopening, as the test suite that failed is passing for me locally.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074552054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074565057","html_url":"https://github.com/apache/iceberg/pull/4372#issuecomment-1074565057","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4372","id":1074565057,"node_id":"IC_kwDOCW7NX85ADI_B","user":{"login":"liuml07","id":159186,"node_id":"MDQ6VXNlcjE1OTE4Ng==","avatar_url":"https://avatars.githubusercontent.com/u/159186?v=4","gravatar_id":"","url":"https://api.github.com/users/liuml07","html_url":"https://github.com/liuml07","followers_url":"https://api.github.com/users/liuml07/followers","following_url":"https://api.github.com/users/liuml07/following{/other_user}","gists_url":"https://api.github.com/users/liuml07/gists{/gist_id}","starred_url":"https://api.github.com/users/liuml07/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liuml07/subscriptions","organizations_url":"https://api.github.com/users/liuml07/orgs","repos_url":"https://api.github.com/users/liuml07/repos","events_url":"https://api.github.com/users/liuml07/events{/privacy}","received_events_url":"https://api.github.com/users/liuml07/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T00:49:13Z","updated_at":"2022-03-22T00:51:35Z","author_association":"MEMBER","body":"I have a unit test but I'm not sure it's worth to add it.\r\n\r\n```java\r\npackage org.apache.iceberg;\r\n\r\nimport org.apache.iceberg.relocated.com.google.common.collect.ImmutableSet;\r\nimport org.apache.iceberg.types.Types;\r\nimport org.junit.Assert;\r\nimport org.junit.Test;\r\n\r\npublic class TestSchema {\r\n  @Test\r\n  public void testValidateIdentifierField() {\r\n    try {\r\n      new Schema(\r\n          Types.StructType.of(Types.NestedField.required(1, \"id\", Types.StringType.get())).fields(),\r\n          ImmutableSet.of(2));\r\n      Assert.fail(\"Should have failed because identifier id 2 does not exist\");\r\n    } catch (IllegalArgumentException e) {\r\n      Assert.assertTrue(e.getMessage().contains(\"field not exists\"));\r\n    } // all other exception fails the test\r\n  }\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074565057/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074629360","html_url":"https://github.com/apache/iceberg/issues/4368#issuecomment-1074629360","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4368","id":1074629360,"node_id":"IC_kwDOCW7NX85ADYrw","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T02:03:51Z","updated_at":"2022-03-22T02:03:51Z","author_association":"CONTRIBUTOR","body":"because of list is LIFO,  the method of findFirstExistentPreviousMetadata's first metadata means of oldest I thinkbut from most recent to oldest@RussellSpitzerI want to ask find first metadata is the oldest or the recent to oldest?\r\n\r\nthanks @rdblue @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074629360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074633914","html_url":"https://github.com/apache/iceberg/issues/4368#issuecomment-1074633914","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4368","id":1074633914,"node_id":"IC_kwDOCW7NX85ADZy6","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T02:11:51Z","updated_at":"2022-03-22T02:11:51Z","author_association":"MEMBER","body":"I could have gotten it wrong, it's whatever the first element of the list is in the metadata.json.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074633914/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074674104","html_url":"https://github.com/apache/iceberg/issues/4368#issuecomment-1074674104","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4368","id":1074674104,"node_id":"IC_kwDOCW7NX85ADjm4","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T02:59:49Z","updated_at":"2022-03-22T02:59:49Z","author_association":"CONTRIBUTOR","body":"I got it, thanks and close this issue. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074674104/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074716201","html_url":"https://github.com/apache/iceberg/pull/4372#issuecomment-1074716201","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4372","id":1074716201,"node_id":"IC_kwDOCW7NX85ADt4p","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-03-22T04:33:47Z","updated_at":"2022-03-22T04:33:47Z","author_association":"COLLABORATOR","body":"> I have a unit test but I'm not sure it's worth to add it.\r\n> \r\n> ```java\r\n> package org.apache.iceberg;\r\n> \r\n> import org.apache.iceberg.relocated.com.google.common.collect.ImmutableSet;\r\n> import org.apache.iceberg.types.Types;\r\n> import org.junit.Assert;\r\n> import org.junit.Test;\r\n> \r\n> public class TestSchema {\r\n>   @Test\r\n>   public void testValidateIdentifierField() {\r\n>     try {\r\n>       new Schema(\r\n>           Types.StructType.of(Types.NestedField.required(1, \"id\", Types.StringType.get())).fields(),\r\n>           ImmutableSet.of(2));\r\n>       Assert.fail(\"Should have failed because identifier id 2 does not exist\");\r\n>     } catch (IllegalArgumentException e) {\r\n>       Assert.assertTrue(e.getMessage().contains(\"field not exists\"));\r\n>     } // all other exception fails the test\r\n>   }\r\n> }\r\n> ```\r\n\r\nI think we can put one in TestSchemaUpdate (where the original author seems to put some test of the other preconditions?)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1074716201/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]