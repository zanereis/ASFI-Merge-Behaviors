[{"url":"https://api.github.com/repos/apache/ratis/issues/comments/744112036","html_url":"https://github.com/apache/ratis/pull/175#issuecomment-744112036","issue_url":"https://api.github.com/repos/apache/ratis/issues/175","id":744112036,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NDExMjAzNg==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-14T01:26:14Z","updated_at":"2020-12-14T01:26:14Z","author_association":"CONTRIBUTOR","body":"Close this pr, because https://issues.apache.org/jira/browse/RATIS-967 can achieve this.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/744112036/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/744200129","html_url":"https://github.com/apache/ratis/pull/353#issuecomment-744200129","issue_url":"https://api.github.com/repos/apache/ratis/issues/353","id":744200129,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NDIwMDEyOQ==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-14T06:21:24Z","updated_at":"2020-12-14T06:21:24Z","author_association":"CONTRIBUTOR","body":"@szetszwo In my test, if seperate the thread pool, different clients's cost are almost same, but if use only one thread pool, different clients' cost vary a lot.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/744200129/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/747265213","html_url":"https://github.com/apache/ratis/pull/359#issuecomment-747265213","issue_url":"https://api.github.com/repos/apache/ratis/issues/359","id":747265213,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzI2NTIxMw==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T07:28:17Z","updated_at":"2020-12-17T07:28:58Z","author_association":"CONTRIBUTOR","body":"> Since priority is stored in RaftPeer, we could use RaftClient.setConfiguration to change priority. It needs some tests.\r\n\r\n@szetszwo Hi, I have test it, and change `hasNoChange`.\r\n\r\nBesides, if we want to change leader from server1 to server2, we can assign server2 with highest priority, but maybe we also need to force server1 stop accepting client request, otherwise, maybe server2 hard or take a long time to catch up with server1's log. What do you think ?\r\n","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/747265213/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/747269085","html_url":"https://github.com/apache/ratis/pull/360#issuecomment-747269085","issue_url":"https://api.github.com/repos/apache/ratis/issues/360","id":747269085,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzI2OTA4NQ==","user":{"login":"avijayanhwx","id":14299376,"node_id":"MDQ6VXNlcjE0Mjk5Mzc2","avatar_url":"https://avatars.githubusercontent.com/u/14299376?v=4","gravatar_id":"","url":"https://api.github.com/users/avijayanhwx","html_url":"https://github.com/avijayanhwx","followers_url":"https://api.github.com/users/avijayanhwx/followers","following_url":"https://api.github.com/users/avijayanhwx/following{/other_user}","gists_url":"https://api.github.com/users/avijayanhwx/gists{/gist_id}","starred_url":"https://api.github.com/users/avijayanhwx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/avijayanhwx/subscriptions","organizations_url":"https://api.github.com/users/avijayanhwx/orgs","repos_url":"https://api.github.com/users/avijayanhwx/repos","events_url":"https://api.github.com/users/avijayanhwx/events{/privacy}","received_events_url":"https://api.github.com/users/avijayanhwx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T07:37:41Z","updated_at":"2020-12-17T07:37:41Z","author_association":"CONTRIBUTOR","body":"cc @szetszwo / @hanishakoneru / @lokeshj1703 for review.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/747269085/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/747289479","html_url":"https://github.com/apache/ratis/pull/359#issuecomment-747289479","issue_url":"https://api.github.com/repos/apache/ratis/issues/359","id":747289479,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NzI4OTQ3OQ==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-17T08:25:06Z","updated_at":"2020-12-17T08:25:06Z","author_association":"CONTRIBUTOR","body":"> Besides, if we want to change leader from server1 to server2, we can assign server2 with highest priority, but maybe we also need to force server1 stop accepting client request, otherwise, maybe server2 hard or take a long time to catch up with server1's log. What do you think ?\r\n\r\nWe may force server1 to step down during configuration change.\r\n","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/747289479/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/748396823","html_url":"https://github.com/apache/ratis/pull/364#issuecomment-748396823","issue_url":"https://api.github.com/repos/apache/ratis/issues/364","id":748396823,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODM5NjgyMw==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-19T01:19:39Z","updated_at":"2020-12-19T01:41:32Z","author_association":"CONTRIBUTOR","body":"@szetszwo Hi, sorry, now I have one problem, where should I put the route table in proto ? Now I put route table in DataStreamInitProto, and encode DataStreamInitProto as  RaftClientRequestProto#message. But this can not work for filestore, because filestore encode FileStoreRequestProto as RaftClientRequestProto#message, I can only put route table in StreamWriteRequestProto. But this seems a little complicated, maybe we should put route table in a same proto, no matter whether it's filestore. Do you have any suggestion ?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/748396823/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/748422745","html_url":"https://github.com/apache/ratis/pull/364#issuecomment-748422745","issue_url":"https://api.github.com/repos/apache/ratis/issues/364","id":748422745,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODQyMjc0NQ==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-19T05:32:21Z","updated_at":"2020-12-19T05:32:21Z","author_association":"CONTRIBUTOR","body":"BTW, let's separate the FileStore change to another JIRA since RoutingTable is an important change.  We should focus on it.\r\n\r\nThanks a lot for working on this.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/748422745/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/748445410","html_url":"https://github.com/apache/ratis/pull/364#issuecomment-748445410","issue_url":"https://api.github.com/repos/apache/ratis/issues/364","id":748445410,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODQ0NTQxMA==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-19T09:00:55Z","updated_at":"2020-12-19T09:00:55Z","author_association":"CONTRIBUTOR","body":"> We probably should add the RoutingTableProto to RaftClientRequestProto\r\n\r\n@szetszwo I agree.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/748445410/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/748569007","html_url":"https://github.com/apache/ratis/pull/364#issuecomment-748569007","issue_url":"https://api.github.com/repos/apache/ratis/issues/364","id":748569007,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODU2OTAwNw==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-20T06:15:44Z","updated_at":"2020-12-20T06:15:44Z","author_association":"CONTRIBUTOR","body":"@szetszwo I have updated the patch, could you help review it again ?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/748569007/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/748587147","html_url":"https://github.com/apache/ratis/pull/364#issuecomment-748587147","issue_url":"https://api.github.com/repos/apache/ratis/issues/364","id":748587147,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODU4NzE0Nw==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-20T10:04:08Z","updated_at":"2020-12-20T10:04:08Z","author_association":"CONTRIBUTOR","body":"RoutingTable is a small interface to encapsulate the getSuccessors(..) method.  We want to use it instead of Map since we don't have to build a Map in some cases.  E.g. the default uses a RaftConfigurable to return the other peer ids.\r\n\r\nBTW, StreamInfo does not have to implement RoutingTable.  It may just provide a getSuccessors method as below.\r\n```\r\n    // StreamInfo\r\n    private Set<RaftPeer> getSuccessors(RaftPeerId peerId, RaftConfiguration conf) {\r\n      final RoutingTable routingTable = ...;\r\n      if (routingTable != null) {\r\n        return routingTable.getSuccessors(peerId).stream().map(conf::getPeer).collect(Collectors.toSet());\r\n      } if (isPrimary()) {\r\n        return conf.getCurrentPeers().stream()\r\n            .filter(p -> !p.getId().equals(server.getId()))\r\n            .collect(Collectors.toSet());\r\n      } else {\r\n        return Collections.emptySet();\r\n      }\r\n    }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/748587147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/748868456","html_url":"https://github.com/apache/ratis/pull/366#issuecomment-748868456","issue_url":"https://api.github.com/repos/apache/ratis/issues/366","id":748868456,"node_id":"MDEyOklzc3VlQ29tbWVudDc0ODg2ODQ1Ng==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-21T09:22:44Z","updated_at":"2020-12-21T09:22:44Z","author_association":"CONTRIBUTOR","body":"Thanks @runzhiwang .  Will review this tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/748868456/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/749374056","html_url":"https://github.com/apache/ratis/pull/366#issuecomment-749374056","issue_url":"https://api.github.com/repos/apache/ratis/issues/366","id":749374056,"node_id":"MDEyOklzc3VlQ29tbWVudDc0OTM3NDA1Ng==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-22T06:39:17Z","updated_at":"2020-12-22T06:39:17Z","author_association":"CONTRIBUTOR","body":"@szetszwo Thanks for review. CI passed, and I merge it.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/749374056/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/749418707","html_url":"https://github.com/apache/ratis/pull/366#issuecomment-749418707","issue_url":"https://api.github.com/repos/apache/ratis/issues/366","id":749418707,"node_id":"MDEyOklzc3VlQ29tbWVudDc0OTQxODcwNw==","user":{"login":"amaliujia","id":1938382,"node_id":"MDQ6VXNlcjE5MzgzODI=","avatar_url":"https://avatars.githubusercontent.com/u/1938382?v=4","gravatar_id":"","url":"https://api.github.com/users/amaliujia","html_url":"https://github.com/amaliujia","followers_url":"https://api.github.com/users/amaliujia/followers","following_url":"https://api.github.com/users/amaliujia/following{/other_user}","gists_url":"https://api.github.com/users/amaliujia/gists{/gist_id}","starred_url":"https://api.github.com/users/amaliujia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amaliujia/subscriptions","organizations_url":"https://api.github.com/users/amaliujia/orgs","repos_url":"https://api.github.com/users/amaliujia/repos","events_url":"https://api.github.com/users/amaliujia/events{/privacy}","received_events_url":"https://api.github.com/users/amaliujia/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-22T08:34:35Z","updated_at":"2020-12-22T08:34:35Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/749418707/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/749875466","html_url":"https://github.com/apache/ratis/pull/372#issuecomment-749875466","issue_url":"https://api.github.com/repos/apache/ratis/issues/372","id":749875466,"node_id":"MDEyOklzc3VlQ29tbWVudDc0OTg3NTQ2Ng==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-23T01:50:55Z","updated_at":"2020-12-23T01:50:55Z","author_association":"CONTRIBUTOR","body":"@szetszwo hi, This is only draft, could you have a brief review ? \r\n\r\n1. I did not include change priority in TransferLeaderShipRequest, I think change priority should be left to user, for example, there are 3 servers: server1, server2, server3, we want to transfer leadership from server1 to server2, we can assign server2 with highest priority, but we could not make sure whether server1's priority bigger or smaller than server3's priority, so I think this should be left to user to decide. When transferLeadership, I check whether server2 has the highest priority. \r\n\r\n2. Not sure whether TimeoutScheduler is enough, if user pass a big value of timeout, such as 100 seconds, but transferLeadership finish in 1 second, we should not return to client after 100 seconds, so maybe we have to check periodically to return to client as soon as possible.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/749875466/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/749899296","html_url":"https://github.com/apache/ratis/pull/372#issuecomment-749899296","issue_url":"https://api.github.com/repos/apache/ratis/issues/372","id":749899296,"node_id":"MDEyOklzc3VlQ29tbWVudDc0OTg5OTI5Ng==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-23T03:02:56Z","updated_at":"2020-12-23T03:02:56Z","author_association":"CONTRIBUTOR","body":"> Not sure whether TimeoutScheduler is enough, if user pass a big value of timeout, such as 100 seconds, but transferLeadership finish in 1 second, we should not return to client after 100 seconds, so maybe we have to check periodically to return to client as soon as possible.\r\n\r\nWhen the leader receives a request, it creates a reply future F and a timeout task T.  If the leader has successfully transferred leadership within timeout, it completes F.  When timeout occurs, T checks if F has already been completed.  If yes, T does nothing.  Otherwise, it completes F exceptionally.\r\n\r\nIn asynchronous event driven, everything is triggered by an event.  It should not periodically check if an event has occurred.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/749899296/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/749899631","html_url":"https://github.com/apache/ratis/pull/372#issuecomment-749899631","issue_url":"https://api.github.com/repos/apache/ratis/issues/372","id":749899631,"node_id":"MDEyOklzc3VlQ29tbWVudDc0OTg5OTYzMQ==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-23T03:04:01Z","updated_at":"2020-12-23T03:04:01Z","author_association":"CONTRIBUTOR","body":"> I did not include change priority in TransferLeaderShipRequest, ...\r\n\r\nSounds great.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/749899631/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/749929219","html_url":"https://github.com/apache/ratis/pull/371#issuecomment-749929219","issue_url":"https://api.github.com/repos/apache/ratis/issues/371","id":749929219,"node_id":"MDEyOklzc3VlQ29tbWVudDc0OTkyOTIxOQ==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-23T04:45:02Z","updated_at":"2020-12-23T04:45:02Z","author_association":"CONTRIBUTOR","body":"> build-branch / compile (11) (pull_request) Failing after 2s — compile (11)\r\n\r\nThe failure is not related.\r\n","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/749929219/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/749978687","html_url":"https://github.com/apache/ratis/pull/372#issuecomment-749978687","issue_url":"https://api.github.com/repos/apache/ratis/issues/372","id":749978687,"node_id":"MDEyOklzc3VlQ29tbWVudDc0OTk3ODY4Nw==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-23T07:09:41Z","updated_at":"2020-12-23T07:09:41Z","author_association":"CONTRIBUTOR","body":"@szetszwo I have updated the patch, Could you help review it again ?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/749978687/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/750036972","html_url":"https://github.com/apache/ratis/pull/372#issuecomment-750036972","issue_url":"https://api.github.com/repos/apache/ratis/issues/372","id":750036972,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MDAzNjk3Mg==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-23T09:30:25Z","updated_at":"2020-12-23T09:30:25Z","author_association":"CONTRIBUTOR","body":"Tried to move the code during review but I have not tested it.\r\n```\r\nclass TransferLeadership {\r\n  public static final Logger LOG = LoggerFactory.getLogger(TransferLeadership.class);\r\n\r\n  class PendingRequest {\r\n    private final TransferLeadershipRequest request;\r\n    private final CompletableFuture<RaftClientReply> replyFuture = new CompletableFuture<>();\r\n\r\n    PendingRequest(TransferLeadershipRequest request) {\r\n      this.request = request;\r\n    }\r\n\r\n    TransferLeadershipRequest getRequest() {\r\n      return request;\r\n    }\r\n\r\n    CompletableFuture<RaftClientReply> getReplyFuture() {\r\n      return replyFuture;\r\n    }\r\n\r\n    void complete(RaftPeerId currentLeader) {\r\n      if (replyFuture.isDone()) {\r\n        return;\r\n      }\r\n\r\n      if (currentLeader.equals(request.getNewLeader())) {\r\n        replyFuture.complete(server.newSuccessReply(request));\r\n      } else {\r\n        final TransferLeadershipException e = new TransferLeadershipException(\r\n            \"Failed to transfer leadership to \" + request.getNewLeader() + \": current leader is \" + currentLeader);\r\n        replyFuture.complete(server.newExceptionReply(request, e));\r\n      }\r\n    }\r\n\r\n    @Override\r\n    public String toString() {\r\n      return request.toString();\r\n    }\r\n  }\r\n\r\n  private final RaftServerImpl server;\r\n  private final TimeoutScheduler scheduler = TimeoutScheduler.getInstance();\r\n  private final AtomicReference<PendingRequest> pending = new AtomicReference<>();\r\n\r\n  TransferLeadership(RaftServerImpl server) {\r\n    this.server = server;\r\n  }\r\n\r\n  CompletableFuture<RaftClientReply> start(TransferLeadershipRequest request) {\r\n    final MemoizedSupplier<PendingRequest> supplier = JavaUtils.memoize(() -> new PendingRequest(request));\r\n    final PendingRequest previous = pending.getAndUpdate(f -> f != null? f: supplier.get());\r\n    if (previous != null) {\r\n      if (request.getNewLeader().equals(previous.getRequest().getNewLeader())) {\r\n        final CompletableFuture<RaftClientReply> replyFuture = new CompletableFuture<>();\r\n        previous.getReplyFuture().whenComplete((r, e) -> {\r\n          if (e != null) {\r\n            replyFuture.completeExceptionally(e);\r\n          } else {\r\n            replyFuture.complete(r.isSuccess()? server.newSuccessReply(request)\r\n                : server.newExceptionReply(request, r.getException()));\r\n          }\r\n        });\r\n        return replyFuture;\r\n      } else {\r\n        final StateMachineException sme = new StateMachineException(\r\n            \"Failed to transfer leadership to \" + request.getNewLeader() + \": a previous \" + previous + \" exists\");\r\n        return CompletableFuture.completedFuture(server.newExceptionReply(request, sme));\r\n      }\r\n    }\r\n\r\n    scheduler.onTimeout(TimeDuration.ONE_SECOND,\r\n        () -> finish(server.getState().getLeaderId()),\r\n        LOG, () -> \"Timeout check failed for append entry request: \" + request);\r\n    return supplier.get().getReplyFuture();\r\n  }\r\n\r\n  void finish(RaftPeerId currentLeader) {\r\n    Optional.ofNullable(pending.getAndSet(null))\r\n        .ifPresent(r -> r.complete(currentLeader));\r\n  }\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/750036972/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/750226682","html_url":"https://github.com/apache/ratis/pull/372#issuecomment-750226682","issue_url":"https://api.github.com/repos/apache/ratis/issues/372","id":750226682,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MDIyNjY4Mg==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-23T12:02:19Z","updated_at":"2020-12-23T12:02:19Z","author_association":"CONTRIBUTOR","body":"@szetszwo Thanks the code very much, I will use it.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/750226682/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/750296198","html_url":"https://github.com/apache/ratis/pull/372#issuecomment-750296198","issue_url":"https://api.github.com/repos/apache/ratis/issues/372","id":750296198,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MDI5NjE5OA==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-23T13:15:35Z","updated_at":"2020-12-23T13:15:35Z","author_association":"CONTRIBUTOR","body":"> Do I need to put the following check code in TransferLeadership class ? ...\r\n\r\nLet's keep them in RaftServerImpl.  Thanks.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/750296198/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/750601995","html_url":"https://github.com/apache/ratis/pull/372#issuecomment-750601995","issue_url":"https://api.github.com/repos/apache/ratis/issues/372","id":750601995,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MDYwMTk5NQ==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-24T00:01:00Z","updated_at":"2020-12-24T00:01:00Z","author_association":"CONTRIBUTOR","body":"@szetszwo I have updated the patch. Could you help review it again ?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/750601995/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/750736393","html_url":"https://github.com/apache/ratis/pull/373#issuecomment-750736393","issue_url":"https://api.github.com/repos/apache/ratis/issues/373","id":750736393,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MDczNjM5Mw==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-24T04:35:30Z","updated_at":"2020-12-24T04:35:59Z","author_association":"CONTRIBUTOR","body":"@szetszwo If want to support timeout when transfer leadership, I need the following change in grpc call, otherwise request will timeout by requestTimeoutDuration, default 3 seconds. So if without following change, even though I set timeout to 10 seconds, the call will also timeout after 3 seconds. If you agree with this change, I will also change the netty call.\r\n\r\n```\r\n   RaftClientReplyProto transferLeadership(\r\n       TransferLeadershipRequestProto request) throws IOException {\r\n+    TimeDuration duration = TimeDuration.valueOf(\r\n+        requestTimeoutDuration.getDuration(), requestTimeoutDuration.getUnit());\r\n+    TimeDuration durationInMs = duration.to(TimeUnit.MILLISECONDS);\r\n     return blockingCall(() -> blockingStub\r\n-        .withDeadlineAfter(requestTimeoutDuration.getDuration(), requestTimeoutDuration.getUnit())\r\n+        .withDeadlineAfter(durationInMs.getDuration() + request.getTimeoutInMs(), TimeUnit.MILLISECONDS)\r\n         .transferLeadership(request));\r\n   }\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/750736393/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/750744297","html_url":"https://github.com/apache/ratis/pull/373#issuecomment-750744297","issue_url":"https://api.github.com/repos/apache/ratis/issues/373","id":750744297,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MDc0NDI5Nw==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-24T05:11:11Z","updated_at":"2020-12-24T05:11:11Z","author_association":"CONTRIBUTOR","body":"Sure.   It should use max instead adding two timeout values together.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/750744297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/750748956","html_url":"https://github.com/apache/ratis/pull/373#issuecomment-750748956","issue_url":"https://api.github.com/repos/apache/ratis/issues/373","id":750748956,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MDc0ODk1Ng==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-24T05:31:17Z","updated_at":"2020-12-24T05:32:41Z","author_association":"CONTRIBUTOR","body":"> Sure. It should use max instead adding two timeout values together.\r\n\r\n@szetszwo Use the max does not work, because rpc call count time before TransferLeadership#scheduler, so if we use the max, such as 10 seconds, maybe when TransferLeadership#scheduler count time to 9.9 seconds, rpc call already count to 10 seconds, so rpc call timeout before TransferLeadership#scheduler timeout. So the timeout value of rpc call should be larger than TransferLeadership#schedule","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/750748956/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/750818144","html_url":"https://github.com/apache/ratis/pull/373#issuecomment-750818144","issue_url":"https://api.github.com/repos/apache/ratis/issues/373","id":750818144,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MDgxODE0NA==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-24T09:15:29Z","updated_at":"2020-12-24T09:15:29Z","author_association":"CONTRIBUTOR","body":"I see.  Then we should add two timeout values together.  Thanks.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/750818144/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/751142382","html_url":"https://github.com/apache/ratis/pull/375#issuecomment-751142382","issue_url":"https://api.github.com/repos/apache/ratis/issues/375","id":751142382,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MTE0MjM4Mg==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-25T01:31:06Z","updated_at":"2020-12-25T01:31:06Z","author_association":"CONTRIBUTOR","body":"@szetszwo Thanks for review. Because ci passed, so I merge it.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/751142382/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/751144255","html_url":"https://github.com/apache/ratis/pull/373#issuecomment-751144255","issue_url":"https://api.github.com/repos/apache/ratis/issues/373","id":751144255,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MTE0NDI1NQ==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-25T01:45:56Z","updated_at":"2020-12-25T01:45:56Z","author_association":"CONTRIBUTOR","body":"@szetszwo I have updated the patch, could you help review it again ?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/751144255/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/751162117","html_url":"https://github.com/apache/ratis/pull/373#issuecomment-751162117","issue_url":"https://api.github.com/repos/apache/ratis/issues/373","id":751162117,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MTE2MjExNw==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-25T03:50:07Z","updated_at":"2020-12-25T03:50:07Z","author_association":"CONTRIBUTOR","body":"will fix the failed ut","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/751162117/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/751185724","html_url":"https://github.com/apache/ratis/pull/373#issuecomment-751185724","issue_url":"https://api.github.com/repos/apache/ratis/issues/373","id":751185724,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MTE4NTcyNA==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-25T06:30:18Z","updated_at":"2020-12-25T06:30:18Z","author_association":"CONTRIBUTOR","body":"failed ut has been fixed","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/751185724/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/751233492","html_url":"https://github.com/apache/ratis/pull/373#issuecomment-751233492","issue_url":"https://api.github.com/repos/apache/ratis/issues/373","id":751233492,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MTIzMzQ5Mg==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-25T11:07:45Z","updated_at":"2020-12-25T11:07:45Z","author_association":"CONTRIBUTOR","body":"@szetszwo Thanks for review. Becase ci passed, so I merge it.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/751233492/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/751257201","html_url":"https://github.com/apache/ratis/pull/377#issuecomment-751257201","issue_url":"https://api.github.com/repos/apache/ratis/issues/377","id":751257201,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MTI1NzIwMQ==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-25T14:31:08Z","updated_at":"2020-12-25T14:31:08Z","author_association":"CONTRIBUTOR","body":"@ferhui , thanks a lot for working on this.  We should make Streaming port optional for these examples since they are not using Streaming.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/751257201/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/751425434","html_url":"https://github.com/apache/ratis/pull/376#issuecomment-751425434","issue_url":"https://api.github.com/repos/apache/ratis/issues/376","id":751425434,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MTQyNTQzNA==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-27T04:39:11Z","updated_at":"2020-12-27T04:39:11Z","author_association":"CONTRIBUTOR","body":"@szetszwo Thanks for review. Because CI passed, so I merge it.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/751425434/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/751590617","html_url":"https://github.com/apache/ratis/pull/377#issuecomment-751590617","issue_url":"https://api.github.com/repos/apache/ratis/issues/377","id":751590617,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MTU5MDYxNw==","user":{"login":"ferhui","id":2336003,"node_id":"MDQ6VXNlcjIzMzYwMDM=","avatar_url":"https://avatars.githubusercontent.com/u/2336003?v=4","gravatar_id":"","url":"https://api.github.com/users/ferhui","html_url":"https://github.com/ferhui","followers_url":"https://api.github.com/users/ferhui/followers","following_url":"https://api.github.com/users/ferhui/following{/other_user}","gists_url":"https://api.github.com/users/ferhui/gists{/gist_id}","starred_url":"https://api.github.com/users/ferhui/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ferhui/subscriptions","organizations_url":"https://api.github.com/users/ferhui/orgs","repos_url":"https://api.github.com/users/ferhui/repos","events_url":"https://api.github.com/users/ferhui/events{/privacy}","received_events_url":"https://api.github.com/users/ferhui/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-28T06:07:01Z","updated_at":"2020-12-28T06:07:01Z","author_association":"CONTRIBUTOR","body":"@szetszwo Thanks for review! \r\nNew commits:\r\n\r\n- datastream port is optional\r\n- fix client argument\r\n","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/751590617/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/752032537","html_url":"https://github.com/apache/ratis/pull/384#issuecomment-752032537","issue_url":"https://api.github.com/repos/apache/ratis/issues/384","id":752032537,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjAzMjUzNw==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-29T10:48:25Z","updated_at":"2020-12-29T10:48:25Z","author_association":"CONTRIBUTOR","body":"@szetszwo Thanks for review. Because CI passed, so I merge the patch.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/752032537/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/752342620","html_url":"https://github.com/apache/ratis/pull/385#issuecomment-752342620","issue_url":"https://api.github.com/repos/apache/ratis/issues/385","id":752342620,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjM0MjYyMA==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T06:19:34Z","updated_at":"2020-12-30T06:19:34Z","author_association":"CONTRIBUTOR","body":"Sorry, still need some change","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/752342620/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/752372362","html_url":"https://github.com/apache/ratis/pull/385#issuecomment-752372362","issue_url":"https://api.github.com/repos/apache/ratis/issues/385","id":752372362,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjM3MjM2Mg==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T08:25:01Z","updated_at":"2020-12-30T08:25:01Z","author_association":"CONTRIBUTOR","body":"ready for review","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/752372362/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/752381079","html_url":"https://github.com/apache/ratis/pull/385#issuecomment-752381079","issue_url":"https://api.github.com/repos/apache/ratis/issues/385","id":752381079,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjM4MTA3OQ==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T08:59:09Z","updated_at":"2020-12-30T08:59:09Z","author_association":"CONTRIBUTOR","body":"Since this already has passed all the checks, let's merge this first and work on the suggestions separately.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/752381079/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/752381531","html_url":"https://github.com/apache/ratis/pull/385#issuecomment-752381531","issue_url":"https://api.github.com/repos/apache/ratis/issues/385","id":752381531,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjM4MTUzMQ==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T09:00:46Z","updated_at":"2020-12-30T09:00:46Z","author_association":"CONTRIBUTOR","body":"@szetszwo Thanks for review. I will work on the suggestions.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/752381531/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/752638187","html_url":"https://github.com/apache/ratis/pull/387#issuecomment-752638187","issue_url":"https://api.github.com/repos/apache/ratis/issues/387","id":752638187,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjYzODE4Nw==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T14:21:06Z","updated_at":"2020-12-30T14:21:06Z","author_association":"CONTRIBUTOR","body":"@szetszwo Thanks for review.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/752638187/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/752791803","html_url":"https://github.com/apache/ratis/pull/388#issuecomment-752791803","issue_url":"https://api.github.com/repos/apache/ratis/issues/388","id":752791803,"node_id":"MDEyOklzc3VlQ29tbWVudDc1Mjc5MTgwMw==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-30T23:41:56Z","updated_at":"2020-12-30T23:41:56Z","author_association":"CONTRIBUTOR","body":"@szetszwo Hi, I have test this PR, it does work. Could you help explain the root cause of the problem ?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/752791803/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/752811602","html_url":"https://github.com/apache/ratis/pull/388#issuecomment-752811602","issue_url":"https://api.github.com/repos/apache/ratis/issues/388","id":752811602,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjgxMTYwMg==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-31T01:34:36Z","updated_at":"2020-12-31T01:34:36Z","author_association":"CONTRIBUTOR","body":"@runzhiwang , thanks a lot for testing it.\r\n\r\n```\r\n-            .setBuffer(decodeData(buf, header, b -> b.copy().nioBuffer()))\r\n+            .setBuffer(decodeData(buf, header, NettyDataStreamUtils::copy))\r\n```\r\nThe original code uses Netty ByteBuf.copy().  It allocates a ByteBuf object from its buffer pool and the object needs to be released afterward.  Otherwise, there is a leak.\r\n\r\nThe new code copies the ByteBuf by creating a new byte[].  Of course, Java will gc it afterward as usual.\r\n","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/752811602/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/753797923","html_url":"https://github.com/apache/ratis/pull/390#issuecomment-753797923","issue_url":"https://api.github.com/repos/apache/ratis/issues/390","id":753797923,"node_id":"MDEyOklzc3VlQ29tbWVudDc1Mzc5NzkyMw==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T07:04:35Z","updated_at":"2021-01-04T07:04:35Z","author_association":"CONTRIBUTOR","body":"@szetszwo Thanks the patch. I have merged it.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/753797923/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/754469273","html_url":"https://github.com/apache/ratis/pull/378#issuecomment-754469273","issue_url":"https://api.github.com/repos/apache/ratis/issues/378","id":754469273,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDQ2OTI3Mw==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T07:53:01Z","updated_at":"2021-01-05T07:53:01Z","author_association":"CONTRIBUTOR","body":"> I somehow have overlooked this pull request.\r\n\r\n@szetszwo Thanks for review. It does not matter. ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/754469273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/754469628","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-754469628","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":754469628,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDQ2OTYyOA==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T07:53:41Z","updated_at":"2021-01-05T07:53:41Z","author_association":"CONTRIBUTOR","body":"@szetszwo Could you help review this proposal ?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/754469628/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/754474016","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-754474016","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":754474016,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDQ3NDAxNg==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T08:02:50Z","updated_at":"2021-01-05T08:02:50Z","author_association":"CONTRIBUTOR","body":"Sure, will review this.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/754474016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/754477166","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-754477166","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":754477166,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDQ3NzE2Ng==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T08:09:08Z","updated_at":"2021-01-05T08:09:08Z","author_association":"CONTRIBUTOR","body":"The design looks good. Will look at the code changes.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/754477166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/754509804","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-754509804","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":754509804,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDUwOTgwNA==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T09:13:08Z","updated_at":"2021-01-05T09:13:08Z","author_association":"CONTRIBUTOR","body":"Question: when the leader has lost the leader lease, should it step down?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/754509804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/754531751","html_url":"https://github.com/apache/ratis/pull/378#issuecomment-754531751","issue_url":"https://api.github.com/repos/apache/ratis/issues/378","id":754531751,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDUzMTc1MQ==","user":{"login":"lokeshj1703","id":9255455,"node_id":"MDQ6VXNlcjkyNTU0NTU=","avatar_url":"https://avatars.githubusercontent.com/u/9255455?v=4","gravatar_id":"","url":"https://api.github.com/users/lokeshj1703","html_url":"https://github.com/lokeshj1703","followers_url":"https://api.github.com/users/lokeshj1703/followers","following_url":"https://api.github.com/users/lokeshj1703/following{/other_user}","gists_url":"https://api.github.com/users/lokeshj1703/gists{/gist_id}","starred_url":"https://api.github.com/users/lokeshj1703/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lokeshj1703/subscriptions","organizations_url":"https://api.github.com/users/lokeshj1703/orgs","repos_url":"https://api.github.com/users/lokeshj1703/repos","events_url":"https://api.github.com/users/lokeshj1703/events{/privacy}","received_events_url":"https://api.github.com/users/lokeshj1703/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T09:54:50Z","updated_at":"2021-01-05T09:54:50Z","author_association":"CONTRIBUTOR","body":"@runzhiwang Thanks for the contribution! @szetszwo Thanks for the review! I have committed the PR to master branch.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/754531751/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/754558533","html_url":"https://github.com/apache/ratis/pull/378#issuecomment-754558533","issue_url":"https://api.github.com/repos/apache/ratis/issues/378","id":754558533,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDU1ODUzMw==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T10:45:31Z","updated_at":"2021-01-05T10:45:31Z","author_association":"CONTRIBUTOR","body":"@lokeshj1703 @szetszwo Thanks for review.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/754558533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/755035694","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-755035694","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":755035694,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTAzNTY5NA==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-06T02:28:35Z","updated_at":"2021-01-06T02:28:35Z","author_association":"CONTRIBUTOR","body":"@szetszwo Hi, because this PR depends on Pre-Vote PR: https://github.com/apache/incubator-ratis/pull/161. So I want to modify Pre-Vote PR first, after Pre-Vote PR was merged, then I continue to work on this PR. what do you think ?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/755035694/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/755036702","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-755036702","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":755036702,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTAzNjcwMg==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-06T02:31:58Z","updated_at":"2021-01-06T02:31:58Z","author_association":"CONTRIBUTOR","body":"Sure, the plan sounds great.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/755036702/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/755136290","html_url":"https://github.com/apache/ratis/pull/161#issuecomment-755136290","issue_url":"https://api.github.com/repos/apache/ratis/issues/161","id":755136290,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTEzNjI5MA==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-06T07:32:02Z","updated_at":"2021-01-06T07:32:02Z","author_association":"CONTRIBUTOR","body":"@szetszwo I have updated this pre-vote patch. Could you help review it ?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/755136290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/755185123","html_url":"https://github.com/apache/ratis/pull/161#issuecomment-755185123","issue_url":"https://api.github.com/repos/apache/ratis/issues/161","id":755185123,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTE4NTEyMw==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-06T09:23:16Z","updated_at":"2021-01-06T09:23:16Z","author_association":"CONTRIBUTOR","body":"will fix the failed ut.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/755185123/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/755273565","html_url":"https://github.com/apache/ratis/pull/161#issuecomment-755273565","issue_url":"https://api.github.com/repos/apache/ratis/issues/161","id":755273565,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTI3MzU2NQ==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-06T12:32:25Z","updated_at":"2021-01-06T12:32:25Z","author_association":"CONTRIBUTOR","body":"> There are quite many code duplications between pre-vote and vote. We may refactor the code here or in a separated JIRA.\r\n\r\n@szetszwo Thanks for review. I will refactor the code in next PR. \r\n\r\nBesides, when s1 transferLeaderShip to s2,  s2 should skip askForPreVote, and askForVote directly. Because when s2 askForPreVote, s1 and s3 will reject it because current leader is still valid. So I add a flag: LeaderElection#force which means we should skip askForPreVote and askForVote directly, this flag will be true when s2 receive StartLeaderElectionRequest.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/755273565/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/755332894","html_url":"https://github.com/apache/ratis/pull/161#issuecomment-755332894","issue_url":"https://api.github.com/repos/apache/ratis/issues/161","id":755332894,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTMzMjg5NA==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-06T14:33:23Z","updated_at":"2021-01-06T14:33:23Z","author_association":"CONTRIBUTOR","body":"> ...  I will refactor the code in next PR.\r\n\r\n@runzhiwang , thanks a lot.  Since you are working on RATIS-1273, let me do the refactoring.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/755332894/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/755335868","html_url":"https://github.com/apache/ratis/pull/161#issuecomment-755335868","issue_url":"https://api.github.com/repos/apache/ratis/issues/161","id":755335868,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTMzNTg2OA==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-06T14:38:31Z","updated_at":"2021-01-06T14:38:31Z","author_association":"CONTRIBUTOR","body":"@szetszwo  Sure, thanks a lot.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/755335868/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/756074220","html_url":"https://github.com/apache/ratis/pull/391#issuecomment-756074220","issue_url":"https://api.github.com/repos/apache/ratis/issues/391","id":756074220,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NjA3NDIyMA==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T12:00:30Z","updated_at":"2021-01-07T12:00:30Z","author_association":"CONTRIBUTOR","body":"@szetszwo Thanks the patch. I have merged it.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/756074220/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/756515315","html_url":"https://github.com/apache/ratis/pull/392#issuecomment-756515315","issue_url":"https://api.github.com/repos/apache/ratis/issues/392","id":756515315,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NjUxNTMxNQ==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-08T02:55:34Z","updated_at":"2021-01-08T02:55:34Z","author_association":"CONTRIBUTOR","body":"@szetszwo Thanks the patch. I have merged it.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/756515315/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/756887260","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-756887260","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":756887260,"node_id":"MDEyOklzc3VlQ29tbWVudDc1Njg4NzI2MA==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-08T17:12:57Z","updated_at":"2021-01-08T17:12:57Z","author_association":"CONTRIBUTOR","body":"> We may not need the LEADER_LEASE_TIMEOUT_RATIO_KEY at the very beginning. ...\r\n\r\nI agree with @GlenGeng that we may not need LEADER_LEASE_TIMEOUT_RATIO_KEY.  If we take rpc-send-time right before sending out appendEntries, it seems pretty safe to use min-rpc-timeout as the leader-lease-timeout.  If split brain happens, it has to take at least (min-rpc-timeout + leader election time) to elect a new leader.  Then, the old leader lease must be expired by that time.\r\n\r\n@runzhiwang , what do you think?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/756887260/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/757410153","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-757410153","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":757410153,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzQxMDE1Mw==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-10T03:56:14Z","updated_at":"2021-01-10T03:56:14Z","author_association":"CONTRIBUTOR","body":"> I agree with @GlenGeng that we may not need LEADER_LEASE_TIMEOUT_RATIO_KEY. If we take rpc-send-time right before sending out appendEntries, it seems pretty safe to use min-rpc-timeout as the leader-lease-timeout. If split brain happens, it has to take at least (min-rpc-timeout + leader election time) to elect a new leader. Then, the old leader lease must be expired by that time.\r\n\r\n@szetszwo I agree. There are some failed ut related to this PR, let me fix them.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/757410153/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/757740636","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-757740636","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":757740636,"node_id":"MDEyOklzc3VlQ29tbWVudDc1Nzc0MDYzNg==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-11T08:49:57Z","updated_at":"2021-01-11T08:49:57Z","author_association":"CONTRIBUTOR","body":"@runzhiwang , thanks a lot.\r\n\r\nBTW, we should add confs to enable/disable PreVote and LeaderLease.  Some applications may not require these features.  This is suggested by @bshashikant .","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/757740636/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/757918564","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-757918564","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":757918564,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzkxODU2NA==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-11T12:23:32Z","updated_at":"2021-01-11T12:23:32Z","author_association":"CONTRIBUTOR","body":"@szetszwo @bharatviswa504 Thanks, got it. I will add config in next PR.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/757918564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/757923211","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-757923211","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":757923211,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzkyMzIxMQ==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-11T12:33:16Z","updated_at":"2021-01-11T12:33:16Z","author_association":"CONTRIBUTOR","body":"@szetszwo @bharatviswa504 Sorry, I have a question, I understand LeaderLease maybe not needed in some applications. But \r\nin my thinking PreVote is needed in any application, it can make the leader more steady, what do you think ?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/757923211/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/757980043","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-757980043","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":757980043,"node_id":"MDEyOklzc3VlQ29tbWVudDc1Nzk4MDA0Mw==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-11T14:18:12Z","updated_at":"2021-01-11T14:18:12Z","author_association":"CONTRIBUTOR","body":"@runzhiwang , in general, I agree that PreVote should help for all the applications.  However, PreVote needs an additional phase before the real election.  It could potentially slows down some applications.  Individual applications like Ozone may want to benchmark it.  If it is not configurable, it is impossible to benchmark.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/757980043/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/758353867","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-758353867","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":758353867,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODM1Mzg2Nw==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-12T02:33:14Z","updated_at":"2021-01-12T02:33:14Z","author_association":"CONTRIBUTOR","body":"@szetszwo Thanks, got it. With leader lease, some ut become flaky, I need some time to fix them.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/758353867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/758358279","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-758358279","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":758358279,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODM1ODI3OQ==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-12T02:46:42Z","updated_at":"2021-01-12T02:46:42Z","author_association":"CONTRIBUTOR","body":"@runzhiwang , No problem.  Please take you time.  Thanks a lot for working hard on this.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/758358279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/759411485","html_url":"https://github.com/apache/ratis/pull/393#issuecomment-759411485","issue_url":"https://api.github.com/repos/apache/ratis/issues/393","id":759411485,"node_id":"MDEyOklzc3VlQ29tbWVudDc1OTQxMTQ4NQ==","user":{"login":"ferhui","id":2336003,"node_id":"MDQ6VXNlcjIzMzYwMDM=","avatar_url":"https://avatars.githubusercontent.com/u/2336003?v=4","gravatar_id":"","url":"https://api.github.com/users/ferhui","html_url":"https://github.com/ferhui","followers_url":"https://api.github.com/users/ferhui/followers","following_url":"https://api.github.com/users/ferhui/following{/other_user}","gists_url":"https://api.github.com/users/ferhui/gists{/gist_id}","starred_url":"https://api.github.com/users/ferhui/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ferhui/subscriptions","organizations_url":"https://api.github.com/users/ferhui/orgs","repos_url":"https://api.github.com/users/ferhui/repos","events_url":"https://api.github.com/users/ferhui/events{/privacy}","received_events_url":"https://api.github.com/users/ferhui/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-13T12:17:30Z","updated_at":"2021-01-13T12:17:30Z","author_association":"CONTRIBUTOR","body":"@lokeshj1703 Hi, i see you add this test, could you please take a look? Thanks","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/759411485/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/760031039","html_url":"https://github.com/apache/ratis/pull/393#issuecomment-760031039","issue_url":"https://api.github.com/repos/apache/ratis/issues/393","id":760031039,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDAzMTAzOQ==","user":{"login":"ferhui","id":2336003,"node_id":"MDQ6VXNlcjIzMzYwMDM=","avatar_url":"https://avatars.githubusercontent.com/u/2336003?v=4","gravatar_id":"","url":"https://api.github.com/users/ferhui","html_url":"https://github.com/ferhui","followers_url":"https://api.github.com/users/ferhui/followers","following_url":"https://api.github.com/users/ferhui/following{/other_user}","gists_url":"https://api.github.com/users/ferhui/gists{/gist_id}","starred_url":"https://api.github.com/users/ferhui/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ferhui/subscriptions","organizations_url":"https://api.github.com/users/ferhui/orgs","repos_url":"https://api.github.com/users/ferhui/repos","events_url":"https://api.github.com/users/ferhui/events{/privacy}","received_events_url":"https://api.github.com/users/ferhui/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-14T08:50:19Z","updated_at":"2021-01-14T08:50:19Z","author_association":"CONTRIBUTOR","body":"Detail about this PR, I have post it to jira, and paste it here.\r\n\r\nThe first while clause in TestRetryCacheWithGrpc#testRetryOnResourceUnavailableException\r\n```\r\nwhile (!failure.get()) {\r\n  long cid = callId;\r\n  r = cluster.newRaftClientRequest(clientId, leaderProxy.getId(), callId++,\r\n      new RaftTestUtil.SimpleMessage(\"message\"));\r\n  CompletableFuture<RaftClientReply> f = leaderProxy.submitClientRequestAsync(r);\r\n  f.exceptionally(e -> {\r\n      if (e.getCause() instanceof ResourceUnavailableException) {\r\n        RetryCacheTestUtil.isFailed(RetryCacheTestUtil.get(leader, clientId, cid));\r\n        failure.set(true);\r\n      }\r\n      return null;\r\n  });\r\n}\r\n```\r\n\r\nThere are 2 requests here, and because followers call blockWriteStateMachineData, the first request will be blocked, and ELEMENT_LIMIT_KEY is 1, the second request will fail and receive ResourceUnavailableException.\r\n\r\nAfter quittng the first while clause. Followers call unblockWriteStateMachineData\r\n\r\nIn the second while clause\r\n```\r\nwhile (failure.get()) {\r\n  try {\r\n  // retry until the request failed with ResourceUnavailableException succeeds.\r\n  leaderProxy.submitClientRequestAsync(r).get();\r\n  } catch (Exception e) {\r\n    failure.set(false);\r\n  }\r\n}\r\n```\r\n\r\nThere are 2 cases: 1. If the first request has been done, the 3rd request will be handled, and later requests will hit retrycache, and server will always return success. It couldn't get Exception and enter infinite loop. 2. If the first request hasn't been done, and the 3rd request has been reach the server, it will get   ResourceUnavailableException and set failure true, and quit the loop.\r\n\r\nMostly the case 1 occurs, and this UT nearly always fails\r\n\r\nSo i suggest that quit the loop when request handled successfully as the comments say\r\n\r\n> // retry until the request failed with ResourceUnavailableException succeeds.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/760031039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/760770669","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-760770669","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":760770669,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDc3MDY2OQ==","user":{"login":"GlenGeng-awx","id":8412672,"node_id":"MDQ6VXNlcjg0MTI2NzI=","avatar_url":"https://avatars.githubusercontent.com/u/8412672?v=4","gravatar_id":"","url":"https://api.github.com/users/GlenGeng-awx","html_url":"https://github.com/GlenGeng-awx","followers_url":"https://api.github.com/users/GlenGeng-awx/followers","following_url":"https://api.github.com/users/GlenGeng-awx/following{/other_user}","gists_url":"https://api.github.com/users/GlenGeng-awx/gists{/gist_id}","starred_url":"https://api.github.com/users/GlenGeng-awx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GlenGeng-awx/subscriptions","organizations_url":"https://api.github.com/users/GlenGeng-awx/orgs","repos_url":"https://api.github.com/users/GlenGeng-awx/repos","events_url":"https://api.github.com/users/GlenGeng-awx/events{/privacy}","received_events_url":"https://api.github.com/users/GlenGeng-awx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-15T09:12:17Z","updated_at":"2021-01-15T09:12:17Z","author_association":"CONTRIBUTOR","body":"For now, me and @runzhiwang is developing SCM HA.\r\n\r\nIn SCM HA, SCM will cache `isLeader` and `term`, updating them when underlying RaftServer steps down or becomes leader, by implementing `StateMachine#notifyNotLeader` and `StateMachine#notifyLeaderChanged`.\r\n\r\nSCM HA does not invoke `DivisionInfo#isLeader()` but query its cached `isLeader` to decide whether underlying RaftServer is leader or not, thus it expects RaftServer to step down when lease is expired.\r\n\r\nI suggest to implement the leader with lease solution in `LeaderStateImpl#checkLeadership`, and add a switch to decide to step down whether when  lease is expired or when it can not hear from majority.\r\n\r\nWhat do you think @szetszwo  @runzhiwang ?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/760770669/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/761709658","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-761709658","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":761709658,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTcwOTY1OA==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-17T01:13:32Z","updated_at":"2021-01-17T01:17:19Z","author_association":"CONTRIBUTOR","body":"@szetszwo Hi, with leader lease, the CI becomes flaky, there are 2 reasons:\r\n1. The CI environment' machine has a low performance, some times one rpc call cost more then 20ms from send to receive.\r\n2. In current ratis implementation,  leader sends log or heartbeat to follower every 75ms, if there is log, leader will not send heartbeat again. For example, at 0ms there is log and leader send log to follower, at 75ms there is log and leader send log to follower again, ..., at 750ms there is log and leader send log to follower again. So you can find from 0ms to 750ms, log always exist, leader always send log, never heartbeat. But if each log need more than 1000ms to: WriteDisk, applyTransaction, then leader will not receive any reply from 0-1000ms, then leader lease becomes invalid frequently.\r\n\r\nI think we have following options:\r\n1. Increase rpc.timeout.min from 150ms to 1500ms in CI \r\n2. Default disable leader lease, then CI need not to consider leader lease\r\n\r\n\r\nWhat do you think ?\r\n","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/761709658/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/761943411","html_url":"https://github.com/apache/ratis/pull/395#issuecomment-761943411","issue_url":"https://api.github.com/repos/apache/ratis/issues/395","id":761943411,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTk0MzQxMQ==","user":{"login":"amaliujia","id":1938382,"node_id":"MDQ6VXNlcjE5MzgzODI=","avatar_url":"https://avatars.githubusercontent.com/u/1938382?v=4","gravatar_id":"","url":"https://api.github.com/users/amaliujia","html_url":"https://github.com/amaliujia","followers_url":"https://api.github.com/users/amaliujia/followers","following_url":"https://api.github.com/users/amaliujia/following{/other_user}","gists_url":"https://api.github.com/users/amaliujia/gists{/gist_id}","starred_url":"https://api.github.com/users/amaliujia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amaliujia/subscriptions","organizations_url":"https://api.github.com/users/amaliujia/orgs","repos_url":"https://api.github.com/users/amaliujia/repos","events_url":"https://api.github.com/users/amaliujia/events{/privacy}","received_events_url":"https://api.github.com/users/amaliujia/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T02:43:54Z","updated_at":"2021-01-18T02:45:09Z","author_association":"CONTRIBUTOR","body":"R: @runzhiwang @szetszwo \r\n\r\nI found this `summary of failures` was pretty useful when I worked on Ozone. So I can see a list of failed tests directly without the need to dig into the long log from running the unit tests.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/761943411/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/761943677","html_url":"https://github.com/apache/ratis/pull/395#issuecomment-761943677","issue_url":"https://api.github.com/repos/apache/ratis/issues/395","id":761943677,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTk0MzY3Nw==","user":{"login":"amaliujia","id":1938382,"node_id":"MDQ6VXNlcjE5MzgzODI=","avatar_url":"https://avatars.githubusercontent.com/u/1938382?v=4","gravatar_id":"","url":"https://api.github.com/users/amaliujia","html_url":"https://github.com/amaliujia","followers_url":"https://api.github.com/users/amaliujia/followers","following_url":"https://api.github.com/users/amaliujia/following{/other_user}","gists_url":"https://api.github.com/users/amaliujia/gists{/gist_id}","starred_url":"https://api.github.com/users/amaliujia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amaliujia/subscriptions","organizations_url":"https://api.github.com/users/amaliujia/orgs","repos_url":"https://api.github.com/users/amaliujia/repos","events_url":"https://api.github.com/users/amaliujia/events{/privacy}","received_events_url":"https://api.github.com/users/amaliujia/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T02:44:47Z","updated_at":"2021-01-18T02:44:47Z","author_association":"CONTRIBUTOR","body":"This is the screenshot  to show that the `summary of  failures` is setup properly.\r\n\r\n![截屏2021-01-17 下午6 42 24](https://user-images.githubusercontent.com/1938382/104866671-fa071f00-58f3-11eb-8c88-9f97aca48f6b.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/761943677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/761946177","html_url":"https://github.com/apache/ratis/pull/395#issuecomment-761946177","issue_url":"https://api.github.com/repos/apache/ratis/issues/395","id":761946177,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTk0NjE3Nw==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T02:53:04Z","updated_at":"2021-01-18T02:53:04Z","author_association":"CONTRIBUTOR","body":"@amaliujia Can we print more detailed message of failed ut in summary.txt ? For example:\r\n![image](https://user-images.githubusercontent.com/51938049/104867208-52cdca80-597b-11eb-8be0-fb94d24de51a.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/761946177/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/761949146","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-761949146","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":761949146,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTk0OTE0Ng==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T03:03:35Z","updated_at":"2021-01-18T03:03:35Z","author_association":"CONTRIBUTOR","body":"@runzhiwang ,  thanks again for working on this.\r\n\r\n> 2. In current ratis implementation, leader sends log or heartbeat to follower every 75ms, if there is log, leader will not send heartbeat again. For example, at 0ms there is log and leader send log to follower, at 75ms there is log and leader send log to follower again, ..., at 750ms there is log and leader send log to follower again. So you can find from 0ms to 750ms, log always exist, leader always send log, never heartbeat. But if each log need more than 1000ms to: WriteDisk, applyTransaction, then leader will not receive any reply from 0-1000ms, then leader lease becomes invalid frequently.\r\n\r\nWith the leader lease feature, the leader probably should send heartbeat separately since followers may take a long time to process log entires.  (The followers do not count the log processing time when counting heartbeat timeout.  However, it is impossible for the leader to do the same discount.)\r\n","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/761949146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/761949585","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-761949585","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":761949585,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTk0OTU4NQ==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T03:05:21Z","updated_at":"2021-01-18T03:05:21Z","author_association":"CONTRIBUTOR","body":"> 2. Default disable leader lease, then CI need not to consider leader lease\r\n\r\nLet's disable leader lease as default.  When the feature becomes stable, we can change the default to enable.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/761949585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/761982406","html_url":"https://github.com/apache/ratis/pull/395#issuecomment-761982406","issue_url":"https://api.github.com/repos/apache/ratis/issues/395","id":761982406,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTk4MjQwNg==","user":{"login":"amaliujia","id":1938382,"node_id":"MDQ6VXNlcjE5MzgzODI=","avatar_url":"https://avatars.githubusercontent.com/u/1938382?v=4","gravatar_id":"","url":"https://api.github.com/users/amaliujia","html_url":"https://github.com/amaliujia","followers_url":"https://api.github.com/users/amaliujia/followers","following_url":"https://api.github.com/users/amaliujia/following{/other_user}","gists_url":"https://api.github.com/users/amaliujia/gists{/gist_id}","starred_url":"https://api.github.com/users/amaliujia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amaliujia/subscriptions","organizations_url":"https://api.github.com/users/amaliujia/orgs","repos_url":"https://api.github.com/users/amaliujia/repos","events_url":"https://api.github.com/users/amaliujia/events{/privacy}","received_events_url":"https://api.github.com/users/amaliujia/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T05:06:08Z","updated_at":"2021-01-18T05:06:08Z","author_association":"CONTRIBUTOR","body":"@runzhiwang \r\n\r\nCurrently that detailed error message is not printed into the summary.txt. We might can write customized script but that will need more work plus I guess those script will likely be fragile.\r\n\r\nThe summary of failed test name is useful already: we can know which has failed and go back to log to search the test name and then can find the error message.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/761982406/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/761988463","html_url":"https://github.com/apache/ratis/pull/395#issuecomment-761988463","issue_url":"https://api.github.com/repos/apache/ratis/issues/395","id":761988463,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTk4ODQ2Mw==","user":{"login":"amaliujia","id":1938382,"node_id":"MDQ6VXNlcjE5MzgzODI=","avatar_url":"https://avatars.githubusercontent.com/u/1938382?v=4","gravatar_id":"","url":"https://api.github.com/users/amaliujia","html_url":"https://github.com/amaliujia","followers_url":"https://api.github.com/users/amaliujia/followers","following_url":"https://api.github.com/users/amaliujia/following{/other_user}","gists_url":"https://api.github.com/users/amaliujia/gists{/gist_id}","starred_url":"https://api.github.com/users/amaliujia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amaliujia/subscriptions","organizations_url":"https://api.github.com/users/amaliujia/orgs","repos_url":"https://api.github.com/users/amaliujia/repos","events_url":"https://api.github.com/users/amaliujia/events{/privacy}","received_events_url":"https://api.github.com/users/amaliujia/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T05:24:28Z","updated_at":"2021-01-18T05:24:28Z","author_association":"CONTRIBUTOR","body":"Meanwhile I will leave the failed CI check here as this PR does not change any code. The failed CI check is also a way to approve this PR is working.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/761988463/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/762006435","html_url":"https://github.com/apache/ratis/pull/395#issuecomment-762006435","issue_url":"https://api.github.com/repos/apache/ratis/issues/395","id":762006435,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjAwNjQzNQ==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T06:09:20Z","updated_at":"2021-01-18T06:09:20Z","author_association":"CONTRIBUTOR","body":"@amaliujia Thanks the patch. I have merged it.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/762006435/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/762519775","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-762519775","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":762519775,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjUxOTc3NQ==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T23:55:28Z","updated_at":"2021-01-18T23:55:28Z","author_association":"CONTRIBUTOR","body":"> When the feature becomes stable, we can change the default to enable.\r\n\r\n@szetszwo Hi, I find it's almost impossible to enable leader lease in CI, because sometimes it cost 300ms from leader send heart to follower receive heartbeat. So CI will become very unstable, unless we increase rpc.timeout.min.\r\n\r\nBesides, what do you think of @GlenGeng 's suggestion: leader step down when lease become invalid ? In SCM HA, we do not check isLeaderReady, we depends on StateMachine#notifyLeaderChanged to change leadership.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/762519775/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/762544924","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-762544924","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":762544924,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjU0NDkyNA==","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T01:31:01Z","updated_at":"2021-01-19T01:31:01Z","author_association":"CONTRIBUTOR","body":"> ..., I find it's almost impossible to enable leader lease in CI, because sometimes it cost 300ms from leader send heart to follower receive heartbeat. So CI will become very unstable, unless we increase rpc.timeout.min.\r\n\r\nYes, we may increase rpc.timeout.min if necessary.\r\n\r\n> ... leader step down when lease become invalid ? ...\r\n\r\nLet's also make it configurable?  It seems that both ways have its own benefit.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/762544924/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/762545226","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-762545226","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":762545226,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjU0NTIyNg==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T01:32:11Z","updated_at":"2021-01-19T01:32:11Z","author_association":"CONTRIBUTOR","body":"> Let's also make it configurable? It seems that both ways have its own benefit.\r\n\r\n@szetszwo Thanks, I agree.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/762545226/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/762622960","html_url":"https://github.com/apache/ratis/pull/393#issuecomment-762622960","issue_url":"https://api.github.com/repos/apache/ratis/issues/393","id":762622960,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjYyMjk2MA==","user":{"login":"lokeshj1703","id":9255455,"node_id":"MDQ6VXNlcjkyNTU0NTU=","avatar_url":"https://avatars.githubusercontent.com/u/9255455?v=4","gravatar_id":"","url":"https://api.github.com/users/lokeshj1703","html_url":"https://github.com/lokeshj1703","followers_url":"https://api.github.com/users/lokeshj1703/followers","following_url":"https://api.github.com/users/lokeshj1703/following{/other_user}","gists_url":"https://api.github.com/users/lokeshj1703/gists{/gist_id}","starred_url":"https://api.github.com/users/lokeshj1703/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lokeshj1703/subscriptions","organizations_url":"https://api.github.com/users/lokeshj1703/orgs","repos_url":"https://api.github.com/users/lokeshj1703/repos","events_url":"https://api.github.com/users/lokeshj1703/events{/privacy}","received_events_url":"https://api.github.com/users/lokeshj1703/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T06:07:05Z","updated_at":"2021-01-19T06:07:05Z","author_association":"CONTRIBUTOR","body":"@ferhui Can you please update the PR description as well?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/762622960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/762624117","html_url":"https://github.com/apache/ratis/pull/393#issuecomment-762624117","issue_url":"https://api.github.com/repos/apache/ratis/issues/393","id":762624117,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjYyNDExNw==","user":{"login":"lokeshj1703","id":9255455,"node_id":"MDQ6VXNlcjkyNTU0NTU=","avatar_url":"https://avatars.githubusercontent.com/u/9255455?v=4","gravatar_id":"","url":"https://api.github.com/users/lokeshj1703","html_url":"https://github.com/lokeshj1703","followers_url":"https://api.github.com/users/lokeshj1703/followers","following_url":"https://api.github.com/users/lokeshj1703/following{/other_user}","gists_url":"https://api.github.com/users/lokeshj1703/gists{/gist_id}","starred_url":"https://api.github.com/users/lokeshj1703/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lokeshj1703/subscriptions","organizations_url":"https://api.github.com/users/lokeshj1703/orgs","repos_url":"https://api.github.com/users/lokeshj1703/repos","events_url":"https://api.github.com/users/lokeshj1703/events{/privacy}","received_events_url":"https://api.github.com/users/lokeshj1703/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T06:10:34Z","updated_at":"2021-01-19T06:10:34Z","author_association":"CONTRIBUTOR","body":"@ferhui Thanks for the contribution! I have committed the PR to master branch. The test failures in CI are unrelated as PR only has changes in a test file.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/762624117/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/762629632","html_url":"https://github.com/apache/ratis/pull/393#issuecomment-762629632","issue_url":"https://api.github.com/repos/apache/ratis/issues/393","id":762629632,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjYyOTYzMg==","user":{"login":"ferhui","id":2336003,"node_id":"MDQ6VXNlcjIzMzYwMDM=","avatar_url":"https://avatars.githubusercontent.com/u/2336003?v=4","gravatar_id":"","url":"https://api.github.com/users/ferhui","html_url":"https://github.com/ferhui","followers_url":"https://api.github.com/users/ferhui/followers","following_url":"https://api.github.com/users/ferhui/following{/other_user}","gists_url":"https://api.github.com/users/ferhui/gists{/gist_id}","starred_url":"https://api.github.com/users/ferhui/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ferhui/subscriptions","organizations_url":"https://api.github.com/users/ferhui/orgs","repos_url":"https://api.github.com/users/ferhui/repos","events_url":"https://api.github.com/users/ferhui/events{/privacy}","received_events_url":"https://api.github.com/users/ferhui/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T06:25:13Z","updated_at":"2021-01-19T06:25:13Z","author_association":"CONTRIBUTOR","body":"@lokeshj1703 Thanks for review!","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/762629632/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763181819","html_url":"https://github.com/apache/ratis/pull/397#issuecomment-763181819","issue_url":"https://api.github.com/repos/apache/ratis/issues/397","id":763181819,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzE4MTgxOQ==","user":{"login":"amaliujia","id":1938382,"node_id":"MDQ6VXNlcjE5MzgzODI=","avatar_url":"https://avatars.githubusercontent.com/u/1938382?v=4","gravatar_id":"","url":"https://api.github.com/users/amaliujia","html_url":"https://github.com/amaliujia","followers_url":"https://api.github.com/users/amaliujia/followers","following_url":"https://api.github.com/users/amaliujia/following{/other_user}","gists_url":"https://api.github.com/users/amaliujia/gists{/gist_id}","starred_url":"https://api.github.com/users/amaliujia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amaliujia/subscriptions","organizations_url":"https://api.github.com/users/amaliujia/orgs","repos_url":"https://api.github.com/users/amaliujia/repos","events_url":"https://api.github.com/users/amaliujia/events{/privacy}","received_events_url":"https://api.github.com/users/amaliujia/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T22:27:02Z","updated_at":"2021-01-19T22:27:02Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763181819/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763185165","html_url":"https://github.com/apache/ratis/pull/396#issuecomment-763185165","issue_url":"https://api.github.com/repos/apache/ratis/issues/396","id":763185165,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzE4NTE2NQ==","user":{"login":"amaliujia","id":1938382,"node_id":"MDQ6VXNlcjE5MzgzODI=","avatar_url":"https://avatars.githubusercontent.com/u/1938382?v=4","gravatar_id":"","url":"https://api.github.com/users/amaliujia","html_url":"https://github.com/amaliujia","followers_url":"https://api.github.com/users/amaliujia/followers","following_url":"https://api.github.com/users/amaliujia/following{/other_user}","gists_url":"https://api.github.com/users/amaliujia/gists{/gist_id}","starred_url":"https://api.github.com/users/amaliujia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amaliujia/subscriptions","organizations_url":"https://api.github.com/users/amaliujia/orgs","repos_url":"https://api.github.com/users/amaliujia/repos","events_url":"https://api.github.com/users/amaliujia/events{/privacy}","received_events_url":"https://api.github.com/users/amaliujia/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T22:32:24Z","updated_at":"2021-01-19T22:32:24Z","author_association":"CONTRIBUTOR","body":"I think such permission issue shouldn't be handled by code. It is better to fix permission outside of Ratis.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763185165/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763214593","html_url":"https://github.com/apache/ratis/pull/397#issuecomment-763214593","issue_url":"https://api.github.com/repos/apache/ratis/issues/397","id":763214593,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzIxNDU5Mw==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T23:42:25Z","updated_at":"2021-01-19T23:42:25Z","author_association":"CONTRIBUTOR","body":"@szetszwo Thanks the patch. @amaliujia Thanks for review. I have merged it.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763214593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763304127","html_url":"https://github.com/apache/ratis/pull/398#issuecomment-763304127","issue_url":"https://api.github.com/repos/apache/ratis/issues/398","id":763304127,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzMwNDEyNw==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T03:27:47Z","updated_at":"2021-01-20T03:27:47Z","author_association":"CONTRIBUTOR","body":"will fix the failed ut.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763304127/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763364142","html_url":"https://github.com/apache/ratis/pull/398#issuecomment-763364142","issue_url":"https://api.github.com/repos/apache/ratis/issues/398","id":763364142,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzM2NDE0Mg==","user":{"login":"amaliujia","id":1938382,"node_id":"MDQ6VXNlcjE5MzgzODI=","avatar_url":"https://avatars.githubusercontent.com/u/1938382?v=4","gravatar_id":"","url":"https://api.github.com/users/amaliujia","html_url":"https://github.com/amaliujia","followers_url":"https://api.github.com/users/amaliujia/followers","following_url":"https://api.github.com/users/amaliujia/following{/other_user}","gists_url":"https://api.github.com/users/amaliujia/gists{/gist_id}","starred_url":"https://api.github.com/users/amaliujia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amaliujia/subscriptions","organizations_url":"https://api.github.com/users/amaliujia/orgs","repos_url":"https://api.github.com/users/amaliujia/repos","events_url":"https://api.github.com/users/amaliujia/events{/privacy}","received_events_url":"https://api.github.com/users/amaliujia/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T06:15:37Z","updated_at":"2021-01-20T06:15:37Z","author_association":"CONTRIBUTOR","body":"cc @amaliujia  I can help review when the UT is fixed.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763364142/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763392809","html_url":"https://github.com/apache/ratis/pull/396#issuecomment-763392809","issue_url":"https://api.github.com/repos/apache/ratis/issues/396","id":763392809,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzM5MjgwOQ==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T07:17:14Z","updated_at":"2021-01-20T07:17:14Z","author_association":"CONTRIBUTOR","body":"@amaliujia cc, this mainly fixed for bad disk, not permission, but the exception is same.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763392809/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763398345","html_url":"https://github.com/apache/ratis/pull/396#issuecomment-763398345","issue_url":"https://api.github.com/repos/apache/ratis/issues/396","id":763398345,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzM5ODM0NQ==","user":{"login":"amaliujia","id":1938382,"node_id":"MDQ6VXNlcjE5MzgzODI=","avatar_url":"https://avatars.githubusercontent.com/u/1938382?v=4","gravatar_id":"","url":"https://api.github.com/users/amaliujia","html_url":"https://github.com/amaliujia","followers_url":"https://api.github.com/users/amaliujia/followers","following_url":"https://api.github.com/users/amaliujia/following{/other_user}","gists_url":"https://api.github.com/users/amaliujia/gists{/gist_id}","starred_url":"https://api.github.com/users/amaliujia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amaliujia/subscriptions","organizations_url":"https://api.github.com/users/amaliujia/orgs","repos_url":"https://api.github.com/users/amaliujia/repos","events_url":"https://api.github.com/users/amaliujia/events{/privacy}","received_events_url":"https://api.github.com/users/amaliujia/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T07:29:29Z","updated_at":"2021-01-20T07:29:29Z","author_association":"CONTRIBUTOR","body":"+1 for bad disk it is ok.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763398345/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763400887","html_url":"https://github.com/apache/ratis/pull/383#issuecomment-763400887","issue_url":"https://api.github.com/repos/apache/ratis/issues/383","id":763400887,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzQwMDg4Nw==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T07:35:09Z","updated_at":"2021-01-20T07:35:23Z","author_association":"CONTRIBUTOR","body":"this pr depends on: https://github.com/apache/incubator-ratis/pull/398","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763400887/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763483512","html_url":"https://github.com/apache/ratis/pull/400#issuecomment-763483512","issue_url":"https://api.github.com/repos/apache/ratis/issues/400","id":763483512,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzQ4MzUxMg==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T09:54:48Z","updated_at":"2021-01-20T09:54:59Z","author_association":"CONTRIBUTOR","body":"@szetszwo Could you help review this ? Thanks a lot.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763483512/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763518965","html_url":"https://github.com/apache/ratis/pull/396#issuecomment-763518965","issue_url":"https://api.github.com/repos/apache/ratis/issues/396","id":763518965,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzUxODk2NQ==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T10:52:51Z","updated_at":"2021-01-20T10:52:51Z","author_association":"CONTRIBUTOR","body":"@cchenax Thanks the patch. @amaliujia Thanks for review. I have merged it.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763518965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763580454","html_url":"https://github.com/apache/ratis/pull/400#issuecomment-763580454","issue_url":"https://api.github.com/repos/apache/ratis/issues/400","id":763580454,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzU4MDQ1NA==","user":{"login":"runzhiwang","id":51938049,"node_id":"MDQ6VXNlcjUxOTM4MDQ5","avatar_url":"https://avatars.githubusercontent.com/u/51938049?v=4","gravatar_id":"","url":"https://api.github.com/users/runzhiwang","html_url":"https://github.com/runzhiwang","followers_url":"https://api.github.com/users/runzhiwang/followers","following_url":"https://api.github.com/users/runzhiwang/following{/other_user}","gists_url":"https://api.github.com/users/runzhiwang/gists{/gist_id}","starred_url":"https://api.github.com/users/runzhiwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/runzhiwang/subscriptions","organizations_url":"https://api.github.com/users/runzhiwang/orgs","repos_url":"https://api.github.com/users/runzhiwang/repos","events_url":"https://api.github.com/users/runzhiwang/events{/privacy}","received_events_url":"https://api.github.com/users/runzhiwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T12:41:15Z","updated_at":"2021-01-20T12:41:15Z","author_association":"CONTRIBUTOR","body":"@szetszwo Thanks for review. I have merged it.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763580454/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763998918","html_url":"https://github.com/apache/ratis/pull/400#issuecomment-763998918","issue_url":"https://api.github.com/repos/apache/ratis/issues/400","id":763998918,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzk5ODkxOA==","user":{"login":"amaliujia","id":1938382,"node_id":"MDQ6VXNlcjE5MzgzODI=","avatar_url":"https://avatars.githubusercontent.com/u/1938382?v=4","gravatar_id":"","url":"https://api.github.com/users/amaliujia","html_url":"https://github.com/amaliujia","followers_url":"https://api.github.com/users/amaliujia/followers","following_url":"https://api.github.com/users/amaliujia/following{/other_user}","gists_url":"https://api.github.com/users/amaliujia/gists{/gist_id}","starred_url":"https://api.github.com/users/amaliujia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amaliujia/subscriptions","organizations_url":"https://api.github.com/users/amaliujia/orgs","repos_url":"https://api.github.com/users/amaliujia/repos","events_url":"https://api.github.com/users/amaliujia/events{/privacy}","received_events_url":"https://api.github.com/users/amaliujia/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T22:38:21Z","updated_at":"2021-01-20T22:38:21Z","author_association":"CONTRIBUTOR","body":"+1 thanks!","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/763998918/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/765251817","html_url":"https://github.com/apache/ratis/pull/401#issuecomment-765251817","issue_url":"https://api.github.com/repos/apache/ratis/issues/401","id":765251817,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTI1MTgxNw==","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T09:05:38Z","updated_at":"2021-01-22T09:05:38Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo and @amaliujia for the review.  I have updated the patch with your suggestions (except where noted).","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/765251817/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/765293126","html_url":"https://github.com/apache/ratis/pull/401#issuecomment-765293126","issue_url":"https://api.github.com/repos/apache/ratis/issues/401","id":765293126,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTI5MzEyNg==","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T10:05:35Z","updated_at":"2021-01-22T10:05:35Z","author_association":"CONTRIBUTOR","body":"Checking `TestMetaServer` failure.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/765293126/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/765606326","html_url":"https://github.com/apache/ratis/pull/401#issuecomment-765606326","issue_url":"https://api.github.com/repos/apache/ratis/issues/401","id":765606326,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTYwNjMyNg==","user":{"login":"amaliujia","id":1938382,"node_id":"MDQ6VXNlcjE5MzgzODI=","avatar_url":"https://avatars.githubusercontent.com/u/1938382?v=4","gravatar_id":"","url":"https://api.github.com/users/amaliujia","html_url":"https://github.com/amaliujia","followers_url":"https://api.github.com/users/amaliujia/followers","following_url":"https://api.github.com/users/amaliujia/following{/other_user}","gists_url":"https://api.github.com/users/amaliujia/gists{/gist_id}","starred_url":"https://api.github.com/users/amaliujia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amaliujia/subscriptions","organizations_url":"https://api.github.com/users/amaliujia/orgs","repos_url":"https://api.github.com/users/amaliujia/repos","events_url":"https://api.github.com/users/amaliujia/events{/privacy}","received_events_url":"https://api.github.com/users/amaliujia/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T18:32:12Z","updated_at":"2021-01-22T18:32:12Z","author_association":"CONTRIBUTOR","body":"LGTM thanks!","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/765606326/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]