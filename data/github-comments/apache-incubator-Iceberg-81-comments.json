[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/793695370","html_url":"https://github.com/apache/iceberg/issues/2244#issuecomment-793695370","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2244","id":793695370,"node_id":"MDEyOklzc3VlQ29tbWVudDc5MzY5NTM3MA==","user":{"login":"javsanbel2","id":36443689,"node_id":"MDQ6VXNlcjM2NDQzNjg5","avatar_url":"https://avatars.githubusercontent.com/u/36443689?v=4","gravatar_id":"","url":"https://api.github.com/users/javsanbel2","html_url":"https://github.com/javsanbel2","followers_url":"https://api.github.com/users/javsanbel2/followers","following_url":"https://api.github.com/users/javsanbel2/following{/other_user}","gists_url":"https://api.github.com/users/javsanbel2/gists{/gist_id}","starred_url":"https://api.github.com/users/javsanbel2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javsanbel2/subscriptions","organizations_url":"https://api.github.com/users/javsanbel2/orgs","repos_url":"https://api.github.com/users/javsanbel2/repos","events_url":"https://api.github.com/users/javsanbel2/events{/privacy}","received_events_url":"https://api.github.com/users/javsanbel2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-09T10:40:33Z","updated_at":"2021-03-09T10:40:33Z","author_association":"NONE","body":"Hello @RussellSpitzer! I am having a similar issue and I agree to your solution as well. Did you continue working on this? I would like to know more about your approach. How would this work in practice?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/793695370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/793866614","html_url":"https://github.com/apache/iceberg/issues/2244#issuecomment-793866614","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2244","id":793866614,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Mzg2NjYxNA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-09T13:00:42Z","updated_at":"2021-03-09T13:00:42Z","author_association":"MEMBER","body":"There is an active pr to fix this, please help with the review if you are interested. Basically everywhere we currently have handling for timestamp with timezone we add in handling for timestamp without timezone with the same code except we gate it with a flag.\n\nhttps://github.com/apache/iceberg/pull/2282\n\nSent from my iPhone\n\n> On Mar 9, 2021, at 4:40 AM, Javier Sánchez Beltrán <notifications@github.com> wrote:\n> \n> ﻿\n> Hello @RussellSpitzer! I am having a similar issue and I agree to your solution as well. Did you continue working on this? I would like to know more about your approach. How would this work in practice?\n> \n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub, or unsubscribe.\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/793866614/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794588739","html_url":"https://github.com/apache/iceberg/issues/2309#issuecomment-794588739","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2309","id":794588739,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDU4ODczOQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-09T23:15:40Z","updated_at":"2021-03-09T23:15:40Z","author_association":"MEMBER","body":"I would also tag this as \"good first ticket\" but I do not know how to add labels","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794588739/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794591937","html_url":"https://github.com/apache/iceberg/pull/2210#issuecomment-794591937","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2210","id":794591937,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDU5MTkzNw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-09T23:19:00Z","updated_at":"2021-03-09T23:19:00Z","author_association":"MEMBER","body":"@pvary + @aokolnychyi Should be ready for another look if ya'll have time, Thanks in advance!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794591937/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794639193","html_url":"https://github.com/apache/iceberg/pull/2276#issuecomment-794639193","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2276","id":794639193,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDYzOTE5Mw==","user":{"login":"sunchao","id":506679,"node_id":"MDQ6VXNlcjUwNjY3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/506679?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchao","html_url":"https://github.com/sunchao","followers_url":"https://api.github.com/users/sunchao/followers","following_url":"https://api.github.com/users/sunchao/following{/other_user}","gists_url":"https://api.github.com/users/sunchao/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchao/subscriptions","organizations_url":"https://api.github.com/users/sunchao/orgs","repos_url":"https://api.github.com/users/sunchao/repos","events_url":"https://api.github.com/users/sunchao/events{/privacy}","received_events_url":"https://api.github.com/users/sunchao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T00:11:53Z","updated_at":"2021-03-10T00:11:53Z","author_association":"MEMBER","body":"@aokolnychyi @rdblue @prodeezy updated the PR according to the discussions. Please take another look. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794639193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794707731","html_url":"https://github.com/apache/iceberg/pull/1972#issuecomment-794707731","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1972","id":794707731,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDcwNzczMQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T01:30:23Z","updated_at":"2021-03-10T01:31:49Z","author_association":"CONTRIBUTOR","body":"Thanks for the great work, @Fokko! \r\n\r\nWe have a person who is also interested in a Beam sink for Iceberg. It would be great to collaborate. @RussellSpitzer and I can help with reviews. I feel like this is not far from being ready.\r\n\r\nA couple of questions from me (I have just a basic understanding of Beam):\r\n- Is it correct that this PR supports only fixed windows in Beam? \r\n- I head it is pretty common to write to multiple tables or determine which table to write to dynamically in Beam. Is it worth supporting such cases in the Iceberg sink? Does not have to be done in the first version, apparently.\r\n- Does Beam have any way to control the distribution and ordering of data that is passed for write? For example, we have added a way to ask Spark to distribute and order records according to the partition spec and sort order. A similar effort is in progress for Flink. The main reason is to reduce the number of produced files and order records accordingly to benefit from min/max skipping and better compression. Can people shuffle and sort data manually? Can we do that automatically?\r\n\r\n\r\nThe first two points are minor but the last one can be a big deal at scale. For example, if we don't distribute and order data on write, we will either produce a lot of small files or keep a lot of files open at the same time.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794707731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794719689","html_url":"https://github.com/apache/iceberg/issues/2300#issuecomment-794719689","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2300","id":794719689,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDcxOTY4OQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T01:43:52Z","updated_at":"2021-03-10T01:43:52Z","author_association":"CONTRIBUTOR","body":"@pvary, I think this logic would only apply to path-based tables that are not tracked in a metastore. It is pretty popular at least in Spark. Whenever we have a metastore, we should talk to it for figure out the list of partitions and their locations.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794719689/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794730662","html_url":"https://github.com/apache/iceberg/issues/2309#issuecomment-794730662","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2309","id":794730662,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDczMDY2Mg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T01:56:34Z","updated_at":"2021-03-10T01:56:34Z","author_association":"CONTRIBUTOR","body":"I feel it will be useful.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794730662/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794749577","html_url":"https://github.com/apache/iceberg/pull/1972#issuecomment-794749577","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1972","id":794749577,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDc0OTU3Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T02:18:06Z","updated_at":"2021-03-10T02:18:22Z","author_association":"CONTRIBUTOR","body":"@madhubabubits, let us know if you have any other comments. I know you are giving this PR a try.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794749577/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794759953","html_url":"https://github.com/apache/iceberg/issues/2309#issuecomment-794759953","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2309","id":794759953,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDc1OTk1Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T02:29:38Z","updated_at":"2021-03-10T02:29:38Z","author_association":"CONTRIBUTOR","body":"@flyrain, would you be interested in working on this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794759953/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794764189","html_url":"https://github.com/apache/iceberg/issues/2309#issuecomment-794764189","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2309","id":794764189,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDc2NDE4OQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T02:34:15Z","updated_at":"2021-03-10T02:34:15Z","author_association":"CONTRIBUTOR","body":"We need to check if this will have any possible implications. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794764189/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794768956","html_url":"https://github.com/apache/iceberg/issues/2309#issuecomment-794768956","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2309","id":794768956,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDc2ODk1Ng==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T02:39:49Z","updated_at":"2021-03-10T02:39:49Z","author_association":"CONTRIBUTOR","body":"As far as I see, Spark passes the location as a table property. I think we can fake it in `SparkTable` like we fake the provider and the current snapshot id.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794768956/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794769981","html_url":"https://github.com/apache/iceberg/issues/2309#issuecomment-794769981","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2309","id":794769981,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDc2OTk4MQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T02:41:01Z","updated_at":"2021-03-10T02:41:01Z","author_association":"CONTRIBUTOR","body":"I think we can simply adapt `SparkTable$properties`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794769981/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794770142","html_url":"https://github.com/apache/iceberg/issues/2309#issuecomment-794770142","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2309","id":794770142,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDc3MDE0Mg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T02:41:13Z","updated_at":"2021-03-10T02:41:37Z","author_association":"MEMBER","body":"Totally agree, I was worried about it being mis used somewhere, but I think this is the right thing to do, and of course we should add it to \"reserved properties\" too because currently you can set this but it has no effect","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794770142/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794773590","html_url":"https://github.com/apache/iceberg/issues/2311#issuecomment-794773590","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2311","id":794773590,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDc3MzU5MA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T02:45:23Z","updated_at":"2021-03-10T02:45:23Z","author_association":"CONTRIBUTOR","body":"@flyrain, could you take a look at this one?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794773590/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794840167","html_url":"https://github.com/apache/iceberg/pull/1508#issuecomment-794840167","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1508","id":794840167,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDg0MDE2Nw==","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T04:07:21Z","updated_at":"2021-03-10T04:10:13Z","author_association":"CONTRIBUTOR","body":"@yyanyy thank you for your work in #2096 and #2275.\r\n@rdblue can you please take a look at this again and let me know your thoughts on how to proceed with this? I think that there is still a place for this work. There are two parts to this work: \r\n1. `BaseTable#schemaForSnapshot`.\r\n2. Changes to Spark 2 and Spark 3 to use the schema for the snapshot when reading. These directly or indirectly call `BaseTable#schemaForSnapshot`.\r\n\r\nThe first part can be changed to lookup the schema by `schema-id` from the `schemas` list now that snapshots in the `snapshot-log` have a `schema-id` with @yyanyy's work. If the snapshot does not have a `schema-id`, then we fall back to doing what I'm doing here. The second part, I think, is still applicable.\r\nOne other aspect is that I'm not competent to make changes for the other supported components such as Hive and Flink, only for Spark, but the changes for those components could be done separately and by other folks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794840167/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794878503","html_url":"https://github.com/apache/iceberg/pull/2210#issuecomment-794878503","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2210","id":794878503,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDg3ODUwMw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T04:54:18Z","updated_at":"2021-03-10T04:54:18Z","author_association":"CONTRIBUTOR","body":"I like the new structure, I had only minor points so far. I'll do another look with fresh eyes tomorrow but I think this is close.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/794878503/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/795119546","html_url":"https://github.com/apache/iceberg/pull/2210#issuecomment-795119546","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2210","id":795119546,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NTExOTU0Ng==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T09:05:29Z","updated_at":"2021-03-10T09:05:29Z","author_association":"CONTRIBUTOR","body":"> @pvary + @aokolnychyi Should be ready for another look if ya'll have time, Thanks in advance!\r\n\r\nLGTM on Hive related stuff. Only minors and mostly questions.\r\nWhen we start working on Hive migration definitely will move some of the code from the `SparkTableUtil`, `Spark3Util` to some more accessible place, but that's another story.\r\nToo much Spark code to be comfortable giving a +1.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/795119546/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/795291692","html_url":"https://github.com/apache/iceberg/pull/2266#issuecomment-795291692","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2266","id":795291692,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NTI5MTY5Mg==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T11:37:58Z","updated_at":"2021-03-10T11:37:58Z","author_association":"COLLABORATOR","body":"@rymurr Thanks a lot Ryan for helping me with this change.  Did the suggestions, when you have another chance","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/795291692/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/795362250","html_url":"https://github.com/apache/iceberg/pull/2305#issuecomment-795362250","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2305","id":795362250,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NTM2MjI1MA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T12:44:09Z","updated_at":"2021-03-10T12:44:48Z","author_association":"MEMBER","body":"Actually,  I did not fully understand the whole PR (https://github.com/apache/iceberg/pull/2105) when reviewing this separate PR, I think I will need more time to understand the whole codes firstly.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/795362250/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796102912","html_url":"https://github.com/apache/iceberg/pull/2293#issuecomment-796102912","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2293","id":796102912,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjEwMjkxMg==","user":{"login":"edgarRd","id":266670,"node_id":"MDQ6VXNlcjI2NjY3MA==","avatar_url":"https://avatars.githubusercontent.com/u/266670?v=4","gravatar_id":"","url":"https://api.github.com/users/edgarRd","html_url":"https://github.com/edgarRd","followers_url":"https://api.github.com/users/edgarRd/followers","following_url":"https://api.github.com/users/edgarRd/following{/other_user}","gists_url":"https://api.github.com/users/edgarRd/gists{/gist_id}","starred_url":"https://api.github.com/users/edgarRd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edgarRd/subscriptions","organizations_url":"https://api.github.com/users/edgarRd/orgs","repos_url":"https://api.github.com/users/edgarRd/repos","events_url":"https://api.github.com/users/edgarRd/events{/privacy}","received_events_url":"https://api.github.com/users/edgarRd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T21:03:48Z","updated_at":"2021-03-10T21:03:48Z","author_association":"CONTRIBUTOR","body":"@rdblue @aokolnychyi I just wanted to follow up on this. Please let me know if there's any other comment. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796102912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796120008","html_url":"https://github.com/apache/iceberg/pull/1918#issuecomment-796120008","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1918","id":796120008,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjEyMDAwOA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T21:13:41Z","updated_at":"2021-03-10T21:13:41Z","author_association":"MEMBER","body":"cc @ggershinsky","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796120008/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796249577","html_url":"https://github.com/apache/iceberg/pull/2314#issuecomment-796249577","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2314","id":796249577,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjI0OTU3Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T22:39:44Z","updated_at":"2021-03-10T22:39:44Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer @rdblue @rymurr @shardulm94 @karuppayya @flyrain, could you please review?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796249577/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796253038","html_url":"https://github.com/apache/iceberg/pull/2315#issuecomment-796253038","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2315","id":796253038,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjI1MzAzOA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T22:42:26Z","updated_at":"2021-03-10T22:42:26Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer @rdblue @rymurr @shardulm94 @karuppayya, could you please review?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796253038/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796258733","html_url":"https://github.com/apache/iceberg/pull/2203#issuecomment-796258733","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2203","id":796258733,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjI1ODczMw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T22:48:47Z","updated_at":"2021-03-10T22:48:47Z","author_association":"CONTRIBUTOR","body":"Let me take a look at this now. Sorry I did not get to this one earlier.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796258733/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796261775","html_url":"https://github.com/apache/iceberg/pull/2203#issuecomment-796261775","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2203","id":796261775,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjI2MTc3NQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T22:53:43Z","updated_at":"2021-03-10T22:53:43Z","author_association":"CONTRIBUTOR","body":"The change looks correct to me. @rymurr, shall we split this PR into two and address Hadoop and Hive catalogs separately?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796261775/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796266479","html_url":"https://github.com/apache/iceberg/issues/2316#issuecomment-796266479","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2316","id":796266479,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjI2NjQ3OQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T23:01:32Z","updated_at":"2021-03-10T23:01:59Z","author_association":"CONTRIBUTOR","body":"@flyrain, could you take a look at this one too? We should have this inside our internal code.\r\n\r\nAlso cc @RussellSpitzer and @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796266479/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796287993","html_url":"https://github.com/apache/iceberg/issues/2317#issuecomment-796287993","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2317","id":796287993,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjI4Nzk5Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T23:33:01Z","updated_at":"2021-03-10T23:36:27Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer, will you submit a PR for this? I'll help reviewing.\r\n\r\ncc @pvary @rymurr @shardulm94 @rdblue too","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796287993/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796318195","html_url":"https://github.com/apache/iceberg/issues/2306#issuecomment-796318195","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2306","id":796318195,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjMxODE5NQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T00:25:31Z","updated_at":"2021-03-11T00:25:31Z","author_association":"CONTRIBUTOR","body":"I'll look into that soon.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796318195/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796333027","html_url":"https://github.com/apache/iceberg/pull/2240#issuecomment-796333027","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2240","id":796333027,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjMzMzAyNw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T00:50:39Z","updated_at":"2021-03-11T00:50:39Z","author_association":"CONTRIBUTOR","body":"Sorry, I was distracted by other things. Let me take a look at this PR tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796333027/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796336117","html_url":"https://github.com/apache/iceberg/pull/2240#issuecomment-796336117","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2240","id":796336117,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjMzNjExNw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T00:56:02Z","updated_at":"2021-03-11T00:56:02Z","author_association":"CONTRIBUTOR","body":"I think we have a similar effort in https://github.com/apache/iceberg/pull/2214. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796336117/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796339527","html_url":"https://github.com/apache/iceberg/pull/2286#issuecomment-796339527","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2286","id":796339527,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjMzOTUyNw==","user":{"login":"mayursrivastava","id":8659624,"node_id":"MDQ6VXNlcjg2NTk2MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8659624?v=4","gravatar_id":"","url":"https://api.github.com/users/mayursrivastava","html_url":"https://github.com/mayursrivastava","followers_url":"https://api.github.com/users/mayursrivastava/followers","following_url":"https://api.github.com/users/mayursrivastava/following{/other_user}","gists_url":"https://api.github.com/users/mayursrivastava/gists{/gist_id}","starred_url":"https://api.github.com/users/mayursrivastava/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayursrivastava/subscriptions","organizations_url":"https://api.github.com/users/mayursrivastava/orgs","repos_url":"https://api.github.com/users/mayursrivastava/repos","events_url":"https://api.github.com/users/mayursrivastava/events{/privacy}","received_events_url":"https://api.github.com/users/mayursrivastava/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T01:01:59Z","updated_at":"2021-03-11T01:01:59Z","author_association":"CONTRIBUTOR","body":"Hi @rymurr\r\n\r\nI've made the changes you suggested. Please take a look again.\r\n\r\nThanks,\r\nMayur\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796339527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796342152","html_url":"https://github.com/apache/iceberg/pull/2214#issuecomment-796342152","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2214","id":796342152,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjM0MjE1Mg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T01:06:59Z","updated_at":"2021-03-11T01:07:34Z","author_association":"CONTRIBUTOR","body":"cc @szehon-ho  @RussellSpitzer @rdblue who participated in #2240.\r\n\r\nThis PR has been open for a while. I think it has a great basis for propagating the sort order to writers but I am afraid we cannot mark written files with the current sort order unless we sure those files are sorted. That will require a query engine API to request a distribution and ordering. For Spark, it will be possible only in 3.2. What about the other query engine integrations, @openinx @pvary?\r\n\r\nIf my understanding is correct, what about limiting the scope of this PR to just propagate the sort order to writers?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796342152/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796352164","html_url":"https://github.com/apache/iceberg/issues/2317#issuecomment-796352164","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2317","id":796352164,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjM1MjE2NA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T01:25:58Z","updated_at":"2021-03-11T01:25:58Z","author_association":"MEMBER","body":"Yeah I can start digging into this soon, but I only am confident enough to handle the HMS use case here, I would suggest all the other catalog creators do a similar check to see if they have the same issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796352164/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796354335","html_url":"https://github.com/apache/iceberg/pull/2315#issuecomment-796354335","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2315","id":796354335,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjM1NDMzNQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T01:30:18Z","updated_at":"2021-03-11T01:30:18Z","author_association":"CONTRIBUTOR","body":"Thanks for the review, @RussellSpitzer @shardulm94!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796354335/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796354558","html_url":"https://github.com/apache/iceberg/issues/2317#issuecomment-796354558","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2317","id":796354558,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjM1NDU1OA==","user":{"login":"shardulm94","id":6961317,"node_id":"MDQ6VXNlcjY5NjEzMTc=","avatar_url":"https://avatars.githubusercontent.com/u/6961317?v=4","gravatar_id":"","url":"https://api.github.com/users/shardulm94","html_url":"https://github.com/shardulm94","followers_url":"https://api.github.com/users/shardulm94/followers","following_url":"https://api.github.com/users/shardulm94/following{/other_user}","gists_url":"https://api.github.com/users/shardulm94/gists{/gist_id}","starred_url":"https://api.github.com/users/shardulm94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shardulm94/subscriptions","organizations_url":"https://api.github.com/users/shardulm94/orgs","repos_url":"https://api.github.com/users/shardulm94/repos","events_url":"https://api.github.com/users/shardulm94/events{/privacy}","received_events_url":"https://api.github.com/users/shardulm94/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T01:30:44Z","updated_at":"2021-03-11T01:39:34Z","author_association":"CONTRIBUTOR","body":"Thanks @RussellSpitzer for filing this. We hit this issue at LinkedIn recently with HiveCatalog and were investigating the issue. Your analysis seems to line up with what we too observed.  cc: @omalley ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796354558/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796395354","html_url":"https://github.com/apache/iceberg/issues/2317#issuecomment-796395354","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2317","id":796395354,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjM5NTM1NA==","user":{"login":"zhangdove","id":25578853,"node_id":"MDQ6VXNlcjI1NTc4ODUz","avatar_url":"https://avatars.githubusercontent.com/u/25578853?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangdove","html_url":"https://github.com/zhangdove","followers_url":"https://api.github.com/users/zhangdove/followers","following_url":"https://api.github.com/users/zhangdove/following{/other_user}","gists_url":"https://api.github.com/users/zhangdove/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangdove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangdove/subscriptions","organizations_url":"https://api.github.com/users/zhangdove/orgs","repos_url":"https://api.github.com/users/zhangdove/repos","events_url":"https://api.github.com/users/zhangdove/events{/privacy}","received_events_url":"https://api.github.com/users/zhangdove/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T02:51:01Z","updated_at":"2021-03-11T02:51:01Z","author_association":"CONTRIBUTOR","body":"We are using the Spark computing engine to read MySQL data and overwrite Iceberg (used by HadoopCatalog). When the timeout with MySQL is too long, the data file is cleaned up, while the file new-metadata.json still exists.\r\n\r\nI'm not sure if it's the same as this ISSUE, but it looks a bit like @RussellSpitzer 's analysis.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796395354/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796413642","html_url":"https://github.com/apache/iceberg/issues/2319#issuecomment-796413642","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2319","id":796413642,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjQxMzY0Mg==","user":{"login":"zhangdove","id":25578853,"node_id":"MDQ6VXNlcjI1NTc4ODUz","avatar_url":"https://avatars.githubusercontent.com/u/25578853?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangdove","html_url":"https://github.com/zhangdove","followers_url":"https://api.github.com/users/zhangdove/followers","following_url":"https://api.github.com/users/zhangdove/following{/other_user}","gists_url":"https://api.github.com/users/zhangdove/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangdove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangdove/subscriptions","organizations_url":"https://api.github.com/users/zhangdove/orgs","repos_url":"https://api.github.com/users/zhangdove/repos","events_url":"https://api.github.com/users/zhangdove/events{/privacy}","received_events_url":"https://api.github.com/users/zhangdove/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T03:29:21Z","updated_at":"2021-03-11T03:29:21Z","author_association":"CONTRIBUTOR","body":"I also agree that the default 'cache-enable' is set to false and it is up to the user to turn this parameter on or not.\r\n\r\nIn particular, some long lived Spark Sessions may have exceptions due to default caching. There are two kinds of situations that we encounter:\r\n\r\n1. Asynchronous job clears old snapshots and data files (the higher the frequency of triggering, the more likely it is to occur)\r\n2. Asynchronous job cleaning orphan files will clear older metadata.json (write.metadata.previous-versions-max default value is 100)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796413642/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796510443","html_url":"https://github.com/apache/iceberg/issues/2235#issuecomment-796510443","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2235","id":796510443,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjUxMDQ0Mw==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T06:58:35Z","updated_at":"2021-03-11T06:58:35Z","author_association":"MEMBER","body":"@elkhand , Sorry for the delay,  there's no other reason that we did not provide the `checkNullability` and `checkOrdering` option.  We flink could provide that options if we really need.  I think that could be a TODO issue for iceberg flink connector. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796510443/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796515616","html_url":"https://github.com/apache/iceberg/issues/2319#issuecomment-796515616","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2319","id":796515616,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjUxNTYxNg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T07:07:37Z","updated_at":"2021-03-11T07:08:57Z","author_association":"CONTRIBUTOR","body":"None of the solutions is ideal. I wish Spark had a bit more control over that. My only worry about setting it as false is breaking self joins. Maybe, we can delegate that concern to Spark rather than to the caching catalog in Iceberg? I would not mind changing the default if there is enough consensus. I did ask this question earlier myself.\r\n\r\nI'd like to hear from @rdblue @Parth-Brahmbhatt @danielcweeks as folks seem to rely on the current behavior.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796515616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796552497","html_url":"https://github.com/apache/iceberg/pull/2296#issuecomment-796552497","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2296","id":796552497,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjU1MjQ5Nw==","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T08:11:29Z","updated_at":"2021-03-11T08:11:29Z","author_association":"MEMBER","body":"@RussellSpitzer Can you approve and merge it?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796552497/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796568356","html_url":"https://github.com/apache/iceberg/issues/2317#issuecomment-796568356","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2317","id":796568356,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjU2ODM1Ng==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T08:40:20Z","updated_at":"2021-03-11T08:41:19Z","author_association":"CONTRIBUTOR","body":"As a Hive user I would hate if I have to handle Type 2 errors. Is this rare enough to leave unhandled?\r\n\r\nJust brainstorming:\r\n- If we want to avoid this situation we can acquire a shared lock for getting the snapshot as well. This would mean that during the swap operation we should wait until the write operation is either finished successfully or failed. Since ideally both swap and getting the snapshot is a very short operation this should not cause too much trouble. OTOH if there are plenty of reads the we can have problem getting the exclusive lock for writes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796568356/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796578997","html_url":"https://github.com/apache/iceberg/issues/2319#issuecomment-796578997","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2319","id":796578997,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjU3ODk5Nw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T08:58:20Z","updated_at":"2021-03-11T08:58:20Z","author_association":"CONTRIBUTOR","body":"I found the same issue and tried to start a discussion on the dev list [discussion](https://mail-archives.apache.org/mod_mbox/iceberg-dev/202102.mbox/%3c3113F592-08A2-4EEA-9F76-F3DB32870DEE@cloudera.com%3e) about it.\r\nThe main points are:\r\n- Stale data\r\n- Table object is not thread safe\r\n\r\nAlso chatted a little bit about it with @rdblue, and he mentioned that in Spark the CachingCatalog is also used for making sure that the same version of the table is retrieved every time during the same session. So getting back stale data is a feature, not a bug.\r\n\r\nBased on this discussion my feeling is that the best solution would be to create a metadata cache around `TableMetadataParser.read(FileIO io, InputFile file)` where the cache key is the `file.location()`.\r\n\r\nThe snapshots are immutable and I guess (no hard numbers on it yet) that the most resource intensive part of the table creation is metadata fetching from S3 and file parsing, so this would help us more and allows us to have a least complicated solution.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796578997/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796609864","html_url":"https://github.com/apache/iceberg/pull/2075#issuecomment-796609864","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2075","id":796609864,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjYwOTg2NA==","user":{"login":"dixingxing0","id":1303530,"node_id":"MDQ6VXNlcjEzMDM1MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1303530?v=4","gravatar_id":"","url":"https://api.github.com/users/dixingxing0","html_url":"https://github.com/dixingxing0","followers_url":"https://api.github.com/users/dixingxing0/followers","following_url":"https://api.github.com/users/dixingxing0/following{/other_user}","gists_url":"https://api.github.com/users/dixingxing0/gists{/gist_id}","starred_url":"https://api.github.com/users/dixingxing0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dixingxing0/subscriptions","organizations_url":"https://api.github.com/users/dixingxing0/orgs","repos_url":"https://api.github.com/users/dixingxing0/repos","events_url":"https://api.github.com/users/dixingxing0/events{/privacy}","received_events_url":"https://api.github.com/users/dixingxing0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T09:48:01Z","updated_at":"2021-03-11T09:48:01Z","author_association":"CONTRIBUTOR","body":"@pvary  @rdblue  could you please review this pr again, i think this can help iceberg users who has enabled hive metastore sasl.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796609864/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796610725","html_url":"https://github.com/apache/iceberg/issues/2318#issuecomment-796610725","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2318","id":796610725,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjYxMDcyNQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T09:49:27Z","updated_at":"2021-03-11T09:49:27Z","author_association":"MEMBER","body":"@johnclara  Thanks for reporting this,  I think it's a bug need to be fixed.  Would you like to prepare a PR for this ?  Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796610725/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796636597","html_url":"https://github.com/apache/iceberg/issues/2317#issuecomment-796636597","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2317","id":796636597,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjYzNjU5Nw==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T10:31:06Z","updated_at":"2021-03-11T10:31:06Z","author_association":"COLLABORATOR","body":"When running into a Type 2 error,  I think our retry logic would need to be changed. When retrying for a Type 2, we shouldn't cleanup the files prematurely, but instead should first attempt to reconnect to the catalog to double-check if the earlier operation succeeded. \r\n\r\n- If we get an answer, and our snapshot is in the history of the table, then we're essentially done and no need to do anything.\r\n- If we get an answer, and our snapshot is not in the table history, we proceed with the file cleanup and the retry. \r\n- If we cannot get ahold of the catalog persistently, then we'll give up the retry operation but still don't do any file cleanup. That ensures that if the operation did succeed, then we're not messing things up. If it was unsuccessful, that could leave some dangling files temporarily but that should be cleaned up by the Cleaner eventually, IIUC.\r\n\r\nWhat do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796636597/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796640343","html_url":"https://github.com/apache/iceberg/pull/2075#issuecomment-796640343","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2075","id":796640343,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjY0MDM0Mw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T10:37:43Z","updated_at":"2021-03-11T10:37:43Z","author_association":"CONTRIBUTOR","body":"CC: @lcspinter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796640343/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796687147","html_url":"https://github.com/apache/iceberg/issues/2317#issuecomment-796687147","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2317","id":796687147,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjY4NzE0Nw==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T12:01:56Z","updated_at":"2021-03-11T12:01:56Z","author_association":"CONTRIBUTOR","body":"Re Hive: @marton-bod's logic sounds correct to me, including the case of multiple commiters. I guess its a matter of accurately identifying type 2 vs type 1\r\n\r\nRe other catalogs. Nessie is susceptible to this issue as well. I think the fix is straightforward - certain exceptions don't delete metadata. Retrying the commit again is safe as it will create an empty commit. Polluting the commit log is annoying but at least the data is safe. Will raise a PR for Nessie soon to fix this. Nessie avoids the branching behaviour described by @RussellSpitzer thanks to it forcing a linear history so its safe with multiple commiters too.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796687147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796722305","html_url":"https://github.com/apache/iceberg/issues/2317#issuecomment-796722305","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2317","id":796722305,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjcyMjMwNQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T13:06:50Z","updated_at":"2021-03-11T13:06:50Z","author_association":"MEMBER","body":"@pvary If we do not handle them we basically corrupt the iceberg table when they happen and require manual restoration/\r\n\r\nI agree with @marton-bod, we can really do any amount of retries and reconnects but eventually we have to give up and at that point we must not clean up.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796722305/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796723589","html_url":"https://github.com/apache/iceberg/pull/2203#issuecomment-796723589","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2203","id":796723589,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjcyMzU4OQ==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T13:08:50Z","updated_at":"2021-03-11T13:08:50Z","author_association":"CONTRIBUTOR","body":"Thanks for taking a look @aokolnychyi I have removed the hadoop changes and rebased","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796723589/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796735616","html_url":"https://github.com/apache/iceberg/pull/2286#issuecomment-796735616","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2286","id":796735616,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjczNTYxNg==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T13:29:12Z","updated_at":"2021-03-11T13:29:12Z","author_association":"CONTRIBUTOR","body":"> I've made the changes you suggested. Please take a look again.\r\n\r\nThanks @mayursrivastava I will get to this asap :+1: \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796735616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796735828","html_url":"https://github.com/apache/iceberg/issues/2317#issuecomment-796735828","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2317","id":796735828,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjczNTgyOA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T13:29:33Z","updated_at":"2021-03-11T13:29:33Z","author_association":"CONTRIBUTOR","body":"> I agree with @marton-bod, we can really do any amount of retries and reconnects but eventually we have to give up and at that point we must not clean up.\r\n\r\nIs @marton-bod's assumption is correct, that if we give up and the commit was not successful then the dangling files will be cleaned up by the Cleaner eventually?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796735828/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796737113","html_url":"https://github.com/apache/iceberg/issues/2317#issuecomment-796737113","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2317","id":796737113,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjczNzExMw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T13:31:38Z","updated_at":"2021-03-11T13:31:38Z","author_association":"MEMBER","body":"Eventually the end user will need to run \"remove orphan files\" or something like the case of Type 2 Failure that is actually a failure and not just a network issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796737113/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796740977","html_url":"https://github.com/apache/iceberg/issues/2317#issuecomment-796740977","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2317","id":796740977,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Njc0MDk3Nw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T13:37:40Z","updated_at":"2021-03-11T13:38:06Z","author_association":"CONTRIBUTOR","body":"> Eventually the end user will need to run \"remove orphan files\" or something like the case of Type 2 Failure that is actually a failure and not just a network issue.\r\n\r\nThanks for the info!\r\nSo the tools are there, but manual intervention is needed.\r\n\r\nThe number of these manual interventions could be minimized with @marton-bod's suggestion by checking the table status after a Type 2 failure and running cleanup automatically if the connection is available again and the commit was not successful. This solution looks good to me","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796740977/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796797019","html_url":"https://github.com/apache/iceberg/pull/1918#issuecomment-796797019","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1918","id":796797019,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Njc5NzAxOQ==","user":{"login":"ggershinsky","id":12033212,"node_id":"MDQ6VXNlcjEyMDMzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/12033212?v=4","gravatar_id":"","url":"https://api.github.com/users/ggershinsky","html_url":"https://github.com/ggershinsky","followers_url":"https://api.github.com/users/ggershinsky/followers","following_url":"https://api.github.com/users/ggershinsky/following{/other_user}","gists_url":"https://api.github.com/users/ggershinsky/gists{/gist_id}","starred_url":"https://api.github.com/users/ggershinsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggershinsky/subscriptions","organizations_url":"https://api.github.com/users/ggershinsky/orgs","repos_url":"https://api.github.com/users/ggershinsky/repos","events_url":"https://api.github.com/users/ggershinsky/events{/privacy}","received_events_url":"https://api.github.com/users/ggershinsky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T14:57:34Z","updated_at":"2021-03-11T14:57:34Z","author_association":"CONTRIBUTOR","body":"Hi guys, now that parquet-mr-1.12 is about to be released, we're starting to explore integration of Parquet column encryption in Iceberg. Thanks for looping me in, this pull request is certainly related. From the discussion above, and from the PR code, it looks like the focus is on general file encryption/decryption streams, and not on leveraging the native column encryption capabilities in Parquet and ORC. Which is fine, as these offer complementary sets of capabilities. Also, I agree these mechanisms share many common areas that we should define and re-use as much as possible. I'm sure this is possible; e.g. I see references to Parquet key management design and concepts like single and double wrapping. There is a number of open questions, though, like the storage of key material and an approach to key rotation; definition of key material, key metadata, key provider etc; protection of column statistics with global or column-specific keys; etc. I think it would be good to have a design document that draws a top-down picture of data encryption in Iceberg, with the goals and staging/roadmap; how this PR fits it, how ORC and Parquet column encryption will fit in later, what should be the common layers, etc.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796797019/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796820310","html_url":"https://github.com/apache/iceberg/pull/2325#issuecomment-796820310","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2325","id":796820310,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjgyMDMxMA==","user":{"login":"lcspinter","id":47777102,"node_id":"MDQ6VXNlcjQ3Nzc3MTAy","avatar_url":"https://avatars.githubusercontent.com/u/47777102?v=4","gravatar_id":"","url":"https://api.github.com/users/lcspinter","html_url":"https://github.com/lcspinter","followers_url":"https://api.github.com/users/lcspinter/followers","following_url":"https://api.github.com/users/lcspinter/following{/other_user}","gists_url":"https://api.github.com/users/lcspinter/gists{/gist_id}","starred_url":"https://api.github.com/users/lcspinter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lcspinter/subscriptions","organizations_url":"https://api.github.com/users/lcspinter/orgs","repos_url":"https://api.github.com/users/lcspinter/repos","events_url":"https://api.github.com/users/lcspinter/events{/privacy}","received_events_url":"https://api.github.com/users/lcspinter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T15:29:51Z","updated_at":"2021-03-11T15:29:51Z","author_association":"CONTRIBUTOR","body":"@rymurr @pvary @marton-bod Could you please review this PR? Thank you","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796820310/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796843692","html_url":"https://github.com/apache/iceberg/issues/2326#issuecomment-796843692","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2326","id":796843692,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Njg0MzY5Mg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T16:01:27Z","updated_at":"2021-03-11T16:01:27Z","author_association":"MEMBER","body":"I think the predicate pushdown approach is probably the simplest solution at the moment, if you look in the Partition table code it creates a Scan which can have predicates applied to it, these should be filtered in the same way a normal scan would be.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796843692/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796845953","html_url":"https://github.com/apache/iceberg/issues/2326#issuecomment-796845953","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2326","id":796845953,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Njg0NTk1Mw==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T16:04:15Z","updated_at":"2021-03-11T16:05:08Z","author_association":"COLLABORATOR","body":"Yea I was thinking that, I can take a quick look at this.  Wondering about exposing Partition min/max in API based on what is \r\non the current snapshot's manifest-list, I guess it's a bit too internal to V1 spec?  Even though it'd be a bit useful for a super quick response.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796845953/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796847658","html_url":"https://github.com/apache/iceberg/issues/2326#issuecomment-796847658","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2326","id":796847658,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Njg0NzY1OA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T16:06:32Z","updated_at":"2021-03-11T16:06:32Z","author_association":"MEMBER","body":"I think if you wanted to go the spark route you could do the same conversion we already do for Spark Filters -> Iceberg Expressions and just apply them directly? I would think we could just expose \"PartitionTable(Expressions)\" ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796847658/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796868732","html_url":"https://github.com/apache/iceberg/issues/2326#issuecomment-796868732","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2326","id":796868732,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Njg2ODczMg==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T16:33:27Z","updated_at":"2021-03-11T16:33:27Z","author_association":"COLLABORATOR","body":"Yea sorry if I missed your point, I think pushing down expression to PartitionTable can either be Spark or current route (for Spark can wait until you PR is done).  \r\n\r\nBut min/max is not an expression (rather an aggregate)?  Which I guess is not pushed down by Spark for now?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796868732/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796873814","html_url":"https://github.com/apache/iceberg/pull/2240#issuecomment-796873814","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2240","id":796873814,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Njg3MzgxNA==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T16:40:12Z","updated_at":"2021-03-11T16:40:12Z","author_association":"COLLABORATOR","body":"Thanks for looking @aokolnychyi .  Oh yes what a coincidence, yea if that could be merged then I can rebase and just make the changes to the metrics part.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796873814/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796895875","html_url":"https://github.com/apache/iceberg/pull/2266#issuecomment-796895875","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2266","id":796895875,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Njg5NTg3NQ==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T17:09:53Z","updated_at":"2021-03-11T17:09:53Z","author_association":"COLLABORATOR","body":"Done, thanks @rymurr !  To be honest, its my first python change in quite awhile :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796895875/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796912149","html_url":"https://github.com/apache/iceberg/pull/2266#issuecomment-796912149","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2266","id":796912149,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjkxMjE0OQ==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T17:34:16Z","updated_at":"2021-03-11T17:34:16Z","author_association":"CONTRIBUTOR","body":"looks great @szehon-ho I will approve once the tests pass. Thanks a lot!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796912149/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796917905","html_url":"https://github.com/apache/iceberg/pull/2266#issuecomment-796917905","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2266","id":796917905,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjkxNzkwNQ==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T17:43:27Z","updated_at":"2021-03-11T17:43:27Z","author_association":"COLLABORATOR","body":"OK let me fix the linting","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796917905/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796951503","html_url":"https://github.com/apache/iceberg/issues/2317#issuecomment-796951503","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2317","id":796951503,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Njk1MTUwMw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T18:32:15Z","updated_at":"2021-03-11T18:32:15Z","author_association":"MEMBER","body":"Posted a WIP ^ for feedback while I work on tests","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796951503/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796980469","html_url":"https://github.com/apache/iceberg/pull/2266#issuecomment-796980469","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2266","id":796980469,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Njk4MDQ2OQ==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T19:20:20Z","updated_at":"2021-03-11T19:20:20Z","author_association":"COLLABORATOR","body":"Finally all green!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/796980469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797071203","html_url":"https://github.com/apache/iceberg/pull/2296#issuecomment-797071203","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2296","id":797071203,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzA3MTIwMw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T21:46:27Z","updated_at":"2021-03-11T21:46:27Z","author_association":"MEMBER","body":"I do not have that power :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797071203/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797075661","html_url":"https://github.com/apache/iceberg/pull/2296#issuecomment-797075661","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2296","id":797075661,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzA3NTY2MQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T21:54:57Z","updated_at":"2021-03-11T21:54:57Z","author_association":"CONTRIBUTOR","body":"Let me take a look too.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797075661/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797085585","html_url":"https://github.com/apache/iceberg/pull/2296#issuecomment-797085585","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2296","id":797085585,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzA4NTU4NQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T22:14:26Z","updated_at":"2021-03-11T22:14:26Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer and I had a quick chat.\r\n\r\nWe exclude all antlr4 dependencies except the runtime jar that is needed for parsing [here](https://github.com/apache/iceberg/blob/900476d62ea599cccfc6e01806b0f02d00ce16af/build.gradle#L962).\r\n\r\nSo far, we were lucky and it did not cause any conflicts as we are using the same antlr4 version as Spark. However, what if Spark decides to change the version? Then there will be conflicts. We could exclude that jar like this PR does and rely on the jar available in Spark. However, what if Spark bumps its version to something not compatible with what we use? We won't detect it at build time.\r\n\r\nIt seems the safest option is to actually shade the runtime antlr4 dep and be independent from Spark. \r\n\r\nWhat does everybody think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797085585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797103513","html_url":"https://github.com/apache/iceberg/issues/2319#issuecomment-797103513","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2319","id":797103513,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzEwMzUxMw==","user":{"login":"edgarRd","id":266670,"node_id":"MDQ6VXNlcjI2NjY3MA==","avatar_url":"https://avatars.githubusercontent.com/u/266670?v=4","gravatar_id":"","url":"https://api.github.com/users/edgarRd","html_url":"https://github.com/edgarRd","followers_url":"https://api.github.com/users/edgarRd/followers","following_url":"https://api.github.com/users/edgarRd/following{/other_user}","gists_url":"https://api.github.com/users/edgarRd/gists{/gist_id}","starred_url":"https://api.github.com/users/edgarRd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edgarRd/subscriptions","organizations_url":"https://api.github.com/users/edgarRd/orgs","repos_url":"https://api.github.com/users/edgarRd/repos","events_url":"https://api.github.com/users/edgarRd/events{/privacy}","received_events_url":"https://api.github.com/users/edgarRd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T22:53:26Z","updated_at":"2021-03-11T23:04:07Z","author_association":"CONTRIBUTOR","body":"I think caching tables indefinitely in sessions (until garbage collected or a change happens) returning stale results is unintuitive (non-obvious) and inconsistent to be set enabled by default. Seems like multiple people have brought up this behavior in the past -  at least @aokolnychyi and @pvary - signaling how unintuitive returning stale results by default is. Also, it's inconsistent with how Hive and Presto handle Iceberg tables; but also how Spark handles queries to non-Iceberg tables.\r\n\r\nI'm not arguing for removing caching altogether - as @pvary mentioned, it can be a feature in some cases - but instead that the default should be the most intuitive and consistent behavior. If there are use cases that need to fix the state of the table at some point, then cache can be used explicitly rather than using it implicitly by default. In fact, Spark provides such constructs with https://spark.apache.org/docs/3.0.1/sql-ref-syntax-aux-cache-cache-table.html - shouldn't that be more in line with Spark's expected handling of cached tables?\r\n\r\n> My only worry about setting it as false is breaking self joins\r\n\r\nIf caching by default is needed in a full environment and it depends on having it enabled, this can be set in `spark-defaults.conf` and set the `cache-enable=true` regardless of the default value - it's anyways good practice to avoid depending on defaults. I think this is better rather than the other way around, expecting users to know they have to refresh their table to see if the table had changes. If the change of the default were to happen, we'd definitely need to include in docs/release notes. On the other hand, we could recommend users to set always `cache-enabled=false` to avoid depending on defaults and have fresh state, but as mentioned before, this seems less intuitive if you don't rely or know of this config.\r\n\r\n> Based on this discussion my feeling is that the best solution would be to create a metadata cache around TableMetadataParser.read(FileIO io, InputFile file) where the cache key is the file.location().\r\n\r\nI agree, this would solve caching for saving resources. However, this does not address the self-join concerns mentioned before, since they rely on looking at the same snapshot.\r\n\r\nI think @Parth-Brahmbhatt mentioned that there's a `refresh` store procedure, however I think that this goes in the wrong direction to support caching by default, i.e. users would need to know that tables are cached by default, which is problematic if the behavior is inconsistent with other compute engines or table formats. Instead, I think it's preferable to cache explicitly (either with https://spark.apache.org/docs/3.0.1/sql-ref-syntax-aux-cache-cache-table.html or a stored procedure); this makes the default behavior intuitive and consistent with other compute engines and other non-Iceberg tables in Spark.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797103513/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797179935","html_url":"https://github.com/apache/iceberg/pull/2321#issuecomment-797179935","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2321","id":797179935,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzE3OTkzNQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T01:59:13Z","updated_at":"2021-03-12T01:59:13Z","author_association":"MEMBER","body":"LGTM, +1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797179935/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797185398","html_url":"https://github.com/apache/iceberg/pull/2321#issuecomment-797185398","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2321","id":797185398,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzE4NTM5OA==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T02:15:06Z","updated_at":"2021-03-12T02:15:06Z","author_association":"COLLABORATOR","body":"Some Flink unit tests failed.  Could you re-run the CI? I can close and reopen the PR if necessary.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797185398/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797190843","html_url":"https://github.com/apache/iceberg/pull/2321#issuecomment-797190843","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2321","id":797190843,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzE5MDg0Mw==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T02:30:23Z","updated_at":"2021-03-12T02:30:23Z","author_association":"MEMBER","body":"I don't think this patch will affect the flink unit tests. Got this merged now, will take a look to the flink unit tests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797190843/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797210124","html_url":"https://github.com/apache/iceberg/pull/2075#issuecomment-797210124","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2075","id":797210124,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzIxMDEyNA==","user":{"login":"dixingxing0","id":1303530,"node_id":"MDQ6VXNlcjEzMDM1MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1303530?v=4","gravatar_id":"","url":"https://api.github.com/users/dixingxing0","html_url":"https://github.com/dixingxing0","followers_url":"https://api.github.com/users/dixingxing0/followers","following_url":"https://api.github.com/users/dixingxing0/following{/other_user}","gists_url":"https://api.github.com/users/dixingxing0/gists{/gist_id}","starred_url":"https://api.github.com/users/dixingxing0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dixingxing0/subscriptions","organizations_url":"https://api.github.com/users/dixingxing0/orgs","repos_url":"https://api.github.com/users/dixingxing0/repos","events_url":"https://api.github.com/users/dixingxing0/events{/privacy}","received_events_url":"https://api.github.com/users/dixingxing0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T03:30:16Z","updated_at":"2021-03-12T03:30:16Z","author_association":"CONTRIBUTOR","body":"@pvary comments addressed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797210124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797214639","html_url":"https://github.com/apache/iceberg/pull/2296#issuecomment-797214639","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2296","id":797214639,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzIxNDYzOQ==","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T03:45:43Z","updated_at":"2021-03-12T03:45:43Z","author_association":"MEMBER","body":"Thanks @aokolnychyi clarify, I agree that the ideal solution is relocate antlr4 runtime dependencies, and will close this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797214639/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797264297","html_url":"https://github.com/apache/iceberg/pull/2323#issuecomment-797264297","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2323","id":797264297,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzI2NDI5Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T06:19:33Z","updated_at":"2021-03-12T06:19:33Z","author_association":"CONTRIBUTOR","body":"Thank you, @rymurr!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797264297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797264824","html_url":"https://github.com/apache/iceberg/pull/2296#issuecomment-797264824","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2296","id":797264824,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzI2NDgyNA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T06:20:39Z","updated_at":"2021-03-12T06:20:39Z","author_association":"CONTRIBUTOR","body":"Would you be interested to work on that, @pan3793?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797264824/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797277486","html_url":"https://github.com/apache/iceberg/issues/2319#issuecomment-797277486","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2319","id":797277486,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzI3NzQ4Ng==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T06:51:07Z","updated_at":"2021-03-12T06:51:07Z","author_association":"CONTRIBUTOR","body":"> Also, it's inconsistent with how Hive and Presto handle Iceberg tables; but also how Spark handles queries to non-Iceberg tables.\r\n\r\nHive also should use the same snapshot of the table on query level, but the refresh is expected between sessions and transactions (currently queries). Since Hive query execution spans multiple JVMs, we have to find our own way for snapshotting tables. We have already started working on this (See BaseTable serialization)\r\n\r\n> I agree, this would solve caching for saving resources. However, this does not address the self-join concerns mentioned before, since they rely on looking at the same snapshot.\r\n\r\nI think the current CachingCatalog is too specific for general use but still has its own use-cases. Also, as this is a released feature some users might depend on its specific features. I would suggest to create a new one alongside it and when it is ready we might decide to deprecate the old.\r\n\r\nWhatdo you think? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797277486/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797415802","html_url":"https://github.com/apache/iceberg/issues/508#issuecomment-797415802","issue_url":"https://api.github.com/repos/apache/iceberg/issues/508","id":797415802,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzQxNTgwMg==","user":{"login":"ayush-san","id":57655135,"node_id":"MDQ6VXNlcjU3NjU1MTM1","avatar_url":"https://avatars.githubusercontent.com/u/57655135?v=4","gravatar_id":"","url":"https://api.github.com/users/ayush-san","html_url":"https://github.com/ayush-san","followers_url":"https://api.github.com/users/ayush-san/followers","following_url":"https://api.github.com/users/ayush-san/following{/other_user}","gists_url":"https://api.github.com/users/ayush-san/gists{/gist_id}","starred_url":"https://api.github.com/users/ayush-san/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayush-san/subscriptions","organizations_url":"https://api.github.com/users/ayush-san/orgs","repos_url":"https://api.github.com/users/ayush-san/repos","events_url":"https://api.github.com/users/ayush-san/events{/privacy}","received_events_url":"https://api.github.com/users/ayush-san/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T10:59:03Z","updated_at":"2021-03-12T10:59:03Z","author_association":"NONE","body":"I think for someone getting this error, these entries in documentation will help \r\n\r\n* For batch job - [Writing against partitioned table](https://iceberg.apache.org/spark/#writing-against-partitioned-table)\r\n* For streaming job - [Writing against partitioned table](https://iceberg.apache.org/spark-structured-streaming/)\r\n\r\nPR - https://github.com/apache/iceberg/pull/1929","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797415802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797513499","html_url":"https://github.com/apache/iceberg/pull/2266#issuecomment-797513499","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2266","id":797513499,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzUxMzQ5OQ==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T14:10:16Z","updated_at":"2021-03-12T14:10:16Z","author_association":"COLLABORATOR","body":"Thanks again @rymurr  for your time!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797513499/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797557395","html_url":"https://github.com/apache/iceberg/issues/1502#issuecomment-797557395","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1502","id":797557395,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzU1NzM5NQ==","user":{"login":"springle","id":3150844,"node_id":"MDQ6VXNlcjMxNTA4NDQ=","avatar_url":"https://avatars.githubusercontent.com/u/3150844?v=4","gravatar_id":"","url":"https://api.github.com/users/springle","html_url":"https://github.com/springle","followers_url":"https://api.github.com/users/springle/followers","following_url":"https://api.github.com/users/springle/following{/other_user}","gists_url":"https://api.github.com/users/springle/gists{/gist_id}","starred_url":"https://api.github.com/users/springle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/springle/subscriptions","organizations_url":"https://api.github.com/users/springle/orgs","repos_url":"https://api.github.com/users/springle/repos","events_url":"https://api.github.com/users/springle/events{/privacy}","received_events_url":"https://api.github.com/users/springle/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T15:20:33Z","updated_at":"2021-03-12T15:20:33Z","author_association":"CONTRIBUTOR","body":"Hi - I'm not sure if this should be a separate issue,  but I still see this error with some frequency while using Spark 2.4.4 and writing to an existing Iceberg table. It's non-deterministic, but it only seems to happen for longer writes (30+ minutes). I also see this TODO which seems related (https://github.com/apache/iceberg/blob/master/hive-metastore/src/main/java/org/apache/iceberg/hive/HiveCatalog.java#L522), but I'm not too familiar with Iceberg internals yet.\r\n\r\n```\r\nPy4JJavaError: An error occurred while calling o7137.save.\r\n: org.apache.spark.SparkException: Writing job aborted.\r\n\tat org.apache.spark.sql.execution.datasources.v2.WriteToDataSourceV2Exec.doExecute(WriteToDataSourceV2Exec.scala:92)\r\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:131)\r\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:127)\r\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:155)\r\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\r\n\tat org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)\r\n\tat org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)\r\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:80)\r\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:80)\r\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:676)\r\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:676)\r\n\tat org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1.apply(SQLExecution.scala:78)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:125)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:73)\r\n\tat org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:676)\r\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:260)\r\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:229)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\r\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\r\n\tat py4j.Gateway.invoke(Gateway.java:282)\r\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\r\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\r\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\nCaused by: java.lang.IllegalStateException: Cannot get a client from a closed pool\r\n\tat org.apache.iceberg.relocated.com.google.common.base.Preconditions.checkState(Preconditions.java:508)\r\n\tat org.apache.iceberg.hive.ClientPool.get(ClientPool.java:110)\r\n\tat org.apache.iceberg.hive.ClientPool.run(ClientPool.java:52)\r\n\tat org.apache.iceberg.hive.HiveTableOperations.doRefresh(HiveTableOperations.java:130)\r\n\tat org.apache.iceberg.BaseMetastoreTableOperations.refresh(BaseMetastoreTableOperations.java:86)\r\n\tat org.apache.iceberg.SnapshotProducer.refresh(SnapshotProducer.java:258)\r\n\tat org.apache.iceberg.SnapshotProducer.apply(SnapshotProducer.java:155)\r\n\tat org.apache.iceberg.BaseReplacePartitions.apply(BaseReplacePartitions.java:26)\r\n\tat org.apache.iceberg.SnapshotProducer.lambda$commit$2(SnapshotProducer.java:276)\r\n\tat org.apache.iceberg.util.Tasks$Builder.runTaskWithRetry(Tasks.java:404)\r\n\tat org.apache.iceberg.util.Tasks$Builder.runSingleThreaded(Tasks.java:213)\r\n\tat org.apache.iceberg.util.Tasks$Builder.run(Tasks.java:197)\r\n\tat org.apache.iceberg.util.Tasks$Builder.run(Tasks.java:189)\r\n\tat org.apache.iceberg.SnapshotProducer.commit(SnapshotProducer.java:275)\r\n\tat org.apache.iceberg.BaseReplacePartitions.commit(BaseReplacePartitions.java:26)\r\n\tat org.apache.iceberg.spark.source.Writer.commitOperation(Writer.java:172)\r\n\tat org.apache.iceberg.spark.source.Writer.replacePartitions(Writer.java:198)\r\n\tat org.apache.iceberg.spark.source.Writer.commit(Writer.java:148)\r\n\tat org.apache.spark.sql.execution.datasources.v2.WriteToDataSourceV2Exec.doExecute(WriteToDataSourceV2Exec.scala:76)\r\n\t... 27 more\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797557395/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797583632","html_url":"https://github.com/apache/iceberg/pull/2329#issuecomment-797583632","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2329","id":797583632,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzU4MzYzMg==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T16:00:18Z","updated_at":"2021-03-12T16:00:18Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi: any concerns about adding `TOTAL_FILE_SIZE_PROP` to the `SnapshotSummary`?\r\n\r\nThe Hive part looks good to me, so I will merge if there is no concerns about the core side.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797583632/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797603522","html_url":"https://github.com/apache/iceberg/issues/1502#issuecomment-797603522","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1502","id":797603522,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzYwMzUyMg==","user":{"login":"springle","id":3150844,"node_id":"MDQ6VXNlcjMxNTA4NDQ=","avatar_url":"https://avatars.githubusercontent.com/u/3150844?v=4","gravatar_id":"","url":"https://api.github.com/users/springle","html_url":"https://github.com/springle","followers_url":"https://api.github.com/users/springle/followers","following_url":"https://api.github.com/users/springle/following{/other_user}","gists_url":"https://api.github.com/users/springle/gists{/gist_id}","starred_url":"https://api.github.com/users/springle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/springle/subscriptions","organizations_url":"https://api.github.com/users/springle/orgs","repos_url":"https://api.github.com/users/springle/repos","events_url":"https://api.github.com/users/springle/events{/privacy}","received_events_url":"https://api.github.com/users/springle/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T16:30:56Z","updated_at":"2021-03-12T16:57:47Z","author_association":"CONTRIBUTOR","body":"From what I can understand, the child `Table` object is created with the catalog before [initializing the Spark writer](https://github.com/apache/iceberg/blob/master/spark2/src/main/java/org/apache/iceberg/spark/source/IcebergSource.java#L93), and then the reference to the catalog is lost (and sometimes GC'd, closing the connection pool in Hive's case). Who should own this reference - the `IcebergSource`, the `Writer`?\r\n\r\nEDIT: nevermind, looks like https://github.com/apache/iceberg/pull/2325 will resolve this!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797603522/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797711579","html_url":"https://github.com/apache/iceberg/issues/2326#issuecomment-797711579","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2326","id":797711579,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzcxMTU3OQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T19:41:56Z","updated_at":"2021-03-12T19:42:44Z","author_association":"CONTRIBUTOR","body":"Well, it was expected the partitions table would not perform that well when a lot of metadata is present. I had [this](https://github.com/apache/iceberg/pull/655#discussion_r347950984) comment on the original PR.\r\n\r\nDoing an aggregate on top of the files metadata table in Spark would be way faster but not instant. Have you tried that as a temp solution, @szehon-ho? I just wonder what's the difference in terms of performance. You can tune the input split size for metadata tables to have reasonable parallelism.\r\n\r\nThere is also an interesting proposal in #2182. Can we potentially benefit from it here?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797711579/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797712252","html_url":"https://github.com/apache/iceberg/issues/2326#issuecomment-797712252","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2326","id":797712252,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzcxMjI1Mg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T19:43:14Z","updated_at":"2021-03-12T19:43:14Z","author_association":"CONTRIBUTOR","body":"I definitely agree knowing a list of partitions in a table is a very common scenario and it should be quick.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797712252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797719341","html_url":"https://github.com/apache/iceberg/issues/2326#issuecomment-797719341","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2326","id":797719341,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzcxOTM0MQ==","user":{"login":"Parth-Brahmbhatt","id":6914358,"node_id":"MDQ6VXNlcjY5MTQzNTg=","avatar_url":"https://avatars.githubusercontent.com/u/6914358?v=4","gravatar_id":"","url":"https://api.github.com/users/Parth-Brahmbhatt","html_url":"https://github.com/Parth-Brahmbhatt","followers_url":"https://api.github.com/users/Parth-Brahmbhatt/followers","following_url":"https://api.github.com/users/Parth-Brahmbhatt/following{/other_user}","gists_url":"https://api.github.com/users/Parth-Brahmbhatt/gists{/gist_id}","starred_url":"https://api.github.com/users/Parth-Brahmbhatt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Parth-Brahmbhatt/subscriptions","organizations_url":"https://api.github.com/users/Parth-Brahmbhatt/orgs","repos_url":"https://api.github.com/users/Parth-Brahmbhatt/repos","events_url":"https://api.github.com/users/Parth-Brahmbhatt/events{/privacy}","received_events_url":"https://api.github.com/users/Parth-Brahmbhatt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T19:56:34Z","updated_at":"2021-03-12T19:56:34Z","author_association":"CONTRIBUTOR","body":"In presto , we basically implemented the partitions implementation as a view on top of files table and even for large table the performance is acceptable. We could do the same for spark and implement partitions as a view on top of files so the users don't really have to craft a query manually","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797719341/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797725905","html_url":"https://github.com/apache/iceberg/issues/2326#issuecomment-797725905","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2326","id":797725905,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzcyNTkwNQ==","user":{"login":"sunchao","id":506679,"node_id":"MDQ6VXNlcjUwNjY3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/506679?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchao","html_url":"https://github.com/sunchao","followers_url":"https://api.github.com/users/sunchao/followers","following_url":"https://api.github.com/users/sunchao/following{/other_user}","gists_url":"https://api.github.com/users/sunchao/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchao/subscriptions","organizations_url":"https://api.github.com/users/sunchao/orgs","repos_url":"https://api.github.com/users/sunchao/repos","events_url":"https://api.github.com/users/sunchao/events{/privacy}","received_events_url":"https://api.github.com/users/sunchao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T20:08:50Z","updated_at":"2021-03-12T20:08:50Z","author_association":"MEMBER","body":"FWIW aggregation pushdown is being worked on in Spark at the moment ([PR](https://github.com/apache/spark/pull/29695)). It targets JDBC datasources right now but @huaxingao is extending that to Parquet/Iceberg.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797725905/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797768675","html_url":"https://github.com/apache/iceberg/issues/2326#issuecomment-797768675","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2326","id":797768675,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Nzc2ODY3NQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T21:35:04Z","updated_at":"2021-03-12T21:35:04Z","author_association":"CONTRIBUTOR","body":"@Parth-Brahmbhatt, yeah, that would be great to do that when Spark has the view catalog.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797768675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797814402","html_url":"https://github.com/apache/iceberg/issues/2326#issuecomment-797814402","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2326","id":797814402,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzgxNDQwMg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T23:36:36Z","updated_at":"2021-03-12T23:36:36Z","author_association":"CONTRIBUTOR","body":"@szehon-ho, could you please try the equivalent query using the files table?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797814402/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797814544","html_url":"https://github.com/apache/iceberg/issues/2326#issuecomment-797814544","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2326","id":797814544,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzgxNDU0NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T23:37:08Z","updated_at":"2021-03-12T23:37:08Z","author_association":"CONTRIBUTOR","body":"@sunchao, it is great to see progress on that one! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797814544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797825441","html_url":"https://github.com/apache/iceberg/pull/2287#issuecomment-797825441","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2287","id":797825441,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzgyNTQ0MQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-13T00:10:59Z","updated_at":"2021-03-13T00:10:59Z","author_association":"CONTRIBUTOR","body":"A few minor points and should be ready to go. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797825441/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797831073","html_url":"https://github.com/apache/iceberg/pull/2328#issuecomment-797831073","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2328","id":797831073,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzgzMTA3Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-13T00:31:36Z","updated_at":"2021-03-13T00:31:36Z","author_association":"CONTRIBUTOR","body":"I think the current approach looks good. I have just a couple of nits.\r\n\r\nI checked the following places and seems like we don't have to update them:\r\n\r\n- UpdateLocation\r\n- UpdateSchema\r\n- UpdatePartitionSpec\r\n- ReplaceSortOrder","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797831073/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797831347","html_url":"https://github.com/apache/iceberg/pull/2328#issuecomment-797831347","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2328","id":797831347,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzgzMTM0Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-13T00:33:06Z","updated_at":"2021-03-13T00:33:06Z","author_association":"CONTRIBUTOR","body":"It would be great to hear your thoughts, @pvary @rymurr @Parth-Brahmbhatt @danielcweeks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797831347/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797836912","html_url":"https://github.com/apache/iceberg/pull/2287#issuecomment-797836912","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2287","id":797836912,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzgzNjkxMg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-13T00:59:21Z","updated_at":"2021-03-13T00:59:21Z","author_association":"CONTRIBUTOR","body":"I gave it a round of testing and it seems we overlooked the fact that each action will get a new counter.\r\nI think the counter should be a static variable:\r\n\r\n```\r\nprivate static final AtomicInteger JOB_COUNTER = new AtomicInteger();\r\n```\r\n\r\nAlso, there seems to be a style violation. @karuppayya, could you update those, please? LGTM otherwise.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797836912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797839585","html_url":"https://github.com/apache/iceberg/pull/2287#issuecomment-797839585","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2287","id":797839585,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzgzOTU4NQ==","user":{"login":"karuppayya","id":5082742,"node_id":"MDQ6VXNlcjUwODI3NDI=","avatar_url":"https://avatars.githubusercontent.com/u/5082742?v=4","gravatar_id":"","url":"https://api.github.com/users/karuppayya","html_url":"https://github.com/karuppayya","followers_url":"https://api.github.com/users/karuppayya/followers","following_url":"https://api.github.com/users/karuppayya/following{/other_user}","gists_url":"https://api.github.com/users/karuppayya/gists{/gist_id}","starred_url":"https://api.github.com/users/karuppayya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karuppayya/subscriptions","organizations_url":"https://api.github.com/users/karuppayya/orgs","repos_url":"https://api.github.com/users/karuppayya/repos","events_url":"https://api.github.com/users/karuppayya/events{/privacy}","received_events_url":"https://api.github.com/users/karuppayya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-13T01:12:45Z","updated_at":"2021-03-13T01:12:45Z","author_association":"CONTRIBUTOR","body":"> I gave it a round of testing and it seems we overlooked the fact that each action will get a new counter.\r\n> I think the counter should be a static variable:\r\n\r\nCompletely missed this, Thanks!!!\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797839585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797839663","html_url":"https://github.com/apache/iceberg/issues/2309#issuecomment-797839663","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2309","id":797839663,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzgzOTY2Mw==","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-13T01:13:09Z","updated_at":"2021-03-13T01:13:09Z","author_association":"CONTRIBUTOR","body":"Looking at this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797839663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797852639","html_url":"https://github.com/apache/iceberg/pull/2275#issuecomment-797852639","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2275","id":797852639,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Nzg1MjYzOQ==","user":{"login":"yyanyy","id":71906210,"node_id":"MDQ6VXNlcjcxOTA2MjEw","avatar_url":"https://avatars.githubusercontent.com/u/71906210?v=4","gravatar_id":"","url":"https://api.github.com/users/yyanyy","html_url":"https://github.com/yyanyy","followers_url":"https://api.github.com/users/yyanyy/followers","following_url":"https://api.github.com/users/yyanyy/following{/other_user}","gists_url":"https://api.github.com/users/yyanyy/gists{/gist_id}","starred_url":"https://api.github.com/users/yyanyy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyanyy/subscriptions","organizations_url":"https://api.github.com/users/yyanyy/orgs","repos_url":"https://api.github.com/users/yyanyy/repos","events_url":"https://api.github.com/users/yyanyy/events{/privacy}","received_events_url":"https://api.github.com/users/yyanyy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-13T02:39:10Z","updated_at":"2021-03-13T02:39:10Z","author_association":"CONTRIBUTOR","body":"> I have some questions:\r\n> When we switch from v1 format to v2, and a new metadata file is written for an existing table, what schemas are written to the `schemas` list? And in the `snapshot-log`, what `schema-id` is written for the previous snapshots? (Is it not written, i.e., is null? or is it 0?)\r\n> In general, if we see a schema id of 0, does that ever represent a specific schema, or does that always represent some undetermined schema? Let me elaborate: (1) Will we ever see a `schema-id` of 0 in a metadata file and if so, does that refer to a unique schema? (2) In code, if we have an instance of a schema and its schemaId is 0, what are the semantics of that schemaId?\r\n\r\nThank you for the review, and sorry for the delay responding!\r\n\r\nI think this change applies to v1 tables as well. When the engine starts to use a release with this change, the new `schemas` list will be written with the current schema and 0 as its default schema id. And in `snapshot-log`, previous snapshots will have null schema-id since they were not available when they were written. \r\n\r\n0 is a valid schema-id and it will refer to a unique schema in metadata file; if there's no schema evolution after the table starts to write `schemas`, 0 will be assigned to the current schema. And in the code, since we only care about id during the interaction with table metadata, and throughout the process when schema class is used as various classes for doing projection etc, schemaId will always be 0, and that is just a default value and shouldn't be used. #2096 has some conversation around this, and this behavior is mentioned in [schema class](https://github.com/apache/iceberg/blob/master/api/src/main/java/org/apache/iceberg/Schema.java#L44-L45).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797852639/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797852850","html_url":"https://github.com/apache/iceberg/pull/2320#issuecomment-797852850","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2320","id":797852850,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Nzg1Mjg1MA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-13T02:41:02Z","updated_at":"2021-03-13T02:41:02Z","author_association":"MEMBER","body":"Got this merged,  Thanks @chenjunjiedada for contributing ! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797852850/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797865540","html_url":"https://github.com/apache/iceberg/pull/2328#issuecomment-797865540","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2328","id":797865540,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Nzg2NTU0MA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-13T04:38:46Z","updated_at":"2021-03-13T04:38:46Z","author_association":"MEMBER","body":"Thanks @pvary + @aokolnychyi , \r\nand thanks in advance to everyone else who is about to review. This is probably the best part of Open Source when we can all come together and fix issues like this as a community.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/797865540/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/798046841","html_url":"https://github.com/apache/iceberg/pull/2296#issuecomment-798046841","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2296","id":798046841,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODA0Njg0MQ==","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-13T09:47:09Z","updated_at":"2021-03-13T09:47:09Z","author_association":"MEMBER","body":"> Would you be interested to work on that, @pan3793?\r\n\r\nI will open another PR for it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/798046841/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]