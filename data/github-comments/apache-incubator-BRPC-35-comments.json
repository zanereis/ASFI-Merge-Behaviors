[{"url":"https://api.github.com/repos/apache/brpc/issues/comments/754603575","html_url":"https://github.com/apache/brpc/issues/1319#issuecomment-754603575","issue_url":"https://api.github.com/repos/apache/brpc/issues/1319","id":754603575,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDYwMzU3NQ==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T12:23:17Z","updated_at":"2021-01-05T12:23:17Z","author_association":"CONTRIBUTOR","body":"> 我设置成max_concurrency=200都不行，不加这个参数，服务是可以恢复正常的，客户端接收到的错误是service faild, err_code: 2004 reason: [E2004][127.0.0.1:9053][E2004]Reached server's max_concurrency=200 [R1][E2004]；看服务端 不停报，src/bthread/task_group.cpp:672] _remote_rq is full, capacity=2048，监控上并发度还为concurrency: 200，是一些状态变量没法恢复吗，不设置这个参数，是可以恢复正常的\r\n\r\n看你描述max_concurrency=200对于你们服务来说还是大了。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/754603575/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/754626556","html_url":"https://github.com/apache/brpc/issues/1322#issuecomment-754626556","issue_url":"https://api.github.com/repos/apache/brpc/issues/1322","id":754626556,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDYyNjU1Ng==","user":{"login":"chenzhangyi","id":6805583,"node_id":"MDQ6VXNlcjY4MDU1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/6805583?v=4","gravatar_id":"","url":"https://api.github.com/users/chenzhangyi","html_url":"https://github.com/chenzhangyi","followers_url":"https://api.github.com/users/chenzhangyi/followers","following_url":"https://api.github.com/users/chenzhangyi/following{/other_user}","gists_url":"https://api.github.com/users/chenzhangyi/gists{/gist_id}","starred_url":"https://api.github.com/users/chenzhangyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenzhangyi/subscriptions","organizations_url":"https://api.github.com/users/chenzhangyi/orgs","repos_url":"https://api.github.com/users/chenzhangyi/repos","events_url":"https://api.github.com/users/chenzhangyi/events{/privacy}","received_events_url":"https://api.github.com/users/chenzhangyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T13:10:59Z","updated_at":"2021-01-05T13:10:59Z","author_association":"MEMBER","body":"是有方案了还是一个feature request？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/754626556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/754727509","html_url":"https://github.com/apache/brpc/issues/1319#issuecomment-754727509","issue_url":"https://api.github.com/repos/apache/brpc/issues/1319","id":754727509,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NDcyNzUwOQ==","user":{"login":"zhuqingrui","id":15721856,"node_id":"MDQ6VXNlcjE1NzIxODU2","avatar_url":"https://avatars.githubusercontent.com/u/15721856?v=4","gravatar_id":"","url":"https://api.github.com/users/zhuqingrui","html_url":"https://github.com/zhuqingrui","followers_url":"https://api.github.com/users/zhuqingrui/followers","following_url":"https://api.github.com/users/zhuqingrui/following{/other_user}","gists_url":"https://api.github.com/users/zhuqingrui/gists{/gist_id}","starred_url":"https://api.github.com/users/zhuqingrui/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhuqingrui/subscriptions","organizations_url":"https://api.github.com/users/zhuqingrui/orgs","repos_url":"https://api.github.com/users/zhuqingrui/repos","events_url":"https://api.github.com/users/zhuqingrui/events{/privacy}","received_events_url":"https://api.github.com/users/zhuqingrui/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-05T16:01:18Z","updated_at":"2021-01-05T16:01:18Z","author_association":"NONE","body":"brpc框架认为是大了，但是机器cpu利用率只有40%；另外当我把请求停掉的时候，空跑着的服务的server._concurrency的值一直是200，当我再单次请求的时候，会增加成201，而被限流；另外发现task_group的队列也是一直满着的，没有进行消费呢","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/754727509/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/755134686","html_url":"https://github.com/apache/brpc/issues/1322#issuecomment-755134686","issue_url":"https://api.github.com/repos/apache/brpc/issues/1322","id":755134686,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTEzNDY4Ng==","user":{"login":"serverglen","id":38067377,"node_id":"MDQ6VXNlcjM4MDY3Mzc3","avatar_url":"https://avatars.githubusercontent.com/u/38067377?v=4","gravatar_id":"","url":"https://api.github.com/users/serverglen","html_url":"https://github.com/serverglen","followers_url":"https://api.github.com/users/serverglen/followers","following_url":"https://api.github.com/users/serverglen/following{/other_user}","gists_url":"https://api.github.com/users/serverglen/gists{/gist_id}","starred_url":"https://api.github.com/users/serverglen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/serverglen/subscriptions","organizations_url":"https://api.github.com/users/serverglen/orgs","repos_url":"https://api.github.com/users/serverglen/repos","events_url":"https://api.github.com/users/serverglen/events{/privacy}","received_events_url":"https://api.github.com/users/serverglen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-06T07:27:45Z","updated_at":"2021-01-06T07:27:45Z","author_association":"CONTRIBUTOR","body":"> 是有方案了还是一个feature request？\r\n\r\n内部已经实现了，最近准备提个PR","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/755134686/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":2,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/755299530","html_url":"https://github.com/apache/brpc/issues/1199#issuecomment-755299530","issue_url":"https://api.github.com/repos/apache/brpc/issues/1199","id":755299530,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTI5OTUzMA==","user":{"login":"sunzhenkai","id":74759149,"node_id":"MDQ6VXNlcjc0NzU5MTQ5","avatar_url":"https://avatars.githubusercontent.com/u/74759149?v=4","gravatar_id":"","url":"https://api.github.com/users/sunzhenkai","html_url":"https://github.com/sunzhenkai","followers_url":"https://api.github.com/users/sunzhenkai/followers","following_url":"https://api.github.com/users/sunzhenkai/following{/other_user}","gists_url":"https://api.github.com/users/sunzhenkai/gists{/gist_id}","starred_url":"https://api.github.com/users/sunzhenkai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunzhenkai/subscriptions","organizations_url":"https://api.github.com/users/sunzhenkai/orgs","repos_url":"https://api.github.com/users/sunzhenkai/repos","events_url":"https://api.github.com/users/sunzhenkai/events{/privacy}","received_events_url":"https://api.github.com/users/sunzhenkai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-06T13:30:09Z","updated_at":"2021-01-07T02:14:42Z","author_association":"NONE","body":"![image](https://user-images.githubusercontent.com/74759149/103773476-0f638a00-5066-11eb-9f34-1fa9ad1def7c.png)\r\n\r\ngflags静态库和共享库同时存在导致。我是选择手动编译gflags，在编译时为cmake指定选项`-DBUILD_SHARED_LIBS=1`，只编译共享库，可解决问题，具体参考[这里](https://github.com/sunzhenkai/cooking/blob/5022774c0185cf140c90553d837fc247f9586d67/c%2B%2B/universal/third/install.sh#L73)。如果是使用命令安装，可以尝试先移除`/usr/local/lib/libgflags.a` 和 `/usr/local/lib/libgflags_nothread.a`，然后重新编译brpc。\r\n![image](https://user-images.githubusercontent.com/74759149/103773612-4cc81780-5066-11eb-99f5-3ab1fa69dcfc.png)\r\n![image](https://user-images.githubusercontent.com/74759149/103774369-67e75700-5067-11eb-87f1-ab56ed2e0c09.png)\r\n\r\n\r\n如果遇到下面这个异常，类似的原因，移除静态库。\r\n```\r\nERROR: something wrong with flag 'help' in file '/Users/wii/Git/cooking/c++/universal/third/build/gflags-2.2.2/src/gflags_reporting.cc'.  One possibility: file '/Users/wii/Git/cooking/c++/universal/third/build/gflags-2.2.2/src/gflags_reporting.cc' is being linked both statically and dynamically into this executable.\r\n```\r\n\r\n以上仅供参考。\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/755299530/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/755305176","html_url":"https://github.com/apache/brpc/issues/1319#issuecomment-755305176","issue_url":"https://api.github.com/repos/apache/brpc/issues/1319","id":755305176,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTMwNTE3Ng==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-06T13:42:09Z","updated_at":"2021-01-06T13:42:09Z","author_association":"CONTRIBUTOR","body":"done->Run()没有调用导致泄漏了把，出现问题的时候，worker_usage, bthread_count这些bvar是多少? cpu不是唯一指标。\r\n另外确认，max_concurrency不设置反而不会触发你说的问题？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/755305176/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/755855550","html_url":"https://github.com/apache/brpc/issues/1319#issuecomment-755855550","issue_url":"https://api.github.com/repos/apache/brpc/issues/1319","id":755855550,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTg1NTU1MA==","user":{"login":"zhuqingrui","id":15721856,"node_id":"MDQ6VXNlcjE1NzIxODU2","avatar_url":"https://avatars.githubusercontent.com/u/15721856?v=4","gravatar_id":"","url":"https://api.github.com/users/zhuqingrui","html_url":"https://github.com/zhuqingrui","followers_url":"https://api.github.com/users/zhuqingrui/followers","following_url":"https://api.github.com/users/zhuqingrui/following{/other_user}","gists_url":"https://api.github.com/users/zhuqingrui/gists{/gist_id}","starred_url":"https://api.github.com/users/zhuqingrui/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhuqingrui/subscriptions","organizations_url":"https://api.github.com/users/zhuqingrui/orgs","repos_url":"https://api.github.com/users/zhuqingrui/repos","events_url":"https://api.github.com/users/zhuqingrui/events{/privacy}","received_events_url":"https://api.github.com/users/zhuqingrui/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T03:15:21Z","updated_at":"2021-01-07T03:15:21Z","author_association":"NONE","body":"线上服务，高并发跑了一两年了的😄","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/755855550/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/756295195","html_url":"https://github.com/apache/brpc/pull/1320#issuecomment-756295195","issue_url":"https://api.github.com/repos/apache/brpc/issues/1320","id":756295195,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NjI5NTE5NQ==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T18:26:10Z","updated_at":"2021-01-07T18:26:10Z","author_association":"MEMBER","body":"Thanks for the contribution.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/756295195/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/757357095","html_url":"https://github.com/apache/brpc/issues/1188#issuecomment-757357095","issue_url":"https://api.github.com/repos/apache/brpc/issues/1188","id":757357095,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NzM1NzA5NQ==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-09T19:41:17Z","updated_at":"2021-01-09T19:41:17Z","author_association":"CONTRIBUTOR","body":"#1325 猜测是ResourcePool返回了一个超过65535的id，原因是看ResourcePool的逻辑是65536个group * 65536个Block * 256个元素，其容量远大于2^32。而bthread_id_t的计算方式是 resource_id << 32 | version，那么resource_id == 0 和 resource_id = 65536生成的bthread_id_t的值是一样的，这俩id在return_resource的时候会把resource_id == 0的元素return两遍，后续get_resouce就会有问题。 #1179 这个也有可能是这个原因，不过1179看起来不光是TimerTask相同，而且还连在一起了，概率感觉比较低，还没有想明白\r\n\r\n这个issue另外一个问题是butex是nullptr，感觉可能是创建的时候就失败了，之前没有check，这个PR加了个check，#1326  \r\n\r\n@jamesge @acelyc111 辛苦帮忙review下看我的猜测是否合理哈，感谢\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/757357095/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/758449638","html_url":"https://github.com/apache/brpc/issues/1296#issuecomment-758449638","issue_url":"https://api.github.com/repos/apache/brpc/issues/1296","id":758449638,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODQ0OTYzOA==","user":{"login":"Pating","id":3406829,"node_id":"MDQ6VXNlcjM0MDY4Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/3406829?v=4","gravatar_id":"","url":"https://api.github.com/users/Pating","html_url":"https://github.com/Pating","followers_url":"https://api.github.com/users/Pating/followers","following_url":"https://api.github.com/users/Pating/following{/other_user}","gists_url":"https://api.github.com/users/Pating/gists{/gist_id}","starred_url":"https://api.github.com/users/Pating/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Pating/subscriptions","organizations_url":"https://api.github.com/users/Pating/orgs","repos_url":"https://api.github.com/users/Pating/repos","events_url":"https://api.github.com/users/Pating/events{/privacy}","received_events_url":"https://api.github.com/users/Pating/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-12T06:57:24Z","updated_at":"2021-01-12T07:03:53Z","author_association":"NONE","body":"> @Pating The patch is merged into rdma branch. You can try again and give me a feedback.\r\n\r\nHi Tuvie\r\n   我试了你提供最新的rdma分支， commit id是 62240fea92。在这个最新分支上还会有rdma的问题，虽然出现频率比老版本低，但也不是很难复现。我这边持续大压力读写，1个小时内就会复现。\r\n   如下是当前版本brpc的报错日志：\r\n  \r\n![image](https://user-images.githubusercontent.com/3406829/104279841-eddf2400-54e5-11eb-82b2-7f21e21a23d1.png)\r\n![image](https://user-images.githubusercontent.com/3406829/104279916-0bac8900-54e6-11eb-9258-ed0c9cec323d.png)\r\n![image](https://user-images.githubusercontent.com/3406829/104279980-25e66700-54e6-11eb-9642-a604fc321c9e.png)\r\n\r\nE0112 14:18:15.942765 934036 /home/changlox/essd/src/megrez/extentsvr/handler/write_block.cc:252] error replica cntl[E3001]Fail to handle RDMA completion, error status: 12\r\nE0112 14:18:15.942794 934038 /home/changlox/essd/src/megrez/extentsvr/handler/write_block.cc:252] error replica cntl[E3001]Fail to handle RDMA completion, error status: 12\r\nE0112 14:18:15.942765 934037 /home/changlox/essd/src/megrez/extentsvr/handler/write_block.cc:252] error replica cntl[E3001]Fail to handle RDMA completion, error status: 12\r\nE0112 14:18:15.942765 934031 /home/changlox/essd/src/megrez/extentsvr/handler/write_block.cc:252] error replica cntl[E3001]Fail to handle RDMA completion, error status: 12\r\nE0112 14:18:15.942822 934036 /home/changlox/essd/src/megrez/extentsvr/handler/write_block.cc:252] error replica cntl[E3001]Fail to handle RDMA completion, error status: 12\r\n\r\n\r\nN0112 22:17:17.946238 238499 /home/changlox/sxj/src/blockfs/blockserver/core/plane_impl.cc:303] Seal extent in segment:0 success, clear error state\r\nW0112 22:17:24.573034 238500 /home/changlox/software/brpc/src/brpc/rdma/rdma_completion_queue.cpp:417] Fail to handle RDMA completion, error status(12): RDMA verbs error\r\nE0112 22:17:24.573174 238511 /home/changlox/sxj/src/blockfs/blockserver/rpc/write_block.cc:78] Write block failed:[E3001]Fail to handle RDMA completion, error status: 12\r\nE0112 22:17:24.573203 238510 /home/changlox/sxj/src/blockfs/blockserver/rpc/write_block.cc:78] Write block failed:[E3001]Fail to handle RDMA completion, error status: 12\r\nE0112 22:17:24.573188 238501 /home/changlox/sxj/src/blockfs/blockserver/rpc/write_block.cc:78] Write block failed:[E3001]Fail to handle RDMA completion, error status: 12\r\nE0112 22:17:24.573192 238509 /home/changlox/sxj/src/blockfs/blockserver/rpc/write_block.cc:78] Write block failed:[E3001]Fail to handle RDMA completion, error status: 12\r\nE0112 22:17:24.573314 238509 /home/changlox/sxj/src/blockfs/blockserver/core/stream_rw.cc:244] Write block ret:-12000 err:network cntl err\r\nE0112 22:17:24.573182 238500 /home/changlox/sxj/src/blockfs/blockserver/rpc/write_block.cc:78] Write block failed:[E3001]Fail to handle RDMA completion, error status: 12\r\nE0112 22:17:24.573218 238511 /home/changlox/sxj/src/blockfs/blockserver/core/stream_rw.cc:244] Write block ret:-12000 err:network cntl err\r\nE0112 22:17:24.573367 238500 /home/changlox/sxj/src/blockfs/blockserver/core/stream_rw.cc:244] Write block ret:-12000 err:network cntl err\r\nE0112 22:17:24.573295 238501 /home/changlox/sxj/src/blockfs/blockserver/core/stream_rw.cc:244] Write block ret:-12000 err:network cntl err\r\nE0112 22:17:24.573352 238506 /home/changlox/sxj/src/blockfs/blockserver/handle/write.cc:111] Write ret:-12000 err:network cntl err retry write lba:5076942848 logid:0\r\nE0112 22:17:24.573249 238510 /home/changlox/sxj/src/blockfs/blockserver/core/stream_rw.cc:244] Write block ret:-12000 err:network cntl err\r\nE0112 22:17:24.573480 238506 /home/changlox/sxj/src/blockfs/blockserver/handle/write.cc:111] Write ret:-12000 err:network cntl err retry write lba:5076029440 logid:0\r\nE0112 22:17:24.573546 238506 /home/changlox/sxj/src/blockfs/blockserver/handle/write.cc:111] Write ret:-12000 err:network cntl err retry write lba:5077991424 logid:0\r\nE0112 22:17:24.573565 238506 /home/changlox/sxj/src/blockfs/blockserver/handle/write.cc:111] Write ret:-12000 err:network cntl err retry write lba:5075894272 logid:0\r\nW0112 22:17:24.573583 238506 /home/changlox/sxj/src/blockfs/blockserver/core/plane_impl.cc:267] segment:0 meet error, we'll do seal\r\nE0112 22:17:24.573599 238506 /home/changlox/sxj/src/blockfs/blockserver/handle/write.cc:111] Write ret:-12000 err:network cntl err retry write lba:5079040000 logid:0\r\n\r\n\r\n  如果需要更多信息请随时@我，多谢。\r\n\r\n\r\n\r\n      \r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/758449638/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/758574671","html_url":"https://github.com/apache/brpc/issues/1296#issuecomment-758574671","issue_url":"https://api.github.com/repos/apache/brpc/issues/1296","id":758574671,"node_id":"MDEyOklzc3VlQ29tbWVudDc1ODU3NDY3MQ==","user":{"login":"Tuvie","id":5780312,"node_id":"MDQ6VXNlcjU3ODAzMTI=","avatar_url":"https://avatars.githubusercontent.com/u/5780312?v=4","gravatar_id":"","url":"https://api.github.com/users/Tuvie","html_url":"https://github.com/Tuvie","followers_url":"https://api.github.com/users/Tuvie/followers","following_url":"https://api.github.com/users/Tuvie/following{/other_user}","gists_url":"https://api.github.com/users/Tuvie/gists{/gist_id}","starred_url":"https://api.github.com/users/Tuvie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tuvie/subscriptions","organizations_url":"https://api.github.com/users/Tuvie/orgs","repos_url":"https://api.github.com/users/Tuvie/repos","events_url":"https://api.github.com/users/Tuvie/events{/privacy}","received_events_url":"https://api.github.com/users/Tuvie/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-12T10:52:01Z","updated_at":"2021-01-12T10:52:01Z","author_association":"CONTRIBUTOR","body":"从日志上看，反馈的error status 是12，这个在rdma里代表IBV_WC_RETRY_EXC_ERR，也就是重试次数超限。RDMA和TCP不一样，TCP丢包可以近乎无限的重传，RDMA丢包后，超时重传有次数上限。超出上限后，整个QP会报上面的错，连接中断。\r\n看上去你测试底层使用的物理网络环境没有做特殊配置。建议在有PFC和ECN网络配置的物理网络环境中使用RoCE。否则确实会出现大量丢包导致连接中断的情况。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/758574671/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/759165844","html_url":"https://github.com/apache/brpc/pull/1329#issuecomment-759165844","issue_url":"https://api.github.com/repos/apache/brpc/issues/1329","id":759165844,"node_id":"MDEyOklzc3VlQ29tbWVudDc1OTE2NTg0NA==","user":{"login":"niukuo","id":6831097,"node_id":"MDQ6VXNlcjY4MzEwOTc=","avatar_url":"https://avatars.githubusercontent.com/u/6831097?v=4","gravatar_id":"","url":"https://api.github.com/users/niukuo","html_url":"https://github.com/niukuo","followers_url":"https://api.github.com/users/niukuo/followers","following_url":"https://api.github.com/users/niukuo/following{/other_user}","gists_url":"https://api.github.com/users/niukuo/gists{/gist_id}","starred_url":"https://api.github.com/users/niukuo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/niukuo/subscriptions","organizations_url":"https://api.github.com/users/niukuo/orgs","repos_url":"https://api.github.com/users/niukuo/repos","events_url":"https://api.github.com/users/niukuo/events{/privacy}","received_events_url":"https://api.github.com/users/niukuo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-13T02:40:25Z","updated_at":"2021-01-13T02:40:25Z","author_association":"CONTRIBUTOR","body":"adapt to sw64 platform","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/759165844/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/759248816","html_url":"https://github.com/apache/brpc/issues/1330#issuecomment-759248816","issue_url":"https://api.github.com/repos/apache/brpc/issues/1330","id":759248816,"node_id":"MDEyOklzc3VlQ29tbWVudDc1OTI0ODgxNg==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-13T06:58:57Z","updated_at":"2021-01-13T06:58:57Z","author_association":"CONTRIBUTOR","body":"减少race condition。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/759248816/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/759892215","html_url":"https://github.com/apache/brpc/issues/1118#issuecomment-759892215","issue_url":"https://api.github.com/repos/apache/brpc/issues/1118","id":759892215,"node_id":"MDEyOklzc3VlQ29tbWVudDc1OTg5MjIxNQ==","user":{"login":"guowei-bian","id":71699414,"node_id":"MDQ6VXNlcjcxNjk5NDE0","avatar_url":"https://avatars.githubusercontent.com/u/71699414?v=4","gravatar_id":"","url":"https://api.github.com/users/guowei-bian","html_url":"https://github.com/guowei-bian","followers_url":"https://api.github.com/users/guowei-bian/followers","following_url":"https://api.github.com/users/guowei-bian/following{/other_user}","gists_url":"https://api.github.com/users/guowei-bian/gists{/gist_id}","starred_url":"https://api.github.com/users/guowei-bian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guowei-bian/subscriptions","organizations_url":"https://api.github.com/users/guowei-bian/orgs","repos_url":"https://api.github.com/users/guowei-bian/repos","events_url":"https://api.github.com/users/guowei-bian/events{/privacy}","received_events_url":"https://api.github.com/users/guowei-bian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-14T02:56:38Z","updated_at":"2021-01-14T02:56:38Z","author_association":"NONE","body":"请教一下，遇到个情况，网卡挡down后，发消息还正常但超时，这种情况brpc是没有心跳检测吗？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/759892215/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/760224736","html_url":"https://github.com/apache/brpc/issues/1241#issuecomment-760224736","issue_url":"https://api.github.com/repos/apache/brpc/issues/1241","id":760224736,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDIyNDczNg==","user":{"login":"xiaopeifeng","id":7620721,"node_id":"MDQ6VXNlcjc2MjA3MjE=","avatar_url":"https://avatars.githubusercontent.com/u/7620721?v=4","gravatar_id":"","url":"https://api.github.com/users/xiaopeifeng","html_url":"https://github.com/xiaopeifeng","followers_url":"https://api.github.com/users/xiaopeifeng/followers","following_url":"https://api.github.com/users/xiaopeifeng/following{/other_user}","gists_url":"https://api.github.com/users/xiaopeifeng/gists{/gist_id}","starred_url":"https://api.github.com/users/xiaopeifeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiaopeifeng/subscriptions","organizations_url":"https://api.github.com/users/xiaopeifeng/orgs","repos_url":"https://api.github.com/users/xiaopeifeng/repos","events_url":"https://api.github.com/users/xiaopeifeng/events{/privacy}","received_events_url":"https://api.github.com/users/xiaopeifeng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-14T14:17:55Z","updated_at":"2021-01-14T14:17:55Z","author_association":"NONE","body":"@gydong 求拉社区交流群，fengxiaopei0324, 谢谢","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/760224736/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/760599407","html_url":"https://github.com/apache/brpc/issues/1118#issuecomment-760599407","issue_url":"https://api.github.com/repos/apache/brpc/issues/1118","id":760599407,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDU5OTQwNw==","user":{"login":"gydong","id":3294444,"node_id":"MDQ6VXNlcjMyOTQ0NDQ=","avatar_url":"https://avatars.githubusercontent.com/u/3294444?v=4","gravatar_id":"","url":"https://api.github.com/users/gydong","html_url":"https://github.com/gydong","followers_url":"https://api.github.com/users/gydong/followers","following_url":"https://api.github.com/users/gydong/following{/other_user}","gists_url":"https://api.github.com/users/gydong/gists{/gist_id}","starred_url":"https://api.github.com/users/gydong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gydong/subscriptions","organizations_url":"https://api.github.com/users/gydong/orgs","repos_url":"https://api.github.com/users/gydong/repos","events_url":"https://api.github.com/users/gydong/events{/privacy}","received_events_url":"https://api.github.com/users/gydong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-15T02:16:50Z","updated_at":"2021-01-15T02:17:20Z","author_association":"CONTRIBUTOR","body":"> 请教一下，遇到个情况，网卡挡down后，发消息还正常但超时，这种情况brpc是没有心跳检测吗？\r\n\r\n![image](https://user-images.githubusercontent.com/3294444/104672452-c45b0e00-571a-11eb-8c6a-5646ea07a5fc.png)\r\n\r\n这两个timeout，你分别设置成了多少？如果timeout_ms比connect_timeout_ms短的话，可能会出现你遇到的问题\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/760599407/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/760666248","html_url":"https://github.com/apache/brpc/issues/1118#issuecomment-760666248","issue_url":"https://api.github.com/repos/apache/brpc/issues/1118","id":760666248,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDY2NjI0OA==","user":{"login":"guowei-bian","id":71699414,"node_id":"MDQ6VXNlcjcxNjk5NDE0","avatar_url":"https://avatars.githubusercontent.com/u/71699414?v=4","gravatar_id":"","url":"https://api.github.com/users/guowei-bian","html_url":"https://github.com/guowei-bian","followers_url":"https://api.github.com/users/guowei-bian/followers","following_url":"https://api.github.com/users/guowei-bian/following{/other_user}","gists_url":"https://api.github.com/users/guowei-bian/gists{/gist_id}","starred_url":"https://api.github.com/users/guowei-bian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guowei-bian/subscriptions","organizations_url":"https://api.github.com/users/guowei-bian/orgs","repos_url":"https://api.github.com/users/guowei-bian/repos","events_url":"https://api.github.com/users/guowei-bian/events{/privacy}","received_events_url":"https://api.github.com/users/guowei-bian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-15T06:00:39Z","updated_at":"2021-01-15T06:00:39Z","author_association":"NONE","body":"> 这两个timeout，你分别设置成了多少？如果timeout_ms比connect_timeout_ms短的话，可能会出现你遇到的问题\r\n\r\n超时时间60s，连接超时为缺省值。验证很多次，发现网卡down掉后，消息还能发送但60s后报超时。如果能提前探测到连接断了，让消息返错就好了。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/760666248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/763384306","html_url":"https://github.com/apache/brpc/issues/1331#issuecomment-763384306","issue_url":"https://api.github.com/repos/apache/brpc/issues/1331","id":763384306,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzM4NDMwNg==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T06:59:14Z","updated_at":"2021-01-20T06:59:14Z","author_association":"CONTRIBUTOR","body":"不能，brpc server不允许线程数小于4。你这种情况要用[execution queue](https://github.com/apache/incubator-brpc/blob/master/docs/cn/execution_queue.md)","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/763384306/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/763385977","html_url":"https://github.com/apache/brpc/issues/1333#issuecomment-763385977","issue_url":"https://api.github.com/repos/apache/brpc/issues/1333","id":763385977,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzM4NTk3Nw==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T07:03:00Z","updated_at":"2021-01-20T07:03:00Z","author_association":"CONTRIBUTOR","body":"The file descriptor for epoll (epfd) was probably closed somewhere","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/763385977/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/763391446","html_url":"https://github.com/apache/brpc/issues/1331#issuecomment-763391446","issue_url":"https://api.github.com/repos/apache/brpc/issues/1331","id":763391446,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzM5MTQ0Ng==","user":{"login":"cfreebuf","id":22336250,"node_id":"MDQ6VXNlcjIyMzM2MjUw","avatar_url":"https://avatars.githubusercontent.com/u/22336250?v=4","gravatar_id":"","url":"https://api.github.com/users/cfreebuf","html_url":"https://github.com/cfreebuf","followers_url":"https://api.github.com/users/cfreebuf/followers","following_url":"https://api.github.com/users/cfreebuf/following{/other_user}","gists_url":"https://api.github.com/users/cfreebuf/gists{/gist_id}","starred_url":"https://api.github.com/users/cfreebuf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cfreebuf/subscriptions","organizations_url":"https://api.github.com/users/cfreebuf/orgs","repos_url":"https://api.github.com/users/cfreebuf/repos","events_url":"https://api.github.com/users/cfreebuf/events{/privacy}","received_events_url":"https://api.github.com/users/cfreebuf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T07:14:19Z","updated_at":"2021-01-20T07:14:19Z","author_association":"NONE","body":"收到，我了解一下ExecutionQueue，Thanks!","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/763391446/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/763478627","html_url":"https://github.com/apache/brpc/issues/1333#issuecomment-763478627","issue_url":"https://api.github.com/repos/apache/brpc/issues/1333","id":763478627,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzQ3ODYyNw==","user":{"login":"hustnn","id":73186,"node_id":"MDQ6VXNlcjczMTg2","avatar_url":"https://avatars.githubusercontent.com/u/73186?v=4","gravatar_id":"","url":"https://api.github.com/users/hustnn","html_url":"https://github.com/hustnn","followers_url":"https://api.github.com/users/hustnn/followers","following_url":"https://api.github.com/users/hustnn/following{/other_user}","gists_url":"https://api.github.com/users/hustnn/gists{/gist_id}","starred_url":"https://api.github.com/users/hustnn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hustnn/subscriptions","organizations_url":"https://api.github.com/users/hustnn/orgs","repos_url":"https://api.github.com/users/hustnn/repos","events_url":"https://api.github.com/users/hustnn/events{/privacy}","received_events_url":"https://api.github.com/users/hustnn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T09:46:46Z","updated_at":"2021-01-20T09:46:46Z","author_association":"NONE","body":"@jamesge Thanks. Do you have any suggestion on how to debug the root cause? like finding out the place closes this fd.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/763478627/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/765184779","html_url":"https://github.com/apache/brpc/issues/1072#issuecomment-765184779","issue_url":"https://api.github.com/repos/apache/brpc/issues/1072","id":765184779,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTE4NDc3OQ==","user":{"login":"leo07046219","id":3337353,"node_id":"MDQ6VXNlcjMzMzczNTM=","avatar_url":"https://avatars.githubusercontent.com/u/3337353?v=4","gravatar_id":"","url":"https://api.github.com/users/leo07046219","html_url":"https://github.com/leo07046219","followers_url":"https://api.github.com/users/leo07046219/followers","following_url":"https://api.github.com/users/leo07046219/following{/other_user}","gists_url":"https://api.github.com/users/leo07046219/gists{/gist_id}","starred_url":"https://api.github.com/users/leo07046219/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leo07046219/subscriptions","organizations_url":"https://api.github.com/users/leo07046219/orgs","repos_url":"https://api.github.com/users/leo07046219/repos","events_url":"https://api.github.com/users/leo07046219/events{/privacy}","received_events_url":"https://api.github.com/users/leo07046219/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T07:08:46Z","updated_at":"2021-01-22T07:08:46Z","author_association":"NONE","body":"32bit arm的，能用么？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/765184779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/765189803","html_url":"https://github.com/apache/brpc/issues/1111#issuecomment-765189803","issue_url":"https://api.github.com/repos/apache/brpc/issues/1111","id":765189803,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTE4OTgwMw==","user":{"login":"leo07046219","id":3337353,"node_id":"MDQ6VXNlcjMzMzczNTM=","avatar_url":"https://avatars.githubusercontent.com/u/3337353?v=4","gravatar_id":"","url":"https://api.github.com/users/leo07046219","html_url":"https://github.com/leo07046219","followers_url":"https://api.github.com/users/leo07046219/followers","following_url":"https://api.github.com/users/leo07046219/following{/other_user}","gists_url":"https://api.github.com/users/leo07046219/gists{/gist_id}","starred_url":"https://api.github.com/users/leo07046219/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leo07046219/subscriptions","organizations_url":"https://api.github.com/users/leo07046219/orgs","repos_url":"https://api.github.com/users/leo07046219/repos","events_url":"https://api.github.com/users/leo07046219/events{/privacy}","received_events_url":"https://api.github.com/users/leo07046219/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T07:18:04Z","updated_at":"2021-01-22T07:18:04Z","author_association":"NONE","body":"> brpc不支持32位系统\r\n1.有支持计划么？\r\n2.如果自己去支持，是否具备可行性，成本多高？\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/765189803/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/765239686","html_url":"https://github.com/apache/brpc/issues/1335#issuecomment-765239686","issue_url":"https://api.github.com/repos/apache/brpc/issues/1335","id":765239686,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTIzOTY4Ng==","user":{"login":"pluswu","id":1171583,"node_id":"MDQ6VXNlcjExNzE1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/1171583?v=4","gravatar_id":"","url":"https://api.github.com/users/pluswu","html_url":"https://github.com/pluswu","followers_url":"https://api.github.com/users/pluswu/followers","following_url":"https://api.github.com/users/pluswu/following{/other_user}","gists_url":"https://api.github.com/users/pluswu/gists{/gist_id}","starred_url":"https://api.github.com/users/pluswu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pluswu/subscriptions","organizations_url":"https://api.github.com/users/pluswu/orgs","repos_url":"https://api.github.com/users/pluswu/repos","events_url":"https://api.github.com/users/pluswu/events{/privacy}","received_events_url":"https://api.github.com/users/pluswu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T08:42:08Z","updated_at":"2021-01-22T08:42:08Z","author_association":"NONE","body":"另外一个线程此时正在处理bvar的http输出\r\n\r\n0  0x00007efc5ad4a42d in __lll_lock_wait () from /lib64/libpthread.so.0\r\n#1  0x00007efc5ad45de6 in _L_lock_870 () from /lib64/libpthread.so.0\r\n#2  0x00007efc5ad45cdf in pthread_mutex_lock () from /lib64/libpthread.so.0\r\n#3  0x00007efc59b155d7 in unique_lock (mutex=..., this=<synthetic pointer>) at /data/home/pluswu/incubator-brpc/src/butil/scoped_lock.h:218\r\n#4  bvar::Variable::list_exposed (names=names@entry=0x7efc412ea540, display_filter=bvar::DISPLAY_ON_PLAIN_TEXT) at /data/home/pluswu/incubator-brpc/src/bvar/variable.cpp:212\r\n#5  0x00007efc59b16cc2 in bvar::Variable::dump_exposed (dumper=dumper@entry=0x7efc412ea930, poptions=poptions@entry=0x0) at /data/home/pluswu/incubator-brpc/src/bvar/variable.cpp:507\r\n#6  0x00007efc59b96201 in brpc::DumpPrometheusMetricsToIOBuf (output=output@entry=0x7efc28025710) at /data/home/pluswu/incubator-brpc/src/brpc/builtin/prometheus_metrics_service.cpp:198\r\n#7  0x00007efc59b964b9 in brpc::PrometheusMetricsService::default_method (this=<optimized out>, cntl_base=0x7efc28025540, done=0x7efc28025890) at /data/home/pluswu/incubator-brpc/src/brpc/builtin/prometheus_metrics_service.cpp:189\r\n#8  0x00007efc59cc047e in brpc::brpc_metrics::CallMethod (this=0x9f8d120, method=<optimized out>, controller=0x7efc28025540, request=0x7efc28025850, response=0x7efc28025870, done=0x7efc28025890) at /data/home/pluswu/incubator-brpc/brpc/builtin_service.pb.cc:8506\r\n#9  0x00007efc59c16b0f in brpc::policy::ProcessHttpRequest (msg=<optimized out>) at /data/home/pluswu/incubator-brpc/src/brpc/policy/http_rpc_protocol.cpp:1484\r\n#10 0x00007efc59bdbe6a in brpc::ProcessInputMessage (void_arg=void_arg@entry=0x7efc28024620) at /data/home/pluswu/incubator-brpc/src/brpc/input_messenger.cpp:135\r\n#11 0x00007efc59bdcb83 in operator() (this=<optimized out>, last_msg=0x7efc28024620) at /data/home/pluswu/incubator-brpc/src/brpc/input_messenger.cpp:141\r\n#12 brpc::InputMessenger::OnNewMessages (m=0x7efc48028890) at /usr/include/c++/4.8.2/bits/unique_ptr.h:184\r\n#13 0x00007efc59c8b1bd in brpc::Socket::ProcessEvent (arg=0x7efc48028890) at /data/home/pluswu/incubator-brpc/src/brpc/socket.cpp:1017\r\n#14 0x00007efc59b3764a in bthread::TaskGroup::task_runner (skip_remained=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bthread/task_group.cpp:295\r\n#15 0x00007efc59b20991 in bthread_make_fcontext () from /data/home/user00/server/lib/libbrpc.so\r\n#16 0x0000000000000000 in ?? ()","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/765239686/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/765240938","html_url":"https://github.com/apache/brpc/issues/1335#issuecomment-765240938","issue_url":"https://api.github.com/repos/apache/brpc/issues/1335","id":765240938,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTI0MDkzOA==","user":{"login":"pluswu","id":1171583,"node_id":"MDQ6VXNlcjExNzE1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/1171583?v=4","gravatar_id":"","url":"https://api.github.com/users/pluswu","html_url":"https://github.com/pluswu","followers_url":"https://api.github.com/users/pluswu/followers","following_url":"https://api.github.com/users/pluswu/following{/other_user}","gists_url":"https://api.github.com/users/pluswu/gists{/gist_id}","starred_url":"https://api.github.com/users/pluswu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pluswu/subscriptions","organizations_url":"https://api.github.com/users/pluswu/orgs","repos_url":"https://api.github.com/users/pluswu/repos","events_url":"https://api.github.com/users/pluswu/events{/privacy}","received_events_url":"https://api.github.com/users/pluswu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T08:44:09Z","updated_at":"2021-01-22T08:44:09Z","author_association":"NONE","body":"这是所有线程的堆栈\r\n\r\nthread 12 (Thread 0x7efc55e6b700 (LWP 8717)):\r\n#0  0x00007efc578271bd in nanosleep () from /lib64/libc.so.6\r\n#1  0x00007efc57857ed4 in usleep () from /lib64/libc.so.6\r\n#2  0x00007efc59b05c9a in bvar::detail::SamplerCollector::run (this=0x9db32f0) at /data/home/pluswu/incubator-brpc/src/bvar/detail/sampler.cpp:177\r\n#3  0x00007efc59b067d9 in bvar::detail::SamplerCollector::sampling_thread (arg=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bvar/detail/sampler.cpp:110\r\n#4  0x00007efc5ad43e25 in start_thread () from /lib64/libpthread.so.0\r\n#5  0x00007efc5786035d in clone () from /lib64/libc.so.6\r\nThread 11 (Thread 0x7efc4d925700 (LWP 8728)):\r\n#0  0x00007efc5785a809 in syscall () from /lib64/libc.so.6\r\n#1  0x00007efc59b3c608 in futex_wait_private (timeout=<optimized out>, expected=21951, addr1=0x9f764d0) at /data/home/pluswu/incubator-brpc/src/bthread/sys_futex.h:41\r\n#2  bthread::TimerThread::run (this=0x9f764a0) at /data/home/pluswu/incubator-brpc/src/bthread/timer_thread.cpp:431\r\n#3  0x00007efc59b3cb19 in bthread::TimerThread::run_this (arg=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bthread/timer_thread.cpp:120\r\n#4  0x00007efc5ad43e25 in start_thread () from /lib64/libpthread.so.0\r\n#5  0x00007efc5786035d in clone () from /lib64/libc.so.6\r\nThread 10 (Thread 0x7efc4d124700 (LWP 8729)):\r\n#0  0x00007efc5785a809 in syscall () from /lib64/libc.so.6\r\n#1  0x00007efc59b35802 in futex_wait_private (timeout=0x0, expected=<optimized out>, addr1=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bthread/sys_futex.h:41\r\n#2  wait (expected_state=..., this=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bthread/parking_lot.h:60\r\n#3  bthread::TaskGroup::wait_task (this=this@entry=0x7efc480008c0, tid=tid@entry=0x7efc4d123a68) at /data/home/pluswu/incubator-brpc/src/bthread/task_group.cpp:124\r\n#4  0x00007efc59b378bb in bthread::TaskGroup::run_main_task (this=this@entry=0x7efc480008c0) at /data/home/pluswu/incubator-brpc/src/bthread/task_group.cpp:152\r\n#5  0x00007efc59b3360e in bthread::TaskControl::worker_thread (arg=0x9f70f20) at /data/home/pluswu/incubator-brpc/src/bthread/task_control.cpp:76\r\n#6  0x00007efc5ad43e25 in start_thread () from /lib64/libpthread.so.0\r\n#7  0x00007efc5786035d in clone () from /lib64/libc.so.6\r\nThread 9 (Thread 0x7efc4c923700 (LWP 8730)):\r\n#0  0x00007efc5ad4a42d in __lll_lock_wait () from /lib64/libpthread.so.0\r\n#1  0x00007efc5ad45dcb in _L_lock_812 () from /lib64/libpthread.so.0\r\n#2  0x00007efc5ad45c98 in pthread_mutex_lock () from /lib64/libpthread.so.0\r\n#3  0x00007efc59afaf79 in lock (this=<optimized out>) at /data/home/pluswu/incubator-brpc/src/butil/synchronization/lock.h:69\r\n#4  lock_guard (__m=..., this=<synthetic pointer>) at /usr/include/c++/4.8.2/mutex:414\r\n#5  get_value (result=<synthetic pointer>, window_size=10, this=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bvar/detail/sampler.h:149\r\n#6  get_span (this=<optimized out>, result=<synthetic pointer>, window_size=10) at /data/home/pluswu/incubator-brpc/src/bvar/window.h:96\r\n#7  bvar::PerSecond<bvar::PassiveStatus<unsigned long> >::get_value (this=<optimized out>, window_size=10) at /data/home/pluswu/incubator-brpc/src/bvar/window.h:225\r\n#8  0x00007efc59af71e6 in get_value (this=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bvar/window.h:111\r\n#9  bvar::detail::WindowBase<bvar::PassiveStatus<unsigned long>, (bvar::SeriesFrequency)1>::describe (this=<optimized out>, os=..., quote_string=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bvar/window.h:117\r\n#10 0x00007efc59b14d35 in bvar::Variable::describe_exposed (name=\"process_faults_minor_second\", os=..., quote_string=<optimized out>, display_filter=bvar::DISPLAY_ON_PLAIN_TEXT) at /data/home/pluswu/incubator-brpc/src/bvar/variable.cpp:257\r\n#11 0x00007efc59b17cdd in bvar::Variable::dump_exposed (dumper=dumper@entry=0x7efc23fff930, poptions=poptions@entry=0x0) at /data/home/pluswu/incubator-brpc/src/bvar/variable.cpp:515\r\n#12 0x00007efc59b96201 in brpc::DumpPrometheusMetricsToIOBuf (output=output@entry=0x7efc3c022a20) at /data/home/pluswu/incubator-brpc/src/brpc/builtin/prometheus_metrics_service.cpp:198\r\n#13 0x00007efc59b964b9 in brpc::PrometheusMetricsService::default_method (this=<optimized out>, cntl_base=0x7efc3c022850, done=0x7efc3c022ba0) at /data/home/pluswu/incubator-brpc/src/brpc/builtin/prometheus_metrics_service.cpp:189\r\n#14 0x00007efc59cc047e in brpc::brpc_metrics::CallMethod (this=0x9f8d120, method=<optimized out>, controller=0x7efc3c022850, request=0x7efc3c022b60, response=0x7efc3c022b80, done=0x7efc3c022ba0) at /data/home/pluswu/incubator-brpc/brpc/builtin_service.pb.cc:8506\r\n#15 0x00007efc59c16b0f in brpc::policy::ProcessHttpRequest (msg=<optimized out>) at /data/home/pluswu/incubator-brpc/src/brpc/policy/http_rpc_protocol.cpp:1484\r\n#16 0x00007efc59bdbe6a in brpc::ProcessInputMessage (void_arg=void_arg@entry=0x7efc3c022180) at /data/home/pluswu/incubator-brpc/src/brpc/input_messenger.cpp:135\r\n#17 0x00007efc59bdcb83 in operator() (this=<optimized out>, last_msg=0x7efc3c022180) at /data/home/pluswu/incubator-brpc/src/brpc/input_messenger.cpp:141\r\n#18 brpc::InputMessenger::OnNewMessages (m=0x7efc48028690) at /usr/include/c++/4.8.2/bits/unique_ptr.h:184\r\n#19 0x00007efc59c8b1bd in brpc::Socket::ProcessEvent (arg=0x7efc48028690) at /data/home/pluswu/incubator-brpc/src/brpc/socket.cpp:1017\r\n#20 0x00007efc59b3764a in bthread::TaskGroup::task_runner (skip_remained=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bthread/task_group.cpp:295\r\n#21 0x00007efc59b20991 in bthread_make_fcontext () from /data/home/user00/server/lib/libbrpc.so\r\n#22 0x00007efc24000020 in ?? ()\r\n#23 0x0000000000000000 in ?? ()\r\nThread 8 (Thread 0x7efc44122700 (LWP 8731)):\r\n#0  0x00007efc5785a809 in syscall () from /lib64/libc.so.6\r\n#1  0x00007efc59b35802 in futex_wait_private (timeout=0x0, expected=<optimized out>, addr1=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bthread/sys_futex.h:41\r\n#2  wait (expected_state=..., this=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bthread/parking_lot.h:60\r\n#3  bthread::TaskGroup::wait_task (this=this@entry=0x7efc340008c0, tid=tid@entry=0x7efc44121a68) at /data/home/pluswu/incubator-brpc/src/bthread/task_group.cpp:124\r\n#4  0x00007efc59b378bb in bthread::TaskGroup::run_main_task (this=this@entry=0x7efc340008c0) at /data/home/pluswu/incubator-brpc/src/bthread/task_group.cpp:152\r\n#5  0x00007efc59b3360e in bthread::TaskControl::worker_thread (arg=0x9f70f20) at /data/home/pluswu/incubator-brpc/src/bthread/task_control.cpp:76\r\n#6  0x00007efc5ad43e25 in start_thread () from /lib64/libpthread.so.0\r\n#7  0x00007efc5786035d in clone () from /lib64/libc.so.6\r\nThread 7 (Thread 0x7efc47fff700 (LWP 8732)):\r\n#0  0x00007efc5785a809 in syscall () from /lib64/libc.so.6\r\n#1  0x00007efc59b35802 in futex_wait_private (timeout=0x0, expected=<optimized out>, addr1=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bthread/sys_futex.h:41\r\n#2  wait (expected_state=..., this=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bthread/parking_lot.h:60\r\n#3  bthread::TaskGroup::wait_task (this=this@entry=0x7efc380008c0, tid=tid@entry=0x7efc47ffea68) at /data/home/pluswu/incubator-brpc/src/bthread/task_group.cpp:124\r\n#4  0x00007efc59b378bb in bthread::TaskGroup::run_main_task (this=this@entry=0x7efc380008c0) at /data/home/pluswu/incubator-brpc/src/bthread/task_group.cpp:152\r\n#5  0x00007efc59b3360e in bthread::TaskControl::worker_thread (arg=0x9f70f20) at /data/home/pluswu/incubator-brpc/src/bthread/task_control.cpp:76\r\n#6  0x00007efc5ad43e25 in start_thread () from /lib64/libpthread.so.0\r\n#7  0x00007efc5786035d in clone () from /lib64/libc.so.6\r\nThread 6 (Thread 0x7efc477fe700 (LWP 8733)):\r\n#0  0x00007efc5785a809 in syscall () from /lib64/libc.so.6\r\n#1  0x00007efc59b35802 in futex_wait_private (timeout=0x0, expected=<optimized out>, addr1=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bthread/sys_futex.h:41\r\n#2  wait (expected_state=..., this=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bthread/parking_lot.h:60\r\n#3  bthread::TaskGroup::wait_task (this=this@entry=0x7efc2c0008c0, tid=tid@entry=0x7efc477fda68) at /data/home/pluswu/incubator-brpc/src/bthread/task_group.cpp:124\r\n#4  0x00007efc59b378bb in bthread::TaskGroup::run_main_task (this=this@entry=0x7efc2c0008c0) at /data/home/pluswu/incubator-brpc/src/bthread/task_group.cpp:152\r\n#5  0x00007efc59b3360e in bthread::TaskControl::worker_thread (arg=0x9f70f20) at /data/home/pluswu/incubator-brpc/src/bthread/task_control.cpp:76\r\n#6  0x00007efc5ad43e25 in start_thread () from /lib64/libpthread.so.0\r\n#7  0x00007efc5786035d in clone () from /lib64/libc.so.6\r\nThread 5 (Thread 0x7efc46ffd700 (LWP 8734)):\r\n#0  0x00007efc5ad4a42d in __lll_lock_wait () from /lib64/libpthread.so.0\r\n#1  0x00007efc5ad45de6 in _L_lock_870 () from /lib64/libpthread.so.0\r\n#2  0x00007efc5ad45cdf in pthread_mutex_lock () from /lib64/libpthread.so.0\r\n#3  0x00007efc59b155d7 in unique_lock (mutex=..., this=<synthetic pointer>) at /data/home/pluswu/incubator-brpc/src/butil/scoped_lock.h:218\r\n#4  bvar::Variable::list_exposed (names=names@entry=0x7efc2235e540, display_filter=bvar::DISPLAY_ON_PLAIN_TEXT) at /data/home/pluswu/incubator-brpc/src/bvar/variable.cpp:212\r\n#5  0x00007efc59b16cc2 in bvar::Variable::dump_exposed (dumper=dumper@entry=0x7efc2235e930, poptions=poptions@entry=0x0) at /data/home/pluswu/incubator-brpc/src/bvar/variable.cpp:507\r\n#6  0x00007efc59b96201 in brpc::DumpPrometheusMetricsToIOBuf (output=output@entry=0x7efc300222b0) at /data/home/pluswu/incubator-brpc/src/brpc/builtin/prometheus_metrics_service.cpp:198\r\n#7  0x00007efc59b964b9 in brpc::PrometheusMetricsService::default_method (this=<optimized out>, cntl_base=0x7efc300220e0, done=0x7efc30022430) at /data/home/pluswu/incubator-brpc/src/brpc/builtin/prometheus_metrics_service.cpp:189\r\n#8  0x00007efc59cc047e in brpc::brpc_metrics::CallMethod (this=0x9f8d120, method=<optimized out>, controller=0x7efc300220e0, request=0x7efc300223f0, response=0x7efc30022410, done=0x7efc30022430) at /data/home/pluswu/incubator-brpc/brpc/builtin_service.pb.cc:8506\r\n#9  0x00007efc59c16b0f in brpc::policy::ProcessHttpRequest (msg=<optimized out>) at /data/home/pluswu/incubator-brpc/src/brpc/policy/http_rpc_protocol.cpp:1484\r\n#10 0x00007efc59bdbe6a in brpc::ProcessInputMessage (void_arg=void_arg@entry=0x7efc300211c0) at /data/home/pluswu/incubator-brpc/src/brpc/input_messenger.cpp:135\r\n#11 0x00007efc59bdcb83 in operator() (this=<optimized out>, last_msg=0x7efc300211c0) at /data/home/pluswu/incubator-brpc/src/brpc/input_messenger.cpp:141\r\n#12 brpc::InputMessenger::OnNewMessages (m=0x7efc2c01f600) at /usr/include/c++/4.8.2/bits/unique_ptr.h:184\r\n#13 0x00007efc59c8b1bd in brpc::Socket::ProcessEvent (arg=0x7efc2c01f600) at /data/home/pluswu/incubator-brpc/src/brpc/socket.cpp:1017\r\n#14 0x00007efc59b3764a in bthread::TaskGroup::task_runner (skip_remained=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bthread/task_group.cpp:295\r\n#15 0x00007efc59b20991 in bthread_make_fcontext () from /data/home/user00/server/lib/libbrpc.so\r\n#16 0x0000000000000000 in ?? ()\r\nThread 4 (Thread 0x7efc467fc700 (LWP 8735)):\r\n#0  0x00007efc5785a809 in syscall () from /lib64/libc.so.6\r\n#1  0x00007efc59b35802 in futex_wait_private (timeout=0x0, expected=<optimized out>, addr1=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bthread/sys_futex.h:41\r\n#2  wait (expected_state=..., this=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bthread/parking_lot.h:60\r\n#3  bthread::TaskGroup::wait_task (this=this@entry=0x7efc240008c0, tid=tid@entry=0x7efc467fba68) at /data/home/pluswu/incubator-brpc/src/bthread/task_group.cpp:124\r\n#4  0x00007efc59b378bb in bthread::TaskGroup::run_main_task (this=this@entry=0x7efc240008c0) at /data/home/pluswu/incubator-brpc/src/bthread/task_group.cpp:152\r\n#5  0x00007efc59b3360e in bthread::TaskControl::worker_thread (arg=0x9f70f20) at /data/home/pluswu/incubator-brpc/src/bthread/task_control.cpp:76\r\n#6  0x00007efc5ad43e25 in start_thread () from /lib64/libpthread.so.0\r\n#7  0x00007efc5786035d in clone () from /lib64/libc.so.6\r\nThread 3 (Thread 0x7efc45ffb700 (LWP 8736)):\r\n#0  0x00007efc5ad4a42d in __lll_lock_wait () from /lib64/libpthread.so.0\r\n#1  0x00007efc5ad45de6 in _L_lock_870 () from /lib64/libpthread.so.0\r\n#2  0x00007efc5ad45cdf in pthread_mutex_lock () from /lib64/libpthread.so.0\r\n#3  0x00007efc59b155d7 in unique_lock (mutex=..., this=<synthetic pointer>) at /data/home/pluswu/incubator-brpc/src/butil/scoped_lock.h:218\r\n#4  bvar::Variable::list_exposed (names=names@entry=0x7efc412ea540, display_filter=bvar::DISPLAY_ON_PLAIN_TEXT) at /data/home/pluswu/incubator-brpc/src/bvar/variable.cpp:212\r\n#5  0x00007efc59b16cc2 in bvar::Variable::dump_exposed (dumper=dumper@entry=0x7efc412ea930, poptions=poptions@entry=0x0) at /data/home/pluswu/incubator-brpc/src/bvar/variable.cpp:507\r\n#6  0x00007efc59b96201 in brpc::DumpPrometheusMetricsToIOBuf (output=output@entry=0x7efc28025710) at /data/home/pluswu/incubator-brpc/src/brpc/builtin/prometheus_metrics_service.cpp:198\r\n#7  0x00007efc59b964b9 in brpc::PrometheusMetricsService::default_method (this=<optimized out>, cntl_base=0x7efc28025540, done=0x7efc28025890) at /data/home/pluswu/incubator-brpc/src/brpc/builtin/prometheus_metrics_service.cpp:189\r\n#8  0x00007efc59cc047e in brpc::brpc_metrics::CallMethod (this=0x9f8d120, method=<optimized out>, controller=0x7efc28025540, request=0x7efc28025850, response=0x7efc28025870, done=0x7efc28025890) at /data/home/pluswu/incubator-brpc/brpc/builtin_service.pb.cc:8506\r\n#9  0x00007efc59c16b0f in brpc::policy::ProcessHttpRequest (msg=<optimized out>) at /data/home/pluswu/incubator-brpc/src/brpc/policy/http_rpc_protocol.cpp:1484\r\n#10 0x00007efc59bdbe6a in brpc::ProcessInputMessage (void_arg=void_arg@entry=0x7efc28024620) at /data/home/pluswu/incubator-brpc/src/brpc/input_messenger.cpp:135\r\n#11 0x00007efc59bdcb83 in operator() (this=<optimized out>, last_msg=0x7efc28024620) at /data/home/pluswu/incubator-brpc/src/brpc/input_messenger.cpp:141\r\n#12 brpc::InputMessenger::OnNewMessages (m=0x7efc48028890) at /usr/include/c++/4.8.2/bits/unique_ptr.h:184\r\n#13 0x00007efc59c8b1bd in brpc::Socket::ProcessEvent (arg=0x7efc48028890) at /data/home/pluswu/incubator-brpc/src/brpc/socket.cpp:1017\r\n#14 0x00007efc59b3764a in bthread::TaskGroup::task_runner (skip_remained=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bthread/task_group.cpp:295\r\n#15 0x00007efc59b20991 in bthread_make_fcontext () from /data/home/user00/server/lib/libbrpc.so\r\n#16 0x0000000000000000 in ?? ()\r\nThread 2 (Thread 0x7efc457fa700 (LWP 8737)):\r\n#0  0x00007efc5785a809 in syscall () from /lib64/libc.so.6\r\n#1  0x00007efc59b35802 in futex_wait_private (timeout=0x0, expected=<optimized out>, addr1=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bthread/sys_futex.h:41\r\n#2  wait (expected_state=..., this=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bthread/parking_lot.h:60\r\n#3  bthread::TaskGroup::wait_task (this=this@entry=0x7efc1c0008c0, tid=tid@entry=0x7efc457f9a68) at /data/home/pluswu/incubator-brpc/src/bthread/task_group.cpp:124\r\n#4  0x00007efc59b378bb in bthread::TaskGroup::run_main_task (this=this@entry=0x7efc1c0008c0) at /data/home/pluswu/incubator-brpc/src/bthread/task_group.cpp:152\r\n#5  0x00007efc59b3360e in bthread::TaskControl::worker_thread (arg=0x9f70f20) at /data/home/pluswu/incubator-brpc/src/bthread/task_control.cpp:76\r\n#6  0x00007efc5ad43e25 in start_thread () from /lib64/libpthread.so.0\r\n#7  0x00007efc5786035d in clone () from /lib64/libc.so.6\r\nThread 1 (Thread 0x7efc5b04dac0 (LWP 8716)):\r\n#0  0x00007efc5ad4a42d in __lll_lock_wait () from /lib64/libpthread.so.0\r\n#1  0x00007efc5ad45de6 in _L_lock_870 () from /lib64/libpthread.so.0\r\n#2  0x00007efc5ad45cdf in pthread_mutex_lock () from /lib64/libpthread.so.0\r\n#3  0x00007efc59b14eed in lock_guard (mutex=..., this=<synthetic pointer>) at /data/home/pluswu/incubator-brpc/src/butil/scoped_lock.h:163\r\n#4  bvar::Variable::hide (this=this@entry=0x7efc5a1f7f00 <bvar::g_minflt_second>) at /data/home/pluswu/incubator-brpc/src/bvar/variable.cpp:189\r\n#5  0x00007efc59af899f in ~WindowBase (this=0x7efc5a1f7f00 <bvar::g_minflt_second>, __in_chrg=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bvar/window.h:88\r\n#6  bvar::PerSecond<bvar::PassiveStatus<unsigned long> >::~PerSecond (this=0x7efc5a1f7f00 <bvar::g_minflt_second>, __in_chrg=<optimized out>) at /data/home/pluswu/incubator-brpc/src/bvar/window.h:197\r\n#7  0x00007efc577a0dda in __cxa_finalize () from /lib64/libc.so.6\r\n#8  0x00007efc59aa3023 in __do_global_dtors_aux () from /data/home/user00/server/lib/libbrpc.so\r\n#9  0x00007ffd9f1a6660 in ?? ()\r\n#10 0x00007efc5af67b3a in _dl_fini () from /lib64/ld-linux-x86-64.so.2","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/765240938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/765956219","html_url":"https://github.com/apache/brpc/issues/1335#issuecomment-765956219","issue_url":"https://api.github.com/repos/apache/brpc/issues/1335","id":765956219,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTk1NjIxOQ==","user":{"login":"pluswu","id":1171583,"node_id":"MDQ6VXNlcjExNzE1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/1171583?v=4","gravatar_id":"","url":"https://api.github.com/users/pluswu","html_url":"https://github.com/pluswu","followers_url":"https://api.github.com/users/pluswu/followers","following_url":"https://api.github.com/users/pluswu/following{/other_user}","gists_url":"https://api.github.com/users/pluswu/gists{/gist_id}","starred_url":"https://api.github.com/users/pluswu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pluswu/subscriptions","organizations_url":"https://api.github.com/users/pluswu/orgs","repos_url":"https://api.github.com/users/pluswu/repos","events_url":"https://api.github.com/users/pluswu/events{/privacy}","received_events_url":"https://api.github.com/users/pluswu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-23T12:31:54Z","updated_at":"2021-01-23T12:31:54Z","author_association":"NONE","body":"看上去和这个类似 https://github.com/apache/incubator-brpc/issues/1085  我这边验证多次发现如果进程用nohup方式启动没有问题 如果用系统api实现daemon就会在导出bvar信息时 固定在下面这里死锁\r\n#3 0x00007efc59afaf79 in lock (this=) at /data/home/pluswu/incubator-brpc/src/butil/synchronization/lock.h:69\r\n#4 lock_guard (__m=..., this=) at /usr/include/c++/4.8.2/mutex:414\r\n#5 get_value (result=, window_size=10, this=) at /data/home/pluswu/incubator-brpc/src/bvar/detail/sampler.h:149\r\n#6 get_span (this=, result=, window_size=10) at /data/home/pluswu/incubator-brpc/src/bvar/window.h:96\r\n#7 bvar::PerSecond<bvar::PassiveStatus >::get_value (this=, window_size=10) at /data/home/pluswu/incubator-brpc/src/bvar/window.h:225\r\n#8 0x00007efc59af71e6 in get_value (this=) at /data/home/pluswu/incubator-brpc/src/bvar/window.h:111\r\n#9 bvar::detail::WindowBase<bvar::PassiveStatus, (bvar::SeriesFrequency)1>::describe (this=, os=..., quote_string=) at /data/home/pluswu/incubator-brpc/src/bvar/window.h:117\r\n#10 0x00007efc59b14d35 in bvar::Variable::describe_exposed (name=\"process_faults_minor_second\", os=..., quote_string=, display_filter=bvar::DISPLAY_ON_PLAIN_TEXT) at /data/home/pluswu/incubator-brpc/src/bvar/variable.cpp:257","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/765956219/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/767322555","html_url":"https://github.com/apache/brpc/issues/1335#issuecomment-767322555","issue_url":"https://api.github.com/repos/apache/brpc/issues/1335","id":767322555,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NzMyMjU1NQ==","user":{"login":"pluswu","id":1171583,"node_id":"MDQ6VXNlcjExNzE1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/1171583?v=4","gravatar_id":"","url":"https://api.github.com/users/pluswu","html_url":"https://github.com/pluswu","followers_url":"https://api.github.com/users/pluswu/followers","following_url":"https://api.github.com/users/pluswu/following{/other_user}","gists_url":"https://api.github.com/users/pluswu/gists{/gist_id}","starred_url":"https://api.github.com/users/pluswu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pluswu/subscriptions","organizations_url":"https://api.github.com/users/pluswu/orgs","repos_url":"https://api.github.com/users/pluswu/repos","events_url":"https://api.github.com/users/pluswu/events{/privacy}","received_events_url":"https://api.github.com/users/pluswu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-26T06:18:30Z","updated_at":"2021-01-26T06:18:30Z","author_association":"NONE","body":"最小可复现代码\r\n\r\n#include <gflags/gflags.h>\r\n#include <brpc/channel.h>\r\n#include <brpc/server.h>\r\n\r\n#include <sys/stat.h>\r\n#include <sys/types.h>\r\n#include <sys/utsname.h>\r\n#include \"linux/limits.h\"\r\n\r\n#include <signal.h>\r\nvoid make_daemon()\r\n{\r\n\tpid_t pid;\r\n\r\n\tpid = fork() ;\r\n\r\n\tif (pid != 0)\r\n\t\texit(0);\r\n\r\n\tsetsid();\r\n\r\n\tsignal(SIGINT,  SIG_IGN);\r\n\tsignal(SIGHUP,  SIG_IGN);\r\n\tsignal(SIGQUIT, SIG_IGN);\r\n\tsignal(SIGPIPE, SIG_IGN);\r\n\tsignal(SIGTTOU, SIG_IGN);\r\n\tsignal(SIGTTIN, SIG_IGN);\r\n\tsignal(SIGCHLD, SIG_IGN);\r\n\tsignal(SIGTERM, SIG_IGN);\r\n\tsignal(SIGHUP,  SIG_IGN);\r\n\r\n\tpid = fork() ;\r\n\r\n\tif (pid != 0)\r\n\t\texit(0);\r\n\r\n\tumask(0);\r\n}\r\n\r\nint main()\r\n{\r\n    make_daemon();\r\n    brpc::StartDummyServerAt(8080);\r\n    while (true)\r\n    {\r\n        sleep(1);\r\n    }\r\n    return 0;\r\n}","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/767322555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/767516245","html_url":"https://github.com/apache/brpc/issues/1338#issuecomment-767516245","issue_url":"https://api.github.com/repos/apache/brpc/issues/1338","id":767516245,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NzUxNjI0NQ==","user":{"login":"zgb40302","id":24806026,"node_id":"MDQ6VXNlcjI0ODA2MDI2","avatar_url":"https://avatars.githubusercontent.com/u/24806026?v=4","gravatar_id":"","url":"https://api.github.com/users/zgb40302","html_url":"https://github.com/zgb40302","followers_url":"https://api.github.com/users/zgb40302/followers","following_url":"https://api.github.com/users/zgb40302/following{/other_user}","gists_url":"https://api.github.com/users/zgb40302/gists{/gist_id}","starred_url":"https://api.github.com/users/zgb40302/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zgb40302/subscriptions","organizations_url":"https://api.github.com/users/zgb40302/orgs","repos_url":"https://api.github.com/users/zgb40302/repos","events_url":"https://api.github.com/users/zgb40302/events{/privacy}","received_events_url":"https://api.github.com/users/zgb40302/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-26T12:40:18Z","updated_at":"2021-01-26T12:40:18Z","author_association":"NONE","body":"\r\n\r\nexample 里面的echo++ 程序没有问题\r\n[root@localhost build]# ./echo_server --reuse_port=true &\r\n[1] 23377\r\n[root@localhost build]# I0126 20:37:08.738100 23377 /data0/data1/incubator-brpc/src/brpc/server.cpp:1045] Server[example::EchoServiceImpl] is serving on port=8000.\r\nI0126 20:37:08.738689 23377 /data0/data1/incubator-brpc/src/brpc/server.cpp:1048] Check out http://localhost.localdomain:8000 in web browser.\r\n\r\n[root@localhost build]# ./echo_server --reuse_port=true\r\nI0126 20:37:11.704532 23494 /data0/data1/incubator-brpc/src/brpc/server.cpp:1045] Server[example::EchoServiceImpl] is serving on port=8000.\r\nI0126 20:37:11.705123 23494 /data0/data1/incubator-brpc/src/brpc/server.cpp:1048] Check out http://localhost.localdomain:8000 in web browser.\r\n\r\n^CI0126 20:37:20.231765 23494 /data0/data1/incubator-brpc/src/brpc/server.cpp:1100] Server[example::EchoServiceImpl] is going to quit","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/767516245/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/767521791","html_url":"https://github.com/apache/brpc/issues/1338#issuecomment-767521791","issue_url":"https://api.github.com/repos/apache/brpc/issues/1338","id":767521791,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NzUyMTc5MQ==","user":{"login":"zgb40302","id":24806026,"node_id":"MDQ6VXNlcjI0ODA2MDI2","avatar_url":"https://avatars.githubusercontent.com/u/24806026?v=4","gravatar_id":"","url":"https://api.github.com/users/zgb40302","html_url":"https://github.com/zgb40302","followers_url":"https://api.github.com/users/zgb40302/followers","following_url":"https://api.github.com/users/zgb40302/following{/other_user}","gists_url":"https://api.github.com/users/zgb40302/gists{/gist_id}","starred_url":"https://api.github.com/users/zgb40302/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zgb40302/subscriptions","organizations_url":"https://api.github.com/users/zgb40302/orgs","repos_url":"https://api.github.com/users/zgb40302/repos","events_url":"https://api.github.com/users/zgb40302/events{/privacy}","received_events_url":"https://api.github.com/users/zgb40302/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-26T12:51:53Z","updated_at":"2021-01-26T12:51:53Z","author_association":"NONE","body":"main 函数里没有调用这个函数\r\ngoogle::ParseCommandLineFlags(&args, &argv, true);\r\n所以命令行里的reuse_port没有生效","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/767521791/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/768246895","html_url":"https://github.com/apache/brpc/issues/1335#issuecomment-768246895","issue_url":"https://api.github.com/repos/apache/brpc/issues/1335","id":768246895,"node_id":"MDEyOklzc3VlQ29tbWVudDc2ODI0Njg5NQ==","user":{"login":"pluswu","id":1171583,"node_id":"MDQ6VXNlcjExNzE1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/1171583?v=4","gravatar_id":"","url":"https://api.github.com/users/pluswu","html_url":"https://github.com/pluswu","followers_url":"https://api.github.com/users/pluswu/followers","following_url":"https://api.github.com/users/pluswu/following{/other_user}","gists_url":"https://api.github.com/users/pluswu/gists{/gist_id}","starred_url":"https://api.github.com/users/pluswu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pluswu/subscriptions","organizations_url":"https://api.github.com/users/pluswu/orgs","repos_url":"https://api.github.com/users/pluswu/repos","events_url":"https://api.github.com/users/pluswu/events{/privacy}","received_events_url":"https://api.github.com/users/pluswu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-27T12:16:41Z","updated_at":"2021-01-27T12:16:41Z","author_association":"NONE","body":"本质还是静态数据初始化 多线程与fork顺序不确定性导致的 暂时通过将默认bvar延迟到main函数之后初始化规避这个问题","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/768246895/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/770651224","html_url":"https://github.com/apache/brpc/issues/1339#issuecomment-770651224","issue_url":"https://api.github.com/repos/apache/brpc/issues/1339","id":770651224,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDY1MTIyNA==","user":{"login":"longdafeng","id":374091,"node_id":"MDQ6VXNlcjM3NDA5MQ==","avatar_url":"https://avatars.githubusercontent.com/u/374091?v=4","gravatar_id":"","url":"https://api.github.com/users/longdafeng","html_url":"https://github.com/longdafeng","followers_url":"https://api.github.com/users/longdafeng/followers","following_url":"https://api.github.com/users/longdafeng/following{/other_user}","gists_url":"https://api.github.com/users/longdafeng/gists{/gist_id}","starred_url":"https://api.github.com/users/longdafeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/longdafeng/subscriptions","organizations_url":"https://api.github.com/users/longdafeng/orgs","repos_url":"https://api.github.com/users/longdafeng/repos","events_url":"https://api.github.com/users/longdafeng/events{/privacy}","received_events_url":"https://api.github.com/users/longdafeng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T07:55:46Z","updated_at":"2021-02-01T07:55:46Z","author_association":"NONE","body":"看了源码 config_brpc.sh, 只能支持单目录的设置\r\n```\r\nfind_dir_of_lib() {\r\n    local lib=$(find ${LIBS_IN} -name \"lib${1}.a\" -o -name \"lib${1}.$SO\" 2>/dev/null | head -n1)\r\n    if [ ! -z \"$lib\" ]; then\r\n        dirname $lib\r\n    fi\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/770651224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/770668628","html_url":"https://github.com/apache/brpc/issues/1268#issuecomment-770668628","issue_url":"https://api.github.com/repos/apache/brpc/issues/1268","id":770668628,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDY2ODYyOA==","user":{"login":"tanzhongyi003","id":20179982,"node_id":"MDQ6VXNlcjIwMTc5OTgy","avatar_url":"https://avatars.githubusercontent.com/u/20179982?v=4","gravatar_id":"","url":"https://api.github.com/users/tanzhongyi003","html_url":"https://github.com/tanzhongyi003","followers_url":"https://api.github.com/users/tanzhongyi003/followers","following_url":"https://api.github.com/users/tanzhongyi003/following{/other_user}","gists_url":"https://api.github.com/users/tanzhongyi003/gists{/gist_id}","starred_url":"https://api.github.com/users/tanzhongyi003/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tanzhongyi003/subscriptions","organizations_url":"https://api.github.com/users/tanzhongyi003/orgs","repos_url":"https://api.github.com/users/tanzhongyi003/repos","events_url":"https://api.github.com/users/tanzhongyi003/events{/privacy}","received_events_url":"https://api.github.com/users/tanzhongyi003/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T08:24:32Z","updated_at":"2021-02-01T08:24:32Z","author_association":"MEMBER","body":"bazel 出4.0版本了，4.0是LTS版本，维护期两年。\r\n用4.0试试，\r\n如果build不过，看看啥原因","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/770668628/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/771288344","html_url":"https://github.com/apache/brpc/issues/1339#issuecomment-771288344","issue_url":"https://api.github.com/repos/apache/brpc/issues/1339","id":771288344,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTI4ODM0NA==","user":{"login":"serverglen","id":38067377,"node_id":"MDQ6VXNlcjM4MDY3Mzc3","avatar_url":"https://avatars.githubusercontent.com/u/38067377?v=4","gravatar_id":"","url":"https://api.github.com/users/serverglen","html_url":"https://github.com/serverglen","followers_url":"https://api.github.com/users/serverglen/followers","following_url":"https://api.github.com/users/serverglen/following{/other_user}","gists_url":"https://api.github.com/users/serverglen/gists{/gist_id}","starred_url":"https://api.github.com/users/serverglen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/serverglen/subscriptions","organizations_url":"https://api.github.com/users/serverglen/orgs","repos_url":"https://api.github.com/users/serverglen/repos","events_url":"https://api.github.com/users/serverglen/events{/privacy}","received_events_url":"https://api.github.com/users/serverglen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T01:52:53Z","updated_at":"2021-02-02T01:52:53Z","author_association":"CONTRIBUTOR","body":"有兴趣自己实现并贡献个PR嘛","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/771288344/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/771449962","html_url":"https://github.com/apache/brpc/issues/699#issuecomment-771449962","issue_url":"https://api.github.com/repos/apache/brpc/issues/699","id":771449962,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTQ0OTk2Mg==","user":{"login":"BADBOY-Aaron","id":8815260,"node_id":"MDQ6VXNlcjg4MTUyNjA=","avatar_url":"https://avatars.githubusercontent.com/u/8815260?v=4","gravatar_id":"","url":"https://api.github.com/users/BADBOY-Aaron","html_url":"https://github.com/BADBOY-Aaron","followers_url":"https://api.github.com/users/BADBOY-Aaron/followers","following_url":"https://api.github.com/users/BADBOY-Aaron/following{/other_user}","gists_url":"https://api.github.com/users/BADBOY-Aaron/gists{/gist_id}","starred_url":"https://api.github.com/users/BADBOY-Aaron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BADBOY-Aaron/subscriptions","organizations_url":"https://api.github.com/users/BADBOY-Aaron/orgs","repos_url":"https://api.github.com/users/BADBOY-Aaron/repos","events_url":"https://api.github.com/users/BADBOY-Aaron/events{/privacy}","received_events_url":"https://api.github.com/users/BADBOY-Aaron/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T08:08:40Z","updated_at":"2021-02-02T08:08:40Z","author_association":"NONE","body":"这个问题现在解决了吗？我也遇到了","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/771449962/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/772182688","html_url":"https://github.com/apache/brpc/issues/1340#issuecomment-772182688","issue_url":"https://api.github.com/repos/apache/brpc/issues/1340","id":772182688,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjE4MjY4OA==","user":{"login":"serverglen","id":38067377,"node_id":"MDQ6VXNlcjM4MDY3Mzc3","avatar_url":"https://avatars.githubusercontent.com/u/38067377?v=4","gravatar_id":"","url":"https://api.github.com/users/serverglen","html_url":"https://github.com/serverglen","followers_url":"https://api.github.com/users/serverglen/followers","following_url":"https://api.github.com/users/serverglen/following{/other_user}","gists_url":"https://api.github.com/users/serverglen/gists{/gist_id}","starred_url":"https://api.github.com/users/serverglen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/serverglen/subscriptions","organizations_url":"https://api.github.com/users/serverglen/orgs","repos_url":"https://api.github.com/users/serverglen/repos","events_url":"https://api.github.com/users/serverglen/events{/privacy}","received_events_url":"https://api.github.com/users/serverglen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T03:03:01Z","updated_at":"2021-02-03T03:09:00Z","author_association":"CONTRIBUTOR","body":"`\r\nstruct xxx {\r\n};\r\n`\r\n\r\n需要实现：\r\n1. 重载==运算符\r\n`\r\nbool operator==(const struct xxx& obj) const {\r\n    // TODO\r\n}\r\n`\r\n2. 实现自定义的hash函数\r\n`\r\ntemplate <>\r\nstruct butil::DefaultHasher <struct xxx> {\r\n    std::size_t operator() (const struct xxx& obj) {\r\n        // TODO\r\n    }\r\n};\r\n`","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/772182688/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/774629412","html_url":"https://github.com/apache/brpc/issues/582#issuecomment-774629412","issue_url":"https://api.github.com/repos/apache/brpc/issues/582","id":774629412,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDYyOTQxMg==","user":{"login":"xiangpdu","id":11640492,"node_id":"MDQ6VXNlcjExNjQwNDky","avatar_url":"https://avatars.githubusercontent.com/u/11640492?v=4","gravatar_id":"","url":"https://api.github.com/users/xiangpdu","html_url":"https://github.com/xiangpdu","followers_url":"https://api.github.com/users/xiangpdu/followers","following_url":"https://api.github.com/users/xiangpdu/following{/other_user}","gists_url":"https://api.github.com/users/xiangpdu/gists{/gist_id}","starred_url":"https://api.github.com/users/xiangpdu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiangpdu/subscriptions","organizations_url":"https://api.github.com/users/xiangpdu/orgs","repos_url":"https://api.github.com/users/xiangpdu/repos","events_url":"https://api.github.com/users/xiangpdu/events{/privacy}","received_events_url":"https://api.github.com/users/xiangpdu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-07T07:50:36Z","updated_at":"2021-02-07T07:50:36Z","author_association":"NONE","body":"请问这个问题后续怎么样了， 遇到相同的问题，请教一下最后是怎么解决的？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/774629412/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/775028227","html_url":"https://github.com/apache/brpc/pull/1341#issuecomment-775028227","issue_url":"https://api.github.com/repos/apache/brpc/issues/1341","id":775028227,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTAyODIyNw==","user":{"login":"hzchenjianfei","id":49896148,"node_id":"MDQ6VXNlcjQ5ODk2MTQ4","avatar_url":"https://avatars.githubusercontent.com/u/49896148?v=4","gravatar_id":"","url":"https://api.github.com/users/hzchenjianfei","html_url":"https://github.com/hzchenjianfei","followers_url":"https://api.github.com/users/hzchenjianfei/followers","following_url":"https://api.github.com/users/hzchenjianfei/following{/other_user}","gists_url":"https://api.github.com/users/hzchenjianfei/gists{/gist_id}","starred_url":"https://api.github.com/users/hzchenjianfei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hzchenjianfei/subscriptions","organizations_url":"https://api.github.com/users/hzchenjianfei/orgs","repos_url":"https://api.github.com/users/hzchenjianfei/repos","events_url":"https://api.github.com/users/hzchenjianfei/events{/privacy}","received_events_url":"https://api.github.com/users/hzchenjianfei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T10:06:33Z","updated_at":"2021-02-08T10:06:33Z","author_association":"NONE","body":"if n < 4,  no need compare \"PRPC\" with header_buf.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/775028227/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/775218037","html_url":"https://github.com/apache/brpc/issues/90#issuecomment-775218037","issue_url":"https://api.github.com/repos/apache/brpc/issues/90","id":775218037,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTIxODAzNw==","user":{"login":"Seafoodair","id":51044388,"node_id":"MDQ6VXNlcjUxMDQ0Mzg4","avatar_url":"https://avatars.githubusercontent.com/u/51044388?v=4","gravatar_id":"","url":"https://api.github.com/users/Seafoodair","html_url":"https://github.com/Seafoodair","followers_url":"https://api.github.com/users/Seafoodair/followers","following_url":"https://api.github.com/users/Seafoodair/following{/other_user}","gists_url":"https://api.github.com/users/Seafoodair/gists{/gist_id}","starred_url":"https://api.github.com/users/Seafoodair/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Seafoodair/subscriptions","organizations_url":"https://api.github.com/users/Seafoodair/orgs","repos_url":"https://api.github.com/users/Seafoodair/repos","events_url":"https://api.github.com/users/Seafoodair/events{/privacy}","received_events_url":"https://api.github.com/users/Seafoodair/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T15:13:08Z","updated_at":"2021-02-08T15:13:08Z","author_association":"NONE","body":"我安装了libgflags.so，且跟libgflags.a同一个目录。编译的时候还会出现关于生成protoc-gen-mcpack失败的问题 。新手，求指导。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/775218037/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/775254600","html_url":"https://github.com/apache/brpc/pull/1341#issuecomment-775254600","issue_url":"https://api.github.com/repos/apache/brpc/issues/1341","id":775254600,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTI1NDYwMA==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T16:07:06Z","updated_at":"2021-02-08T16:07:06Z","author_association":"CONTRIBUTOR","body":"这是在比较前缀，不相等就意味着可能是其他协议。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/775254600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/778239510","html_url":"https://github.com/apache/brpc/pull/1343#issuecomment-778239510","issue_url":"https://api.github.com/repos/apache/brpc/issues/1343","id":778239510,"node_id":"MDEyOklzc3VlQ29tbWVudDc3ODIzOTUxMA==","user":{"login":"wangpengcheng","id":37323208,"node_id":"MDQ6VXNlcjM3MzIzMjA4","avatar_url":"https://avatars.githubusercontent.com/u/37323208?v=4","gravatar_id":"","url":"https://api.github.com/users/wangpengcheng","html_url":"https://github.com/wangpengcheng","followers_url":"https://api.github.com/users/wangpengcheng/followers","following_url":"https://api.github.com/users/wangpengcheng/following{/other_user}","gists_url":"https://api.github.com/users/wangpengcheng/gists{/gist_id}","starred_url":"https://api.github.com/users/wangpengcheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangpengcheng/subscriptions","organizations_url":"https://api.github.com/users/wangpengcheng/orgs","repos_url":"https://api.github.com/users/wangpengcheng/repos","events_url":"https://api.github.com/users/wangpengcheng/events{/privacy}","received_events_url":"https://api.github.com/users/wangpengcheng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-12T14:49:05Z","updated_at":"2021-02-12T14:49:05Z","author_association":"NONE","body":"同步","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/778239510/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/782058713","html_url":"https://github.com/apache/brpc/issues/1344#issuecomment-782058713","issue_url":"https://api.github.com/repos/apache/brpc/issues/1344","id":782058713,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjA1ODcxMw==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T12:59:02Z","updated_at":"2021-02-19T12:59:02Z","author_association":"CONTRIBUTOR","body":"可以发个最小可复现的程序吗","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/782058713/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/782063652","html_url":"https://github.com/apache/brpc/issues/1339#issuecomment-782063652","issue_url":"https://api.github.com/repos/apache/brpc/issues/1339","id":782063652,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjA2MzY1Mg==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T13:08:36Z","updated_at":"2021-02-19T13:08:36Z","author_association":"CONTRIBUTOR","body":"@longdafeng 是支持多个目录的，sh config_brpc.sh --headers=\"dir1 dir2 dir3\" --libs=\"dir4 dir5 dir6\"这样就可以","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/782063652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/782064848","html_url":"https://github.com/apache/brpc/issues/1340#issuecomment-782064848","issue_url":"https://api.github.com/repos/apache/brpc/issues/1340","id":782064848,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjA2NDg0OA==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T13:11:04Z","updated_at":"2021-02-19T13:11:04Z","author_association":"CONTRIBUTOR","body":"@muween 可以贴个代码片段吗，以及编译器报的错误","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/782064848/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/782065363","html_url":"https://github.com/apache/brpc/issues/1337#issuecomment-782065363","issue_url":"https://api.github.com/repos/apache/brpc/issues/1337","id":782065363,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjA2NTM2Mw==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T13:12:06Z","updated_at":"2021-02-19T13:12:06Z","author_association":"CONTRIBUTOR","body":"好复现不，可以挂ASAN跑一下试试","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/782065363/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/782099931","html_url":"https://github.com/apache/brpc/issues/1334#issuecomment-782099931","issue_url":"https://api.github.com/repos/apache/brpc/issues/1334","id":782099931,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjA5OTkzMQ==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T14:12:24Z","updated_at":"2021-02-19T14:12:24Z","author_association":"CONTRIBUTOR","body":"Is server level max_concurrency can solve your problem? may be you can set ServerOptions.max_concurrency","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/782099931/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/782103644","html_url":"https://github.com/apache/brpc/issues/1322#issuecomment-782103644","issue_url":"https://api.github.com/repos/apache/brpc/issues/1322","id":782103644,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjEwMzY0NA==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T14:18:59Z","updated_at":"2021-02-19T14:18:59Z","author_association":"CONTRIBUTOR","body":"@serverglen 预计什么时候开源呀","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/782103644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/782582772","html_url":"https://github.com/apache/brpc/issues/207#issuecomment-782582772","issue_url":"https://api.github.com/repos/apache/brpc/issues/207","id":782582772,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjU4Mjc3Mg==","user":{"login":"fly3366","id":38378045,"node_id":"MDQ6VXNlcjM4Mzc4MDQ1","avatar_url":"https://avatars.githubusercontent.com/u/38378045?v=4","gravatar_id":"","url":"https://api.github.com/users/fly3366","html_url":"https://github.com/fly3366","followers_url":"https://api.github.com/users/fly3366/followers","following_url":"https://api.github.com/users/fly3366/following{/other_user}","gists_url":"https://api.github.com/users/fly3366/gists{/gist_id}","starred_url":"https://api.github.com/users/fly3366/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fly3366/subscriptions","organizations_url":"https://api.github.com/users/fly3366/orgs","repos_url":"https://api.github.com/users/fly3366/repos","events_url":"https://api.github.com/users/fly3366/events{/privacy}","received_events_url":"https://api.github.com/users/fly3366/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-20T08:00:43Z","updated_at":"2021-02-20T08:00:43Z","author_association":"NONE","body":"Can I pr unix domain support for endpoint?","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/782582772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/783833867","html_url":"https://github.com/apache/brpc/issues/1322#issuecomment-783833867","issue_url":"https://api.github.com/repos/apache/brpc/issues/1322","id":783833867,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzgzMzg2Nw==","user":{"login":"serverglen","id":38067377,"node_id":"MDQ6VXNlcjM4MDY3Mzc3","avatar_url":"https://avatars.githubusercontent.com/u/38067377?v=4","gravatar_id":"","url":"https://api.github.com/users/serverglen","html_url":"https://github.com/serverglen","followers_url":"https://api.github.com/users/serverglen/followers","following_url":"https://api.github.com/users/serverglen/following{/other_user}","gists_url":"https://api.github.com/users/serverglen/gists{/gist_id}","starred_url":"https://api.github.com/users/serverglen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/serverglen/subscriptions","organizations_url":"https://api.github.com/users/serverglen/orgs","repos_url":"https://api.github.com/users/serverglen/repos","events_url":"https://api.github.com/users/serverglen/events{/privacy}","received_events_url":"https://api.github.com/users/serverglen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T02:26:51Z","updated_at":"2021-02-23T02:26:51Z","author_association":"CONTRIBUTOR","body":"> @serverglen 预计什么时候开源呀\r\n\r\n预计6月份之前","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/783833867/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/784467017","html_url":"https://github.com/apache/brpc/issues/1194#issuecomment-784467017","issue_url":"https://api.github.com/repos/apache/brpc/issues/1194","id":784467017,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDQ2NzAxNw==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T19:50:46Z","updated_at":"2021-02-23T19:50:46Z","author_association":"MEMBER","body":"测试结果：\r\n\r\n* 正确设置FLAMEGRAPH_PL_PATH后，火焰图效果：\r\n![image](https://user-images.githubusercontent.com/4475779/108899037-3a0aa180-7618-11eb-8544-d88287a5b032.png)\r\n\r\n* 没有设置FLAMEGRAPH_PL_PATH效果：\r\n![image](https://user-images.githubusercontent.com/4475779/108899245-80f89700-7618-11eb-9f9d-34377aa8fe04.png)\r\n\r\n* 设置错误的FLAMEGRAPH_PL_PATH效果：\r\n![image](https://user-images.githubusercontent.com/4475779/108899395-a685a080-7618-11eb-9d22-a7852c731c60.png)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/784467017/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/785075969","html_url":"https://github.com/apache/brpc/issues/101#issuecomment-785075969","issue_url":"https://api.github.com/repos/apache/brpc/issues/101","id":785075969,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTA3NTk2OQ==","user":{"login":"kfstorm","id":3626358,"node_id":"MDQ6VXNlcjM2MjYzNTg=","avatar_url":"https://avatars.githubusercontent.com/u/3626358?v=4","gravatar_id":"","url":"https://api.github.com/users/kfstorm","html_url":"https://github.com/kfstorm","followers_url":"https://api.github.com/users/kfstorm/followers","following_url":"https://api.github.com/users/kfstorm/following{/other_user}","gists_url":"https://api.github.com/users/kfstorm/gists{/gist_id}","starred_url":"https://api.github.com/users/kfstorm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kfstorm/subscriptions","organizations_url":"https://api.github.com/users/kfstorm/orgs","repos_url":"https://api.github.com/users/kfstorm/repos","events_url":"https://api.github.com/users/kfstorm/events{/privacy}","received_events_url":"https://api.github.com/users/kfstorm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T13:29:27Z","updated_at":"2021-02-24T13:29:27Z","author_association":"NONE","body":"What if I linked glog but I don't want to use glog?","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/785075969/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/785592191","html_url":"https://github.com/apache/brpc/issues/1106#issuecomment-785592191","issue_url":"https://api.github.com/repos/apache/brpc/issues/1106","id":785592191,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTU5MjE5MQ==","user":{"login":"kfstorm","id":3626358,"node_id":"MDQ6VXNlcjM2MjYzNTg=","avatar_url":"https://avatars.githubusercontent.com/u/3626358?v=4","gravatar_id":"","url":"https://api.github.com/users/kfstorm","html_url":"https://github.com/kfstorm","followers_url":"https://api.github.com/users/kfstorm/followers","following_url":"https://api.github.com/users/kfstorm/following{/other_user}","gists_url":"https://api.github.com/users/kfstorm/gists{/gist_id}","starred_url":"https://api.github.com/users/kfstorm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kfstorm/subscriptions","organizations_url":"https://api.github.com/users/kfstorm/orgs","repos_url":"https://api.github.com/users/kfstorm/repos","events_url":"https://api.github.com/users/kfstorm/events{/privacy}","received_events_url":"https://api.github.com/users/kfstorm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T04:20:39Z","updated_at":"2021-02-25T04:20:39Z","author_association":"NONE","body":"Any updates on this issue? We've been suffering from this.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/785592191/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/785790001","html_url":"https://github.com/apache/brpc/issues/1106#issuecomment-785790001","issue_url":"https://api.github.com/repos/apache/brpc/issues/1106","id":785790001,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTc5MDAwMQ==","user":{"login":"wrongtest-intellif","id":7600935,"node_id":"MDQ6VXNlcjc2MDA5MzU=","avatar_url":"https://avatars.githubusercontent.com/u/7600935?v=4","gravatar_id":"","url":"https://api.github.com/users/wrongtest-intellif","html_url":"https://github.com/wrongtest-intellif","followers_url":"https://api.github.com/users/wrongtest-intellif/followers","following_url":"https://api.github.com/users/wrongtest-intellif/following{/other_user}","gists_url":"https://api.github.com/users/wrongtest-intellif/gists{/gist_id}","starred_url":"https://api.github.com/users/wrongtest-intellif/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wrongtest-intellif/subscriptions","organizations_url":"https://api.github.com/users/wrongtest-intellif/orgs","repos_url":"https://api.github.com/users/wrongtest-intellif/repos","events_url":"https://api.github.com/users/wrongtest-intellif/events{/privacy}","received_events_url":"https://api.github.com/users/wrongtest-intellif/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T10:28:33Z","updated_at":"2021-02-25T10:28:33Z","author_association":"NONE","body":"Currently we recompile brpc with the sscanf code modified to skip this error message.\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/785790001/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/785834481","html_url":"https://github.com/apache/brpc/issues/1106#issuecomment-785834481","issue_url":"https://api.github.com/repos/apache/brpc/issues/1106","id":785834481,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTgzNDQ4MQ==","user":{"login":"kfstorm","id":3626358,"node_id":"MDQ6VXNlcjM2MjYzNTg=","avatar_url":"https://avatars.githubusercontent.com/u/3626358?v=4","gravatar_id":"","url":"https://api.github.com/users/kfstorm","html_url":"https://github.com/kfstorm","followers_url":"https://api.github.com/users/kfstorm/followers","following_url":"https://api.github.com/users/kfstorm/following{/other_user}","gists_url":"https://api.github.com/users/kfstorm/gists{/gist_id}","starred_url":"https://api.github.com/users/kfstorm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kfstorm/subscriptions","organizations_url":"https://api.github.com/users/kfstorm/orgs","repos_url":"https://api.github.com/users/kfstorm/repos","events_url":"https://api.github.com/users/kfstorm/events{/privacy}","received_events_url":"https://api.github.com/users/kfstorm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T11:42:34Z","updated_at":"2021-02-25T11:42:34Z","author_association":"NONE","body":"@wrongtest Thanks. Since it's a bug of brpc, I think it's better to get fixed property.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/785834481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/786995184","html_url":"https://github.com/apache/brpc/issues/1346#issuecomment-786995184","issue_url":"https://api.github.com/repos/apache/brpc/issues/1346","id":786995184,"node_id":"MDEyOklzc3VlQ29tbWVudDc4Njk5NTE4NA==","user":{"login":"lifeiyang","id":3754939,"node_id":"MDQ6VXNlcjM3NTQ5Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/3754939?v=4","gravatar_id":"","url":"https://api.github.com/users/lifeiyang","html_url":"https://github.com/lifeiyang","followers_url":"https://api.github.com/users/lifeiyang/followers","following_url":"https://api.github.com/users/lifeiyang/following{/other_user}","gists_url":"https://api.github.com/users/lifeiyang/gists{/gist_id}","starred_url":"https://api.github.com/users/lifeiyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lifeiyang/subscriptions","organizations_url":"https://api.github.com/users/lifeiyang/orgs","repos_url":"https://api.github.com/users/lifeiyang/repos","events_url":"https://api.github.com/users/lifeiyang/events{/privacy}","received_events_url":"https://api.github.com/users/lifeiyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-27T03:21:36Z","updated_at":"2021-02-27T03:21:36Z","author_association":"NONE","body":"> **Describe the bug (描述bug)**\r\n> brpc 作为client 访问grpc server 第一次请求包大小大概50KB左右，能够正常返回，第二次发送同样大小的包，则会返回错误， 出现 Err=[E2004]remote_window_left is not enough ， 我看之前有个关于remote_window_left is not enough的bug fix #849 是关于首次发送大包请求的问题，我目前用的brpc版本是0.9.7，已经包含了这个fix， 而且首次发送几MB的大包都没问题，但是第二次发送同样的包就会出现这个错误，麻烦各位大佬，指出问题所在，谢谢\r\n> **To Reproduce (复现方法)**\r\n> brpc作为client第一次访问grpc server的包大小为50KB左右，第二次同样的请求会出现Err=[E2004]remote_window_left is not enough\r\n> \r\n> **Expected behavior (期望行为)**\r\n> 每次client端发送的大包请求都能够被正确处理\r\n> \r\n> **Versions (各种版本)**\r\n> OS: centos 7.3\r\n> Compiler: gcc 7.3\r\n> brpc: 0.9.7\r\n> protobuf: protobuf 2.6\r\n> \r\n> **Additional context/screenshots (更多上下文/截图)**\r\n\r\n@jamesge 麻烦作者关注一下问题，看看到底是使用问题还是框架本身的问题，谢谢","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/786995184/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/786998114","html_url":"https://github.com/apache/brpc/issues/1346#issuecomment-786998114","issue_url":"https://api.github.com/repos/apache/brpc/issues/1346","id":786998114,"node_id":"MDEyOklzc3VlQ29tbWVudDc4Njk5ODExNA==","user":{"login":"lifeiyang","id":3754939,"node_id":"MDQ6VXNlcjM3NTQ5Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/3754939?v=4","gravatar_id":"","url":"https://api.github.com/users/lifeiyang","html_url":"https://github.com/lifeiyang","followers_url":"https://api.github.com/users/lifeiyang/followers","following_url":"https://api.github.com/users/lifeiyang/following{/other_user}","gists_url":"https://api.github.com/users/lifeiyang/gists{/gist_id}","starred_url":"https://api.github.com/users/lifeiyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lifeiyang/subscriptions","organizations_url":"https://api.github.com/users/lifeiyang/orgs","repos_url":"https://api.github.com/users/lifeiyang/repos","events_url":"https://api.github.com/users/lifeiyang/events{/privacy}","received_events_url":"https://api.github.com/users/lifeiyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-27T03:47:06Z","updated_at":"2021-02-27T03:47:06Z","author_association":"NONE","body":"> **Describe the bug (描述bug)**\r\n> brpc 作为client 访问grpc server 第一次请求包大小大概50KB左右，能够正常返回，第二次发送同样大小的包，则会返回错误， 出现 Err=[E2004]remote_window_left is not enough ， 我看之前有个关于remote_window_left is not enough的bug fix #849 是关于首次发送大包请求的问题，我目前用的brpc版本是0.9.7，已经包含了这个fix， 而且首次发送几MB的大包都没问题，但是第二次发送同样的包就会出现这个错误，麻烦各位大佬，指出问题所在，谢谢\r\n> **To Reproduce (复现方法)**\r\n> brpc作为client第一次访问grpc server的包大小为50KB左右，第二次同样的请求会出现Err=[E2004]remote_window_left is not enough\r\n> \r\n> **Expected behavior (期望行为)**\r\n> 每次client端发送的大包请求都能够被正确处理\r\n> \r\n> **Versions (各种版本)**\r\n> OS: centos 7.3\r\n> Compiler: gcc 7.3\r\n> brpc: 0.9.7\r\n> protobuf: protobuf 2.6\r\n> \r\n> **Additional context/screenshots (更多上下文/截图)**\r\n\r\n@zyearn  麻烦大佬帮忙看看","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/786998114/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/787038785","html_url":"https://github.com/apache/brpc/issues/1346#issuecomment-787038785","issue_url":"https://api.github.com/repos/apache/brpc/issues/1346","id":787038785,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NzAzODc4NQ==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-27T08:50:51Z","updated_at":"2021-02-27T08:50:51Z","author_association":"MEMBER","body":"尝试一下把brpc client的window_size调大，具体是这两个参数\r\n* https://github.com/apache/incubator-brpc/blob/master/src/brpc/policy/http2_rpc_protocol.cpp#L37\r\n* https://github.com/apache/incubator-brpc/blob/master/src/brpc/policy/http2_rpc_protocol.cpp#L39","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/787038785/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/787066076","html_url":"https://github.com/apache/brpc/issues/1346#issuecomment-787066076","issue_url":"https://api.github.com/repos/apache/brpc/issues/1346","id":787066076,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NzA2NjA3Ng==","user":{"login":"lifeiyang","id":3754939,"node_id":"MDQ6VXNlcjM3NTQ5Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/3754939?v=4","gravatar_id":"","url":"https://api.github.com/users/lifeiyang","html_url":"https://github.com/lifeiyang","followers_url":"https://api.github.com/users/lifeiyang/followers","following_url":"https://api.github.com/users/lifeiyang/following{/other_user}","gists_url":"https://api.github.com/users/lifeiyang/gists{/gist_id}","starred_url":"https://api.github.com/users/lifeiyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lifeiyang/subscriptions","organizations_url":"https://api.github.com/users/lifeiyang/orgs","repos_url":"https://api.github.com/users/lifeiyang/repos","events_url":"https://api.github.com/users/lifeiyang/events{/privacy}","received_events_url":"https://api.github.com/users/lifeiyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-27T12:33:42Z","updated_at":"2021-02-27T13:16:25Z","author_association":"NONE","body":"> 尝试一下把brpc client的window_size调大，具体是这两个参数\r\n> \r\n> * https://github.com/apache/incubator-brpc/blob/master/src/brpc/policy/http2_rpc_protocol.cpp#L37\r\n> * https://github.com/apache/incubator-brpc/blob/master/src/brpc/policy/http2_rpc_protocol.cpp#L39\r\n@zyearn \r\n参数调整如下：\r\n![image](https://user-images.githubusercontent.com/3754939/109387182-d4c9ef80-793a-11eb-940d-7a0429e69497.png)\r\n\r\n但是调大之后，依然没有效果，错误信息还是如下：\r\nErr=[E2004]remote_window_left is not enough, data_size=51208\r\n\r\n\r\n\r\n通过brpc的 ip:port/sockets/agent_server_id 查看的信息如下：\r\n红色标注框上面为remote_setting, 下面为local_setting\r\n![image](https://user-images.githubusercontent.com/3754939/109387691-dea12200-793d-11eb-9469-c37b0a2f7318.png)\r\n\r\n\r\n是不是grpc server 返回的http2 交互信息中没有更新stream_window_size 导致本地remote_window_size 没法增加\r\n![image](https://user-images.githubusercontent.com/3754939/109388265-0776e680-7941-11eb-8757-59d02b8ab57c.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/787066076/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/787316149","html_url":"https://github.com/apache/brpc/issues/1346#issuecomment-787316149","issue_url":"https://api.github.com/repos/apache/brpc/issues/1346","id":787316149,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NzMxNjE0OQ==","user":{"login":"lifeiyang","id":3754939,"node_id":"MDQ6VXNlcjM3NTQ5Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/3754939?v=4","gravatar_id":"","url":"https://api.github.com/users/lifeiyang","html_url":"https://github.com/lifeiyang","followers_url":"https://api.github.com/users/lifeiyang/followers","following_url":"https://api.github.com/users/lifeiyang/following{/other_user}","gists_url":"https://api.github.com/users/lifeiyang/gists{/gist_id}","starred_url":"https://api.github.com/users/lifeiyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lifeiyang/subscriptions","organizations_url":"https://api.github.com/users/lifeiyang/orgs","repos_url":"https://api.github.com/users/lifeiyang/repos","events_url":"https://api.github.com/users/lifeiyang/events{/privacy}","received_events_url":"https://api.github.com/users/lifeiyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-28T03:58:16Z","updated_at":"2021-02-28T03:58:16Z","author_association":"NONE","body":"还有什么需要修改的点吗？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/787316149/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/787417985","html_url":"https://github.com/apache/brpc/issues/1346#issuecomment-787417985","issue_url":"https://api.github.com/repos/apache/brpc/issues/1346","id":787417985,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NzQxNzk4NQ==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-28T08:45:35Z","updated_at":"2021-02-28T08:46:50Z","author_association":"MEMBER","body":"找一下grpc server的h2 window_size的配置，然后把这个值调大就可以了。你的场景应该是client向grpc server发大包，默认情况下server端这个窗口是很小的（64K），需要手动调大。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/787417985/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/788605487","html_url":"https://github.com/apache/brpc/issues/1346#issuecomment-788605487","issue_url":"https://api.github.com/repos/apache/brpc/issues/1346","id":788605487,"node_id":"MDEyOklzc3VlQ29tbWVudDc4ODYwNTQ4Nw==","user":{"login":"lifeiyang","id":3754939,"node_id":"MDQ6VXNlcjM3NTQ5Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/3754939?v=4","gravatar_id":"","url":"https://api.github.com/users/lifeiyang","html_url":"https://github.com/lifeiyang","followers_url":"https://api.github.com/users/lifeiyang/followers","following_url":"https://api.github.com/users/lifeiyang/following{/other_user}","gists_url":"https://api.github.com/users/lifeiyang/gists{/gist_id}","starred_url":"https://api.github.com/users/lifeiyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lifeiyang/subscriptions","organizations_url":"https://api.github.com/users/lifeiyang/orgs","repos_url":"https://api.github.com/users/lifeiyang/repos","events_url":"https://api.github.com/users/lifeiyang/events{/privacy}","received_events_url":"https://api.github.com/users/lifeiyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-02T05:24:57Z","updated_at":"2021-03-02T05:24:57Z","author_association":"NONE","body":"> 找一下grpc server的h2 window_size的配置，然后把这个值调大就可以了。你的场景应该是client向grpc server发大包，默认情况下server端这个窗口是很小的（64K），需要手动调大。\r\ngrpc server 端把stream_window_size 调大也没有效果，还是没发多次发送大包（超过50KB）， brpc client这边的流控看着是connection 级别的 remote_window_left限制的原因，个人理解，每个http2连接开始时应该先接收到服务端的setting确定接收方的流控窗口大小，settting 初始化remote_window_left 如下代码所示：\r\n![image](https://user-images.githubusercontent.com/3754939/109601722-55b30200-7b5a-11eb-9bf2-befbd9c316c9.png)\r\n图中所标注的代码行，为什么不直接写成如下：\r\n_remote_window_left.store(H2Settings::DEFAULT_INITIAL_WINDOW_SIZE, butil::memory_order_relaxed);\r\n@zyearn 麻烦大佬解惑，谢谢\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/788605487/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/789167328","html_url":"https://github.com/apache/brpc/issues/1346#issuecomment-789167328","issue_url":"https://api.github.com/repos/apache/brpc/issues/1346","id":789167328,"node_id":"MDEyOklzc3VlQ29tbWVudDc4OTE2NzMyOA==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-02T19:46:36Z","updated_at":"2021-03-02T19:46:36Z","author_association":"MEMBER","body":"是因为_remote_window_left的初始值是MAX_WINDOW_SIZE，这个fetch_sub是把初始值恢复到DEFAULT_INITIAL_WINDOW_SIZE。\r\n\r\n改完grpc server的配置后再看看你之前贴图里面的H2Context { remote_setting =...} 有没有生效，否则再检查一下有没有正确设置，用grpc-go的话，需要设置两个变量。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/789167328/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/789352171","html_url":"https://github.com/apache/brpc/issues/1348#issuecomment-789352171","issue_url":"https://api.github.com/repos/apache/brpc/issues/1348","id":789352171,"node_id":"MDEyOklzc3VlQ29tbWVudDc4OTM1MjE3MQ==","user":{"login":"cstarc","id":11407488,"node_id":"MDQ6VXNlcjExNDA3NDg4","avatar_url":"https://avatars.githubusercontent.com/u/11407488?v=4","gravatar_id":"","url":"https://api.github.com/users/cstarc","html_url":"https://github.com/cstarc","followers_url":"https://api.github.com/users/cstarc/followers","following_url":"https://api.github.com/users/cstarc/following{/other_user}","gists_url":"https://api.github.com/users/cstarc/gists{/gist_id}","starred_url":"https://api.github.com/users/cstarc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cstarc/subscriptions","organizations_url":"https://api.github.com/users/cstarc/orgs","repos_url":"https://api.github.com/users/cstarc/repos","events_url":"https://api.github.com/users/cstarc/events{/privacy}","received_events_url":"https://api.github.com/users/cstarc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-03T01:23:49Z","updated_at":"2021-03-03T01:23:49Z","author_association":"CONTRIBUTOR","body":"PackRpcRequest\r\n  \r\n   const size_t req_size = request_body.length(); \r\n    **const size_t attached_size** = cntl->request_attachment().length();\r\n    if (attached_size) {\r\n        **meta.set_attachment_size(attached_size);**\r\n    }\r\n    Span* span = accessor.span();\r\n    if (span) {\r\n        request_meta->set_trace_id(span->trace_id());\r\n        request_meta->set_span_id(span->span_id());\r\n        request_meta->set_parent_span_id(span->parent_span_id());\r\n    }\r\n\r\n    SerializeRpcHeaderAndMeta(req_buf, meta, req_size + attached_size);\r\n    req_buf->append(request_body);\r\n    **if (attached_size) {\r\n        req_buf->append(cntl->request_attachment());**\r\n    }\r\n\r\n大小不一致","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/789352171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/789476555","html_url":"https://github.com/apache/brpc/issues/1334#issuecomment-789476555","issue_url":"https://api.github.com/repos/apache/brpc/issues/1334","id":789476555,"node_id":"MDEyOklzc3VlQ29tbWVudDc4OTQ3NjU1NQ==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-03T06:36:55Z","updated_at":"2021-03-03T06:36:55Z","author_association":"CONTRIBUTOR","body":"Auto concurrency can not work well in our services too. \r\nWe deveplop a new auto concurrency policy which is based on bthread congestion control in run queue. \r\nIt works well in our system. We will commit a pr recently.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/789476555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/789618396","html_url":"https://github.com/apache/brpc/issues/1346#issuecomment-789618396","issue_url":"https://api.github.com/repos/apache/brpc/issues/1346","id":789618396,"node_id":"MDEyOklzc3VlQ29tbWVudDc4OTYxODM5Ng==","user":{"login":"lifeiyang","id":3754939,"node_id":"MDQ6VXNlcjM3NTQ5Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/3754939?v=4","gravatar_id":"","url":"https://api.github.com/users/lifeiyang","html_url":"https://github.com/lifeiyang","followers_url":"https://api.github.com/users/lifeiyang/followers","following_url":"https://api.github.com/users/lifeiyang/following{/other_user}","gists_url":"https://api.github.com/users/lifeiyang/gists{/gist_id}","starred_url":"https://api.github.com/users/lifeiyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lifeiyang/subscriptions","organizations_url":"https://api.github.com/users/lifeiyang/orgs","repos_url":"https://api.github.com/users/lifeiyang/repos","events_url":"https://api.github.com/users/lifeiyang/events{/privacy}","received_events_url":"https://api.github.com/users/lifeiyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-03T10:43:21Z","updated_at":"2021-03-03T10:46:50Z","author_association":"NONE","body":"> 是因为_remote_window_left的初始值是MAX_WINDOW_SIZE，这个fetch_sub是把初始值恢复到DEFAULT_INITIAL_WINDOW_SIZE。\r\n> \r\n> 改完grpc server的配置后再看看你之前贴图里面的H2Context { remote_setting =...} 有没有生效，否则再检查一下有没有正确设置，用grpc-go的话，需要设置两个变量。\r\n\r\nserver端使用的是grpc-c, 那边通过常量修改stream_window_size为1GB，观察已经生效，但是brpc client端的 remote_window_left值，还是只有几十KB, 如下图所示：\r\n![image](https://user-images.githubusercontent.com/3754939/109794193-93925200-7c50-11eb-8258-37e6285cf9e6.png)\r\n\r\n下一步调整哪些参数或者逻辑能让remote_window_left继续增大以便于发送大数据量的包呢？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/789618396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/789634911","html_url":"https://github.com/apache/brpc/issues/764#issuecomment-789634911","issue_url":"https://api.github.com/repos/apache/brpc/issues/764","id":789634911,"node_id":"MDEyOklzc3VlQ29tbWVudDc4OTYzNDkxMQ==","user":{"login":"shanghx","id":31763956,"node_id":"MDQ6VXNlcjMxNzYzOTU2","avatar_url":"https://avatars.githubusercontent.com/u/31763956?v=4","gravatar_id":"","url":"https://api.github.com/users/shanghx","html_url":"https://github.com/shanghx","followers_url":"https://api.github.com/users/shanghx/followers","following_url":"https://api.github.com/users/shanghx/following{/other_user}","gists_url":"https://api.github.com/users/shanghx/gists{/gist_id}","starred_url":"https://api.github.com/users/shanghx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shanghx/subscriptions","organizations_url":"https://api.github.com/users/shanghx/orgs","repos_url":"https://api.github.com/users/shanghx/repos","events_url":"https://api.github.com/users/shanghx/events{/privacy}","received_events_url":"https://api.github.com/users/shanghx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-03T11:10:05Z","updated_at":"2021-03-03T11:10:05Z","author_association":"NONE","body":"这个修复后考虑合入master嘛？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/789634911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/790006745","html_url":"https://github.com/apache/brpc/issues/1346#issuecomment-790006745","issue_url":"https://api.github.com/repos/apache/brpc/issues/1346","id":790006745,"node_id":"MDEyOklzc3VlQ29tbWVudDc5MDAwNjc0NQ==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-03T19:44:47Z","updated_at":"2021-03-03T19:44:47Z","author_association":"MEMBER","body":"因为server端没有设置connection层面的window_size，在brpc里对应的是H2Settings:: connection_window_size，你要找找grpc-c对应设置的地方。设置完后，h2初始化的时候server会向client发一个H2_FRAME_WINDOW_UPDATE包，可以抓包看看有没有。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/790006745/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/791180912","html_url":"https://github.com/apache/brpc/issues/1346#issuecomment-791180912","issue_url":"https://api.github.com/repos/apache/brpc/issues/1346","id":791180912,"node_id":"MDEyOklzc3VlQ29tbWVudDc5MTE4MDkxMg==","user":{"login":"lifeiyang","id":3754939,"node_id":"MDQ6VXNlcjM3NTQ5Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/3754939?v=4","gravatar_id":"","url":"https://api.github.com/users/lifeiyang","html_url":"https://github.com/lifeiyang","followers_url":"https://api.github.com/users/lifeiyang/followers","following_url":"https://api.github.com/users/lifeiyang/following{/other_user}","gists_url":"https://api.github.com/users/lifeiyang/gists{/gist_id}","starred_url":"https://api.github.com/users/lifeiyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lifeiyang/subscriptions","organizations_url":"https://api.github.com/users/lifeiyang/orgs","repos_url":"https://api.github.com/users/lifeiyang/repos","events_url":"https://api.github.com/users/lifeiyang/events{/privacy}","received_events_url":"https://api.github.com/users/lifeiyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-05T06:07:06Z","updated_at":"2021-03-05T06:11:58Z","author_association":"NONE","body":"grpc-c 里面没有提供对外的接口和配置能够手动修改h2 的connection_window_size, 它是通过BDP（bandwith delay production）来自动调节流控窗口的（包括stream_window_size和conn_window_size），我们通过比对发现grpc服务端启动的时候通过配置项: builder.AddChannelArgument(GRPC_ARG_HTTP2_BDP_PROBE, 0);  关闭了BDP;  这样server端就没法根据客户端发送的数据包大小，自动调节流控窗口大小，最终导致brpc 客户端无法持续发送大的数据包, 也就是说brpc client 和grpc server 端都保持默认的流控策略是没有任何问题的，感谢@zyearn的问题分析。\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/791180912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/792313617","html_url":"https://github.com/apache/brpc/issues/1173#issuecomment-792313617","issue_url":"https://api.github.com/repos/apache/brpc/issues/1173","id":792313617,"node_id":"MDEyOklzc3VlQ29tbWVudDc5MjMxMzYxNw==","user":{"login":"lorinlee","id":16054841,"node_id":"MDQ6VXNlcjE2MDU0ODQx","avatar_url":"https://avatars.githubusercontent.com/u/16054841?v=4","gravatar_id":"","url":"https://api.github.com/users/lorinlee","html_url":"https://github.com/lorinlee","followers_url":"https://api.github.com/users/lorinlee/followers","following_url":"https://api.github.com/users/lorinlee/following{/other_user}","gists_url":"https://api.github.com/users/lorinlee/gists{/gist_id}","starred_url":"https://api.github.com/users/lorinlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lorinlee/subscriptions","organizations_url":"https://api.github.com/users/lorinlee/orgs","repos_url":"https://api.github.com/users/lorinlee/repos","events_url":"https://api.github.com/users/lorinlee/events{/privacy}","received_events_url":"https://api.github.com/users/lorinlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-07T17:17:31Z","updated_at":"2021-03-07T17:17:31Z","author_association":"CONTRIBUTOR","body":"@JianyuLi @zhongleihe 请问问题解决了吗","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/792313617/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/792626960","html_url":"https://github.com/apache/brpc/issues/1351#issuecomment-792626960","issue_url":"https://api.github.com/repos/apache/brpc/issues/1351","id":792626960,"node_id":"MDEyOklzc3VlQ29tbWVudDc5MjYyNjk2MA==","user":{"login":"bystorm","id":15179542,"node_id":"MDQ6VXNlcjE1MTc5NTQy","avatar_url":"https://avatars.githubusercontent.com/u/15179542?v=4","gravatar_id":"","url":"https://api.github.com/users/bystorm","html_url":"https://github.com/bystorm","followers_url":"https://api.github.com/users/bystorm/followers","following_url":"https://api.github.com/users/bystorm/following{/other_user}","gists_url":"https://api.github.com/users/bystorm/gists{/gist_id}","starred_url":"https://api.github.com/users/bystorm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bystorm/subscriptions","organizations_url":"https://api.github.com/users/bystorm/orgs","repos_url":"https://api.github.com/users/bystorm/repos","events_url":"https://api.github.com/users/bystorm/events{/privacy}","received_events_url":"https://api.github.com/users/bystorm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-08T09:44:42Z","updated_at":"2021-03-08T09:44:42Z","author_association":"NONE","body":"看错了。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/792626960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/794781512","html_url":"https://github.com/apache/brpc/issues/1023#issuecomment-794781512","issue_url":"https://api.github.com/repos/apache/brpc/issues/1023","id":794781512,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDc4MTUxMg==","user":{"login":"cloudhan","id":1279292,"node_id":"MDQ6VXNlcjEyNzkyOTI=","avatar_url":"https://avatars.githubusercontent.com/u/1279292?v=4","gravatar_id":"","url":"https://api.github.com/users/cloudhan","html_url":"https://github.com/cloudhan","followers_url":"https://api.github.com/users/cloudhan/followers","following_url":"https://api.github.com/users/cloudhan/following{/other_user}","gists_url":"https://api.github.com/users/cloudhan/gists{/gist_id}","starred_url":"https://api.github.com/users/cloudhan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cloudhan/subscriptions","organizations_url":"https://api.github.com/users/cloudhan/orgs","repos_url":"https://api.github.com/users/cloudhan/repos","events_url":"https://api.github.com/users/cloudhan/events{/privacy}","received_events_url":"https://api.github.com/users/cloudhan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T02:54:40Z","updated_at":"2021-03-10T02:54:40Z","author_association":"NONE","body":"Since #1032 is merged, I think this issue can be closed for now.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/794781512/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/794922168","html_url":"https://github.com/apache/brpc/issues/1216#issuecomment-794922168","issue_url":"https://api.github.com/repos/apache/brpc/issues/1216","id":794922168,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NDkyMjE2OA==","user":{"login":"cavalier23","id":53844067,"node_id":"MDQ6VXNlcjUzODQ0MDY3","avatar_url":"https://avatars.githubusercontent.com/u/53844067?v=4","gravatar_id":"","url":"https://api.github.com/users/cavalier23","html_url":"https://github.com/cavalier23","followers_url":"https://api.github.com/users/cavalier23/followers","following_url":"https://api.github.com/users/cavalier23/following{/other_user}","gists_url":"https://api.github.com/users/cavalier23/gists{/gist_id}","starred_url":"https://api.github.com/users/cavalier23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cavalier23/subscriptions","organizations_url":"https://api.github.com/users/cavalier23/orgs","repos_url":"https://api.github.com/users/cavalier23/repos","events_url":"https://api.github.com/users/cavalier23/events{/privacy}","received_events_url":"https://api.github.com/users/cavalier23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T05:47:21Z","updated_at":"2021-03-10T05:47:21Z","author_association":"NONE","body":"> 手动处理了一下config.sh，己安装成功\r\n\r\n怎么处理的？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/794922168/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/796412214","html_url":"https://github.com/apache/brpc/issues/1353#issuecomment-796412214","issue_url":"https://api.github.com/repos/apache/brpc/issues/1353","id":796412214,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjQxMjIxNA==","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T03:26:25Z","updated_at":"2021-03-11T06:37:33Z","author_association":"CONTRIBUTOR","body":"![image](https://user-images.githubusercontent.com/7091130/110730983-70712f00-825c-11eb-87c8-8bafe8e40fa4.png)\r\n看代码是 value_proto.SerializeToString(value_buf) 从这里面进入到pb，value_proto是一个局部变量\r\n![image](https://user-images.githubusercontent.com/7091130/110731032-854dc280-825c-11eb-9ecb-045a5cdb2d4a.png)\r\nbp里面序列化过程中计算前后size不一致，导致abort。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/796412214/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/797220019","html_url":"https://github.com/apache/brpc/issues/1355#issuecomment-797220019","issue_url":"https://api.github.com/repos/apache/brpc/issues/1355","id":797220019,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzIyMDAxOQ==","user":{"login":"wasphin","id":1237906,"node_id":"MDQ6VXNlcjEyMzc5MDY=","avatar_url":"https://avatars.githubusercontent.com/u/1237906?v=4","gravatar_id":"","url":"https://api.github.com/users/wasphin","html_url":"https://github.com/wasphin","followers_url":"https://api.github.com/users/wasphin/followers","following_url":"https://api.github.com/users/wasphin/following{/other_user}","gists_url":"https://api.github.com/users/wasphin/gists{/gist_id}","starred_url":"https://api.github.com/users/wasphin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wasphin/subscriptions","organizations_url":"https://api.github.com/users/wasphin/orgs","repos_url":"https://api.github.com/users/wasphin/repos","events_url":"https://api.github.com/users/wasphin/events{/privacy}","received_events_url":"https://api.github.com/users/wasphin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T04:04:58Z","updated_at":"2021-03-12T04:04:58Z","author_association":"MEMBER","body":"package/rpm 下有 rpm 打包的 spec, 目前测试可以在 rhel/centos 6/7/8 上打包安装使用, 可以从 release 界面下载 tar 包或自己使用命令打一个:\r\n```\r\nexport TOPDIR=`pwd`/package\r\nmkdir ${TOPDIR}/SOURCES\r\ngit archive --format=tar.gz --prefix=incubator-brpc-0.9.7/ --output ${TOPDIR}/SOURCES/incubator-brpc-0.9.7.tar.gz HEAD\r\n```\r\n安装依赖:\r\n```\r\nsudo yum-builddeps -y package/rpm/brpc.spec\r\n```\r\n编译:\r\n```\r\nrpmbuild -bb package/rpm/brpc.spec ---define \"%_topdir $TOPDIR\"\r\n```","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/797220019/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/797304942","html_url":"https://github.com/apache/brpc/issues/1355#issuecomment-797304942","issue_url":"https://api.github.com/repos/apache/brpc/issues/1355","id":797304942,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzMwNDk0Mg==","user":{"login":"darionyaphet","id":4414314,"node_id":"MDQ6VXNlcjQ0MTQzMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/4414314?v=4","gravatar_id":"","url":"https://api.github.com/users/darionyaphet","html_url":"https://github.com/darionyaphet","followers_url":"https://api.github.com/users/darionyaphet/followers","following_url":"https://api.github.com/users/darionyaphet/following{/other_user}","gists_url":"https://api.github.com/users/darionyaphet/gists{/gist_id}","starred_url":"https://api.github.com/users/darionyaphet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/darionyaphet/subscriptions","organizations_url":"https://api.github.com/users/darionyaphet/orgs","repos_url":"https://api.github.com/users/darionyaphet/repos","events_url":"https://api.github.com/users/darionyaphet/events{/privacy}","received_events_url":"https://api.github.com/users/darionyaphet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T07:51:22Z","updated_at":"2021-03-12T07:51:22Z","author_association":"CONTRIBUTOR","body":"额 大佬 仓库里面没有  必须要自己动手吗？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/797304942/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/797520855","html_url":"https://github.com/apache/brpc/issues/1355#issuecomment-797520855","issue_url":"https://api.github.com/repos/apache/brpc/issues/1355","id":797520855,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzUyMDg1NQ==","user":{"login":"wasphin","id":1237906,"node_id":"MDQ6VXNlcjEyMzc5MDY=","avatar_url":"https://avatars.githubusercontent.com/u/1237906?v=4","gravatar_id":"","url":"https://api.github.com/users/wasphin","html_url":"https://github.com/wasphin","followers_url":"https://api.github.com/users/wasphin/followers","following_url":"https://api.github.com/users/wasphin/following{/other_user}","gists_url":"https://api.github.com/users/wasphin/gists{/gist_id}","starred_url":"https://api.github.com/users/wasphin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wasphin/subscriptions","organizations_url":"https://api.github.com/users/wasphin/orgs","repos_url":"https://api.github.com/users/wasphin/repos","events_url":"https://api.github.com/users/wasphin/events{/privacy}","received_events_url":"https://api.github.com/users/wasphin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T14:23:00Z","updated_at":"2021-03-12T14:23:00Z","author_association":"MEMBER","body":"可以考虑用[这个源](https://copr.fedorainfracloud.org/coprs/wasphin/brpc/), 刚基于 master 分支编译的, 而不是 0.9.7, 目前只编译了 epel7 和 epel8, 另外, 工具像 ``rpc_view`` 之类的也并未打包.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/797520855/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/798833913","html_url":"https://github.com/apache/brpc/issues/783#issuecomment-798833913","issue_url":"https://api.github.com/repos/apache/brpc/issues/783","id":798833913,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODgzMzkxMw==","user":{"login":"li4951","id":2560643,"node_id":"MDQ6VXNlcjI1NjA2NDM=","avatar_url":"https://avatars.githubusercontent.com/u/2560643?v=4","gravatar_id":"","url":"https://api.github.com/users/li4951","html_url":"https://github.com/li4951","followers_url":"https://api.github.com/users/li4951/followers","following_url":"https://api.github.com/users/li4951/following{/other_user}","gists_url":"https://api.github.com/users/li4951/gists{/gist_id}","starred_url":"https://api.github.com/users/li4951/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/li4951/subscriptions","organizations_url":"https://api.github.com/users/li4951/orgs","repos_url":"https://api.github.com/users/li4951/repos","events_url":"https://api.github.com/users/li4951/events{/privacy}","received_events_url":"https://api.github.com/users/li4951/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-14T05:06:10Z","updated_at":"2021-03-14T05:06:10Z","author_association":"NONE","body":"@mingolm 请问这个问题解决了吗？我也遇到了。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/798833913/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/798834012","html_url":"https://github.com/apache/brpc/issues/699#issuecomment-798834012","issue_url":"https://api.github.com/repos/apache/brpc/issues/699","id":798834012,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODgzNDAxMg==","user":{"login":"li4951","id":2560643,"node_id":"MDQ6VXNlcjI1NjA2NDM=","avatar_url":"https://avatars.githubusercontent.com/u/2560643?v=4","gravatar_id":"","url":"https://api.github.com/users/li4951","html_url":"https://github.com/li4951","followers_url":"https://api.github.com/users/li4951/followers","following_url":"https://api.github.com/users/li4951/following{/other_user}","gists_url":"https://api.github.com/users/li4951/gists{/gist_id}","starred_url":"https://api.github.com/users/li4951/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/li4951/subscriptions","organizations_url":"https://api.github.com/users/li4951/orgs","repos_url":"https://api.github.com/users/li4951/repos","events_url":"https://api.github.com/users/li4951/events{/privacy}","received_events_url":"https://api.github.com/users/li4951/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-14T05:07:24Z","updated_at":"2021-03-14T05:07:24Z","author_association":"NONE","body":"@reachfish 请问这个问题解决了吗？我也遇到了。版本0.9.6","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/798834012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/799037516","html_url":"https://github.com/apache/brpc/issues/1355#issuecomment-799037516","issue_url":"https://api.github.com/repos/apache/brpc/issues/1355","id":799037516,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTAzNzUxNg==","user":{"login":"darionyaphet","id":4414314,"node_id":"MDQ6VXNlcjQ0MTQzMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/4414314?v=4","gravatar_id":"","url":"https://api.github.com/users/darionyaphet","html_url":"https://github.com/darionyaphet","followers_url":"https://api.github.com/users/darionyaphet/followers","following_url":"https://api.github.com/users/darionyaphet/following{/other_user}","gists_url":"https://api.github.com/users/darionyaphet/gists{/gist_id}","starred_url":"https://api.github.com/users/darionyaphet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/darionyaphet/subscriptions","organizations_url":"https://api.github.com/users/darionyaphet/orgs","repos_url":"https://api.github.com/users/darionyaphet/repos","events_url":"https://api.github.com/users/darionyaphet/events{/privacy}","received_events_url":"https://api.github.com/users/darionyaphet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T01:54:28Z","updated_at":"2021-03-15T01:54:28Z","author_association":"CONTRIBUTOR","body":"谢谢大佬 ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/799037516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/799059294","html_url":"https://github.com/apache/brpc/issues/1334#issuecomment-799059294","issue_url":"https://api.github.com/repos/apache/brpc/issues/1334","id":799059294,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTA1OTI5NA==","user":{"login":"xiangpdu","id":11640492,"node_id":"MDQ6VXNlcjExNjQwNDky","avatar_url":"https://avatars.githubusercontent.com/u/11640492?v=4","gravatar_id":"","url":"https://api.github.com/users/xiangpdu","html_url":"https://github.com/xiangpdu","followers_url":"https://api.github.com/users/xiangpdu/followers","following_url":"https://api.github.com/users/xiangpdu/following{/other_user}","gists_url":"https://api.github.com/users/xiangpdu/gists{/gist_id}","starred_url":"https://api.github.com/users/xiangpdu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiangpdu/subscriptions","organizations_url":"https://api.github.com/users/xiangpdu/orgs","repos_url":"https://api.github.com/users/xiangpdu/repos","events_url":"https://api.github.com/users/xiangpdu/events{/privacy}","received_events_url":"https://api.github.com/users/xiangpdu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T03:10:34Z","updated_at":"2021-03-15T03:11:12Z","author_association":"NONE","body":"@cdjingit Great! Can you paste your merge request here?","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/799059294/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/807582753","html_url":"https://github.com/apache/brpc/issues/1364#issuecomment-807582753","issue_url":"https://api.github.com/repos/apache/brpc/issues/1364","id":807582753,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNzU4Mjc1Mw==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-25T22:03:57Z","updated_at":"2021-03-25T22:03:57Z","author_association":"MEMBER","body":"影响请求本身吗？这个是grpc的[自定义setting_id](https://github.com/grpc/grpc/blob/master/src/core/ext/transport/chttp2/transport/http2_settings.h)，如果正常的话，对端不认识就直接忽略了。\r\n\r\n标准的setting：https://tools.ietf.org/html/rfc7540#section-6.5","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/807582753/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/809267882","html_url":"https://github.com/apache/brpc/issues/1362#issuecomment-809267882","issue_url":"https://api.github.com/repos/apache/brpc/issues/1362","id":809267882,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTI2Nzg4Mg==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T10:27:48Z","updated_at":"2021-03-29T10:27:48Z","author_association":"CONTRIBUTOR","body":"这个链路追踪的功能，brpc内置服务提供了一个类似的本地调试工具rpcz","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/809267882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/809268801","html_url":"https://github.com/apache/brpc/issues/1365#issuecomment-809268801","issue_url":"https://api.github.com/repos/apache/brpc/issues/1365","id":809268801,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTI2ODgwMQ==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T10:29:09Z","updated_at":"2021-03-29T10:29:09Z","author_association":"CONTRIBUTOR","body":"参考文档：https://github.com/apache/incubator-brpc/blob/master/docs/cn/bvar_c++.md#quick-introduction","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/809268801/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/809865450","html_url":"https://github.com/apache/brpc/issues/1365#issuecomment-809865450","issue_url":"https://api.github.com/repos/apache/brpc/issues/1365","id":809865450,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTg2NTQ1MA==","user":{"login":"DannyLuoDan","id":23734650,"node_id":"MDQ6VXNlcjIzNzM0NjUw","avatar_url":"https://avatars.githubusercontent.com/u/23734650?v=4","gravatar_id":"","url":"https://api.github.com/users/DannyLuoDan","html_url":"https://github.com/DannyLuoDan","followers_url":"https://api.github.com/users/DannyLuoDan/followers","following_url":"https://api.github.com/users/DannyLuoDan/following{/other_user}","gists_url":"https://api.github.com/users/DannyLuoDan/gists{/gist_id}","starred_url":"https://api.github.com/users/DannyLuoDan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DannyLuoDan/subscriptions","organizations_url":"https://api.github.com/users/DannyLuoDan/orgs","repos_url":"https://api.github.com/users/DannyLuoDan/repos","events_url":"https://api.github.com/users/DannyLuoDan/events{/privacy}","received_events_url":"https://api.github.com/users/DannyLuoDan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T02:52:17Z","updated_at":"2021-03-30T02:52:17Z","author_association":"NONE","body":"> 参考文档：https://github.com/apache/incubator-brpc/blob/master/docs/cn/bvar_c++.md#quick-introduction\r\n\r\n谢谢。不过就是这边有些不明白的地方：\r\n// bvar::Adder<T>用于累加，下面定义了一个统计read error总数的Adder。\r\nbvar::Adder<int> g_read_error;\r\n// 把bvar::Window套在其他bvar上就可以获得时间窗口内的值。\r\nbvar::Window<bvar::Adder<int> > g_read_error_minute(\"foo_bar\", \"read_error\", &g_read_error, 60);\r\n//                                                     ^          ^                         ^\r\n//                                                    前缀       监控项名称                  60秒,忽略则为10秒\r\n\r\n这边时间窗口内的值是什么值？假设时间窗口为1秒，g_read_error 当前已经累加到了15，后续有时候1s增加2，有时候1s增加3等， 那么foo_bar_read_error的值是 累加后的值 17 还是 2 或者3呀？ ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/809865450/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/809876948","html_url":"https://github.com/apache/brpc/issues/1339#issuecomment-809876948","issue_url":"https://api.github.com/repos/apache/brpc/issues/1339","id":809876948,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTg3Njk0OA==","user":{"login":"yushimeng","id":18053443,"node_id":"MDQ6VXNlcjE4MDUzNDQz","avatar_url":"https://avatars.githubusercontent.com/u/18053443?v=4","gravatar_id":"","url":"https://api.github.com/users/yushimeng","html_url":"https://github.com/yushimeng","followers_url":"https://api.github.com/users/yushimeng/followers","following_url":"https://api.github.com/users/yushimeng/following{/other_user}","gists_url":"https://api.github.com/users/yushimeng/gists{/gist_id}","starred_url":"https://api.github.com/users/yushimeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yushimeng/subscriptions","organizations_url":"https://api.github.com/users/yushimeng/orgs","repos_url":"https://api.github.com/users/yushimeng/repos","events_url":"https://api.github.com/users/yushimeng/events{/privacy}","received_events_url":"https://api.github.com/users/yushimeng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T03:25:36Z","updated_at":"2021-03-30T03:25:36Z","author_association":"NONE","body":"yum 安装完gflag之后\r\n$ ls /usr/include/gflags/\r\ngflags_completions.h  gflags.h\r\n只有这两个文件，没有gflags_declare.h","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/809876948/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/809885700","html_url":"https://github.com/apache/brpc/issues/1362#issuecomment-809885700","issue_url":"https://api.github.com/repos/apache/brpc/issues/1362","id":809885700,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTg4NTcwMA==","user":{"login":"qqwangxiaow","id":26954625,"node_id":"MDQ6VXNlcjI2OTU0NjI1","avatar_url":"https://avatars.githubusercontent.com/u/26954625?v=4","gravatar_id":"","url":"https://api.github.com/users/qqwangxiaow","html_url":"https://github.com/qqwangxiaow","followers_url":"https://api.github.com/users/qqwangxiaow/followers","following_url":"https://api.github.com/users/qqwangxiaow/following{/other_user}","gists_url":"https://api.github.com/users/qqwangxiaow/gists{/gist_id}","starred_url":"https://api.github.com/users/qqwangxiaow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qqwangxiaow/subscriptions","organizations_url":"https://api.github.com/users/qqwangxiaow/orgs","repos_url":"https://api.github.com/users/qqwangxiaow/repos","events_url":"https://api.github.com/users/qqwangxiaow/events{/privacy}","received_events_url":"https://api.github.com/users/qqwangxiaow/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T03:51:42Z","updated_at":"2021-03-30T03:51:42Z","author_association":"CONTRIBUTOR","body":"client端在调用RPC的时候有获得正常request node和backup request node信息的方法吗\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/809885700/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/809990255","html_url":"https://github.com/apache/brpc/issues/1339#issuecomment-809990255","issue_url":"https://api.github.com/repos/apache/brpc/issues/1339","id":809990255,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTk5MDI1NQ==","user":{"login":"wasphin","id":1237906,"node_id":"MDQ6VXNlcjEyMzc5MDY=","avatar_url":"https://avatars.githubusercontent.com/u/1237906?v=4","gravatar_id":"","url":"https://api.github.com/users/wasphin","html_url":"https://github.com/wasphin","followers_url":"https://api.github.com/users/wasphin/followers","following_url":"https://api.github.com/users/wasphin/following{/other_user}","gists_url":"https://api.github.com/users/wasphin/gists{/gist_id}","starred_url":"https://api.github.com/users/wasphin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wasphin/subscriptions","organizations_url":"https://api.github.com/users/wasphin/orgs","repos_url":"https://api.github.com/users/wasphin/repos","events_url":"https://api.github.com/users/wasphin/events{/privacy}","received_events_url":"https://api.github.com/users/wasphin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T07:37:56Z","updated_at":"2021-03-30T07:37:56Z","author_association":"MEMBER","body":"https://github.com/apache/incubator-brpc/blob/60159fc3f3e13490fb9806ea0a0cb0dcdbda7f7d/package/rpm/brpc.spec#L26\r\n\r\ngflags 需要 2.1+ 的版本","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/809990255/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/810075482","html_url":"https://github.com/apache/brpc/pull/760#issuecomment-810075482","issue_url":"https://api.github.com/repos/apache/brpc/issues/760","id":810075482,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDA3NTQ4Mg==","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T09:39:34Z","updated_at":"2021-03-30T09:39:34Z","author_association":"CONTRIBUTOR","body":"> > 添加了mysql的prepared statement协议的支持。\r\n> > 遇到的两个问题解决方案如下：\r\n> > 1、prepared statement首先是在某个连接上创建一个statement id，后续操作可以根据这个statement id向这个连接发送后续的请求。同一个语句在每个连接上的statement id是不同的。在pooled模式下，每次RPC选择的连接是不同的，所以需要记录SocketId和statement id的关系，我们这里称为id_map。但是一个SocketId有可能关闭，然后又重新建立起来，这个新SocketId对应的连接没有这个statement id。id_map没有机制可以做到同步更新，保存的SocketId与statement id关系信息是旧的关系。这样就会产生问题。\r\n> > 这个问题的修改方式是，给socketid对应的fd一个唯一的版本号，每次通过stmt_id找到socketid的时候对比一下版本号，版本号一致说明fd没有变化，版本号不一致说明fd变化过。\r\n> > 2、目前还不能支持single模式，唯一的原因就是auth部分，正常auth多个请求会竞争发送auth，后续操作就不需要发送auth了，auth不用等待服务端应答，就可以让其他请求继续发送。但是mysql的auth和这个逻辑不通，mysql的auth首先接收mysql-server发送过来的salt，客户端根据salt加密密码，再把加密后的密码发送给服务端。这样的逻辑如果不等待服务端应答就解锁别的请求，就会出现发送auth的请求落后于正常的请求，导致消息乱序。\r\n> > 这个目前就先不支持single模式了。\r\n> \r\n> 1. statement id是和连接相关的？还是和地址相关，即同一个地址不同的连接可以用一个statement id？\r\n> 2. single模式的认证过程的问题，我在开发cql协议的时候也遇到了，解决放案如下：\r\n>    在认证交互流程完成前，业务请求包先累积在buf里，等认证完成再一起发送出去。\r\n\r\n1、statement id 是连接相关的。\r\n2、嗯，业务请求包先累积在buf里这个我参考一下","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/810075482/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/811615710","html_url":"https://github.com/apache/brpc/issues/1362#issuecomment-811615710","issue_url":"https://api.github.com/repos/apache/brpc/issues/1362","id":811615710,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTYxNTcxMA==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T03:43:02Z","updated_at":"2021-04-01T03:43:02Z","author_association":"CONTRIBUTOR","body":"> client端在调用RPC的时候有获得正常request node和backup request node信息的方法吗\r\n\r\n不能，只能获得最终返回结果的remote node。中间的重试node，包括backup node，都不能获取到。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/811615710/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/813505393","html_url":"https://github.com/apache/brpc/pull/1370#issuecomment-813505393","issue_url":"https://api.github.com/repos/apache/brpc/issues/1370","id":813505393,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMzUwNTM5Mw==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-05T17:01:22Z","updated_at":"2021-04-05T17:01:22Z","author_association":"MEMBER","body":"Thanks for the contribution.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/813505393/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/815436572","html_url":"https://github.com/apache/brpc/issues/1373#issuecomment-815436572","issue_url":"https://api.github.com/repos/apache/brpc/issues/1373","id":815436572,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNTQzNjU3Mg==","user":{"login":"cuisonghui","id":8772285,"node_id":"MDQ6VXNlcjg3NzIyODU=","avatar_url":"https://avatars.githubusercontent.com/u/8772285?v=4","gravatar_id":"","url":"https://api.github.com/users/cuisonghui","html_url":"https://github.com/cuisonghui","followers_url":"https://api.github.com/users/cuisonghui/followers","following_url":"https://api.github.com/users/cuisonghui/following{/other_user}","gists_url":"https://api.github.com/users/cuisonghui/gists{/gist_id}","starred_url":"https://api.github.com/users/cuisonghui/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cuisonghui/subscriptions","organizations_url":"https://api.github.com/users/cuisonghui/orgs","repos_url":"https://api.github.com/users/cuisonghui/repos","events_url":"https://api.github.com/users/cuisonghui/events{/privacy}","received_events_url":"https://api.github.com/users/cuisonghui/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-08T04:28:09Z","updated_at":"2021-04-08T04:28:09Z","author_association":"NONE","body":"@gydong @serverglen @jamesge ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/815436572/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/816384278","html_url":"https://github.com/apache/brpc/issues/1344#issuecomment-816384278","issue_url":"https://api.github.com/repos/apache/brpc/issues/1344","id":816384278,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNjM4NDI3OA==","user":{"login":"yangzhg","id":9098473,"node_id":"MDQ6VXNlcjkwOTg0NzM=","avatar_url":"https://avatars.githubusercontent.com/u/9098473?v=4","gravatar_id":"","url":"https://api.github.com/users/yangzhg","html_url":"https://github.com/yangzhg","followers_url":"https://api.github.com/users/yangzhg/followers","following_url":"https://api.github.com/users/yangzhg/following{/other_user}","gists_url":"https://api.github.com/users/yangzhg/gists{/gist_id}","starred_url":"https://api.github.com/users/yangzhg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yangzhg/subscriptions","organizations_url":"https://api.github.com/users/yangzhg/orgs","repos_url":"https://api.github.com/users/yangzhg/repos","events_url":"https://api.github.com/users/yangzhg/events{/privacy}","received_events_url":"https://api.github.com/users/yangzhg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-09T04:00:38Z","updated_at":"2021-04-09T04:00:38Z","author_association":"MEMBER","body":"后来发现如果Server端有设置attachment  用grpc 访问就会出错","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/816384278/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/817437125","html_url":"https://github.com/apache/brpc/issues/1244#issuecomment-817437125","issue_url":"https://api.github.com/repos/apache/brpc/issues/1244","id":817437125,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNzQzNzEyNQ==","user":{"login":"GOGOYAO","id":18675094,"node_id":"MDQ6VXNlcjE4Njc1MDk0","avatar_url":"https://avatars.githubusercontent.com/u/18675094?v=4","gravatar_id":"","url":"https://api.github.com/users/GOGOYAO","html_url":"https://github.com/GOGOYAO","followers_url":"https://api.github.com/users/GOGOYAO/followers","following_url":"https://api.github.com/users/GOGOYAO/following{/other_user}","gists_url":"https://api.github.com/users/GOGOYAO/gists{/gist_id}","starred_url":"https://api.github.com/users/GOGOYAO/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GOGOYAO/subscriptions","organizations_url":"https://api.github.com/users/GOGOYAO/orgs","repos_url":"https://api.github.com/users/GOGOYAO/repos","events_url":"https://api.github.com/users/GOGOYAO/events{/privacy}","received_events_url":"https://api.github.com/users/GOGOYAO/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-12T02:30:18Z","updated_at":"2021-04-12T03:29:39Z","author_association":"CONTRIBUTOR","body":"> 因为brpc的profile功能是在.h文件中定义的，只有在你使用brpc的代码部分才会去看BRPC_ENABLE_CPU_PROFILER是否开启，具体代码请看` brpc/details/profiler_linker.h`\r\n\r\n是你这样弄的。\r\n\r\n我的问题是，”发现cpu profile结果的下拉列表里面，可以正常打开看到cpu profile结果“，但是如果是选择new profile提示的是未开启。很奇怪。\r\n\r\n![image](https://user-images.githubusercontent.com/18675094/114336809-563faf00-9b82-11eb-93e4-a51c31e3ece4.png)\r\n\r\n红框里面的都是可以看到profile结果的","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/817437125/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/818485156","html_url":"https://github.com/apache/brpc/issues/1373#issuecomment-818485156","issue_url":"https://api.github.com/repos/apache/brpc/issues/1373","id":818485156,"node_id":"MDEyOklzc3VlQ29tbWVudDgxODQ4NTE1Ng==","user":{"login":"hotaery","id":29942326,"node_id":"MDQ6VXNlcjI5OTQyMzI2","avatar_url":"https://avatars.githubusercontent.com/u/29942326?v=4","gravatar_id":"","url":"https://api.github.com/users/hotaery","html_url":"https://github.com/hotaery","followers_url":"https://api.github.com/users/hotaery/followers","following_url":"https://api.github.com/users/hotaery/following{/other_user}","gists_url":"https://api.github.com/users/hotaery/gists{/gist_id}","starred_url":"https://api.github.com/users/hotaery/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hotaery/subscriptions","organizations_url":"https://api.github.com/users/hotaery/orgs","repos_url":"https://api.github.com/users/hotaery/repos","events_url":"https://api.github.com/users/hotaery/events{/privacy}","received_events_url":"https://api.github.com/users/hotaery/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-13T06:46:41Z","updated_at":"2021-04-13T06:46:41Z","author_association":"NONE","body":"有可能，如果执行函数内部有bthread提供的同步原语，比如bthread_mutex，如果没有获取到会被挂起，后面条件达到时会加入队列等待调度，此时有可能其他空闲工作线程会来窃取bthread执行，最终执行函数会在多个工作线程(pthread)执行","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/818485156/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/818491775","html_url":"https://github.com/apache/brpc/issues/1376#issuecomment-818491775","issue_url":"https://api.github.com/repos/apache/brpc/issues/1376","id":818491775,"node_id":"MDEyOklzc3VlQ29tbWVudDgxODQ5MTc3NQ==","user":{"login":"hotaery","id":29942326,"node_id":"MDQ6VXNlcjI5OTQyMzI2","avatar_url":"https://avatars.githubusercontent.com/u/29942326?v=4","gravatar_id":"","url":"https://api.github.com/users/hotaery","html_url":"https://github.com/hotaery","followers_url":"https://api.github.com/users/hotaery/followers","following_url":"https://api.github.com/users/hotaery/following{/other_user}","gists_url":"https://api.github.com/users/hotaery/gists{/gist_id}","starred_url":"https://api.github.com/users/hotaery/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hotaery/subscriptions","organizations_url":"https://api.github.com/users/hotaery/orgs","repos_url":"https://api.github.com/users/hotaery/repos","events_url":"https://api.github.com/users/hotaery/events{/privacy}","received_events_url":"https://api.github.com/users/hotaery/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-13T06:58:30Z","updated_at":"2021-04-13T06:58:30Z","author_association":"NONE","body":"多写多读都是支持的，但是多写最终会串行执行的，写使用了mutex来保护的，具体可以参考https://github.com/apache/incubator-brpc/blob/master/src/butil/containers/doubly_buffered_data.h#L351","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/818491775/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/818493682","html_url":"https://github.com/apache/brpc/issues/1368#issuecomment-818493682","issue_url":"https://api.github.com/repos/apache/brpc/issues/1368","id":818493682,"node_id":"MDEyOklzc3VlQ29tbWVudDgxODQ5MzY4Mg==","user":{"login":"hotaery","id":29942326,"node_id":"MDQ6VXNlcjI5OTQyMzI2","avatar_url":"https://avatars.githubusercontent.com/u/29942326?v=4","gravatar_id":"","url":"https://api.github.com/users/hotaery","html_url":"https://github.com/hotaery","followers_url":"https://api.github.com/users/hotaery/followers","following_url":"https://api.github.com/users/hotaery/following{/other_user}","gists_url":"https://api.github.com/users/hotaery/gists{/gist_id}","starred_url":"https://api.github.com/users/hotaery/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hotaery/subscriptions","organizations_url":"https://api.github.com/users/hotaery/orgs","repos_url":"https://api.github.com/users/hotaery/repos","events_url":"https://api.github.com/users/hotaery/events{/privacy}","received_events_url":"https://api.github.com/users/hotaery/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-13T07:01:39Z","updated_at":"2021-04-13T07:01:39Z","author_association":"NONE","body":"不需要任何初始化，就直接使用类似bthread_start_background等类pthread接口就可以了，具体接口可以看https://github.com/apache/incubator-brpc/blob/master/src/bthread/bthread.h","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/818493682/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/818493987","html_url":"https://github.com/apache/brpc/issues/1376#issuecomment-818493987","issue_url":"https://api.github.com/repos/apache/brpc/issues/1376","id":818493987,"node_id":"MDEyOklzc3VlQ29tbWVudDgxODQ5Mzk4Nw==","user":{"login":"cfreebuf","id":22336250,"node_id":"MDQ6VXNlcjIyMzM2MjUw","avatar_url":"https://avatars.githubusercontent.com/u/22336250?v=4","gravatar_id":"","url":"https://api.github.com/users/cfreebuf","html_url":"https://github.com/cfreebuf","followers_url":"https://api.github.com/users/cfreebuf/followers","following_url":"https://api.github.com/users/cfreebuf/following{/other_user}","gists_url":"https://api.github.com/users/cfreebuf/gists{/gist_id}","starred_url":"https://api.github.com/users/cfreebuf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cfreebuf/subscriptions","organizations_url":"https://api.github.com/users/cfreebuf/orgs","repos_url":"https://api.github.com/users/cfreebuf/repos","events_url":"https://api.github.com/users/cfreebuf/events{/privacy}","received_events_url":"https://api.github.com/users/cfreebuf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-13T07:02:08Z","updated_at":"2021-04-13T07:02:08Z","author_association":"NONE","body":"明白，多谢~","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/818493987/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/818495288","html_url":"https://github.com/apache/brpc/issues/1365#issuecomment-818495288","issue_url":"https://api.github.com/repos/apache/brpc/issues/1365","id":818495288,"node_id":"MDEyOklzc3VlQ29tbWVudDgxODQ5NTI4OA==","user":{"login":"hotaery","id":29942326,"node_id":"MDQ6VXNlcjI5OTQyMzI2","avatar_url":"https://avatars.githubusercontent.com/u/29942326?v=4","gravatar_id":"","url":"https://api.github.com/users/hotaery","html_url":"https://github.com/hotaery","followers_url":"https://api.github.com/users/hotaery/followers","following_url":"https://api.github.com/users/hotaery/following{/other_user}","gists_url":"https://api.github.com/users/hotaery/gists{/gist_id}","starred_url":"https://api.github.com/users/hotaery/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hotaery/subscriptions","organizations_url":"https://api.github.com/users/hotaery/orgs","repos_url":"https://api.github.com/users/hotaery/repos","events_url":"https://api.github.com/users/hotaery/events{/privacy}","received_events_url":"https://api.github.com/users/hotaery/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-13T07:04:19Z","updated_at":"2021-04-13T07:04:19Z","author_association":"NONE","body":"> > 参考文档：https://github.com/apache/incubator-brpc/blob/master/docs/cn/bvar_c++.md#quick-introduction\r\n> \r\n> 谢谢。不过就是这边有些不明白的地方：\r\n> // bvar::Adder用于累加，下面定义了一个统计read error总数的Adder。\r\n> bvar::Adder g_read_error;\r\n> // 把bvar::Window套在其他bvar上就可以获得时间窗口内的值。\r\n> bvar::Window<bvar::Adder > g_read_error_minute(\"foo_bar\", \"read_error\", &g_read_error, 60);\r\n> // ^ ^ ^\r\n> // 前缀 监控项名称 60秒,忽略则为10秒\r\n> \r\n> 这边时间窗口内的值是什么值？假设时间窗口为1秒，g_read_error 当前已经累加到了15，后续有时候1s增加2，有时候1s增加3等， 那么foo_bar_read_error的值是 累加后的值 17 还是 2 或者3呀？\r\n\r\n后者","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/818495288/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/818725158","html_url":"https://github.com/apache/brpc/issues/1378#issuecomment-818725158","issue_url":"https://api.github.com/repos/apache/brpc/issues/1378","id":818725158,"node_id":"MDEyOklzc3VlQ29tbWVudDgxODcyNTE1OA==","user":{"login":"FightingMan","id":1555834,"node_id":"MDQ6VXNlcjE1NTU4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1555834?v=4","gravatar_id":"","url":"https://api.github.com/users/FightingMan","html_url":"https://github.com/FightingMan","followers_url":"https://api.github.com/users/FightingMan/followers","following_url":"https://api.github.com/users/FightingMan/following{/other_user}","gists_url":"https://api.github.com/users/FightingMan/gists{/gist_id}","starred_url":"https://api.github.com/users/FightingMan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FightingMan/subscriptions","organizations_url":"https://api.github.com/users/FightingMan/orgs","repos_url":"https://api.github.com/users/FightingMan/repos","events_url":"https://api.github.com/users/FightingMan/events{/privacy}","received_events_url":"https://api.github.com/users/FightingMan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-13T13:13:21Z","updated_at":"2021-04-13T13:13:21Z","author_association":"NONE","body":"update:\r\ncopy全部buildfile到本地，以及修改本地WORKSPACE文件能解决\r\n期待提供一共fucntion，load一下即可\r\n\r\n(base) [ /tmp/test_brpc]$ ls\r\nBUILD  WORKSPACE  bazel-bin  bazel-out  bazel-test_brpc  bazel-testlogs  glog.BUILD  leveldb.BUILD  openssl.BUILD  test.cpp  zlib.BUILD\r\n(base) [/tmp/test_brpc]$ !cat\r\ncat WORKSPACE \r\nload(\"@bazel_tools//tools/build_defs/repo:http.bzl\", \"http_archive\")\r\nload('@bazel_tools//tools/build_defs/repo:git.bzl', 'git_repository')\r\ngit_repository(\r\n    name = \"brpc_cpp\",\r\n    remote = \"https://github.com/apache/incubator-brpc.git\",\r\n    branch = \"master\",\r\n)\r\n\r\nskylib_version = \"0.8.0\"\r\nhttp_archive(\r\n    name = \"bazel_skylib\",\r\n    type = \"tar.gz\",\r\n    url = \"https://github.com/bazelbuild/bazel-skylib/releases/download/{}/bazel-skylib.{}.tar.gz\".format (skylib_version, skylib_version),\r\n    sha256 = \"2ef429f5d7ce7111263289644d233707dba35e39696377ebab8b0bc701f7818e\",\r\n)\r\n\r\nhttp_archive(\r\n  name = \"com_google_protobuf\",\r\n  strip_prefix = \"protobuf-3.6.1.3\",\r\n  sha256 = \"9510dd2afc29e7245e9e884336f848c8a6600a14ae726adb6befdb4f786f0be2\",\r\n  type = \"zip\",\r\n  url = \"https://github.com/protocolbuffers/protobuf/archive/v3.6.1.3.zip\",\r\n)\r\n\r\nhttp_archive(\r\n    name = \"com_github_gflags_gflags\",\r\n    strip_prefix = \"gflags-46f73f88b18aee341538c0dfc22b1710a6abedef\",\r\n    url = \"https://github.com/gflags/gflags/archive/46f73f88b18aee341538c0dfc22b1710a6abedef.tar.gz\",\r\n)\r\n\r\nbind(\r\n    name = \"gflags\",\r\n    actual = \"@com_github_gflags_gflags//:gflags\",\r\n)\r\n\r\nhttp_archive(\r\n    name = \"com_github_google_leveldb\",\r\n    build_file = \"//:leveldb.BUILD\",\r\n    strip_prefix = \"leveldb-a53934a3ae1244679f812d998a4f16f2c7f309a6\",\r\n    url = \"https://github.com/google/leveldb/archive/a53934a3ae1244679f812d998a4f16f2c7f309a6.tar.gz\"\r\n)\r\n\r\nhttp_archive(\r\n    name = \"com_github_google_glog\",\r\n    build_file = \"//:glog.BUILD\",\r\n    strip_prefix = \"glog-a6a166db069520dbbd653c97c2e5b12e08a8bb26\",\r\n    url = \"https://github.com/google/glog/archive/a6a166db069520dbbd653c97c2e5b12e08a8bb26.tar.gz\"\r\n)\r\n\r\nhttp_archive(\r\n    name = \"com_google_googletest\",\r\n    strip_prefix = \"googletest-0fe96607d85cf3a25ac40da369db62bbee2939a5\",\r\n    url = \"https://github.com/google/googletest/archive/0fe96607d85cf3a25ac40da369db62bbee2939a5.tar.gz\",\r\n)\r\n\r\nnew_local_repository(\r\n    name = \"openssl\",\r\n    path = \"/usr\",\r\n    build_file = \"//:openssl.BUILD\",\r\n)\r\n\r\nnew_local_repository(\r\n    name = \"openssl_macos\",\r\n    build_file = \"//:openssl.BUILD\",\r\n    path = \"/usr/lib/openssl\",\r\n)\r\n\r\nbind(\r\n    name = \"ssl\",\r\n    actual = \"@openssl//:ssl\"\r\n)\r\n\r\nbind(\r\n    name = \"ssl_macos\",\r\n    actual = \"@openssl_macos//:ssl\"\r\n)\r\n\r\nnew_local_repository(\r\n    name = \"zlib\",\r\n    build_file = \"//:zlib.BUILD\",\r\n    path = \"/usr\",\r\n)","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/818725158/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/819164862","html_url":"https://github.com/apache/brpc/issues/1350#issuecomment-819164862","issue_url":"https://api.github.com/repos/apache/brpc/issues/1350","id":819164862,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTE2NDg2Mg==","user":{"login":"woniuasd","id":29877000,"node_id":"MDQ6VXNlcjI5ODc3MDAw","avatar_url":"https://avatars.githubusercontent.com/u/29877000?v=4","gravatar_id":"","url":"https://api.github.com/users/woniuasd","html_url":"https://github.com/woniuasd","followers_url":"https://api.github.com/users/woniuasd/followers","following_url":"https://api.github.com/users/woniuasd/following{/other_user}","gists_url":"https://api.github.com/users/woniuasd/gists{/gist_id}","starred_url":"https://api.github.com/users/woniuasd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/woniuasd/subscriptions","organizations_url":"https://api.github.com/users/woniuasd/orgs","repos_url":"https://api.github.com/users/woniuasd/repos","events_url":"https://api.github.com/users/woniuasd/events{/privacy}","received_events_url":"https://api.github.com/users/woniuasd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T01:55:04Z","updated_at":"2021-04-14T01:55:04Z","author_association":"NONE","body":"看着像protobuf的版本不对导致的，源码编译安装protobuf一般都是安装到了/usr/local/lib文件夹里面，apt安装默认不是在这个位置,可是尝试源码安装其他版本的的protobuf试试","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/819164862/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/819300098","html_url":"https://github.com/apache/brpc/issues/1365#issuecomment-819300098","issue_url":"https://api.github.com/repos/apache/brpc/issues/1365","id":819300098,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTMwMDA5OA==","user":{"login":"DannyLuoDan","id":23734650,"node_id":"MDQ6VXNlcjIzNzM0NjUw","avatar_url":"https://avatars.githubusercontent.com/u/23734650?v=4","gravatar_id":"","url":"https://api.github.com/users/DannyLuoDan","html_url":"https://github.com/DannyLuoDan","followers_url":"https://api.github.com/users/DannyLuoDan/followers","following_url":"https://api.github.com/users/DannyLuoDan/following{/other_user}","gists_url":"https://api.github.com/users/DannyLuoDan/gists{/gist_id}","starred_url":"https://api.github.com/users/DannyLuoDan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DannyLuoDan/subscriptions","organizations_url":"https://api.github.com/users/DannyLuoDan/orgs","repos_url":"https://api.github.com/users/DannyLuoDan/repos","events_url":"https://api.github.com/users/DannyLuoDan/events{/privacy}","received_events_url":"https://api.github.com/users/DannyLuoDan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T07:35:19Z","updated_at":"2021-04-14T07:35:19Z","author_association":"NONE","body":"明白了，谢谢两位大佬","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/819300098/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]