[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775020283","html_url":"https://github.com/apache/iceberg/pull/8659#issuecomment-1775020283","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8659","id":1775020283,"node_id":"IC_kwDOCW7NX85pzKj7","user":{"login":"bitsondatadev","id":8547669,"node_id":"MDQ6VXNlcjg1NDc2Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8547669?v=4","gravatar_id":"","url":"https://api.github.com/users/bitsondatadev","html_url":"https://github.com/bitsondatadev","followers_url":"https://api.github.com/users/bitsondatadev/followers","following_url":"https://api.github.com/users/bitsondatadev/following{/other_user}","gists_url":"https://api.github.com/users/bitsondatadev/gists{/gist_id}","starred_url":"https://api.github.com/users/bitsondatadev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitsondatadev/subscriptions","organizations_url":"https://api.github.com/users/bitsondatadev/orgs","repos_url":"https://api.github.com/users/bitsondatadev/repos","events_url":"https://api.github.com/users/bitsondatadev/events{/privacy}","received_events_url":"https://api.github.com/users/bitsondatadev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-23T11:48:55Z","updated_at":"2023-10-23T11:48:55Z","author_association":"COLLABORATOR","body":"Yeah, I think the projects make sense to have a better visual of progress broken down by phase. The first phase was a bunch of research and discussion on the design, so that would have been difficult to coordinate. The second phase is rather boring and though it is something that's easier to task out, my goal is to move quickly on that one so we don't have two versions of docs for long. The third phase is where I will build a bunch of tasks and get us to business as usual.\n\nThe second phase is updating older docs to the mkdocs format and tracking down a web dev to get mkdocs stylized to the current site. If anyone knows any open source web devs please let them know to reach out on the mailing list!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775020283/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775193170","html_url":"https://github.com/apache/iceberg/pull/8906#issuecomment-1775193170","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8906","id":1775193170,"node_id":"IC_kwDOCW7NX85pz0xS","user":{"login":"jbonofre","id":158903,"node_id":"MDQ6VXNlcjE1ODkwMw==","avatar_url":"https://avatars.githubusercontent.com/u/158903?v=4","gravatar_id":"","url":"https://api.github.com/users/jbonofre","html_url":"https://github.com/jbonofre","followers_url":"https://api.github.com/users/jbonofre/followers","following_url":"https://api.github.com/users/jbonofre/following{/other_user}","gists_url":"https://api.github.com/users/jbonofre/gists{/gist_id}","starred_url":"https://api.github.com/users/jbonofre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbonofre/subscriptions","organizations_url":"https://api.github.com/users/jbonofre/orgs","repos_url":"https://api.github.com/users/jbonofre/repos","events_url":"https://api.github.com/users/jbonofre/events{/privacy}","received_events_url":"https://api.github.com/users/jbonofre/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-23T13:26:31Z","updated_at":"2023-10-23T13:26:31Z","author_association":"MEMBER","body":"FYI, related to `revapi`, I'm working on https://github.com/palantir/gradle-revapi/issues/612.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775193170/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775210294","html_url":"https://github.com/apache/iceberg/pull/7105#issuecomment-1775210294","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7105","id":1775210294,"node_id":"IC_kwDOCW7NX85pz482","user":{"login":"jbonofre","id":158903,"node_id":"MDQ6VXNlcjE1ODkwMw==","avatar_url":"https://avatars.githubusercontent.com/u/158903?v=4","gravatar_id":"","url":"https://api.github.com/users/jbonofre","html_url":"https://github.com/jbonofre","followers_url":"https://api.github.com/users/jbonofre/followers","following_url":"https://api.github.com/users/jbonofre/following{/other_user}","gists_url":"https://api.github.com/users/jbonofre/gists{/gist_id}","starred_url":"https://api.github.com/users/jbonofre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbonofre/subscriptions","organizations_url":"https://api.github.com/users/jbonofre/orgs","repos_url":"https://api.github.com/users/jbonofre/repos","events_url":"https://api.github.com/users/jbonofre/events{/privacy}","received_events_url":"https://api.github.com/users/jbonofre/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-23T13:34:12Z","updated_at":"2023-10-23T13:34:12Z","author_association":"MEMBER","body":"I took a new complete look on this PR. @ajantha-bhat isolated specs change in this PR, which is a good approach (to focus only on specs and not the impact on impl).\r\nAs this PR:\r\n- focus on table/partition spec\r\n- new table/partition spec properties are optional\r\nI think it's reasonable to merge it (or at least to have a new review).\r\n\r\n@rdblue @aokolnychyi do you mind to take a new look ? IMHO, it's good for me and we can merge it. The impl/engine changes will be in other PRs (eventually iterating on spec change if needed).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775210294/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775255912","html_url":"https://github.com/apache/iceberg/issues/8902#issuecomment-1775255912","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8902","id":1775255912,"node_id":"IC_kwDOCW7NX85p0EFo","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-23T13:53:09Z","updated_at":"2023-10-23T13:55:51Z","author_association":"CONTRIBUTOR","body":"ACK @cccs-jc let me take a closer look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775255912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775412513","html_url":"https://github.com/apache/iceberg/issues/8902#issuecomment-1775412513","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8902","id":1775412513,"node_id":"IC_kwDOCW7NX85p0qUh","user":{"login":"cccs-jc","id":56140112,"node_id":"MDQ6VXNlcjU2MTQwMTEy","avatar_url":"https://avatars.githubusercontent.com/u/56140112?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-jc","html_url":"https://github.com/cccs-jc","followers_url":"https://api.github.com/users/cccs-jc/followers","following_url":"https://api.github.com/users/cccs-jc/following{/other_user}","gists_url":"https://api.github.com/users/cccs-jc/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-jc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-jc/subscriptions","organizations_url":"https://api.github.com/users/cccs-jc/orgs","repos_url":"https://api.github.com/users/cccs-jc/repos","events_url":"https://api.github.com/users/cccs-jc/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-jc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-23T15:04:25Z","updated_at":"2023-10-23T15:04:25Z","author_association":"CONTRIBUTOR","body":"yes I would skip over all the files of a rewrite snapshot.\r\n\r\nalso I've noticed here when you calculate the `latestOffset` you call `skippedManifestIndexesFromSnapshot`.\r\n\r\nhttps://github.com/apache/iceberg/blob/e2b56daf35724700a9b57dbeee5fe23f99c592c4/spark/v3.4/spark/src/main/java/org/apache/iceberg/spark/source/SparkMicroBatchStream.java#L350\r\n\r\nHowever, that function does not skip over rewrite snapshots. I think it should?\r\n\r\nand here, I'm not sure why you add the current number of files to your `currentFileIndex ` counter.\r\n\r\nhttps://github.com/apache/iceberg/blob/e2b56daf35724700a9b57dbeee5fe23f99c592c4/core/src/main/java/org/apache/iceberg/MicroBatches.java#L95\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775412513/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775478787","html_url":"https://github.com/apache/iceberg/pull/8905#issuecomment-1775478787","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8905","id":1775478787,"node_id":"IC_kwDOCW7NX85p06gD","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-23T15:37:02Z","updated_at":"2023-10-23T15:37:02Z","author_association":"CONTRIBUTOR","body":"I'll close this out since this was already done by https://github.com/apache/iceberg/pull/8886","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775478787/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775485225","html_url":"https://github.com/apache/iceberg/pull/8906#issuecomment-1775485225","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8906","id":1775485225,"node_id":"IC_kwDOCW7NX85p08Ep","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-23T15:40:30Z","updated_at":"2023-10-23T15:40:30Z","author_association":"CONTRIBUTOR","body":"I believe we typically don't update RevAPI to patch versions (at least we haven't done so for 1.2.1 or 1.3.1 in the past)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775485225/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775495652","html_url":"https://github.com/apache/iceberg/pull/8906#issuecomment-1775495652","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8906","id":1775495652,"node_id":"IC_kwDOCW7NX85p0-nk","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-23T15:46:08Z","updated_at":"2023-10-23T15:46:08Z","author_association":"MEMBER","body":"> I believe we typically don't update RevAPI to patch versions (at least we haven't done so for 1.2.1 or 1.3.1 in the past)\r\n\r\nIt is because revAPI expects a tag from the main branch. For point release, the tags are not created from the main branch. Hence, revAPI doesn't work. \r\nhttps://github.com/apache/iceberg/pull/6102#issuecomment-1299800976","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775495652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775505118","html_url":"https://github.com/apache/iceberg/issues/7137#issuecomment-1775505118","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7137","id":1775505118,"node_id":"IC_kwDOCW7NX85p1A7e","user":{"login":"erikcw","id":113129,"node_id":"MDQ6VXNlcjExMzEyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/113129?v=4","gravatar_id":"","url":"https://api.github.com/users/erikcw","html_url":"https://github.com/erikcw","followers_url":"https://api.github.com/users/erikcw/followers","following_url":"https://api.github.com/users/erikcw/following{/other_user}","gists_url":"https://api.github.com/users/erikcw/gists{/gist_id}","starred_url":"https://api.github.com/users/erikcw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erikcw/subscriptions","organizations_url":"https://api.github.com/users/erikcw/orgs","repos_url":"https://api.github.com/users/erikcw/repos","events_url":"https://api.github.com/users/erikcw/events{/privacy}","received_events_url":"https://api.github.com/users/erikcw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-23T15:51:23Z","updated_at":"2023-10-23T15:51:23Z","author_association":"NONE","body":"I'm also experiencing this issue.  I'm on Trino version 430.\r\n\r\n```\r\nçorg.apache.iceberg.exceptions.RuntimeIOException: Failed to open file: s3://MY.BUCKET/parquet/campaigns-pre-id-iceberg/metadata/5e73263d-42dd-4e6a-af4b-3027ec72896a-m25.avro\r\n\tat org.apache.iceberg.avro.AvroIterable.newFileReader(AvroIterable.java:102)\r\n\tat org.apache.iceberg.avro.AvroIterable.iterator(AvroIterable.java:76)\r\n\tat org.apache.iceberg.io.CloseableIterable$7$1.<init>(CloseableIterable.java:188)\r\n\tat org.apache.iceberg.io.CloseableIterable$7.iterator(CloseableIterable.java:187)\r\n\tat org.apache.iceberg.io.CloseableIterable.lambda$filter$1(CloseableIterable.java:136)\r\n\tat org.apache.iceberg.io.CloseableIterable$2.iterator(CloseableIterable.java:72)\r\n\tat org.apache.iceberg.io.CloseableIterable.lambda$filter$1(CloseableIterable.java:136)\r\n\tat org.apache.iceberg.io.CloseableIterable$2.iterator(CloseableIterable.java:72)\r\n\tat org.apache.iceberg.io.CloseableIterable.lambda$filter$1(CloseableIterable.java:136)\r\n\tat org.apache.iceberg.io.CloseableIterable$2.iterator(CloseableIterable.java:72)\r\n\tat org.apache.iceberg.io.CloseableIterable$7$1.<init>(CloseableIterable.java:188)\r\n\tat org.apache.iceberg.io.CloseableIterable$7.iterator(CloseableIterable.java:187)\r\n\tat org.apache.iceberg.ManifestGroup$1.iterator(ManifestGroup.java:333)\r\n\tat org.apache.iceberg.ManifestGroup$1.iterator(ManifestGroup.java:291)\r\n\tat org.apache.iceberg.util.ParallelIterable$ParallelIterator.lambda$new$1(ParallelIterable.java:69)\r\n\tat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)\r\n\tat java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n\tat java.base/java.lang.Thread.run(Thread.java:833)\r\nCaused by: java.io.FileNotFoundException: File s3://MY.BUCKET/parquet/campaigns-pre-id-iceberg/metadata/5e73263d-42dd-4e6a-af4b-3027ec72896a-m25.avro not found: The specified key does not exist. (Service: Amazon S3; Status Code: 404; Error Code: NoSuchKey; Request ID: 3QPXD22DZE38NQK8; S3 Extended Request ID: i/+9xgHx+b4VsxsUDx2qz+qcm0dc8rDCxGObBEkliJxl7N3tV4Zq3MvHq7uWnVA5iqUdBBuN3mY=; Proxy: null) (Bucket: MY.BUCKET, Key: parquet/campaigns-pre-id-iceberg/metadata/5e73263d-42dd-4e6a-af4b-3027ec72896a-m25.avro)\r\n\tat io.trino.filesystem.hdfs.HdfsTrinoInputStream.read(HdfsTrinoInputStream.java:103)\r\n\tat io.trino.plugin.iceberg.fileio.ForwardingSeekableInputStream.read(ForwardingSeekableInputStream.java:66)\r\n\tat org.apache.iceberg.avro.AvroIO$AvroInputStreamAdapter.read(AvroIO.java:117)\r\n\tat org.apache.avro.file.DataFileReader.openReader(DataFileReader.java:65)\r\n\tat org.apache.iceberg.avro.AvroIterable.newFileReader(AvroIterable.java:100)\r\n\t... 19 more\r\nCaused by: java.io.FileNotFoundException: The specified key does not exist. (Service: Amazon S3; Status Code: 404; Error Code: NoSuchKey; Request ID: 3QPXD22DZE38NQK8; S3 Extended Request ID: i/+9xgHx+b4VsxsUDx2qz+qcm0dc8rDCxGObBEkliJxl7N3tV4Zq3MvHq7uWnVA5iqUdBBuN3mY=; Proxy: null) (Bucket: MY.BUCKET, Key: parquet/campaigns-pre-id-iceberg/metadata/5e73263d-42dd-4e6a-af4b-3027ec72896a-m25.avro)\r\n\tat io.trino.hdfs.s3.TrinoS3FileSystem.throwIfFileNotFound(TrinoS3FileSystem.java:2074)\r\n\tat io.trino.hdfs.s3.TrinoS3FileSystem$TrinoS3InputStream.lambda$openStream$2(TrinoS3FileSystem.java:1580)\r\n\tat io.trino.hdfs.s3.RetryDriver.run(RetryDriver.java:125)\r\n\tat io.trino.hdfs.s3.TrinoS3FileSystem$TrinoS3InputStream.openStream(TrinoS3FileSystem.java:1557)\r\n\tat io.trino.hdfs.s3.TrinoS3FileSystem$TrinoS3InputStream.openStream(TrinoS3FileSystem.java:1542)\r\n\tat io.trino.hdfs.s3.TrinoS3FileSystem$TrinoS3InputStream.seekStream(TrinoS3FileSystem.java:1535)\r\n\tat io.trino.hdfs.s3.TrinoS3FileSystem$TrinoS3InputStream.lambda$read$1(TrinoS3FileSystem.java:1479)\r\n\tat io.trino.hdfs.s3.RetryDriver.run(RetryDriver.java:125)\r\n\tat io.trino.hdfs.s3.TrinoS3FileSystem$TrinoS3InputStream.read(TrinoS3FileSystem.java:1478)\r\n\tat java.base/java.io.BufferedInputStream.fill(BufferedInputStream.java:244)\r\n\tat java.base/java.io.BufferedInputStream.read1(BufferedInputStream.java:284)\r\n\tat java.base/java.io.BufferedInputStream.read(BufferedInputStream.java:343)\r\n\tat java.base/java.io.DataInputStream.read(DataInputStream.java:151)\r\n\tat java.base/java.io.DataInputStream.read(DataInputStream.java:151)\r\n\tat io.trino.filesystem.hdfs.HdfsTrinoInputStream.read(HdfsTrinoInputStream.java:100)\r\n\t... 23 more\r\nCaused by: com.amazonaws.services.s3.model.AmazonS3Exception: The specified key does not exist. (Service: Amazon S3; Status Code: 404; Error Code: NoSuchKey; Request ID: 3QPXD22DZE38NQK8; S3 Extended Request ID: i/+9xgHx+b4VsxsUDx2qz+qcm0dc8rDCxGObBEkliJxl7N3tV4Zq3MvHq7uWnVA5iqUdBBuN3mY=; Proxy: null)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.handleErrorResponse(AmazonHttpClient.java:1879)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.handleServiceErrorResponse(AmazonHttpClient.java:1418)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeOneRequest(AmazonHttpClient.java:1387)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeHelper(AmazonHttpClient.java:1157)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.doExecute(AmazonHttpClient.java:814)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeWithTimer(AmazonHttpClient.java:781)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.execute(AmazonHttpClient.java:755)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.access$500(AmazonHttpClient.java:715)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutionBuilderImpl.execute(AmazonHttpClient.java:697)\r\n\tat com.amazonaws.http.AmazonHttpClient.execute(AmazonHttpClient.java:561)\r\n\tat com.amazonaws.http.AmazonHttpClient.execute(AmazonHttpClient.java:541)\r\n\tat com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:5520)\r\n\tat com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:5467)\r\n\tat com.amazonaws.services.s3.AmazonS3Client.getObject(AmazonS3Client.java:1554)\r\n\tat io.trino.hdfs.s3.TrinoS3FileSystem$TrinoS3InputStream.lambda$openStream$2(TrinoS3FileSystem.java:1563)\r\n\t... 36 more\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775505118/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775511123","html_url":"https://github.com/apache/iceberg/issues/8881#issuecomment-1775511123","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8881","id":1775511123,"node_id":"IC_kwDOCW7NX85p1CZT","user":{"login":"rakesh-das08","id":16017562,"node_id":"MDQ6VXNlcjE2MDE3NTYy","avatar_url":"https://avatars.githubusercontent.com/u/16017562?v=4","gravatar_id":"","url":"https://api.github.com/users/rakesh-das08","html_url":"https://github.com/rakesh-das08","followers_url":"https://api.github.com/users/rakesh-das08/followers","following_url":"https://api.github.com/users/rakesh-das08/following{/other_user}","gists_url":"https://api.github.com/users/rakesh-das08/gists{/gist_id}","starred_url":"https://api.github.com/users/rakesh-das08/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rakesh-das08/subscriptions","organizations_url":"https://api.github.com/users/rakesh-das08/orgs","repos_url":"https://api.github.com/users/rakesh-das08/repos","events_url":"https://api.github.com/users/rakesh-das08/events{/privacy}","received_events_url":"https://api.github.com/users/rakesh-das08/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-23T15:54:47Z","updated_at":"2023-10-23T15:56:16Z","author_association":"CONTRIBUTOR","body":"Few observations: \r\n1) There are 2 ways to work with branches: WAP or Branch Identifiers. IMO working with branch identifiers is much intuitive and easier. You can refer to a branch by using `db.table.branch_<your_branch_name>`\r\nSo once you use branch identifiers, you dont need to set `spark.wap.branch = 'validation-branch'`\r\n\r\n2) So if you are using branch identifiers, your merge and insert query can be re-written as below:\r\n```\r\nspark.sql(f\"\"\"\r\nMERGE INTO iceberg_catalog.db.employee.branch_validation_branch as T\r\nUSING \r\n    iceberg_catalog.db.employee_stg as S\r\nON T.employee_id = S.employee_id\r\nWHEN MATCHED and etl_state = 'current'\r\nTHEN UPDATE \r\n    SET etl_state='history',\r\n        eff_end_dt=S.load_date\r\n\"\"\")\r\nspark.sql(f\"\"\"\r\nINSERT INTO iceberg_catalog.db.employee.branch_validation_branch\r\nselect  employee_id, name, salary, load_date, date('9999-12-31'), 'current'\r\nfrom iceberg_catalog.db.employee_stg\r\n\"\"\")\r\n```\r\n\r\n3) Your `fast_forward` procedure seems to be using a different schema and table than the ones defined above.\r\nSo your `fast_forward` procedure call should look something like :\r\n```\r\nspark.sql(\"\"\"CALL iceberg_catalog.system.fast_forward('iceberg_catalog.db.employee', 'main', 'validation_branch')\"\"\")\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775511123/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775630259","html_url":"https://github.com/apache/iceberg/issues/8910#issuecomment-1775630259","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8910","id":1775630259,"node_id":"IC_kwDOCW7NX85p1fez","user":{"login":"mayankasthana","id":2264215,"node_id":"MDQ6VXNlcjIyNjQyMTU=","avatar_url":"https://avatars.githubusercontent.com/u/2264215?v=4","gravatar_id":"","url":"https://api.github.com/users/mayankasthana","html_url":"https://github.com/mayankasthana","followers_url":"https://api.github.com/users/mayankasthana/followers","following_url":"https://api.github.com/users/mayankasthana/following{/other_user}","gists_url":"https://api.github.com/users/mayankasthana/gists{/gist_id}","starred_url":"https://api.github.com/users/mayankasthana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayankasthana/subscriptions","organizations_url":"https://api.github.com/users/mayankasthana/orgs","repos_url":"https://api.github.com/users/mayankasthana/repos","events_url":"https://api.github.com/users/mayankasthana/events{/privacy}","received_events_url":"https://api.github.com/users/mayankasthana/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-23T17:01:57Z","updated_at":"2023-10-23T17:01:57Z","author_association":"NONE","body":"Duplicate of https://github.com/apache/iceberg/issues/8862 so closing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775630259/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775822458","html_url":"https://github.com/apache/iceberg/issues/8911#issuecomment-1775822458","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8911","id":1775822458,"node_id":"IC_kwDOCW7NX85p2OZ6","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-23T18:51:06Z","updated_at":"2023-10-23T18:51:06Z","author_association":"MEMBER","body":"I think this could be done but the fix would have to be in Spark I believe. Spark needs to be able to convert Substring => StartsWith on their end","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775822458/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775871158","html_url":"https://github.com/apache/iceberg/issues/8911#issuecomment-1775871158","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8911","id":1775871158,"node_id":"IC_kwDOCW7NX85p2aS2","user":{"login":"tombarti","id":5863331,"node_id":"MDQ6VXNlcjU4NjMzMzE=","avatar_url":"https://avatars.githubusercontent.com/u/5863331?v=4","gravatar_id":"","url":"https://api.github.com/users/tombarti","html_url":"https://github.com/tombarti","followers_url":"https://api.github.com/users/tombarti/followers","following_url":"https://api.github.com/users/tombarti/following{/other_user}","gists_url":"https://api.github.com/users/tombarti/gists{/gist_id}","starred_url":"https://api.github.com/users/tombarti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tombarti/subscriptions","organizations_url":"https://api.github.com/users/tombarti/orgs","repos_url":"https://api.github.com/users/tombarti/repos","events_url":"https://api.github.com/users/tombarti/events{/privacy}","received_events_url":"https://api.github.com/users/tombarti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-23T19:18:15Z","updated_at":"2023-10-23T19:18:15Z","author_association":"NONE","body":"Thanks for the quick reply @RussellSpitzer, so what you are saying is that this really should be implemented in Spark and once it is, there is nothing much to do on the Iceberg side?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775871158/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775880284","html_url":"https://github.com/apache/iceberg/issues/8911#issuecomment-1775880284","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8911","id":1775880284,"node_id":"IC_kwDOCW7NX85p2chc","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-23T19:24:42Z","updated_at":"2023-10-23T19:26:52Z","author_association":"MEMBER","body":"Iceberg uses the Datasource API from Spark, so we only see filters and expressions that Spark decides to pass through to us. In this case \"substring\" is just not an expression it can push through. What it can push through is \"StartsWith\" so in Spark we would want an analysis rule that converted Substring(1, X) => StartsWith.\r\n\r\n\r\nAnother possible avenue to support this sort of thing would be to use the Iceberg truncate expression and an in clause. That may be possible in just Iceberg.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775880284/reactions","total_count":3,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":2,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775911356","html_url":"https://github.com/apache/iceberg/issues/8911#issuecomment-1775911356","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8911","id":1775911356,"node_id":"IC_kwDOCW7NX85p2kG8","user":{"login":"tombarti","id":5863331,"node_id":"MDQ6VXNlcjU4NjMzMzE=","avatar_url":"https://avatars.githubusercontent.com/u/5863331?v=4","gravatar_id":"","url":"https://api.github.com/users/tombarti","html_url":"https://github.com/tombarti","followers_url":"https://api.github.com/users/tombarti/followers","following_url":"https://api.github.com/users/tombarti/following{/other_user}","gists_url":"https://api.github.com/users/tombarti/gists{/gist_id}","starred_url":"https://api.github.com/users/tombarti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tombarti/subscriptions","organizations_url":"https://api.github.com/users/tombarti/orgs","repos_url":"https://api.github.com/users/tombarti/repos","events_url":"https://api.github.com/users/tombarti/events{/privacy}","received_events_url":"https://api.github.com/users/tombarti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-23T19:46:58Z","updated_at":"2023-10-23T19:46:58Z","author_association":"NONE","body":"Thanks for taking the time to explain, that all makes sense now!\r\n\r\nI can see that #7886 in Iceberg 1.4.0 could be handful for the other avenue you are suggesting!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1775911356/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1776250753","html_url":"https://github.com/apache/iceberg/issues/7187#issuecomment-1776250753","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7187","id":1776250753,"node_id":"IC_kwDOCW7NX85p32-B","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T00:10:46Z","updated_at":"2023-10-24T00:10:46Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1776250753/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1776250781","html_url":"https://github.com/apache/iceberg/issues/7186#issuecomment-1776250781","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7186","id":1776250781,"node_id":"IC_kwDOCW7NX85p32-d","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T00:10:49Z","updated_at":"2023-10-24T00:10:49Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1776250781/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1776385634","html_url":"https://github.com/apache/iceberg/issues/8901#issuecomment-1776385634","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8901","id":1776385634,"node_id":"IC_kwDOCW7NX85p4X5i","user":{"login":"lurnagao-dahua","id":91278331,"node_id":"MDQ6VXNlcjkxMjc4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/91278331?v=4","gravatar_id":"","url":"https://api.github.com/users/lurnagao-dahua","html_url":"https://github.com/lurnagao-dahua","followers_url":"https://api.github.com/users/lurnagao-dahua/followers","following_url":"https://api.github.com/users/lurnagao-dahua/following{/other_user}","gists_url":"https://api.github.com/users/lurnagao-dahua/gists{/gist_id}","starred_url":"https://api.github.com/users/lurnagao-dahua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lurnagao-dahua/subscriptions","organizations_url":"https://api.github.com/users/lurnagao-dahua/orgs","repos_url":"https://api.github.com/users/lurnagao-dahua/repos","events_url":"https://api.github.com/users/lurnagao-dahua/events{/privacy}","received_events_url":"https://api.github.com/users/lurnagao-dahua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T02:08:55Z","updated_at":"2023-10-24T02:08:55Z","author_association":"CONTRIBUTOR","body":"Hi, In Hive3，DML operations work only with MapReduce execution engine. Bad performance of the MR execution engine","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1776385634/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1776639925","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1776639925","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1776639925,"node_id":"IC_kwDOCW7NX85p5V-1","user":{"login":"JanKaul","id":19823005,"node_id":"MDQ6VXNlcjE5ODIzMDA1","avatar_url":"https://avatars.githubusercontent.com/u/19823005?v=4","gravatar_id":"","url":"https://api.github.com/users/JanKaul","html_url":"https://github.com/JanKaul","followers_url":"https://api.github.com/users/JanKaul/followers","following_url":"https://api.github.com/users/JanKaul/following{/other_user}","gists_url":"https://api.github.com/users/JanKaul/gists{/gist_id}","starred_url":"https://api.github.com/users/JanKaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JanKaul/subscriptions","organizations_url":"https://api.github.com/users/JanKaul/orgs","repos_url":"https://api.github.com/users/JanKaul/repos","events_url":"https://api.github.com/users/JanKaul/events{/privacy}","received_events_url":"https://api.github.com/users/JanKaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T07:03:02Z","updated_at":"2023-10-24T07:03:02Z","author_association":"NONE","body":"I've updated the issue description and the google doc (https://docs.google.com/document/d/1UnhldHhe3Grz8JBngwXPA6ZZord1xMedY5ukEhZYF-A/edit?usp=sharing).\r\n\r\nI would love to get your feedback. @liurenjie1024 @jackye1995 @wmoustafa @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1776639925/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1776642611","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1776642611","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1776642611,"node_id":"IC_kwDOCW7NX85p5Woz","user":{"login":"JanKaul","id":19823005,"node_id":"MDQ6VXNlcjE5ODIzMDA1","avatar_url":"https://avatars.githubusercontent.com/u/19823005?v=4","gravatar_id":"","url":"https://api.github.com/users/JanKaul","html_url":"https://github.com/JanKaul","followers_url":"https://api.github.com/users/JanKaul/followers","following_url":"https://api.github.com/users/JanKaul/following{/other_user}","gists_url":"https://api.github.com/users/JanKaul/gists{/gist_id}","starred_url":"https://api.github.com/users/JanKaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JanKaul/subscriptions","organizations_url":"https://api.github.com/users/JanKaul/orgs","repos_url":"https://api.github.com/users/JanKaul/repos","events_url":"https://api.github.com/users/JanKaul/events{/privacy}","received_events_url":"https://api.github.com/users/JanKaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T07:05:34Z","updated_at":"2023-10-24T07:05:34Z","author_association":"NONE","body":"@wmoustafa I hope you are okay with using the table identifier as the storage table pointer instead of using the metadata location. But I don't see a way to use the metadata location with the REST catalog. And ultimately we require a robust solution that works across all catalogs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1776642611/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1776759965","html_url":"https://github.com/apache/iceberg/issues/8891#issuecomment-1776759965","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8891","id":1776759965,"node_id":"IC_kwDOCW7NX85p5zSd","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T08:31:29Z","updated_at":"2023-10-24T08:31:29Z","author_association":"CONTRIBUTOR","body":"@anvanna: Are you able to read the data from the Iceberg table with another tool? The issue with writing with Tez, that the newly created files are not propagated to the HS2 and they are not added to the commit. So it is absolutely possible that the files are there, and a new Iceberg snapshot is created, but this new snapshot does not contain the new files.\r\n\r\nI would like to reiterate that the Tez writes are not supported. Could you try using MR for the insert and then read with Tez?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1776759965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1776773140","html_url":"https://github.com/apache/iceberg/issues/8901#issuecomment-1776773140","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8901","id":1776773140,"node_id":"IC_kwDOCW7NX85p52gU","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T08:40:16Z","updated_at":"2023-10-24T08:40:16Z","author_association":"CONTRIBUTOR","body":"You might want to try Hive 4.0.0-beta-1 which has plenty of related performance improvements","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1776773140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1776773600","html_url":"https://github.com/apache/iceberg/issues/8901#issuecomment-1776773600","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8901","id":1776773600,"node_id":"IC_kwDOCW7NX85p52ng","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T08:40:33Z","updated_at":"2023-10-24T08:40:33Z","author_association":"CONTRIBUTOR","body":"Also Iceberg is included out-of-the-box","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1776773600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1777000677","html_url":"https://github.com/apache/iceberg/issues/7938#issuecomment-1777000677","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7938","id":1777000677,"node_id":"IC_kwDOCW7NX85p6uDl","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T11:10:19Z","updated_at":"2023-10-24T11:10:19Z","author_association":"CONTRIBUTOR","body":"@singhpk234 I was planning to pick up https://github.com/apache/spark/pull/39796, but I don't know yet whether we'd want to integrate those temporarily into Iceberg until they make it into Spark","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1777000677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1777461016","html_url":"https://github.com/apache/iceberg/issues/5384#issuecomment-1777461016","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5384","id":1777461016,"node_id":"IC_kwDOCW7NX85p8ecY","user":{"login":"sanromeo","id":44975602,"node_id":"MDQ6VXNlcjQ0OTc1NjAy","avatar_url":"https://avatars.githubusercontent.com/u/44975602?v=4","gravatar_id":"","url":"https://api.github.com/users/sanromeo","html_url":"https://github.com/sanromeo","followers_url":"https://api.github.com/users/sanromeo/followers","following_url":"https://api.github.com/users/sanromeo/following{/other_user}","gists_url":"https://api.github.com/users/sanromeo/gists{/gist_id}","starred_url":"https://api.github.com/users/sanromeo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sanromeo/subscriptions","organizations_url":"https://api.github.com/users/sanromeo/orgs","repos_url":"https://api.github.com/users/sanromeo/repos","events_url":"https://api.github.com/users/sanromeo/events{/privacy}","received_events_url":"https://api.github.com/users/sanromeo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T15:17:21Z","updated_at":"2023-10-24T15:17:21Z","author_association":"NONE","body":"Have same issue","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1777461016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1777589163","html_url":"https://github.com/apache/iceberg/issues/8904#issuecomment-1777589163","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8904","id":1777589163,"node_id":"IC_kwDOCW7NX85p89ur","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T16:22:22Z","updated_at":"2023-10-24T16:22:22Z","author_association":"CONTRIBUTOR","body":"cc @aokolnychyi @RussellSpitzer \r\n\r\nSeems we need to turn this `useCommitCoordinator` off. Here is the [discussion](https://github.com/apache/spark/pull/36564#issuecomment-1774214202). Do you have any concern of switching this off? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1777589163/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1777764930","html_url":"https://github.com/apache/iceberg/issues/8913#issuecomment-1777764930","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8913","id":1777764930,"node_id":"IC_kwDOCW7NX85p9opC","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T18:09:31Z","updated_at":"2023-10-24T18:09:31Z","author_association":"CONTRIBUTOR","body":"Thanks @asheeshgarg for raising this. The PyIceberg repository has been moved to https://github.com/apache/iceberg-python. To get the quickest answers, it is best to raise the question over there.\r\n\r\nWe recently merged a PR that fixes this when reading Avro fields: https://github.com/apache/iceberg-python/pull/83\r\n\r\nCan you try if this issue still persists on the main branch? You can easily install it using:\r\n\r\n```sh\r\npip install \"git+https://github.com/apache/iceberg-python.git#egg=pyiceberg[arrow]\"\r\n```\r\n\r\nIf you run into anything, could you also share the error? Thanks 🙌 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1777764930/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1777819176","html_url":"https://github.com/apache/iceberg/issues/5556#issuecomment-1777819176","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5556","id":1777819176,"node_id":"IC_kwDOCW7NX85p914o","user":{"login":"FabricioZGalvani","id":125269274,"node_id":"U_kgDOB3d1Gg","avatar_url":"https://avatars.githubusercontent.com/u/125269274?v=4","gravatar_id":"","url":"https://api.github.com/users/FabricioZGalvani","html_url":"https://github.com/FabricioZGalvani","followers_url":"https://api.github.com/users/FabricioZGalvani/followers","following_url":"https://api.github.com/users/FabricioZGalvani/following{/other_user}","gists_url":"https://api.github.com/users/FabricioZGalvani/gists{/gist_id}","starred_url":"https://api.github.com/users/FabricioZGalvani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FabricioZGalvani/subscriptions","organizations_url":"https://api.github.com/users/FabricioZGalvani/orgs","repos_url":"https://api.github.com/users/FabricioZGalvani/repos","events_url":"https://api.github.com/users/FabricioZGalvani/events{/privacy}","received_events_url":"https://api.github.com/users/FabricioZGalvani/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T18:41:32Z","updated_at":"2023-10-24T18:41:32Z","author_association":"NONE","body":"Any updates on this feature? I also have a strong interest in iceberg providing this solution.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1777819176/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1777822435","html_url":"https://github.com/apache/iceberg/issues/5556#issuecomment-1777822435","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5556","id":1777822435,"node_id":"IC_kwDOCW7NX85p92rj","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T18:43:44Z","updated_at":"2023-10-24T18:43:44Z","author_association":"MEMBER","body":"Anyone who would like to work on the issue is welcome to, there is currently no one I know working on it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1777822435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1777824236","html_url":"https://github.com/apache/iceberg/issues/8908#issuecomment-1777824236","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8908","id":1777824236,"node_id":"IC_kwDOCW7NX85p93Hs","user":{"login":"FabricioZGalvani","id":125269274,"node_id":"U_kgDOB3d1Gg","avatar_url":"https://avatars.githubusercontent.com/u/125269274?v=4","gravatar_id":"","url":"https://api.github.com/users/FabricioZGalvani","html_url":"https://github.com/FabricioZGalvani","followers_url":"https://api.github.com/users/FabricioZGalvani/followers","following_url":"https://api.github.com/users/FabricioZGalvani/following{/other_user}","gists_url":"https://api.github.com/users/FabricioZGalvani/gists{/gist_id}","starred_url":"https://api.github.com/users/FabricioZGalvani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FabricioZGalvani/subscriptions","organizations_url":"https://api.github.com/users/FabricioZGalvani/orgs","repos_url":"https://api.github.com/users/FabricioZGalvani/repos","events_url":"https://api.github.com/users/FabricioZGalvani/events{/privacy}","received_events_url":"https://api.github.com/users/FabricioZGalvani/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T18:44:57Z","updated_at":"2023-10-24T18:44:57Z","author_association":"NONE","body":"I'm facing the same issue when trying to use pyspark with mergeSchema; i get the error of columns being out of order.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1777824236/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1777826448","html_url":"https://github.com/apache/iceberg/issues/8908#issuecomment-1777826448","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8908","id":1777826448,"node_id":"IC_kwDOCW7NX85p93qQ","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T18:46:23Z","updated_at":"2023-10-24T18:46:23Z","author_association":"MEMBER","body":"https://iceberg.apache.org/docs/latest/spark-writes/#schema-merge \r\nPlease make sure you are setting all the appropriate properties","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1777826448/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1777840610","html_url":"https://github.com/apache/iceberg/pull/8683#issuecomment-1777840610","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8683","id":1777840610,"node_id":"IC_kwDOCW7NX85p97Hi","user":{"login":"jacobmarble","id":622263,"node_id":"MDQ6VXNlcjYyMjI2Mw==","avatar_url":"https://avatars.githubusercontent.com/u/622263?v=4","gravatar_id":"","url":"https://api.github.com/users/jacobmarble","html_url":"https://github.com/jacobmarble","followers_url":"https://api.github.com/users/jacobmarble/followers","following_url":"https://api.github.com/users/jacobmarble/following{/other_user}","gists_url":"https://api.github.com/users/jacobmarble/gists{/gist_id}","starred_url":"https://api.github.com/users/jacobmarble/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jacobmarble/subscriptions","organizations_url":"https://api.github.com/users/jacobmarble/orgs","repos_url":"https://api.github.com/users/jacobmarble/repos","events_url":"https://api.github.com/users/jacobmarble/events{/privacy}","received_events_url":"https://api.github.com/users/jacobmarble/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T18:55:35Z","updated_at":"2023-10-24T18:55:35Z","author_association":"CONTRIBUTOR","body":"@rdblue @Fokko what concerns remain regarding this change?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1777840610/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1778246891","html_url":"https://github.com/apache/iceberg/issues/8863#issuecomment-1778246891","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8863","id":1778246891,"node_id":"IC_kwDOCW7NX85p_eTr","user":{"login":"Omega359","id":226258,"node_id":"MDQ6VXNlcjIyNjI1OA==","avatar_url":"https://avatars.githubusercontent.com/u/226258?v=4","gravatar_id":"","url":"https://api.github.com/users/Omega359","html_url":"https://github.com/Omega359","followers_url":"https://api.github.com/users/Omega359/followers","following_url":"https://api.github.com/users/Omega359/following{/other_user}","gists_url":"https://api.github.com/users/Omega359/gists{/gist_id}","starred_url":"https://api.github.com/users/Omega359/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Omega359/subscriptions","organizations_url":"https://api.github.com/users/Omega359/orgs","repos_url":"https://api.github.com/users/Omega359/repos","events_url":"https://api.github.com/users/Omega359/events{/privacy}","received_events_url":"https://api.github.com/users/Omega359/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-24T23:57:14Z","updated_at":"2023-10-24T23:57:14Z","author_association":"CONTRIBUTOR","body":"I've just encountered this exception as well but the circumstances are somewhat different. One process is writing out an iceberg table primarily via appends with the occasional delete. Upon completion a new cluster is spun up that reads that table. This issue presented itself during that process:\r\n\r\n```\r\n23/10/24 22:25:51 ERROR BaseReader: Error reading file(s): s3://vdcint-transaction-dev-txn/AR_IDw/dev/transaction_2023_10_ndleq8xl/source_alias=MC3/transaction_date_year=2016/00081-10437993-40ecbe40-af70-41a4-9fde-61bc6a6abeb2-00001.parquet\r\njava.lang.IllegalArgumentException: requirement failed: length (-135733377) cannot be smaller than -1\r\n\tat scala.Predef$.require(Predef.scala:281) ~[scala-library-2.12.15.jar:?]\r\n\tat org.apache.spark.rdd.InputFileBlockHolder$.set(InputFileBlockHolder.scala:79) ~[spark-core_2.12-3.4.1-amzn-1.jar:3.4.1-amzn-1]\r\n\tat org.apache.spark.rdd.InputFileBlockHolder.set(InputFileBlockHolder.scala) ~[spark-core_2.12-3.4.1-amzn-1.jar:3.4.1-amzn-1]\r\n\tat org.apache.iceberg.spark.source.BatchDataReader.open(BatchDataReader.java:89) ~[app.jar:?]\r\n\tat org.apache.iceberg.spark.source.BatchDataReader.open(BatchDataReader.java:41) ~[app.jar:?]\r\n\tat org.apache.iceberg.spark.source.BaseReader.next(BaseReader.java:141) ~[app.jar:?]\r\n\tat org.apache.spark.sql.execution.datasources.v2.PartitionIterator.hasNext(DataSourceRDD.scala:120) ~[spark-sql_2.12-3.4.1-amzn-1.jar:3.4.1-amzn-1]\r\n\tat org.apache.spark.sql.execution.datasources.v2.MetricsIterator.hasNext(DataSourceRDD.scala:158) ~[spark-sql_2.12-3.4.1-amzn-1.jar:3.4.1-amzn-1]\r\n\tat org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.$anonfun$hasNext$1(DataSourceRDD.scala:63) ~[spark-sql_2.12-3.4.1-amzn-1.jar:3.4.1-amzn-1]\r\n\tat org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.$anonfun$hasNext$1$adapted(DataSourceRDD.scala:63) ~[spark-sql_2.12-3.4.1-amzn-1.jar:3.4.1-amzn-1]\r\n\tat scala.Option.exists(Option.scala:376) ~[scala-library-2.12.15.jar:?]\r\n\tat org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.hasNext(DataSourceRDD.scala:63) ~[spark-sql_2.12-3.4.1-amzn-1.jar:3.4.1-amzn-1]\r\n\tat org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37) ~[spark-core_2.12-3.4.1-amzn-1.jar:3.4.1-amzn-1]\r\n\tat scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460) ~[scala-library-2.12.15.jar:?]\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage4.columnartorow_nextBatch_0$(Unknown Source) ~[?:?]\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage4.hashAgg_doAggregateWithoutKey_0$(Unknown Source) ~[?:?]\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage4.processNext(Unknown Source) ~[?:?]\r\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:35) ~[spark-sql_2.12-3.4.1-amzn-1.jar:3.4.1-amzn-1]\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage4.hasNext(Unknown Source) ~[?:?]\r\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:959) ~[spark-sql_2.12-3.4.1-amzn-1.jar:3.4.1-amzn-1]\r\n\tat scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460) ~[scala-library-2.12.15.jar:?]\r\n\tat org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:142) ~[spark-core_2.12-3.4.1-amzn-1.jar:3.4.1-amzn-1]\r\n\tat org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59) ~[spark-core_2.12-3.4.1-amzn-1.jar:3.4.1-amzn-1]\r\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:101) ~[spark-core_2.12-3.4.1-amzn-1.jar:3.4.1-amzn-1]\r\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:53) ~[spark-core_2.12-3.4.1-amzn-1.jar:3.4.1-amzn-1]\r\n\tat org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161) ~[spark-core_2.12-3.4.1-amzn-1.jar:3.4.1-amzn-1]\r\n\tat org.apache.spark.scheduler.Task.run(Task.scala:141) ~[spark-core_2.12-3.4.1-amzn-1.jar:3.4.1-amzn-1]\r\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:554) ~[spark-core_2.12-3.4.1-amzn-1.jar:3.4.1-amzn-1]\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1541) ~[spark-core_2.12-3.4.1-amzn-1.jar:3.4.1-amzn-1]\r\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:557) ~[spark-core_2.12-3.4.1-amzn-1.jar:3.4.1-amzn-1]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]\r\n\tat java.lang.Thread.run(Thread.java:833) ~[?:?]\r\n``` \r\nIceberg 1.4.0, Spark 3.4.1 (EMR 6.14.0), JDK 17.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1778246891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1778259989","html_url":"https://github.com/apache/iceberg/issues/7452#issuecomment-1778259989","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7452","id":1778259989,"node_id":"IC_kwDOCW7NX85p_hgV","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T00:10:37Z","updated_at":"2023-10-25T00:10:37Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1778259989/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1778260018","html_url":"https://github.com/apache/iceberg/issues/7446#issuecomment-1778260018","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7446","id":1778260018,"node_id":"IC_kwDOCW7NX85p_hgy","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T00:10:39Z","updated_at":"2023-10-25T00:10:39Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1778260018/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1778260107","html_url":"https://github.com/apache/iceberg/issues/7340#issuecomment-1778260107","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7340","id":1778260107,"node_id":"IC_kwDOCW7NX85p_hiL","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T00:10:45Z","updated_at":"2023-10-25T00:10:45Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1778260107/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1778260143","html_url":"https://github.com/apache/iceberg/issues/7325#issuecomment-1778260143","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7325","id":1778260143,"node_id":"IC_kwDOCW7NX85p_hiv","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T00:10:47Z","updated_at":"2023-10-25T00:10:47Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1778260143/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1778282237","html_url":"https://github.com/apache/iceberg/pull/8914#issuecomment-1778282237","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8914","id":1778282237,"node_id":"IC_kwDOCW7NX85p_m79","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T00:32:48Z","updated_at":"2023-10-25T00:32:48Z","author_association":"CONTRIBUTOR","body":"cc @amogh-jahagirdar @nastra seems like a miss in the spec, unless the OpenAPI error response requires the `error` nesting by default, but I did not find any reference of that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1778282237/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1778670668","html_url":"https://github.com/apache/iceberg/pull/8870#issuecomment-1778670668","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8870","id":1778670668,"node_id":"IC_kwDOCW7NX85qBFxM","user":{"login":"okayhooni","id":81631424,"node_id":"MDQ6VXNlcjgxNjMxNDI0","avatar_url":"https://avatars.githubusercontent.com/u/81631424?v=4","gravatar_id":"","url":"https://api.github.com/users/okayhooni","html_url":"https://github.com/okayhooni","followers_url":"https://api.github.com/users/okayhooni/followers","following_url":"https://api.github.com/users/okayhooni/following{/other_user}","gists_url":"https://api.github.com/users/okayhooni/gists{/gist_id}","starred_url":"https://api.github.com/users/okayhooni/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/okayhooni/subscriptions","organizations_url":"https://api.github.com/users/okayhooni/orgs","repos_url":"https://api.github.com/users/okayhooni/repos","events_url":"https://api.github.com/users/okayhooni/events{/privacy}","received_events_url":"https://api.github.com/users/okayhooni/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T07:25:59Z","updated_at":"2023-10-25T07:25:59Z","author_association":"NONE","body":"@amogh-jahagirdar \r\n\r\nSorry for the late response and thanks to handle this issue..!\r\n\r\nYes, there is a trailing slash on the database location, as you said..! so, your commit will handle the issue..! thank you!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1778670668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1778946237","html_url":"https://github.com/apache/iceberg/issues/8908#issuecomment-1778946237","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8908","id":1778946237,"node_id":"IC_kwDOCW7NX85qCJC9","user":{"login":"josgarmar14","id":46621941,"node_id":"MDQ6VXNlcjQ2NjIxOTQx","avatar_url":"https://avatars.githubusercontent.com/u/46621941?v=4","gravatar_id":"","url":"https://api.github.com/users/josgarmar14","html_url":"https://github.com/josgarmar14","followers_url":"https://api.github.com/users/josgarmar14/followers","following_url":"https://api.github.com/users/josgarmar14/following{/other_user}","gists_url":"https://api.github.com/users/josgarmar14/gists{/gist_id}","starred_url":"https://api.github.com/users/josgarmar14/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/josgarmar14/subscriptions","organizations_url":"https://api.github.com/users/josgarmar14/orgs","repos_url":"https://api.github.com/users/josgarmar14/repos","events_url":"https://api.github.com/users/josgarmar14/events{/privacy}","received_events_url":"https://api.github.com/users/josgarmar14/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T10:15:45Z","updated_at":"2023-10-25T10:15:45Z","author_association":"NONE","body":"I think everything is correct. Once the table is created I execute:\r\n\r\n```\r\nquery = f\"\"\"ALTER TABLE job_catalog.{args['glue_db']}.{args['glue_iceberg_tablename']} SET TBLPROPERTIES ('write.spark.accept-any-schema'='true')\"\"\"\r\nspark.sql(query)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1778946237/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1779110745","html_url":"https://github.com/apache/iceberg/issues/8902#issuecomment-1779110745","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8902","id":1779110745,"node_id":"IC_kwDOCW7NX85qCxNZ","user":{"login":"cccs-jc","id":56140112,"node_id":"MDQ6VXNlcjU2MTQwMTEy","avatar_url":"https://avatars.githubusercontent.com/u/56140112?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-jc","html_url":"https://github.com/cccs-jc","followers_url":"https://api.github.com/users/cccs-jc/followers","following_url":"https://api.github.com/users/cccs-jc/following{/other_user}","gists_url":"https://api.github.com/users/cccs-jc/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-jc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-jc/subscriptions","organizations_url":"https://api.github.com/users/cccs-jc/orgs","repos_url":"https://api.github.com/users/cccs-jc/repos","events_url":"https://api.github.com/users/cccs-jc/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-jc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T11:59:10Z","updated_at":"2023-10-25T11:59:10Z","author_association":"CONTRIBUTOR","body":"@singhpk234 just a few quick questions. see above.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1779110745/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1779218865","html_url":"https://github.com/apache/iceberg/pull/8878#issuecomment-1779218865","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8878","id":1779218865,"node_id":"IC_kwDOCW7NX85qDLmx","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T12:57:20Z","updated_at":"2023-10-25T12:58:11Z","author_association":"CONTRIBUTOR","body":"> I didn't find the rules to decide when to rebase and when to squash the PR in the docs. Are they both used/needed, or only the squash?\r\n\r\nThe squash and merge is the normal way of merging PRs. Rebase and merge is sometime used for very big PRs where we want to split it up a bit (for example, adding support for a new version of Spark as in https://github.com/apache/iceberg/pull/8571). Maybe we should add this to the docs as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1779218865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1779220520","html_url":"https://github.com/apache/iceberg/pull/8878#issuecomment-1779220520","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8878","id":1779220520,"node_id":"IC_kwDOCW7NX85qDMAo","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T12:58:14Z","updated_at":"2023-10-25T12:58:14Z","author_association":"CONTRIBUTOR","body":"Thanks everyone for the review and comment 👍 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1779220520/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1779475302","html_url":"https://github.com/apache/iceberg/issues/7317#issuecomment-1779475302","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7317","id":1779475302,"node_id":"IC_kwDOCW7NX85qEKNm","user":{"login":"matthijseikelenboom","id":1364843,"node_id":"MDQ6VXNlcjEzNjQ4NDM=","avatar_url":"https://avatars.githubusercontent.com/u/1364843?v=4","gravatar_id":"","url":"https://api.github.com/users/matthijseikelenboom","html_url":"https://github.com/matthijseikelenboom","followers_url":"https://api.github.com/users/matthijseikelenboom/followers","following_url":"https://api.github.com/users/matthijseikelenboom/following{/other_user}","gists_url":"https://api.github.com/users/matthijseikelenboom/gists{/gist_id}","starred_url":"https://api.github.com/users/matthijseikelenboom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matthijseikelenboom/subscriptions","organizations_url":"https://api.github.com/users/matthijseikelenboom/orgs","repos_url":"https://api.github.com/users/matthijseikelenboom/repos","events_url":"https://api.github.com/users/matthijseikelenboom/events{/privacy}","received_events_url":"https://api.github.com/users/matthijseikelenboom/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T15:00:41Z","updated_at":"2023-10-25T15:00:41Z","author_association":"NONE","body":"I also get this error. The situation is as follows: We have a Spark data lake with data in it and now want to apply Iceberg to it. When running this migrate procedure when trying to change Spark parquet tables to Iceberg tables, we also get this error.\r\n\r\n@singhpk234 Are you saying I should add that line to the config or should I change my current `spark.sql.catalog.iceberghadoop` to `org.apache.iceberg.spark.SparkSessionCatalog`?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1779475302/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1779669087","html_url":"https://github.com/apache/iceberg/pull/8914#issuecomment-1779669087","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8914","id":1779669087,"node_id":"IC_kwDOCW7NX85qE5hf","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T16:44:33Z","updated_at":"2023-10-25T16:44:33Z","author_association":"CONTRIBUTOR","body":"thanks for the fix, and thanks for the reviews!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1779669087/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1779741555","html_url":"https://github.com/apache/iceberg/pull/8906#issuecomment-1779741555","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8906","id":1779741555,"node_id":"IC_kwDOCW7NX85qFLNz","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T17:30:48Z","updated_at":"2023-10-25T17:30:48Z","author_association":"CONTRIBUTOR","body":"@ajantha-bhat thanks for the context, closing this one","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1779741555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780012237","html_url":"https://github.com/apache/iceberg/issues/8921#issuecomment-1780012237","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8921","id":1780012237,"node_id":"IC_kwDOCW7NX85qGNTN","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T20:33:36Z","updated_at":"2023-10-25T20:37:48Z","author_association":"CONTRIBUTOR","body":"I am not entirely sure why this would happen, i was under the impression that initialOffset() is used from checkpoint file and the way it's calculated is same as you stated above : \r\n\r\nhttps://github.com/apache/iceberg/blob/aa891acf20040d15e7ca59dc503adb3c1e4325b8/spark/v3.5/spark/src/main/java/org/apache/iceberg/spark/source/SparkMicroBatchStream.java#L112\r\n\r\n\r\nhttps://github.com/apache/iceberg/blob/aa891acf20040d15e7ca59dc503adb3c1e4325b8/spark/v3.5/spark/src/main/java/org/apache/iceberg/spark/source/SparkMicroBatchStream.java#L458\r\n\r\n\r\nIs there some caching that would be coming into picture for snapshot not found ? i think we have something like `SparkCachedTableCatalog` can you try making the ttl zero, just making a wild guess here., this might require deep-dive if we have a crisp steps of repro. \r\n\r\nAlso is it just a 1.3 issue or have you observed this in earlier version as well as the initialOffset calculation remains unchanged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780012237/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780015926","html_url":"https://github.com/apache/iceberg/issues/8902#issuecomment-1780015926","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8902","id":1780015926,"node_id":"IC_kwDOCW7NX85qGOM2","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T20:36:37Z","updated_at":"2023-10-25T20:36:37Z","author_association":"CONTRIBUTOR","body":"yes @cccs-jc i think the right way to skip over snapshots (for the overwrite ones) should be latestOffset Api so that we coud just say the new offset is the one ignoring un-necessary ones. \r\n\r\nWould you like to add a CL for the same? presently I am a bit tied up in some internal work should be able to pick this up sometime next week otherwise ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780015926/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780023262","html_url":"https://github.com/apache/iceberg/issues/8921#issuecomment-1780023262","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8921","id":1780023262,"node_id":"IC_kwDOCW7NX85qGP_e","user":{"login":"cccs-jc","id":56140112,"node_id":"MDQ6VXNlcjU2MTQwMTEy","avatar_url":"https://avatars.githubusercontent.com/u/56140112?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-jc","html_url":"https://github.com/cccs-jc","followers_url":"https://api.github.com/users/cccs-jc/followers","following_url":"https://api.github.com/users/cccs-jc/following{/other_user}","gists_url":"https://api.github.com/users/cccs-jc/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-jc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-jc/subscriptions","organizations_url":"https://api.github.com/users/cccs-jc/orgs","repos_url":"https://api.github.com/users/cccs-jc/repos","events_url":"https://api.github.com/users/cccs-jc/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-jc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T20:42:25Z","updated_at":"2023-10-25T20:42:25Z","author_association":"CONTRIBUTOR","body":"ya seems pretty clear that it should be picking up the offset from the checkpoint when it exists.\r\n\r\ncould this come into the picture. There are two checks about the timestamp here\r\nhttps://github.com/apache/iceberg/blob/aa891acf20040d15e7ca59dc503adb3c1e4325b8/spark/v3.5/spark/src/main/java/org/apache/iceberg/spark/source/SparkMicroBatchStream.java#L326\r\n\r\nand we do set rate limits on rows and on files.\r\npublic Offset latestOffset(Offset startOffset, ReadLimit limit) {\r\n\r\nI have only tested with 1.3.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780023262/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780029801","html_url":"https://github.com/apache/iceberg/issues/8902#issuecomment-1780029801","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8902","id":1780029801,"node_id":"IC_kwDOCW7NX85qGRlp","user":{"login":"cccs-jc","id":56140112,"node_id":"MDQ6VXNlcjU2MTQwMTEy","avatar_url":"https://avatars.githubusercontent.com/u/56140112?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-jc","html_url":"https://github.com/cccs-jc","followers_url":"https://api.github.com/users/cccs-jc/followers","following_url":"https://api.github.com/users/cccs-jc/following{/other_user}","gists_url":"https://api.github.com/users/cccs-jc/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-jc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-jc/subscriptions","organizations_url":"https://api.github.com/users/cccs-jc/orgs","repos_url":"https://api.github.com/users/cccs-jc/repos","events_url":"https://api.github.com/users/cccs-jc/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-jc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T20:47:12Z","updated_at":"2023-10-25T20:47:12Z","author_association":"CONTRIBUTOR","body":"a CL, that's a pull request?\r\n\r\nright now I'm trying to add unit tests but it's going slowly. I don't have too many free cycles..","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780029801/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780032370","html_url":"https://github.com/apache/iceberg/issues/8902#issuecomment-1780032370","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8902","id":1780032370,"node_id":"IC_kwDOCW7NX85qGSNy","user":{"login":"cccs-jc","id":56140112,"node_id":"MDQ6VXNlcjU2MTQwMTEy","avatar_url":"https://avatars.githubusercontent.com/u/56140112?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-jc","html_url":"https://github.com/cccs-jc","followers_url":"https://api.github.com/users/cccs-jc/followers","following_url":"https://api.github.com/users/cccs-jc/following{/other_user}","gists_url":"https://api.github.com/users/cccs-jc/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-jc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-jc/subscriptions","organizations_url":"https://api.github.com/users/cccs-jc/orgs","repos_url":"https://api.github.com/users/cccs-jc/repos","events_url":"https://api.github.com/users/cccs-jc/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-jc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T20:49:07Z","updated_at":"2023-10-25T20:49:07Z","author_association":"CONTRIBUTOR","body":"I did manage to reproduce the issue. So we'll see how it goes.\r\n```java\r\n\r\n@Test\r\n  public void testReadStreamWithSnapshotTypeReplaceIgnoresReplace() throws Exception {\r\n    // fill table with some data\r\n    List<List<SimpleRecord>> expected = TEST_DATA_MULTIPLE_SNAPSHOTS;\r\n    appendDataAsMultipleSnapshots(expected);\r\n\r\n    // this should create a snapshot with type Replace.\r\n    table.rewriteManifests().clusterBy(f -> 1).commit();\r\n    RewriteFiles rewrite = table.newRewrite();\r\n\r\n    Iterable<Snapshot> it = table.snapshots();\r\n    for (Snapshot snapshot : it) {\r\n      Iterable<DataFile> datafiles = snapshot.addedDataFiles(table.io());\r\n      for (DataFile datafile : datafiles) {\r\n        rewrite.addFile(datafile);\r\n        rewrite.deleteFile(datafile);\r\n      }\r\n    }\r\n    rewrite.commit();\r\n    \r\n    // check pre-condition\r\n    Assert.assertEquals(DataOperations.REPLACE, table.currentSnapshot().operation());\r\n\r\n    // StreamingQuery query = startStream();\r\n    // List<SimpleRecord> actual = rowsAvailable(query);\r\n    // Assertions.assertThat(actual).containsExactlyInAnyOrderElementsOf(Iterables.concat(expected));\r\n\r\n    Assert.assertEquals(\r\n        5,\r\n        microBatchCount(\r\n            ImmutableMap.of(SparkReadOptions.STREAMING_MAX_FILES_PER_MICRO_BATCH, \"1\")));\r\n\r\n    \r\n  }\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780032370/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780040874","html_url":"https://github.com/apache/iceberg/issues/8921#issuecomment-1780040874","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8921","id":1780040874,"node_id":"IC_kwDOCW7NX85qGUSq","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T20:55:51Z","updated_at":"2023-10-25T20:55:51Z","author_association":"CONTRIBUTOR","body":"I am not entirely sure still how would this give us or being us to snapshot id not found as the offset returned here would be pointing to -1 snapshot id but as you suggested earlier you get a valid snapshot id which did exist in the table.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780040874/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780043095","html_url":"https://github.com/apache/iceberg/issues/8902#issuecomment-1780043095","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8902","id":1780043095,"node_id":"IC_kwDOCW7NX85qGU1X","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-25T20:57:31Z","updated_at":"2023-10-25T20:57:31Z","author_association":"CONTRIBUTOR","body":"Ya sure take your time you are pretty close :) let me know if you need some help here, apologies I am short on bandwidth too due to upcoming re:invent.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780043095/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780223461","html_url":"https://github.com/apache/iceberg/issues/7461#issuecomment-1780223461","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7461","id":1780223461,"node_id":"IC_kwDOCW7NX85qHA3l","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-26T00:10:44Z","updated_at":"2023-10-26T00:10:44Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780223461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780223493","html_url":"https://github.com/apache/iceberg/issues/7455#issuecomment-1780223493","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7455","id":1780223493,"node_id":"IC_kwDOCW7NX85qHA4F","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-26T00:10:46Z","updated_at":"2023-10-26T00:10:46Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780223493/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780223574","html_url":"https://github.com/apache/iceberg/issues/7351#issuecomment-1780223574","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7351","id":1780223574,"node_id":"IC_kwDOCW7NX85qHA5W","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-26T00:10:52Z","updated_at":"2023-10-26T00:10:52Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780223574/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780243850","html_url":"https://github.com/apache/iceberg/pull/8803#issuecomment-1780243850","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8803","id":1780243850,"node_id":"IC_kwDOCW7NX85qHF2K","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-26T00:40:21Z","updated_at":"2023-10-26T00:40:44Z","author_association":"CONTRIBUTOR","body":"I took a quick look. My original guess was to do this in `ManifestReader` but it seems Peter is right: it should be sufficient to do this in `ManifestGroup` as we are using either `entries()` or `liveEntries()` and call `copy()`  in `ManifestGroup`, rather than relying on `iterator()` from `ManifestReader`.\r\n\r\nI'll check with fresh eyes tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780243850/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780377369","html_url":"https://github.com/apache/iceberg/issues/8863#issuecomment-1780377369","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8863","id":1780377369,"node_id":"IC_kwDOCW7NX85qHmcZ","user":{"login":"camper42","id":3177898,"node_id":"MDQ6VXNlcjMxNzc4OTg=","avatar_url":"https://avatars.githubusercontent.com/u/3177898?v=4","gravatar_id":"","url":"https://api.github.com/users/camper42","html_url":"https://github.com/camper42","followers_url":"https://api.github.com/users/camper42/followers","following_url":"https://api.github.com/users/camper42/following{/other_user}","gists_url":"https://api.github.com/users/camper42/gists{/gist_id}","starred_url":"https://api.github.com/users/camper42/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/camper42/subscriptions","organizations_url":"https://api.github.com/users/camper42/orgs","repos_url":"https://api.github.com/users/camper42/repos","events_url":"https://api.github.com/users/camper42/events{/privacy}","received_events_url":"https://api.github.com/users/camper42/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-26T03:58:47Z","updated_at":"2023-10-26T03:58:47Z","author_association":"NONE","body":"Can this caused by critical bug described in #8834 ? @bryanck \r\n\r\nIf it is, this issue could be closed","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1780377369/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1781549984","html_url":"https://github.com/apache/iceberg/pull/7412#issuecomment-1781549984","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7412","id":1781549984,"node_id":"IC_kwDOCW7NX85qMEug","user":{"login":"dchristle","id":5257839,"node_id":"MDQ6VXNlcjUyNTc4Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/5257839?v=4","gravatar_id":"","url":"https://api.github.com/users/dchristle","html_url":"https://github.com/dchristle","followers_url":"https://api.github.com/users/dchristle/followers","following_url":"https://api.github.com/users/dchristle/following{/other_user}","gists_url":"https://api.github.com/users/dchristle/gists{/gist_id}","starred_url":"https://api.github.com/users/dchristle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dchristle/subscriptions","organizations_url":"https://api.github.com/users/dchristle/orgs","repos_url":"https://api.github.com/users/dchristle/repos","events_url":"https://api.github.com/users/dchristle/events{/privacy}","received_events_url":"https://api.github.com/users/dchristle/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-26T17:34:26Z","updated_at":"2023-10-26T17:34:26Z","author_association":"CONTRIBUTOR","body":"> We released these code here (https://cloud.google.com/bigquery/docs/manage-open-source-metadata#connect-dataproc-vm):\r\n> \r\n> Iceberg 1.2.0: gs://spark-lib/biglake/biglake-catalog-iceberg1.2.0-0.1.1-with-dependencies.jar Iceberg 0.14.0: gs://spark-lib/biglake/biglake-catalog-iceberg0.14.0-0.1.1-with-dependencies.jar\r\n> \r\n> Feel free to try these before this PR is merged.\r\n\r\n@coufon @emkornfield Are there instructions on how to build the equivalent artifacts using this pull request, including dependencies (`with-dependencies`) & any shading? It would be nice to use a jar built with 1.4.x as a dependency when using Iceberg 1.4.x. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1781549984/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1781867237","html_url":"https://github.com/apache/iceberg/pull/8925#issuecomment-1781867237","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8925","id":1781867237,"node_id":"IC_kwDOCW7NX85qNSLl","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-26T20:42:28Z","updated_at":"2023-10-26T20:42:28Z","author_association":"CONTRIBUTOR","body":"@amogh-jahagirdar, maybe this time we should create a test to validate `FileScanTask.split` when there are bad split offsets? I think that would have caught this in the last PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1781867237/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782035943","html_url":"https://github.com/apache/iceberg/pull/8683#issuecomment-1782035943","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8683","id":1782035943,"node_id":"IC_kwDOCW7NX85qN7Xn","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-26T23:09:57Z","updated_at":"2023-10-26T23:09:57Z","author_association":"CONTRIBUTOR","body":"@jacobmarble sorry for the delay, I was travelling. I think we just need to call out more clearly that the new types are v3 only and can't be used in v2 without breaking forward compatibility. A footnote isn't quite enough.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782035943/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782099308","html_url":"https://github.com/apache/iceberg/issues/7160#issuecomment-1782099308","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7160","id":1782099308,"node_id":"IC_kwDOCW7NX85qOK1s","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-27T00:10:39Z","updated_at":"2023-10-27T00:10:39Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782099308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782123678","html_url":"https://github.com/apache/iceberg/pull/8924#issuecomment-1782123678","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8924","id":1782123678,"node_id":"IC_kwDOCW7NX85qOQye","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-27T00:44:39Z","updated_at":"2023-10-27T00:44:39Z","author_association":"CONTRIBUTOR","body":"Thank you @singhpk234 @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782123678/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782198625","html_url":"https://github.com/apache/iceberg/pull/8467#issuecomment-1782198625","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8467","id":1782198625,"node_id":"IC_kwDOCW7NX85qOjFh","user":{"login":"jerqi","id":8159038,"node_id":"MDQ6VXNlcjgxNTkwMzg=","avatar_url":"https://avatars.githubusercontent.com/u/8159038?v=4","gravatar_id":"","url":"https://api.github.com/users/jerqi","html_url":"https://github.com/jerqi","followers_url":"https://api.github.com/users/jerqi/followers","following_url":"https://api.github.com/users/jerqi/following{/other_user}","gists_url":"https://api.github.com/users/jerqi/gists{/gist_id}","starred_url":"https://api.github.com/users/jerqi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerqi/subscriptions","organizations_url":"https://api.github.com/users/jerqi/orgs","repos_url":"https://api.github.com/users/jerqi/repos","events_url":"https://api.github.com/users/jerqi/events{/privacy}","received_events_url":"https://api.github.com/users/jerqi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-27T02:40:31Z","updated_at":"2023-10-27T02:40:31Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi @RussellSpitzer Gently ping.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782198625/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782313012","html_url":"https://github.com/apache/iceberg/issues/8930#issuecomment-1782313012","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8930","id":1782313012,"node_id":"IC_kwDOCW7NX85qO_A0","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-27T05:23:09Z","updated_at":"2023-10-27T05:23:09Z","author_association":"CONTRIBUTOR","body":"I am concerned about the dependency tree of the flink/v1.17 module. If the flink-common depends on Flink 1.18, and the flink/v1.17 depends on flink-common, then we will have a transitive dependency on Flink 1.18. We can exclude the dependency, but how can we make sure that everything works as expected without running the tests.\r\nAlso this would mean that we need to predict the changes in Flink when deciding what to put into the flink-common package, and what to keep in the version specific packages. As an alternative we can move these classes around every time when it is needed - but this approach has its own maintenance costs.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782313012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782354754","html_url":"https://github.com/apache/iceberg/issues/8927#issuecomment-1782354754","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8927","id":1782354754,"node_id":"IC_kwDOCW7NX85qPJNC","user":{"login":"nk1506","id":4146188,"node_id":"MDQ6VXNlcjQxNDYxODg=","avatar_url":"https://avatars.githubusercontent.com/u/4146188?v=4","gravatar_id":"","url":"https://api.github.com/users/nk1506","html_url":"https://github.com/nk1506","followers_url":"https://api.github.com/users/nk1506/followers","following_url":"https://api.github.com/users/nk1506/following{/other_user}","gists_url":"https://api.github.com/users/nk1506/gists{/gist_id}","starred_url":"https://api.github.com/users/nk1506/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nk1506/subscriptions","organizations_url":"https://api.github.com/users/nk1506/orgs","repos_url":"https://api.github.com/users/nk1506/repos","events_url":"https://api.github.com/users/nk1506/events{/privacy}","received_events_url":"https://api.github.com/users/nk1506/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-27T06:12:47Z","updated_at":"2023-10-27T06:12:47Z","author_association":"CONTRIBUTOR","body":"@dyno , as per log message \r\n\r\n> W1024 22:07:51.303 pool-38-thread-273   o.a.i.s.s.SparkWrite:226] Skipping cleanup of written files\r\n\r\nIt means files should not be deleted. \r\nAm I missing something here ? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782354754/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782356812","html_url":"https://github.com/apache/iceberg/pull/8909#issuecomment-1782356812","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8909","id":1782356812,"node_id":"IC_kwDOCW7NX85qPJtM","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-27T06:14:59Z","updated_at":"2023-10-27T06:14:59Z","author_association":"MEMBER","body":"PR is ready for review. \r\ncc: @nastra, @dimas-b, @snazy, @adutra    ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782356812/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782418606","html_url":"https://github.com/apache/iceberg/issues/7317#issuecomment-1782418606","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7317","id":1782418606,"node_id":"IC_kwDOCW7NX85qPYyu","user":{"login":"tomtongue","id":43331405,"node_id":"MDQ6VXNlcjQzMzMxNDA1","avatar_url":"https://avatars.githubusercontent.com/u/43331405?v=4","gravatar_id":"","url":"https://api.github.com/users/tomtongue","html_url":"https://github.com/tomtongue","followers_url":"https://api.github.com/users/tomtongue/followers","following_url":"https://api.github.com/users/tomtongue/following{/other_user}","gists_url":"https://api.github.com/users/tomtongue/gists{/gist_id}","starred_url":"https://api.github.com/users/tomtongue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomtongue/subscriptions","organizations_url":"https://api.github.com/users/tomtongue/orgs","repos_url":"https://api.github.com/users/tomtongue/repos","events_url":"https://api.github.com/users/tomtongue/events{/privacy}","received_events_url":"https://api.github.com/users/tomtongue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-27T07:16:25Z","updated_at":"2023-10-27T07:16:25Z","author_association":"CONTRIBUTOR","body":"Sorry for jumping in. I personally investigated the migrate query issue for GlueCatalog, so let me share my investigation result.\r\n\r\n## Result\r\nCurrently, it’s NOT possible to run `migrate` query for Spark/Hive tables in Glue Data Catalog. The reason of this is that GlueCatalog client doesn’t support renaming tables currently. \r\nLet me elaborate that below. If I’m wrong, please correct me.\r\n\r\n## Details\r\nWhen running the `migrate`  query for a Spark/Hive table in Glue Data Catalog, as described above, the `SparkSessionCatalog` configuration should be specified like `  .config(\"spark.sql.catalog.spark_catalog\", \"org.apache.iceberg.spark.SparkSessionCatalog\")`.\r\n\r\nIn this case, the source table in the `migrate` query like `table => '$db.$table'` is always set to `spark_catalog` (if other catalog is specified, the Spark application will fail).\r\n\r\nFor this, in the current design of `migrate` , the code path always goes through [`SparkSessionCatalog.renameTable`](https://github.com/apache/iceberg/blob/apache-iceberg-1.4.1/spark/v3.5/spark/src/main/java/org/apache/iceberg/spark/SparkSessionCatalog.java#L293) because as its specification, the `migrate`  creates a staging table, renames the source table to keep the table as backup, and then migrate the source table to Iceberg. After the migration, the back table is dropped or not based on the `drop_backup` parameter. In the phase of renaming the source table to keep the backup table, the `SparkSessionCatalog.renameTable` is called. \r\n\r\nThe `SparkSessionCatalog.renameTable` can handle the IcebergCatalog to rename the table in GlueCatalog, the method basically checks the source table and if the source table is Iceberg, then calls `IcebergCatalog.renameTable` (GlueCatalogImpl is specified here, so the `renameTable` in GlueCatalogImpl will be used). However, in this case, the source table always belongs to `spark_catalog`, therefore the code path always goes to `getSessionCatalog().renameTable` as follows:\r\n\r\nhttps://github.com/apache/iceberg/blob/apache-iceberg-1.4.1/spark/v3.5/spark/src/main/java/org/apache/iceberg/spark/SparkSessionCatalog.java#L293\r\n```java\r\n  @Override\r\n  public void renameTable(Identifier from, Identifier to)\r\n      throws NoSuchTableException, TableAlreadyExistsException {\r\n    // rename is not supported by HadoopCatalog. to avoid UnsupportedOperationException for session\r\n    // catalog tables,\r\n    // check table existence first to ensure that the table belongs to the Iceberg catalog.\r\n    if (icebergCatalog.tableExists(from)) {\r\n      icebergCatalog.renameTable(from, to);\r\n    } else {\r\n      getSessionCatalog().renameTable(from, to);  // <= THIS PATH\r\n    }\r\n  }\r\n\r\n```\r\n\r\n`getSessionCatalog().renameTable` calls Hive APIs for the table in Glue Data Catalog, so it fails due to renaming failure. \r\n\r\n\r\nHere’s the detail of calling flow (in Iceberg 1.4.1 with Spark 3.5):\r\n1. https://github.com/apache/iceberg/blob/apache-iceberg-1.4.1/spark/v3.5/spark/src/main/java/org/apache/iceberg/spark/procedures/MigrateTableProcedure.java#L76 -> Calls `MigrateTableSparkAction`\r\n2. https://github.com/apache/iceberg/blob/apache-iceberg-1.4.1/spark/v3.5/spark/src/main/java/org/apache/iceberg/spark/actions/MigrateTableSparkAction.java#L118 -> The actual migration impl\r\n   1. `renameAndBackupSourceTable()` is called to keep the backup\r\n   2. https://github.com/apache/iceberg/blob/apache-iceberg-1.4.1/spark/v3.5/spark/src/main/java/org/apache/iceberg/spark/actions/MigrateTableSparkAction.java#L209 -> `renameAndBackupSourceTable`. `destCatalog().renameTable(...)` will be called. But the `destCatalog()` is defined by `this.destCatalog = checkDestinationCatalog(sourceCatalog);` in the L66 in the same Class.\r\n3. https://github.com/apache/iceberg/blob/apache-iceberg-1.4.1/spark/v3.5/spark/src/main/java/org/apache/iceberg/spark/SparkSessionCatalog.java#L293 -> The `destCatalog` is `SparkSessionCatalog` in step 2, so the `getSessionCatalog().renameTable` will be called.\r\n\r\n## Resolution\r\nIf the GlueCatalog renameTable can be used to keep the backup table, it’s possible to run the `migrate`. To resolve this, for example, it’s possible to add a new option to specify the destination catalog.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782418606/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782599430","html_url":"https://github.com/apache/iceberg/pull/8683#issuecomment-1782599430","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8683","id":1782599430,"node_id":"IC_kwDOCW7NX85qQE8G","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-27T09:30:51Z","updated_at":"2023-10-27T09:30:51Z","author_association":"MEMBER","body":"> Now that we have separate types, we can use the type to carry that information, so that you can promote a `long` to `timestamp_ms` or `timestamp` and we know how to interpret the value.\r\n\r\nThat's true as long as there is only type promotion only once.\r\n\r\nWhat should happen when `timestamp_ms` is promoted to `timestamp`?\r\nIf it wasn't a `long` before, such promotion should be permitted.\r\nIf it was a `long` before... how do we handle this case?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782599430/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782660563","html_url":"https://github.com/apache/iceberg/issues/8902#issuecomment-1782660563","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8902","id":1782660563,"node_id":"IC_kwDOCW7NX85qQT3T","user":{"login":"cccs-jc","id":56140112,"node_id":"MDQ6VXNlcjU2MTQwMTEy","avatar_url":"https://avatars.githubusercontent.com/u/56140112?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-jc","html_url":"https://github.com/cccs-jc","followers_url":"https://api.github.com/users/cccs-jc/followers","following_url":"https://api.github.com/users/cccs-jc/following{/other_user}","gists_url":"https://api.github.com/users/cccs-jc/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-jc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-jc/subscriptions","organizations_url":"https://api.github.com/users/cccs-jc/orgs","repos_url":"https://api.github.com/users/cccs-jc/repos","events_url":"https://api.github.com/users/cccs-jc/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-jc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-27T10:15:15Z","updated_at":"2023-10-27T10:15:15Z","author_association":"CONTRIBUTOR","body":"@singhpk234  do you know why the `existingFilesCount` are added to the count. Seems like it should only add the number of `addedFilesCount` .\r\n\r\nhttps://github.com/apache/iceberg/blob/e2b56daf35724700a9b57dbeee5fe23f99c592c4/core/src/main/java/org/apache/iceberg/MicroBatches.java#L95\r\n\r\nIn the test cases there are no snapshot with multiple manifest list so I'm not 100% sure it's correct or not.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782660563/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782759994","html_url":"https://github.com/apache/iceberg/issues/8932#issuecomment-1782759994","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8932","id":1782759994,"node_id":"IC_kwDOCW7NX85qQsI6","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-27T11:33:52Z","updated_at":"2023-10-27T11:33:52Z","author_association":"MEMBER","body":"Do you have a flame graph or some evidence of this? My gut would say that would be a trivial check","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782759994/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782883251","html_url":"https://github.com/apache/iceberg/issues/8930#issuecomment-1782883251","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8930","id":1782883251,"node_id":"IC_kwDOCW7NX85qRKOz","user":{"login":"YesOrNo828","id":6017591,"node_id":"MDQ6VXNlcjYwMTc1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/6017591?v=4","gravatar_id":"","url":"https://api.github.com/users/YesOrNo828","html_url":"https://github.com/YesOrNo828","followers_url":"https://api.github.com/users/YesOrNo828/followers","following_url":"https://api.github.com/users/YesOrNo828/following{/other_user}","gists_url":"https://api.github.com/users/YesOrNo828/gists{/gist_id}","starred_url":"https://api.github.com/users/YesOrNo828/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YesOrNo828/subscriptions","organizations_url":"https://api.github.com/users/YesOrNo828/orgs","repos_url":"https://api.github.com/users/YesOrNo828/repos","events_url":"https://api.github.com/users/YesOrNo828/events{/privacy}","received_events_url":"https://api.github.com/users/YesOrNo828/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-27T13:04:18Z","updated_at":"2023-10-27T13:04:18Z","author_association":"NONE","body":"> then we will have a transitive dependency on Flink 1.18. We can exclude the dependency, but how can we make sure that everything works as expected without running the tests. \r\n\r\nYou're right. There'll be a transitive dependency. If Flink1.17's APIs are incompatible with Flink1.18, I think we can copy some tests into the Flink1.17 module to ensure it works fine and add end-to-end tests to guarantee compatibility with different Flink versions\r\n\r\n> As an alternative we can move these classes around every time when it is needed - but this approach has its own maintenance costs. \r\n\r\nAs of Flink 1.18, released a few days ago, the Flink community has externalized the [JDBC](https://github.com/apache/flink-connector-jdbc), [ES](https://github.com/apache/flink-connector-elasticsearch), [Kafka](https://github.com/apache/flink-connector-kafka), [pulsar](https://github.com/apache/flink-connector-pulsar), [HBase](https://github.com/apache/flink-connector-hbase), and so on connectors. That means the Flink API has become more compatible. So I think this maintenance cost between different Flink versions is acceptable.\r\n ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782883251/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782901768","html_url":"https://github.com/apache/iceberg/pull/8934#issuecomment-1782901768","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8934","id":1782901768,"node_id":"IC_kwDOCW7NX85qROwI","user":{"login":"cccs-jc","id":56140112,"node_id":"MDQ6VXNlcjU2MTQwMTEy","avatar_url":"https://avatars.githubusercontent.com/u/56140112?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-jc","html_url":"https://github.com/cccs-jc","followers_url":"https://api.github.com/users/cccs-jc/followers","following_url":"https://api.github.com/users/cccs-jc/following{/other_user}","gists_url":"https://api.github.com/users/cccs-jc/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-jc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-jc/subscriptions","organizations_url":"https://api.github.com/users/cccs-jc/orgs","repos_url":"https://api.github.com/users/cccs-jc/repos","events_url":"https://api.github.com/users/cccs-jc/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-jc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-27T13:17:12Z","updated_at":"2023-10-27T13:17:12Z","author_association":"CONTRIBUTOR","body":"not ready","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1782901768/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783179835","html_url":"https://github.com/apache/iceberg/issues/4129#issuecomment-1783179835","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4129","id":1783179835,"node_id":"IC_kwDOCW7NX85qSSo7","user":{"login":"l20DfX35JnKBfRn","id":91458857,"node_id":"MDQ6VXNlcjkxNDU4ODU3","avatar_url":"https://avatars.githubusercontent.com/u/91458857?v=4","gravatar_id":"","url":"https://api.github.com/users/l20DfX35JnKBfRn","html_url":"https://github.com/l20DfX35JnKBfRn","followers_url":"https://api.github.com/users/l20DfX35JnKBfRn/followers","following_url":"https://api.github.com/users/l20DfX35JnKBfRn/following{/other_user}","gists_url":"https://api.github.com/users/l20DfX35JnKBfRn/gists{/gist_id}","starred_url":"https://api.github.com/users/l20DfX35JnKBfRn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/l20DfX35JnKBfRn/subscriptions","organizations_url":"https://api.github.com/users/l20DfX35JnKBfRn/orgs","repos_url":"https://api.github.com/users/l20DfX35JnKBfRn/repos","events_url":"https://api.github.com/users/l20DfX35JnKBfRn/events{/privacy}","received_events_url":"https://api.github.com/users/l20DfX35JnKBfRn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-27T16:18:21Z","updated_at":"2023-10-27T16:18:21Z","author_association":"NONE","body":"If anyone is confused about this error on AWS Athena, unlike with hive-style file partitioning in S3 like `{table-s3-location}/year={}/month={}/day={}/`\r\n\r\nThe equivalent in iceberg, e.g.\r\n```SQL\r\nCREATE TABLE documents (\r\nid string,\r\ncreated_at timestamp\r\n...\r\n)\r\nPARTITIONED BY (\r\n\tday(created_at)\r\n\t);\r\nLOCATION 's3://{table-s3-location}/'\r\nTBLPROPERTIES ('table_type' = 'ICEBERG');\r\n```\r\n\r\nThis will create separate partitions for each day exactly like hive","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783179835/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783184731","html_url":"https://github.com/apache/iceberg/pull/8683#issuecomment-1783184731","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8683","id":1783184731,"node_id":"IC_kwDOCW7NX85qST1b","user":{"login":"jacobmarble","id":622263,"node_id":"MDQ6VXNlcjYyMjI2Mw==","avatar_url":"https://avatars.githubusercontent.com/u/622263?v=4","gravatar_id":"","url":"https://api.github.com/users/jacobmarble","html_url":"https://github.com/jacobmarble","followers_url":"https://api.github.com/users/jacobmarble/followers","following_url":"https://api.github.com/users/jacobmarble/following{/other_user}","gists_url":"https://api.github.com/users/jacobmarble/gists{/gist_id}","starred_url":"https://api.github.com/users/jacobmarble/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jacobmarble/subscriptions","organizations_url":"https://api.github.com/users/jacobmarble/orgs","repos_url":"https://api.github.com/users/jacobmarble/repos","events_url":"https://api.github.com/users/jacobmarble/events{/privacy}","received_events_url":"https://api.github.com/users/jacobmarble/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-27T16:22:10Z","updated_at":"2023-10-27T16:22:10Z","author_association":"CONTRIBUTOR","body":"> > Now that we have separate types, we can use the type to carry that information, so that you can promote a `long` to `timestamp_ms` or `timestamp` and we know how to interpret the value.\r\n> \r\n> That's true as long as there is only type promotion only once.\r\n> \r\n> What should happen when `timestamp_ms` is promoted to `timestamp`? If it wasn't a `long` before, such promotion should be permitted. If it was a `long` before... how do we handle this case?\r\n\r\nFWIW, the millisecond timestamp types (`timestamp_ms`, `timestamptz_ms`) have been removed from this change.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783184731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783460277","html_url":"https://github.com/apache/iceberg/pull/8683#issuecomment-1783460277","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8683","id":1783460277,"node_id":"IC_kwDOCW7NX85qTXG1","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-27T20:20:04Z","updated_at":"2023-10-27T20:20:04Z","author_association":"MEMBER","body":"@jacobmarble indeed, thanks!\r\ndo we expect any type promotions being allowed around the new types being added here?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783460277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783496227","html_url":"https://github.com/apache/iceberg/pull/8925#issuecomment-1783496227","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8925","id":1783496227,"node_id":"IC_kwDOCW7NX85qTf4j","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-27T20:49:05Z","updated_at":"2023-10-27T20:49:05Z","author_association":"CONTRIBUTOR","body":"> @amogh-jahagirdar, maybe this time we should create a test to validate FileScanTask.split when there are bad split offsets? I think that would have caught this in the last PR.\r\n\r\nDone, added a new test which will exercise both `splitOffsetArray` and `splitOffsets`. This will also validate the number of tasks per file","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783496227/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783512462","html_url":"https://github.com/apache/iceberg/issues/8745#issuecomment-1783512462","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8745","id":1783512462,"node_id":"IC_kwDOCW7NX85qTj2O","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-27T21:06:02Z","updated_at":"2023-10-27T21:06:02Z","author_association":"CONTRIBUTOR","body":"@JFinis I think this was in there so the schema didn't need to be deserialized. \r\n\r\n> Suggestion: Remove mentioning of field completely from the spec. It's redundant and the implementation doesn't seem to write it anyway.\r\n\r\nWDYT of creating a PR, and also raising this on the dev list?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783512462/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783584994","html_url":"https://github.com/apache/iceberg/pull/8922#issuecomment-1783584994","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8922","id":1783584994,"node_id":"IC_kwDOCW7NX85qT1ji","user":{"login":"jzhuge","id":1883812,"node_id":"MDQ6VXNlcjE4ODM4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1883812?v=4","gravatar_id":"","url":"https://api.github.com/users/jzhuge","html_url":"https://github.com/jzhuge","followers_url":"https://api.github.com/users/jzhuge/followers","following_url":"https://api.github.com/users/jzhuge/following{/other_user}","gists_url":"https://api.github.com/users/jzhuge/gists{/gist_id}","starred_url":"https://api.github.com/users/jzhuge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzhuge/subscriptions","organizations_url":"https://api.github.com/users/jzhuge/orgs","repos_url":"https://api.github.com/users/jzhuge/repos","events_url":"https://api.github.com/users/jzhuge/events{/privacy}","received_events_url":"https://api.github.com/users/jzhuge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-27T22:42:29Z","updated_at":"2023-10-27T22:42:29Z","author_association":"MEMBER","body":"The PR is ready for review.\r\n\r\nIf approved, we will follow up with doc update and backports to 3.4, 3.3, etc.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783584994/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783596341","html_url":"https://github.com/apache/iceberg/pull/8701#issuecomment-1783596341","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8701","id":1783596341,"node_id":"IC_kwDOCW7NX85qT4U1","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-27T23:01:19Z","updated_at":"2023-10-27T23:01:19Z","author_association":"CONTRIBUTOR","body":"I'm a +1 on moving forward with this.  I think there might still be an open question about Iceberg/Avro Schema definitions, but I'm fine with either resolution.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783596341/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783628604","html_url":"https://github.com/apache/iceberg/issues/7130#issuecomment-1783628604","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7130","id":1783628604,"node_id":"IC_kwDOCW7NX85qUAM8","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-28T00:10:28Z","updated_at":"2023-10-28T00:10:28Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783628604/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783634807","html_url":"https://github.com/apache/iceberg/issues/3044#issuecomment-1783634807","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3044","id":1783634807,"node_id":"IC_kwDOCW7NX85qUBt3","user":{"login":"rajcoolguy","id":148938762,"node_id":"U_kgDOCOCgCg","avatar_url":"https://avatars.githubusercontent.com/u/148938762?v=4","gravatar_id":"","url":"https://api.github.com/users/rajcoolguy","html_url":"https://github.com/rajcoolguy","followers_url":"https://api.github.com/users/rajcoolguy/followers","following_url":"https://api.github.com/users/rajcoolguy/following{/other_user}","gists_url":"https://api.github.com/users/rajcoolguy/gists{/gist_id}","starred_url":"https://api.github.com/users/rajcoolguy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajcoolguy/subscriptions","organizations_url":"https://api.github.com/users/rajcoolguy/orgs","repos_url":"https://api.github.com/users/rajcoolguy/repos","events_url":"https://api.github.com/users/rajcoolguy/events{/privacy}","received_events_url":"https://api.github.com/users/rajcoolguy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-28T00:25:10Z","updated_at":"2023-10-28T00:25:10Z","author_association":"NONE","body":"@mgmarino - how did you make this work in KDA, lacking documentation, i am either landing in to linkage error due to hadoop jars though i have shaded and relocated hadoop classes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783634807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783700784","html_url":"https://github.com/apache/iceberg/pull/8683#issuecomment-1783700784","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8683","id":1783700784,"node_id":"IC_kwDOCW7NX85qUR0w","user":{"login":"jacobmarble","id":622263,"node_id":"MDQ6VXNlcjYyMjI2Mw==","avatar_url":"https://avatars.githubusercontent.com/u/622263?v=4","gravatar_id":"","url":"https://api.github.com/users/jacobmarble","html_url":"https://github.com/jacobmarble","followers_url":"https://api.github.com/users/jacobmarble/followers","following_url":"https://api.github.com/users/jacobmarble/following{/other_user}","gists_url":"https://api.github.com/users/jacobmarble/gists{/gist_id}","starred_url":"https://api.github.com/users/jacobmarble/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jacobmarble/subscriptions","organizations_url":"https://api.github.com/users/jacobmarble/orgs","repos_url":"https://api.github.com/users/jacobmarble/repos","events_url":"https://api.github.com/users/jacobmarble/events{/privacy}","received_events_url":"https://api.github.com/users/jacobmarble/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-28T04:50:22Z","updated_at":"2023-10-28T04:50:22Z","author_association":"CONTRIBUTOR","body":"> @jacobmarble indeed, thanks! do we expect any type promotions being allowed around the new types being added here?\r\n\r\n@findepi when we discussed in the last community meeting, that was discussed. We agreed to scope this PR, and #8657 to just adding the type, and let type promotion be a separate issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783700784/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783712015","html_url":"https://github.com/apache/iceberg/issues/8930#issuecomment-1783712015","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8930","id":1783712015,"node_id":"IC_kwDOCW7NX85qUUkP","user":{"login":"YesOrNo828","id":6017591,"node_id":"MDQ6VXNlcjYwMTc1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/6017591?v=4","gravatar_id":"","url":"https://api.github.com/users/YesOrNo828","html_url":"https://github.com/YesOrNo828","followers_url":"https://api.github.com/users/YesOrNo828/followers","following_url":"https://api.github.com/users/YesOrNo828/following{/other_user}","gists_url":"https://api.github.com/users/YesOrNo828/gists{/gist_id}","starred_url":"https://api.github.com/users/YesOrNo828/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YesOrNo828/subscriptions","organizations_url":"https://api.github.com/users/YesOrNo828/orgs","repos_url":"https://api.github.com/users/YesOrNo828/repos","events_url":"https://api.github.com/users/YesOrNo828/events{/privacy}","received_events_url":"https://api.github.com/users/YesOrNo828/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-28T05:43:19Z","updated_at":"2023-10-28T05:43:19Z","author_association":"NONE","body":"The list supported Flink versions for each connector:\nhttps://flink.apache.org/downloads/#apache-flink-connectors\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783712015/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783720979","html_url":"https://github.com/apache/iceberg/issues/8927#issuecomment-1783720979","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8927","id":1783720979,"node_id":"IC_kwDOCW7NX85qUWwT","user":{"login":"dyno","id":7204,"node_id":"MDQ6VXNlcjcyMDQ=","avatar_url":"https://avatars.githubusercontent.com/u/7204?v=4","gravatar_id":"","url":"https://api.github.com/users/dyno","html_url":"https://github.com/dyno","followers_url":"https://api.github.com/users/dyno/followers","following_url":"https://api.github.com/users/dyno/following{/other_user}","gists_url":"https://api.github.com/users/dyno/gists{/gist_id}","starred_url":"https://api.github.com/users/dyno/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dyno/subscriptions","organizations_url":"https://api.github.com/users/dyno/orgs","repos_url":"https://api.github.com/users/dyno/repos","events_url":"https://api.github.com/users/dyno/events{/privacy}","received_events_url":"https://api.github.com/users/dyno/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-28T06:28:43Z","updated_at":"2023-10-28T06:28:43Z","author_association":"NONE","body":"probably the error message just means the data file and maniefst files but not the metadata location file? i am sure the medata location file was gone and from s3 access log the deletion was initiated by the same cluster at around the same time.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783720979/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783722052","html_url":"https://github.com/apache/iceberg/issues/8930#issuecomment-1783722052","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8930","id":1783722052,"node_id":"IC_kwDOCW7NX85qUXBE","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-28T06:34:22Z","updated_at":"2023-10-28T06:34:22Z","author_association":"CONTRIBUTOR","body":"> > then we will have a transitive dependency on Flink 1.18. We can exclude the dependency, but how can we make sure that everything works as expected without running the tests.\r\n> \r\n> You're right. There'll be a transitive dependency. If Flink1.17's APIs are incompatible with Flink1.18, I think we can copy some tests into the Flink1.17 module to ensure it works fine and add end-to-end tests to guarantee compatibility with different Flink versions\r\n\r\nI think the issue here, is that we can not be sure, which dependency needs to be copied over in advance.\r\n\r\nI tried to upgrade to Flink 1.18 yesterday, and found that there is a Flink change which causes the TestFlinkMetaDataTable#testAllFilesPartitioned test to fail. See: https://apache-flink.slack.com/archives/C03G7LJTS2G/p1698402761715879?thread_ts=1698402761.715879&cid=C03G7LJTS2G\r\n\r\nOne can argue that these issues are found at upgrade time, but if we add features between migration, then we will not find them, only if we run all of the tests.\r\n\r\nSo I think running all of the tests on every supported Flink version is a must.\r\n\r\n> > As an alternative we can move these classes around every time when it is needed - but this approach has its own maintenance costs.\r\n> \r\n> As of Flink 1.18, released a few days ago, the Flink community has externalized the [JDBC](https://github.com/apache/flink-connector-jdbc), [ES](https://github.com/apache/flink-connector-elasticsearch), [Kafka](https://github.com/apache/flink-connector-kafka), [pulsar](https://github.com/apache/flink-connector-pulsar), [HBase](https://github.com/apache/flink-connector-hbase), and so on connectors. That means the Flink API has become more compatible. So I think this maintenance cost between different Flink versions is acceptable.\r\n\r\nI am currently working on extending the Flink Sink API to provide features needed for Iceberg. See:\r\n- https://cwiki.apache.org/confluence/display/FLINK/FLIP-371%3A+Provide+initialization+context+for+Committer+creation+in+TwoPhaseCommittingSink\r\n- https://cwiki.apache.org/confluence/display/FLINK/FLIP-372%3A+Allow+TwoPhaseCommittingSink+WithPreCommitTopology+to+alter+the+type+of+the+Committable\r\n\r\nI would like to use them ASAP, and this will cause differences between 1.18/1.19 versions of the Iceberg connector. If we have flink-common, then until 1.18 this should be in common, after 1.19 it should go to the version specific code, and after we drop support for 1.18 then it will go to the common code again. Also we would need to come up with the appropriate abstractions for separate the changing code from the fix code. These issues might be even more pronounced when the Flink 2.0 comes out, of which the discussion is already started.\r\n\r\nIMHO these are more complex tasks than simply backporting the changes to the other branches. Maybe that is the cause why the Iceberg-Spark code is handled in the same way.\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783722052/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783724655","html_url":"https://github.com/apache/iceberg/issues/8927#issuecomment-1783724655","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8927","id":1783724655,"node_id":"IC_kwDOCW7NX85qUXpv","user":{"login":"dyno","id":7204,"node_id":"MDQ6VXNlcjcyMDQ=","avatar_url":"https://avatars.githubusercontent.com/u/7204?v=4","gravatar_id":"","url":"https://api.github.com/users/dyno","html_url":"https://github.com/dyno","followers_url":"https://api.github.com/users/dyno/followers","following_url":"https://api.github.com/users/dyno/following{/other_user}","gists_url":"https://api.github.com/users/dyno/gists{/gist_id}","starred_url":"https://api.github.com/users/dyno/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dyno/subscriptions","organizations_url":"https://api.github.com/users/dyno/orgs","repos_url":"https://api.github.com/users/dyno/repos","events_url":"https://api.github.com/users/dyno/events{/privacy}","received_events_url":"https://api.github.com/users/dyno/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-28T06:47:01Z","updated_at":"2023-10-28T06:47:01Z","author_association":"NONE","body":"or the main problem is iceberg should not update metadata location in hive metastore before the write is actually completed. and the symptom is write is failed but the metadata location is updated so even the metadata location file is not deleted, the table is not in a consistent state. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783724655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783900918","html_url":"https://github.com/apache/iceberg/pull/7710#issuecomment-1783900918","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7710","id":1783900918,"node_id":"IC_kwDOCW7NX85qVCr2","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-28T19:12:52Z","updated_at":"2023-10-28T19:12:52Z","author_association":"CONTRIBUTOR","body":"Sorry for the late review. This looks great. Thanks @Fokko!\r\n\r\nI didn't merge this in case it conflicts with the other linked PR. Feel free to merge in the order that makes the most sense.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783900918/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783905583","html_url":"https://github.com/apache/iceberg/pull/8683#issuecomment-1783905583","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8683","id":1783905583,"node_id":"IC_kwDOCW7NX85qVD0v","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-28T19:36:40Z","updated_at":"2023-10-28T19:36:40Z","author_association":"CONTRIBUTOR","body":"@findepi, for type promotion we decided to always interpret a promoted long as a millisecond value and the convert to either micros or nanos depending on the Iceberg type. Since we don't have a way to know what a long represents, there are problems no matter what we do and that's the best way to get predictable behavior. Otherwise, type promotion (i.e. timestamp_ms to a higher precision value) could corrupt data values that were previously working.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783905583/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783905941","html_url":"https://github.com/apache/iceberg/pull/8922#issuecomment-1783905941","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8922","id":1783905941,"node_id":"IC_kwDOCW7NX85qVD6V","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-28T19:38:19Z","updated_at":"2023-10-28T19:38:19Z","author_association":"CONTRIBUTOR","body":"@jzhuge, what is the rationale for this change? Iceberg has always ignored Spark's settings here.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783905941/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783910095","html_url":"https://github.com/apache/iceberg/pull/8704#issuecomment-1783910095","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8704","id":1783910095,"node_id":"IC_kwDOCW7NX85qVE7P","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-28T20:01:19Z","updated_at":"2023-10-28T20:01:19Z","author_association":"CONTRIBUTOR","body":"I'm going to close this. The reason why it was optional is that the `snapshot_id` can be inherited in v1 using a table setting to enable breaking forward compatibility.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783910095/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783948762","html_url":"https://github.com/apache/iceberg/issues/7492#issuecomment-1783948762","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7492","id":1783948762,"node_id":"IC_kwDOCW7NX85qVOXa","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-29T00:11:46Z","updated_at":"2023-10-29T00:11:46Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783948762/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783948766","html_url":"https://github.com/apache/iceberg/issues/7465#issuecomment-1783948766","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7465","id":1783948766,"node_id":"IC_kwDOCW7NX85qVOXe","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-29T00:11:48Z","updated_at":"2023-10-29T00:11:48Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783948766/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783948782","html_url":"https://github.com/apache/iceberg/issues/7393#issuecomment-1783948782","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7393","id":1783948782,"node_id":"IC_kwDOCW7NX85qVOXu","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-29T00:11:54Z","updated_at":"2023-10-29T00:11:54Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783948782/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783997110","html_url":"https://github.com/apache/iceberg/pull/8899#issuecomment-1783997110","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8899","id":1783997110,"node_id":"IC_kwDOCW7NX85qVaK2","user":{"login":"dependabot[bot]","id":49699333,"node_id":"MDM6Qm90NDk2OTkzMzM=","avatar_url":"https://avatars.githubusercontent.com/in/29110?v=4","gravatar_id":"","url":"https://api.github.com/users/dependabot%5Bbot%5D","html_url":"https://github.com/apps/dependabot","followers_url":"https://api.github.com/users/dependabot%5Bbot%5D/followers","following_url":"https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dependabot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/dependabot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/dependabot%5Bbot%5D/repos","events_url":"https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/dependabot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-29T04:41:39Z","updated_at":"2023-10-29T04:41:39Z","author_association":"CONTRIBUTOR","body":"Superseded by #8944.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1783997110/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1784285812","html_url":"https://github.com/apache/iceberg/issues/7371#issuecomment-1784285812","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7371","id":1784285812,"node_id":"IC_kwDOCW7NX85qWgp0","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-30T00:11:13Z","updated_at":"2023-10-30T00:11:13Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1784285812/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1784285827","html_url":"https://github.com/apache/iceberg/issues/7365#issuecomment-1784285827","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7365","id":1784285827,"node_id":"IC_kwDOCW7NX85qWgqD","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-10-30T00:11:15Z","updated_at":"2023-10-30T00:11:15Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1784285827/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1784354151","html_url":"https://github.com/apache/iceberg/issues/8949#issuecomment-1784354151","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8949","id":1784354151,"node_id":"IC_kwDOCW7NX85qWxVn","user":{"login":"manuzhang","id":1191767,"node_id":"MDQ6VXNlcjExOTE3Njc=","avatar_url":"https://avatars.githubusercontent.com/u/1191767?v=4","gravatar_id":"","url":"https://api.github.com/users/manuzhang","html_url":"https://github.com/manuzhang","followers_url":"https://api.github.com/users/manuzhang/followers","following_url":"https://api.github.com/users/manuzhang/following{/other_user}","gists_url":"https://api.github.com/users/manuzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/manuzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manuzhang/subscriptions","organizations_url":"https://api.github.com/users/manuzhang/orgs","repos_url":"https://api.github.com/users/manuzhang/repos","events_url":"https://api.github.com/users/manuzhang/events{/privacy}","received_events_url":"https://api.github.com/users/manuzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-30T01:50:54Z","updated_at":"2023-10-30T01:50:54Z","author_association":"COLLABORATOR","body":"@yabola  @aokolnychyi @nastra please kindly advise.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1784354151/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1784369261","html_url":"https://github.com/apache/iceberg/issues/8927#issuecomment-1784369261","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8927","id":1784369261,"node_id":"IC_kwDOCW7NX85qW1Bt","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-30T02:13:10Z","updated_at":"2023-10-30T02:13:10Z","author_association":"CONTRIBUTOR","body":"Please try to latest version. I think this problem has been fixed by https://github.com/apache/iceberg/pull/7931","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1784369261/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1784382828","html_url":"https://github.com/apache/iceberg/issues/5846#issuecomment-1784382828","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5846","id":1784382828,"node_id":"IC_kwDOCW7NX85qW4Vs","user":{"login":"chenwyi2","id":19389434,"node_id":"MDQ6VXNlcjE5Mzg5NDM0","avatar_url":"https://avatars.githubusercontent.com/u/19389434?v=4","gravatar_id":"","url":"https://api.github.com/users/chenwyi2","html_url":"https://github.com/chenwyi2","followers_url":"https://api.github.com/users/chenwyi2/followers","following_url":"https://api.github.com/users/chenwyi2/following{/other_user}","gists_url":"https://api.github.com/users/chenwyi2/gists{/gist_id}","starred_url":"https://api.github.com/users/chenwyi2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenwyi2/subscriptions","organizations_url":"https://api.github.com/users/chenwyi2/orgs","repos_url":"https://api.github.com/users/chenwyi2/repos","events_url":"https://api.github.com/users/chenwyi2/events{/privacy}","received_events_url":"https://api.github.com/users/chenwyi2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-30T02:34:16Z","updated_at":"2023-10-30T02:34:16Z","author_association":"NONE","body":"@lirui-apache how about controling snapshot expiration with retain_last or older_than parameter?  We can keep some snapshots and read max committed checkpoint id in this way.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1784382828/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]