[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1629687495","html_url":"https://github.com/apache/iceberg/issues/7822#issuecomment-1629687495","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7822","id":1629687495,"node_id":"IC_kwDOCW7NX85hIw7H","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-10T20:30:26Z","updated_at":"2023-07-10T20:30:26Z","author_association":"CONTRIBUTOR","body":"I feel like it is important to note that Iceberg tracks columns by ID and the latest assigned column ID is being tracked in the metadata. \r\n\r\n```\r\nspark.sql(\"ALTER TABLE s3_catalog.cdc.test DROP COLUMN name\")\r\nspark.sql('ALTER TABLE s3_catalog.cdc.test ADD COLUMN name string')\r\n```\r\n\r\nThe snippet above does NOT restore the original column. Instead, it adds a brand-new column with a fresh ID that happens to have the same name as one of the columns that were dropped earlier. That's why the CDC procedure, which acts according to the current schema, outputs nulls for `name` in old columns. From the Iceberg perspective, original files from the first snapshot did not have `name` as the column ID was different.\r\n\r\nThis behavior is intentional to avoid surprises when a column is dropped and a new one added a few years after and suddenly old data starts to appear in the query output. It is possible to restore an old column but it is not done via ALTER TABLE ADD/DROP COLUMN.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1629687495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1629782393","html_url":"https://github.com/apache/iceberg/pull/8015#issuecomment-1629782393","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8015","id":1629782393,"node_id":"IC_kwDOCW7NX85hJIF5","user":{"login":"mr-brobot","id":18426892,"node_id":"MDQ6VXNlcjE4NDI2ODky","avatar_url":"https://avatars.githubusercontent.com/u/18426892?v=4","gravatar_id":"","url":"https://api.github.com/users/mr-brobot","html_url":"https://github.com/mr-brobot","followers_url":"https://api.github.com/users/mr-brobot/followers","following_url":"https://api.github.com/users/mr-brobot/following{/other_user}","gists_url":"https://api.github.com/users/mr-brobot/gists{/gist_id}","starred_url":"https://api.github.com/users/mr-brobot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mr-brobot/subscriptions","organizations_url":"https://api.github.com/users/mr-brobot/orgs","repos_url":"https://api.github.com/users/mr-brobot/repos","events_url":"https://api.github.com/users/mr-brobot/events{/privacy}","received_events_url":"https://api.github.com/users/mr-brobot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-10T21:53:44Z","updated_at":"2023-07-10T21:53:44Z","author_association":"CONTRIBUTOR","body":"> It would be nice if a pool can be reused. Forking new processes for each new pool can be a costly operation\r\n\r\n@koenvo Reusing the executor is a good idea. I can create a separate issue for that and work on it next.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1629782393/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1629842315","html_url":"https://github.com/apache/iceberg/pull/8033#issuecomment-1629842315","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8033","id":1629842315,"node_id":"IC_kwDOCW7NX85hJWuL","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-10T22:57:24Z","updated_at":"2023-07-10T22:57:24Z","author_association":"COLLABORATOR","body":"Took a look and looks like transient error, re-starting it:\r\n\r\nTestStructuredStreamingRead3 > [catalogName = spark_catalog, implementation = org.apache.iceberg.spark.SparkSessionCatalog, config = {type=hive, default-namespace=default, parquet-enabled=true, cache-enabled=false}] > testReadingStreamFromFutureTimetsamp[catalogName = spark_catalog, implementation = org.apache.iceberg.spark.SparkSessionCatalog, config = {type=hive, default-namespace=default, parquet-enabled=true, cache-enabled=false}] FAILED\r\n    org.opentest4j.AssertionFailedError: \r\n    Expecting value to be true but was false","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1629842315/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1629904633","html_url":"https://github.com/apache/iceberg/issues/6519#issuecomment-1629904633","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6519","id":1629904633,"node_id":"IC_kwDOCW7NX85hJl75","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T00:13:31Z","updated_at":"2023-07-11T00:13:31Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1629904633/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1629912773","html_url":"https://github.com/apache/iceberg/pull/5774#issuecomment-1629912773","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5774","id":1629912773,"node_id":"IC_kwDOCW7NX85hJn7F","user":{"login":"bitsondatadev","id":8547669,"node_id":"MDQ6VXNlcjg1NDc2Njk=","avatar_url":"https://avatars.githubusercontent.com/u/8547669?v=4","gravatar_id":"","url":"https://api.github.com/users/bitsondatadev","html_url":"https://github.com/bitsondatadev","followers_url":"https://api.github.com/users/bitsondatadev/followers","following_url":"https://api.github.com/users/bitsondatadev/following{/other_user}","gists_url":"https://api.github.com/users/bitsondatadev/gists{/gist_id}","starred_url":"https://api.github.com/users/bitsondatadev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitsondatadev/subscriptions","organizations_url":"https://api.github.com/users/bitsondatadev/orgs","repos_url":"https://api.github.com/users/bitsondatadev/repos","events_url":"https://api.github.com/users/bitsondatadev/events{/privacy}","received_events_url":"https://api.github.com/users/bitsondatadev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T00:23:52Z","updated_at":"2023-07-11T00:23:52Z","author_association":"COLLABORATOR","body":"@findepi \n\n@rdblue says there's still some ambiguity. Rather than using `hashInt` that refers to the `hashLong(long(i))` you changed it to just `hashLong(...)`. But the cast is important.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1629912773/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1629973954","html_url":"https://github.com/apache/iceberg/pull/7933#issuecomment-1629973954","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7933","id":1629973954,"node_id":"IC_kwDOCW7NX85hJ23C","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T01:41:55Z","updated_at":"2023-07-11T01:41:55Z","author_association":"COLLABORATOR","body":"@RussellSpitzer @szehon-ho @ConeyLiu Can we add a doc like README and some flowchart to describe the commit logic? That may help later optimizations and reviews.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1629973954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1629978800","html_url":"https://github.com/apache/iceberg/issues/7937#issuecomment-1629978800","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7937","id":1629978800,"node_id":"IC_kwDOCW7NX85hJ4Cw","user":{"login":"LevisBale0824","id":46475641,"node_id":"MDQ6VXNlcjQ2NDc1NjQx","avatar_url":"https://avatars.githubusercontent.com/u/46475641?v=4","gravatar_id":"","url":"https://api.github.com/users/LevisBale0824","html_url":"https://github.com/LevisBale0824","followers_url":"https://api.github.com/users/LevisBale0824/followers","following_url":"https://api.github.com/users/LevisBale0824/following{/other_user}","gists_url":"https://api.github.com/users/LevisBale0824/gists{/gist_id}","starred_url":"https://api.github.com/users/LevisBale0824/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LevisBale0824/subscriptions","organizations_url":"https://api.github.com/users/LevisBale0824/orgs","repos_url":"https://api.github.com/users/LevisBale0824/repos","events_url":"https://api.github.com/users/LevisBale0824/events{/privacy}","received_events_url":"https://api.github.com/users/LevisBale0824/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T01:48:47Z","updated_at":"2023-07-11T01:48:47Z","author_association":"NONE","body":"the residual files you can try DeleteOrphanFiles","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1629978800/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1629994673","html_url":"https://github.com/apache/iceberg/pull/8002#issuecomment-1629994673","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8002","id":1629994673,"node_id":"IC_kwDOCW7NX85hJ76x","user":{"login":"joan38","id":1200478,"node_id":"MDQ6VXNlcjEyMDA0Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/1200478?v=4","gravatar_id":"","url":"https://api.github.com/users/joan38","html_url":"https://github.com/joan38","followers_url":"https://api.github.com/users/joan38/followers","following_url":"https://api.github.com/users/joan38/following{/other_user}","gists_url":"https://api.github.com/users/joan38/gists{/gist_id}","starred_url":"https://api.github.com/users/joan38/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joan38/subscriptions","organizations_url":"https://api.github.com/users/joan38/orgs","repos_url":"https://api.github.com/users/joan38/repos","events_url":"https://api.github.com/users/joan38/events{/privacy}","received_events_url":"https://api.github.com/users/joan38/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T02:11:43Z","updated_at":"2023-07-11T02:11:43Z","author_association":"CONTRIBUTOR","body":"Thanks for the review. Is there anyone who can merge this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1629994673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1630195194","html_url":"https://github.com/apache/iceberg/pull/8033#issuecomment-1630195194","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8033","id":1630195194,"node_id":"IC_kwDOCW7NX85hKs36","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T06:05:26Z","updated_at":"2023-07-11T06:05:26Z","author_association":"CONTRIBUTOR","body":"@szehon-ho yes we should also include that for 1.3.1. I'll open a separate PR with this fix cherry-picked to 1.3.x","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1630195194/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1630573846","html_url":"https://github.com/apache/iceberg/issues/4363#issuecomment-1630573846","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4363","id":1630573846,"node_id":"IC_kwDOCW7NX85hMJUW","user":{"login":"aajisaka","id":3403122,"node_id":"MDQ6VXNlcjM0MDMxMjI=","avatar_url":"https://avatars.githubusercontent.com/u/3403122?v=4","gravatar_id":"","url":"https://api.github.com/users/aajisaka","html_url":"https://github.com/aajisaka","followers_url":"https://api.github.com/users/aajisaka/followers","following_url":"https://api.github.com/users/aajisaka/following{/other_user}","gists_url":"https://api.github.com/users/aajisaka/gists{/gist_id}","starred_url":"https://api.github.com/users/aajisaka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aajisaka/subscriptions","organizations_url":"https://api.github.com/users/aajisaka/orgs","repos_url":"https://api.github.com/users/aajisaka/repos","events_url":"https://api.github.com/users/aajisaka/events{/privacy}","received_events_url":"https://api.github.com/users/aajisaka/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T10:29:08Z","updated_at":"2023-07-11T10:29:08Z","author_association":"MEMBER","body":"FYI\r\n\r\n> https://github.com/apache/spark/blob/v3.1.2/python/pyspark/sql/readwriter.py#L1496-L1525\r\n> missing \"self._jwriter.partitionedBy(col, cols)\"\r\n\r\nNice catch. This issue has been fixed in https://issues.apache.org/jira/browse/SPARK-37079","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1630573846/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1630854982","html_url":"https://github.com/apache/iceberg/pull/7942#issuecomment-1630854982","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7942","id":1630854982,"node_id":"IC_kwDOCW7NX85hNN9G","user":{"login":"dependabot[bot]","id":49699333,"node_id":"MDM6Qm90NDk2OTkzMzM=","avatar_url":"https://avatars.githubusercontent.com/in/29110?v=4","gravatar_id":"","url":"https://api.github.com/users/dependabot%5Bbot%5D","html_url":"https://github.com/apps/dependabot","followers_url":"https://api.github.com/users/dependabot%5Bbot%5D/followers","following_url":"https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dependabot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/dependabot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/dependabot%5Bbot%5D/repos","events_url":"https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/dependabot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T13:39:34Z","updated_at":"2023-07-11T13:39:34Z","author_association":"CONTRIBUTOR","body":"OK, I won't notify you again about this release, but will get in touch when a new version is available. If you'd rather skip all updates until the next major or minor version, let me know by commenting `@dependabot ignore this major version` or `@dependabot ignore this minor version`. You can also ignore all major, minor, or patch releases for a dependency by adding an [`ignore` condition](https://docs.github.com/en/code-security/supply-chain-security/configuration-options-for-dependency-updates#ignore) with the desired `update_types` to your config file.\n\nIf you change your mind, just re-open this PR and I'll resolve any conflicts on it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1630854982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1630878337","html_url":"https://github.com/apache/iceberg/pull/7991#issuecomment-1630878337","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7991","id":1630878337,"node_id":"IC_kwDOCW7NX85hNTqB","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T13:53:44Z","updated_at":"2023-07-11T13:53:44Z","author_association":"CONTRIBUTOR","body":"Thanks for fixing this @nastra ðŸ‘ðŸ» ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1630878337/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631176227","html_url":"https://github.com/apache/iceberg/pull/8037#issuecomment-1631176227","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8037","id":1631176227,"node_id":"IC_kwDOCW7NX85hOcYj","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T17:01:22Z","updated_at":"2023-07-11T17:01:22Z","author_association":"CONTRIBUTOR","body":"Thanks @nastra and @singhpk234 for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631176227/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631183637","html_url":"https://github.com/apache/iceberg/pull/7831#issuecomment-1631183637","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7831","id":1631183637,"node_id":"IC_kwDOCW7NX85hOeMV","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T17:06:50Z","updated_at":"2023-07-11T17:06:50Z","author_association":"CONTRIBUTOR","body":"For some reason my big comment was collapsed:\r\n\r\nSince Arrow is column-oriented, I'm sure that it will follow the order of the write schema:\r\n\r\n![image](https://github.com/apache/iceberg/assets/1134248/5dd5016e-7761-4cdc-a169-d3c4744c581b)\r\n\r\nThe reason I try to avoid using too many internal details from PyArrow is that we support PyArrow `[9.0.0, 12.0.1]` currently. There is no guarantee that all these internals stay the same, therefore I think we should do as much as possible within our own control (also regarding the internal Parquet types, or how the column names are structured).\r\n\r\nWe already have the write schema, so we can easily filter out the primitive types:\r\n\r\n```python\r\nclass PyArrowStatisticsCollector(PreOrderSchemaVisitor[List[StatisticsCollector]]):\r\n    _field_id = 0\r\n    _schema: Schema\r\n    _properties: Properties\r\n\r\n    def __init__(self, schema: Schema, properties: Dict[str, str]):\r\n        self._schema = schema\r\n        self._properties = properties\r\n\r\n    def schema(self, schema: Schema, struct_result: Callable[[], List[StatisticsCollector]]) -> List[StatisticsCollector]:\r\n        return struct_result()\r\n\r\n    def struct(self, struct: StructType, field_results: List[Callable[[], List[StatisticsCollector]]]) -> List[StatisticsCollector]:\r\n        return list(chain(*[result() for result in field_results]))\r\n\r\n    def field(self, field: NestedField, field_result: Callable[[], List[StatisticsCollector]]) -> List[StatisticsCollector]:\r\n        self._field_id = field.field_id\r\n        result = field_result()\r\n        return result\r\n\r\n    def list(self, list_type: ListType, element_result: Callable[[], List[StatisticsCollector]]) -> List[StatisticsCollector]:\r\n        self._field_id = list_type.element_id\r\n        return element_result()\r\n\r\n    def map(self, map_type: MapType, key_result: Callable[[], List[StatisticsCollector]], value_result: Callable[[], List[StatisticsCollector]]) -> List[StatisticsCollector]:\r\n        self._field_id = map_type.key_id\r\n        k = key_result()\r\n        self._field_id = map_type.value_id\r\n        v = value_result()\r\n        return k + v\r\n\r\n    def primitive(self, primitive: PrimitiveType) -> List[StatisticsCollector]:\r\n        return [StatisticsCollector(\r\n            field_id=self._field_id,\r\n            iceberg_type=primitive,\r\n            mode=MetricsMode.TRUNC\r\n            # schema\r\n            # self._properties.get(f\"write.metadata.metrics.column.{schema.find_column_name(self._field_id)}\")\r\n        )]\r\n```\r\n\r\nThis way we get a nice list of columns that we need to collect statistics for. We have:\r\n\r\n```python\r\n@dataclass(frozen=True)\r\nclass StatisticsCollector:\r\n    field_id: int\r\n    iceberg_type: PrimitiveType\r\n    mode: MetricsMode\r\n```\r\n\r\nWhere we can use the `field_id` to properly populate the maps, and the `iceberg_type` to feed into `to_bytes` to do the conversion (so we don't have to have yet another one for PyArrow).\r\n\r\nI did a quick test, and it seems to work:\r\n```python\r\ndef test_complex_schema(table_schema_nested: Schema):\r\n    tbl = pa.Table.from_pydict({\r\n        \"foo\": [\"a\", \"b\"],\r\n        \"bar\": [1, 2],\r\n        \"baz\": [False, True],\r\n        \"qux\": [[\"a\", \"b\"], [\"c\", \"d\"]],\r\n        \"quux\": [[(\"a\", ((\"aa\", 1), (\"ab\", 2)))], [(\"b\", ((\"ba\", 3), (\"bb\", 4)))]],\r\n        \"location\": [[(52.377956, 4.897070), (4.897070, -122.431297)],\r\n                     [(43.618881, -116.215019), (41.881832, -87.623177)]],\r\n        \"person\": [(\"Fokko\", 33), (\"Max\", 42)]  # Possible data quality issue\r\n    },\r\n        schema=schema_to_pyarrow(table_schema_nested)\r\n    )\r\n    stats_columns = pre_order_visit(table_schema_nested, PyArrowStatisticsCollector(table_schema_nested, {}))\r\n\r\n    visited_paths = []\r\n\r\n    def file_visitor(written_file: Any) -> None:\r\n        visited_paths.append(written_file)\r\n\r\n    with TemporaryDirectory() as tmpdir:\r\n        pq.write_to_dataset(tbl, tmpdir, file_visitor=file_visitor)\r\n\r\n    assert visited_paths[0].metadata.num_columns == len(stats_columns)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631183637/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631216990","html_url":"https://github.com/apache/iceberg/pull/7933#issuecomment-1631216990","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7933","id":1631216990,"node_id":"IC_kwDOCW7NX85hOmVe","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T17:28:53Z","updated_at":"2023-07-11T17:28:53Z","author_association":"COLLABORATOR","body":"Hm.. would it make more sense as a code comment rather than separate README file?  \r\n\r\n@ConeyLiu can you check if my understanding is right , for the test case, and make those changes?\r\n\r\nWanted to get this in to 1.3.1, and maybe we can do some follow up for docs","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631216990/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631219302","html_url":"https://github.com/apache/iceberg/pull/8036#issuecomment-1631219302","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8036","id":1631219302,"node_id":"IC_kwDOCW7NX85hOm5m","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T17:30:32Z","updated_at":"2023-07-11T17:30:32Z","author_association":"COLLABORATOR","body":"Merged, thanks @nastra and @singhpk234 for additional review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631219302/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631296790","html_url":"https://github.com/apache/iceberg/pull/7980#issuecomment-1631296790","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7980","id":1631296790,"node_id":"IC_kwDOCW7NX85hO50W","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T18:29:29Z","updated_at":"2023-07-11T18:29:29Z","author_association":"COLLABORATOR","body":"Makes sense, Ill wait to see if any comments, will commit if not.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631296790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631365210","html_url":"https://github.com/apache/iceberg/pull/8042#issuecomment-1631365210","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8042","id":1631365210,"node_id":"IC_kwDOCW7NX85hPKha","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T19:04:57Z","updated_at":"2023-07-11T19:04:57Z","author_association":"MEMBER","body":"@huaxingao is probably the right person to review this","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631365210/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631408336","html_url":"https://github.com/apache/iceberg/pull/8002#issuecomment-1631408336","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8002","id":1631408336,"node_id":"IC_kwDOCW7NX85hPVDQ","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T19:38:40Z","updated_at":"2023-07-11T19:38:40Z","author_association":"COLLABORATOR","body":"Looks good and test pass.  Thanks @joan38 for contribution, and @nastra for additional review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631408336/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631629180","html_url":"https://github.com/apache/iceberg/issues/7822#issuecomment-1631629180","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7822","id":1631629180,"node_id":"IC_kwDOCW7NX85hQK98","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T23:23:11Z","updated_at":"2023-07-11T23:23:11Z","author_association":"CONTRIBUTOR","body":"BTW, it would be possible to take into account the old schema as well.\r\nWhat is the use case are you looking for, @bmaisonn?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631629180/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631643837","html_url":"https://github.com/apache/iceberg/pull/7412#issuecomment-1631643837","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7412","id":1631643837,"node_id":"IC_kwDOCW7NX85hQOi9","user":{"login":"coufon","id":11655397,"node_id":"MDQ6VXNlcjExNjU1Mzk3","avatar_url":"https://avatars.githubusercontent.com/u/11655397?v=4","gravatar_id":"","url":"https://api.github.com/users/coufon","html_url":"https://github.com/coufon","followers_url":"https://api.github.com/users/coufon/followers","following_url":"https://api.github.com/users/coufon/following{/other_user}","gists_url":"https://api.github.com/users/coufon/gists{/gist_id}","starred_url":"https://api.github.com/users/coufon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coufon/subscriptions","organizations_url":"https://api.github.com/users/coufon/orgs","repos_url":"https://api.github.com/users/coufon/repos","events_url":"https://api.github.com/users/coufon/events{/privacy}","received_events_url":"https://api.github.com/users/coufon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T23:37:51Z","updated_at":"2023-07-11T23:37:51Z","author_association":"NONE","body":"Thanks Ryan for the helpful comments. I fixed style issues and will work on the rest comments in another commit.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631643837/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631645871","html_url":"https://github.com/apache/iceberg/issues/8045#issuecomment-1631645871","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8045","id":1631645871,"node_id":"IC_kwDOCW7NX85hQPCv","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T23:40:42Z","updated_at":"2023-07-11T23:40:42Z","author_association":"CONTRIBUTOR","body":"Looks like this was caused by partition transformation/hidden partition where column `ts` is of type `timestamptz` but transformed partition spec have days transformation on `ts` column which result in `ts_day` of type `int`. \r\n\r\nIf you can, can you share how your original rewrite_position_delete_files command so we can try to repro?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631645871/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631653470","html_url":"https://github.com/apache/iceberg/issues/7981#issuecomment-1631653470","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7981","id":1631653470,"node_id":"IC_kwDOCW7NX85hQQ5e","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-11T23:52:17Z","updated_at":"2023-07-11T23:52:17Z","author_association":"CONTRIBUTOR","body":"Looks like it's a valid option here for spark 3.1 but stacktrace above seems to differ https://github.com/apache/iceberg/blob/master/spark/v3.1/spark/src/main/java/org/apache/iceberg/spark/actions/BaseRewriteDataFilesSparkAction.java#L82","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631653470/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631665667","html_url":"https://github.com/apache/iceberg/pull/8043#issuecomment-1631665667","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8043","id":1631665667,"node_id":"IC_kwDOCW7NX85hQT4D","user":{"login":"jzhuge","id":1883812,"node_id":"MDQ6VXNlcjE4ODM4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1883812?v=4","gravatar_id":"","url":"https://api.github.com/users/jzhuge","html_url":"https://github.com/jzhuge","followers_url":"https://api.github.com/users/jzhuge/followers","following_url":"https://api.github.com/users/jzhuge/following{/other_user}","gists_url":"https://api.github.com/users/jzhuge/gists{/gist_id}","starred_url":"https://api.github.com/users/jzhuge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzhuge/subscriptions","organizations_url":"https://api.github.com/users/jzhuge/orgs","repos_url":"https://api.github.com/users/jzhuge/repos","events_url":"https://api.github.com/users/jzhuge/events{/privacy}","received_events_url":"https://api.github.com/users/jzhuge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T00:10:18Z","updated_at":"2023-07-12T00:11:34Z","author_association":"MEMBER","body":"@jfz's [PR 3539 in AWS SDK](https://github.com/aws/aws-sdk-java-v2/pull/3539/files) added `UncheckedIOException` to `RETRYABLE_EXCEPTIONS`. It is in 2.19.2 and later. We can just upgrade AWS SDK v2 to pick up UncheckedIOException \r\n changes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631665667/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631669765","html_url":"https://github.com/apache/iceberg/issues/6370#issuecomment-1631669765","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6370","id":1631669765,"node_id":"IC_kwDOCW7NX85hQU4F","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T00:16:01Z","updated_at":"2023-07-12T00:16:01Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631669765/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631669826","html_url":"https://github.com/apache/iceberg/issues/5947#issuecomment-1631669826","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5947","id":1631669826,"node_id":"IC_kwDOCW7NX85hQU5C","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T00:16:06Z","updated_at":"2023-07-12T00:16:06Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631669826/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631675253","html_url":"https://github.com/apache/iceberg/pull/7932#issuecomment-1631675253","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7932","id":1631675253,"node_id":"IC_kwDOCW7NX85hQWN1","user":{"login":"bowenliang123","id":1935105,"node_id":"MDQ6VXNlcjE5MzUxMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1935105?v=4","gravatar_id":"","url":"https://api.github.com/users/bowenliang123","html_url":"https://github.com/bowenliang123","followers_url":"https://api.github.com/users/bowenliang123/followers","following_url":"https://api.github.com/users/bowenliang123/following{/other_user}","gists_url":"https://api.github.com/users/bowenliang123/gists{/gist_id}","starred_url":"https://api.github.com/users/bowenliang123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bowenliang123/subscriptions","organizations_url":"https://api.github.com/users/bowenliang123/orgs","repos_url":"https://api.github.com/users/bowenliang123/repos","events_url":"https://api.github.com/users/bowenliang123/events{/privacy}","received_events_url":"https://api.github.com/users/bowenliang123/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T00:23:53Z","updated_at":"2023-07-12T00:23:53Z","author_association":"CONTRIBUTOR","body":"> @bowenliang123 Can we merge this to master by having a flag called \"strictDistributionRequired\" Similar to https://github.com/apache/spark/blob/453300b418bc03511ad9167bbaad49e0f1f1c090/sql/core/src/main/scala/org/apache/spark/sql/execution/datasources/v2/DistributionAndOrderingUtils.scala#L63 for rebalance to be applied?\r\n\r\nYes, I have noticed this changes in Spark 3.4. And backporting them to 3.3 is a considerable approach.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631675253/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631680135","html_url":"https://github.com/apache/iceberg/pull/8042#issuecomment-1631680135","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8042","id":1631680135,"node_id":"IC_kwDOCW7NX85hQXaH","user":{"login":"bowenliang123","id":1935105,"node_id":"MDQ6VXNlcjE5MzUxMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1935105?v=4","gravatar_id":"","url":"https://api.github.com/users/bowenliang123","html_url":"https://github.com/bowenliang123","followers_url":"https://api.github.com/users/bowenliang123/followers","following_url":"https://api.github.com/users/bowenliang123/following{/other_user}","gists_url":"https://api.github.com/users/bowenliang123/gists{/gist_id}","starred_url":"https://api.github.com/users/bowenliang123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bowenliang123/subscriptions","organizations_url":"https://api.github.com/users/bowenliang123/orgs","repos_url":"https://api.github.com/users/bowenliang123/repos","events_url":"https://api.github.com/users/bowenliang123/events{/privacy}","received_events_url":"https://api.github.com/users/bowenliang123/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T00:30:36Z","updated_at":"2023-07-12T00:30:36Z","author_association":"CONTRIBUTOR","body":"Thanks for extending my PR on #7932, by introducing strict table distribution in table property.\r\nI think it's also worth backporting to both Spark 3.3 and 3.2 for rebalancing support.\r\nAnd again as in your comment https://github.com/apache/iceberg/pull/7932#issuecomment-1615265754, rebalancing partitions does not have range partitioner support.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631680135/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631680989","html_url":"https://github.com/apache/iceberg/pull/7932#issuecomment-1631680989","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7932","id":1631680989,"node_id":"IC_kwDOCW7NX85hQXnd","user":{"login":"bowenliang123","id":1935105,"node_id":"MDQ6VXNlcjE5MzUxMDU=","avatar_url":"https://avatars.githubusercontent.com/u/1935105?v=4","gravatar_id":"","url":"https://api.github.com/users/bowenliang123","html_url":"https://github.com/bowenliang123","followers_url":"https://api.github.com/users/bowenliang123/followers","following_url":"https://api.github.com/users/bowenliang123/following{/other_user}","gists_url":"https://api.github.com/users/bowenliang123/gists{/gist_id}","starred_url":"https://api.github.com/users/bowenliang123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bowenliang123/subscriptions","organizations_url":"https://api.github.com/users/bowenliang123/orgs","repos_url":"https://api.github.com/users/bowenliang123/repos","events_url":"https://api.github.com/users/bowenliang123/events{/privacy}","received_events_url":"https://api.github.com/users/bowenliang123/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T00:31:59Z","updated_at":"2023-07-12T00:31:59Z","author_association":"CONTRIBUTOR","body":"I do not have a clue about how to fix the failures in GA tests, and where and why they fail. May need some help in this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631680989/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631683406","html_url":"https://github.com/apache/iceberg/issues/7981#issuecomment-1631683406","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7981","id":1631683406,"node_id":"IC_kwDOCW7NX85hQYNO","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T00:36:02Z","updated_at":"2023-07-12T00:36:02Z","author_association":"MEMBER","body":"Yeah they get set as valid options in the base validate and init methodSent from my iPhoneOn Jul 11, 2023, at 6:52 PM, dramaticlly ***@***.***> wrote:ï»¿\r\nLooks like it's a valid option here for spark 3.1 but stacktrace above seems to differ https://github.com/apache/iceberg/blob/master/spark/v3.1/spark/src/main/java/org/apache/iceberg/spark/actions/BaseRewriteDataFilesSparkAction.java#L82\r\n\r\nâ€”Reply to this email directly, view it on GitHub, or unsubscribe.You are receiving this because you were mentioned.Message ID: ***@***.***>","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631683406/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631715139","html_url":"https://github.com/apache/iceberg/pull/8023#issuecomment-1631715139","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8023","id":1631715139,"node_id":"IC_kwDOCW7NX85hQf9D","user":{"login":"zinking","id":118241,"node_id":"MDQ6VXNlcjExODI0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/118241?v=4","gravatar_id":"","url":"https://api.github.com/users/zinking","html_url":"https://github.com/zinking","followers_url":"https://api.github.com/users/zinking/followers","following_url":"https://api.github.com/users/zinking/following{/other_user}","gists_url":"https://api.github.com/users/zinking/gists{/gist_id}","starred_url":"https://api.github.com/users/zinking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zinking/subscriptions","organizations_url":"https://api.github.com/users/zinking/orgs","repos_url":"https://api.github.com/users/zinking/repos","events_url":"https://api.github.com/users/zinking/events{/privacy}","received_events_url":"https://api.github.com/users/zinking/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T01:25:59Z","updated_at":"2023-07-12T01:25:59Z","author_association":"CONTRIBUTOR","body":"@Fokko  are we going to force styles on scala as well? not sure why this isn't done when enforcing styles on java.  \r\nif the answer is yes, guess we need to do this early instead of late.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631715139/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631721549","html_url":"https://github.com/apache/iceberg/pull/8001#issuecomment-1631721549","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8001","id":1631721549,"node_id":"IC_kwDOCW7NX85hQhhN","user":{"login":"zinking","id":118241,"node_id":"MDQ6VXNlcjExODI0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/118241?v=4","gravatar_id":"","url":"https://api.github.com/users/zinking","html_url":"https://github.com/zinking","followers_url":"https://api.github.com/users/zinking/followers","following_url":"https://api.github.com/users/zinking/following{/other_user}","gists_url":"https://api.github.com/users/zinking/gists{/gist_id}","starred_url":"https://api.github.com/users/zinking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zinking/subscriptions","organizations_url":"https://api.github.com/users/zinking/orgs","repos_url":"https://api.github.com/users/zinking/repos","events_url":"https://api.github.com/users/zinking/events{/privacy}","received_events_url":"https://api.github.com/users/zinking/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T01:36:09Z","updated_at":"2023-07-12T01:36:09Z","author_association":"CONTRIBUTOR","body":"some thoughts:\r\n\r\n1. the partially commit enabled rewrite PROCESS should not have commit conflicts within itself, meaning the threads within this PROCESS should be coordinated to commit without conflict instead of concurrently commit.\r\n\r\n2. when this rewrite PROCESS conflict with other PROCESS, retry option should be provided to avoid wasted work.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631721549/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631736728","html_url":"https://github.com/apache/iceberg/issues/2562#issuecomment-1631736728","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2562","id":1631736728,"node_id":"IC_kwDOCW7NX85hQlOY","user":{"login":"norrishuang","id":33706975,"node_id":"MDQ6VXNlcjMzNzA2OTc1","avatar_url":"https://avatars.githubusercontent.com/u/33706975?v=4","gravatar_id":"","url":"https://api.github.com/users/norrishuang","html_url":"https://github.com/norrishuang","followers_url":"https://api.github.com/users/norrishuang/followers","following_url":"https://api.github.com/users/norrishuang/following{/other_user}","gists_url":"https://api.github.com/users/norrishuang/gists{/gist_id}","starred_url":"https://api.github.com/users/norrishuang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/norrishuang/subscriptions","organizations_url":"https://api.github.com/users/norrishuang/orgs","repos_url":"https://api.github.com/users/norrishuang/repos","events_url":"https://api.github.com/users/norrishuang/events{/privacy}","received_events_url":"https://api.github.com/users/norrishuang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T02:00:46Z","updated_at":"2023-07-12T02:01:02Z","author_association":"NONE","body":"I found too. I test iceberg on spark 3.3.1 used TPC-DS 3TB. The performance is slower than spark on parquet table 3-4x.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631736728/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631739930","html_url":"https://github.com/apache/iceberg/pull/7933#issuecomment-1631739930","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7933","id":1631739930,"node_id":"IC_kwDOCW7NX85hQmAa","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T02:05:37Z","updated_at":"2023-07-12T02:05:37Z","author_association":"CONTRIBUTOR","body":"Thanks @szehon-ho for the detailed review, will address the comments today.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631739930/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631768080","html_url":"https://github.com/apache/iceberg/issues/8005#issuecomment-1631768080","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8005","id":1631768080,"node_id":"IC_kwDOCW7NX85hQs4Q","user":{"login":"coded9","id":9302330,"node_id":"MDQ6VXNlcjkzMDIzMzA=","avatar_url":"https://avatars.githubusercontent.com/u/9302330?v=4","gravatar_id":"","url":"https://api.github.com/users/coded9","html_url":"https://github.com/coded9","followers_url":"https://api.github.com/users/coded9/followers","following_url":"https://api.github.com/users/coded9/following{/other_user}","gists_url":"https://api.github.com/users/coded9/gists{/gist_id}","starred_url":"https://api.github.com/users/coded9/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coded9/subscriptions","organizations_url":"https://api.github.com/users/coded9/orgs","repos_url":"https://api.github.com/users/coded9/repos","events_url":"https://api.github.com/users/coded9/events{/privacy}","received_events_url":"https://api.github.com/users/coded9/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T02:44:45Z","updated_at":"2023-07-12T02:44:45Z","author_association":"CONTRIBUTOR","body":"could you assign to me @RussellSpitzer ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631768080/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631770198","html_url":"https://github.com/apache/iceberg/issues/7040#issuecomment-1631770198","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7040","id":1631770198,"node_id":"IC_kwDOCW7NX85hQtZW","user":{"login":"coded9","id":9302330,"node_id":"MDQ6VXNlcjkzMDIzMzA=","avatar_url":"https://avatars.githubusercontent.com/u/9302330?v=4","gravatar_id":"","url":"https://api.github.com/users/coded9","html_url":"https://github.com/coded9","followers_url":"https://api.github.com/users/coded9/followers","following_url":"https://api.github.com/users/coded9/following{/other_user}","gists_url":"https://api.github.com/users/coded9/gists{/gist_id}","starred_url":"https://api.github.com/users/coded9/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coded9/subscriptions","organizations_url":"https://api.github.com/users/coded9/orgs","repos_url":"https://api.github.com/users/coded9/repos","events_url":"https://api.github.com/users/coded9/events{/privacy}","received_events_url":"https://api.github.com/users/coded9/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T02:47:56Z","updated_at":"2023-07-12T02:47:56Z","author_association":"CONTRIBUTOR","body":"@tobehardest we can work together, if you are finding it difficult.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631770198/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631781273","html_url":"https://github.com/apache/iceberg/issues/7618#issuecomment-1631781273","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7618","id":1631781273,"node_id":"IC_kwDOCW7NX85hQwGZ","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T03:05:58Z","updated_at":"2023-07-12T03:05:58Z","author_association":"CONTRIBUTOR","body":"this is the intended behavior. This check requires users to add partition columns to the identifier/PK columns.\r\nhttps://github.com/apache/iceberg/blob/master/flink/v1.17/flink/src/main/java/org/apache/iceberg/flink/sink/FlinkSink.java#L523\r\n\r\nI am not sure we need PR #7620. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631781273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631804101","html_url":"https://github.com/apache/iceberg/pull/7980#issuecomment-1631804101","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7980","id":1631804101,"node_id":"IC_kwDOCW7NX85hQ1rF","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T03:45:37Z","updated_at":"2023-07-12T03:45:37Z","author_association":"CONTRIBUTOR","body":"@szehon-ho Thanks for reviewing. Do I need to port the change to other spark versions?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631804101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631934972","html_url":"https://github.com/apache/iceberg/issues/8045#issuecomment-1631934972","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8045","id":1631934972,"node_id":"IC_kwDOCW7NX85hRVn8","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T06:38:41Z","updated_at":"2023-07-12T06:38:41Z","author_association":"COLLABORATOR","body":"I think I know the issue. \r\n\r\nIt is part of the code to do 'removeDanglingDeletes'.  For each partition of delete files, I am trying to find 'live' data files so I can do the clean up.  \r\n\r\nIn this method, https://github.com/apache/iceberg/blob/master/spark/v3.4/spark/src/main/java/org/apache/iceberg/spark/actions/SparkBinPackPositionDeletesRewriter.java#L122  , I use the DeleteFile's partition data directly , to query data_files table.  I thought it would work as the data_files table is using the transformed partition values, just as the DeleteFile partition data should have.\r\n\r\nBut the partition data of DeleteFile is not the same type as exposed in the Spark metadata table...  In particular, there's a difference of logical and real Avro types as defined in spec:  https://iceberg.apache.org/spec/#avro\r\n\r\nSummary: the issue does not affect specifically partition transforms.  It affects partitions that has an Avro type != logical Avro type . ie date, time, etc.\r\n\r\nIm investigating a fix involving adding a conversion from Avro type to logical type.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1631934972/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632096802","html_url":"https://github.com/apache/iceberg/issues/7821#issuecomment-1632096802","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7821","id":1632096802,"node_id":"IC_kwDOCW7NX85hR9Ii","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T08:43:01Z","updated_at":"2023-07-12T08:43:01Z","author_association":"CONTRIBUTOR","body":"@hxgdada thanks for reporting this. I've opened #8046 that should fix it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632096802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632124679","html_url":"https://github.com/apache/iceberg/pull/8043#issuecomment-1632124679","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8043","id":1632124679,"node_id":"IC_kwDOCW7NX85hSD8H","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T09:01:36Z","updated_at":"2023-07-12T09:01:36Z","author_association":"CONTRIBUTOR","body":"thanks for pointing this out @jzhuge. So I think we should change the PR to just update the AWS SDK version. @hiloboy0119 could you do that please?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632124679/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632162232","html_url":"https://github.com/apache/iceberg/issues/8047#issuecomment-1632162232","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8047","id":1632162232,"node_id":"IC_kwDOCW7NX85hSNG4","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T09:25:28Z","updated_at":"2023-07-12T09:25:28Z","author_association":"CONTRIBUTOR","body":"cc @JonasJ-ap ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632162232/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632242215","html_url":"https://github.com/apache/iceberg/issues/7822#issuecomment-1632242215","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7822","id":1632242215,"node_id":"IC_kwDOCW7NX85hSgon","user":{"login":"bmaisonn","id":7989822,"node_id":"MDQ6VXNlcjc5ODk4MjI=","avatar_url":"https://avatars.githubusercontent.com/u/7989822?v=4","gravatar_id":"","url":"https://api.github.com/users/bmaisonn","html_url":"https://github.com/bmaisonn","followers_url":"https://api.github.com/users/bmaisonn/followers","following_url":"https://api.github.com/users/bmaisonn/following{/other_user}","gists_url":"https://api.github.com/users/bmaisonn/gists{/gist_id}","starred_url":"https://api.github.com/users/bmaisonn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmaisonn/subscriptions","organizations_url":"https://api.github.com/users/bmaisonn/orgs","repos_url":"https://api.github.com/users/bmaisonn/repos","events_url":"https://api.github.com/users/bmaisonn/events{/privacy}","received_events_url":"https://api.github.com/users/bmaisonn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T10:21:45Z","updated_at":"2023-07-12T10:21:45Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi the behavior mentioned above makes sense to me. In this example we didn't necessarily expect that the two columns with the same name to line up in the changelog. We did that when we noticed that the column disappeared from the changelog after we dropped it to try to figure out if it would come back and how.\r\n\r\nThe use case here is that we want to keep track of the changes made by the users on those tables for quality purpose. Basically we want to be able to easily answer the question \"What happened to that datapoint during the last week\" and see the modifications made for that period of time. In that context we'd like to see the records as of that modification.\r\n\r\nIn that case i think it would be acceptable to see two columns with the same name in the changelog or to return the column ids and let us resolve them afterward. Still it would be difficult to make the difference between \"this column was there with null values\" vs \" this column wasn't there at that time\" but we could display the schema changes separately.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632242215/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632438087","html_url":"https://github.com/apache/iceberg/issues/8031#issuecomment-1632438087","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8031","id":1632438087,"node_id":"IC_kwDOCW7NX85hTQdH","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T12:26:26Z","updated_at":"2023-07-12T12:26:26Z","author_association":"CONTRIBUTOR","body":"I agree that this is suprising behavior from an end user's perspective, but it is expected according to https://github.com/apache/iceberg/blob/223177faf955bd8f11864477da16013cf5d7cc75/core/src/test/java/org/apache/iceberg/TestUpdatePartitionSpec.java#L204-L206\r\n\r\nThis is what makes https://iceberg.apache.org/docs/latest/evolution/#partition-evolution properly work","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632438087/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632609309","html_url":"https://github.com/apache/iceberg/pull/7933#issuecomment-1632609309","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7933","id":1632609309,"node_id":"IC_kwDOCW7NX85hT6Qd","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T14:14:10Z","updated_at":"2023-07-12T14:14:10Z","author_association":"CONTRIBUTOR","body":"Thanks @szehon-ho @chenjunjiedada I comment in the comments thread. Please take a look. I will update to code if it is OK.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632609309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632658546","html_url":"https://github.com/apache/iceberg/pull/8043#issuecomment-1632658546","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8043","id":1632658546,"node_id":"IC_kwDOCW7NX85hUGRy","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T14:42:46Z","updated_at":"2023-07-12T14:42:46Z","author_association":"CONTRIBUTOR","body":"[doubt] Will be be required then considering we are already as SDK version [2.20.18](https://github.com/apache/iceberg/blob/master/versions.props#L24) @nastra @jzhuge ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632658546/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632674803","html_url":"https://github.com/apache/iceberg/pull/8043#issuecomment-1632674803","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8043","id":1632674803,"node_id":"IC_kwDOCW7NX85hUKPz","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T14:49:19Z","updated_at":"2023-07-12T14:49:19Z","author_association":"CONTRIBUTOR","body":"ah right, I forgot that we're already on 2.20.18, thanks for pointing that out @singhpk234 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632674803/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632690195","html_url":"https://github.com/apache/iceberg/pull/8049#issuecomment-1632690195","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8049","id":1632690195,"node_id":"IC_kwDOCW7NX85hUOAT","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T14:53:52Z","updated_at":"2023-07-12T14:53:52Z","author_association":"CONTRIBUTOR","body":"Thanks for raising this @ktk1012. The behavior seems to be inconsistent with Java, where a -1 is being written: https://github.com/apache/iceberg/blob/6cafd7055e3e943f44d12640c241d870d2a9cfbe/core/src/main/java/org/apache/iceberg/TableMetadataParser.java#L216-L218\r\n\r\nHowever, it is optional in the spec:\r\n![image](https://github.com/apache/iceberg/assets/1134248/c6a12fdf-73bb-44fe-95ea-15a2ecd978e1)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632690195/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632691029","html_url":"https://github.com/apache/iceberg/pull/8049#issuecomment-1632691029","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8049","id":1632691029,"node_id":"IC_kwDOCW7NX85hUONV","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T14:54:11Z","updated_at":"2023-07-12T14:54:11Z","author_association":"CONTRIBUTOR","body":"cc @rdblue WDYT?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632691029/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632745389","html_url":"https://github.com/apache/iceberg/pull/5774#issuecomment-1632745389","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5774","id":1632745389,"node_id":"IC_kwDOCW7NX85hUbet","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T15:22:55Z","updated_at":"2023-07-12T15:22:55Z","author_association":"MEMBER","body":"@bitsondatadev you mean it should be `hashLong(long(daysFromUnixEpoch(v)))` instead of `hashLong(daysFromUnixEpoch(v))`? I don't see how the latter is ambiguous, but sure I can do that. I want confirmation though that I understood the right way","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632745389/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632850423","html_url":"https://github.com/apache/iceberg/pull/7988#issuecomment-1632850423","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7988","id":1632850423,"node_id":"IC_kwDOCW7NX85hU1H3","user":{"login":"Neuw84","id":5920770,"node_id":"MDQ6VXNlcjU5MjA3NzA=","avatar_url":"https://avatars.githubusercontent.com/u/5920770?v=4","gravatar_id":"","url":"https://api.github.com/users/Neuw84","html_url":"https://github.com/Neuw84","followers_url":"https://api.github.com/users/Neuw84/followers","following_url":"https://api.github.com/users/Neuw84/following{/other_user}","gists_url":"https://api.github.com/users/Neuw84/gists{/gist_id}","starred_url":"https://api.github.com/users/Neuw84/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Neuw84/subscriptions","organizations_url":"https://api.github.com/users/Neuw84/orgs","repos_url":"https://api.github.com/users/Neuw84/repos","events_url":"https://api.github.com/users/Neuw84/events{/privacy}","received_events_url":"https://api.github.com/users/Neuw84/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T16:25:43Z","updated_at":"2023-07-12T16:25:43Z","author_association":"CONTRIBUTOR","body":"Hi @nastra,\r\n\r\nHave refactored the test methods based on the ones existing on `IOUtil` ones and have added `serialize() / deserialize()` methods to the `TestHelpers`  class. Have applied everywhere `spotless` too. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1632850423/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633133064","html_url":"https://github.com/apache/iceberg/pull/7933#issuecomment-1633133064","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7933","id":1633133064,"node_id":"IC_kwDOCW7NX85hV6II","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T20:03:05Z","updated_at":"2023-07-12T20:03:05Z","author_association":"COLLABORATOR","body":"Thanks  @ConeyLiu for patiently answering my questions, the concurrent test a bit difficult to follow for me :).  I'm ok to do the comment you put, I just put one more suggestion.  I'm also working on another pending 1.3.1 issue so we should be ok.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633133064/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633143517","html_url":"https://github.com/apache/iceberg/pull/7980#issuecomment-1633143517","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7980","id":1633143517,"node_id":"IC_kwDOCW7NX85hV8rd","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T20:11:35Z","updated_at":"2023-07-12T20:11:35Z","author_association":"COLLABORATOR","body":"Merged, thanks @lirui-apache , yea I think that would be great , maybe at least 3.3?  I think It's voluntary and depends who needs what in each branch.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633143517/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633230903","html_url":"https://github.com/apache/iceberg/issues/8045#issuecomment-1633230903","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8045","id":1633230903,"node_id":"IC_kwDOCW7NX85hWSA3","user":{"login":"mcgray","id":1321966,"node_id":"MDQ6VXNlcjEzMjE5NjY=","avatar_url":"https://avatars.githubusercontent.com/u/1321966?v=4","gravatar_id":"","url":"https://api.github.com/users/mcgray","html_url":"https://github.com/mcgray","followers_url":"https://api.github.com/users/mcgray/followers","following_url":"https://api.github.com/users/mcgray/following{/other_user}","gists_url":"https://api.github.com/users/mcgray/gists{/gist_id}","starred_url":"https://api.github.com/users/mcgray/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mcgray/subscriptions","organizations_url":"https://api.github.com/users/mcgray/orgs","repos_url":"https://api.github.com/users/mcgray/repos","events_url":"https://api.github.com/users/mcgray/events{/privacy}","received_events_url":"https://api.github.com/users/mcgray/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T21:22:54Z","updated_at":"2023-07-12T21:22:54Z","author_association":"NONE","body":"No argument for ```rewrite_position_delete_files``` apart from ```table``` was used. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633230903/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633231058","html_url":"https://github.com/apache/iceberg/pull/7914#issuecomment-1633231058","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7914","id":1633231058,"node_id":"IC_kwDOCW7NX85hWSDS","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T21:23:04Z","updated_at":"2023-07-12T21:23:04Z","author_association":"MEMBER","body":"PR still needs tests, let me know when they have been added?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633231058/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633294224","html_url":"https://github.com/apache/iceberg/pull/8051#issuecomment-1633294224","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8051","id":1633294224,"node_id":"IC_kwDOCW7NX85hWheQ","user":{"login":"SinghAsDev","id":4915557,"node_id":"MDQ6VXNlcjQ5MTU1NTc=","avatar_url":"https://avatars.githubusercontent.com/u/4915557?v=4","gravatar_id":"","url":"https://api.github.com/users/SinghAsDev","html_url":"https://github.com/SinghAsDev","followers_url":"https://api.github.com/users/SinghAsDev/followers","following_url":"https://api.github.com/users/SinghAsDev/following{/other_user}","gists_url":"https://api.github.com/users/SinghAsDev/gists{/gist_id}","starred_url":"https://api.github.com/users/SinghAsDev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SinghAsDev/subscriptions","organizations_url":"https://api.github.com/users/SinghAsDev/orgs","repos_url":"https://api.github.com/users/SinghAsDev/repos","events_url":"https://api.github.com/users/SinghAsDev/events{/privacy}","received_events_url":"https://api.github.com/users/SinghAsDev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T22:35:37Z","updated_at":"2023-07-12T22:35:37Z","author_association":"CONTRIBUTOR","body":"Hi @puchengy can this be achieved with `rewriteDataFiles` as well? If yes, the reason you are proposing this is to provide a relatively cheaper way to delete empty files?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633294224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633304657","html_url":"https://github.com/apache/iceberg/issues/8010#issuecomment-1633304657","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8010","id":1633304657,"node_id":"IC_kwDOCW7NX85hWkBR","user":{"login":"holdenk","id":59893,"node_id":"MDQ6VXNlcjU5ODkz","avatar_url":"https://avatars.githubusercontent.com/u/59893?v=4","gravatar_id":"","url":"https://api.github.com/users/holdenk","html_url":"https://github.com/holdenk","followers_url":"https://api.github.com/users/holdenk/followers","following_url":"https://api.github.com/users/holdenk/following{/other_user}","gists_url":"https://api.github.com/users/holdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/holdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holdenk/subscriptions","organizations_url":"https://api.github.com/users/holdenk/orgs","repos_url":"https://api.github.com/users/holdenk/repos","events_url":"https://api.github.com/users/holdenk/events{/privacy}","received_events_url":"https://api.github.com/users/holdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T22:49:41Z","updated_at":"2023-07-12T22:50:28Z","author_association":"CONTRIBUTOR","body":"Ok! So I did some more digging, and I _think_ the fix could go in the Iceberg side ( see https://www.youtube.com/watch?v=dqqD-frXb4M for ~the hour of me poking through the code if anyone is curious).\r\n\r\nSpark's `RequiredDistributionAndOrdering` has an option `distributionStrictlyRequired()` which when true (which is the default) will force a repartition to match the desired dist to the T (see `DistributionAndOrderingUtils.scala`). I _think_ we might want instead to set it to false so we get `RebalancePartitions` which would allow `OptimizeSkewInRebalancePartitions` to maybe address the skew issue that we are seeing.\r\n\r\nWDYT @RussellSpitzer ?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633304657/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633308821","html_url":"https://github.com/apache/iceberg/issues/8010#issuecomment-1633308821","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8010","id":1633308821,"node_id":"IC_kwDOCW7NX85hWlCV","user":{"login":"holdenk","id":59893,"node_id":"MDQ6VXNlcjU5ODkz","avatar_url":"https://avatars.githubusercontent.com/u/59893?v=4","gravatar_id":"","url":"https://api.github.com/users/holdenk","html_url":"https://github.com/holdenk","followers_url":"https://api.github.com/users/holdenk/followers","following_url":"https://api.github.com/users/holdenk/following{/other_user}","gists_url":"https://api.github.com/users/holdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/holdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holdenk/subscriptions","organizations_url":"https://api.github.com/users/holdenk/orgs","repos_url":"https://api.github.com/users/holdenk/repos","events_url":"https://api.github.com/users/holdenk/events{/privacy}","received_events_url":"https://api.github.com/users/holdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-12T22:55:13Z","updated_at":"2023-07-12T22:55:13Z","author_association":"CONTRIBUTOR","body":"Follow up: looks like this is set in Spark 3.4 w/Iceberg so it's probably fine already and a problem from using Spark 3.3.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633308821/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":2,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633358337","html_url":"https://github.com/apache/iceberg/issues/6561#issuecomment-1633358337","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6561","id":1633358337,"node_id":"IC_kwDOCW7NX85hWxIB","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T00:13:22Z","updated_at":"2023-07-13T00:13:22Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633358337/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633358356","html_url":"https://github.com/apache/iceberg/issues/6549#issuecomment-1633358356","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6549","id":1633358356,"node_id":"IC_kwDOCW7NX85hWxIU","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T00:13:23Z","updated_at":"2023-07-13T00:13:23Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633358356/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633410217","html_url":"https://github.com/apache/iceberg/issues/7040#issuecomment-1633410217","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7040","id":1633410217,"node_id":"IC_kwDOCW7NX85hW9yp","user":{"login":"tobehardest","id":88612778,"node_id":"MDQ6VXNlcjg4NjEyNzc4","avatar_url":"https://avatars.githubusercontent.com/u/88612778?v=4","gravatar_id":"","url":"https://api.github.com/users/tobehardest","html_url":"https://github.com/tobehardest","followers_url":"https://api.github.com/users/tobehardest/followers","following_url":"https://api.github.com/users/tobehardest/following{/other_user}","gists_url":"https://api.github.com/users/tobehardest/gists{/gist_id}","starred_url":"https://api.github.com/users/tobehardest/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tobehardest/subscriptions","organizations_url":"https://api.github.com/users/tobehardest/orgs","repos_url":"https://api.github.com/users/tobehardest/repos","events_url":"https://api.github.com/users/tobehardest/events{/privacy}","received_events_url":"https://api.github.com/users/tobehardest/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T01:37:28Z","updated_at":"2023-07-13T01:37:28Z","author_association":"NONE","body":"> @tobehardest we can work together, if you are finding it difficult.\r\n\r\nOK. How to contact you?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633410217/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633410320","html_url":"https://github.com/apache/iceberg/pull/7412#issuecomment-1633410320","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7412","id":1633410320,"node_id":"IC_kwDOCW7NX85hW90Q","user":{"login":"coufon","id":11655397,"node_id":"MDQ6VXNlcjExNjU1Mzk3","avatar_url":"https://avatars.githubusercontent.com/u/11655397?v=4","gravatar_id":"","url":"https://api.github.com/users/coufon","html_url":"https://github.com/coufon","followers_url":"https://api.github.com/users/coufon/followers","following_url":"https://api.github.com/users/coufon/following{/other_user}","gists_url":"https://api.github.com/users/coufon/gists{/gist_id}","starred_url":"https://api.github.com/users/coufon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coufon/subscriptions","organizations_url":"https://api.github.com/users/coufon/orgs","repos_url":"https://api.github.com/users/coufon/repos","events_url":"https://api.github.com/users/coufon/events{/privacy}","received_events_url":"https://api.github.com/users/coufon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T01:37:39Z","updated_at":"2023-07-13T01:37:39Z","author_association":"NONE","body":"Thanks @rdblue and @nastra for the review. I have addressed the comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633410320/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633501777","html_url":"https://github.com/apache/iceberg/pull/7933#issuecomment-1633501777","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7933","id":1633501777,"node_id":"IC_kwDOCW7NX85hXUJR","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T03:44:36Z","updated_at":"2023-07-13T03:44:36Z","author_association":"CONTRIBUTOR","body":"Thanks @szehon-ho for the time to do the details review. Comments have been added.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633501777/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633509436","html_url":"https://github.com/apache/iceberg/issues/8031#issuecomment-1633509436","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8031","id":1633509436,"node_id":"IC_kwDOCW7NX85hXWA8","user":{"login":"LevisBale0824","id":46475641,"node_id":"MDQ6VXNlcjQ2NDc1NjQx","avatar_url":"https://avatars.githubusercontent.com/u/46475641?v=4","gravatar_id":"","url":"https://api.github.com/users/LevisBale0824","html_url":"https://github.com/LevisBale0824","followers_url":"https://api.github.com/users/LevisBale0824/followers","following_url":"https://api.github.com/users/LevisBale0824/following{/other_user}","gists_url":"https://api.github.com/users/LevisBale0824/gists{/gist_id}","starred_url":"https://api.github.com/users/LevisBale0824/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LevisBale0824/subscriptions","organizations_url":"https://api.github.com/users/LevisBale0824/orgs","repos_url":"https://api.github.com/users/LevisBale0824/repos","events_url":"https://api.github.com/users/LevisBale0824/events{/privacy}","received_events_url":"https://api.github.com/users/LevisBale0824/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T03:58:13Z","updated_at":"2023-07-13T03:58:13Z","author_association":"NONE","body":"> I agree that this is suprising behavior from an end user's perspective, but it is expected according to\r\n> \r\n> https://github.com/apache/iceberg/blob/223177faf955bd8f11864477da16013cf5d7cc75/core/src/test/java/org/apache/iceberg/TestUpdatePartitionSpec.java#L204-L206\r\n> \r\n> This is what makes https://iceberg.apache.org/docs/latest/evolution/#partition-evolution properly work\r\n\r\nI think it means that we can use replacePartition to update the partition with time type and old data will also useful","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633509436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633624549","html_url":"https://github.com/apache/iceberg/issues/7975#issuecomment-1633624549","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7975","id":1633624549,"node_id":"IC_kwDOCW7NX85hXyHl","user":{"login":"zinking","id":118241,"node_id":"MDQ6VXNlcjExODI0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/118241?v=4","gravatar_id":"","url":"https://api.github.com/users/zinking","html_url":"https://github.com/zinking","followers_url":"https://api.github.com/users/zinking/followers","following_url":"https://api.github.com/users/zinking/following{/other_user}","gists_url":"https://api.github.com/users/zinking/gists{/gist_id}","starred_url":"https://api.github.com/users/zinking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zinking/subscriptions","organizations_url":"https://api.github.com/users/zinking/orgs","repos_url":"https://api.github.com/users/zinking/repos","events_url":"https://api.github.com/users/zinking/events{/privacy}","received_events_url":"https://api.github.com/users/zinking/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T06:23:49Z","updated_at":"2023-07-13T06:23:49Z","author_association":"CONTRIBUTOR","body":"would delete too many paths concurrently trigger rate limit etc ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633624549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633626741","html_url":"https://github.com/apache/iceberg/pull/8046#issuecomment-1633626741","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8046","id":1633626741,"node_id":"IC_kwDOCW7NX85hXyp1","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T06:25:45Z","updated_at":"2023-07-13T06:25:45Z","author_association":"CONTRIBUTOR","body":"> LGTM, maybe also worth updating this hardcoded UTF-8 in PartitionSpec to using StandardCharsets as well? https://github.com/apache/iceberg/blob/master/api/src/main/java/org/apache/iceberg/PartitionSpec.java#L174\r\n\r\nSeems like there are a few more places that use the hardcoded string and it's not directly related to this PR. @dramaticlly would you be interested in updating those?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633626741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633629143","html_url":"https://github.com/apache/iceberg/pull/8046#issuecomment-1633629143","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8046","id":1633629143,"node_id":"IC_kwDOCW7NX85hXzPX","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T06:27:47Z","updated_at":"2023-07-13T06:27:47Z","author_association":"CONTRIBUTOR","body":"> > LGTM, maybe also worth updating this hardcoded UTF-8 in PartitionSpec to using StandardCharsets as well? https://github.com/apache/iceberg/blob/master/api/src/main/java/org/apache/iceberg/PartitionSpec.java#L174\n> \n> \n> \n> Seems like there are a few more places that use the hardcoded string and it's not directly related to this PR. @dramaticlly would you be interested in updating those?\n\nSure I can cut a separate PR to update those.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633629143/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633629531","html_url":"https://github.com/apache/iceberg/pull/8051#issuecomment-1633629531","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8051","id":1633629531,"node_id":"IC_kwDOCW7NX85hXzVb","user":{"login":"zinking","id":118241,"node_id":"MDQ6VXNlcjExODI0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/118241?v=4","gravatar_id":"","url":"https://api.github.com/users/zinking","html_url":"https://github.com/zinking","followers_url":"https://api.github.com/users/zinking/followers","following_url":"https://api.github.com/users/zinking/following{/other_user}","gists_url":"https://api.github.com/users/zinking/gists{/gist_id}","starred_url":"https://api.github.com/users/zinking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zinking/subscriptions","organizations_url":"https://api.github.com/users/zinking/orgs","repos_url":"https://api.github.com/users/zinking/repos","events_url":"https://api.github.com/users/zinking/events{/privacy}","received_events_url":"https://api.github.com/users/zinking/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T06:28:10Z","updated_at":"2023-07-13T06:28:10Z","author_association":"CONTRIBUTOR","body":"I guess the issue is rather why is empty file committed in the first place?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633629531/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633635084","html_url":"https://github.com/apache/iceberg/pull/8050#issuecomment-1633635084","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8050","id":1633635084,"node_id":"IC_kwDOCW7NX85hX0sM","user":{"login":"zinking","id":118241,"node_id":"MDQ6VXNlcjExODI0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/118241?v=4","gravatar_id":"","url":"https://api.github.com/users/zinking","html_url":"https://github.com/zinking","followers_url":"https://api.github.com/users/zinking/followers","following_url":"https://api.github.com/users/zinking/following{/other_user}","gists_url":"https://api.github.com/users/zinking/gists{/gist_id}","starred_url":"https://api.github.com/users/zinking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zinking/subscriptions","organizations_url":"https://api.github.com/users/zinking/orgs","repos_url":"https://api.github.com/users/zinking/repos","events_url":"https://api.github.com/users/zinking/events{/privacy}","received_events_url":"https://api.github.com/users/zinking/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T06:33:13Z","updated_at":"2023-07-13T07:27:45Z","author_association":"CONTRIBUTOR","body":"LGTM\r\n\r\non the other side,  there doesn't seem to be parsing exceptions from my experience, is that because the writer essentially always write out the `optional` field.  in this sense, what is changed ? or it's just to stick more strictly with the spec?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633635084/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633787010","html_url":"https://github.com/apache/iceberg/pull/8050#issuecomment-1633787010","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8050","id":1633787010,"node_id":"IC_kwDOCW7NX85hYZyC","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T08:20:18Z","updated_at":"2023-07-13T08:20:18Z","author_association":"CONTRIBUTOR","body":"> on the other side, there doesn't seem to be parsing exceptions from my experience, is that because the writer essentially always write out the optional field. in this sense, what is changed ? or it's just to stick more strictly with the spec?\r\n\r\n@zinking Thanks for the review. Let me elaborate. It is sticking to the spec on the read side. In the spec, the `current-snapshot-id`, `properties`, and `snapshots` fields can be omitted, but the parser doesn't allow this. \r\n\r\nThe Java code still writes a `-1` when writing a Metadata JSON:\r\n\r\nhttps://github.com/apache/iceberg/blob/531bf9de69aac73b14bb6e7dccc0917da522c11c/core/src/main/java/org/apache/iceberg/TableMetadataParser.java#L216-L218\r\n\r\nBut I don't want to change that today, since other readers might expect a -1 instead of omitting the field (I know Athena does). I think aking sure that the read-side adheres to the spec is a good first step.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633787010/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633918501","html_url":"https://github.com/apache/iceberg/pull/7988#issuecomment-1633918501","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7988","id":1633918501,"node_id":"IC_kwDOCW7NX85hY54l","user":{"login":"Neuw84","id":5920770,"node_id":"MDQ6VXNlcjU5MjA3NzA=","avatar_url":"https://avatars.githubusercontent.com/u/5920770?v=4","gravatar_id":"","url":"https://api.github.com/users/Neuw84","html_url":"https://github.com/Neuw84","followers_url":"https://api.github.com/users/Neuw84/followers","following_url":"https://api.github.com/users/Neuw84/following{/other_user}","gists_url":"https://api.github.com/users/Neuw84/gists{/gist_id}","starred_url":"https://api.github.com/users/Neuw84/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Neuw84/subscriptions","organizations_url":"https://api.github.com/users/Neuw84/orgs","repos_url":"https://api.github.com/users/Neuw84/repos","events_url":"https://api.github.com/users/Neuw84/events{/privacy}","received_events_url":"https://api.github.com/users/Neuw84/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T09:46:34Z","updated_at":"2023-07-13T09:46:34Z","author_association":"CONTRIBUTOR","body":"Done with the required changes. \r\n\r\nFor `ManifestReadBenchmark` I have also changed the `Files.createTemp` from Guava as it collides with `java.nio.File.Files` and the change was small. \r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1633918501/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634209715","html_url":"https://github.com/apache/iceberg/issues/7226#issuecomment-1634209715","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7226","id":1634209715,"node_id":"IC_kwDOCW7NX85haA-z","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T13:04:43Z","updated_at":"2023-07-13T13:04:43Z","author_association":"CONTRIBUTOR","body":"@shuvaevv Sorry for the late reply, I missed this one. Do you have a stacktrace? I've cleaned up the PR, and that should be ready for the next release.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634209715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634317651","html_url":"https://github.com/apache/iceberg/pull/8015#issuecomment-1634317651","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8015","id":1634317651,"node_id":"IC_kwDOCW7NX85habVT","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T14:10:57Z","updated_at":"2023-07-13T14:10:57Z","author_association":"CONTRIBUTOR","body":"Just out curiosity, where are you able to run multi-processing?\r\n```\r\nexport PYICEBERG_CONCURRENCY_MODE=process\r\nâžœ  docker-spark-iceberg git:(main) time python3 /tmp/vo.py                  \r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py\", line 116, in spawn_main\r\n    exitcode = _main(fd, parent_sentinel)\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py\", line 125, in _main\r\n    prepare(preparation_data)\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py\", line 236, in prepare\r\n    _fixup_main_from_path(data['init_main_from_path'])\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py\", line 287, in _fixup_main_from_path\r\n    main_content = runpy.run_path(main_path,\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py\", line 268, in run_path\r\n    return _run_module_code(code, init_globals, run_name,\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py\", line 97, in _run_module_code\r\n    _run_code(code, mod_globals, init_globals,\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py\", line 87, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/tmp/vo.py\", line 11, in <module>\r\n    df = table.scan().to_arrow()\r\n  File \"/Users/fokkodriesprong/Desktop/iceberg/python/pyiceberg/table/__init__.py\", line 825, in to_arrow\r\n    self.plan_files(),\r\n  File \"/Users/fokkodriesprong/Desktop/iceberg/python/pyiceberg/table/__init__.py\", line 784, in plan_files\r\n    *executor.map(\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/concurrent/futures/process.py\", line 726, in map\r\n    results = super().map(partial(_process_chunk, fn),\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/concurrent/futures/_base.py\", line 597, in map\r\n    fs = [self.submit(fn, *args) for args in zip(*iterables)]\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/concurrent/futures/_base.py\", line 597, in <listcomp>\r\n    fs = [self.submit(fn, *args) for args in zip(*iterables)]\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/concurrent/futures/process.py\", line 697, in submit\r\n    self._adjust_process_count()\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/concurrent/futures/process.py\", line 675, in _adjust_process_count\r\n    p.start()\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py\", line 121, in start\r\n    self._popen = self._Popen(self)\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/context.py\", line 284, in _Popen\r\n    return Popen(process_obj)\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/popen_spawn_posix.py\", line 32, in __init__\r\n    super().__init__(process_obj)\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/popen_fork.py\", line 19, in __init__\r\n    self._launch(process_obj)\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/popen_spawn_posix.py\", line 42, in _launch\r\n    prep_data = spawn.get_preparation_data(process_obj._name)\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py\", line 154, in get_preparation_data\r\n    _check_not_importing_main()\r\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py\", line 134, in _check_not_importing_main\r\n    raise RuntimeError('''\r\nRuntimeError: \r\n        An attempt has been made to start a new process before the\r\n        current process has finished its bootstrapping phase.\r\n\r\n        This probably means that you are not using fork to start your\r\n        child processes and you have forgotten to use the proper idiom\r\n        in the main module:\r\n\r\n            if __name__ == '__main__':\r\n                freeze_support()\r\n                ...\r\n\r\n        The \"freeze_support()\" line can be omitted if the program\r\n        is not going to be frozen to produce an executable.\r\n```\r\n\r\nWhere:\r\n```python\r\nfrom pyiceberg.catalog import load_catalog\r\n\r\ncatalog = load_catalog('local')\r\n\r\ntable = catalog.load_table('nyc.taxis')\r\n\r\nexpected_rows = 15885533\r\n\r\nfor _ in range(10):\r\n    df = table.scan().to_arrow()\r\n    assert len(df) == expected_rows, f\"Got {len(df)} rows, instead of {expected_rows}\"\r\n```\r\n\r\nAnd local points to my local [docker-spark-iceberg](https://github.com/tabular-io/docker-spark-iceberg/tree/main/spark) setup, so I don't have S3 latency.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634317651/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634491013","html_url":"https://github.com/apache/iceberg/pull/8042#issuecomment-1634491013","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8042","id":1634491013,"node_id":"IC_kwDOCW7NX85hbFqF","user":{"login":"namrathamyske","id":17932873,"node_id":"MDQ6VXNlcjE3OTMyODcz","avatar_url":"https://avatars.githubusercontent.com/u/17932873?v=4","gravatar_id":"","url":"https://api.github.com/users/namrathamyske","html_url":"https://github.com/namrathamyske","followers_url":"https://api.github.com/users/namrathamyske/followers","following_url":"https://api.github.com/users/namrathamyske/following{/other_user}","gists_url":"https://api.github.com/users/namrathamyske/gists{/gist_id}","starred_url":"https://api.github.com/users/namrathamyske/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/namrathamyske/subscriptions","organizations_url":"https://api.github.com/users/namrathamyske/orgs","repos_url":"https://api.github.com/users/namrathamyske/repos","events_url":"https://api.github.com/users/namrathamyske/events{/privacy}","received_events_url":"https://api.github.com/users/namrathamyske/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T15:51:08Z","updated_at":"2023-07-13T15:51:08Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer Added tests from spark 3.4 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634491013/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634520240","html_url":"https://github.com/apache/iceberg/pull/8051#issuecomment-1634520240","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8051","id":1634520240,"node_id":"IC_kwDOCW7NX85hbMyw","user":{"login":"puchengy","id":8072956,"node_id":"MDQ6VXNlcjgwNzI5NTY=","avatar_url":"https://avatars.githubusercontent.com/u/8072956?v=4","gravatar_id":"","url":"https://api.github.com/users/puchengy","html_url":"https://github.com/puchengy","followers_url":"https://api.github.com/users/puchengy/followers","following_url":"https://api.github.com/users/puchengy/following{/other_user}","gists_url":"https://api.github.com/users/puchengy/gists{/gist_id}","starred_url":"https://api.github.com/users/puchengy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puchengy/subscriptions","organizations_url":"https://api.github.com/users/puchengy/orgs","repos_url":"https://api.github.com/users/puchengy/repos","events_url":"https://api.github.com/users/puchengy/events{/privacy}","received_events_url":"https://api.github.com/users/puchengy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T16:11:26Z","updated_at":"2023-07-13T16:11:26Z","author_association":"CONTRIBUTOR","body":"@zinking Hi the reason is mentioned in the description. Copy here as well: https://github.com/apache/iceberg/issues/7949","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634520240/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634526199","html_url":"https://github.com/apache/iceberg/pull/7980#issuecomment-1634526199","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7980","id":1634526199,"node_id":"IC_kwDOCW7NX85hbOP3","user":{"login":"puchengy","id":8072956,"node_id":"MDQ6VXNlcjgwNzI5NTY=","avatar_url":"https://avatars.githubusercontent.com/u/8072956?v=4","gravatar_id":"","url":"https://api.github.com/users/puchengy","html_url":"https://github.com/puchengy","followers_url":"https://api.github.com/users/puchengy/followers","following_url":"https://api.github.com/users/puchengy/following{/other_user}","gists_url":"https://api.github.com/users/puchengy/gists{/gist_id}","starred_url":"https://api.github.com/users/puchengy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puchengy/subscriptions","organizations_url":"https://api.github.com/users/puchengy/orgs","repos_url":"https://api.github.com/users/puchengy/repos","events_url":"https://api.github.com/users/puchengy/events{/privacy}","received_events_url":"https://api.github.com/users/puchengy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T16:15:55Z","updated_at":"2023-07-13T16:15:55Z","author_association":"CONTRIBUTOR","body":"Would love to see this ported to 3.2 as well, thanks! Otherwise I can do it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634526199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634581398","html_url":"https://github.com/apache/iceberg/issues/7841#issuecomment-1634581398","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7841","id":1634581398,"node_id":"IC_kwDOCW7NX85hbbuW","user":{"login":"rahil-c","id":32500120,"node_id":"MDQ6VXNlcjMyNTAwMTIw","avatar_url":"https://avatars.githubusercontent.com/u/32500120?v=4","gravatar_id":"","url":"https://api.github.com/users/rahil-c","html_url":"https://github.com/rahil-c","followers_url":"https://api.github.com/users/rahil-c/followers","following_url":"https://api.github.com/users/rahil-c/following{/other_user}","gists_url":"https://api.github.com/users/rahil-c/gists{/gist_id}","starred_url":"https://api.github.com/users/rahil-c/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rahil-c/subscriptions","organizations_url":"https://api.github.com/users/rahil-c/orgs","repos_url":"https://api.github.com/users/rahil-c/repos","events_url":"https://api.github.com/users/rahil-c/events{/privacy}","received_events_url":"https://api.github.com/users/rahil-c/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T16:53:37Z","updated_at":"2023-07-13T16:53:37Z","author_association":"CONTRIBUTOR","body":"@nastra  Im also seeing this same stracktrace as well, so we would have to do a similar logic of this pr https://github.com/apache/iceberg/pull/7487 within the `GlueCatalog`?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634581398/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634585196","html_url":"https://github.com/apache/iceberg/issues/7841#issuecomment-1634585196","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7841","id":1634585196,"node_id":"IC_kwDOCW7NX85hbcps","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T16:55:47Z","updated_at":"2023-07-13T16:55:47Z","author_association":"CONTRIBUTOR","body":"@rahil-c yes, similar logic as #7487 would have to be done in `GlueTableOperations` (see my previous comment)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634585196/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634641623","html_url":"https://github.com/apache/iceberg/issues/8045#issuecomment-1634641623","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8045","id":1634641623,"node_id":"IC_kwDOCW7NX85hbqbX","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T17:36:33Z","updated_at":"2023-07-13T17:36:33Z","author_association":"COLLABORATOR","body":"I have a fix here:  #8059 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634641623/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634673153","html_url":"https://github.com/apache/iceberg/pull/8024#issuecomment-1634673153","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8024","id":1634673153,"node_id":"IC_kwDOCW7NX85hbyIB","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T18:01:07Z","updated_at":"2023-07-13T18:01:07Z","author_association":"COLLABORATOR","body":"Merged, thanks @hsiang-c !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634673153/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634687728","html_url":"https://github.com/apache/iceberg/pull/8015#issuecomment-1634687728","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8015","id":1634687728,"node_id":"IC_kwDOCW7NX85hb1rw","user":{"login":"mr-brobot","id":18426892,"node_id":"MDQ6VXNlcjE4NDI2ODky","avatar_url":"https://avatars.githubusercontent.com/u/18426892?v=4","gravatar_id":"","url":"https://api.github.com/users/mr-brobot","html_url":"https://github.com/mr-brobot","followers_url":"https://api.github.com/users/mr-brobot/followers","following_url":"https://api.github.com/users/mr-brobot/following{/other_user}","gists_url":"https://api.github.com/users/mr-brobot/gists{/gist_id}","starred_url":"https://api.github.com/users/mr-brobot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mr-brobot/subscriptions","organizations_url":"https://api.github.com/users/mr-brobot/orgs","repos_url":"https://api.github.com/users/mr-brobot/repos","events_url":"https://api.github.com/users/mr-brobot/events{/privacy}","received_events_url":"https://api.github.com/users/mr-brobot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T18:13:40Z","updated_at":"2023-07-13T22:39:47Z","author_association":"CONTRIBUTOR","body":"> Just out curiosity, where are you able to run multi-processing?\r\n\r\n@Fokko I was on Ubuntu [where the start method defaults to `fork`](https://docs.python.org/3/library/multiprocessing.html#contexts-and-start-methods). Since Windows & macOS default to the `spawn` method, and that is [considerably slower due to re-initialization of a new Python interpreter](https://peps.python.org/pep-0703/#multiprocessing), I think we should advise against multi-processing on these platforms in our documentation and perhaps log a warning.\r\n\r\nIn fact, in a previous version of this PR, I thought to fall back to multi-threading when the start mode was `spawn`:\r\n```python\r\ndef _mp_pref() -> bool:\r\n    \"\"\"Returns whether multiprocessing is preferred.\"\"\"\r\n    start_method = get_start_method()\r\n\r\n    if start_method != \"fork\":\r\n        logger.debug(\"Multi-processing not preferred in current runtime: start_method=%s\", start_method)\r\n        return False\r\n\r\n    return start_method == \"fork\"\r\n```\r\n\r\nI'll add some documentation after I do some testing with process spawning on Windows & macOS. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634687728/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634809059","html_url":"https://github.com/apache/iceberg/pull/8059#issuecomment-1634809059","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8059","id":1634809059,"node_id":"IC_kwDOCW7NX85hcTTj","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T19:42:00Z","updated_at":"2023-07-13T19:42:00Z","author_association":"COLLABORATOR","body":"@aokolnychyi  added a test with partition transform (as discussed offline )","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634809059/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634971827","html_url":"https://github.com/apache/iceberg/pull/7295#issuecomment-1634971827","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7295","id":1634971827,"node_id":"IC_kwDOCW7NX85hc7Cz","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T21:57:23Z","updated_at":"2023-07-13T21:57:23Z","author_association":"CONTRIBUTOR","body":"I think this is a good idea. I'll put it in my queue to review.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1634971827/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635052735","html_url":"https://github.com/apache/iceberg/pull/7933#issuecomment-1635052735","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7933","id":1635052735,"node_id":"IC_kwDOCW7NX85hdOy_","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T23:29:03Z","updated_at":"2023-07-13T23:29:03Z","author_association":"COLLABORATOR","body":"Merged, thanks @ConeyLiu , and all for the reviews!\r\n\r\n@ConeyLiu can you make a pr to merge to 1.3.1?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635052735/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635053607","html_url":"https://github.com/apache/iceberg/pull/8021#issuecomment-1635053607","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8021","id":1635053607,"node_id":"IC_kwDOCW7NX85hdPAn","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T23:30:21Z","updated_at":"2023-07-13T23:30:21Z","author_association":"COLLABORATOR","body":"Merged, thanks @hsiang-c , and @dramaticlly for extra review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635053607/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635061515","html_url":"https://github.com/apache/iceberg/pull/7636#issuecomment-1635061515","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7636","id":1635061515,"node_id":"IC_kwDOCW7NX85hdQ8L","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-13T23:44:00Z","updated_at":"2023-07-14T03:22:25Z","author_association":"COLLABORATOR","body":"@RussellSpitzer was this close, and do you think it should go to 1.3.1?\r\n\r\nEdit: realize its already disabled, so i guess it should not go into 1.3.1, as its a new feature and not a bug fix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635061515/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635079036","html_url":"https://github.com/apache/iceberg/issues/6523#issuecomment-1635079036","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6523","id":1635079036,"node_id":"IC_kwDOCW7NX85hdVN8","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T00:14:01Z","updated_at":"2023-07-14T00:14:01Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635079036/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635079083","html_url":"https://github.com/apache/iceberg/issues/5675#issuecomment-1635079083","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5675","id":1635079083,"node_id":"IC_kwDOCW7NX85hdVOr","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T00:14:06Z","updated_at":"2023-07-14T00:14:06Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635079083/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635124150","html_url":"https://github.com/apache/iceberg/issues/7949#issuecomment-1635124150","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7949","id":1635124150,"node_id":"IC_kwDOCW7NX85hdgO2","user":{"login":"zinking","id":118241,"node_id":"MDQ6VXNlcjExODI0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/118241?v=4","gravatar_id":"","url":"https://api.github.com/users/zinking","html_url":"https://github.com/zinking","followers_url":"https://api.github.com/users/zinking/followers","following_url":"https://api.github.com/users/zinking/following{/other_user}","gists_url":"https://api.github.com/users/zinking/gists{/gist_id}","starred_url":"https://api.github.com/users/zinking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zinking/subscriptions","organizations_url":"https://api.github.com/users/zinking/orgs","repos_url":"https://api.github.com/users/zinking/repos","events_url":"https://api.github.com/users/zinking/events{/privacy}","received_events_url":"https://api.github.com/users/zinking/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T01:25:28Z","updated_at":"2023-07-14T01:25:28Z","author_association":"CONTRIBUTOR","body":"guess the question is still the same, if the file is empty with records, why is it included in the commit in the first place? isn't that supposed to be fixed?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635124150/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635128922","html_url":"https://github.com/apache/iceberg/issues/7949#issuecomment-1635128922","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7949","id":1635128922,"node_id":"IC_kwDOCW7NX85hdhZa","user":{"login":"puchengy","id":8072956,"node_id":"MDQ6VXNlcjgwNzI5NTY=","avatar_url":"https://avatars.githubusercontent.com/u/8072956?v=4","gravatar_id":"","url":"https://api.github.com/users/puchengy","html_url":"https://github.com/puchengy","followers_url":"https://api.github.com/users/puchengy/followers","following_url":"https://api.github.com/users/puchengy/following{/other_user}","gists_url":"https://api.github.com/users/puchengy/gists{/gist_id}","starred_url":"https://api.github.com/users/puchengy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puchengy/subscriptions","organizations_url":"https://api.github.com/users/puchengy/orgs","repos_url":"https://api.github.com/users/puchengy/repos","events_url":"https://api.github.com/users/puchengy/events{/privacy}","received_events_url":"https://api.github.com/users/puchengy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T01:32:40Z","updated_at":"2023-07-14T01:32:40Z","author_association":"CONTRIBUTOR","body":"@zinking I see what you mean, it is hard to fix the source since these files are produced by various engines.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635128922/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635166281","html_url":"https://github.com/apache/iceberg/pull/8015#issuecomment-1635166281","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8015","id":1635166281,"node_id":"IC_kwDOCW7NX85hdqhJ","user":{"login":"mr-brobot","id":18426892,"node_id":"MDQ6VXNlcjE4NDI2ODky","avatar_url":"https://avatars.githubusercontent.com/u/18426892?v=4","gravatar_id":"","url":"https://api.github.com/users/mr-brobot","html_url":"https://github.com/mr-brobot","followers_url":"https://api.github.com/users/mr-brobot/followers","following_url":"https://api.github.com/users/mr-brobot/following{/other_user}","gists_url":"https://api.github.com/users/mr-brobot/gists{/gist_id}","starred_url":"https://api.github.com/users/mr-brobot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mr-brobot/subscriptions","organizations_url":"https://api.github.com/users/mr-brobot/orgs","repos_url":"https://api.github.com/users/mr-brobot/repos","events_url":"https://api.github.com/users/mr-brobot/events{/privacy}","received_events_url":"https://api.github.com/users/mr-brobot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T02:14:08Z","updated_at":"2023-07-14T04:00:14Z","author_association":"CONTRIBUTOR","body":"@Fokko After some more testing in other platforms, I'm of the opinion that multi-processing support should be considered separately from simply making PyIceberg work in serverless environments. \r\n\r\n1. Making PyIceberg work in serverless is simple. Replacing usage of `multiprocessing.pool.ThreadPool` and related synchronization concepts with `concurrent.futures.ThreadPoolExecutor` and the corresponding synchronization concepts in `threading`.\r\n2. Making PyIceberg support multi-processing adds variability across platforms and would require more care when introducing future changes (e.g., ensuring that everything parallelized by an executor can be pickled).\r\n\r\nI'm going to close this and reopen a separate PR focused on (1). For (2), I will create yet another PR where I will dedicate more attention to testing all platforms and possibly some benchmarks that prove the ROI.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635166281/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635175421","html_url":"https://github.com/apache/iceberg/pull/7933#issuecomment-1635175421","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7933","id":1635175421,"node_id":"IC_kwDOCW7NX85hdsv9","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T02:28:15Z","updated_at":"2023-07-14T02:28:15Z","author_association":"CONTRIBUTOR","body":"Thanks @szehon-ho for merging this and thanks @RussellSpitzer @chenjunjiedada @stevenzwu @yananli-ebay for reviewing.\r\n\r\nPR for 1.3.x submitted.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635175421/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635176284","html_url":"https://github.com/apache/iceberg/pull/8060#issuecomment-1635176284","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8060","id":1635176284,"node_id":"IC_kwDOCW7NX85hds9c","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T02:29:37Z","updated_at":"2023-07-14T02:29:37Z","author_association":"CONTRIBUTOR","body":"@szehon-ho, this is a clean port, just cherry-pick.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635176284/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635177219","html_url":"https://github.com/apache/iceberg/issues/7949#issuecomment-1635177219","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7949","id":1635177219,"node_id":"IC_kwDOCW7NX85hdtMD","user":{"login":"zinking","id":118241,"node_id":"MDQ6VXNlcjExODI0MQ==","avatar_url":"https://avatars.githubusercontent.com/u/118241?v=4","gravatar_id":"","url":"https://api.github.com/users/zinking","html_url":"https://github.com/zinking","followers_url":"https://api.github.com/users/zinking/followers","following_url":"https://api.github.com/users/zinking/following{/other_user}","gists_url":"https://api.github.com/users/zinking/gists{/gist_id}","starred_url":"https://api.github.com/users/zinking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zinking/subscriptions","organizations_url":"https://api.github.com/users/zinking/orgs","repos_url":"https://api.github.com/users/zinking/repos","events_url":"https://api.github.com/users/zinking/events{/privacy}","received_events_url":"https://api.github.com/users/zinking/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T02:31:03Z","updated_at":"2023-07-14T02:31:03Z","author_association":"CONTRIBUTOR","body":"not really at the various engine side, but actually at the moment when it is included into iceberg. or to be precise during the `commit` process of iceberg, we can simply check and discard those empty files. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635177219/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635208101","html_url":"https://github.com/apache/iceberg/issues/7949#issuecomment-1635208101","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7949","id":1635208101,"node_id":"IC_kwDOCW7NX85hd0ul","user":{"login":"puchengy","id":8072956,"node_id":"MDQ6VXNlcjgwNzI5NTY=","avatar_url":"https://avatars.githubusercontent.com/u/8072956?v=4","gravatar_id":"","url":"https://api.github.com/users/puchengy","html_url":"https://github.com/puchengy","followers_url":"https://api.github.com/users/puchengy/followers","following_url":"https://api.github.com/users/puchengy/following{/other_user}","gists_url":"https://api.github.com/users/puchengy/gists{/gist_id}","starred_url":"https://api.github.com/users/puchengy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puchengy/subscriptions","organizations_url":"https://api.github.com/users/puchengy/orgs","repos_url":"https://api.github.com/users/puchengy/repos","events_url":"https://api.github.com/users/puchengy/events{/privacy}","received_events_url":"https://api.github.com/users/puchengy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T03:20:32Z","updated_at":"2023-07-14T03:20:32Z","author_association":"CONTRIBUTOR","body":"@zinking https://github.com/apache/iceberg/pull/8040 is already doing this","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635208101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635214971","html_url":"https://github.com/apache/iceberg/pull/7980#issuecomment-1635214971","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7980","id":1635214971,"node_id":"IC_kwDOCW7NX85hd2Z7","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T03:28:35Z","updated_at":"2023-07-14T03:28:35Z","author_association":"CONTRIBUTOR","body":"Sure I'll open a PR for other spark versions.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635214971/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635216327","html_url":"https://github.com/apache/iceberg/issues/7040#issuecomment-1635216327","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7040","id":1635216327,"node_id":"IC_kwDOCW7NX85hd2vH","user":{"login":"coded9","id":9302330,"node_id":"MDQ6VXNlcjkzMDIzMzA=","avatar_url":"https://avatars.githubusercontent.com/u/9302330?v=4","gravatar_id":"","url":"https://api.github.com/users/coded9","html_url":"https://github.com/coded9","followers_url":"https://api.github.com/users/coded9/followers","following_url":"https://api.github.com/users/coded9/following{/other_user}","gists_url":"https://api.github.com/users/coded9/gists{/gist_id}","starred_url":"https://api.github.com/users/coded9/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coded9/subscriptions","organizations_url":"https://api.github.com/users/coded9/orgs","repos_url":"https://api.github.com/users/coded9/repos","events_url":"https://api.github.com/users/coded9/events{/privacy}","received_events_url":"https://api.github.com/users/coded9/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T03:31:07Z","updated_at":"2023-07-14T03:31:07Z","author_association":"CONTRIBUTOR","body":"Are you on iceberg slack channel ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635216327/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635238669","html_url":"https://github.com/apache/iceberg/pull/8015#issuecomment-1635238669","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8015","id":1635238669,"node_id":"IC_kwDOCW7NX85hd8MN","user":{"login":"corleyma","id":2080732,"node_id":"MDQ6VXNlcjIwODA3MzI=","avatar_url":"https://avatars.githubusercontent.com/u/2080732?v=4","gravatar_id":"","url":"https://api.github.com/users/corleyma","html_url":"https://github.com/corleyma","followers_url":"https://api.github.com/users/corleyma/followers","following_url":"https://api.github.com/users/corleyma/following{/other_user}","gists_url":"https://api.github.com/users/corleyma/gists{/gist_id}","starred_url":"https://api.github.com/users/corleyma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/corleyma/subscriptions","organizations_url":"https://api.github.com/users/corleyma/orgs","repos_url":"https://api.github.com/users/corleyma/repos","events_url":"https://api.github.com/users/corleyma/events{/privacy}","received_events_url":"https://api.github.com/users/corleyma/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T04:08:25Z","updated_at":"2023-07-14T04:08:25Z","author_association":"NONE","body":"I think that's  a great call!  Multiprocessing is tricky to get right, would be good to know the juice is worth the squeeze.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635238669/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635242090","html_url":"https://github.com/apache/iceberg/pull/8042#issuecomment-1635242090","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8042","id":1635242090,"node_id":"IC_kwDOCW7NX85hd9Bq","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T04:13:57Z","updated_at":"2023-07-14T04:13:57Z","author_association":"CONTRIBUTOR","body":"@namrathamyske Thanks for making this PR! The approach looks reasonable to me. I have left a few minor comments for style.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635242090/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635421623","html_url":"https://github.com/apache/iceberg/pull/8050#issuecomment-1635421623","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8050","id":1635421623,"node_id":"IC_kwDOCW7NX85heo23","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-07-14T07:26:53Z","updated_at":"2023-07-14T07:26:53Z","author_association":"CONTRIBUTOR","body":"Thanks @zinking @nastra for the review, and @szehon-ho for adding the milestone. Let me create the backport right away","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1635421623/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]