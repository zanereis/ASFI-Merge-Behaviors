[{"url":"https://api.github.com/repos/apache/brpc/issues/comments/487459591","html_url":"https://github.com/apache/brpc/issues/751#issuecomment-487459591","issue_url":"https://api.github.com/repos/apache/brpc/issues/751","id":487459591,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4NzQ1OTU5MQ==","user":{"login":"jasonszang","id":19163259,"node_id":"MDQ6VXNlcjE5MTYzMjU5","avatar_url":"https://avatars.githubusercontent.com/u/19163259?v=4","gravatar_id":"","url":"https://api.github.com/users/jasonszang","html_url":"https://github.com/jasonszang","followers_url":"https://api.github.com/users/jasonszang/followers","following_url":"https://api.github.com/users/jasonszang/following{/other_user}","gists_url":"https://api.github.com/users/jasonszang/gists{/gist_id}","starred_url":"https://api.github.com/users/jasonszang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasonszang/subscriptions","organizations_url":"https://api.github.com/users/jasonszang/orgs","repos_url":"https://api.github.com/users/jasonszang/repos","events_url":"https://api.github.com/users/jasonszang/events{/privacy}","received_events_url":"https://api.github.com/users/jasonszang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-04-29T06:03:27Z","updated_at":"2019-04-29T06:03:27Z","author_association":"CONTRIBUTOR","body":"Guess they wanted `capacity`","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/487459591/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/487818461","html_url":"https://github.com/apache/brpc/issues/747#issuecomment-487818461","issue_url":"https://api.github.com/repos/apache/brpc/issues/747","id":487818461,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4NzgxODQ2MQ==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-04-30T04:31:24Z","updated_at":"2019-04-30T04:31:24Z","author_association":"CONTRIBUTOR","body":"如果如你所说，可以使builtin service从另外的port上start。也可以配置builtin service自己的鉴权（和业务服务区分开来）。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/487818461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/487835921","html_url":"https://github.com/apache/brpc/pull/570#issuecomment-487835921","issue_url":"https://api.github.com/repos/apache/brpc/issues/570","id":487835921,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4NzgzNTkyMQ==","user":{"login":"hairet","id":7167017,"node_id":"MDQ6VXNlcjcxNjcwMTc=","avatar_url":"https://avatars.githubusercontent.com/u/7167017?v=4","gravatar_id":"","url":"https://api.github.com/users/hairet","html_url":"https://github.com/hairet","followers_url":"https://api.github.com/users/hairet/followers","following_url":"https://api.github.com/users/hairet/following{/other_user}","gists_url":"https://api.github.com/users/hairet/gists{/gist_id}","starred_url":"https://api.github.com/users/hairet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hairet/subscriptions","organizations_url":"https://api.github.com/users/hairet/orgs","repos_url":"https://api.github.com/users/hairet/repos","events_url":"https://api.github.com/users/hairet/events{/privacy}","received_events_url":"https://api.github.com/users/hairet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-04-30T06:39:50Z","updated_at":"2019-04-30T06:39:50Z","author_association":"NONE","body":"> 在应用层面解决这个需求有什么缺陷么？bthread层面的改动成本太高了，无法单纯地从code review和单测中判断这些代码的影响面。\r\n\r\n由于bthread的调度存在steal,然后IO层入包parse出多个包QueueMessage给多个bthread处理，导致一个问题，同一个tcp前端发来多个包，在svr这边处理的时候会乱序（有些业务有排队需求）\r\n业务层不太好做排序，因为乱序来自好几个地方，特别明显的就是我前面说的OnNewMessages->QueueMessage那里。\r\n\r\n我暂时只能通过单测，以及明显代码级别不影响老代码(即整个串行化开关是纯新代码)来保证安全，还有一大部分代码没有提交。我晚点经过实战验证，再把相关代码做干净的整理提PR吧","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/487835921/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/487843248","html_url":"https://github.com/apache/brpc/issues/752#issuecomment-487843248","issue_url":"https://api.github.com/repos/apache/brpc/issues/752","id":487843248,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4Nzg0MzI0OA==","user":{"login":"kenshinxf","id":7056720,"node_id":"MDQ6VXNlcjcwNTY3MjA=","avatar_url":"https://avatars.githubusercontent.com/u/7056720?v=4","gravatar_id":"","url":"https://api.github.com/users/kenshinxf","html_url":"https://github.com/kenshinxf","followers_url":"https://api.github.com/users/kenshinxf/followers","following_url":"https://api.github.com/users/kenshinxf/following{/other_user}","gists_url":"https://api.github.com/users/kenshinxf/gists{/gist_id}","starred_url":"https://api.github.com/users/kenshinxf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kenshinxf/subscriptions","organizations_url":"https://api.github.com/users/kenshinxf/orgs","repos_url":"https://api.github.com/users/kenshinxf/repos","events_url":"https://api.github.com/users/kenshinxf/events{/privacy}","received_events_url":"https://api.github.com/users/kenshinxf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-04-30T07:15:29Z","updated_at":"2019-04-30T07:15:29Z","author_association":"NONE","body":"please keep consistent with std::shared_ptr or boost::shared_ptr while compiling thrift, brpc and your example","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/487843248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/487844167","html_url":"https://github.com/apache/brpc/issues/743#issuecomment-487844167","issue_url":"https://api.github.com/repos/apache/brpc/issues/743","id":487844167,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4Nzg0NDE2Nw==","user":{"login":"kenshinxf","id":7056720,"node_id":"MDQ6VXNlcjcwNTY3MjA=","avatar_url":"https://avatars.githubusercontent.com/u/7056720?v=4","gravatar_id":"","url":"https://api.github.com/users/kenshinxf","html_url":"https://github.com/kenshinxf","followers_url":"https://api.github.com/users/kenshinxf/followers","following_url":"https://api.github.com/users/kenshinxf/following{/other_user}","gists_url":"https://api.github.com/users/kenshinxf/gists{/gist_id}","starred_url":"https://api.github.com/users/kenshinxf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kenshinxf/subscriptions","organizations_url":"https://api.github.com/users/kenshinxf/orgs","repos_url":"https://api.github.com/users/kenshinxf/repos","events_url":"https://api.github.com/users/kenshinxf/events{/privacy}","received_events_url":"https://api.github.com/users/kenshinxf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-04-30T07:19:35Z","updated_at":"2019-04-30T07:19:35Z","author_association":"NONE","body":"> 直接重启一台下游服务； 没有复现这个问题？ 直接channel单连接一台下游服务试试；我昨天复现无数次了； 现在线上的服务改成半异步才好； 要不行我等下再试试； 然后整个程序包你也一起看看；\r\n\r\n不太明白为啥channel连接下游一台服务器而不是下游集群， 这样的目的是？这样下游重启的时候，你的上游客户端岂不是都访问失败了？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/487844167/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/487846000","html_url":"https://github.com/apache/brpc/issues/743#issuecomment-487846000","issue_url":"https://api.github.com/repos/apache/brpc/issues/743","id":487846000,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4Nzg0NjAwMA==","user":{"login":"cauchy1988","id":7292411,"node_id":"MDQ6VXNlcjcyOTI0MTE=","avatar_url":"https://avatars.githubusercontent.com/u/7292411?v=4","gravatar_id":"","url":"https://api.github.com/users/cauchy1988","html_url":"https://github.com/cauchy1988","followers_url":"https://api.github.com/users/cauchy1988/followers","following_url":"https://api.github.com/users/cauchy1988/following{/other_user}","gists_url":"https://api.github.com/users/cauchy1988/gists{/gist_id}","starred_url":"https://api.github.com/users/cauchy1988/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cauchy1988/subscriptions","organizations_url":"https://api.github.com/users/cauchy1988/orgs","repos_url":"https://api.github.com/users/cauchy1988/repos","events_url":"https://api.github.com/users/cauchy1988/events{/privacy}","received_events_url":"https://api.github.com/users/cauchy1988/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-04-30T07:27:05Z","updated_at":"2019-04-30T07:27:05Z","author_association":"NONE","body":"> > 直接重启一台下游服务； 没有复现这个问题？ 直接channel单连接一台下游服务试试；我昨天复现无数次了； 现在线上的服务改成半异步才好； 要不行我等下再试试； 然后整个程序包你也一起看看；\r\n> \r\n> 不太明白为啥channel连接下游一台服务器而不是下游集群， 这样的目的是？这样下游重启的时候，你的上游客户端岂不是都访问失败了？\r\n\r\n原因是这样的， 我们目前仍旧使用zookeeper作为服务发现的组件； 然后又没有针对brpc开发brpc的zookeeper服务发现插件； 所以目前比较low地用使用不同的channel 连不同的ip； 然后\"服务发现”的逻辑我们自己在这层抽象上实现的： 比如发现某台服务失活了， 会erase掉对应的channel， 先这样理解吧； 确实不太好；","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/487846000/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489328891","html_url":"https://github.com/apache/brpc/issues/742#issuecomment-489328891","issue_url":"https://api.github.com/repos/apache/brpc/issues/742","id":489328891,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTMyODg5MQ==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-04T13:50:57Z","updated_at":"2019-05-04T13:50:57Z","author_association":"CONTRIBUTOR","body":"不支持32位系统。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489328891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489329080","html_url":"https://github.com/apache/brpc/issues/743#issuecomment-489329080","issue_url":"https://api.github.com/repos/apache/brpc/issues/743","id":489329080,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTMyOTA4MA==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-04T13:53:12Z","updated_at":"2019-05-04T13:53:12Z","author_association":"CONTRIBUTOR","body":"这个问题看起来和你们自研的“服务发现”逻辑有比较密切的关联。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489329080/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489329192","html_url":"https://github.com/apache/brpc/issues/744#issuecomment-489329192","issue_url":"https://api.github.com/repos/apache/brpc/issues/744","id":489329192,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTMyOTE5Mg==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-04T13:54:54Z","updated_at":"2019-05-04T13:54:54Z","author_association":"CONTRIBUTOR","body":"@haolujun 你的回复中对connection_type的描述是不是有些问题？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489329192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489329626","html_url":"https://github.com/apache/brpc/issues/750#issuecomment-489329626","issue_url":"https://api.github.com/repos/apache/brpc/issues/750","id":489329626,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTMyOTYyNg==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-04T14:01:12Z","updated_at":"2019-05-04T14:01:12Z","author_association":"CONTRIBUTOR","body":"一个是rpc的错误码，一个是http的status，两者会尽量一致，因为一些用户可能会习惯性地只看http的status而不判定cntl->Failed()与否，丛直觉上来说，这种代码应该仍能够正确运行。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489329626/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489329698","html_url":"https://github.com/apache/brpc/issues/751#issuecomment-489329698","issue_url":"https://api.github.com/repos/apache/brpc/issues/751","id":489329698,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTMyOTY5OA==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-04T14:01:58Z","updated_at":"2019-05-04T14:01:58Z","author_association":"CONTRIBUTOR","body":"@jasonszang yes, this is a typo","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489329698/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489330024","html_url":"https://github.com/apache/brpc/issues/753#issuecomment-489330024","issue_url":"https://api.github.com/repos/apache/brpc/issues/753","id":489330024,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTMzMDAyNA==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-04T14:05:56Z","updated_at":"2019-05-04T14:05:56Z","author_association":"CONTRIBUTOR","body":"内外版本目录结构、命名空间、包含代码差异还是比较多的，所以很难自动化地patch。之前的方案是：开源版本中有一个[patch_from_baidu](https://github.com/apache/incubator-brpc/blob/master/tools/patch_from_baidu)，内部版本中有一个patch_from_github，然后定期手动同步，大部分diff都是可以自动patch的，所以工作量还好。但这个工作并没有明确的文档，所以我就不清楚目前的状况了。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489330024/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489393004","html_url":"https://github.com/apache/brpc/pull/570#issuecomment-489393004","issue_url":"https://api.github.com/repos/apache/brpc/issues/570","id":489393004,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTM5MzAwNA==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-05T05:55:22Z","updated_at":"2019-05-05T05:55:22Z","author_association":"CONTRIBUTOR","body":"需要有序用[streaming rpc](https://github.com/apache/incubator-brpc/blob/master/docs/cn/streaming_rpc.md)","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489393004/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489408599","html_url":"https://github.com/apache/brpc/issues/165#issuecomment-489408599","issue_url":"https://api.github.com/repos/apache/brpc/issues/165","id":489408599,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTQwODU5OQ==","user":{"login":"Xavier1994","id":11145343,"node_id":"MDQ6VXNlcjExMTQ1MzQz","avatar_url":"https://avatars.githubusercontent.com/u/11145343?v=4","gravatar_id":"","url":"https://api.github.com/users/Xavier1994","html_url":"https://github.com/Xavier1994","followers_url":"https://api.github.com/users/Xavier1994/followers","following_url":"https://api.github.com/users/Xavier1994/following{/other_user}","gists_url":"https://api.github.com/users/Xavier1994/gists{/gist_id}","starred_url":"https://api.github.com/users/Xavier1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Xavier1994/subscriptions","organizations_url":"https://api.github.com/users/Xavier1994/orgs","repos_url":"https://api.github.com/users/Xavier1994/repos","events_url":"https://api.github.com/users/Xavier1994/events{/privacy}","received_events_url":"https://api.github.com/users/Xavier1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-05T09:31:42Z","updated_at":"2019-05-05T09:31:42Z","author_association":"NONE","body":"我也遇到了这个问题, bt也是展示了core在brpc里, 所以应该怎么看到core在我业务代码的backtrace上","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489408599/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489408867","html_url":"https://github.com/apache/brpc/issues/165#issuecomment-489408867","issue_url":"https://api.github.com/repos/apache/brpc/issues/165","id":489408867,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTQwODg2Nw==","user":{"login":"d0ngjun","id":3346718,"node_id":"MDQ6VXNlcjMzNDY3MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3346718?v=4","gravatar_id":"","url":"https://api.github.com/users/d0ngjun","html_url":"https://github.com/d0ngjun","followers_url":"https://api.github.com/users/d0ngjun/followers","following_url":"https://api.github.com/users/d0ngjun/following{/other_user}","gists_url":"https://api.github.com/users/d0ngjun/gists{/gist_id}","starred_url":"https://api.github.com/users/d0ngjun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/d0ngjun/subscriptions","organizations_url":"https://api.github.com/users/d0ngjun/orgs","repos_url":"https://api.github.com/users/d0ngjun/repos","events_url":"https://api.github.com/users/d0ngjun/events{/privacy}","received_events_url":"https://api.github.com/users/d0ngjun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-05T09:34:54Z","updated_at":"2019-05-05T09:34:54Z","author_association":"NONE","body":"我的做法是在回调内写一个大的try catch，这样可以捕获，避免brpc“吞掉”异常。\r\n或者可以在关键代码块附近添加log，可以辅助判断","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489408867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489410109","html_url":"https://github.com/apache/brpc/issues/165#issuecomment-489410109","issue_url":"https://api.github.com/repos/apache/brpc/issues/165","id":489410109,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTQxMDEwOQ==","user":{"login":"Xavier1994","id":11145343,"node_id":"MDQ6VXNlcjExMTQ1MzQz","avatar_url":"https://avatars.githubusercontent.com/u/11145343?v=4","gravatar_id":"","url":"https://api.github.com/users/Xavier1994","html_url":"https://github.com/Xavier1994","followers_url":"https://api.github.com/users/Xavier1994/followers","following_url":"https://api.github.com/users/Xavier1994/following{/other_user}","gists_url":"https://api.github.com/users/Xavier1994/gists{/gist_id}","starred_url":"https://api.github.com/users/Xavier1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Xavier1994/subscriptions","organizations_url":"https://api.github.com/users/Xavier1994/orgs","repos_url":"https://api.github.com/users/Xavier1994/repos","events_url":"https://api.github.com/users/Xavier1994/events{/privacy}","received_events_url":"https://api.github.com/users/Xavier1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-05T09:51:40Z","updated_at":"2019-05-05T09:51:52Z","author_association":"NONE","body":"@scottzzq 请教一下你的后面一个与业务逻辑相关的backtrace是如何打出来的","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489410109/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489419591","html_url":"https://github.com/apache/brpc/issues/165#issuecomment-489419591","issue_url":"https://api.github.com/repos/apache/brpc/issues/165","id":489419591,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTQxOTU5MQ==","user":{"login":"Xavier1994","id":11145343,"node_id":"MDQ6VXNlcjExMTQ1MzQz","avatar_url":"https://avatars.githubusercontent.com/u/11145343?v=4","gravatar_id":"","url":"https://api.github.com/users/Xavier1994","html_url":"https://github.com/Xavier1994","followers_url":"https://api.github.com/users/Xavier1994/followers","following_url":"https://api.github.com/users/Xavier1994/following{/other_user}","gists_url":"https://api.github.com/users/Xavier1994/gists{/gist_id}","starred_url":"https://api.github.com/users/Xavier1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Xavier1994/subscriptions","organizations_url":"https://api.github.com/users/Xavier1994/orgs","repos_url":"https://api.github.com/users/Xavier1994/repos","events_url":"https://api.github.com/users/Xavier1994/events{/privacy}","received_events_url":"https://api.github.com/users/Xavier1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-05T11:59:11Z","updated_at":"2019-05-05T11:59:11Z","author_association":"NONE","body":"@d0ngjun 可以在brpc回调的函数都加上noexcept, 然后core的时候backtrace就会出来 ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489419591/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489511517","html_url":"https://github.com/apache/brpc/issues/753#issuecomment-489511517","issue_url":"https://api.github.com/repos/apache/brpc/issues/753","id":489511517,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTUxMTUxNw==","user":{"login":"Ye-Tian-Zero","id":8231208,"node_id":"MDQ6VXNlcjgyMzEyMDg=","avatar_url":"https://avatars.githubusercontent.com/u/8231208?v=4","gravatar_id":"","url":"https://api.github.com/users/Ye-Tian-Zero","html_url":"https://github.com/Ye-Tian-Zero","followers_url":"https://api.github.com/users/Ye-Tian-Zero/followers","following_url":"https://api.github.com/users/Ye-Tian-Zero/following{/other_user}","gists_url":"https://api.github.com/users/Ye-Tian-Zero/gists{/gist_id}","starred_url":"https://api.github.com/users/Ye-Tian-Zero/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ye-Tian-Zero/subscriptions","organizations_url":"https://api.github.com/users/Ye-Tian-Zero/orgs","repos_url":"https://api.github.com/users/Ye-Tian-Zero/repos","events_url":"https://api.github.com/users/Ye-Tian-Zero/events{/privacy}","received_events_url":"https://api.github.com/users/Ye-Tian-Zero/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-06T06:21:08Z","updated_at":"2019-05-06T06:21:08Z","author_association":"CONTRIBUTOR","body":"嗯嗯，我看github的版本已经增加了不少feature，确实不太好同步，谢谢。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489511517/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489926254","html_url":"https://github.com/apache/brpc/issues/743#issuecomment-489926254","issue_url":"https://api.github.com/repos/apache/brpc/issues/743","id":489926254,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTkyNjI1NA==","user":{"login":"kenshinxf","id":7056720,"node_id":"MDQ6VXNlcjcwNTY3MjA=","avatar_url":"https://avatars.githubusercontent.com/u/7056720?v=4","gravatar_id":"","url":"https://api.github.com/users/kenshinxf","html_url":"https://github.com/kenshinxf","followers_url":"https://api.github.com/users/kenshinxf/followers","following_url":"https://api.github.com/users/kenshinxf/following{/other_user}","gists_url":"https://api.github.com/users/kenshinxf/gists{/gist_id}","starred_url":"https://api.github.com/users/kenshinxf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kenshinxf/subscriptions","organizations_url":"https://api.github.com/users/kenshinxf/orgs","repos_url":"https://api.github.com/users/kenshinxf/repos","events_url":"https://api.github.com/users/kenshinxf/events{/privacy}","received_events_url":"https://api.github.com/users/kenshinxf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-07T06:28:56Z","updated_at":"2019-05-07T06:29:33Z","author_association":"NONE","body":"> > > 直接重启一台下游服务； 没有复现这个问题？ 直接channel单连接一台下游服务试试；我昨天复现无数次了； 现在线上的服务改成半异步才好； 要不行我等下再试试； 然后整个程序包你也一起看看；\r\n> > \r\n> > \r\n> > 不太明白为啥channel连接下游一台服务器而不是下游集群， 这样的目的是？这样下游重启的时候，你的上游客户端岂不是都访问失败了？\r\n> \r\n> 原因是这样的， 我们目前仍旧使用zookeeper作为服务发现的组件； 然后又没有针对brpc开发brpc的zookeeper服务发现插件； 所以目前比较low地用使用不同的channel 连不同的ip； 然后\"服务发现”的逻辑我们自己在这层抽象上实现的： 比如发现某台服务失活了， 会erase掉对应的channel， 先这样理解吧； 确实不太好；\r\n\r\n我说一下我们之前是怎么使用类似zk/etcd/consul/xxx服务发现的方案吧\r\nbrpc channel init的时候支持file类型的ip列表， 在ip列表有变化的时候brpc会自动更新， 所以我们就简单的在自己的服务里面启动一个获取ip列表的背景线程， 然后在有ip列表变化的时候更新那个文件（更新文件的时候要用mv的方式， 防止读写冲突）， 这样就和任意一个服务发现方式解耦了， 无论用那种服务发现最终都是调用获取ip接口，然后更新文件， 所以个人感觉brpc也没太大的必要集成各类服务发现\r\n这样你的用户层代码一个下游就一个channel就搞定了","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/489926254/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/490032908","html_url":"https://github.com/apache/brpc/issues/744#issuecomment-490032908","issue_url":"https://api.github.com/repos/apache/brpc/issues/744","id":490032908,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDAzMjkwOA==","user":{"login":"haolujun","id":10751631,"node_id":"MDQ6VXNlcjEwNzUxNjMx","avatar_url":"https://avatars.githubusercontent.com/u/10751631?v=4","gravatar_id":"","url":"https://api.github.com/users/haolujun","html_url":"https://github.com/haolujun","followers_url":"https://api.github.com/users/haolujun/followers","following_url":"https://api.github.com/users/haolujun/following{/other_user}","gists_url":"https://api.github.com/users/haolujun/gists{/gist_id}","starred_url":"https://api.github.com/users/haolujun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haolujun/subscriptions","organizations_url":"https://api.github.com/users/haolujun/orgs","repos_url":"https://api.github.com/users/haolujun/repos","events_url":"https://api.github.com/users/haolujun/events{/privacy}","received_events_url":"https://api.github.com/users/haolujun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-07T10:59:41Z","updated_at":"2019-05-07T10:59:41Z","author_association":"NONE","body":"多谢提醒，是描述的有问题。 是connection_type为single时，会出现超时。把connection_type改成short或者pooled后，就不会有超时现象了。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/490032908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/490388197","html_url":"https://github.com/apache/brpc/pull/465#issuecomment-490388197","issue_url":"https://api.github.com/repos/apache/brpc/issues/465","id":490388197,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDM4ODE5Nw==","user":{"login":"peacedog123","id":32981594,"node_id":"MDQ6VXNlcjMyOTgxNTk0","avatar_url":"https://avatars.githubusercontent.com/u/32981594?v=4","gravatar_id":"","url":"https://api.github.com/users/peacedog123","html_url":"https://github.com/peacedog123","followers_url":"https://api.github.com/users/peacedog123/followers","following_url":"https://api.github.com/users/peacedog123/following{/other_user}","gists_url":"https://api.github.com/users/peacedog123/gists{/gist_id}","starred_url":"https://api.github.com/users/peacedog123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peacedog123/subscriptions","organizations_url":"https://api.github.com/users/peacedog123/orgs","repos_url":"https://api.github.com/users/peacedog123/repos","events_url":"https://api.github.com/users/peacedog123/events{/privacy}","received_events_url":"https://api.github.com/users/peacedog123/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-08T07:57:16Z","updated_at":"2019-05-08T07:57:16Z","author_association":"NONE","body":"谢谢，社区这边不考虑合并么？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/490388197/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/490556339","html_url":"https://github.com/apache/brpc/issues/695#issuecomment-490556339","issue_url":"https://api.github.com/repos/apache/brpc/issues/695","id":490556339,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDU1NjMzOQ==","user":{"login":"flily","id":1126143,"node_id":"MDQ6VXNlcjExMjYxNDM=","avatar_url":"https://avatars.githubusercontent.com/u/1126143?v=4","gravatar_id":"","url":"https://api.github.com/users/flily","html_url":"https://github.com/flily","followers_url":"https://api.github.com/users/flily/followers","following_url":"https://api.github.com/users/flily/following{/other_user}","gists_url":"https://api.github.com/users/flily/gists{/gist_id}","starred_url":"https://api.github.com/users/flily/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flily/subscriptions","organizations_url":"https://api.github.com/users/flily/orgs","repos_url":"https://api.github.com/users/flily/repos","events_url":"https://api.github.com/users/flily/events{/privacy}","received_events_url":"https://api.github.com/users/flily/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-08T16:27:45Z","updated_at":"2019-05-08T16:27:45Z","author_association":"NONE","body":"这个问题我解决了，gflags和protobuf编译的时候没有`-fPIC`参数，最后链接的时候出的问题。这两个的源代码我自己重新编译了一次，在CMakeFiles.txt的最后加上一行`set(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -fPIC\")`。\r\n\r\n看起来似乎编译动态库的时候也会有其他问题，所以还是**都编译成静态库**，做静态链接比较稳妥。\r\nprotobuf的cmake参数加上`-Dprotobuf_BUILD_SHARED_LIBS=OFF`。\r\ngflags的cmake参数加上`-DBUILD_SHARED_LIBS=OFF`。\r\n\r\n参考环境：Ubuntu 18.04.2 LTS，gcc/g++ 7.4.0，gflags 2.2.2，protobuf 3.2.1","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/490556339/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/490734899","html_url":"https://github.com/apache/brpc/issues/744#issuecomment-490734899","issue_url":"https://api.github.com/repos/apache/brpc/issues/744","id":490734899,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDczNDg5OQ==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-09T04:02:24Z","updated_at":"2019-05-09T04:02:24Z","author_association":"CONTRIBUTOR","body":"怎么复现这个问题呢？持续地发那个\"300个key“可以复现么？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/490734899/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/490792120","html_url":"https://github.com/apache/brpc/issues/658#issuecomment-490792120","issue_url":"https://api.github.com/repos/apache/brpc/issues/658","id":490792120,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDc5MjEyMA==","user":{"login":"GardianT","id":38547380,"node_id":"MDQ6VXNlcjM4NTQ3Mzgw","avatar_url":"https://avatars.githubusercontent.com/u/38547380?v=4","gravatar_id":"","url":"https://api.github.com/users/GardianT","html_url":"https://github.com/GardianT","followers_url":"https://api.github.com/users/GardianT/followers","following_url":"https://api.github.com/users/GardianT/following{/other_user}","gists_url":"https://api.github.com/users/GardianT/gists{/gist_id}","starred_url":"https://api.github.com/users/GardianT/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GardianT/subscriptions","organizations_url":"https://api.github.com/users/GardianT/orgs","repos_url":"https://api.github.com/users/GardianT/repos","events_url":"https://api.github.com/users/GardianT/events{/privacy}","received_events_url":"https://api.github.com/users/GardianT/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-09T07:49:13Z","updated_at":"2019-05-09T07:49:13Z","author_association":"NONE","body":"remind，这个问题想问下有进度么？最近看见过四五次了。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/490792120/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/490812934","html_url":"https://github.com/apache/brpc/issues/712#issuecomment-490812934","issue_url":"https://api.github.com/repos/apache/brpc/issues/712","id":490812934,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDgxMjkzNA==","user":{"login":"stuhj","id":19342620,"node_id":"MDQ6VXNlcjE5MzQyNjIw","avatar_url":"https://avatars.githubusercontent.com/u/19342620?v=4","gravatar_id":"","url":"https://api.github.com/users/stuhj","html_url":"https://github.com/stuhj","followers_url":"https://api.github.com/users/stuhj/followers","following_url":"https://api.github.com/users/stuhj/following{/other_user}","gists_url":"https://api.github.com/users/stuhj/gists{/gist_id}","starred_url":"https://api.github.com/users/stuhj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stuhj/subscriptions","organizations_url":"https://api.github.com/users/stuhj/orgs","repos_url":"https://api.github.com/users/stuhj/repos","events_url":"https://api.github.com/users/stuhj/events{/privacy}","received_events_url":"https://api.github.com/users/stuhj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-09T08:40:00Z","updated_at":"2019-05-09T08:40:00Z","author_association":"NONE","body":"同样遇到这个问题，rpc channel连接数量稳定在5000，io-buf一直上涨 \r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/490812934/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/490832981","html_url":"https://github.com/apache/brpc/issues/712#issuecomment-490832981","issue_url":"https://api.github.com/repos/apache/brpc/issues/712","id":490832981,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDgzMjk4MQ==","user":{"login":"dapengbusi","id":9564704,"node_id":"MDQ6VXNlcjk1NjQ3MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/9564704?v=4","gravatar_id":"","url":"https://api.github.com/users/dapengbusi","html_url":"https://github.com/dapengbusi","followers_url":"https://api.github.com/users/dapengbusi/followers","following_url":"https://api.github.com/users/dapengbusi/following{/other_user}","gists_url":"https://api.github.com/users/dapengbusi/gists{/gist_id}","starred_url":"https://api.github.com/users/dapengbusi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dapengbusi/subscriptions","organizations_url":"https://api.github.com/users/dapengbusi/orgs","repos_url":"https://api.github.com/users/dapengbusi/repos","events_url":"https://api.github.com/users/dapengbusi/events{/privacy}","received_events_url":"https://api.github.com/users/dapengbusi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-09T09:37:26Z","updated_at":"2019-05-09T09:37:26Z","author_association":"NONE","body":"我猜测，这个问题根本原因是brpc，依赖tc_malloc库，这个库其实很不好。开辟的大块内存，最后都不会被操作系统回收。尽管你调用了free。需要强制调用tcmalloc内置free函数。建议brpc后面版本更新至jemalloc。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/490832981/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/490836339","html_url":"https://github.com/apache/brpc/issues/678#issuecomment-490836339","issue_url":"https://api.github.com/repos/apache/brpc/issues/678","id":490836339,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDgzNjMzOQ==","user":{"login":"dapengbusi","id":9564704,"node_id":"MDQ6VXNlcjk1NjQ3MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/9564704?v=4","gravatar_id":"","url":"https://api.github.com/users/dapengbusi","html_url":"https://github.com/dapengbusi","followers_url":"https://api.github.com/users/dapengbusi/followers","following_url":"https://api.github.com/users/dapengbusi/following{/other_user}","gists_url":"https://api.github.com/users/dapengbusi/gists{/gist_id}","starred_url":"https://api.github.com/users/dapengbusi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dapengbusi/subscriptions","organizations_url":"https://api.github.com/users/dapengbusi/orgs","repos_url":"https://api.github.com/users/dapengbusi/repos","events_url":"https://api.github.com/users/dapengbusi/events{/privacy}","received_events_url":"https://api.github.com/users/dapengbusi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-09T09:48:04Z","updated_at":"2019-05-09T09:48:04Z","author_association":"NONE","body":"一致性hash，你提到的这个原因，这也是一方面原因。但我理解，一致性hash之所以选32位最大值，是因为虚拟节点个数，一般最大值也就这个。当然你也可以设置成16位的，任何你想设置的数字，但需要保证，虚拟节点对应的实体ip，分布较为均匀即可。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/490836339/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/491147346","html_url":"https://github.com/apache/brpc/issues/756#issuecomment-491147346","issue_url":"https://api.github.com/repos/apache/brpc/issues/756","id":491147346,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MTE0NzM0Ng==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-10T04:00:04Z","updated_at":"2019-05-10T04:00:04Z","author_association":"MEMBER","body":"The [context lib](https://github.com/twlostow/libcontext) that brpc uses has already supported linux on arm64. But the version adopted by brpc maybe too old that new features are not added. If you have the demand to run your application on arm64, you can try to replace the context with the newest version and check whether it can be compiled as expected","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/491147346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/491148512","html_url":"https://github.com/apache/brpc/issues/755#issuecomment-491148512","issue_url":"https://api.github.com/repos/apache/brpc/issues/755","id":491148512,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MTE0ODUxMg==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-10T04:08:59Z","updated_at":"2019-05-10T04:08:59Z","author_association":"MEMBER","body":"please read https://github.com/apache/incubator-brpc/blob/master/docs/en/client.md and https://github.com/apache/incubator-brpc/blob/master/docs/en/server.md for more details. After reading some basic materials and you still have questions, make you questions clear and concise so that I can know how to help, thanks","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/491148512/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/491150643","html_url":"https://github.com/apache/brpc/issues/728#issuecomment-491150643","issue_url":"https://api.github.com/repos/apache/brpc/issues/728","id":491150643,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MTE1MDY0Mw==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-10T04:23:54Z","updated_at":"2019-05-10T04:23:54Z","author_association":"MEMBER","body":"The current implementation considers all the error as feedback to circuit breaker, which may not be a reasonable way. I have opened a new [issue](https://github.com/apache/incubator-brpc/issues/759) to discuss which error should be ignored.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/491150643/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/491153666","html_url":"https://github.com/apache/brpc/issues/751#issuecomment-491153666","issue_url":"https://api.github.com/repos/apache/brpc/issues/751","id":491153666,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MTE1MzY2Ng==","user":{"login":"jasonszang","id":19163259,"node_id":"MDQ6VXNlcjE5MTYzMjU5","avatar_url":"https://avatars.githubusercontent.com/u/19163259?v=4","gravatar_id":"","url":"https://api.github.com/users/jasonszang","html_url":"https://github.com/jasonszang","followers_url":"https://api.github.com/users/jasonszang/followers","following_url":"https://api.github.com/users/jasonszang/following{/other_user}","gists_url":"https://api.github.com/users/jasonszang/gists{/gist_id}","starred_url":"https://api.github.com/users/jasonszang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasonszang/subscriptions","organizations_url":"https://api.github.com/users/jasonszang/orgs","repos_url":"https://api.github.com/users/jasonszang/repos","events_url":"https://api.github.com/users/jasonszang/events{/privacy}","received_events_url":"https://api.github.com/users/jasonszang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-10T04:43:07Z","updated_at":"2019-05-10T04:43:07Z","author_association":"CONTRIBUTOR","body":"Fixed in #757 ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/491153666/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/491156813","html_url":"https://github.com/apache/brpc/pull/760#issuecomment-491156813","issue_url":"https://api.github.com/repos/apache/brpc/issues/760","id":491156813,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MTE1NjgxMw==","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-10T05:02:45Z","updated_at":"2019-05-10T05:02:45Z","author_association":"CONTRIBUTOR","body":"issue #209","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/491156813/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/491646134","html_url":"https://github.com/apache/brpc/issues/756#issuecomment-491646134","issue_url":"https://api.github.com/repos/apache/brpc/issues/756","id":491646134,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MTY0NjEzNA==","user":{"login":"chenlei5662","id":6380665,"node_id":"MDQ6VXNlcjYzODA2NjU=","avatar_url":"https://avatars.githubusercontent.com/u/6380665?v=4","gravatar_id":"","url":"https://api.github.com/users/chenlei5662","html_url":"https://github.com/chenlei5662","followers_url":"https://api.github.com/users/chenlei5662/followers","following_url":"https://api.github.com/users/chenlei5662/following{/other_user}","gists_url":"https://api.github.com/users/chenlei5662/gists{/gist_id}","starred_url":"https://api.github.com/users/chenlei5662/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenlei5662/subscriptions","organizations_url":"https://api.github.com/users/chenlei5662/orgs","repos_url":"https://api.github.com/users/chenlei5662/repos","events_url":"https://api.github.com/users/chenlei5662/events{/privacy}","received_events_url":"https://api.github.com/users/chenlei5662/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-13T01:12:05Z","updated_at":"2019-05-13T01:12:05Z","author_association":"NONE","body":"ok，thanks！","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/491646134/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/491710044","html_url":"https://github.com/apache/brpc/issues/755#issuecomment-491710044","issue_url":"https://api.github.com/repos/apache/brpc/issues/755","id":491710044,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MTcxMDA0NA==","user":{"login":"alicialin","id":19277778,"node_id":"MDQ6VXNlcjE5Mjc3Nzc4","avatar_url":"https://avatars.githubusercontent.com/u/19277778?v=4","gravatar_id":"","url":"https://api.github.com/users/alicialin","html_url":"https://github.com/alicialin","followers_url":"https://api.github.com/users/alicialin/followers","following_url":"https://api.github.com/users/alicialin/following{/other_user}","gists_url":"https://api.github.com/users/alicialin/gists{/gist_id}","starred_url":"https://api.github.com/users/alicialin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alicialin/subscriptions","organizations_url":"https://api.github.com/users/alicialin/orgs","repos_url":"https://api.github.com/users/alicialin/repos","events_url":"https://api.github.com/users/alicialin/events{/privacy}","received_events_url":"https://api.github.com/users/alicialin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-13T07:37:48Z","updated_at":"2019-05-13T07:42:22Z","author_association":"NONE","body":"请教：多线程写问题， 一般多线程写一个内存单元（比如数组）需要加锁。但是可以通过设计思路把一个数组拆分成32个数组，那么同时写，就可以规避加锁问题，通过HASH 的方式，分开写，让1个线程写一个地方， 这样并发度就可以达到32.如果用BRPC 同步服务提供这样的功能，bthead不等同于pthead, 能否用不加锁的方式来规避？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/491710044/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/491725005","html_url":"https://github.com/apache/brpc/issues/755#issuecomment-491725005","issue_url":"https://api.github.com/repos/apache/brpc/issues/755","id":491725005,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MTcyNTAwNQ==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-13T08:24:54Z","updated_at":"2019-05-13T08:24:54Z","author_association":"CONTRIBUTOR","body":"即使消除了线程间的写-写冲突，也无法消除了读-写冲突。你先了解一下并发相关的知识，再回头思考一下这个问题吧。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/491725005/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/491780281","html_url":"https://github.com/apache/brpc/issues/744#issuecomment-491780281","issue_url":"https://api.github.com/repos/apache/brpc/issues/744","id":491780281,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MTc4MDI4MQ==","user":{"login":"haolujun","id":10751631,"node_id":"MDQ6VXNlcjEwNzUxNjMx","avatar_url":"https://avatars.githubusercontent.com/u/10751631?v=4","gravatar_id":"","url":"https://api.github.com/users/haolujun","html_url":"https://github.com/haolujun","followers_url":"https://api.github.com/users/haolujun/followers","following_url":"https://api.github.com/users/haolujun/following{/other_user}","gists_url":"https://api.github.com/users/haolujun/gists{/gist_id}","starred_url":"https://api.github.com/users/haolujun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haolujun/subscriptions","organizations_url":"https://api.github.com/users/haolujun/orgs","repos_url":"https://api.github.com/users/haolujun/repos","events_url":"https://api.github.com/users/haolujun/events{/privacy}","received_events_url":"https://api.github.com/users/haolujun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-13T11:13:28Z","updated_at":"2019-05-13T11:13:28Z","author_association":"NONE","body":"请求压力大些就可以复现，我这面压测的时候网络大概是200Mbps，基本上持续压上一段时间就会出现超时现象。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/491780281/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/491815200","html_url":"https://github.com/apache/brpc/issues/744#issuecomment-491815200","issue_url":"https://api.github.com/repos/apache/brpc/issues/744","id":491815200,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MTgxNTIwMA==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-13T13:09:14Z","updated_at":"2019-05-13T13:09:14Z","author_association":"CONTRIBUTOR","body":"这个redis-server是proxy还是什么，应该是single模式下流量都跑到一台redis-server上去了，而其他连接模式访问的是多台。这里的现象很可能就是压垮server端了。所谓“压垮”就是所有的请求都要在各层的buffer里排队，从而最终超时。这时候看client的cpu是没用的，brpc的redis client是多线程的，压死一个单线程redis-server是很轻松的。如果client是异步发请求（而同时向redis-server发起了很多的请求），可能性会更大一些。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/491815200/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492102434","html_url":"https://github.com/apache/brpc/issues/744#issuecomment-492102434","issue_url":"https://api.github.com/repos/apache/brpc/issues/744","id":492102434,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjEwMjQzNA==","user":{"login":"haolujun","id":10751631,"node_id":"MDQ6VXNlcjEwNzUxNjMx","avatar_url":"https://avatars.githubusercontent.com/u/10751631?v=4","gravatar_id":"","url":"https://api.github.com/users/haolujun","html_url":"https://github.com/haolujun","followers_url":"https://api.github.com/users/haolujun/followers","following_url":"https://api.github.com/users/haolujun/following{/other_user}","gists_url":"https://api.github.com/users/haolujun/gists{/gist_id}","starred_url":"https://api.github.com/users/haolujun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haolujun/subscriptions","organizations_url":"https://api.github.com/users/haolujun/orgs","repos_url":"https://api.github.com/users/haolujun/repos","events_url":"https://api.github.com/users/haolujun/events{/privacy}","received_events_url":"https://api.github.com/users/haolujun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-14T06:51:41Z","updated_at":"2019-05-14T06:51:41Z","author_association":"NONE","body":"连接的是proxy，但是按照你的说法，那么出现超时的时候，此时redis-server是不可用的，但是我通过redis-cli连接这个proxy，各种命令畅通无阻。并且，重启redis-client进程，重新访问，立刻就不超时了。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492102434/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492103851","html_url":"https://github.com/apache/brpc/issues/744#issuecomment-492103851","issue_url":"https://api.github.com/repos/apache/brpc/issues/744","id":492103851,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjEwMzg1MQ==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-14T06:56:53Z","updated_at":"2019-05-14T06:56:53Z","author_association":"CONTRIBUTOR","body":"redis-cli，重启都不是走原来那个连接了吧。redis-server对于单个连接的处理速度未必很高","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492103851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492112261","html_url":"https://github.com/apache/brpc/issues/744#issuecomment-492112261","issue_url":"https://api.github.com/repos/apache/brpc/issues/744","id":492112261,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjExMjI2MQ==","user":{"login":"haolujun","id":10751631,"node_id":"MDQ6VXNlcjEwNzUxNjMx","avatar_url":"https://avatars.githubusercontent.com/u/10751631?v=4","gravatar_id":"","url":"https://api.github.com/users/haolujun","html_url":"https://github.com/haolujun","followers_url":"https://api.github.com/users/haolujun/followers","following_url":"https://api.github.com/users/haolujun/following{/other_user}","gists_url":"https://api.github.com/users/haolujun/gists{/gist_id}","starred_url":"https://api.github.com/users/haolujun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haolujun/subscriptions","organizations_url":"https://api.github.com/users/haolujun/orgs","repos_url":"https://api.github.com/users/haolujun/repos","events_url":"https://api.github.com/users/haolujun/events{/privacy}","received_events_url":"https://api.github.com/users/haolujun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-14T07:26:53Z","updated_at":"2019-05-14T07:26:53Z","author_association":"NONE","body":"重启之后，走的是新连接。但是如果这个时候不重启，我降低qps，由100qps降到1qps，依然会超时。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492112261/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492117952","html_url":"https://github.com/apache/brpc/issues/744#issuecomment-492117952","issue_url":"https://api.github.com/repos/apache/brpc/issues/744","id":492117952,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjExNzk1Mg==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-14T07:45:40Z","updated_at":"2019-05-14T07:45:40Z","author_association":"CONTRIBUTOR","body":"你提供一份可复现的client代码，及详细的复现步骤吧。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492117952/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492156942","html_url":"https://github.com/apache/brpc/issues/744#issuecomment-492156942","issue_url":"https://api.github.com/repos/apache/brpc/issues/744","id":492156942,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjE1Njk0Mg==","user":{"login":"haolujun","id":10751631,"node_id":"MDQ6VXNlcjEwNzUxNjMx","avatar_url":"https://avatars.githubusercontent.com/u/10751631?v=4","gravatar_id":"","url":"https://api.github.com/users/haolujun","html_url":"https://github.com/haolujun","followers_url":"https://api.github.com/users/haolujun/followers","following_url":"https://api.github.com/users/haolujun/following{/other_user}","gists_url":"https://api.github.com/users/haolujun/gists{/gist_id}","starred_url":"https://api.github.com/users/haolujun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haolujun/subscriptions","organizations_url":"https://api.github.com/users/haolujun/orgs","repos_url":"https://api.github.com/users/haolujun/repos","events_url":"https://api.github.com/users/haolujun/events{/privacy}","received_events_url":"https://api.github.com/users/haolujun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-14T09:15:53Z","updated_at":"2019-05-14T09:22:52Z","author_association":"NONE","body":"我这面复现步骤：\r\n1: 每次mget 100个key，每个key是个整数字符串，key对应的value是大概为2K的字符串。\r\n2: qps可以持续加大，可以一直加大到直到有超时错误，我这面大概是200qps。\r\n3: 出现超时错误后，降低client的qps到1，这个时候依然会继续超时。\r\n\r\n我这面的client是放在一个服务中的，所以我是通过控制请求该服务的qps，从而控制client请求redis-server的qps。\r\n\r\n```\r\n//redis_client.h\r\n#ifndef REDIS_CLIENT_H\r\n#define REDIS_CLIENT_H\r\n\r\n#include <string>\r\n#include <brpc/redis.h>\r\n#include <brpc/channel.h>\r\n\r\nclass RedisClient {\r\npublic:\r\n    RedisClient() {\r\n        _channel.reset(new ::brpc::Channel());\r\n    }\r\n\r\n    //移动构造函数\r\n    RedisClient(RedisClient&& client) = default;\r\n\r\n    bool init(const std::string& ip, uint32_t port,\r\n              uint32_t timeout_ms=1000, uint32_t max_retry=3);\r\n\r\n    bool access_redis(const std::string& command,\r\n                      ::brpc::RedisResponse& response);\r\n\r\n    ~RedisClient() {}\r\nprivate:\r\n\r\n    std::unique_ptr<::brpc::Channel> _channel;\r\n};\r\n#endif\r\n```\r\n\r\n```\r\n//redis_client.cpp\r\n#include \"redis_client.h\"\r\n#include <sstream>\r\n\r\nbool RedisClient::init(const std::string& ip, uint32_t port,\r\n                       uint32_t timeout_ms, uint32_t max_retry) {\r\n    // Initialize the channel, NULL means using default options.\r\n    ::brpc::ChannelOptions options;\r\n    options.protocol = ::brpc::PROTOCOL_REDIS;\r\n    // TODO magic\r\n    options.timeout_ms = timeout_ms/*milliseconds*/;\r\n    options.max_retry  = max_retry;\r\n    options.connection_type = \"single\";  //改成pooled后，超时现象就会消失，非常神奇。\r\n    std::stringstream ss;\r\n    ss << ip << \":\" << port;\r\n    if (_channel->Init(ss.str().c_str(), &options) != 0) {\r\n        LOG(ERROR) << \"Fail to initialize channel\";\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nbool RedisClient::access_redis(const std::string& command,\r\n                               ::brpc::RedisResponse& response) {\r\n    ::brpc::RedisRequest request;\r\n    if (!request.AddCommand(command.c_str())) {\r\n        LOG(ERROR) << \"Fail to add command\";\r\n        return false;\r\n    }\r\n    ::brpc::Controller cntl;\r\n    _channel->CallMethod(NULL, &cntl, &request, &response, NULL);\r\n    if (cntl.Failed()) {\r\n        LOG(ERROR) << \"Fail to access redis, \" << cntl.ErrorText();\r\n        return false;\r\n    } else {\r\n        return true;\r\n    }\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492156942/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492574584","html_url":"https://github.com/apache/brpc/issues/765#issuecomment-492574584","issue_url":"https://api.github.com/repos/apache/brpc/issues/765","id":492574584,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjU3NDU4NA==","user":{"login":"Ye-Tian-Zero","id":8231208,"node_id":"MDQ6VXNlcjgyMzEyMDg=","avatar_url":"https://avatars.githubusercontent.com/u/8231208?v=4","gravatar_id":"","url":"https://api.github.com/users/Ye-Tian-Zero","html_url":"https://github.com/Ye-Tian-Zero","followers_url":"https://api.github.com/users/Ye-Tian-Zero/followers","following_url":"https://api.github.com/users/Ye-Tian-Zero/following{/other_user}","gists_url":"https://api.github.com/users/Ye-Tian-Zero/gists{/gist_id}","starred_url":"https://api.github.com/users/Ye-Tian-Zero/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ye-Tian-Zero/subscriptions","organizations_url":"https://api.github.com/users/Ye-Tian-Zero/orgs","repos_url":"https://api.github.com/users/Ye-Tian-Zero/repos","events_url":"https://api.github.com/users/Ye-Tian-Zero/events{/privacy}","received_events_url":"https://api.github.com/users/Ye-Tian-Zero/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-15T09:15:23Z","updated_at":"2019-05-15T09:15:23Z","author_association":"CONTRIBUTOR","body":"我理解 brpc 的 prometheus 是用来传输自己的 metric 信息的，而不是一套公开的机制，因此是不是对 counter summary 这些东西并没有什么需求，其实就是一堆统计信息","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492574584/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492605901","html_url":"https://github.com/apache/brpc/pull/766#issuecomment-492605901","issue_url":"https://api.github.com/repos/apache/brpc/issues/766","id":492605901,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjYwNTkwMQ==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-15T10:53:04Z","updated_at":"2019-05-15T10:53:04Z","author_association":"CONTRIBUTOR","body":"#658 ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492605901/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492895644","html_url":"https://github.com/apache/brpc/issues/577#issuecomment-492895644","issue_url":"https://api.github.com/repos/apache/brpc/issues/577","id":492895644,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5Mjg5NTY0NA==","user":{"login":"fengliangwang","id":9689078,"node_id":"MDQ6VXNlcjk2ODkwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/9689078?v=4","gravatar_id":"","url":"https://api.github.com/users/fengliangwang","html_url":"https://github.com/fengliangwang","followers_url":"https://api.github.com/users/fengliangwang/followers","following_url":"https://api.github.com/users/fengliangwang/following{/other_user}","gists_url":"https://api.github.com/users/fengliangwang/gists{/gist_id}","starred_url":"https://api.github.com/users/fengliangwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fengliangwang/subscriptions","organizations_url":"https://api.github.com/users/fengliangwang/orgs","repos_url":"https://api.github.com/users/fengliangwang/repos","events_url":"https://api.github.com/users/fengliangwang/events{/privacy}","received_events_url":"https://api.github.com/users/fengliangwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-16T02:47:44Z","updated_at":"2019-05-16T02:47:44Z","author_association":"NONE","body":"请问此问题是如何修复解决的？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492895644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492903416","html_url":"https://github.com/apache/brpc/issues/767#issuecomment-492903416","issue_url":"https://api.github.com/repos/apache/brpc/issues/767","id":492903416,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjkwMzQxNg==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-16T03:33:07Z","updated_at":"2019-05-16T03:33:07Z","author_association":"CONTRIBUTOR","body":"1. 之前设置backup_request_ms了么\r\n2. 有不同延时请求的比例么？（cdf）","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492903416/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492903500","html_url":"https://github.com/apache/brpc/issues/768#issuecomment-492903500","issue_url":"https://api.github.com/repos/apache/brpc/issues/768","id":492903500,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjkwMzUwMA==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-16T03:33:43Z","updated_at":"2019-05-16T03:33:43Z","author_association":"CONTRIBUTOR","body":"在做健康检查，默认最多3秒后会连上。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492903500/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492908319","html_url":"https://github.com/apache/brpc/issues/767#issuecomment-492908319","issue_url":"https://api.github.com/repos/apache/brpc/issues/767","id":492908319,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjkwODMxOQ==","user":{"login":"haolujun","id":10751631,"node_id":"MDQ6VXNlcjEwNzUxNjMx","avatar_url":"https://avatars.githubusercontent.com/u/10751631?v=4","gravatar_id":"","url":"https://api.github.com/users/haolujun","html_url":"https://github.com/haolujun","followers_url":"https://api.github.com/users/haolujun/followers","following_url":"https://api.github.com/users/haolujun/following{/other_user}","gists_url":"https://api.github.com/users/haolujun/gists{/gist_id}","starred_url":"https://api.github.com/users/haolujun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haolujun/subscriptions","organizations_url":"https://api.github.com/users/haolujun/orgs","repos_url":"https://api.github.com/users/haolujun/repos","events_url":"https://api.github.com/users/haolujun/events{/privacy}","received_events_url":"https://api.github.com/users/haolujun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-16T04:04:40Z","updated_at":"2019-05-16T04:05:33Z","author_association":"NONE","body":"之前没有设置过backup_request_ms，只设置了timeout_ms=1000，connection_type=pooled，max_retry=3这三个参数。我自己根据日志统计过耗时比例，大概0.5%的请求会超过200ms，99.5%的请求在50ms以内，也就是说超过50ms的请求基本上全都是200+ms，400+ms，600+ms这种。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492908319/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492912731","html_url":"https://github.com/apache/brpc/issues/768#issuecomment-492912731","issue_url":"https://api.github.com/repos/apache/brpc/issues/768","id":492912731,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjkxMjczMQ==","user":{"login":"GTHubT","id":25701767,"node_id":"MDQ6VXNlcjI1NzAxNzY3","avatar_url":"https://avatars.githubusercontent.com/u/25701767?v=4","gravatar_id":"","url":"https://api.github.com/users/GTHubT","html_url":"https://github.com/GTHubT","followers_url":"https://api.github.com/users/GTHubT/followers","following_url":"https://api.github.com/users/GTHubT/following{/other_user}","gists_url":"https://api.github.com/users/GTHubT/gists{/gist_id}","starred_url":"https://api.github.com/users/GTHubT/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GTHubT/subscriptions","organizations_url":"https://api.github.com/users/GTHubT/orgs","repos_url":"https://api.github.com/users/GTHubT/repos","events_url":"https://api.github.com/users/GTHubT/events{/privacy}","received_events_url":"https://api.github.com/users/GTHubT/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-16T04:33:06Z","updated_at":"2019-05-16T04:33:06Z","author_association":"NONE","body":"thanks！","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492912731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492924503","html_url":"https://github.com/apache/brpc/issues/769#issuecomment-492924503","issue_url":"https://api.github.com/repos/apache/brpc/issues/769","id":492924503,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjkyNDUwMw==","user":{"login":"gavinchou","id":6919662,"node_id":"MDQ6VXNlcjY5MTk2NjI=","avatar_url":"https://avatars.githubusercontent.com/u/6919662?v=4","gravatar_id":"","url":"https://api.github.com/users/gavinchou","html_url":"https://github.com/gavinchou","followers_url":"https://api.github.com/users/gavinchou/followers","following_url":"https://api.github.com/users/gavinchou/following{/other_user}","gists_url":"https://api.github.com/users/gavinchou/gists{/gist_id}","starred_url":"https://api.github.com/users/gavinchou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gavinchou/subscriptions","organizations_url":"https://api.github.com/users/gavinchou/orgs","repos_url":"https://api.github.com/users/gavinchou/repos","events_url":"https://api.github.com/users/gavinchou/events{/privacy}","received_events_url":"https://api.github.com/users/gavinchou/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-16T05:39:36Z","updated_at":"2019-05-16T05:39:36Z","author_association":"CONTRIBUTOR","body":"Corresponding  pull request #770","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492924503/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492957268","html_url":"https://github.com/apache/brpc/pull/770#issuecomment-492957268","issue_url":"https://api.github.com/repos/apache/brpc/issues/770","id":492957268,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5Mjk1NzI2OA==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-16T07:45:46Z","updated_at":"2019-05-16T07:45:46Z","author_association":"CONTRIBUTOR","body":"Thanks for the patch and detailed explanations :)","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/492957268/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493005915","html_url":"https://github.com/apache/brpc/issues/577#issuecomment-493005915","issue_url":"https://api.github.com/repos/apache/brpc/issues/577","id":493005915,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MzAwNTkxNQ==","user":{"login":"veyrony","id":5011647,"node_id":"MDQ6VXNlcjUwMTE2NDc=","avatar_url":"https://avatars.githubusercontent.com/u/5011647?v=4","gravatar_id":"","url":"https://api.github.com/users/veyrony","html_url":"https://github.com/veyrony","followers_url":"https://api.github.com/users/veyrony/followers","following_url":"https://api.github.com/users/veyrony/following{/other_user}","gists_url":"https://api.github.com/users/veyrony/gists{/gist_id}","starred_url":"https://api.github.com/users/veyrony/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/veyrony/subscriptions","organizations_url":"https://api.github.com/users/veyrony/orgs","repos_url":"https://api.github.com/users/veyrony/repos","events_url":"https://api.github.com/users/veyrony/events{/privacy}","received_events_url":"https://api.github.com/users/veyrony/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-16T10:08:18Z","updated_at":"2019-05-16T10:08:18Z","author_association":"NONE","body":"> 请问此问题是如何修复解决的？\r\n不用改代码，编译时加上 --define=with_glog=true\r\n$ bazel build --define=with_glog=true  ...","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493005915/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":1,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493368665","html_url":"https://github.com/apache/brpc/pull/692#issuecomment-493368665","issue_url":"https://api.github.com/repos/apache/brpc/issues/692","id":493368665,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MzM2ODY2NQ==","user":{"login":"baoxuezhao","id":6814461,"node_id":"MDQ6VXNlcjY4MTQ0NjE=","avatar_url":"https://avatars.githubusercontent.com/u/6814461?v=4","gravatar_id":"","url":"https://api.github.com/users/baoxuezhao","html_url":"https://github.com/baoxuezhao","followers_url":"https://api.github.com/users/baoxuezhao/followers","following_url":"https://api.github.com/users/baoxuezhao/following{/other_user}","gists_url":"https://api.github.com/users/baoxuezhao/gists{/gist_id}","starred_url":"https://api.github.com/users/baoxuezhao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baoxuezhao/subscriptions","organizations_url":"https://api.github.com/users/baoxuezhao/orgs","repos_url":"https://api.github.com/users/baoxuezhao/repos","events_url":"https://api.github.com/users/baoxuezhao/events{/privacy}","received_events_url":"https://api.github.com/users/baoxuezhao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-17T08:25:55Z","updated_at":"2019-05-17T08:25:55Z","author_association":"NONE","body":"这个PR是不是只实现了Mysql协议的client部分，有对server端做实现吗？比如用brpc server mock一个Mysql server，自定义查询处理逻辑。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493368665/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493682641","html_url":"https://github.com/apache/brpc/pull/692#issuecomment-493682641","issue_url":"https://api.github.com/repos/apache/brpc/issues/692","id":493682641,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MzY4MjY0MQ==","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-18T14:48:54Z","updated_at":"2019-05-18T14:48:54Z","author_association":"CONTRIBUTOR","body":"> 这个PR是不是只实现了Mysql协议的client部分，有对server端做实现吗？比如用brpc server mock一个Mysql server，自定义查询处理逻辑。\r\n\r\n对，只实现了client部分。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493682641/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493733362","html_url":"https://github.com/apache/brpc/issues/772#issuecomment-493733362","issue_url":"https://api.github.com/repos/apache/brpc/issues/772","id":493733362,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MzczMzM2Mg==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-19T07:18:07Z","updated_at":"2019-05-19T07:18:07Z","author_association":"CONTRIBUTOR","body":"不能，brpc本身就大量使用bvar。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493733362/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493819603","html_url":"https://github.com/apache/brpc/pull/766#issuecomment-493819603","issue_url":"https://api.github.com/repos/apache/brpc/issues/766","id":493819603,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MzgxOTYwMw==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-20T02:31:04Z","updated_at":"2019-05-20T02:31:04Z","author_association":"CONTRIBUTOR","body":"@jamesge  帮忙看下这个fix","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493819603/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493838074","html_url":"https://github.com/apache/brpc/issues/774#issuecomment-493838074","issue_url":"https://api.github.com/repos/apache/brpc/issues/774","id":493838074,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MzgzODA3NA==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-20T04:52:00Z","updated_at":"2019-05-20T04:52:00Z","author_association":"CONTRIBUTOR","body":"brpc servers do accept http post requests. You could turn on --http_verbose in the brpc server to see the http requests that it accepts.\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493838074/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493889516","html_url":"https://github.com/apache/brpc/pull/760#issuecomment-493889516","issue_url":"https://api.github.com/repos/apache/brpc/issues/760","id":493889516,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5Mzg4OTUxNg==","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-20T08:31:10Z","updated_at":"2019-05-24T03:30:42Z","author_association":"CONTRIBUTOR","body":"添加了mysql的prepared statement协议的支持。\r\n遇到的两个问题解决方案如下：\r\n1、prepared statement首先是在某个连接上创建一个statement id，后续操作可以根据这个statement id向这个连接发送后续的请求。同一个语句在每个连接上的statement id是不同的。在pooled模式下，每次RPC选择的连接是不同的，所以需要记录SocketId和statement id的关系，我们这里称为id_map。但是一个SocketId有可能关闭，然后又重新建立起来，这个新SocketId对应的连接没有这个statement id。id_map没有机制可以做到同步更新，保存的SocketId与statement id关系信息是旧的关系。这样就会产生问题。\r\n这个问题的修改方式是，给socketid对应的fd一个唯一的版本号，每次通过stmt_id找到socketid的时候对比一下版本号，版本号一致说明fd没有变化，版本号不一致说明fd变化过。\r\n2、目前还不能支持single模式，唯一的原因就是auth部分，正常auth多个请求会竞争发送auth，后续操作就不需要发送auth了，auth不用等待服务端应答，就可以让其他请求继续发送。但是mysql的auth和这个逻辑不通，mysql的auth首先接收mysql-server发送过来的salt，客户端根据salt加密密码，再把加密后的密码发送给服务端。这样的逻辑如果不等待服务端应答就解锁别的请求，就会出现发送auth的请求落后于正常的请求，导致消息乱序。\r\n这个目前就先不支持single模式了。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493889516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493899866","html_url":"https://github.com/apache/brpc/pull/692#issuecomment-493899866","issue_url":"https://api.github.com/repos/apache/brpc/issues/692","id":493899866,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5Mzg5OTg2Ng==","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-20T09:01:28Z","updated_at":"2019-05-20T09:01:28Z","author_association":"CONTRIBUTOR","body":"#760\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493899866/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493910189","html_url":"https://github.com/apache/brpc/pull/692#issuecomment-493910189","issue_url":"https://api.github.com/repos/apache/brpc/issues/692","id":493910189,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MzkxMDE4OQ==","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-20T09:31:39Z","updated_at":"2019-05-20T09:31:39Z","author_association":"CONTRIBUTOR","body":"#760\r\n","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493910189/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493910319","html_url":"https://github.com/apache/brpc/pull/722#issuecomment-493910319","issue_url":"https://api.github.com/repos/apache/brpc/issues/722","id":493910319,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MzkxMDMxOQ==","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-20T09:32:03Z","updated_at":"2019-05-20T09:32:03Z","author_association":"CONTRIBUTOR","body":"#760","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493910319/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493910525","html_url":"https://github.com/apache/brpc/pull/760#issuecomment-493910525","issue_url":"https://api.github.com/repos/apache/brpc/issues/760","id":493910525,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MzkxMDUyNQ==","user":{"login":"yanglimingcn","id":7091130,"node_id":"MDQ6VXNlcjcwOTExMzA=","avatar_url":"https://avatars.githubusercontent.com/u/7091130?v=4","gravatar_id":"","url":"https://api.github.com/users/yanglimingcn","html_url":"https://github.com/yanglimingcn","followers_url":"https://api.github.com/users/yanglimingcn/followers","following_url":"https://api.github.com/users/yanglimingcn/following{/other_user}","gists_url":"https://api.github.com/users/yanglimingcn/gists{/gist_id}","starred_url":"https://api.github.com/users/yanglimingcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanglimingcn/subscriptions","organizations_url":"https://api.github.com/users/yanglimingcn/orgs","repos_url":"https://api.github.com/users/yanglimingcn/repos","events_url":"https://api.github.com/users/yanglimingcn/events{/privacy}","received_events_url":"https://api.github.com/users/yanglimingcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-20T09:32:35Z","updated_at":"2019-05-20T09:32:35Z","author_association":"CONTRIBUTOR","body":"#722 #692 ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493910525/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493939291","html_url":"https://github.com/apache/brpc/pull/749#issuecomment-493939291","issue_url":"https://api.github.com/repos/apache/brpc/issues/749","id":493939291,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MzkzOTI5MQ==","user":{"login":"jasonszang","id":19163259,"node_id":"MDQ6VXNlcjE5MTYzMjU5","avatar_url":"https://avatars.githubusercontent.com/u/19163259?v=4","gravatar_id":"","url":"https://api.github.com/users/jasonszang","html_url":"https://github.com/jasonszang","followers_url":"https://api.github.com/users/jasonszang/followers","following_url":"https://api.github.com/users/jasonszang/following{/other_user}","gists_url":"https://api.github.com/users/jasonszang/gists{/gist_id}","starred_url":"https://api.github.com/users/jasonszang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasonszang/subscriptions","organizations_url":"https://api.github.com/users/jasonszang/orgs","repos_url":"https://api.github.com/users/jasonszang/repos","events_url":"https://api.github.com/users/jasonszang/events{/privacy}","received_events_url":"https://api.github.com/users/jasonszang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-20T11:01:04Z","updated_at":"2019-05-20T11:01:04Z","author_association":"CONTRIBUTOR","body":"@jamesge Hi Ge, thanks a lot for your review. I'll consider and fix these issues except the creation of `mtx_cv_base.h` which is necessary to avoid a circular header dependency.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493939291/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493966838","html_url":"https://github.com/apache/brpc/issues/468#issuecomment-493966838","issue_url":"https://api.github.com/repos/apache/brpc/issues/468","id":493966838,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5Mzk2NjgzOA==","user":{"login":"FearedHeart","id":50689274,"node_id":"MDQ6VXNlcjUwNjg5Mjc0","avatar_url":"https://avatars.githubusercontent.com/u/50689274?v=4","gravatar_id":"","url":"https://api.github.com/users/FearedHeart","html_url":"https://github.com/FearedHeart","followers_url":"https://api.github.com/users/FearedHeart/followers","following_url":"https://api.github.com/users/FearedHeart/following{/other_user}","gists_url":"https://api.github.com/users/FearedHeart/gists{/gist_id}","starred_url":"https://api.github.com/users/FearedHeart/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FearedHeart/subscriptions","organizations_url":"https://api.github.com/users/FearedHeart/orgs","repos_url":"https://api.github.com/users/FearedHeart/repos","events_url":"https://api.github.com/users/FearedHeart/events{/privacy}","received_events_url":"https://api.github.com/users/FearedHeart/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-20T12:31:19Z","updated_at":"2019-05-20T12:31:19Z","author_association":"NONE","body":"在返回请求之前，设置response的header，对于跨域请求主要是下面3个。详细参见：https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS\r\n```\r\n      cntl->http_response().SetHeader(\"Access-Control-Allow-Origin\", \"*\");\r\n      cntl->http_response().SetHeader(\"Access-Control-Allow-Headers\", \"x-requested-with,Content-Type\");\r\n      cntl->http_response().SetHeader(\"Access-Control-Allow-Methods\", \"POST,OPTIONS\");\r\n```\r\n注意有的时候会浏览器会先发送一个OPTIONS请求，需要判断下：\r\n```\r\n    if (cntl->http_request().method() == brpc::HttpMethod::HTTP_METHOD_OPTIONS) {\r\n      cntl->http_response().SetHeader(\"Access-Control-Allow-Origin\", \"*\");\r\n      cntl->http_response().set_status_code(brpc::HTTP_STATUS_OK);\r\n      return;\r\n    }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/493966838/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/494288183","html_url":"https://github.com/apache/brpc/issues/400#issuecomment-494288183","issue_url":"https://api.github.com/repos/apache/brpc/issues/400","id":494288183,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDI4ODE4Mw==","user":{"login":"kevinmgyu","id":42665912,"node_id":"MDQ6VXNlcjQyNjY1OTEy","avatar_url":"https://avatars.githubusercontent.com/u/42665912?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinmgyu","html_url":"https://github.com/kevinmgyu","followers_url":"https://api.github.com/users/kevinmgyu/followers","following_url":"https://api.github.com/users/kevinmgyu/following{/other_user}","gists_url":"https://api.github.com/users/kevinmgyu/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinmgyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinmgyu/subscriptions","organizations_url":"https://api.github.com/users/kevinmgyu/orgs","repos_url":"https://api.github.com/users/kevinmgyu/repos","events_url":"https://api.github.com/users/kevinmgyu/events{/privacy}","received_events_url":"https://api.github.com/users/kevinmgyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-21T08:13:11Z","updated_at":"2019-05-21T08:13:11Z","author_association":"NONE","body":"websocket 现在支持吗","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/494288183/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/494322319","html_url":"https://github.com/apache/brpc/issues/763#issuecomment-494322319","issue_url":"https://api.github.com/repos/apache/brpc/issues/763","id":494322319,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDMyMjMxOQ==","user":{"login":"lwmonster","id":4264580,"node_id":"MDQ6VXNlcjQyNjQ1ODA=","avatar_url":"https://avatars.githubusercontent.com/u/4264580?v=4","gravatar_id":"","url":"https://api.github.com/users/lwmonster","html_url":"https://github.com/lwmonster","followers_url":"https://api.github.com/users/lwmonster/followers","following_url":"https://api.github.com/users/lwmonster/following{/other_user}","gists_url":"https://api.github.com/users/lwmonster/gists{/gist_id}","starred_url":"https://api.github.com/users/lwmonster/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lwmonster/subscriptions","organizations_url":"https://api.github.com/users/lwmonster/orgs","repos_url":"https://api.github.com/users/lwmonster/repos","events_url":"https://api.github.com/users/lwmonster/events{/privacy}","received_events_url":"https://api.github.com/users/lwmonster/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-21T09:51:04Z","updated_at":"2019-05-21T09:51:04Z","author_association":"NONE","body":"大概知道原因了， 自己的 pthread 和 brpc 的 pthread 互相等待，造成死锁。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/494322319/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/494619938","html_url":"https://github.com/apache/brpc/issues/2#issuecomment-494619938","issue_url":"https://api.github.com/repos/apache/brpc/issues/2","id":494619938,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDYxOTkzOA==","user":{"login":"better629","id":7869691,"node_id":"MDQ6VXNlcjc4Njk2OTE=","avatar_url":"https://avatars.githubusercontent.com/u/7869691?v=4","gravatar_id":"","url":"https://api.github.com/users/better629","html_url":"https://github.com/better629","followers_url":"https://api.github.com/users/better629/followers","following_url":"https://api.github.com/users/better629/following{/other_user}","gists_url":"https://api.github.com/users/better629/gists{/gist_id}","starred_url":"https://api.github.com/users/better629/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/better629/subscriptions","organizations_url":"https://api.github.com/users/better629/orgs","repos_url":"https://api.github.com/users/better629/repos","events_url":"https://api.github.com/users/better629/events{/privacy}","received_events_url":"https://api.github.com/users/better629/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-22T01:44:24Z","updated_at":"2019-05-22T01:44:24Z","author_association":"NONE","body":"没有支持Python版的吗","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/494619938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495058867","html_url":"https://github.com/apache/brpc/pull/766#issuecomment-495058867","issue_url":"https://api.github.com/repos/apache/brpc/issues/766","id":495058867,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTA1ODg2Nw==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-23T04:00:39Z","updated_at":"2019-05-23T04:00:39Z","author_association":"CONTRIBUTOR","body":"@cdjingit 这个改法我觉得解决的不是root cause","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495058867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495059968","html_url":"https://github.com/apache/brpc/pull/723#issuecomment-495059968","issue_url":"https://api.github.com/repos/apache/brpc/issues/723","id":495059968,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTA1OTk2OA==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-23T04:08:26Z","updated_at":"2019-05-23T04:08:26Z","author_association":"CONTRIBUTOR","body":"之前的几个PR可能已经修复了一些相关问题，现在看看是否还有必要保留这个PR @wenweihu86 ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495059968/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495079928","html_url":"https://github.com/apache/brpc/pull/766#issuecomment-495079928","issue_url":"https://api.github.com/repos/apache/brpc/issues/766","id":495079928,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTA3OTkyOA==","user":{"login":"old-bear","id":1525532,"node_id":"MDQ6VXNlcjE1MjU1MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1525532?v=4","gravatar_id":"","url":"https://api.github.com/users/old-bear","html_url":"https://github.com/old-bear","followers_url":"https://api.github.com/users/old-bear/followers","following_url":"https://api.github.com/users/old-bear/following{/other_user}","gists_url":"https://api.github.com/users/old-bear/gists{/gist_id}","starred_url":"https://api.github.com/users/old-bear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/old-bear/subscriptions","organizations_url":"https://api.github.com/users/old-bear/orgs","repos_url":"https://api.github.com/users/old-bear/repos","events_url":"https://api.github.com/users/old-bear/events{/privacy}","received_events_url":"https://api.github.com/users/old-bear/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-23T06:04:44Z","updated_at":"2019-05-23T06:04:44Z","author_association":"CONTRIBUTOR","body":"看了下代码，有可能触发路径是这样的：\r\n1. socket在成功connect后，后台启动`KeepWrite`准备往里写：\r\n\r\n> https://github.com/apache/incubator-brpc/blob/8fe8640e2f95a0e508f3070b086b7b25e84f5c88/src/brpc/socket.cpp#L1573-L1580\r\n\r\n2. 此时socket被`SetFailed`，`SetFailed`里好像并不会管上面那个后台启动的线程\r\n3. 触发HealthCheck，然后一路调用把`_ssl_state`重置：\r\n\r\n> https://github.com/apache/incubator-brpc/blob/8fe8640e2f95a0e508f3070b086b7b25e84f5c88/src/brpc/socket.cpp#L705\r\n\r\n4. 这时`KeepWrite`被调度开始运行，`KeepWrite`里并不会尝试`Address`，最后一路到`DoWrite`\r\n\r\n> https://github.com/apache/incubator-brpc/blob/8fe8640e2f95a0e508f3070b086b7b25e84f5c88/src/brpc/socket.cpp#L1690\r\n\r\n本地暂时没环境，还没尝试复现\r\n这个问题在server端不会遇到，因为没开healthcheck\r\n如果要临时修的话，可以按这个PR这么改。后面DoWrite继续尝试写，发现fd关了，最后返回-1","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495079928/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495082523","html_url":"https://github.com/apache/brpc/pull/766#issuecomment-495082523","issue_url":"https://api.github.com/repos/apache/brpc/issues/766","id":495082523,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTA4MjUyMw==","user":{"login":"old-bear","id":1525532,"node_id":"MDQ6VXNlcjE1MjU1MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1525532?v=4","gravatar_id":"","url":"https://api.github.com/users/old-bear","html_url":"https://github.com/old-bear","followers_url":"https://api.github.com/users/old-bear/followers","following_url":"https://api.github.com/users/old-bear/following{/other_user}","gists_url":"https://api.github.com/users/old-bear/gists{/gist_id}","starred_url":"https://api.github.com/users/old-bear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/old-bear/subscriptions","organizations_url":"https://api.github.com/users/old-bear/orgs","repos_url":"https://api.github.com/users/old-bear/repos","events_url":"https://api.github.com/users/old-bear/events{/privacy}","received_events_url":"https://api.github.com/users/old-bear/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-23T06:16:44Z","updated_at":"2019-05-23T06:16:44Z","author_association":"CONTRIBUTOR","body":"> 看了下代码，有可能触发路径是这样的：\r\n> \r\n> 1. socket在成功connect后，后台启动`KeepWrite`准备往里写：\r\n> \r\n> > https://github.com/apache/incubator-brpc/blob/8fe8640e2f95a0e508f3070b086b7b25e84f5c88/src/brpc/socket.cpp#L1573-L1580\r\n> \r\n> 1. 此时socket被`SetFailed`，`SetFailed`里好像并不会管上面那个后台启动的线程\r\n> 2. 触发HealthCheck，然后一路调用把`_ssl_state`重置：\r\n> \r\n> > https://github.com/apache/incubator-brpc/blob/8fe8640e2f95a0e508f3070b086b7b25e84f5c88/src/brpc/socket.cpp#L705\r\n> \r\n> 1. 这时`KeepWrite`被调度开始运行，`KeepWrite`里并不会尝试`Address`，最后一路到`DoWrite`\r\n> \r\n> > https://github.com/apache/incubator-brpc/blob/8fe8640e2f95a0e508f3070b086b7b25e84f5c88/src/brpc/socket.cpp#L1690\r\n> \r\n> 本地暂时没环境，还没尝试复现\r\n> 这个问题在server端不会遇到，因为没开healthcheck\r\n> 如果要临时修的话，可以按这个PR这么改。后面DoWrite继续尝试写，发现fd关了，最后返回-1\r\n\r\n看错了，这个路径不可能，第1步里会占一个ref给`KeepWrite`\r\n剩下可能是`SocketMap`里的ref被remove后，触发后续2-4","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495082523/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495082882","html_url":"https://github.com/apache/brpc/pull/766#issuecomment-495082882","issue_url":"https://api.github.com/repos/apache/brpc/issues/766","id":495082882,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTA4Mjg4Mg==","user":{"login":"cdjingit","id":31362185,"node_id":"MDQ6VXNlcjMxMzYyMTg1","avatar_url":"https://avatars.githubusercontent.com/u/31362185?v=4","gravatar_id":"","url":"https://api.github.com/users/cdjingit","html_url":"https://github.com/cdjingit","followers_url":"https://api.github.com/users/cdjingit/followers","following_url":"https://api.github.com/users/cdjingit/following{/other_user}","gists_url":"https://api.github.com/users/cdjingit/gists{/gist_id}","starred_url":"https://api.github.com/users/cdjingit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdjingit/subscriptions","organizations_url":"https://api.github.com/users/cdjingit/orgs","repos_url":"https://api.github.com/users/cdjingit/repos","events_url":"https://api.github.com/users/cdjingit/events{/privacy}","received_events_url":"https://api.github.com/users/cdjingit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-23T06:18:17Z","updated_at":"2019-05-23T06:18:17Z","author_association":"CONTRIBUTOR","body":"@jamesge @old-bear  这个问题之前有个fix相似，就是启动health check前，认为已经没有socket write了，否则socket引用计数不是2（通过WaitAndReset(2)）。但有一种可能是socket的从naming service删除了（socket 引用计数减一），这时如果socket上还有数据在write，引用计数也是2，WaitAndReseet成功并且重置了socket相关状态。严格来讲，是有问题的。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495082882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495126886","html_url":"https://github.com/apache/brpc/issues/697#issuecomment-495126886","issue_url":"https://api.github.com/repos/apache/brpc/issues/697","id":495126886,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTEyNjg4Ng==","user":{"login":"cuisonghui","id":8772285,"node_id":"MDQ6VXNlcjg3NzIyODU=","avatar_url":"https://avatars.githubusercontent.com/u/8772285?v=4","gravatar_id":"","url":"https://api.github.com/users/cuisonghui","html_url":"https://github.com/cuisonghui","followers_url":"https://api.github.com/users/cuisonghui/followers","following_url":"https://api.github.com/users/cuisonghui/following{/other_user}","gists_url":"https://api.github.com/users/cuisonghui/gists{/gist_id}","starred_url":"https://api.github.com/users/cuisonghui/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cuisonghui/subscriptions","organizations_url":"https://api.github.com/users/cuisonghui/orgs","repos_url":"https://api.github.com/users/cuisonghui/repos","events_url":"https://api.github.com/users/cuisonghui/events{/privacy}","received_events_url":"https://api.github.com/users/cuisonghui/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-23T08:49:51Z","updated_at":"2019-05-23T08:49:51Z","author_association":"NONE","body":"@jamesge  目前在使用ParallelChannel半同步模式，假如有一个下游节点出问题了，用什么方法可以知道？目前ParallelChannel是提供map和merge函数的，可以干预请求和返回，但是如果失败的，有这样的回调函数吗。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495126886/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495532001","html_url":"https://github.com/apache/brpc/pull/749#issuecomment-495532001","issue_url":"https://api.github.com/repos/apache/brpc/issues/749","id":495532001,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTUzMjAwMQ==","user":{"login":"jasonszang","id":19163259,"node_id":"MDQ6VXNlcjE5MTYzMjU5","avatar_url":"https://avatars.githubusercontent.com/u/19163259?v=4","gravatar_id":"","url":"https://api.github.com/users/jasonszang","html_url":"https://github.com/jasonszang","followers_url":"https://api.github.com/users/jasonszang/followers","following_url":"https://api.github.com/users/jasonszang/following{/other_user}","gists_url":"https://api.github.com/users/jasonszang/gists{/gist_id}","starred_url":"https://api.github.com/users/jasonszang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasonszang/subscriptions","organizations_url":"https://api.github.com/users/jasonszang/orgs","repos_url":"https://api.github.com/users/jasonszang/repos","events_url":"https://api.github.com/users/jasonszang/events{/privacy}","received_events_url":"https://api.github.com/users/jasonszang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-24T09:01:44Z","updated_at":"2019-05-24T09:01:44Z","author_association":"CONTRIBUTOR","body":"@jamesge Something went wrong building mesalink on Travis CI, which is obviously not the result of this PR. Would you please spare some time to take a look?","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495532001/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495555191","html_url":"https://github.com/apache/brpc/pull/629#issuecomment-495555191","issue_url":"https://api.github.com/repos/apache/brpc/issues/629","id":495555191,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTU1NTE5MQ==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-24T10:04:49Z","updated_at":"2019-05-24T10:04:49Z","author_association":"MEMBER","body":"@kevinis There is a mesalink build problem in the latest [build](https://travis-ci.org/apache/incubator-brpc/jobs/536646641). Please have a check.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495555191/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495606822","html_url":"https://github.com/apache/brpc/pull/98#issuecomment-495606822","issue_url":"https://api.github.com/repos/apache/brpc/issues/98","id":495606822,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTYwNjgyMg==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-24T12:36:17Z","updated_at":"2019-05-24T12:36:17Z","author_association":"MEMBER","body":"@kenshinxf After running thrift installation command in .travis.yml, running make in thrift example is  failed now. Please have a check, thanks","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495606822/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495694444","html_url":"https://github.com/apache/brpc/pull/777#issuecomment-495694444","issue_url":"https://api.github.com/repos/apache/brpc/issues/777","id":495694444,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTY5NDQ0NA==","user":{"login":"jasonszang","id":19163259,"node_id":"MDQ6VXNlcjE5MTYzMjU5","avatar_url":"https://avatars.githubusercontent.com/u/19163259?v=4","gravatar_id":"","url":"https://api.github.com/users/jasonszang","html_url":"https://github.com/jasonszang","followers_url":"https://api.github.com/users/jasonszang/followers","following_url":"https://api.github.com/users/jasonszang/following{/other_user}","gists_url":"https://api.github.com/users/jasonszang/gists{/gist_id}","starred_url":"https://api.github.com/users/jasonszang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasonszang/subscriptions","organizations_url":"https://api.github.com/users/jasonszang/orgs","repos_url":"https://api.github.com/users/jasonszang/repos","events_url":"https://api.github.com/users/jasonszang/events{/privacy}","received_events_url":"https://api.github.com/users/jasonszang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-24T16:17:13Z","updated_at":"2019-05-24T16:19:51Z","author_association":"CONTRIBUTOR","body":"Hi! I saw you did a test pr and then commented out mesalink from travis config. Is there something wrong with mesalink currently? My PR fails because of unabling to build mesalink and I for sure didn't touch anything near it.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495694444/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495856819","html_url":"https://github.com/apache/brpc/pull/777#issuecomment-495856819","issue_url":"https://api.github.com/repos/apache/brpc/issues/777","id":495856819,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTg1NjgxOQ==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-25T05:22:43Z","updated_at":"2019-05-25T05:22:43Z","author_association":"MEMBER","body":"> Hi! I saw you did a test pr and then commented out mesalink from travis config. Is there something wrong with mesalink currently? My PR fails because of unabling to build mesalink and I for sure didn't touch anything near it.\r\n\r\nYes. Brpc can't be built in travis since some build problem in mesalink. I have reminded the author to solve the issue.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495856819/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495907430","html_url":"https://github.com/apache/brpc/pull/98#issuecomment-495907430","issue_url":"https://api.github.com/repos/apache/brpc/issues/98","id":495907430,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTkwNzQzMA==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-25T10:47:28Z","updated_at":"2019-05-25T10:47:28Z","author_association":"MEMBER","body":"Fix it in https://github.com/apache/incubator-brpc/pull/777","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495907430/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495968160","html_url":"https://github.com/apache/brpc/pull/777#issuecomment-495968160","issue_url":"https://api.github.com/repos/apache/brpc/issues/777","id":495968160,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTk2ODE2MA==","user":{"login":"jasonszang","id":19163259,"node_id":"MDQ6VXNlcjE5MTYzMjU5","avatar_url":"https://avatars.githubusercontent.com/u/19163259?v=4","gravatar_id":"","url":"https://api.github.com/users/jasonszang","html_url":"https://github.com/jasonszang","followers_url":"https://api.github.com/users/jasonszang/followers","following_url":"https://api.github.com/users/jasonszang/following{/other_user}","gists_url":"https://api.github.com/users/jasonszang/gists{/gist_id}","starred_url":"https://api.github.com/users/jasonszang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasonszang/subscriptions","organizations_url":"https://api.github.com/users/jasonszang/orgs","repos_url":"https://api.github.com/users/jasonszang/repos","events_url":"https://api.github.com/users/jasonszang/events{/privacy}","received_events_url":"https://api.github.com/users/jasonszang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-26T04:35:16Z","updated_at":"2019-05-26T04:35:16Z","author_association":"CONTRIBUTOR","body":"Can we depend on a pre-built mesalink on travis instead? Is it necessary that we build mesalink from source?","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/495968160/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496109539","html_url":"https://github.com/apache/brpc/pull/749#issuecomment-496109539","issue_url":"https://api.github.com/repos/apache/brpc/issues/749","id":496109539,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjEwOTUzOQ==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-27T07:29:16Z","updated_at":"2019-05-27T07:29:16Z","author_association":"CONTRIBUTOR","body":"Please rebase on the master head to see if the travis-ci gets passed.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496109539/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496440508","html_url":"https://github.com/apache/brpc/issues/699#issuecomment-496440508","issue_url":"https://api.github.com/repos/apache/brpc/issues/699","id":496440508,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjQ0MDUwOA==","user":{"login":"mingolm","id":28703251,"node_id":"MDQ6VXNlcjI4NzAzMjUx","avatar_url":"https://avatars.githubusercontent.com/u/28703251?v=4","gravatar_id":"","url":"https://api.github.com/users/mingolm","html_url":"https://github.com/mingolm","followers_url":"https://api.github.com/users/mingolm/followers","following_url":"https://api.github.com/users/mingolm/following{/other_user}","gists_url":"https://api.github.com/users/mingolm/gists{/gist_id}","starred_url":"https://api.github.com/users/mingolm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mingolm/subscriptions","organizations_url":"https://api.github.com/users/mingolm/orgs","repos_url":"https://api.github.com/users/mingolm/repos","events_url":"https://api.github.com/users/mingolm/events{/privacy}","received_events_url":"https://api.github.com/users/mingolm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-28T09:32:21Z","updated_at":"2019-05-28T09:32:21Z","author_association":"NONE","body":"我也遇见了，另外，使用la和rr，random都不行，请问如何解决啊","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496440508/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496477126","html_url":"https://github.com/apache/brpc/issues/699#issuecomment-496477126","issue_url":"https://api.github.com/repos/apache/brpc/issues/699","id":496477126,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjQ3NzEyNg==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-28T11:29:26Z","updated_at":"2019-05-28T11:29:26Z","author_association":"CONTRIBUTOR","body":"@linlianmin 非la算法遇到这个问题一般是server全挂了。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496477126/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496538613","html_url":"https://github.com/apache/brpc/issues/699#issuecomment-496538613","issue_url":"https://api.github.com/repos/apache/brpc/issues/699","id":496538613,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjUzODYxMw==","user":{"login":"mingolm","id":28703251,"node_id":"MDQ6VXNlcjI4NzAzMjUx","avatar_url":"https://avatars.githubusercontent.com/u/28703251?v=4","gravatar_id":"","url":"https://api.github.com/users/mingolm","html_url":"https://github.com/mingolm","followers_url":"https://api.github.com/users/mingolm/followers","following_url":"https://api.github.com/users/mingolm/following{/other_user}","gists_url":"https://api.github.com/users/mingolm/gists{/gist_id}","starred_url":"https://api.github.com/users/mingolm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mingolm/subscriptions","organizations_url":"https://api.github.com/users/mingolm/orgs","repos_url":"https://api.github.com/users/mingolm/repos","events_url":"https://api.github.com/users/mingolm/events{/privacy}","received_events_url":"https://api.github.com/users/mingolm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-28T14:22:57Z","updated_at":"2019-05-28T14:22:57Z","author_association":"NONE","body":"我用的http://  ，使用rr算法，可以确保源站没挂，现在的现象是 有成功，也有失败，看失败的记录就是fail to select server，使用的pooled，感觉有点象pooled连接池里连接被用光了，没有排队，直接返回错误了，有空闲就又继续请求？","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496538613/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496758807","html_url":"https://github.com/apache/brpc/pull/749#issuecomment-496758807","issue_url":"https://api.github.com/repos/apache/brpc/issues/749","id":496758807,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5Njc1ODgwNw==","user":{"login":"jasonszang","id":19163259,"node_id":"MDQ6VXNlcjE5MTYzMjU5","avatar_url":"https://avatars.githubusercontent.com/u/19163259?v=4","gravatar_id":"","url":"https://api.github.com/users/jasonszang","html_url":"https://github.com/jasonszang","followers_url":"https://api.github.com/users/jasonszang/followers","following_url":"https://api.github.com/users/jasonszang/following{/other_user}","gists_url":"https://api.github.com/users/jasonszang/gists{/gist_id}","starred_url":"https://api.github.com/users/jasonszang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasonszang/subscriptions","organizations_url":"https://api.github.com/users/jasonszang/orgs","repos_url":"https://api.github.com/users/jasonszang/repos","events_url":"https://api.github.com/users/jasonszang/events{/privacy}","received_events_url":"https://api.github.com/users/jasonszang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-29T02:26:22Z","updated_at":"2019-05-29T02:26:22Z","author_association":"CONTRIBUTOR","body":"Travis looks good now @jamesge ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496758807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496779073","html_url":"https://github.com/apache/brpc/issues/786#issuecomment-496779073","issue_url":"https://api.github.com/repos/apache/brpc/issues/786","id":496779073,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5Njc3OTA3Mw==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-29T04:27:43Z","updated_at":"2019-05-29T04:27:43Z","author_association":"CONTRIBUTOR","body":"协议和连接方式分别是什么？如果是单连接，最大吞吐是会受限的，因为要争抢一个tcp连接。真实场景中一个client往往连多台server，这个限制一般不会触及。","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496779073/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496790960","html_url":"https://github.com/apache/brpc/issues/786#issuecomment-496790960","issue_url":"https://api.github.com/repos/apache/brpc/issues/786","id":496790960,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5Njc5MDk2MA==","user":{"login":"Ye-Tian-Zero","id":8231208,"node_id":"MDQ6VXNlcjgyMzEyMDg=","avatar_url":"https://avatars.githubusercontent.com/u/8231208?v=4","gravatar_id":"","url":"https://api.github.com/users/Ye-Tian-Zero","html_url":"https://github.com/Ye-Tian-Zero","followers_url":"https://api.github.com/users/Ye-Tian-Zero/followers","following_url":"https://api.github.com/users/Ye-Tian-Zero/following{/other_user}","gists_url":"https://api.github.com/users/Ye-Tian-Zero/gists{/gist_id}","starred_url":"https://api.github.com/users/Ye-Tian-Zero/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ye-Tian-Zero/subscriptions","organizations_url":"https://api.github.com/users/Ye-Tian-Zero/orgs","repos_url":"https://api.github.com/users/Ye-Tian-Zero/repos","events_url":"https://api.github.com/users/Ye-Tian-Zero/events{/privacy}","received_events_url":"https://api.github.com/users/Ye-Tian-Zero/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-29T05:34:21Z","updated_at":"2019-05-29T05:34:21Z","author_association":"CONTRIBUTOR","body":"忘记提及，协议走的就是默认的，应该是baidu_std_protocol，连接方式没有特别配置，应该也是默认的。只是好奇这个瓶颈在哪里，看来应该是单链接带来的？～","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496790960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496806693","html_url":"https://github.com/apache/brpc/pull/784#issuecomment-496806693","issue_url":"https://api.github.com/repos/apache/brpc/issues/784","id":496806693,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjgwNjY5Mw==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-29T06:43:13Z","updated_at":"2019-05-29T06:43:13Z","author_association":"MEMBER","body":"Hi, the cxxflags used in shared_lib and test are different, please make sure that UTs generated by cmake can be passed. They are broken in my local environment. Since UTs are not run in cmake environment, so travis looks fine.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496806693/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496814947","html_url":"https://github.com/apache/brpc/issues/786#issuecomment-496814947","issue_url":"https://api.github.com/repos/apache/brpc/issues/786","id":496814947,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjgxNDk0Nw==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-29T07:14:03Z","updated_at":"2019-05-29T07:14:03Z","author_association":"CONTRIBUTOR","body":"可以尝试增加client端的线程数","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496814947/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496818695","html_url":"https://github.com/apache/brpc/pull/784#issuecomment-496818695","issue_url":"https://api.github.com/repos/apache/brpc/issues/784","id":496818695,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjgxODY5NQ==","user":{"login":"jasonszang","id":19163259,"node_id":"MDQ6VXNlcjE5MTYzMjU5","avatar_url":"https://avatars.githubusercontent.com/u/19163259?v=4","gravatar_id":"","url":"https://api.github.com/users/jasonszang","html_url":"https://github.com/jasonszang","followers_url":"https://api.github.com/users/jasonszang/followers","following_url":"https://api.github.com/users/jasonszang/following{/other_user}","gists_url":"https://api.github.com/users/jasonszang/gists{/gist_id}","starred_url":"https://api.github.com/users/jasonszang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasonszang/subscriptions","organizations_url":"https://api.github.com/users/jasonszang/orgs","repos_url":"https://api.github.com/users/jasonszang/repos","events_url":"https://api.github.com/users/jasonszang/events{/privacy}","received_events_url":"https://api.github.com/users/jasonszang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-29T07:26:57Z","updated_at":"2019-05-29T07:27:41Z","author_association":"CONTRIBUTOR","body":"Ah, I see you require that some different cxxflags be used to compile non-test code for your unit tests to properly function.\r\nPersonally I feel that this might not be a good choice since you are testing binaries that are compiled differently than what you actually ship with `make install`. Which means that you did not test what you ship.\r\nBut anyway I'll try to fix this and make it work for now.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496818695/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496820028","html_url":"https://github.com/apache/brpc/issues/787#issuecomment-496820028","issue_url":"https://api.github.com/repos/apache/brpc/issues/787","id":496820028,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjgyMDAyOA==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-29T07:31:06Z","updated_at":"2019-05-29T07:31:06Z","author_association":"CONTRIBUTOR","body":"可以试验下[熔断](https://github.com/apache/incubator-brpc/blob/master/docs/cn/circuit_breaker.md)","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496820028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496821857","html_url":"https://github.com/apache/brpc/pull/784#issuecomment-496821857","issue_url":"https://api.github.com/repos/apache/brpc/issues/784","id":496821857,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjgyMTg1Nw==","user":{"login":"jamesge","id":6566535,"node_id":"MDQ6VXNlcjY1NjY1MzU=","avatar_url":"https://avatars.githubusercontent.com/u/6566535?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesge","html_url":"https://github.com/jamesge","followers_url":"https://api.github.com/users/jamesge/followers","following_url":"https://api.github.com/users/jamesge/following{/other_user}","gists_url":"https://api.github.com/users/jamesge/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesge/subscriptions","organizations_url":"https://api.github.com/users/jamesge/orgs","repos_url":"https://api.github.com/users/jamesge/repos","events_url":"https://api.github.com/users/jamesge/events{/privacy}","received_events_url":"https://api.github.com/users/jamesge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-29T07:36:54Z","updated_at":"2019-05-29T07:36:54Z","author_association":"CONTRIBUTOR","body":"UT may turn on additional debugging macros to check consistencies and would like the release build being unaffected. Creating different (and probably incompatible) binaries is the only solution.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496821857/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496828743","html_url":"https://github.com/apache/brpc/pull/784#issuecomment-496828743","issue_url":"https://api.github.com/repos/apache/brpc/issues/784","id":496828743,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjgyODc0Mw==","user":{"login":"jasonszang","id":19163259,"node_id":"MDQ6VXNlcjE5MTYzMjU5","avatar_url":"https://avatars.githubusercontent.com/u/19163259?v=4","gravatar_id":"","url":"https://api.github.com/users/jasonszang","html_url":"https://github.com/jasonszang","followers_url":"https://api.github.com/users/jasonszang/followers","following_url":"https://api.github.com/users/jasonszang/following{/other_user}","gists_url":"https://api.github.com/users/jasonszang/gists{/gist_id}","starred_url":"https://api.github.com/users/jasonszang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasonszang/subscriptions","organizations_url":"https://api.github.com/users/jasonszang/orgs","repos_url":"https://api.github.com/users/jasonszang/repos","events_url":"https://api.github.com/users/jasonszang/events{/privacy}","received_events_url":"https://api.github.com/users/jasonszang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-29T07:59:11Z","updated_at":"2019-05-29T07:59:11Z","author_association":"CONTRIBUTOR","body":"If creating binaries that have different logic and behave differently for UT cannot be avoided then perhaps we should build a separate brpc shared or static library for testing instead of using object libraries directly for binaries.\r\nAnd still, the unability to test release library make me a little nervious :) \r\nMaybe we can solve this by separate tests that depend on these UT specific behaviours to different test binaries, link those against the specially built UT library, and run other normal tests against our release lib?","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496828743/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496832828","html_url":"https://github.com/apache/brpc/issues/787#issuecomment-496832828","issue_url":"https://api.github.com/repos/apache/brpc/issues/787","id":496832828,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjgzMjgyOA==","user":{"login":"scottzzq","id":1217132,"node_id":"MDQ6VXNlcjEyMTcxMzI=","avatar_url":"https://avatars.githubusercontent.com/u/1217132?v=4","gravatar_id":"","url":"https://api.github.com/users/scottzzq","html_url":"https://github.com/scottzzq","followers_url":"https://api.github.com/users/scottzzq/followers","following_url":"https://api.github.com/users/scottzzq/following{/other_user}","gists_url":"https://api.github.com/users/scottzzq/gists{/gist_id}","starred_url":"https://api.github.com/users/scottzzq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scottzzq/subscriptions","organizations_url":"https://api.github.com/users/scottzzq/orgs","repos_url":"https://api.github.com/users/scottzzq/repos","events_url":"https://api.github.com/users/scottzzq/events{/privacy}","received_events_url":"https://api.github.com/users/scottzzq/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-29T08:11:40Z","updated_at":"2019-05-29T08:11:40Z","author_association":"NONE","body":"https://github.com/apache/incubator-brpc/blob/master/src/brpc/socket.cpp#L878 这一行直接调用了SetFailed，内部重新设置fd=-1, 理论上会执行到这一行https://github.com/apache/incubator-brpc/blob/master/src/brpc/socket.cpp#L1933，我们的系统遇到FATAL直接coredump了。 @jamesge ","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496832828/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496844520","html_url":"https://github.com/apache/brpc/pull/784#issuecomment-496844520","issue_url":"https://api.github.com/repos/apache/brpc/issues/784","id":496844520,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5Njg0NDUyMA==","user":{"login":"zyearn","id":4475779,"node_id":"MDQ6VXNlcjQ0NzU3Nzk=","avatar_url":"https://avatars.githubusercontent.com/u/4475779?v=4","gravatar_id":"","url":"https://api.github.com/users/zyearn","html_url":"https://github.com/zyearn","followers_url":"https://api.github.com/users/zyearn/followers","following_url":"https://api.github.com/users/zyearn/following{/other_user}","gists_url":"https://api.github.com/users/zyearn/gists{/gist_id}","starred_url":"https://api.github.com/users/zyearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zyearn/subscriptions","organizations_url":"https://api.github.com/users/zyearn/orgs","repos_url":"https://api.github.com/users/zyearn/repos","events_url":"https://api.github.com/users/zyearn/events{/privacy}","received_events_url":"https://api.github.com/users/zyearn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-29T08:45:38Z","updated_at":"2019-05-29T08:45:38Z","author_association":"MEMBER","body":"The logic in UT and release is not strict different but has a relation of Inclusion. It means that if UT is passed, then we can be sure that the code in release is correct. For example, in http2, in order to test the code work expectedly after stream id runs out, we start it at a very big number so that after only a short time, we can test whether the code is correct or not.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496844520/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496851874","html_url":"https://github.com/apache/brpc/pull/784#issuecomment-496851874","issue_url":"https://api.github.com/repos/apache/brpc/issues/784","id":496851874,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5Njg1MTg3NA==","user":{"login":"jasonszang","id":19163259,"node_id":"MDQ6VXNlcjE5MTYzMjU5","avatar_url":"https://avatars.githubusercontent.com/u/19163259?v=4","gravatar_id":"","url":"https://api.github.com/users/jasonszang","html_url":"https://github.com/jasonszang","followers_url":"https://api.github.com/users/jasonszang/followers","following_url":"https://api.github.com/users/jasonszang/following{/other_user}","gists_url":"https://api.github.com/users/jasonszang/gists{/gist_id}","starred_url":"https://api.github.com/users/jasonszang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasonszang/subscriptions","organizations_url":"https://api.github.com/users/jasonszang/orgs","repos_url":"https://api.github.com/users/jasonszang/repos","events_url":"https://api.github.com/users/jasonszang/events{/privacy}","received_events_url":"https://api.github.com/users/jasonszang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-29T09:06:25Z","updated_at":"2019-05-29T09:08:55Z","author_association":"CONTRIBUTOR","body":"Then you need to make sure this relation of inclusion is always true by writing good codes and tests that never violate this relation always. Might be a burden upon ut writers / developers? But if you guys are confident with that then maybe its OK.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496851874/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496905386","html_url":"https://github.com/apache/brpc/issues/786#issuecomment-496905386","issue_url":"https://api.github.com/repos/apache/brpc/issues/786","id":496905386,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjkwNTM4Ng==","user":{"login":"Ye-Tian-Zero","id":8231208,"node_id":"MDQ6VXNlcjgyMzEyMDg=","avatar_url":"https://avatars.githubusercontent.com/u/8231208?v=4","gravatar_id":"","url":"https://api.github.com/users/Ye-Tian-Zero","html_url":"https://github.com/Ye-Tian-Zero","followers_url":"https://api.github.com/users/Ye-Tian-Zero/followers","following_url":"https://api.github.com/users/Ye-Tian-Zero/following{/other_user}","gists_url":"https://api.github.com/users/Ye-Tian-Zero/gists{/gist_id}","starred_url":"https://api.github.com/users/Ye-Tian-Zero/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ye-Tian-Zero/subscriptions","organizations_url":"https://api.github.com/users/Ye-Tian-Zero/orgs","repos_url":"https://api.github.com/users/Ye-Tian-Zero/repos","events_url":"https://api.github.com/users/Ye-Tian-Zero/events{/privacy}","received_events_url":"https://api.github.com/users/Ye-Tian-Zero/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-29T11:56:48Z","updated_at":"2019-05-29T11:56:48Z","author_association":"CONTRIBUTOR","body":"我试过增加 Client 端线程数，最后上限大概就是 50w qps，再增加线程数 Client 端 CPU 和 Qps 都不会有太大变化了","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496905386/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496918845","html_url":"https://github.com/apache/brpc/issues/779#issuecomment-496918845","issue_url":"https://api.github.com/repos/apache/brpc/issues/779","id":496918845,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjkxODg0NQ==","user":{"login":"kevinmgyu","id":42665912,"node_id":"MDQ6VXNlcjQyNjY1OTEy","avatar_url":"https://avatars.githubusercontent.com/u/42665912?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinmgyu","html_url":"https://github.com/kevinmgyu","followers_url":"https://api.github.com/users/kevinmgyu/followers","following_url":"https://api.github.com/users/kevinmgyu/following{/other_user}","gists_url":"https://api.github.com/users/kevinmgyu/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinmgyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinmgyu/subscriptions","organizations_url":"https://api.github.com/users/kevinmgyu/orgs","repos_url":"https://api.github.com/users/kevinmgyu/repos","events_url":"https://api.github.com/users/kevinmgyu/events{/privacy}","received_events_url":"https://api.github.com/users/kevinmgyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-29T12:39:16Z","updated_at":"2019-05-29T12:39:16Z","author_association":"NONE","body":"up","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496918845/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496925016","html_url":"https://github.com/apache/brpc/issues/786#issuecomment-496925016","issue_url":"https://api.github.com/repos/apache/brpc/issues/786","id":496925016,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjkyNTAxNg==","user":{"login":"Ye-Tian-Zero","id":8231208,"node_id":"MDQ6VXNlcjgyMzEyMDg=","avatar_url":"https://avatars.githubusercontent.com/u/8231208?v=4","gravatar_id":"","url":"https://api.github.com/users/Ye-Tian-Zero","html_url":"https://github.com/Ye-Tian-Zero","followers_url":"https://api.github.com/users/Ye-Tian-Zero/followers","following_url":"https://api.github.com/users/Ye-Tian-Zero/following{/other_user}","gists_url":"https://api.github.com/users/Ye-Tian-Zero/gists{/gist_id}","starred_url":"https://api.github.com/users/Ye-Tian-Zero/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ye-Tian-Zero/subscriptions","organizations_url":"https://api.github.com/users/Ye-Tian-Zero/orgs","repos_url":"https://api.github.com/users/Ye-Tian-Zero/repos","events_url":"https://api.github.com/users/Ye-Tian-Zero/events{/privacy}","received_events_url":"https://api.github.com/users/Ye-Tian-Zero/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-29T12:57:27Z","updated_at":"2019-05-29T12:57:27Z","author_association":"CONTRIBUTOR","body":"但是增加客户端是可以提升server端qps的","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496925016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496938288","html_url":"https://github.com/apache/brpc/pull/784#issuecomment-496938288","issue_url":"https://api.github.com/repos/apache/brpc/issues/784","id":496938288,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjkzODI4OA==","user":{"login":"jasonszang","id":19163259,"node_id":"MDQ6VXNlcjE5MTYzMjU5","avatar_url":"https://avatars.githubusercontent.com/u/19163259?v=4","gravatar_id":"","url":"https://api.github.com/users/jasonszang","html_url":"https://github.com/jasonszang","followers_url":"https://api.github.com/users/jasonszang/followers","following_url":"https://api.github.com/users/jasonszang/following{/other_user}","gists_url":"https://api.github.com/users/jasonszang/gists{/gist_id}","starred_url":"https://api.github.com/users/jasonszang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasonszang/subscriptions","organizations_url":"https://api.github.com/users/jasonszang/orgs","repos_url":"https://api.github.com/users/jasonszang/repos","events_url":"https://api.github.com/users/jasonszang/events{/privacy}","received_events_url":"https://api.github.com/users/jasonszang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-29T13:32:52Z","updated_at":"2019-05-29T13:32:52Z","author_association":"CONTRIBUTOR","body":"So I for now give up on these tests that relies on non-test objects built with specific cxxflags and instead only change those who do not to directly link against the release library.\r\nTest binaries downsized to 1.2G instead of 600M but its still a big improvement.\r\nAs a byproduct, ctest now works correctly and users can now `make test` and run various `ctest` commands with CMake builds.","reactions":{"url":"https://api.github.com/repos/apache/brpc/issues/comments/496938288/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]