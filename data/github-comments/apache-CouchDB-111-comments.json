[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1226758043","html_url":"https://github.com/apache/couchdb/pull/4140#issuecomment-1226758043","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4140","id":1226758043,"node_id":"IC_kwDOAAMmUc5JHteb","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-25T04:24:37Z","updated_at":"2022-08-25T04:24:37Z","author_association":"CONTRIBUTOR","body":"Noticed a recent failure in the full CI run referencing a \"**error:{notsup,{\"mac.c\",264},\"Unsupported digest algorithm\"}\"\r\n\r\nhttps://ci-couchdb.apache.org/blue/organizations/jenkins/jenkins-cm1%2FFullPlatformMatrix/detail/main/327/pipeline/203\r\n\r\n```\r\n[2022-08-24T16:57:41.113Z] module 'chttpd_auth_hash_algorithms_tests'\r\n\r\n[2022-08-24T16:57:41.113Z]   Testing hash algorithms for cookie auth\r\n\r\n[2022-08-24T16:57:41.467Z]     chttpd_auth_hash_algorithms_tests:31: with (test_hash_algorithms_should_work)...*failed*\r\n\r\n[2022-08-24T16:57:41.467Z] in function crypto:mac_nif/4\r\n\r\n[2022-08-24T16:57:41.467Z]   called as mac_nif(hmac,blake2s,<<\"305ead508cce07ab432b7cd9d6455349bc1dd8ebfa0524f039f502d3\"...>>,\"adm_user:63065885\")\r\n\r\n[2022-08-24T16:57:41.467Z] in call from chttpd_auth_hash_algorithms_tests:make_auth_session_string/4 (test/eunit/chttpd_auth_hash_algorithms_tests.erl, line 68)\r\n\r\n[2022-08-24T16:57:41.467Z] in call from chttpd_auth_hash_algorithms_tests:test_hash_algorithm/2 (test/eunit/chttpd_auth_hash_algorithms_tests.erl, line 85)\r\n\r\n[2022-08-24T16:57:41.467Z] in call from eunit_test:run_testfun/1 (eunit_test.erl, line 71)\r\n\r\n[2022-08-24T16:57:41.467Z] in call from eunit_proc:run_test/1 (eunit_proc.erl, line 522)\r\n\r\n[2022-08-24T16:57:41.467Z] in call from eunit_proc:with_timeout/3 (eunit_proc.erl, line 347)\r\n\r\n[2022-08-24T16:57:41.467Z] in call from eunit_proc:handle_test/2 (eunit_proc.erl, line 505)\r\n\r\n[2022-08-24T16:57:41.467Z] in call from eunit_proc:tests_inorder/3 (eunit_proc.erl, line 447)\r\n\r\n[2022-08-24T16:57:41.467Z] **error:{notsup,{\"mac.c\",264},\"Unsupported digest algorithm\"}\r\n\r\n[2022-08-24T16:57:41.467Z]   output:<<\"\">>\r\n```\r\n\r\nIt may be related to this change, I didn't get a chance to dig in to find out","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1226758043/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1226792154","html_url":"https://github.com/apache/couchdb/pull/4140#issuecomment-1226792154","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4140","id":1226792154,"node_id":"IC_kwDOAAMmUc5JH1za","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-25T05:26:09Z","updated_at":"2022-08-25T05:26:09Z","author_association":"CONTRIBUTOR","body":"I will look at this again.\r\n\r\n1. why didn’t it fail in the PR-CI?\r\n2. What Erlang version do we use in the Full CI?\r\n3. It should skip a algorithm which doesn’t exists…\r\n4. It seems blake2s as a test algorithm is the trigger…\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1226792154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1226814556","html_url":"https://github.com/apache/couchdb/pull/4144#issuecomment-1226814556","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4144","id":1226814556,"node_id":"IC_kwDOAAMmUc5JH7Rc","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-25T06:04:17Z","updated_at":"2022-08-25T23:52:21Z","author_association":"CONTRIBUTOR","body":"Preliminary benchmarks replicating 1M docs locally on a laptop using [couchdyno](https://github.com/cloudant-labs/couchdyno) show a 30% speedup\r\n\r\nWith `main`\r\n```\r\nr=rep.Rep(); r.replicate_1_to_n_and_compare(1, num=1000000, revs=1, branches=1, normal=True, reset_target=True, reset_source=True, cycles=1)\r\n...\r\n >  replicated in 490 sec\r\n```\r\n\r\nWith `_bulk_get` support\r\n\r\n```\r\nr=rep.Rep(); r.replicate_1_to_n_and_compare(1, num=1000000, revs=1, branches=1, normal=True, reset_target=True, reset_source=True, cycles=1)\r\n...\r\n >  replicated in 335 sec\r\n```\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1226814556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1226848841","html_url":"https://github.com/apache/couchdb/pull/4140#issuecomment-1226848841","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4140","id":1226848841,"node_id":"IC_kwDOAAMmUc5JIDpJ","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-25T06:50:44Z","updated_at":"2022-08-25T06:50:44Z","author_association":"CONTRIBUTOR","body":"It fails on:\r\n\r\n1. CentOS 7 with `blake2s` and\r\n2. Ubuntu 22.04 with `md4`\r\n\r\nI think they are not supported by the openssl version in erlang. Need to investigate why they are executed, if they are not supported...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1226848841/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1226935189","html_url":"https://github.com/apache/couchdb/pull/4140#issuecomment-1226935189","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4140","id":1226935189,"node_id":"IC_kwDOAAMmUc5JIYuV","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-25T08:18:30Z","updated_at":"2022-08-25T08:18:30Z","author_association":"CONTRIBUTOR","body":"Found it, the test itself doesn't check for supported hash algorithms.\r\nRefactor the test to use the checks too. See #4156. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1226935189/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1227116437","html_url":"https://github.com/apache/couchdb/pull/3932#issuecomment-1227116437","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3932","id":1227116437,"node_id":"IC_kwDOAAMmUc5JJE-V","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-25T11:10:37Z","updated_at":"2022-08-25T11:10:37Z","author_association":"CONTRIBUTOR","body":"Hi Francesco,\r\n\r\nwould you like to update and rebase your PR against the current main branch to easier review it?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1227116437/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1227118453","html_url":"https://github.com/apache/couchdb/pull/4156#issuecomment-1227118453","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4156","id":1227118453,"node_id":"IC_kwDOAAMmUc5JJFd1","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-25T11:12:53Z","updated_at":"2022-08-25T11:12:53Z","author_association":"CONTRIBUTOR","body":"@nickva Can we test this PR against the full CI build before merging?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1227118453/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1227348670","html_url":"https://github.com/apache/couchdb/pull/4156#issuecomment-1227348670","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4156","id":1227348670,"node_id":"IC_kwDOAAMmUc5JJ9q-","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-25T14:36:25Z","updated_at":"2022-08-25T14:36:25Z","author_association":"CONTRIBUTOR","body":"@big-r81 Thanks for the quick fix!\r\n\r\nTo test the PR with the full CI suite rename the PR branch to have a `jenkins-` prefix. So it would be something like`jenkins-fix-chttpd_auth_hash_algorithms`","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1227348670/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1227386398","html_url":"https://github.com/apache/couchdb/pull/4144#issuecomment-1227386398","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4144","id":1227386398,"node_id":"IC_kwDOAAMmUc5JKG4e","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-25T15:05:54Z","updated_at":"2022-08-25T15:05:54Z","author_association":"CONTRIBUTOR","body":"This is an example how the exponential moving average behaves with `BULK_GET_RATIO_DECAY = 0.25`\r\n\r\n<img width=\"535\" alt=\"ema25\" src=\"https://user-images.githubusercontent.com/211822/186701075-a36be1e6-80a8-4d77-a75b-e132db919684.png\">","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1227386398/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1227490483","html_url":"https://github.com/apache/couchdb/pull/4156#issuecomment-1227490483","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4156","id":1227490483,"node_id":"IC_kwDOAAMmUc5JKgSz","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-25T16:19:48Z","updated_at":"2022-08-25T16:19:48Z","author_association":"CONTRIBUTOR","body":"Superseeded by #4157, for full jenkins CI run.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1227490483/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1227865062","html_url":"https://github.com/apache/couchdb/pull/4144#issuecomment-1227865062","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4144","id":1227865062,"node_id":"IC_kwDOAAMmUc5JL7vm","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-25T23:52:09Z","updated_at":"2022-08-30T18:20:12Z","author_association":"CONTRIBUTOR","body":"Checking compatibility replicating from older versions of Apache CouchDB to either the main branch or the PR branch.\r\n\r\nOlder versions were run with `docker run -p 5984:5984 -it couchdb:$version` then used couchdyno with 10k documents.\r\n`r=rep.Rep(); r.replicate_1_to_n_and_compare(1, num=100000, normal=True)` and measured the time to replicate those documents.\r\n\r\n| CouchDB Version | main branch | PR branch |\r\n| ------------------|-------------| ----|\r\n|3.2.2                       | 160 sec | 55 sec (65% speedup) |\r\n|2.3.1                        | 80 sec | 20 sec (75% speedup) |\r\n|1.7.2                        |  65 sec | 15 sec (77% speedup) |\r\n|1.6.1                        | 75 sec | 70 sec (no _bulk_get API)\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1227865062/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1229126757","html_url":"https://github.com/apache/couchdb/issues/4154#issuecomment-1229126757","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4154","id":1229126757,"node_id":"IC_kwDOAAMmUc5JQvxl","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-27T05:22:45Z","updated_at":"2022-08-27T18:06:54Z","author_association":"CONTRIBUTOR","body":"Looking at adding an  Rockylinux 9 base image in https://github.com/apache/couchdb-pkg it looks like RHEL 9 and its clones do not include the mozjs package(Spidermonkey i.e. our Javascript engine) any longer.\r\n\r\nRelated issue at RedHat https://bugzilla.redhat.com/show_bug.cgi?id=1958111\r\n\r\nThat would complicate and slow down supporting RHEL 9 clones as it seems we'd have to build and maintain our own mozjs RPM. There is a chance EPEL 9 might have it (but so far haven't found it there) or maybe we can find another RPM from Fedora or other RPM based distros which somehow are compatible with RHEL 9 clones.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1229126757/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1229759475","html_url":"https://github.com/apache/couchdb/issues/4154#issuecomment-1229759475","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4154","id":1229759475,"node_id":"IC_kwDOAAMmUc5JTKPz","user":{"login":"konrad-ohms","id":40577406,"node_id":"MDQ6VXNlcjQwNTc3NDA2","avatar_url":"https://avatars.githubusercontent.com/u/40577406?v=4","gravatar_id":"","url":"https://api.github.com/users/konrad-ohms","html_url":"https://github.com/konrad-ohms","followers_url":"https://api.github.com/users/konrad-ohms/followers","following_url":"https://api.github.com/users/konrad-ohms/following{/other_user}","gists_url":"https://api.github.com/users/konrad-ohms/gists{/gist_id}","starred_url":"https://api.github.com/users/konrad-ohms/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/konrad-ohms/subscriptions","organizations_url":"https://api.github.com/users/konrad-ohms/orgs","repos_url":"https://api.github.com/users/konrad-ohms/repos","events_url":"https://api.github.com/users/konrad-ohms/events{/privacy}","received_events_url":"https://api.github.com/users/konrad-ohms/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-29T04:34:48Z","updated_at":"2022-08-29T04:34:48Z","author_association":"NONE","body":"Okay, I see, that is unfortunate 😕 \r\nI guess the RHEL8 rpm will no longer work on RHEL9?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1229759475/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1230501337","html_url":"https://github.com/apache/couchdb/issues/2219#issuecomment-1230501337","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2219","id":1230501337,"node_id":"IC_kwDOAAMmUc5JV_XZ","user":{"login":"celder628","id":20172773,"node_id":"MDQ6VXNlcjIwMTcyNzcz","avatar_url":"https://avatars.githubusercontent.com/u/20172773?v=4","gravatar_id":"","url":"https://api.github.com/users/celder628","html_url":"https://github.com/celder628","followers_url":"https://api.github.com/users/celder628/followers","following_url":"https://api.github.com/users/celder628/following{/other_user}","gists_url":"https://api.github.com/users/celder628/gists{/gist_id}","starred_url":"https://api.github.com/users/celder628/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/celder628/subscriptions","organizations_url":"https://api.github.com/users/celder628/orgs","repos_url":"https://api.github.com/users/celder628/repos","events_url":"https://api.github.com/users/celder628/events{/privacy}","received_events_url":"https://api.github.com/users/celder628/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-29T15:50:18Z","updated_at":"2022-08-29T15:55:17Z","author_association":"NONE","body":"We are seeing an issue on CouchDB 2.3.1 and were curious if this is the same or a related problem:\r\n\r\nThere are a number of GETs that seems to run quickly.  One of the calls is a query:\r\n\r\n2022-08-25T09:32:42.672765857Z [notice] 2022-08-25T09:32:42.672090Z nonode@nohost <0.1173.0> 136e1a264a localhost:5984 127.0.0.1 J3AnRJkA8PjiQ1nedk0s2Bi8FiUSEsg5 POST /jci-prod-channel_jcicc/_all_docs?include_docs=true 200 ok 4\r\n\r\nAbout 10 seconds later we see:\r\n\r\n2022-08-25T09:32:53.374978586Z [error] 2022-08-25T09:32:53.374140Z nonode@nohost <0.8108.2> eb8d1a741a req_err(1041696419) unknown_error : function_clause\r\n\r\n2022-08-25T09:32:53.375007768Z     [<<\"couch_mrview_http:view_cb/2 L338\">>,<<\"chttpd_db:all_docs_view/4 L769\">>,<<\"chttpd:handle_req_after_auth/2 L320\">>,<<\"chttpd:process_request/1 L303\">>,<<\"chttpd:handle_request_int/1 L243\">>,<<\"mochiweb_http:headers/6 L128\">>,<<\"proc_lib:init_p_do_apply/3 L247\">>]\r\n\r\n2022-08-25T09:32:53.375023894Z [notice] 2022-08-25T09:32:53.374479Z nonode@nohost <0.8108.2> eb8d1a741a localhost:5984 127.0.0.1 J3AnRJkA8PjiQ1nedk0s2Bi8FiUSEsg5 POST /jci-prod-channel_lscc/_all_docs?include_docs=true 500 ok 10707\r\n\r\nThe couchdb server does not appear to be under any stress when this happens.  Since this is from a customer, we don't have the exact query that is being executed.   We're trying to evaluate using logs.\r\n\r\nIs it possible this is a bad query causing the error in the background?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1230501337/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1233248673","html_url":"https://github.com/apache/couchdb/issues/2219#issuecomment-1233248673","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2219","id":1233248673,"node_id":"IC_kwDOAAMmUc5JgeGh","user":{"login":"denyeart","id":20165681,"node_id":"MDQ6VXNlcjIwMTY1Njgx","avatar_url":"https://avatars.githubusercontent.com/u/20165681?v=4","gravatar_id":"","url":"https://api.github.com/users/denyeart","html_url":"https://github.com/denyeart","followers_url":"https://api.github.com/users/denyeart/followers","following_url":"https://api.github.com/users/denyeart/following{/other_user}","gists_url":"https://api.github.com/users/denyeart/gists{/gist_id}","starred_url":"https://api.github.com/users/denyeart/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/denyeart/subscriptions","organizations_url":"https://api.github.com/users/denyeart/orgs","repos_url":"https://api.github.com/users/denyeart/repos","events_url":"https://api.github.com/users/denyeart/events{/privacy}","received_events_url":"https://api.github.com/users/denyeart/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-31T18:00:24Z","updated_at":"2022-08-31T18:00:24Z","author_association":"NONE","body":"@wohali I'm working with @celder628 on this one. Any advice on how to troubleshoot these random function_clause errors on relatively idle CouchDB 2.3.1 servers? Would you expect improvement on CouchDB v3.2?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1233248673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280589766","html_url":"https://github.com/apache/couchdb/issues/4213#issuecomment-1280589766","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4213","id":1280589766,"node_id":"IC_kwDOAAMmUc5MVD_G","user":{"login":"RafaelFigueiredo","id":7611174,"node_id":"MDQ6VXNlcjc2MTExNzQ=","avatar_url":"https://avatars.githubusercontent.com/u/7611174?v=4","gravatar_id":"","url":"https://api.github.com/users/RafaelFigueiredo","html_url":"https://github.com/RafaelFigueiredo","followers_url":"https://api.github.com/users/RafaelFigueiredo/followers","following_url":"https://api.github.com/users/RafaelFigueiredo/following{/other_user}","gists_url":"https://api.github.com/users/RafaelFigueiredo/gists{/gist_id}","starred_url":"https://api.github.com/users/RafaelFigueiredo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RafaelFigueiredo/subscriptions","organizations_url":"https://api.github.com/users/RafaelFigueiredo/orgs","repos_url":"https://api.github.com/users/RafaelFigueiredo/repos","events_url":"https://api.github.com/users/RafaelFigueiredo/events{/privacy}","received_events_url":"https://api.github.com/users/RafaelFigueiredo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-31T18:58:50Z","updated_at":"2022-08-31T18:58:50Z","author_association":"NONE","body":"Hi, @big-r81, currently is a manual process and has some drawbacks like the lack of details compared to the main documentation, but it also has benefits like code generation and we are able to interact directly. My plan is to release the first iteration on September 15th.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280589766/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1233753386","html_url":"https://github.com/apache/couchdb/issues/2219#issuecomment-1233753386","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2219","id":1233753386,"node_id":"IC_kwDOAAMmUc5JiZUq","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-01T05:18:32Z","updated_at":"2022-09-01T05:18:32Z","author_association":"CONTRIBUTOR","body":"You could try adding an extra function clause to `couch_mrview_http:view_cb/2` to log the error with `couch_log:error(...)`.\r\n\r\n```erlang\r\nview_cb({row, Row}, #vacc{meta_sent=true}=Acc) ->\r\n    % Adding another row\r\n    Chunk = [prepend_val(Acc), row_to_json(Row)],\r\n    maybe_flush_response(Acc#vacc{row_sent=true}, Chunk, iolist_size(Chunk));\r\n\r\nview_cb(Msg, Acc) ->\r\n    couch_log:error(\"~p : xxxxx function_clause ~p ~p\", [?MODULE, Msg, Acc]),\r\n    error(function_clause).\r\n```\r\n\r\nThere is also a good chance it was fixed in 3.x series, so try to upgrade to 3.2.2 and see if it still happens.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1233753386/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1233760258","html_url":"https://github.com/apache/couchdb/issues/4136#issuecomment-1233760258","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4136","id":1233760258,"node_id":"IC_kwDOAAMmUc5JibAC","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-01T05:31:06Z","updated_at":"2022-09-01T05:31:06Z","author_association":"CONTRIBUTOR","body":"We have https://github.com/apache/couchdb/tree/main/src/weatherreport which can diagnose some of the issues, maybe we can enhance to check for more things?\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1233760258/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1234520479","html_url":"https://github.com/apache/couchdb/issues/4159#issuecomment-1234520479","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4159","id":1234520479,"node_id":"IC_kwDOAAMmUc5JlUmf","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-01T16:35:43Z","updated_at":"2022-09-01T16:39:03Z","author_association":"CONTRIBUTOR","body":"I wasn't able to tell if it's the _view results query you're asking about. If it is, when you're updating documents, it may take some time for the documents to be indexed. You can don't mind receiving stale results a bit you can use the `update=false` parameter. See https://docs.couchdb.org/en/stable/maintenance/performance.html#views for more details.\r\n\r\nIt maybe be helpful if you could provide specific steps to reproduce or at least specific API calls.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1234520479/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1239442611","html_url":"https://github.com/apache/couchdb/pull/4164#issuecomment-1239442611","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4164","id":1239442611,"node_id":"IC_kwDOAAMmUc5J4GSz","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-07T14:08:47Z","updated_at":"2022-09-08T04:13:40Z","author_association":"CONTRIBUTOR","body":"To better illustrate how it works here are the cases described above generated with a few bogus PRs into this branch:\r\n\r\n#### Docs only \r\n\r\n![docs_only](https://user-images.githubusercontent.com/211822/189032514-3b61b86f-9d40-4079-a377-65c9a8f60b87.png)\r\n\r\n#### Docs and source changes\r\n\r\n![docs_and_source](https://user-images.githubusercontent.com/211822/189032620-543a9dd9-f0f9-474d-b6b5-fdb4fa5a59d4.png)\r\n\r\n#### Source only changes\r\n\r\n![no_docs_source_only](https://user-images.githubusercontent.com/211822/189032678-93f12b3e-8368-4b60-b931-34a9798be579.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1239442611/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1239504311","html_url":"https://github.com/apache/couchdb/pull/4163#issuecomment-1239504311","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4163","id":1239504311,"node_id":"IC_kwDOAAMmUc5J4VW3","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-07T14:57:47Z","updated_at":"2022-09-09T05:53:38Z","author_association":"CONTRIBUTOR","body":"This is the behavior of the 0.4 decay factor\r\n\r\n<img width=\"792\" alt=\"revs_diff_stats\" src=\"https://user-images.githubusercontent.com/211822/188910166-2e76704d-81d1-48b2-85a2-10050ffcdcf0.png\">\r\n\r\nIt's affected less by recent history than the _bulk_get one. The idea being is we can react a bit quicker to changes if we if the proportion dips below the threshold (0.95) so we can start calling _revs_diff again.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1239504311/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1241453546","html_url":"https://github.com/apache/couchdb/pull/4164#issuecomment-1241453546","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4164","id":1241453546,"node_id":"IC_kwDOAAMmUc5J_xPq","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-09T03:21:50Z","updated_at":"2022-09-09T05:06:24Z","author_association":"CONTRIBUTOR","body":"Good points, @big-r81\r\n\r\nRTD allows configuring which branches/tags to build. I think we could keep `stable` (which is an alias to `3.2.2`) and `latest`. `latest` is automatically built from `main`. `stable` can be either an explicit branch, or if that's missing it's automatically the highest semver release tag (the one we use). But our `3.2.2` tag in the main repo won't build the moved docs. So thinking of making a `3.2.2-docs` branch with the integrated docs for 3.2.2 for that case.\r\n\r\nAs for archiving we could just update the main branch and put just a readme file indicating to move the pull request to the main repo.. After some time we can archive it too.\r\n\r\nUnfortunately the pending PRs would have to be re-targeted for the main repo. \r\n\r\nI think there would be some links / example readme changes.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1241453546/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1241931451","html_url":"https://github.com/apache/couchdb/issues/3977#issuecomment-1241931451","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3977","id":1241931451,"node_id":"IC_kwDOAAMmUc5KBl67","user":{"login":"abarbosa-godaddy","id":106174121,"node_id":"U_kgDOBlQWqQ","avatar_url":"https://avatars.githubusercontent.com/u/106174121?v=4","gravatar_id":"","url":"https://api.github.com/users/abarbosa-godaddy","html_url":"https://github.com/abarbosa-godaddy","followers_url":"https://api.github.com/users/abarbosa-godaddy/followers","following_url":"https://api.github.com/users/abarbosa-godaddy/following{/other_user}","gists_url":"https://api.github.com/users/abarbosa-godaddy/gists{/gist_id}","starred_url":"https://api.github.com/users/abarbosa-godaddy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abarbosa-godaddy/subscriptions","organizations_url":"https://api.github.com/users/abarbosa-godaddy/orgs","repos_url":"https://api.github.com/users/abarbosa-godaddy/repos","events_url":"https://api.github.com/users/abarbosa-godaddy/events{/privacy}","received_events_url":"https://api.github.com/users/abarbosa-godaddy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-09T12:43:36Z","updated_at":"2022-09-09T12:43:36Z","author_association":"NONE","body":"Does the `beginner-friendly` tag mean that this issue is good for new contributors?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1241931451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242034203","html_url":"https://github.com/apache/couchdb/pull/4170#issuecomment-1242034203","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4170","id":1242034203,"node_id":"IC_kwDOAAMmUc5KB_Ab","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-09T14:19:51Z","updated_at":"2022-09-09T14:19:51Z","author_association":"CONTRIBUTOR","body":"Good first test of a fast docs-only CI run!\r\n\r\n<img width=\"629\" alt=\"Screen Shot 2022-09-09 at 10 18 42 AM\" src=\"https://user-images.githubusercontent.com/211822/189371680-1d9c51e4-e355-4808-8d8b-f16c48b7a4f3.png\">\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242034203/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242045124","html_url":"https://github.com/apache/couchdb/issues/4092#issuecomment-1242045124","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4092","id":1242045124,"node_id":"IC_kwDOAAMmUc5KCBrE","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-09T14:28:18Z","updated_at":"2022-09-09T14:28:18Z","author_association":"MEMBER","body":"how would that work and what would it do?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242045124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242045469","html_url":"https://github.com/apache/couchdb/pull/4164#issuecomment-1242045469","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4164","id":1242045469,"node_id":"IC_kwDOAAMmUc5KCBwd","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-09T14:28:28Z","updated_at":"2022-09-09T14:28:28Z","author_association":"CONTRIBUTOR","body":"Maybe it’s a good idea to define an .editorconfig for the project / projects?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242045469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242160115","html_url":"https://github.com/apache/couchdb/pull/4164#issuecomment-1242160115","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4164","id":1242160115,"node_id":"IC_kwDOAAMmUc5KCdvz","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-09T15:59:59Z","updated_at":"2022-09-09T15:59:59Z","author_association":"CONTRIBUTOR","body":"> Have a few comments, but it appears I was too late!\r\n\r\nIt’s never too late! Will fix it in a separate PR. Thanks for taking a look, @jaydoane ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242160115/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242199160","html_url":"https://github.com/apache/couchdb/pull/4164#issuecomment-1242199160","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4164","id":1242199160,"node_id":"IC_kwDOAAMmUc5KCnR4","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-09T16:32:20Z","updated_at":"2022-09-09T16:32:20Z","author_association":"CONTRIBUTOR","body":"I tried this in `.emacs`:\r\n\r\n```\r\n'(groovy-indent-offset 2)\r\n```\r\n\r\nI'll reformat both the full and pr files\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242199160/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242207082","html_url":"https://github.com/apache/couchdb/pull/4164#issuecomment-1242207082","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4164","id":1242207082,"node_id":"IC_kwDOAAMmUc5KCpNq","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-09T16:39:22Z","updated_at":"2022-09-09T16:39:22Z","author_association":"CONTRIBUTOR","body":"@jaydoane https://github.com/apache/couchdb/pull/4171","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242207082/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242208623","html_url":"https://github.com/apache/couchdb/pull/4164#issuecomment-1242208623","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4164","id":1242208623,"node_id":"IC_kwDOAAMmUc5KCplv","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-09T16:40:52Z","updated_at":"2022-09-09T16:40:52Z","author_association":"CONTRIBUTOR","body":"> Maybe it’s a good idea to define an .editorconfig for the project / projects?\r\n\r\nI wonder if emacs could read that? For erlang it's relatively straightforward as we're using erlfmt but for other languages it's a bit unspecified. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242208623/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242302116","html_url":"https://github.com/apache/couchdb/pull/4164#issuecomment-1242302116","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4164","id":1242302116,"node_id":"IC_kwDOAAMmUc5KDAak","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-09T17:59:58Z","updated_at":"2022-09-09T17:59:58Z","author_association":"CONTRIBUTOR","body":"> > Maybe it’s a good idea to define an .editorconfig for the project / projects?\r\n> \r\n> I wonder if emacs could read that? For erlang it's relatively straightforward as we're using erlfmt but for other languages it's a bit unspecified.\r\n\r\nhttps://github.com/editorconfig/editorconfig-emacs","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242302116/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242614635","html_url":"https://github.com/apache/couchdb/issues/3977#issuecomment-1242614635","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3977","id":1242614635,"node_id":"IC_kwDOAAMmUc5KEMtr","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-10T04:04:47Z","updated_at":"2022-09-10T04:04:47Z","author_association":"CONTRIBUTOR","body":"@abarbosa-godaddy yeah, that's the idea of the tag. To do some validation that some parameters are mutually exclusive.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242614635/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242787386","html_url":"https://github.com/apache/couchdb/pull/4172#issuecomment-1242787386","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4172","id":1242787386,"node_id":"IC_kwDOAAMmUc5KE246","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-10T18:51:20Z","updated_at":"2022-09-10T20:48:47Z","author_association":"CONTRIBUTOR","body":"> It seems like there are two ways to configure a replication to use _bulk_get: one globally via the config option `[replicator] use_bulk_get` and the other as a parameter in the replication doc itself. Is that correct? If so, which takes precedence? It looks like the latter does, but it's not super clear from reading the code. Should we add a test that makes the precedence explicit?\r\n\r\nThe idea is to follow the same pattern as the rest of the replication jobs settings. For instance the existing “use_checkpoints” setting. So the precedence is the same as the other settings - the global default is in the ini file and the replication job may override it.\r\n\r\nGood idea to add a test for it.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242787386/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242804148","html_url":"https://github.com/apache/couchdb/pull/4172#issuecomment-1242804148","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4172","id":1242804148,"node_id":"IC_kwDOAAMmUc5KE6-0","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-10T21:01:55Z","updated_at":"2022-09-10T21:01:55Z","author_association":"CONTRIBUTOR","body":"@jaydoane updated the PR with two more tests: one checks that a global disable and a per-job enable works, and the other checks that global disable works and overrides the code default.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1242804148/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1244675368","html_url":"https://github.com/apache/couchdb/pull/4174#issuecomment-1244675368","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4174","id":1244675368,"node_id":"IC_kwDOAAMmUc5KMD0o","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-12T22:56:06Z","updated_at":"2022-09-12T22:56:06Z","author_association":"CONTRIBUTOR","body":"The rendered example of this PR is at https://docs.couchdb.org/en/try-to-fix-docs-edit-link/","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1244675368/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1244799690","html_url":"https://github.com/apache/couchdb/pull/4174#issuecomment-1244799690","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4174","id":1244799690,"node_id":"IC_kwDOAAMmUc5KMiLK","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-13T01:54:58Z","updated_at":"2022-09-13T01:54:58Z","author_association":"CONTRIBUTOR","body":"> only a small question: could we add httpdomain from sphinxcontrib over pip to easier update this extension?\r\n\r\ngood idea, @big-r81, I'll give that a try","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1244799690/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1244812087","html_url":"https://github.com/apache/couchdb/pull/4174#issuecomment-1244812087","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4174","id":1244812087,"node_id":"IC_kwDOAAMmUc5KMlM3","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-13T02:19:06Z","updated_at":"2022-09-13T02:32:32Z","author_association":"CONTRIBUTOR","body":"@big-r81 great suggestion! httpcontrib now comes from pip\r\n\r\n(Also updated https://docs.couchdb.org/en/try-to-fix-docs-edit-link/)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1244812087/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1244816446","html_url":"https://github.com/apache/couchdb/issues/4175#issuecomment-1244816446","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4175","id":1244816446,"node_id":"IC_kwDOAAMmUc5KMmQ-","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-13T02:27:50Z","updated_at":"2022-09-13T02:29:17Z","author_association":"CONTRIBUTOR","body":"@diachedelic I think it could be related to the transformation that happens in https://github.com/apache/couchdb/blob/main/share/server/60/rewrite_fun.js\r\n\r\nThere, we parse js functions into an AST, patch them  to turn \"function(...) {...}\" into a proper JS syntax (CouchDB global \"function(...) {...}\" it turns out are not valid JS), and then back to a js source string. It could be that the parsers we use esprima and escodegen don't handle ES6 syntax.  That's just a guess so far, I haven't validated it yet.\r\n\r\nA related issue perhaps as well: https://github.com/apache/couchdb/issues/2372","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1244816446/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1244852470","html_url":"https://github.com/apache/couchdb/issues/4175#issuecomment-1244852470","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4175","id":1244852470,"node_id":"IC_kwDOAAMmUc5KMvD2","user":{"login":"diachedelic","id":310464,"node_id":"MDQ6VXNlcjMxMDQ2NA==","avatar_url":"https://avatars.githubusercontent.com/u/310464?v=4","gravatar_id":"","url":"https://api.github.com/users/diachedelic","html_url":"https://github.com/diachedelic","followers_url":"https://api.github.com/users/diachedelic/followers","following_url":"https://api.github.com/users/diachedelic/following{/other_user}","gists_url":"https://api.github.com/users/diachedelic/gists{/gist_id}","starred_url":"https://api.github.com/users/diachedelic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/diachedelic/subscriptions","organizations_url":"https://api.github.com/users/diachedelic/orgs","repos_url":"https://api.github.com/users/diachedelic/repos","events_url":"https://api.github.com/users/diachedelic/events{/privacy}","received_events_url":"https://api.github.com/users/diachedelic/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-13T03:30:46Z","updated_at":"2022-09-13T03:30:46Z","author_association":"NONE","body":"Sorry, I have mischaracterised this error. It appears to actually be a load-sensitive, intermittent failure that happened to correspond perfectly with me switching `var` and `let` a few times. I still don't understand why the error is occurring, but I don't think it is caused solely by using ES6 features in view functions.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1244852470/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1244859708","html_url":"https://github.com/apache/couchdb/issues/4175#issuecomment-1244859708","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4175","id":1244859708,"node_id":"IC_kwDOAAMmUc5KMw08","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-13T03:44:27Z","updated_at":"2022-09-13T03:44:59Z","author_association":"CONTRIBUTOR","body":"Ah no worries, thanks for reaching out. \r\n\r\nThere was an issue related to performance regression with custom reduces with later (> 1.8.5. spidermonkey) https://github.com/apache/couchdb/issues/3517. Something to be aware when upgrading from older CouchDB instances.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1244859708/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1244872458","html_url":"https://github.com/apache/couchdb/issues/4175#issuecomment-1244872458","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4175","id":1244872458,"node_id":"IC_kwDOAAMmUc5KMz8K","user":{"login":"diachedelic","id":310464,"node_id":"MDQ6VXNlcjMxMDQ2NA==","avatar_url":"https://avatars.githubusercontent.com/u/310464?v=4","gravatar_id":"","url":"https://api.github.com/users/diachedelic","html_url":"https://github.com/diachedelic","followers_url":"https://api.github.com/users/diachedelic/followers","following_url":"https://api.github.com/users/diachedelic/following{/other_user}","gists_url":"https://api.github.com/users/diachedelic/gists{/gist_id}","starred_url":"https://api.github.com/users/diachedelic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/diachedelic/subscriptions","organizations_url":"https://api.github.com/users/diachedelic/orgs","repos_url":"https://api.github.com/users/diachedelic/repos","events_url":"https://api.github.com/users/diachedelic/events{/privacy}","received_events_url":"https://api.github.com/users/diachedelic/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-13T04:09:57Z","updated_at":"2022-09-13T04:09:57Z","author_association":"NONE","body":"I was not using custom reducers, but the error certainly occurred more often when I used `let` instead of `var`. Perhaps that was just because `let` made SpiderMonkey work harder.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1244872458/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1244875316","html_url":"https://github.com/apache/couchdb/issues/4175#issuecomment-1244875316","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4175","id":1244875316,"node_id":"IC_kwDOAAMmUc5KM0o0","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-13T04:15:24Z","updated_at":"2022-09-13T04:15:24Z","author_association":"CONTRIBUTOR","body":"That could be, it's hard to saw without more details metrics. That parser/emitter piece of code might have to work harder some newer code constructs like `let`.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1244875316/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1244958916","html_url":"https://github.com/apache/couchdb/issues/4175#issuecomment-1244958916","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4175","id":1244958916,"node_id":"IC_kwDOAAMmUc5KNJDE","user":{"login":"diachedelic","id":310464,"node_id":"MDQ6VXNlcjMxMDQ2NA==","avatar_url":"https://avatars.githubusercontent.com/u/310464?v=4","gravatar_id":"","url":"https://api.github.com/users/diachedelic","html_url":"https://github.com/diachedelic","followers_url":"https://api.github.com/users/diachedelic/followers","following_url":"https://api.github.com/users/diachedelic/following{/other_user}","gists_url":"https://api.github.com/users/diachedelic/gists{/gist_id}","starred_url":"https://api.github.com/users/diachedelic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/diachedelic/subscriptions","organizations_url":"https://api.github.com/users/diachedelic/orgs","repos_url":"https://api.github.com/users/diachedelic/repos","events_url":"https://api.github.com/users/diachedelic/events{/privacy}","received_events_url":"https://api.github.com/users/diachedelic/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-13T06:29:50Z","updated_at":"2022-09-13T06:29:50Z","author_association":"NONE","body":"Is there a way to profile CouchDB's execution of JavaScript? It would be interesting to know where the bottleneck is.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1244958916/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1244966200","html_url":"https://github.com/apache/couchdb/issues/4175#issuecomment-1244966200","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4175","id":1244966200,"node_id":"IC_kwDOAAMmUc5KNK04","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-13T06:39:14Z","updated_at":"2022-09-13T06:39:14Z","author_association":"CONTRIBUTOR","body":"couchjs processes are run as a pool so it maybe possible to compare the CPU usage of those couchjs processes before and after. \r\n\r\nOr run a benchmark building a view on both setups and see which takes longer.\r\n\r\nWith the 2.x/3.x versions, setting the Q sharding factor could help parallelize view builds, so with Q=16 if you have a large database, all 16 shard ranges (and 3 copies if you have a 3 node cluster) will build in parallel.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1244966200/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1245002055","html_url":"https://github.com/apache/couchdb/issues/4175#issuecomment-1245002055","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4175","id":1245002055,"node_id":"IC_kwDOAAMmUc5KNTlH","user":{"login":"diachedelic","id":310464,"node_id":"MDQ6VXNlcjMxMDQ2NA==","avatar_url":"https://avatars.githubusercontent.com/u/310464?v=4","gravatar_id":"","url":"https://api.github.com/users/diachedelic","html_url":"https://github.com/diachedelic","followers_url":"https://api.github.com/users/diachedelic/followers","following_url":"https://api.github.com/users/diachedelic/following{/other_user}","gists_url":"https://api.github.com/users/diachedelic/gists{/gist_id}","starred_url":"https://api.github.com/users/diachedelic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/diachedelic/subscriptions","organizations_url":"https://api.github.com/users/diachedelic/orgs","repos_url":"https://api.github.com/users/diachedelic/repos","events_url":"https://api.github.com/users/diachedelic/events{/privacy}","received_events_url":"https://api.github.com/users/diachedelic/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-13T07:19:54Z","updated_at":"2022-09-13T07:19:54Z","author_association":"NONE","body":"Thanks, that's good to know. If I run into unavoidable performance problems I will give it a shot.\r\n\r\nSomething else I would like to know is why the view functions need to be transpiled for newer SpiderMonkeys, but not for 1.8.5. Is there a discussion anywhere I can read more about this?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1245002055/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1245015487","html_url":"https://github.com/apache/couchdb/issues/4175#issuecomment-1245015487","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4175","id":1245015487,"node_id":"IC_kwDOAAMmUc5KNW2_","user":{"login":"diachedelic","id":310464,"node_id":"MDQ6VXNlcjMxMDQ2NA==","avatar_url":"https://avatars.githubusercontent.com/u/310464?v=4","gravatar_id":"","url":"https://api.github.com/users/diachedelic","html_url":"https://github.com/diachedelic","followers_url":"https://api.github.com/users/diachedelic/followers","following_url":"https://api.github.com/users/diachedelic/following{/other_user}","gists_url":"https://api.github.com/users/diachedelic/gists{/gist_id}","starred_url":"https://api.github.com/users/diachedelic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/diachedelic/subscriptions","organizations_url":"https://api.github.com/users/diachedelic/orgs","repos_url":"https://api.github.com/users/diachedelic/repos","events_url":"https://api.github.com/users/diachedelic/events{/privacy}","received_events_url":"https://api.github.com/users/diachedelic/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-13T07:33:34Z","updated_at":"2022-09-13T07:33:34Z","author_association":"NONE","body":"Oh, I found #2345, the PR for upgrading to SpiderMonkey 60 from 1.8.5. Something I still don't understand is why a view function like `function(doc) { ... }` ceased to be valid. It's just a function expression, why would that stop working with a newer version of SpiderMonkey? There is mention of a \"new style\" of view function, like `(function(doc) { ... });` but that makes even less sense to me, because it is an expression statement which does nothing.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1245015487/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1245017685","html_url":"https://github.com/apache/couchdb/issues/4175#issuecomment-1245017685","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4175","id":1245017685,"node_id":"IC_kwDOAAMmUc5KNXZV","user":{"login":"diachedelic","id":310464,"node_id":"MDQ6VXNlcjMxMDQ2NA==","avatar_url":"https://avatars.githubusercontent.com/u/310464?v=4","gravatar_id":"","url":"https://api.github.com/users/diachedelic","html_url":"https://github.com/diachedelic","followers_url":"https://api.github.com/users/diachedelic/followers","following_url":"https://api.github.com/users/diachedelic/following{/other_user}","gists_url":"https://api.github.com/users/diachedelic/gists{/gist_id}","starred_url":"https://api.github.com/users/diachedelic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/diachedelic/subscriptions","organizations_url":"https://api.github.com/users/diachedelic/orgs","repos_url":"https://api.github.com/users/diachedelic/repos","events_url":"https://api.github.com/users/diachedelic/events{/privacy}","received_events_url":"https://api.github.com/users/diachedelic/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-13T07:35:56Z","updated_at":"2022-09-13T07:35:56Z","author_association":"NONE","body":"Oh, I found https://issues.apache.org/jira/browse/COUCHDB-1643.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1245017685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1245024910","html_url":"https://github.com/apache/couchdb/issues/2762#issuecomment-1245024910","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2762","id":1245024910,"node_id":"IC_kwDOAAMmUc5KNZKO","user":{"login":"diachedelic","id":310464,"node_id":"MDQ6VXNlcjMxMDQ2NA==","avatar_url":"https://avatars.githubusercontent.com/u/310464?v=4","gravatar_id":"","url":"https://api.github.com/users/diachedelic","html_url":"https://github.com/diachedelic","followers_url":"https://api.github.com/users/diachedelic/followers","following_url":"https://api.github.com/users/diachedelic/following{/other_user}","gists_url":"https://api.github.com/users/diachedelic/gists{/gist_id}","starred_url":"https://api.github.com/users/diachedelic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/diachedelic/subscriptions","organizations_url":"https://api.github.com/users/diachedelic/orgs","repos_url":"https://api.github.com/users/diachedelic/repos","events_url":"https://api.github.com/users/diachedelic/events{/privacy}","received_events_url":"https://api.github.com/users/diachedelic/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-13T07:43:33Z","updated_at":"2022-09-13T07:43:33Z","author_association":"NONE","body":"To interrogate CouchDB's JavaScript support, you can just use the Dev Tools REPL in Firefox vN, where N is the version of SpiderMonkey bundled with CouchDB (available via `GET /_node/_local/_versions`).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1245024910/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1249524421","html_url":"https://github.com/apache/couchdb/pull/4179#issuecomment-1249524421","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4179","id":1249524421,"node_id":"IC_kwDOAAMmUc5KejrF","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-16T15:48:06Z","updated_at":"2022-09-16T15:48:06Z","author_association":"CONTRIBUTOR","body":"Log before the PR\r\n```\r\nGET /db1/_changes?feed=normal&style=all_docs&since=%221-g1AAAABzeJzLYWBgYMpgTmHgz8tPSTV0MDQy1zMAQsMckEQiQ1L9____sxIZcCrJYwGSDA1A6j9IZQZzImMuUIDdPDXZ0sAiBVNXFgCBIx1h%22&timeout=10000 200 ok 2\r\n```\r\n\r\nWith the PR\r\n```\r\nGET /db1/_changes?feed=normal&style=all_docs&since=2-g1AAAACTeJzLYWBgYMpgTmHgz8tPSTV0MDQy1zMAQsMckEQiQ1L9____szKYExlzgQLsJqmWKQaW5pjKcRqRxwIkGRqA1H8Uk8xTky0NLFIwdWUBAEyYJFY&timeout=10000 200 ok 2\r\n```\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1249524421/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1250750982","html_url":"https://github.com/apache/couchdb/issues/4180#issuecomment-1250750982","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4180","id":1250750982,"node_id":"IC_kwDOAAMmUc5KjPIG","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-19T09:00:56Z","updated_at":"2022-09-19T09:00:56Z","author_association":"CONTRIBUTOR","body":"Hey @aalegriadg, thanks for reporting. \r\n\r\nIt may take time to support purging against partition/database inside CouchDB if it is an agreed approach in the community. \r\n\r\nIs it possible to use script to get document list from partition/database and then purge them one by one as one quick way?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1250750982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1250895707","html_url":"https://github.com/apache/couchdb/issues/4180#issuecomment-1250895707","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4180","id":1250895707,"node_id":"IC_kwDOAAMmUc5Kjydb","user":{"login":"aalegriadg","id":113889222,"node_id":"U_kgDOBsnPxg","avatar_url":"https://avatars.githubusercontent.com/u/113889222?v=4","gravatar_id":"","url":"https://api.github.com/users/aalegriadg","html_url":"https://github.com/aalegriadg","followers_url":"https://api.github.com/users/aalegriadg/followers","following_url":"https://api.github.com/users/aalegriadg/following{/other_user}","gists_url":"https://api.github.com/users/aalegriadg/gists{/gist_id}","starred_url":"https://api.github.com/users/aalegriadg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aalegriadg/subscriptions","organizations_url":"https://api.github.com/users/aalegriadg/orgs","repos_url":"https://api.github.com/users/aalegriadg/repos","events_url":"https://api.github.com/users/aalegriadg/events{/privacy}","received_events_url":"https://api.github.com/users/aalegriadg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-19T11:28:29Z","updated_at":"2022-09-19T11:28:29Z","author_association":"NONE","body":"Hi! \r\n\r\nThank you for your reply\r\n\r\nBased on your comment, I have modified the description,adding the benefits that this new query could bring.   \r\n\r\nAs you can see, this functionality would be very useful for my team and we would be very willing to contribute to it. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1250895707/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1251872241","html_url":"https://github.com/apache/couchdb/pull/4182#issuecomment-1251872241","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4182","id":1251872241,"node_id":"IC_kwDOAAMmUc5Kng3x","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-20T05:51:56Z","updated_at":"2022-09-20T05:51:56Z","author_association":"CONTRIBUTOR","body":"To also test manually can start a 3 node cluster. Then in remsh disconnect the nodes ex. `net_kernel:disconnect('node2@127.0.0.1').`. Then `nodes()` should not contain the disconnected nodes. Might have do this a few times or disconnect more nodes. Then after a less than a minute nodes should start reconnecting to each and this log message should appear on **one** of the nodes:\r\n\r\n```\r\n[warning] node3@127.0.0.1 <0.397.0> -------- mem3_distribution : reconnected to node2@127.0.0.1\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1251872241/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1253144478","html_url":"https://github.com/apache/couchdb/issues/4181#issuecomment-1253144478","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4181","id":1253144478,"node_id":"IC_kwDOAAMmUc5KsXee","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-21T02:57:21Z","updated_at":"2022-09-21T02:57:21Z","author_association":"CONTRIBUTOR","body":"See some documentation about https://docs.couchdb.org/en/stable/cluster/purging.html#config-settings\r\n\r\nWonder if your  `index_lag_warn_seconds = 86400` setting was altered from the default?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1253144478/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1253290644","html_url":"https://github.com/apache/couchdb/issues/4181#issuecomment-1253290644","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4181","id":1253290644,"node_id":"IC_kwDOAAMmUc5Ks7KU","user":{"login":"aalegriadg","id":113889222,"node_id":"U_kgDOBsnPxg","avatar_url":"https://avatars.githubusercontent.com/u/113889222?v=4","gravatar_id":"","url":"https://api.github.com/users/aalegriadg","html_url":"https://github.com/aalegriadg","followers_url":"https://api.github.com/users/aalegriadg/followers","following_url":"https://api.github.com/users/aalegriadg/following{/other_user}","gists_url":"https://api.github.com/users/aalegriadg/gists{/gist_id}","starred_url":"https://api.github.com/users/aalegriadg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aalegriadg/subscriptions","organizations_url":"https://api.github.com/users/aalegriadg/orgs","repos_url":"https://api.github.com/users/aalegriadg/repos","events_url":"https://api.github.com/users/aalegriadg/events{/privacy}","received_events_url":"https://api.github.com/users/aalegriadg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-21T07:03:54Z","updated_at":"2022-09-21T08:20:59Z","author_association":"NONE","body":"Thank you for the reply,\r\n\r\nNo, the configuration is the default one: `index_lag_warn_seconds = 86400`\r\n\r\nHowever, unlike described in the documentation, the seconds in my logs are not 86400. In my example logs appears \"not update in 59 seconds\" but testing I have seen other values like: 1335, 1237, 126, 9 seconds ...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1253290644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1253944315","html_url":"https://github.com/apache/couchdb/issues/4181#issuecomment-1253944315","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4181","id":1253944315,"node_id":"IC_kwDOAAMmUc5Kvav7","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-21T16:26:30Z","updated_at":"2022-09-21T16:26:30Z","author_association":"CONTRIBUTOR","body":"@aalegriadg You're right, thanks for checking. It looks like it's a bug in the logging bit. It logs how much over the threshold it is, and not the threshold limit itself as the message implied:\r\n\r\nhttps://github.com/apache/couchdb/blob/96214780e891b173f1f8049d50206fcb097c26a5/src/couch/src/couch_db.erl#L525-L529\r\n\r\nIt does look like a warning only, and indicates that the views have not been updated (yet?) after the documents have been purged from the main db. Try to query the views (which forces an update) or perhaps adjust the auto-indexer, [ken](https://docs.couchdb.org/en/stable/config/indexbuilds.html) settings.\r\n\r\nWhat I suspect might be happening is that we don't have have a decent auto-indexer trigger based on purged only. Only on document updates.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1253944315/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1254141992","html_url":"https://github.com/apache/couchdb/issues/4183#issuecomment-1254141992","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4183","id":1254141992,"node_id":"IC_kwDOAAMmUc5KwLAo","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-21T19:34:56Z","updated_at":"2022-09-21T19:34:56Z","author_association":"CONTRIBUTOR","body":"For instance, here is a snippet of logs from running a basic benchmark with couchdyno:\r\n\r\n```\r\nPOST /cdyno-0000001/_bulk_get?latest=true&revs=true&attachments=false 200 ok 420\r\nPOST /cdyno-0000002/_bulk_docs 201 ok 122\r\nPOST /cdyno-0000001/_bulk_get?latest=true&revs=true&attachments=false 200 ok 429\r\nPOST /cdyno-0000002/_bulk_docs 201 ok 126\r\nPOST /cdyno-0000001/_bulk_get?latest=true&revs=true&attachments=false 200 ok 419\r\nPOST /cdyno-0000002/_bulk_docs 201 ok 124\r\nPOST /cdyno-0000002/_bulk_docs 201 ok 130\r\nPOST /cdyno-0000001/_bulk_get?latest=true&revs=true&attachments=false 200 ok 387\r\nPOST /cdyno-0000001/_bulk_get?latest=true&revs=true&attachments=false 200 ok 375\r\nPOST /cdyno-0000002/_bulk_docs 201 ok 137\r\n```\r\n\r\nThe numbers at the end are the milliseconds it took to process the request. It looks like the `_bulk_get` (read) requests are almost 2x-3x as expensive as a `_bulk_docs` (write) requests. So it seems there is room for some optimization there.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1254141992/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1254261378","html_url":"https://github.com/apache/couchdb/pull/4170#issuecomment-1254261378","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4170","id":1254261378,"node_id":"IC_kwDOAAMmUc5KwoKC","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-21T21:47:29Z","updated_at":"2022-09-21T21:47:29Z","author_association":"CONTRIBUTOR","body":"@big-r81 should we merge this?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1254261378/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1254303140","html_url":"https://github.com/apache/couchdb/pull/4170#issuecomment-1254303140","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4170","id":1254303140,"node_id":"IC_kwDOAAMmUc5KwyWk","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-21T22:35:23Z","updated_at":"2022-09-21T22:35:23Z","author_association":"CONTRIBUTOR","body":"@nickva \r\nOf course, can you check why the CI is failing? Am on vacation…","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1254303140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1254426285","html_url":"https://github.com/apache/couchdb/pull/4170#issuecomment-1254426285","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4170","id":1254426285,"node_id":"IC_kwDOAAMmUc5KxQat","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-22T02:14:29Z","updated_at":"2022-09-22T02:15:02Z","author_association":"CONTRIBUTOR","body":"@big-r81 ah no worries, enjoy your vacation.\r\n\r\nThe issue is the json document is not regular json and the latest sphinx does check that\r\n\r\nIt doesn't like this part:\r\n```\r\n                    \"sha256\",\r\n                    ...\r\n                ]\r\n```\r\n\r\nI'll fix it and merge it. Thanks for making the docs PR!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1254426285/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1255755566","html_url":"https://github.com/apache/couchdb/issues/4127#issuecomment-1255755566","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4127","id":1255755566,"node_id":"IC_kwDOAAMmUc5K2U8u","user":{"login":"ryuusama09","id":80237556,"node_id":"MDQ6VXNlcjgwMjM3NTU2","avatar_url":"https://avatars.githubusercontent.com/u/80237556?v=4","gravatar_id":"","url":"https://api.github.com/users/ryuusama09","html_url":"https://github.com/ryuusama09","followers_url":"https://api.github.com/users/ryuusama09/followers","following_url":"https://api.github.com/users/ryuusama09/following{/other_user}","gists_url":"https://api.github.com/users/ryuusama09/gists{/gist_id}","starred_url":"https://api.github.com/users/ryuusama09/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ryuusama09/subscriptions","organizations_url":"https://api.github.com/users/ryuusama09/orgs","repos_url":"https://api.github.com/users/ryuusama09/repos","events_url":"https://api.github.com/users/ryuusama09/events{/privacy}","received_events_url":"https://api.github.com/users/ryuusama09/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-23T03:09:15Z","updated_at":"2022-09-23T03:09:15Z","author_association":"NONE","body":"hi @nickva , I would like to work on this issue if it is still open","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1255755566/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1255830986","html_url":"https://github.com/apache/couchdb/issues/4127#issuecomment-1255830986","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4127","id":1255830986,"node_id":"IC_kwDOAAMmUc5K2nXK","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-23T06:08:21Z","updated_at":"2022-09-23T06:08:21Z","author_association":"CONTRIBUTOR","body":"@ryuusama09 thanks for wanting to take a look!\r\n\r\nThe main task would be to go through the replication (and possibly other docs) in the `src/docs` folder and see if there are any tutorial URL links without a username and password, and update them to have a user name and password like `adm:pass`,  `admin:password` or similar.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1255830986/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1257589551","html_url":"https://github.com/apache/couchdb/issues/4181#issuecomment-1257589551","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4181","id":1257589551,"node_id":"IC_kwDOAAMmUc5K9Usv","user":{"login":"aalegriadg","id":113889222,"node_id":"U_kgDOBsnPxg","avatar_url":"https://avatars.githubusercontent.com/u/113889222?v=4","gravatar_id":"","url":"https://api.github.com/users/aalegriadg","html_url":"https://github.com/aalegriadg","followers_url":"https://api.github.com/users/aalegriadg/followers","following_url":"https://api.github.com/users/aalegriadg/following{/other_user}","gists_url":"https://api.github.com/users/aalegriadg/gists{/gist_id}","starred_url":"https://api.github.com/users/aalegriadg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aalegriadg/subscriptions","organizations_url":"https://api.github.com/users/aalegriadg/orgs","repos_url":"https://api.github.com/users/aalegriadg/repos","events_url":"https://api.github.com/users/aalegriadg/events{/privacy}","received_events_url":"https://api.github.com/users/aalegriadg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-26T07:22:21Z","updated_at":"2022-09-26T07:22:21Z","author_association":"NONE","body":"Thank you for your answer, it is very useful for my team.\r\n\r\n> You're right, thanks for checking. It looks like it's a bug in the logging bit. It logs how much over the threshold it is, and not the threshold limit itself as the message implied:\r\n\r\nAs it is a bug, this log should only appear if the purge takes more than 1 day (86400 seconds), which is not going to happen. So, do I stop worrying about these warnings?\r\n\r\n> It does look like a warning only, and indicates that the views have not been updated (yet?) after the documents have been purged from the main db. Try to query the views (which forces an update) or perhaps adjust the auto-indexer, ken settings.\r\n\r\nAs it is a partitioned database, the reindexing only affects the documents belonging to the queried partition right? i.e. if I purge partition1 the query time of partition2 should not be affected. I ask this because in my project we work with temporary replication windows: Documents are stored by daily partitions and when they are considered old enough they are not replicated and furthermore, they are purged. The query is for the partition with recent documents (those of the current day), not the purged ones. By the way I also opened [this issue ](https://github.com/apache/couchdb/issues/4180)about purging.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1257589551/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1257675779","html_url":"https://github.com/apache/couchdb/issues/4180#issuecomment-1257675779","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4180","id":1257675779,"node_id":"IC_kwDOAAMmUc5K9pwD","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-26T08:25:36Z","updated_at":"2022-09-26T08:25:36Z","author_association":"CONTRIBUTOR","body":"@aalegriadg thanks for feedback and contribution. Want to check you or your team will make PR or let us work together for that?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1257675779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1259107694","html_url":"https://github.com/apache/couchdb/issues/4180#issuecomment-1259107694","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4180","id":1259107694,"node_id":"IC_kwDOAAMmUc5LDHVu","user":{"login":"aalegriadg","id":113889222,"node_id":"U_kgDOBsnPxg","avatar_url":"https://avatars.githubusercontent.com/u/113889222?v=4","gravatar_id":"","url":"https://api.github.com/users/aalegriadg","html_url":"https://github.com/aalegriadg","followers_url":"https://api.github.com/users/aalegriadg/followers","following_url":"https://api.github.com/users/aalegriadg/following{/other_user}","gists_url":"https://api.github.com/users/aalegriadg/gists{/gist_id}","starred_url":"https://api.github.com/users/aalegriadg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aalegriadg/subscriptions","organizations_url":"https://api.github.com/users/aalegriadg/orgs","repos_url":"https://api.github.com/users/aalegriadg/repos","events_url":"https://api.github.com/users/aalegriadg/events{/privacy}","received_events_url":"https://api.github.com/users/aalegriadg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-27T07:37:54Z","updated_at":"2022-09-27T07:37:54Z","author_association":"NONE","body":"We do not have in the team people with experience in Erlang, but we could fund the feature, trying to accelerate it, because we are very interested in it.\r\n\r\nWe would also be interested in a function that returns the existing partitions in the database, of the type `get_all_partitions`","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1259107694/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1261879709","html_url":"https://github.com/apache/couchdb/issues/2858#issuecomment-1261879709","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2858","id":1261879709,"node_id":"IC_kwDOAAMmUc5LNsGd","user":{"login":"SankhaJay","id":43034616,"node_id":"MDQ6VXNlcjQzMDM0NjE2","avatar_url":"https://avatars.githubusercontent.com/u/43034616?v=4","gravatar_id":"","url":"https://api.github.com/users/SankhaJay","html_url":"https://github.com/SankhaJay","followers_url":"https://api.github.com/users/SankhaJay/followers","following_url":"https://api.github.com/users/SankhaJay/following{/other_user}","gists_url":"https://api.github.com/users/SankhaJay/gists{/gist_id}","starred_url":"https://api.github.com/users/SankhaJay/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SankhaJay/subscriptions","organizations_url":"https://api.github.com/users/SankhaJay/orgs","repos_url":"https://api.github.com/users/SankhaJay/repos","events_url":"https://api.github.com/users/SankhaJay/events{/privacy}","received_events_url":"https://api.github.com/users/SankhaJay/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-29T07:30:23Z","updated_at":"2022-09-29T07:30:23Z","author_association":"NONE","body":"as mentioned in this forum we can use sessions rather than basic authentication to overcome this issue\r\nhttps://stackoverflow.com/a/65959268/10350938","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1261879709/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1262537477","html_url":"https://github.com/apache/couchdb/issues/4192#issuecomment-1262537477","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4192","id":1262537477,"node_id":"IC_kwDOAAMmUc5LQMsF","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-09-29T16:44:23Z","updated_at":"2022-09-29T16:44:23Z","author_association":"CONTRIBUTOR","body":"Hi,\r\n\r\n`photon` is a third-party project. Please ask [here](https://github.com/ermouth/couch-photon) for help.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1262537477/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1265677839","html_url":"https://github.com/apache/couchdb/issues/4195#issuecomment-1265677839","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4195","id":1265677839,"node_id":"IC_kwDOAAMmUc5LcLYP","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-03T15:56:47Z","updated_at":"2022-10-03T15:56:47Z","author_association":"CONTRIBUTOR","body":"It's probably because the view shard is processing the purge requests and has to catch up. Processing a lot of purge requests is about same as the making a lot of db updates and waiting for the view to catch up. \r\n\r\nPartition could be located on the same shard as the other partitions and views are built per-shard. So, if the shard hasn't caught up yet, it will block clients waiting the latest updates from the partitions on that shard. One way to handle it could be to [split he shard range](https://docs.couchdb.org/en/3.2.2-docs/cluster/sharding.html#splitting-shards) to hopefully isolate the partition to just one shard.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1265677839/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1266777621","html_url":"https://github.com/apache/couchdb/issues/2867#issuecomment-1266777621","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2867","id":1266777621,"node_id":"IC_kwDOAAMmUc5LgX4V","user":{"login":"mikeymckay","id":12015,"node_id":"MDQ6VXNlcjEyMDE1","avatar_url":"https://avatars.githubusercontent.com/u/12015?v=4","gravatar_id":"","url":"https://api.github.com/users/mikeymckay","html_url":"https://github.com/mikeymckay","followers_url":"https://api.github.com/users/mikeymckay/followers","following_url":"https://api.github.com/users/mikeymckay/following{/other_user}","gists_url":"https://api.github.com/users/mikeymckay/gists{/gist_id}","starred_url":"https://api.github.com/users/mikeymckay/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikeymckay/subscriptions","organizations_url":"https://api.github.com/users/mikeymckay/orgs","repos_url":"https://api.github.com/users/mikeymckay/repos","events_url":"https://api.github.com/users/mikeymckay/events{/privacy}","received_events_url":"https://api.github.com/users/mikeymckay/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-04T11:03:40Z","updated_at":"2022-10-04T11:03:40Z","author_association":"CONTRIBUTOR","body":"I'm seeing this same result, but a different output in the logfile. I have libffi7, and there is no libffi error. \r\n\r\nThis is from the bitnami couchdb aws package which seems to be:\r\n Debian\r\n Couchdb 3.2.2.\r\nErlang: System version: Erlang/OTP 24 [erts-12.3.2] [source] [64-bit] [smp:2:2] [ds:2:2:10] [async-threads:1] [jit]\r\n\r\n\r\nThe error in the logfile is:\r\n\r\n`[error] 2022-10-04T10:38:22.681658Z couchdb@127.0.0.1 <0.22734.281> -------- OS Process Error <0.22722.281> :: {os_process_error,{exit_status,139}}\r\n[error] 2022-10-04T10:38:27.648770Z couchdb@127.0.0.1 <0.22774.281> -------- rexi_server: from: couchdb@127.0.0.1(<0.22951.281>) mfa: fabric_rpc:update_docs/3 exit:{timeout,{gen_server,call,[couch_proc_manager,{get_proc,{doc,<<\"_design/_auth\">>,{1,[<<117,58,224,21,122,139,26,34,51,159,60,14,244,241,191,25>>]},{[{<<\"language\">>,<<\"javascript\">>},{<<\"validate_doc_update\">>,<<\"\\n    function(newDoc, oldDoc, userCtx, secObj) {\\n        if (newDoc._deleted === true) {\\n            // allow deletes by admins and matching users\\n            // without checking the other fields\\n            if ((userCtx.roles.indexOf('_admin') !== -1) ||\\n                (userCtx.name == oldDoc.name)) {\\n                return;\\n            } else {\\n                throw({forbidden: 'Only admins may delete other user docs.'});\\n            }\\n        }\\n\\n        if (newDoc.type !== 'user') {\\n            throw({forbidden : 'doc.type must be user'});\\n        } // we only allow user docs for now\\n\\n        if (!newDoc.name) {\\n            throw({forbidden: 'doc.name is required'});\\n        }\\n\\n        if (!newDoc.roles) {\\n            throw({forbidden: 'doc.roles must exist'});\\n        }\\n\\n        if (!isArray(newDoc.roles)) {\\n            throw({forbidden: 'doc.roles must be an array'});\\n        }\\n\\n        for (var idx = 0; idx < newDoc.roles.length; idx++) {\\n            if (typeof newDoc.roles[idx] !== 'string') {\\n                throw({forbidden: 'doc.roles can only contain strings'});\\n            }\\n        }\\n\\n        if (newDoc._id !== ('org.couchdb.user:' + newDoc.name)) {\\n            throw({\\n                forbidden: 'Doc ID must be of the form org.couchdb.user:name'\\n            });\\n        }\\n\\n        if (oldDoc) { // validate all updates\\n            if (oldDoc.name !== newDoc.name) {\\n                throw({forbidden: 'Usernames can not be changed.'});\\n            }\\n        }\\n\\n        if (newDoc.password_sha && !newDoc.salt) {\\n            throw({\\n                forbidden: 'Users with password_sha must have a salt.' +\\n                    'See /_utils/script/couch.js for example code.'\\n            });\\n        }\\n\\n        var available_schemes = [\\\"simple\\\", \\\"pbkdf2\\\", \\\"bcrypt\\\"];\\n        if (newDoc.password_scheme\\n                && available_schemes.indexOf(newDoc.password_scheme) == -1) {\\n            throw({\\n                forbidden: 'Password scheme `' + newDoc.password_scheme\\n                    + '` not supported.'\\n            });\\n        }\\n\\n        if (newDoc.password_scheme === \\\"pbkdf2\\\") {\\n            if (typeof(newDoc.iterations) !== \\\"number\\\") {\\n               throw({forbidden: \\\"iterations must be a number.\\\"});\\n            }\\n            if (typeof(newDoc.derived_key) !== \\\"string\\\") {\\n               throw({forbidden: \\\"derived_key must be a string.\\\"});\\n            }\\n        }\\n\\n        var is_server_or_database_admin = function(userCtx, secObj) {\\n            // see if the user is a server admin\\n            if(userCtx.roles.indexOf('_admin') !== -1) {\\n                return true; // a server admin\\n            }\\n\\n            // see if the user a database admin specified by name\\n            if(secObj && secObj.admins && secObj.admins.names) {\\n                if(secObj.admins.names.indexOf(userCtx.name) !== -1) {\\n                    return true; // database admin\\n                }\\n            }\\n\\n            // see if the user a database admin specified by role\\n            if(secObj && secObj.admins && secObj.admins.roles) {\\n                var db_roles = secObj.admins.roles;\\n                for(var idx = 0; idx < userCtx.roles.length; idx++) {\\n                    var user_role = userCtx.roles[idx];\\n                    if(db_roles.indexOf(user_role) !== -1) {\\n                        return true; // role matches!\\n                    }\\n                }\\n            }\\n\\n            return false; // default to no admin\\n        }\\n\\n        if (!is_server_or_database_admin(userCtx, secObj)) {\\n            if (oldDoc) { // validate non-admin updates\\n                if (userCtx.name !== newDoc.name) {\\n                    throw({\\n                        forbidden: 'You may only update your own user document.'\\n                    });\\n                }\\n                // validate role updates\\n                var oldRoles = (oldDoc.roles || []).sort();\\n                var newRoles = newDoc.roles.sort();\\n\\n                if (oldRoles.length !== newRoles.length) {\\n                    throw({forbidden: 'Only _admin may edit roles'});\\n                }\\n\\n                for (var i = 0; i < oldRoles.length; i++) {\\n                    if (oldRoles[i] !== newRoles[i]) {\\n                        throw({forbidden: 'Only _admin may edit roles'});\\n                    }\\n                }\\n            } else if (newDoc.roles.length > 0) {\\n                throw({forbidden: 'Only _admin may set roles'});\\n            }\\n        }\\n\\n        // no system roles in users db\\n        for (var i = 0; i < newDoc.roles.length; i++) {\\n            if (newDoc.roles[i] !== '_metrics') {\\n              if (newDoc.roles[i][0] === '_') {\\n                  throw({\\n                      forbidden:\\n                      'No system roles (starting with underscore) in users db.'\\n                  });\\n              }\\n            }\\n        }\\n\\n        // no system names as names\\n        if (newDoc.name[0] === '_') {\\n            throw({forbidden: 'Username may not start with underscore.'});\\n        }\\n\\n        var badUserNameChars = [':'];\\n\\n        for (var i = 0; i < badUserNameChars.length; i++) {\\n            if (newDoc.name.indexOf(badUserNameChars[i]) >= 0) {\\n                throw({forbidden: 'Character `' + badUserNameChars[i] +\\n                        '` is not allowed in usernames.'});\\n            }\\n        }\\n    }\\n\">>}]},[],false,[]},{<<\"_design/_auth\">>,<<\"1-753ae0157a8b1a22339f3c0ef4f1bf19\">>}},5000]}} [{gen_server,call,3,[{file,\"gen_server.erl\"},{line,247}]},{couch_query_servers,get_ddoc_process,2,[{file,\"src/couch_query_servers.erl\"},{line,630}]},{couch_query_servers,with_ddoc_proc,2,[{file,\"src/couch_query_servers.erl\"},{line,525}]},{couch_query_servers,validate_doc_update,5,[{file,\"src/couch_query_servers.erl\"},{line,368}]},{couch_db,'-validate_doc_update_int/3-lc$^0/1-0-',5,[{file,\"src/couch_db.erl\"},{line,914}]},{couch_db,'-validate_doc_update_int/3-fun-1-',3,[{file,\"src/couch_db.erl\"},{line,917}]},{couch_stats,update_histogram,2,[{file,\"src/couch_stats.erl\"},{line,102}]},{couch_db,'-prep_and_validate_updates/6-fun-1-',3,[{file,\"src/couch_db.erl\"},{line,1014}]}]\r\n196.207.167.189 admin PUT /_users/org.couchdb.user%3Ammckay`","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1266777621/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1269159277","html_url":"https://github.com/apache/couchdb/issues/4196#issuecomment-1269159277","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4196","id":1269159277,"node_id":"IC_kwDOAAMmUc5LpdVt","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-06T00:50:12Z","updated_at":"2022-10-06T00:50:12Z","author_association":"CONTRIBUTOR","body":"A q factor is 1024 is probably not practical. The default is 2 and I even it the larger clusters I don't recall seeing anything larger than 256.\r\n\r\nWhat are you trying to do?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1269159277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1269417483","html_url":"https://github.com/apache/couchdb/issues/4196#issuecomment-1269417483","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4196","id":1269417483,"node_id":"IC_kwDOAAMmUc5LqcYL","user":{"login":"ornotnull","id":115115560,"node_id":"U_kgDOBtyGKA","avatar_url":"https://avatars.githubusercontent.com/u/115115560?v=4","gravatar_id":"","url":"https://api.github.com/users/ornotnull","html_url":"https://github.com/ornotnull","followers_url":"https://api.github.com/users/ornotnull/followers","following_url":"https://api.github.com/users/ornotnull/following{/other_user}","gists_url":"https://api.github.com/users/ornotnull/gists{/gist_id}","starred_url":"https://api.github.com/users/ornotnull/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ornotnull/subscriptions","organizations_url":"https://api.github.com/users/ornotnull/orgs","repos_url":"https://api.github.com/users/ornotnull/repos","events_url":"https://api.github.com/users/ornotnull/events{/privacy}","received_events_url":"https://api.github.com/users/ornotnull/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-06T06:38:40Z","updated_at":"2022-10-06T06:38:40Z","author_association":"NONE","body":"OK. Now just testing the database of size about 10Tb\r\nand follow the recommendation to keep a shard within 10Gb\r\nhttps://neighbourhood.ie/blog/2020/09/22/sharding-choosing-the-right-q-value/\r\n\r\nSo the test database is q = 1024 and n = 2 but now only able to go with q = 256, n = 2\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1269417483/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1269527417","html_url":"https://github.com/apache/couchdb/issues/4196#issuecomment-1269527417","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4196","id":1269527417,"node_id":"IC_kwDOAAMmUc5Lq3N5","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-06T07:57:29Z","updated_at":"2022-10-06T07:58:56Z","author_association":"CONTRIBUTOR","body":"Hi,\r\n\r\nwhat @nickva says, but I can reproduce this.\r\n```\r\ncurl -X PUT http:/a:a@127.0.0.1:15984/qdb?q=1024\r\n{\"error\":\"ok\",\"reason\":\"ok\"}\r\n```\r\n See for more error messages: https://gist.github.com/big-r81/d244a22c36820c165ed63a105d6a092b","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1269527417/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1270133136","html_url":"https://github.com/apache/couchdb/issues/4196#issuecomment-1270133136","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4196","id":1270133136,"node_id":"IC_kwDOAAMmUc5LtLGQ","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-06T14:15:34Z","updated_at":"2022-10-06T14:15:34Z","author_association":"CONTRIBUTOR","body":"@ornotnull you can still go as high as 1022 or so (the highest limit is 1023 and there is a +1 so max q would be about 1022). But even with a 10TB I would stick with a smaller sharding factor.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1270133136/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1270169524","html_url":"https://github.com/apache/couchdb/issues/4196#issuecomment-1270169524","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4196","id":1270169524,"node_id":"IC_kwDOAAMmUc5LtT-0","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-06T14:35:16Z","updated_at":"2022-10-06T14:35:43Z","author_association":"CONTRIBUTOR","body":"@ornotnull thanks for reaching out and reporting the bug. Here is a PR that should fix it https://github.com/apache/couchdb/pull/4197","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1270169524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1271124784","html_url":"https://github.com/apache/couchdb/issues/4196#issuecomment-1271124784","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4196","id":1271124784,"node_id":"IC_kwDOAAMmUc5Lw9Mw","user":{"login":"ornotnull","id":115115560,"node_id":"U_kgDOBtyGKA","avatar_url":"https://avatars.githubusercontent.com/u/115115560?v=4","gravatar_id":"","url":"https://api.github.com/users/ornotnull","html_url":"https://github.com/ornotnull","followers_url":"https://api.github.com/users/ornotnull/followers","following_url":"https://api.github.com/users/ornotnull/following{/other_user}","gists_url":"https://api.github.com/users/ornotnull/gists{/gist_id}","starred_url":"https://api.github.com/users/ornotnull/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ornotnull/subscriptions","organizations_url":"https://api.github.com/users/ornotnull/orgs","repos_url":"https://api.github.com/users/ornotnull/repos","events_url":"https://api.github.com/users/ornotnull/events{/privacy}","received_events_url":"https://api.github.com/users/ornotnull/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-07T05:25:30Z","updated_at":"2022-10-07T05:25:30Z","author_association":"NONE","body":"@nickva, thank you a lot \r\nable to compile the new 3.2.2-228b07e version and no issue any more","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1271124784/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1272370331","html_url":"https://github.com/apache/couchdb/issues/3939#issuecomment-1272370331","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3939","id":1272370331,"node_id":"IC_kwDOAAMmUc5L1tSb","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-08T18:07:43Z","updated_at":"2022-10-08T18:07:43Z","author_association":"CONTRIBUTOR","body":"I think this issue is fixed. Closing.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1272370331/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1272370797","html_url":"https://github.com/apache/couchdb/issues/4066#issuecomment-1272370797","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4066","id":1272370797,"node_id":"IC_kwDOAAMmUc5L1tZt","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-08T18:10:01Z","updated_at":"2022-10-08T18:10:01Z","author_association":"CONTRIBUTOR","body":"Closing as there has been no activity in a while. Hopefully the suggested reply helped.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1272370797/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1273544831","html_url":"https://github.com/apache/couchdb/pull/1182#issuecomment-1273544831","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1182","id":1273544831,"node_id":"IC_kwDOAAMmUc5L6MB_","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-10T16:14:30Z","updated_at":"2022-10-10T16:14:30Z","author_association":"CONTRIBUTOR","body":"With Erlang 23+ we do have access to atomics so perhaps this could revived using that. That idea would be to keep an atomic ref in the couch_server `entry...` and then http://www.erlang.org/doc/man/atomics.html#compare_exchange-4 to handle the decref/incref locks and retries.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1273544831/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1273628141","html_url":"https://github.com/apache/couchdb/issues/4138#issuecomment-1273628141","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4138","id":1273628141,"node_id":"IC_kwDOAAMmUc5L6gXt","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-10T17:34:29Z","updated_at":"2022-10-10T17:34:29Z","author_association":"CONTRIBUTOR","body":"I think this issue is fixed. Closing.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1273628141/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1277738010","html_url":"https://github.com/apache/couchdb/issues/4207#issuecomment-1277738010","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4207","id":1277738010,"node_id":"IC_kwDOAAMmUc5MKLwa","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-13T14:49:04Z","updated_at":"2022-10-13T14:49:04Z","author_association":"CONTRIBUTOR","body":"`no_ring` means it cannot reach all the expect database shards at the same time, some of the nodes which are mentioned in the shard map are not connected.\r\n\r\nAlso `2.1.1` is quite a bit outdated, try upgrading to `3.2.1`.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1277738010/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1277752399","html_url":"https://github.com/apache/couchdb/issues/4204#issuecomment-1277752399","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4204","id":1277752399,"node_id":"IC_kwDOAAMmUc5MKPRP","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-13T14:59:07Z","updated_at":"2022-10-13T14:59:07Z","author_association":"CONTRIBUTOR","body":"`missing_doc` often means the document update which changes feed saw was not found when replicator went to fetch all of its revisions. It might happen if the document is deleted in the meantime (and compaction runs), or if the document was just created but somehow it wasn't propagated to the all the nodes in the cluster. \r\n\r\nThere is one retry which the replicator will do that case. You can adjust the sleep period with this setting `[replicator] missing_doc_retry_msec = 2000`. The defaults is 2 seconds but you could set to, say, 10000 (10 seconds). Then check that you have good inter-node (cluster) connectivity. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1277752399/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1277803202","html_url":"https://github.com/apache/couchdb/issues/4207#issuecomment-1277803202","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4207","id":1277803202,"node_id":"IC_kwDOAAMmUc5MKbrC","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-13T15:32:36Z","updated_at":"2022-10-13T15:32:36Z","author_association":"CONTRIBUTOR","body":"> Also `2.1.1` is quite a bit outdated, try upgrading to `3.2.1`.\r\n\r\nTo 3.2.2 please 😉\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1277803202/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1277820599","html_url":"https://github.com/apache/couchdb/issues/4207#issuecomment-1277820599","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4207","id":1277820599,"node_id":"IC_kwDOAAMmUc5MKf63","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-13T15:43:47Z","updated_at":"2022-10-13T15:43:47Z","author_association":"CONTRIBUTOR","body":"@big-r81 indeed, thanks for noticing","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1277820599/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1278411330","html_url":"https://github.com/apache/couchdb/issues/4207#issuecomment-1278411330","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4207","id":1278411330,"node_id":"IC_kwDOAAMmUc5MMwJC","user":{"login":"Manphil","id":22346883,"node_id":"MDQ6VXNlcjIyMzQ2ODgz","avatar_url":"https://avatars.githubusercontent.com/u/22346883?v=4","gravatar_id":"","url":"https://api.github.com/users/Manphil","html_url":"https://github.com/Manphil","followers_url":"https://api.github.com/users/Manphil/followers","following_url":"https://api.github.com/users/Manphil/following{/other_user}","gists_url":"https://api.github.com/users/Manphil/gists{/gist_id}","starred_url":"https://api.github.com/users/Manphil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manphil/subscriptions","organizations_url":"https://api.github.com/users/Manphil/orgs","repos_url":"https://api.github.com/users/Manphil/repos","events_url":"https://api.github.com/users/Manphil/events{/privacy}","received_events_url":"https://api.github.com/users/Manphil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-14T03:06:23Z","updated_at":"2022-10-14T03:06:23Z","author_association":"NONE","body":"> `no_ring` means it cannot reach all the expect database shards at the same time, some of the nodes which are mentioned in the shard map are not connected.\r\n\r\n@nickva Thanks for your reply! Is there any way to sovle this problem? The problem has occurred many times. Last time the problem occurred in another couchdb instance, i upgrade the couchdb to 3.2.2, but the problem still occurred. The method i used to recover was to delete the database and re-create a new one, then re-write all data into the new database, but this way takes lots of time to recover when the db size is large.\r\n\r\nI still have some doubts:\r\n> some of the nodes which are mentioned in the shard map\r\n\r\nDoes the `nodes` mean nodes in cluster enviroment? Acturally, the couchdb runs in docker container and is standalone.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1278411330/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1278422573","html_url":"https://github.com/apache/couchdb/issues/4207#issuecomment-1278422573","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4207","id":1278422573,"node_id":"IC_kwDOAAMmUc5MMy4t","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-14T03:18:51Z","updated_at":"2022-10-14T03:18:51Z","author_association":"CONTRIBUTOR","body":"If it's a multi-node cluster the nodes shown in the `_membership` in `all_nodes` (all currently connected) should match up with `cluster_nodes`, which are nodes which are expected to be present.  https://docs.couchdb.org/en/3.2.2-docs/cluster/nodes.html\r\n\r\nIn addition check your shard map to ensure the nodes mentioned there are nodes which are also connected to and there are not missing nodes or ranges. See https://docs.couchdb.org/en/3.2.2-docs/cluster/sharding.html for some example.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1278422573/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1278433974","html_url":"https://github.com/apache/couchdb/issues/4207#issuecomment-1278433974","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4207","id":1278433974,"node_id":"IC_kwDOAAMmUc5MM1q2","user":{"login":"Manphil","id":22346883,"node_id":"MDQ6VXNlcjIyMzQ2ODgz","avatar_url":"https://avatars.githubusercontent.com/u/22346883?v=4","gravatar_id":"","url":"https://api.github.com/users/Manphil","html_url":"https://github.com/Manphil","followers_url":"https://api.github.com/users/Manphil/followers","following_url":"https://api.github.com/users/Manphil/following{/other_user}","gists_url":"https://api.github.com/users/Manphil/gists{/gist_id}","starred_url":"https://api.github.com/users/Manphil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manphil/subscriptions","organizations_url":"https://api.github.com/users/Manphil/orgs","repos_url":"https://api.github.com/users/Manphil/repos","events_url":"https://api.github.com/users/Manphil/events{/privacy}","received_events_url":"https://api.github.com/users/Manphil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-14T03:34:24Z","updated_at":"2022-10-14T03:40:13Z","author_association":"NONE","body":"@nickva The couchdb is running in single node. I runs couchdb just like:\r\n```\r\ndocker run couchdb\r\n```\r\n\r\nAnd I query the db infomation, returned the response:\r\n```\r\n\"cluster\":{\"q\":8,\"n\":1,\"w\":1,\"r\":1}\r\n```\r\n\r\nAlso, `_membership` shows that:\r\n```\r\n{\"all_nodes\":[\"nonode@nohost\"],\"cluster_nodes\":[\"nonode@nohost\"]}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1278433974/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1278692387","html_url":"https://github.com/apache/couchdb/issues/4204#issuecomment-1278692387","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4204","id":1278692387,"node_id":"IC_kwDOAAMmUc5MN0wj","user":{"login":"arahjan","id":115629637,"node_id":"U_kgDOBuReRQ","avatar_url":"https://avatars.githubusercontent.com/u/115629637?v=4","gravatar_id":"","url":"https://api.github.com/users/arahjan","html_url":"https://github.com/arahjan","followers_url":"https://api.github.com/users/arahjan/followers","following_url":"https://api.github.com/users/arahjan/following{/other_user}","gists_url":"https://api.github.com/users/arahjan/gists{/gist_id}","starred_url":"https://api.github.com/users/arahjan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arahjan/subscriptions","organizations_url":"https://api.github.com/users/arahjan/orgs","repos_url":"https://api.github.com/users/arahjan/repos","events_url":"https://api.github.com/users/arahjan/events{/privacy}","received_events_url":"https://api.github.com/users/arahjan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-14T08:48:29Z","updated_at":"2022-10-14T08:48:29Z","author_association":"NONE","body":"I added this parameter, but it didn't help. \r\nI fetched the database from the MAIN server and restored it to SPARE. Unfortunately that didn't help too. Even though both servers have the same number of documents, the replication status is \"crashed\". \r\nThere is a info in crash details pointing to {couch_replicator_api_wrap.erl\"},{line,302}]} that stands \"NewMaxLen = get_value(max_url_len, Options, ?MAX_URL_LEN) div 2,\". Could max_url_len parameter somehow related then? What's the default value and is it possible to increase it? \r\nConnectivity between nodes is fine. As I said, just this particular database is problematic. \r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1278692387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1279154229","html_url":"https://github.com/apache/couchdb/issues/4207#issuecomment-1279154229","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4207","id":1279154229,"node_id":"IC_kwDOAAMmUc5MPlg1","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-14T15:27:15Z","updated_at":"2022-10-14T15:27:15Z","author_association":"CONTRIBUTOR","body":"@Manphil thanks for checking. \r\n\r\nSee if there are any errors in the logs or crashes in the logs at the time when the call is made. Looking at the source code https://github.com/apache/couchdb/blob/5a55796e7629a6aea717a5755da52e1e0df5eaed/src/fabric/src/fabric_db_meta.erl#L76-L92\r\n\r\nSpecifically log entries which that start with `Failed to set security object on`","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1279154229/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1279365281","html_url":"https://github.com/apache/couchdb/issues/4204#issuecomment-1279365281","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4204","id":1279365281,"node_id":"IC_kwDOAAMmUc5MQZCh","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-14T19:11:13Z","updated_at":"2022-10-14T19:11:13Z","author_association":"CONTRIBUTOR","body":"If you see `max_url_len` in the logs check if there are any 414 HTTP error response from the replication endpoints. It could be that the proxy limits the maximum URL length or `max_document_id_length` was set for couchdb was set too low.\r\n\r\nOne case where that could also apply is if there are lot of conflicted revisions, those would end passed to the fetch document request as `atts_since=....` list and if the response returned is 414 the replicator will try to use a shorter list of `atts_since=...` values.\r\n\r\nHere is where I found a reference to it:\r\n\r\nhttps://github.com/apache/couchdb/blob/21eebad0fb6ea62786d915b29797983be537908a/src/couch_replicator/src/couch_replicator_api_wrap.erl#L346-L363","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1279365281/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280192408","html_url":"https://github.com/apache/couchdb/issues/4207#issuecomment-1280192408","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4207","id":1280192408,"node_id":"IC_kwDOAAMmUc5MTi-Y","user":{"login":"Manphil","id":22346883,"node_id":"MDQ6VXNlcjIyMzQ2ODgz","avatar_url":"https://avatars.githubusercontent.com/u/22346883?v=4","gravatar_id":"","url":"https://api.github.com/users/Manphil","html_url":"https://github.com/Manphil","followers_url":"https://api.github.com/users/Manphil/followers","following_url":"https://api.github.com/users/Manphil/following{/other_user}","gists_url":"https://api.github.com/users/Manphil/gists{/gist_id}","starred_url":"https://api.github.com/users/Manphil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manphil/subscriptions","organizations_url":"https://api.github.com/users/Manphil/orgs","repos_url":"https://api.github.com/users/Manphil/repos","events_url":"https://api.github.com/users/Manphil/events{/privacy}","received_events_url":"https://api.github.com/users/Manphil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-17T02:32:36Z","updated_at":"2022-10-17T02:32:36Z","author_association":"NONE","body":"The couchdb logs show that:\r\n```\r\nrpc couch_db:set_security/2 badarg\r\nFailed to set security object on ... :: {error,badarg}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280192408/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280780947","html_url":"https://github.com/apache/couchdb/issues/4204#issuecomment-1280780947","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4204","id":1280780947,"node_id":"IC_kwDOAAMmUc5MVyqT","user":{"login":"arahjan","id":115629637,"node_id":"U_kgDOBuReRQ","avatar_url":"https://avatars.githubusercontent.com/u/115629637?v=4","gravatar_id":"","url":"https://api.github.com/users/arahjan","html_url":"https://github.com/arahjan","followers_url":"https://api.github.com/users/arahjan/followers","following_url":"https://api.github.com/users/arahjan/following{/other_user}","gists_url":"https://api.github.com/users/arahjan/gists{/gist_id}","starred_url":"https://api.github.com/users/arahjan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arahjan/subscriptions","organizations_url":"https://api.github.com/users/arahjan/orgs","repos_url":"https://api.github.com/users/arahjan/repos","events_url":"https://api.github.com/users/arahjan/events{/privacy}","received_events_url":"https://api.github.com/users/arahjan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-17T12:28:46Z","updated_at":"2022-10-17T13:45:38Z","author_association":"NONE","body":"After some drilling down and increasing logging level I managed to find some errors related to missing revision numbers:\r\n\r\n`61374  [error] 2022-10-17T11:54:12.491238Z couchdb@127.0.0.1 <0.31178.16> -------- Retrying fetch and update of document ABC as it is unexpectedly missing. **Missing revisions** are: 9-6ab086bc66baa1fffe312b90654d90e5\r\n\r\n 61419  [debug] 2022-10-17T11:54:32.173657Z couchdb@127.0.0.1 <0.217.0> -------- New task status for <0.20065.16>: [{changes_pending,null},{checkpoint_interval,30000},{checkpointed_source_seq,0},{continuous,true},{database,<<\"shards/40000000-5fffffff/_replicator.1665052660\">>},{doc_id,<<\"ngraph\">>},{doc_write_failures,0},{docs_read,92279},{docs_written,92279},{**missing_revisions_found**,92279},{replication_id,<<\"58c7cfcc0f22e9d73693b78ec745e04d+continuous\">>},{revisions_checked,406477},{source,<<\"http://admin:xxx@x.x.x.x/cdb2/test/\">>},{source_seq,<<\"79173-g1AAAAJ7eJzLYWBg4MhgTmEQTM4vTc5ISXIwNDLXMwBCwxygFFMiQ5L8____szKYkxgY1HbkAsXYk41NzUwtE7HpwWNSkgKQTLJHGDYJbJhZkmWqqWUyqYY5gAyLRxi2HGyYcbKpUYoByS5LABlWjzCsGmxYooV5oomJKYmG5bEASYYGIAU0bz7UwHawgYaGxoYGluZkGbgAYuB-qIH7wQYaGJlYpqUkkWXgAYiB96EGHgIbmGpqaJqYaEmWgQ8gBsLC8CLEQAMzCwszC2xaswBFLKSv\">>},{started_on,1666007643},{target,<<\"http://admin:xxx@x.x.x.y/cdb2/test/\">>},{through_seq,<<\"78031-g1AAAAJ7eJzLYWBg4MhgTmEQTM4vTc5ISXIwNDLXMwBCwxygFFMiQ5L8____szKYkxgY1HRygWLsycamZqaWidj04DEpSQFIJtkjDGMDG2aWZJlqaplMqmEOIMPiEYYJgQ0zTjY1SjEg2WUJIMPq4YapfgcblmhhnmhiYkqiYXksQJKhAUgBzZsPNfA32EBDQ2NDA0tzsgxcADFwP9S7-mADDYxMLNNSksgy8ADEwPsoBqaaGpomJlqSZeADiIGwCLGGGGhgZmFhZoFNaxYAUe6iNw\">>},{type,replication},{updated_on,1666007672},{user,null}]`\r\n\r\nI checked the document to which this error is regarding and the revision 9-6ab086bc66baa1fffe312b90654d90e5 exists on the document from the replication source. \r\n\r\nAny ideas are welcome...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1280780947/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1281103810","html_url":"https://github.com/apache/couchdb/issues/4204#issuecomment-1281103810","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4204","id":1281103810,"node_id":"IC_kwDOAAMmUc5MXBfC","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-17T16:01:39Z","updated_at":"2022-10-17T16:01:39Z","author_association":"CONTRIBUTOR","body":"Try setting the `checkpoint_interval` to 5000 (5 seconds), down from 30 second default to ensure if the replication job crashes, it doesn't have to backtrack too much. Is there anything different about that particular document than other documents? Does it have more conflicts or updated more often, while the replication is happening perhaps?\r\n\r\nAnother thing to try is to check if this happens on the latest release 3.2.2 or not. Specifically it would be to check if when both the source and instance running the replication jobs are updated, if this happens as well.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1281103810/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1281181550","html_url":"https://github.com/apache/couchdb/issues/4207#issuecomment-1281181550","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4207","id":1281181550,"node_id":"IC_kwDOAAMmUc5MXUdu","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-17T17:05:39Z","updated_at":"2022-10-17T17:05:39Z","author_association":"CONTRIBUTOR","body":"@Manphil thanks for checking. It looks like there is an error applying the security property to individual shards and it's not related to inter-node or cluster connections. Is it easy to reproduce with a script or a few instructions which follow the same pattern you used (if you can't share the exact request)?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1281181550/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1281191886","html_url":"https://github.com/apache/couchdb/issues/4204#issuecomment-1281191886","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4204","id":1281191886,"node_id":"IC_kwDOAAMmUc5MXW_O","user":{"login":"arahjan","id":115629637,"node_id":"U_kgDOBuReRQ","avatar_url":"https://avatars.githubusercontent.com/u/115629637?v=4","gravatar_id":"","url":"https://api.github.com/users/arahjan","html_url":"https://github.com/arahjan","followers_url":"https://api.github.com/users/arahjan/followers","following_url":"https://api.github.com/users/arahjan/following{/other_user}","gists_url":"https://api.github.com/users/arahjan/gists{/gist_id}","starred_url":"https://api.github.com/users/arahjan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arahjan/subscriptions","organizations_url":"https://api.github.com/users/arahjan/orgs","repos_url":"https://api.github.com/users/arahjan/repos","events_url":"https://api.github.com/users/arahjan/events{/privacy}","received_events_url":"https://api.github.com/users/arahjan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-17T17:14:28Z","updated_at":"2022-10-17T17:14:28Z","author_association":"NONE","body":"> Is there anything different about that particular document than other documents?\r\nActually, there are more documents which are being reported in couch.log. I've just added a single as an example. \r\n \r\n\r\n> Does` it have more conflicts or updated more often, while the replication is happening perhaps?\r\nI haven't noticed. At the moment, the source is passive meaning there are no changes in the documents. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1281191886/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1281306608","html_url":"https://github.com/apache/couchdb/pull/4230#issuecomment-1281306608","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4230","id":1281306608,"node_id":"IC_kwDOAAMmUc5MXy_w","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-17T18:33:06Z","updated_at":"2022-10-17T18:33:06Z","author_association":"CONTRIBUTOR","body":"A way to test it could be:\r\n\r\n```\r\n(node1@127.0.0.1)5> lists:foreach(fun(_) -> gen_server:call(couch_prometheus_server, refresh) end, lists:seq(1, 500)).\r\nok\r\n(node1@127.0.0.1)6> erlang:process_info(whereis(couch_prometheus_server)).\r\n[{registered_name,couch_prometheus_server},\r\n...\r\n {message_queue_len,286},\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1281306608/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1281425761","html_url":"https://github.com/apache/couchdb/pull/4230#issuecomment-1281425761","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4230","id":1281425761,"node_id":"IC_kwDOAAMmUc5MYQFh","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-17T20:08:35Z","updated_at":"2022-10-17T20:08:35Z","author_association":"CONTRIBUTOR","body":"@jaydoane great idea to add tests, will do so!\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1281425761/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1281922318","html_url":"https://github.com/apache/couchdb/issues/4207#issuecomment-1281922318","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4207","id":1281922318,"node_id":"IC_kwDOAAMmUc5MaJUO","user":{"login":"Manphil","id":22346883,"node_id":"MDQ6VXNlcjIyMzQ2ODgz","avatar_url":"https://avatars.githubusercontent.com/u/22346883?v=4","gravatar_id":"","url":"https://api.github.com/users/Manphil","html_url":"https://github.com/Manphil","followers_url":"https://api.github.com/users/Manphil/followers","following_url":"https://api.github.com/users/Manphil/following{/other_user}","gists_url":"https://api.github.com/users/Manphil/gists{/gist_id}","starred_url":"https://api.github.com/users/Manphil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manphil/subscriptions","organizations_url":"https://api.github.com/users/Manphil/orgs","repos_url":"https://api.github.com/users/Manphil/repos","events_url":"https://api.github.com/users/Manphil/events{/privacy}","received_events_url":"https://api.github.com/users/Manphil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-18T07:19:57Z","updated_at":"2022-10-18T07:19:57Z","author_association":"NONE","body":"It seems that the situation is difficult to reproduce with a script or a few instructions. Even, I can't reproduce this error when i start a new couchdb instance. When i try to reproduce it in that new db but the result is not expected. \r\n\r\nThis error happens in our database that has been running a long time. And the error has happened several times in different couchdb instance(i.e. independent couchdb container). Seemly, the time when the error happens is uncertain. However, the error will always happen once it happens in that db.\r\n\r\nThe only information i can obtain is that it seems that this error happened after the index of db was modified. I'm not sure if the two are related.\r\n\r\nAnyway, thanks for your reply!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1281922318/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1282305794","html_url":"https://github.com/apache/couchdb/issues/3149#issuecomment-1282305794","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3149","id":1282305794,"node_id":"IC_kwDOAAMmUc5Mbm8C","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-18T12:28:25Z","updated_at":"2022-10-18T12:28:25Z","author_association":"CONTRIBUTOR","body":"Closing this, fixed in 016385f408e83e4058fbc8116c257fd579cc5688.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1282305794/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1282334413","html_url":"https://github.com/apache/couchdb/issues/2756#issuecomment-1282334413","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2756","id":1282334413,"node_id":"IC_kwDOAAMmUc5Mbt7N","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-18T12:48:08Z","updated_at":"2022-10-18T12:48:08Z","author_association":"CONTRIBUTOR","body":"I think this is fixed and backported into 3.x. Closing this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1282334413/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1282593844","html_url":"https://github.com/apache/couchdb/issues/4204#issuecomment-1282593844","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4204","id":1282593844,"node_id":"IC_kwDOAAMmUc5MctQ0","user":{"login":"arahjan","id":115629637,"node_id":"U_kgDOBuReRQ","avatar_url":"https://avatars.githubusercontent.com/u/115629637?v=4","gravatar_id":"","url":"https://api.github.com/users/arahjan","html_url":"https://github.com/arahjan","followers_url":"https://api.github.com/users/arahjan/followers","following_url":"https://api.github.com/users/arahjan/following{/other_user}","gists_url":"https://api.github.com/users/arahjan/gists{/gist_id}","starred_url":"https://api.github.com/users/arahjan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arahjan/subscriptions","organizations_url":"https://api.github.com/users/arahjan/orgs","repos_url":"https://api.github.com/users/arahjan/repos","events_url":"https://api.github.com/users/arahjan/events{/privacy}","received_events_url":"https://api.github.com/users/arahjan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-18T15:36:49Z","updated_at":"2022-10-18T15:36:49Z","author_association":"NONE","body":"I haven't tried the upgrade yet.\r\nAnyways, I deleted all \"questionable\" docs on the source. Even so, I'm still seeing replication process trying to fetch doc, which had been deleted. \r\n`notice] 2022-10-18T15:20:39.950023Z couchdb@127.0.0.1 <0.24560.251> -------- Retrying GET to http://admin:*****@a.b.x.d/cdb2/test/doc1.revs=true&open_revs=%5B%222-b3604d99facabc85abc075995edf2d75%22%5D&latest=true in 16.0 seconds due to error {function_clause,[{couch_replicator_api_wrap,'-**open_doc_revs/6-fun-1-',[404**,[{[83,101,114,118,101,114],[110,103,105,110,120,47,49,46,49,54,46,49]}`\r\n\r\nWhat does 404 error mean in this context? I guess it's a leftover old revision. Do I have to manually purge old revisions on source (is it viable)? Or maybe manual compaction is enough? ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1282593844/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1282619560","html_url":"https://github.com/apache/couchdb/issues/4204#issuecomment-1282619560","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4204","id":1282619560,"node_id":"IC_kwDOAAMmUc5Mczio","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-10-18T15:52:38Z","updated_at":"2022-10-18T15:52:38Z","author_association":"CONTRIBUTOR","body":"@arahjan During replication the deleted document tombstones (markers) are also replicated. That's needed because if we have the same document on the target, we'd want it to also be deleted if the source deletes it. \r\n\r\nThere are a few way to avoid replicating tombstones or removing them later: \r\n\r\n *  https://blog.cloudant.com/2021/05/21/Removing-Tombstones.html\r\n *  https://blog.cloudant.com/2019/12/13/Filtered-Replication.html\r\n\r\nPurging could work as well.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1282619560/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]