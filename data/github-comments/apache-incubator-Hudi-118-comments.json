[{"url":"https://api.github.com/repos/apache/hudi/issues/comments/818691445","html_url":"https://github.com/apache/hudi/issues/2791#issuecomment-818691445","issue_url":"https://api.github.com/repos/apache/hudi/issues/2791","id":818691445,"node_id":"MDEyOklzc3VlQ29tbWVudDgxODY5MTQ0NQ==","user":{"login":"njalan","id":8622340,"node_id":"MDQ6VXNlcjg2MjIzNDA=","avatar_url":"https://avatars.githubusercontent.com/u/8622340?v=4","gravatar_id":"","url":"https://api.github.com/users/njalan","html_url":"https://github.com/njalan","followers_url":"https://api.github.com/users/njalan/followers","following_url":"https://api.github.com/users/njalan/following{/other_user}","gists_url":"https://api.github.com/users/njalan/gists{/gist_id}","starred_url":"https://api.github.com/users/njalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/njalan/subscriptions","organizations_url":"https://api.github.com/users/njalan/orgs","repos_url":"https://api.github.com/users/njalan/repos","events_url":"https://api.github.com/users/njalan/events{/privacy}","received_events_url":"https://api.github.com/users/njalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-13T12:20:47Z","updated_at":"2021-04-13T12:20:47Z","author_association":"NONE","body":"Any updates on it?\r\nActually I am facing the same below issues on s3 as other faced and wonder if they are fixed:\r\nhttps://github.com/apache/hudi/issues/1981\r\nhttps://github.com/apache/hudi/issues/1829\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/818691445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/818737198","html_url":"https://github.com/apache/hudi/issues/2609#issuecomment-818737198","issue_url":"https://api.github.com/repos/apache/hudi/issues/2609","id":818737198,"node_id":"MDEyOklzc3VlQ29tbWVudDgxODczNzE5OA==","user":{"login":"tooptoop4","id":33283496,"node_id":"MDQ6VXNlcjMzMjgzNDk2","avatar_url":"https://avatars.githubusercontent.com/u/33283496?v=4","gravatar_id":"","url":"https://api.github.com/users/tooptoop4","html_url":"https://github.com/tooptoop4","followers_url":"https://api.github.com/users/tooptoop4/followers","following_url":"https://api.github.com/users/tooptoop4/following{/other_user}","gists_url":"https://api.github.com/users/tooptoop4/gists{/gist_id}","starred_url":"https://api.github.com/users/tooptoop4/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tooptoop4/subscriptions","organizations_url":"https://api.github.com/users/tooptoop4/orgs","repos_url":"https://api.github.com/users/tooptoop4/repos","events_url":"https://api.github.com/users/tooptoop4/events{/privacy}","received_events_url":"https://api.github.com/users/tooptoop4/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-13T13:30:08Z","updated_at":"2021-04-13T13:30:08Z","author_association":"NONE","body":"@njalan not trino (aka prestosql), it only in prestodb","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/818737198/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":1,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/818868849","html_url":"https://github.com/apache/hudi/issues/2723#issuecomment-818868849","issue_url":"https://api.github.com/repos/apache/hudi/issues/2723","id":818868849,"node_id":"MDEyOklzc3VlQ29tbWVudDgxODg2ODg0OQ==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-13T16:23:33Z","updated_at":"2021-04-13T16:23:33Z","author_association":"CONTRIBUTOR","body":"@liijiankang : This exception is also seen when shutting down service which has async threads running. With async cleaning, there is a separate executor service setup to handle cleaning. Is it possible that you were doing ctrl-C and then saw this exception. \r\n\r\n  ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/818868849/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/818874363","html_url":"https://github.com/apache/hudi/issues/2813#issuecomment-818874363","issue_url":"https://api.github.com/repos/apache/hudi/issues/2813","id":818874363,"node_id":"MDEyOklzc3VlQ29tbWVudDgxODg3NDM2Mw==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-13T16:30:55Z","updated_at":"2021-04-13T16:30:55Z","author_association":"CONTRIBUTOR","body":"cc @n3nash \r\n\r\nCan you try setting hive.input.format=org.apache.hudi.hadoop.hive.HoodieCombineHiveInputFormat\r\n\r\nand trying.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/818874363/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/818882851","html_url":"https://github.com/apache/hudi/pull/2607#issuecomment-818882851","issue_url":"https://api.github.com/repos/apache/hudi/issues/2607","id":818882851,"node_id":"MDEyOklzc3VlQ29tbWVudDgxODg4Mjg1MQ==","user":{"login":"nbalajee","id":47542891,"node_id":"MDQ6VXNlcjQ3NTQyODkx","avatar_url":"https://avatars.githubusercontent.com/u/47542891?v=4","gravatar_id":"","url":"https://api.github.com/users/nbalajee","html_url":"https://github.com/nbalajee","followers_url":"https://api.github.com/users/nbalajee/followers","following_url":"https://api.github.com/users/nbalajee/following{/other_user}","gists_url":"https://api.github.com/users/nbalajee/gists{/gist_id}","starred_url":"https://api.github.com/users/nbalajee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nbalajee/subscriptions","organizations_url":"https://api.github.com/users/nbalajee/orgs","repos_url":"https://api.github.com/users/nbalajee/repos","events_url":"https://api.github.com/users/nbalajee/events{/privacy}","received_events_url":"https://api.github.com/users/nbalajee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-13T16:43:42Z","updated_at":"2021-04-13T16:43:42Z","author_association":"CONTRIBUTOR","body":"> 1. Logical vs Physical Space\r\n       - With RFC-15 this information can be reported from metdata.  (before RFC-15, may take additional listing)\r\n> 2. CPU used per record (CPU usage of this job ?)\r\n       - cumulative sum of time taken translates to vcore seconds.\r\n> 3. Mem used per record (Mem usage of this job ?)\r\n       - cumulative sum of time taken translates to memory seconds (timetaken * {mem allocated per executor} by default.  Can be refined with actual mem usage stats).\r\n> 4. Time taken per record\r\n        - write stage time\r\n        - bloom index stage time \r\n        are collected per executor.  \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/818882851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/818949257","html_url":"https://github.com/apache/hudi/pull/2815#issuecomment-818949257","issue_url":"https://api.github.com/repos/apache/hudi/issues/2815","id":818949257,"node_id":"MDEyOklzc3VlQ29tbWVudDgxODk0OTI1Nw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-13T18:09:47Z","updated_at":"2021-04-13T18:09:47Z","author_association":"MEMBER","body":"@wangxianghu could please take a look \r\n\r\n@bvaradar can you quickly eye ball the trino instructions? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/818949257/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819114587","html_url":"https://github.com/apache/hudi/pull/2816#issuecomment-819114587","issue_url":"https://api.github.com/repos/apache/hudi/issues/2816","id":819114587,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTExNDU4Nw==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-13T23:25:54Z","updated_at":"2021-04-13T23:29:36Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2816?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2816](https://codecov.io/gh/apache/hudi/pull/2816?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (829b2a6) into [master](https://codecov.io/gh/apache/hudi/commit/e16d31dce2386868634963ec7cf79c5dfae03cc7?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (e16d31d) will **decrease** coverage by `0.02%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2816/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2816?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2816      +/-   ##\n============================================\n- Coverage     52.57%   52.55%   -0.03%     \n- Complexity     3707     3708       +1     \n============================================\n  Files           484      484              \n  Lines         23173    23182       +9     \n  Branches       2459     2461       +2     \n============================================\n- Hits          12184    12183       -1     \n- Misses         9918     9926       +8     \n- Partials       1071     1073       +2     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `40.29% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiclient | `∅ <ø> (∅)` | `0.00 <ø> (ø)` | |\n| hudicommon | `50.67% <ø> (-0.02%)` | `0.00 <ø> (ø)` | |\n| hudiflink | `56.66% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.33% <ø> (-0.12%)` | `0.00 <ø> (ø)` | |\n| hudisparkdatasource | `71.33% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisync | `45.70% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `64.36% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.79% <ø> (ø)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2816?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...hadoop/realtime/RealtimeCompactedRecordReader.java](https://codecov.io/gh/apache/hudi/pull/2816/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1oYWRvb3AtbXIvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaGFkb29wL3JlYWx0aW1lL1JlYWx0aW1lQ29tcGFjdGVkUmVjb3JkUmVhZGVyLmphdmE=) | `64.06% <0.00%> (-8.67%)` | `13.00% <0.00%> (+1.00%)` | :arrow_down: |\n| [...e/hudi/common/table/log/HoodieLogFormatWriter.java](https://codecov.io/gh/apache/hudi/pull/2816/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9Ib29kaWVMb2dGb3JtYXRXcml0ZXIuamF2YQ==) | `78.12% <0.00%> (-1.57%)` | `26.00% <0.00%> (ø%)` | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819114587/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819128495","html_url":"https://github.com/apache/hudi/issues/2791#issuecomment-819128495","issue_url":"https://api.github.com/repos/apache/hudi/issues/2791","id":819128495,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTEyODQ5NQ==","user":{"login":"prashantwason","id":58448203,"node_id":"MDQ6VXNlcjU4NDQ4MjAz","avatar_url":"https://avatars.githubusercontent.com/u/58448203?v=4","gravatar_id":"","url":"https://api.github.com/users/prashantwason","html_url":"https://github.com/prashantwason","followers_url":"https://api.github.com/users/prashantwason/followers","following_url":"https://api.github.com/users/prashantwason/following{/other_user}","gists_url":"https://api.github.com/users/prashantwason/gists{/gist_id}","starred_url":"https://api.github.com/users/prashantwason/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prashantwason/subscriptions","organizations_url":"https://api.github.com/users/prashantwason/orgs","repos_url":"https://api.github.com/users/prashantwason/repos","events_url":"https://api.github.com/users/prashantwason/events{/privacy}","received_events_url":"https://api.github.com/users/prashantwason/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T00:08:54Z","updated_at":"2021-04-14T00:08:54Z","author_association":"MEMBER","body":"Are you getting this error each time you run df.write.format() ?\r\nor\r\nAre you getting this error occasionally (i.e. sometimes df.write.format succeeds and then you run into this error)?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819128495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819141601","html_url":"https://github.com/apache/hudi/issues/2791#issuecomment-819141601","issue_url":"https://api.github.com/repos/apache/hudi/issues/2791","id":819141601,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTE0MTYwMQ==","user":{"login":"njalan","id":8622340,"node_id":"MDQ6VXNlcjg2MjIzNDA=","avatar_url":"https://avatars.githubusercontent.com/u/8622340?v=4","gravatar_id":"","url":"https://api.github.com/users/njalan","html_url":"https://github.com/njalan","followers_url":"https://api.github.com/users/njalan/followers","following_url":"https://api.github.com/users/njalan/following{/other_user}","gists_url":"https://api.github.com/users/njalan/gists{/gist_id}","starred_url":"https://api.github.com/users/njalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/njalan/subscriptions","organizations_url":"https://api.github.com/users/njalan/orgs","repos_url":"https://api.github.com/users/njalan/repos","events_url":"https://api.github.com/users/njalan/events{/privacy}","received_events_url":"https://api.github.com/users/njalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T00:43:53Z","updated_at":"2021-04-14T00:43:53Z","author_association":"NONE","body":"@prashantwason  Thanks for your reply. I am getting this error occasionally.  In my couple of testing it keeps running for likely 20 times df.write.format successfully and then get this error.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819141601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819149860","html_url":"https://github.com/apache/hudi/issues/2723#issuecomment-819149860","issue_url":"https://api.github.com/repos/apache/hudi/issues/2723","id":819149860,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTE0OTg2MA==","user":{"login":"liijiankang","id":42951757,"node_id":"MDQ6VXNlcjQyOTUxNzU3","avatar_url":"https://avatars.githubusercontent.com/u/42951757?v=4","gravatar_id":"","url":"https://api.github.com/users/liijiankang","html_url":"https://github.com/liijiankang","followers_url":"https://api.github.com/users/liijiankang/followers","following_url":"https://api.github.com/users/liijiankang/following{/other_user}","gists_url":"https://api.github.com/users/liijiankang/gists{/gist_id}","starred_url":"https://api.github.com/users/liijiankang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liijiankang/subscriptions","organizations_url":"https://api.github.com/users/liijiankang/orgs","repos_url":"https://api.github.com/users/liijiankang/repos","events_url":"https://api.github.com/users/liijiankang/events{/privacy}","received_events_url":"https://api.github.com/users/liijiankang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T01:08:29Z","updated_at":"2021-04-14T01:08:29Z","author_association":"NONE","body":"@bvaradar Our spark streaming program is submitted to yarn to run in cluster mode, and ctrl-C is not executed during the operation. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819149860/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819153648","html_url":"https://github.com/apache/hudi/issues/2791#issuecomment-819153648","issue_url":"https://api.github.com/repos/apache/hudi/issues/2791","id":819153648,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTE1MzY0OA==","user":{"login":"prashantwason","id":58448203,"node_id":"MDQ6VXNlcjU4NDQ4MjAz","avatar_url":"https://avatars.githubusercontent.com/u/58448203?v=4","gravatar_id":"","url":"https://api.github.com/users/prashantwason","html_url":"https://github.com/prashantwason","followers_url":"https://api.github.com/users/prashantwason/followers","following_url":"https://api.github.com/users/prashantwason/following{/other_user}","gists_url":"https://api.github.com/users/prashantwason/gists{/gist_id}","starred_url":"https://api.github.com/users/prashantwason/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prashantwason/subscriptions","organizations_url":"https://api.github.com/users/prashantwason/orgs","repos_url":"https://api.github.com/users/prashantwason/repos","events_url":"https://api.github.com/users/prashantwason/events{/privacy}","received_events_url":"https://api.github.com/users/prashantwason/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T01:21:01Z","updated_at":"2021-04-14T01:21:01Z","author_association":"MEMBER","body":"Ok thanks for confirming. I am looking into this issue.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819153648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819156959","html_url":"https://github.com/apache/hudi/pull/2815#issuecomment-819156959","issue_url":"https://api.github.com/repos/apache/hudi/issues/2815","id":819156959,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTE1Njk1OQ==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T01:28:45Z","updated_at":"2021-04-14T01:28:55Z","author_association":"CONTRIBUTOR","body":"@leesf Can we also add the OBS product (object storage) of Huawei Cloud into the storage layer later?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819156959/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819159135","html_url":"https://github.com/apache/hudi/pull/2815#issuecomment-819159135","issue_url":"https://api.github.com/repos/apache/hudi/issues/2815","id":819159135,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTE1OTEzNQ==","user":{"login":"leesf","id":10128888,"node_id":"MDQ6VXNlcjEwMTI4ODg4","avatar_url":"https://avatars.githubusercontent.com/u/10128888?v=4","gravatar_id":"","url":"https://api.github.com/users/leesf","html_url":"https://github.com/leesf","followers_url":"https://api.github.com/users/leesf/followers","following_url":"https://api.github.com/users/leesf/following{/other_user}","gists_url":"https://api.github.com/users/leesf/gists{/gist_id}","starred_url":"https://api.github.com/users/leesf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leesf/subscriptions","organizations_url":"https://api.github.com/users/leesf/orgs","repos_url":"https://api.github.com/users/leesf/repos","events_url":"https://api.github.com/users/leesf/events{/privacy}","received_events_url":"https://api.github.com/users/leesf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T01:36:19Z","updated_at":"2021-04-14T01:36:19Z","author_association":"CONTRIBUTOR","body":"> @leesf Can we also add the OBS product (object storage) of Huawei Cloud into the storage layer later?\r\n\r\n@yanghua Sure, @xiarixiaoyao would you please provide obs image so that we would add it in landing page?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819159135/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819171294","html_url":"https://github.com/apache/hudi/pull/1946#issuecomment-819171294","issue_url":"https://api.github.com/repos/apache/hudi/issues/1946","id":819171294,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTE3MTI5NA==","user":{"login":"hddong","id":17537134,"node_id":"MDQ6VXNlcjE3NTM3MTM0","avatar_url":"https://avatars.githubusercontent.com/u/17537134?v=4","gravatar_id":"","url":"https://api.github.com/users/hddong","html_url":"https://github.com/hddong","followers_url":"https://api.github.com/users/hddong/followers","following_url":"https://api.github.com/users/hddong/following{/other_user}","gists_url":"https://api.github.com/users/hddong/gists{/gist_id}","starred_url":"https://api.github.com/users/hddong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hddong/subscriptions","organizations_url":"https://api.github.com/users/hddong/orgs","repos_url":"https://api.github.com/users/hddong/repos","events_url":"https://api.github.com/users/hddong/events{/privacy}","received_events_url":"https://api.github.com/users/hddong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T02:14:45Z","updated_at":"2021-04-14T02:14:45Z","author_association":"CONTRIBUTOR","body":"> we still need `log4j2.properties` or `log4j2.xml` configs right?\r\n\r\nYes, dependent on log4j2 config files now.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819171294/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819172269","html_url":"https://github.com/apache/hudi/pull/2773#issuecomment-819172269","issue_url":"https://api.github.com/repos/apache/hudi/issues/2773","id":819172269,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTE3MjI2OQ==","user":{"login":"lw309637554","id":8501994,"node_id":"MDQ6VXNlcjg1MDE5OTQ=","avatar_url":"https://avatars.githubusercontent.com/u/8501994?v=4","gravatar_id":"","url":"https://api.github.com/users/lw309637554","html_url":"https://github.com/lw309637554","followers_url":"https://api.github.com/users/lw309637554/followers","following_url":"https://api.github.com/users/lw309637554/following{/other_user}","gists_url":"https://api.github.com/users/lw309637554/gists{/gist_id}","starred_url":"https://api.github.com/users/lw309637554/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lw309637554/subscriptions","organizations_url":"https://api.github.com/users/lw309637554/orgs","repos_url":"https://api.github.com/users/lw309637554/repos","events_url":"https://api.github.com/users/lw309637554/events{/privacy}","received_events_url":"https://api.github.com/users/lw309637554/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T02:17:53Z","updated_at":"2021-04-14T02:17:53Z","author_association":"CONTRIBUTOR","body":"@jintaoguan hello ,can you open a new issue and  raise PR to update documentation on CLI page. I can merge this pr","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819172269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819181287","html_url":"https://github.com/apache/hudi/issues/2813#issuecomment-819181287","issue_url":"https://api.github.com/repos/apache/hudi/issues/2813","id":819181287,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTE4MTI4Nw==","user":{"login":"qianjiangbing","id":5980255,"node_id":"MDQ6VXNlcjU5ODAyNTU=","avatar_url":"https://avatars.githubusercontent.com/u/5980255?v=4","gravatar_id":"","url":"https://api.github.com/users/qianjiangbing","html_url":"https://github.com/qianjiangbing","followers_url":"https://api.github.com/users/qianjiangbing/followers","following_url":"https://api.github.com/users/qianjiangbing/following{/other_user}","gists_url":"https://api.github.com/users/qianjiangbing/gists{/gist_id}","starred_url":"https://api.github.com/users/qianjiangbing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qianjiangbing/subscriptions","organizations_url":"https://api.github.com/users/qianjiangbing/orgs","repos_url":"https://api.github.com/users/qianjiangbing/repos","events_url":"https://api.github.com/users/qianjiangbing/events{/privacy}","received_events_url":"https://api.github.com/users/qianjiangbing/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T02:47:23Z","updated_at":"2021-04-14T02:47:23Z","author_association":"NONE","body":"I tried to set hive.input.format = org.apache.hudi.hadoop.hive.HoodieCombineHiveInputFormat;\r\nBut another error occurred:\r\n\r\nDiagnostic Messages for this Task:\r\nError: java.lang.ClassCastException: org.apache.hadoop.hive.ql.exec.vector.VectorizedRowBatch cannot be cast to org.apache.hadoop.io.ArrayWritable\r\n        at org.apache.hudi.hadoop.realtime.RealtimeCompactedRecordReader.createValue(RealtimeCompactedRecordReader.java:150)\r\n        at org.apache.hudi.hadoop.realtime.RealtimeCompactedRecordReader.createValue(RealtimeCompactedRecordReader.java:43)\r\n        at org.apache.hudi.hadoop.realtime.HoodieRealtimeRecordReader.createValue(HoodieRealtimeRecordReader.java:89)\r\n        at org.apache.hudi.hadoop.realtime.HoodieRealtimeRecordReader.createValue(HoodieRealtimeRecordReader.java:36)\r\n        at org.apache.hudi.hadoop.realtime.RealtimeCompactedRecordReader.createValue(RealtimeCompactedRecordReader.java:150)\r\n        at org.apache.hudi.hadoop.realtime.RealtimeCompactedRecordReader.createValue(RealtimeCompactedRecordReader.java:43)\r\n        at org.apache.hudi.hadoop.realtime.HoodieRealtimeRecordReader.createValue(HoodieRealtimeRecordReader.java:89)\r\n        at org.apache.hudi.hadoop.realtime.HoodieCombineRealtimeRecordReader.createValue(HoodieCombineRealtimeRecordReader.java:87)\r\n        at org.apache.hudi.hadoop.realtime.HoodieCombineRealtimeRecordReader.createValue(HoodieCombineRealtimeRecordReader.java:41)\r\n        at org.apache.hadoop.mapred.MapTask$TrackedRecordReader.createValue(MapTask.java:186)\r\n        at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:50)\r\n        at org.apache.hadoop.hive.ql.exec.mr.ExecMapRunner.run(ExecMapRunner.java:37)\r\n        at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:465)\r\n        at org.apache.hadoop.mapred.MapTask.run(MapTask.java:349)\r\n        at org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:174)\r\n        at java.security.AccessController.doPrivileged(Native Method)\r\n        at javax.security.auth.Subject.doAs(Subject.java:422)\r\n        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1731)\r\n        at org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:168)\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819181287/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819224593","html_url":"https://github.com/apache/hudi/issues/2817#issuecomment-819224593","issue_url":"https://api.github.com/repos/apache/hudi/issues/2817","id":819224593,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTIyNDU5Mw==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T04:47:53Z","updated_at":"2021-04-14T04:48:32Z","author_association":"CONTRIBUTOR","body":"@danny0405 @yanghua Can one of you help here ? Once you've responded, please mark label `awaiting-user-response` and remove label `awaiting-community-help`","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819224593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819225776","html_url":"https://github.com/apache/hudi/pull/2784#issuecomment-819225776","issue_url":"https://api.github.com/repos/apache/hudi/issues/2784","id":819225776,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTIyNTc3Ng==","user":{"login":"satishkotha","id":2992755,"node_id":"MDQ6VXNlcjI5OTI3NTU=","avatar_url":"https://avatars.githubusercontent.com/u/2992755?v=4","gravatar_id":"","url":"https://api.github.com/users/satishkotha","html_url":"https://github.com/satishkotha","followers_url":"https://api.github.com/users/satishkotha/followers","following_url":"https://api.github.com/users/satishkotha/following{/other_user}","gists_url":"https://api.github.com/users/satishkotha/gists{/gist_id}","starred_url":"https://api.github.com/users/satishkotha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/satishkotha/subscriptions","organizations_url":"https://api.github.com/users/satishkotha/orgs","repos_url":"https://api.github.com/users/satishkotha/repos","events_url":"https://api.github.com/users/satishkotha/events{/privacy}","received_events_url":"https://api.github.com/users/satishkotha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T04:51:46Z","updated_at":"2021-04-14T04:51:46Z","author_association":"MEMBER","body":"@lw309637554 I reviewed this PR but just want to get another set of eyes. do you mind taking a pass on this? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819225776/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819226802","html_url":"https://github.com/apache/hudi/issues/2813#issuecomment-819226802","issue_url":"https://api.github.com/repos/apache/hudi/issues/2813","id":819226802,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTIyNjgwMg==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T04:55:01Z","updated_at":"2021-04-14T04:55:01Z","author_association":"CONTRIBUTOR","body":"@qianjiangbing @bvaradar There is a ticket created for this -> https://issues.apache.org/jira/browse/HUDI-1036. I will look into this later this week. This looks like a legitimate issue ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819226802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819228489","html_url":"https://github.com/apache/hudi/issues/2812#issuecomment-819228489","issue_url":"https://api.github.com/repos/apache/hudi/issues/2812","id":819228489,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTIyODQ4OQ==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T05:00:18Z","updated_at":"2021-04-14T05:00:18Z","author_association":"CONTRIBUTOR","body":"@xglv1985 It looks like you hit this issue -> https://issues.apache.org/jira/browse/SPARK-11844. \r\n\r\nThe ticket was created as a MINOR and is already resolved by customers explaining that re-try works. Have you tried re-running the job with \"hudi\" multiple times to see if this problem is repeatable ? if yes, we might have to re-open that Spark ticket to get some help.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819228489/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819242687","html_url":"https://github.com/apache/hudi/issues/2813#issuecomment-819242687","issue_url":"https://api.github.com/repos/apache/hudi/issues/2813","id":819242687,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTI0MjY4Nw==","user":{"login":"MyLanPangzi","id":46845236,"node_id":"MDQ6VXNlcjQ2ODQ1MjM2","avatar_url":"https://avatars.githubusercontent.com/u/46845236?v=4","gravatar_id":"","url":"https://api.github.com/users/MyLanPangzi","html_url":"https://github.com/MyLanPangzi","followers_url":"https://api.github.com/users/MyLanPangzi/followers","following_url":"https://api.github.com/users/MyLanPangzi/following{/other_user}","gists_url":"https://api.github.com/users/MyLanPangzi/gists{/gist_id}","starred_url":"https://api.github.com/users/MyLanPangzi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MyLanPangzi/subscriptions","organizations_url":"https://api.github.com/users/MyLanPangzi/orgs","repos_url":"https://api.github.com/users/MyLanPangzi/repos","events_url":"https://api.github.com/users/MyLanPangzi/events{/privacy}","received_events_url":"https://api.github.com/users/MyLanPangzi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T05:38:54Z","updated_at":"2021-04-14T05:38:54Z","author_association":"CONTRIBUTOR","body":"update the question description. i'm using org.apache.hudi.hadoop.realtime.HoodieParquetRealtimeInputFormat agg query mor table when error occur.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819242687/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819244201","html_url":"https://github.com/apache/hudi/pull/2793#issuecomment-819244201","issue_url":"https://api.github.com/repos/apache/hudi/issues/2793","id":819244201,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTI0NDIwMQ==","user":{"login":"TeRS-K","id":26078631,"node_id":"MDQ6VXNlcjI2MDc4NjMx","avatar_url":"https://avatars.githubusercontent.com/u/26078631?v=4","gravatar_id":"","url":"https://api.github.com/users/TeRS-K","html_url":"https://github.com/TeRS-K","followers_url":"https://api.github.com/users/TeRS-K/followers","following_url":"https://api.github.com/users/TeRS-K/following{/other_user}","gists_url":"https://api.github.com/users/TeRS-K/gists{/gist_id}","starred_url":"https://api.github.com/users/TeRS-K/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TeRS-K/subscriptions","organizations_url":"https://api.github.com/users/TeRS-K/orgs","repos_url":"https://api.github.com/users/TeRS-K/repos","events_url":"https://api.github.com/users/TeRS-K/events{/privacy}","received_events_url":"https://api.github.com/users/TeRS-K/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T05:42:41Z","updated_at":"2021-04-14T05:42:41Z","author_association":"CONTRIBUTOR","body":"@leesf \r\n> would not sync hudi orc format table to hive metastore yet?\r\n\r\nORC is well-integrated with hive, so hive already has OrcInputFormat, OrcOutputFormat etc. With my latest change to the HoodieInputFormatUtils class, I was able to sync hudi orc format table to hive metastore (tested with deltastreamer).\r\nHowever, we do still need to implement HoodieOrcInputFormat & HoodieRealtimeOrcInputFormat. I have done some work on that but it's not tested yet.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819244201/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819257340","html_url":"https://github.com/apache/hudi/issues/2812#issuecomment-819257340","issue_url":"https://api.github.com/repos/apache/hudi/issues/2812","id":819257340,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTI1NzM0MA==","user":{"login":"xglv1985","id":15320045,"node_id":"MDQ6VXNlcjE1MzIwMDQ1","avatar_url":"https://avatars.githubusercontent.com/u/15320045?v=4","gravatar_id":"","url":"https://api.github.com/users/xglv1985","html_url":"https://github.com/xglv1985","followers_url":"https://api.github.com/users/xglv1985/followers","following_url":"https://api.github.com/users/xglv1985/following{/other_user}","gists_url":"https://api.github.com/users/xglv1985/gists{/gist_id}","starred_url":"https://api.github.com/users/xglv1985/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xglv1985/subscriptions","organizations_url":"https://api.github.com/users/xglv1985/orgs","repos_url":"https://api.github.com/users/xglv1985/repos","events_url":"https://api.github.com/users/xglv1985/events{/privacy}","received_events_url":"https://api.github.com/users/xglv1985/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T06:13:28Z","updated_at":"2021-04-14T06:14:58Z","author_association":"CONTRIBUTOR","body":"> @xglv1985 It looks like you hit this issue -> https://issues.apache.org/jira/browse/SPARK-11844.\r\n> \r\n> The ticket was created as a MINOR and is already resolved by customers explaining that re-try works. Have you tried re-running the job with \"hudi\" multiple times to see if this problem is repeatable ? if yes, we might have to re-open that Spark ticket to get some help.\r\n\r\nThanks for attention. Yes, the problem is repeatable and can be reproduced each time definitely.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819257340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819258164","html_url":"https://github.com/apache/hudi/issues/2817#issuecomment-819258164","issue_url":"https://api.github.com/repos/apache/hudi/issues/2817","id":819258164,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTI1ODE2NA==","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T06:15:17Z","updated_at":"2021-04-14T06:15:17Z","author_association":"CONTRIBUTOR","body":"Can not do that now really, for batch query, Flink SQL always query the latest snapshot, would support query the history snapshot soon ~","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819258164/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819258466","html_url":"https://github.com/apache/hudi/issues/2817#issuecomment-819258466","issue_url":"https://api.github.com/repos/apache/hudi/issues/2817","id":819258466,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTI1ODQ2Ng==","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T06:15:53Z","updated_at":"2021-04-14T06:15:53Z","author_association":"CONTRIBUTOR","body":"@n3nash Sorry i have no permission to edit the tags.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819258466/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819265116","html_url":"https://github.com/apache/hudi/pull/2793#issuecomment-819265116","issue_url":"https://api.github.com/repos/apache/hudi/issues/2793","id":819265116,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTI2NTExNg==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T06:30:06Z","updated_at":"2021-04-14T06:31:08Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2793?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2793](https://codecov.io/gh/apache/hudi/pull/2793?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (619d75b) into [master](https://codecov.io/gh/apache/hudi/commit/6786581c4842e47e1a8a8e942f54003dc151c7c6?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (6786581) will **decrease** coverage by `0.99%`.\n> The diff coverage is `8.67%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2793/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2793?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2793      +/-   ##\n============================================\n- Coverage     52.54%   51.55%   -1.00%     \n- Complexity     3707     3729      +22     \n============================================\n  Files           485      489       +4     \n  Lines         23171    23753     +582     \n  Branches       2459     2554      +95     \n============================================\n+ Hits          12176    12246      +70     \n- Misses         9923    10427     +504     \n- Partials       1072     1080       +8     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `40.29% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiclient | `∅ <ø> (∅)` | `0.00 <ø> (ø)` | |\n| hudicommon | `48.61% <8.72%> (-2.07%)` | `0.00 <21.00> (ø)` | |\n| hudiflink | `56.54% <ø> (-0.04%)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.27% <0.00%> (-0.18%)` | `0.00 <0.00> (ø)` | |\n| hudisparkdatasource | `71.33% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisync | `45.70% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `64.36% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.74% <ø> (+0.01%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2793?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...org/apache/hudi/common/util/OrcReaderIterator.java](https://codecov.io/gh/apache/hudi/pull/2793/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3V0aWwvT3JjUmVhZGVySXRlcmF0b3IuamF2YQ==) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (?)` | |\n| [...ain/java/org/apache/hudi/common/util/OrcUtils.java](https://codecov.io/gh/apache/hudi/pull/2793/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3V0aWwvT3JjVXRpbHMuamF2YQ==) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (?)` | |\n| [...ache/hudi/hadoop/utils/HoodieInputFormatUtils.java](https://codecov.io/gh/apache/hudi/pull/2793/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1oYWRvb3AtbXIvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaGFkb29wL3V0aWxzL0hvb2RpZUlucHV0Rm9ybWF0VXRpbHMuamF2YQ==) | `47.23% <0.00%> (-0.73%)` | `30.00 <0.00> (ø)` | |\n| [...java/org/apache/hudi/common/util/AvroOrcUtils.java](https://codecov.io/gh/apache/hudi/pull/2793/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3V0aWwvQXZyb09yY1V0aWxzLmphdmE=) | `9.11% <9.11%> (ø)` | `19.00 <19.00> (?)` | |\n| [...va/org/apache/hudi/io/storage/HoodieOrcReader.java](https://codecov.io/gh/apache/hudi/pull/2793/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaW8vc3RvcmFnZS9Ib29kaWVPcmNSZWFkZXIuamF2YQ==) | `25.00% <25.00%> (ø)` | `1.00 <1.00> (?)` | |\n| [...org/apache/hudi/common/model/HoodieFileFormat.java](https://codecov.io/gh/apache/hudi/pull/2793/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL21vZGVsL0hvb2RpZUZpbGVGb3JtYXQuamF2YQ==) | `100.00% <100.00%> (ø)` | `3.00 <0.00> (ø)` | |\n| [...pache/hudi/io/storage/HoodieFileReaderFactory.java](https://codecov.io/gh/apache/hudi/pull/2793/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaW8vc3RvcmFnZS9Ib29kaWVGaWxlUmVhZGVyRmFjdG9yeS5qYXZh) | `61.53% <100.00%> (+11.53%)` | `5.00 <1.00> (+2.00)` | |\n| [.../apache/hudi/sink/partitioner/BucketAssigners.java](https://codecov.io/gh/apache/hudi/pull/2793/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL3BhcnRpdGlvbmVyL0J1Y2tldEFzc2lnbmVycy5qYXZh) | `33.33% <0.00%> (-16.67%)` | `2.00% <0.00%> (ø%)` | |\n| [...hadoop/realtime/RealtimeCompactedRecordReader.java](https://codecov.io/gh/apache/hudi/pull/2793/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1oYWRvb3AtbXIvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaGFkb29wL3JlYWx0aW1lL1JlYWx0aW1lQ29tcGFjdGVkUmVjb3JkUmVhZGVyLmphdmE=) | `64.06% <0.00%> (-8.67%)` | `13.00% <0.00%> (+1.00%)` | :arrow_down: |\n| [.../java/org/apache/hudi/common/util/CommitUtils.java](https://codecov.io/gh/apache/hudi/pull/2793/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3V0aWwvQ29tbWl0VXRpbHMuamF2YQ==) | `40.47% <0.00%> (-3.12%)` | `6.00% <0.00%> (ø%)` | |\n| ... and [21 more](https://codecov.io/gh/apache/hudi/pull/2793/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819265116/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819279331","html_url":"https://github.com/apache/hudi/pull/2815#issuecomment-819279331","issue_url":"https://api.github.com/repos/apache/hudi/issues/2815","id":819279331,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTI3OTMzMQ==","user":{"login":"xiarixiaoyao","id":13514703,"node_id":"MDQ6VXNlcjEzNTE0NzAz","avatar_url":"https://avatars.githubusercontent.com/u/13514703?v=4","gravatar_id":"","url":"https://api.github.com/users/xiarixiaoyao","html_url":"https://github.com/xiarixiaoyao","followers_url":"https://api.github.com/users/xiarixiaoyao/followers","following_url":"https://api.github.com/users/xiarixiaoyao/following{/other_user}","gists_url":"https://api.github.com/users/xiarixiaoyao/gists{/gist_id}","starred_url":"https://api.github.com/users/xiarixiaoyao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiarixiaoyao/subscriptions","organizations_url":"https://api.github.com/users/xiarixiaoyao/orgs","repos_url":"https://api.github.com/users/xiarixiaoyao/repos","events_url":"https://api.github.com/users/xiarixiaoyao/events{/privacy}","received_events_url":"https://api.github.com/users/xiarixiaoyao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T06:59:02Z","updated_at":"2021-04-14T06:59:02Z","author_association":"CONTRIBUTOR","body":"![image](https://user-images.githubusercontent.com/13514703/114667285-de17eb80-9d31-11eb-97ae-bcef248b6fbe.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819279331/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819280589","html_url":"https://github.com/apache/hudi/issues/2817#issuecomment-819280589","issue_url":"https://api.github.com/repos/apache/hudi/issues/2817","id":819280589,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTI4MDU4OQ==","user":{"login":"BigWrite","id":18157374,"node_id":"MDQ6VXNlcjE4MTU3Mzc0","avatar_url":"https://avatars.githubusercontent.com/u/18157374?v=4","gravatar_id":"","url":"https://api.github.com/users/BigWrite","html_url":"https://github.com/BigWrite","followers_url":"https://api.github.com/users/BigWrite/followers","following_url":"https://api.github.com/users/BigWrite/following{/other_user}","gists_url":"https://api.github.com/users/BigWrite/gists{/gist_id}","starred_url":"https://api.github.com/users/BigWrite/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BigWrite/subscriptions","organizations_url":"https://api.github.com/users/BigWrite/orgs","repos_url":"https://api.github.com/users/BigWrite/repos","events_url":"https://api.github.com/users/BigWrite/events{/privacy}","received_events_url":"https://api.github.com/users/BigWrite/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T07:01:34Z","updated_at":"2021-04-14T07:01:34Z","author_association":"NONE","body":"@danny0405 tks for your resp, can i manage history snapshot? such as clean log from one year ago ,to save space, only  save 1 snapshot at first day of each month","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819280589/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819282116","html_url":"https://github.com/apache/hudi/issues/2817#issuecomment-819282116","issue_url":"https://api.github.com/repos/apache/hudi/issues/2817","id":819282116,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTI4MjExNg==","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T07:04:24Z","updated_at":"2021-04-14T07:04:24Z","author_association":"CONTRIBUTOR","body":"> @danny0405 tks for your resp, can i manage history snapshot? such as clean log from one year ago ,to save space, only save 1 snapshot at first day of each month\r\n\r\nYou can do that, and actually Flink SQL already does that, see config options `clean.retain_commits` and `clean.async.enabled`.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819282116/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819282430","html_url":"https://github.com/apache/hudi/issues/2817#issuecomment-819282430","issue_url":"https://api.github.com/repos/apache/hudi/issues/2817","id":819282430,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTI4MjQzMA==","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T07:04:53Z","updated_at":"2021-04-14T07:04:53Z","author_association":"CONTRIBUTOR","body":"BTW, i suggest you to use the latest master code which is more stable for production now ~","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819282430/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819289708","html_url":"https://github.com/apache/hudi/issues/2817#issuecomment-819289708","issue_url":"https://api.github.com/repos/apache/hudi/issues/2817","id":819289708,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTI4OTcwOA==","user":{"login":"BigWrite","id":18157374,"node_id":"MDQ6VXNlcjE4MTU3Mzc0","avatar_url":"https://avatars.githubusercontent.com/u/18157374?v=4","gravatar_id":"","url":"https://api.github.com/users/BigWrite","html_url":"https://github.com/BigWrite","followers_url":"https://api.github.com/users/BigWrite/followers","following_url":"https://api.github.com/users/BigWrite/following{/other_user}","gists_url":"https://api.github.com/users/BigWrite/gists{/gist_id}","starred_url":"https://api.github.com/users/BigWrite/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BigWrite/subscriptions","organizations_url":"https://api.github.com/users/BigWrite/orgs","repos_url":"https://api.github.com/users/BigWrite/repos","events_url":"https://api.github.com/users/BigWrite/events{/privacy}","received_events_url":"https://api.github.com/users/BigWrite/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T07:17:31Z","updated_at":"2021-04-14T07:17:31Z","author_association":"NONE","body":"> BTW, i suggest you to use the latest master code which is more stable for production now ~\r\n\r\nthanks for your help. we are research how to build our datalake，your help means a lot. we'll try to use the most recently released code.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819289708/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819291374","html_url":"https://github.com/apache/hudi/pull/2819#issuecomment-819291374","issue_url":"https://api.github.com/repos/apache/hudi/issues/2819","id":819291374,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTI5MTM3NA==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T07:20:20Z","updated_at":"2021-04-14T07:33:20Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2819?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2819](https://codecov.io/gh/apache/hudi/pull/2819?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (eb7d058) into [master](https://codecov.io/gh/apache/hudi/commit/65844a8d29b715227f3b2ecdf9b102a08950ee67?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (65844a8) will **decrease** coverage by `0.01%`.\n> The diff coverage is `70.00%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2819/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2819?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2819      +/-   ##\n============================================\n- Coverage     52.55%   52.53%   -0.02%     \n- Complexity     3708     3709       +1     \n============================================\n  Files           484      485       +1     \n  Lines         23182    23227      +45     \n  Branches       2461     2465       +4     \n============================================\n+ Hits          12183    12203      +20     \n- Misses         9926     9948      +22     \n- Partials       1073     1076       +3     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `40.29% <0.00%> (ø)` | `0.00 <0.00> (ø)` | |\n| hudiclient | `∅ <ø> (∅)` | `0.00 <ø> (ø)` | |\n| hudicommon | `50.67% <100.00%> (-0.01%)` | `0.00 <3.00> (ø)` | |\n| hudiflink | `56.54% <ø> (-0.13%)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.33% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisparkdatasource | `71.33% <100.00%> (ø)` | `0.00 <0.00> (ø)` | |\n| hudisync | `45.70% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `64.36% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.79% <ø> (ø)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2819?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...ain/java/org/apache/hudi/cli/utils/CommitUtil.java](https://codecov.io/gh/apache/hudi/pull/2819/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jbGkvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY2xpL3V0aWxzL0NvbW1pdFV0aWwuamF2YQ==) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (ø)` | |\n| [...di/common/table/timeline/HoodieActiveTimeline.java](https://codecov.io/gh/apache/hudi/pull/2819/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL3RpbWVsaW5lL0hvb2RpZUFjdGl2ZVRpbWVsaW5lLmphdmE=) | `67.23% <100.00%> (+0.42%)` | `44.00 <3.00> (+1.00)` | |\n| [.../spark/sql/hudi/streaming/HoodieStreamSource.scala](https://codecov.io/gh/apache/hudi/pull/2819/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9zcGFyay9zcWwvaHVkaS9zdHJlYW1pbmcvSG9vZGllU3RyZWFtU291cmNlLnNjYWxh) | `68.67% <100.00%> (ø)` | `21.00 <0.00> (ø)` | |\n| [.../apache/hudi/sink/partitioner/BucketAssigners.java](https://codecov.io/gh/apache/hudi/pull/2819/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL3BhcnRpdGlvbmVyL0J1Y2tldEFzc2lnbmVycy5qYXZh) | `33.33% <0.00%> (-16.67%)` | `2.00% <0.00%> (ø%)` | |\n| [.../java/org/apache/hudi/common/util/CommitUtils.java](https://codecov.io/gh/apache/hudi/pull/2819/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3V0aWwvQ29tbWl0VXRpbHMuamF2YQ==) | `40.47% <0.00%> (-3.12%)` | `6.00% <0.00%> (ø%)` | |\n| [...java/org/apache/hudi/sink/StreamWriteFunction.java](https://codecov.io/gh/apache/hudi/pull/2819/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL1N0cmVhbVdyaXRlRnVuY3Rpb24uamF2YQ==) | `77.77% <0.00%> (-2.74%)` | `22.00% <0.00%> (ø%)` | |\n| [...g/apache/hudi/common/model/WriteOperationType.java](https://codecov.io/gh/apache/hudi/pull/2819/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL21vZGVsL1dyaXRlT3BlcmF0aW9uVHlwZS5qYXZh) | `50.00% <0.00%> (-1.43%)` | `2.00% <0.00%> (ø%)` | |\n| [...he/hudi/sink/partitioner/BucketAssignFunction.java](https://codecov.io/gh/apache/hudi/pull/2819/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL3BhcnRpdGlvbmVyL0J1Y2tldEFzc2lnbkZ1bmN0aW9uLmphdmE=) | `84.33% <0.00%> (-0.85%)` | `17.00% <0.00%> (ø%)` | |\n| [.../org/apache/hudi/sink/InstantGenerateOperator.java](https://codecov.io/gh/apache/hudi/pull/2819/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL0luc3RhbnRHZW5lcmF0ZU9wZXJhdG9yLmphdmE=) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (ø%)` | |\n| [...n/scala/org/apache/hudi/HoodieSparkSqlWriter.scala](https://codecov.io/gh/apache/hudi/pull/2819/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL0hvb2RpZVNwYXJrU3FsV3JpdGVyLnNjYWxh) | `58.52% <0.00%> (ø)` | `0.00% <0.00%> (ø%)` | |\n| ... and [3 more](https://codecov.io/gh/apache/hudi/pull/2819/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819291374/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819333455","html_url":"https://github.com/apache/hudi/issues/2688#issuecomment-819333455","issue_url":"https://api.github.com/repos/apache/hudi/issues/2688","id":819333455,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTMzMzQ1NQ==","user":{"login":"ismailsimsek","id":6005685,"node_id":"MDQ6VXNlcjYwMDU2ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6005685?v=4","gravatar_id":"","url":"https://api.github.com/users/ismailsimsek","html_url":"https://github.com/ismailsimsek","followers_url":"https://api.github.com/users/ismailsimsek/followers","following_url":"https://api.github.com/users/ismailsimsek/following{/other_user}","gists_url":"https://api.github.com/users/ismailsimsek/gists{/gist_id}","starred_url":"https://api.github.com/users/ismailsimsek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ismailsimsek/subscriptions","organizations_url":"https://api.github.com/users/ismailsimsek/orgs","repos_url":"https://api.github.com/users/ismailsimsek/repos","events_url":"https://api.github.com/users/ismailsimsek/events{/privacy}","received_events_url":"https://api.github.com/users/ismailsimsek/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T08:25:39Z","updated_at":"2021-05-04T12:43:04Z","author_association":"NONE","body":"this comment might help  https://github.com/apache/hudi/issues/1751#issuecomment-648481221\r\nadding this jars solved the error for me, solved the error with hudi v 0.7\r\n\r\n> org.apache.calcite\r\n> calcite-core\r\n> 1.16.0\r\n> \r\n> org.apache.thrift\r\n> libfb303\r\n> 0.9.3","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819333455/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819335030","html_url":"https://github.com/apache/hudi/issues/1679#issuecomment-819335030","issue_url":"https://api.github.com/repos/apache/hudi/issues/1679","id":819335030,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTMzNTAzMA==","user":{"login":"ismailsimsek","id":6005685,"node_id":"MDQ6VXNlcjYwMDU2ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6005685?v=4","gravatar_id":"","url":"https://api.github.com/users/ismailsimsek","html_url":"https://github.com/ismailsimsek","followers_url":"https://api.github.com/users/ismailsimsek/followers","following_url":"https://api.github.com/users/ismailsimsek/following{/other_user}","gists_url":"https://api.github.com/users/ismailsimsek/gists{/gist_id}","starred_url":"https://api.github.com/users/ismailsimsek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ismailsimsek/subscriptions","organizations_url":"https://api.github.com/users/ismailsimsek/orgs","repos_url":"https://api.github.com/users/ismailsimsek/repos","events_url":"https://api.github.com/users/ismailsimsek/events{/privacy}","received_events_url":"https://api.github.com/users/ismailsimsek/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T08:27:57Z","updated_at":"2021-04-14T08:27:57Z","author_association":"NONE","body":"this comment might help for the second error #1751 (comment)\r\n`java.lang.NoClassDefFoundError: org/apache/calcite/rel/type/RelDataTypeSystem`\r\n\r\n>     org.apache.calcite\r\n>     calcite-core\r\n>     1.16.0\r\n> \r\n>     org.apache.thrift\r\n>     libfb303\r\n>     0.9.3\r\n> ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819335030/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819369835","html_url":"https://github.com/apache/hudi/issues/2813#issuecomment-819369835","issue_url":"https://api.github.com/repos/apache/hudi/issues/2813","id":819369835,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTM2OTgzNQ==","user":{"login":"qianjiangbing","id":5980255,"node_id":"MDQ6VXNlcjU5ODAyNTU=","avatar_url":"https://avatars.githubusercontent.com/u/5980255?v=4","gravatar_id":"","url":"https://api.github.com/users/qianjiangbing","html_url":"https://github.com/qianjiangbing","followers_url":"https://api.github.com/users/qianjiangbing/followers","following_url":"https://api.github.com/users/qianjiangbing/following{/other_user}","gists_url":"https://api.github.com/users/qianjiangbing/gists{/gist_id}","starred_url":"https://api.github.com/users/qianjiangbing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qianjiangbing/subscriptions","organizations_url":"https://api.github.com/users/qianjiangbing/orgs","repos_url":"https://api.github.com/users/qianjiangbing/repos","events_url":"https://api.github.com/users/qianjiangbing/events{/privacy}","received_events_url":"https://api.github.com/users/qianjiangbing/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T09:18:24Z","updated_at":"2021-04-14T09:18:24Z","author_association":"NONE","body":"I use hive2.3.8 to test, it's ok!","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819369835/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819532968","html_url":"https://github.com/apache/hudi/issues/2797#issuecomment-819532968","issue_url":"https://api.github.com/repos/apache/hudi/issues/2797","id":819532968,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTUzMjk2OA==","user":{"login":"ismailsimsek","id":6005685,"node_id":"MDQ6VXNlcjYwMDU2ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6005685?v=4","gravatar_id":"","url":"https://api.github.com/users/ismailsimsek","html_url":"https://github.com/ismailsimsek","followers_url":"https://api.github.com/users/ismailsimsek/followers","following_url":"https://api.github.com/users/ismailsimsek/following{/other_user}","gists_url":"https://api.github.com/users/ismailsimsek/gists{/gist_id}","starred_url":"https://api.github.com/users/ismailsimsek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ismailsimsek/subscriptions","organizations_url":"https://api.github.com/users/ismailsimsek/orgs","repos_url":"https://api.github.com/users/ismailsimsek/repos","events_url":"https://api.github.com/users/ismailsimsek/events{/privacy}","received_events_url":"https://api.github.com/users/ismailsimsek/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T13:49:11Z","updated_at":"2021-04-14T13:49:11Z","author_association":"NONE","body":"its might be related to missing Glue database s3 path, the field is named  \"Amazon S3 path\"(lakeformation) or \"Location\"(glue) in aws console\r\n\r\nas far as i see at one point in code it is tryiong to construct a path like :  `getDatabasePath` +` tableName`\r\nin my case it was creating:  s3://MyBucketMytable  because of missing `/`. at the end of the database Location\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819532968/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819535304","html_url":"https://github.com/apache/hudi/issues/1909#issuecomment-819535304","issue_url":"https://api.github.com/repos/apache/hudi/issues/1909","id":819535304,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTUzNTMwNA==","user":{"login":"ismailsimsek","id":6005685,"node_id":"MDQ6VXNlcjYwMDU2ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6005685?v=4","gravatar_id":"","url":"https://api.github.com/users/ismailsimsek","html_url":"https://github.com/ismailsimsek","followers_url":"https://api.github.com/users/ismailsimsek/followers","following_url":"https://api.github.com/users/ismailsimsek/following{/other_user}","gists_url":"https://api.github.com/users/ismailsimsek/gists{/gist_id}","starred_url":"https://api.github.com/users/ismailsimsek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ismailsimsek/subscriptions","organizations_url":"https://api.github.com/users/ismailsimsek/orgs","repos_url":"https://api.github.com/users/ismailsimsek/repos","events_url":"https://api.github.com/users/ismailsimsek/events{/privacy}","received_events_url":"https://api.github.com/users/ismailsimsek/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T13:52:23Z","updated_at":"2021-04-14T13:52:23Z","author_association":"NONE","body":"probably related to https://github.com/apache/hudi/issues/2797#issuecomment-819532968","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819535304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819561416","html_url":"https://github.com/apache/hudi/issues/2802#issuecomment-819561416","issue_url":"https://api.github.com/repos/apache/hudi/issues/2802","id":819561416,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTU2MTQxNg==","user":{"login":"aditiwari01","id":16352977,"node_id":"MDQ6VXNlcjE2MzUyOTc3","avatar_url":"https://avatars.githubusercontent.com/u/16352977?v=4","gravatar_id":"","url":"https://api.github.com/users/aditiwari01","html_url":"https://github.com/aditiwari01","followers_url":"https://api.github.com/users/aditiwari01/followers","following_url":"https://api.github.com/users/aditiwari01/following{/other_user}","gists_url":"https://api.github.com/users/aditiwari01/gists{/gist_id}","starred_url":"https://api.github.com/users/aditiwari01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aditiwari01/subscriptions","organizations_url":"https://api.github.com/users/aditiwari01/orgs","repos_url":"https://api.github.com/users/aditiwari01/repos","events_url":"https://api.github.com/users/aditiwari01/events{/privacy}","received_events_url":"https://api.github.com/users/aditiwari01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T14:27:41Z","updated_at":"2021-04-14T14:28:30Z","author_association":"CONTRIBUTOR","body":"Hi @n3nash \r\n\r\nThe issue I am facing is in the case when commit gets succeeded. Let me explain the issue with an example:\r\n\r\nCommit1: insert key1 in partition1 and key2 in partition2 with schema1.\r\nCommit2: update key2 in partition2 with schema2\r\n\r\nIn this case the schema2 is registered successfully after commit2. But the issue is that the `AbstractRealtimeRecordReader` is not reading the latest schema of the table. `AbstractRealtimeRecordReader` tries to read the latest schema for each partition from that last edited log/parquet file.\r\n\r\nAs for the given example, the last edit in partition1 was with schema1. Hence the above code snippet that I have pasted in first comment, takes inn schema1 as writerSchema, causing the issue. (when split belongs to partition1)\r\n\r\nAlso I replace the said logic with taking writerSchema from TableSchemaResolver rather than log/parquet file and it solves the issue for me.\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819561416/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819693141","html_url":"https://github.com/apache/hudi/pull/2815#issuecomment-819693141","issue_url":"https://api.github.com/repos/apache/hudi/issues/2815","id":819693141,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTY5MzE0MQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T17:32:45Z","updated_at":"2021-04-14T17:32:45Z","author_association":"MEMBER","body":"Added! Will land once CI passes.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819693141/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819721513","html_url":"https://github.com/apache/hudi/pull/2645#issuecomment-819721513","issue_url":"https://api.github.com/repos/apache/hudi/issues/2645","id":819721513,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTcyMTUxMw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T18:01:01Z","updated_at":"2021-04-14T18:01:01Z","author_association":"MEMBER","body":"@pengzhiwei2018 are the tests passing? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819721513/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819764118","html_url":"https://github.com/apache/hudi/pull/2678#issuecomment-819764118","issue_url":"https://api.github.com/repos/apache/hudi/issues/2678","id":819764118,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTc2NDExOA==","user":{"login":"jsbali","id":1778470,"node_id":"MDQ6VXNlcjE3Nzg0NzA=","avatar_url":"https://avatars.githubusercontent.com/u/1778470?v=4","gravatar_id":"","url":"https://api.github.com/users/jsbali","html_url":"https://github.com/jsbali","followers_url":"https://api.github.com/users/jsbali/followers","following_url":"https://api.github.com/users/jsbali/following{/other_user}","gists_url":"https://api.github.com/users/jsbali/gists{/gist_id}","starred_url":"https://api.github.com/users/jsbali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jsbali/subscriptions","organizations_url":"https://api.github.com/users/jsbali/orgs","repos_url":"https://api.github.com/users/jsbali/repos","events_url":"https://api.github.com/users/jsbali/events{/privacy}","received_events_url":"https://api.github.com/users/jsbali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T19:09:15Z","updated_at":"2021-04-14T19:09:15Z","author_association":"CONTRIBUTOR","body":"@satishkotha I have made the changes as requested. PTAL","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819764118/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819764635","html_url":"https://github.com/apache/hudi/pull/2677#issuecomment-819764635","issue_url":"https://api.github.com/repos/apache/hudi/issues/2677","id":819764635,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTc2NDYzNQ==","user":{"login":"jsbali","id":1778470,"node_id":"MDQ6VXNlcjE3Nzg0NzA=","avatar_url":"https://avatars.githubusercontent.com/u/1778470?v=4","gravatar_id":"","url":"https://api.github.com/users/jsbali","html_url":"https://github.com/jsbali","followers_url":"https://api.github.com/users/jsbali/followers","following_url":"https://api.github.com/users/jsbali/following{/other_user}","gists_url":"https://api.github.com/users/jsbali/gists{/gist_id}","starred_url":"https://api.github.com/users/jsbali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jsbali/subscriptions","organizations_url":"https://api.github.com/users/jsbali/orgs","repos_url":"https://api.github.com/users/jsbali/repos","events_url":"https://api.github.com/users/jsbali/events{/privacy}","received_events_url":"https://api.github.com/users/jsbali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T19:10:03Z","updated_at":"2021-04-14T19:10:03Z","author_association":"CONTRIBUTOR","body":"@satishkotha I have made the changes as requested. PTAL","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819764635/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819770749","html_url":"https://github.com/apache/hudi/pull/2822#issuecomment-819770749","issue_url":"https://api.github.com/repos/apache/hudi/issues/2822","id":819770749,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTc3MDc0OQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T19:20:30Z","updated_at":"2021-04-14T19:20:30Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2822?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2822](https://codecov.io/gh/apache/hudi/pull/2822?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (5116b0c) into [master](https://codecov.io/gh/apache/hudi/commit/ab4a7b0b4afc66d2123c7f63fdab77b925a8a7f1?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (ab4a7b0) will **decrease** coverage by `9.33%`.\n> The diff coverage is `50.00%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2822/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2822?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2822      +/-   ##\n============================================\n- Coverage     61.96%   52.62%   -9.34%     \n- Complexity      335     3709    +3374     \n============================================\n  Files            54      485     +431     \n  Lines          1993    23210   +21217     \n  Branches        235     2463    +2228     \n============================================\n+ Hits           1235    12215   +10980     \n- Misses          638     9918    +9280     \n- Partials        120     1077     +957     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `40.29% <ø> (?)` | `215.00 <ø> (?)` | |\n| hudiclient | `∅ <ø> (?)` | `0.00 <ø> (?)` | |\n| hudicommon | `50.70% <ø> (?)` | `1977.00 <ø> (?)` | |\n| hudiflink | `56.54% <ø> (?)` | `516.00 <ø> (?)` | |\n| hudihadoopmr | `33.33% <ø> (?)` | `198.00 <ø> (?)` | |\n| hudisparkdatasource | `72.06% <ø> (?)` | `237.00 <ø> (?)` | |\n| hudisync | `46.00% <50.00%> (?)` | `131.00 <0.00> (?)` | |\n| huditimelineservice | `64.36% <ø> (?)` | `62.00 <ø> (?)` | |\n| hudiutilities | `69.79% <ø> (+7.82%)` | `373.00 <ø> (+38.00)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2822?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...main/java/org/apache/hudi/dla/HoodieDLAClient.java](https://codecov.io/gh/apache/hudi/pull/2822/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zeW5jL2h1ZGktZGxhLXN5bmMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvZGxhL0hvb2RpZURMQUNsaWVudC5qYXZh) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (?)` | |\n| [...in/java/org/apache/hudi/hive/HoodieHiveClient.java](https://codecov.io/gh/apache/hudi/pull/2822/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zeW5jL2h1ZGktaGl2ZS1zeW5jL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9odWRpL2hpdmUvSG9vZGllSGl2ZUNsaWVudC5qYXZh) | `74.57% <100.00%> (ø)` | `41.00 <0.00> (?)` | |\n| [...apache/hudi/utilities/deltastreamer/DeltaSync.java](https://codecov.io/gh/apache/hudi/pull/2822/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvRGVsdGFTeW5jLmphdmE=) | `71.08% <0.00%> (-0.35%)` | `55.00% <0.00%> (-1.00%)` | |\n| [...pache/hudi/internal/HoodieWriterCommitMessage.java](https://codecov.io/gh/apache/hudi/pull/2822/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3BhcmsyL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9odWRpL2ludGVybmFsL0hvb2RpZVdyaXRlckNvbW1pdE1lc3NhZ2UuamF2YQ==) | `100.00% <0.00%> (ø)` | `1.00% <0.00%> (?%)` | |\n| [...nal/HoodieBulkInsertDataInternalWriterFactory.java](https://codecov.io/gh/apache/hudi/pull/2822/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3BhcmszL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9odWRpL3NwYXJrMy9pbnRlcm5hbC9Ib29kaWVCdWxrSW5zZXJ0RGF0YUludGVybmFsV3JpdGVyRmFjdG9yeS5qYXZh) | `100.00% <0.00%> (ø)` | `2.00% <0.00%> (?%)` | |\n| [.../apache/hudi/common/fs/ConsistencyGuardConfig.java](https://codecov.io/gh/apache/hudi/pull/2822/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2ZzL0NvbnNpc3RlbmN5R3VhcmRDb25maWcuamF2YQ==) | `37.77% <0.00%> (ø)` | `4.00% <0.00%> (?%)` | |\n| [...org/apache/hudi/common/config/TypedProperties.java](https://codecov.io/gh/apache/hudi/pull/2822/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2NvbmZpZy9UeXBlZFByb3BlcnRpZXMuamF2YQ==) | `89.65% <0.00%> (ø)` | `21.00% <0.00%> (?%)` | |\n| [...rg/apache/hudi/metadata/HoodieMetadataMetrics.java](https://codecov.io/gh/apache/hudi/pull/2822/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvbWV0YWRhdGEvSG9vZGllTWV0YWRhdGFNZXRyaWNzLmphdmE=) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (?%)` | |\n| [...a/org/apache/hudi/avro/HoodieAvroWriteSupport.java](https://codecov.io/gh/apache/hudi/pull/2822/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvYXZyby9Ib29kaWVBdnJvV3JpdGVTdXBwb3J0LmphdmE=) | `90.00% <0.00%> (ø)` | `8.00% <0.00%> (?%)` | |\n| [...rg/apache/hudi/streamer/HoodieFlinkStreamerV2.java](https://codecov.io/gh/apache/hudi/pull/2822/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zdHJlYW1lci9Ib29kaWVGbGlua1N0cmVhbWVyVjIuamF2YQ==) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (?%)` | |\n| ... and [429 more](https://codecov.io/gh/apache/hudi/pull/2822/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819770749/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819792823","html_url":"https://github.com/apache/hudi/issues/2820#issuecomment-819792823","issue_url":"https://api.github.com/repos/apache/hudi/issues/2820","id":819792823,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTc5MjgyMw==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T19:57:31Z","updated_at":"2021-04-14T19:57:31Z","author_association":"CONTRIBUTOR","body":"@ismailsimsek Can you paste the command you are using to start your spark-shell (assuming that's what you are using here to ingest to a hudi table) ?\r\n\r\nIt should be something like this for Spark 3.x\r\n\r\n```\r\nspark-shell \\\r\n  --packages org.apache.hudi:hudi-spark3-bundle_2.12:0.8.0,org.apache.spark:spark-avro_2.12:3.0.1 \\\r\n  --conf 'spark.serializer=org.apache.spark.serializer.KryoSerializer'\r\n```\r\n\r\nThis can also be found at https://hudi.apache.org/docs/spark_quick-start-guide.html#setup","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819792823/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819896025","html_url":"https://github.com/apache/hudi/pull/2677#issuecomment-819896025","issue_url":"https://api.github.com/repos/apache/hudi/issues/2677","id":819896025,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTg5NjAyNQ==","user":{"login":"satishkotha","id":2992755,"node_id":"MDQ6VXNlcjI5OTI3NTU=","avatar_url":"https://avatars.githubusercontent.com/u/2992755?v=4","gravatar_id":"","url":"https://api.github.com/users/satishkotha","html_url":"https://github.com/satishkotha","followers_url":"https://api.github.com/users/satishkotha/followers","following_url":"https://api.github.com/users/satishkotha/following{/other_user}","gists_url":"https://api.github.com/users/satishkotha/gists{/gist_id}","starred_url":"https://api.github.com/users/satishkotha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/satishkotha/subscriptions","organizations_url":"https://api.github.com/users/satishkotha/orgs","repos_url":"https://api.github.com/users/satishkotha/repos","events_url":"https://api.github.com/users/satishkotha/events{/privacy}","received_events_url":"https://api.github.com/users/satishkotha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T22:42:26Z","updated_at":"2021-04-14T22:42:46Z","author_association":"MEMBER","body":"> @satishkotha I have made the changes as requested. PTAL\r\n\r\n@jsbali LGTM. thanks for improving test coverage. Can you resolve git conflicts below? I can merge after that","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819896025/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819896794","html_url":"https://github.com/apache/hudi/pull/2678#issuecomment-819896794","issue_url":"https://api.github.com/repos/apache/hudi/issues/2678","id":819896794,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTg5Njc5NA==","user":{"login":"satishkotha","id":2992755,"node_id":"MDQ6VXNlcjI5OTI3NTU=","avatar_url":"https://avatars.githubusercontent.com/u/2992755?v=4","gravatar_id":"","url":"https://api.github.com/users/satishkotha","html_url":"https://github.com/satishkotha","followers_url":"https://api.github.com/users/satishkotha/followers","following_url":"https://api.github.com/users/satishkotha/following{/other_user}","gists_url":"https://api.github.com/users/satishkotha/gists{/gist_id}","starred_url":"https://api.github.com/users/satishkotha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/satishkotha/subscriptions","organizations_url":"https://api.github.com/users/satishkotha/orgs","repos_url":"https://api.github.com/users/satishkotha/repos","events_url":"https://api.github.com/users/satishkotha/events{/privacy}","received_events_url":"https://api.github.com/users/satishkotha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T22:44:42Z","updated_at":"2021-04-14T22:44:42Z","author_association":"MEMBER","body":"@jsbali looks like there are test failures? Can you please fix them? I can review after that.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819896794/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819901171","html_url":"https://github.com/apache/hudi/issues/1751#issuecomment-819901171","issue_url":"https://api.github.com/repos/apache/hudi/issues/1751","id":819901171,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTkwMTE3MQ==","user":{"login":"dszakallas","id":5807322,"node_id":"MDQ6VXNlcjU4MDczMjI=","avatar_url":"https://avatars.githubusercontent.com/u/5807322?v=4","gravatar_id":"","url":"https://api.github.com/users/dszakallas","html_url":"https://github.com/dszakallas","followers_url":"https://api.github.com/users/dszakallas/followers","following_url":"https://api.github.com/users/dszakallas/following{/other_user}","gists_url":"https://api.github.com/users/dszakallas/gists{/gist_id}","starred_url":"https://api.github.com/users/dszakallas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dszakallas/subscriptions","organizations_url":"https://api.github.com/users/dszakallas/orgs","repos_url":"https://api.github.com/users/dszakallas/repos","events_url":"https://api.github.com/users/dszakallas/events{/privacy}","received_events_url":"https://api.github.com/users/dszakallas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-14T22:55:34Z","updated_at":"2021-04-14T22:55:34Z","author_association":"NONE","body":"I am getting the same `java.lang.NoClassDefFoundError: org/apache/calcite/rel/type/RelDataTypeSystem` when trying to use Hive sync. It looks like Spark 3 is using a custom class loading mechanism for loading Hive: \r\n.https://github.com/apache/spark/blob/ab93729987084ec55f762639a7e7f7cb8dd275e1/sql/hive/src/main/scala/org/apache/spark/sql/hive/client/IsolatedClientLoader.scala#L170\r\nI think this might cause some classes to be loaded only if they are coming from one of the exec jars, which I assume are the jars shipped with Spark.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819901171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819953659","html_url":"https://github.com/apache/hudi/issues/2609#issuecomment-819953659","issue_url":"https://api.github.com/repos/apache/hudi/issues/2609","id":819953659,"node_id":"MDEyOklzc3VlQ29tbWVudDgxOTk1MzY1OQ==","user":{"login":"njalan","id":8622340,"node_id":"MDQ6VXNlcjg2MjIzNDA=","avatar_url":"https://avatars.githubusercontent.com/u/8622340?v=4","gravatar_id":"","url":"https://api.github.com/users/njalan","html_url":"https://github.com/njalan","followers_url":"https://api.github.com/users/njalan/followers","following_url":"https://api.github.com/users/njalan/following{/other_user}","gists_url":"https://api.github.com/users/njalan/gists{/gist_id}","starred_url":"https://api.github.com/users/njalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/njalan/subscriptions","organizations_url":"https://api.github.com/users/njalan/orgs","repos_url":"https://api.github.com/users/njalan/repos","events_url":"https://api.github.com/users/njalan/events{/privacy}","received_events_url":"https://api.github.com/users/njalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T01:29:00Z","updated_at":"2021-04-15T01:29:00Z","author_association":"NONE","body":"@tooptoop4 Thanks for your reply","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/819953659/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820006638","html_url":"https://github.com/apache/hudi/pull/2645#issuecomment-820006638","issue_url":"https://api.github.com/repos/apache/hudi/issues/2645","id":820006638,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDAwNjYzOA==","user":{"login":"pengzhiwei2018","id":42458891,"node_id":"MDQ6VXNlcjQyNDU4ODkx","avatar_url":"https://avatars.githubusercontent.com/u/42458891?v=4","gravatar_id":"","url":"https://api.github.com/users/pengzhiwei2018","html_url":"https://github.com/pengzhiwei2018","followers_url":"https://api.github.com/users/pengzhiwei2018/followers","following_url":"https://api.github.com/users/pengzhiwei2018/following{/other_user}","gists_url":"https://api.github.com/users/pengzhiwei2018/gists{/gist_id}","starred_url":"https://api.github.com/users/pengzhiwei2018/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pengzhiwei2018/subscriptions","organizations_url":"https://api.github.com/users/pengzhiwei2018/orgs","repos_url":"https://api.github.com/users/pengzhiwei2018/repos","events_url":"https://api.github.com/users/pengzhiwei2018/events{/privacy}","received_events_url":"https://api.github.com/users/pengzhiwei2018/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T02:16:16Z","updated_at":"2021-04-15T02:16:16Z","author_association":"NONE","body":"> @pengzhiwei2018 are the tests passing?\r\n\r\nHi @vinothchandar , It seems that there is a leak of `KafkaTestUtils` in `TestHoodieDeltaStreamer`. This can happen by accident. I will add a teardown for `KafkaTestUtils` in `TestHoodieDeltaStreamer` and have a try.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820006638/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820013737","html_url":"https://github.com/apache/hudi/pull/2136#issuecomment-820013737","issue_url":"https://api.github.com/repos/apache/hudi/issues/2136","id":820013737,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDAxMzczNw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T02:35:44Z","updated_at":"2021-04-15T02:35:44Z","author_association":"MEMBER","body":"Closing this PR, in favor of new approach. \r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820013737/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820086280","html_url":"https://github.com/apache/hudi/pull/2825#issuecomment-820086280","issue_url":"https://api.github.com/repos/apache/hudi/issues/2825","id":820086280,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDA4NjI4MA==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T04:29:29Z","updated_at":"2021-04-15T04:29:29Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2825?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2825](https://codecov.io/gh/apache/hudi/pull/2825?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (eb248cf) into [master](https://codecov.io/gh/apache/hudi/commit/62bb9e10d9d2f2a9807ee46b0ed094ef2fcc89e5?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (62bb9e1) will **decrease** coverage by `43.21%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2825/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2825?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@             Coverage Diff              @@\n##             master   #2825       +/-   ##\n============================================\n- Coverage     52.60%   9.38%   -43.22%     \n+ Complexity     3709      48     -3661     \n============================================\n  Files           485      54      -431     \n  Lines         23224    1993    -21231     \n  Branches       2465     235     -2230     \n============================================\n- Hits          12216     187    -12029     \n+ Misses         9929    1793     -8136     \n+ Partials       1079      13     -1066     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `?` | `?` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `9.38% <ø> (-60.42%)` | `48.00 <ø> (-325.00)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2825?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...va/org/apache/hudi/utilities/IdentitySplitter.java](https://codecov.io/gh/apache/hudi/pull/2825/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0lkZW50aXR5U3BsaXR0ZXIuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-2.00%)` | |\n| [...va/org/apache/hudi/utilities/schema/SchemaSet.java](https://codecov.io/gh/apache/hudi/pull/2825/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFTZXQuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-3.00%)` | |\n| [...a/org/apache/hudi/utilities/sources/RowSource.java](https://codecov.io/gh/apache/hudi/pull/2825/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUm93U291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [.../org/apache/hudi/utilities/sources/AvroSource.java](https://codecov.io/gh/apache/hudi/pull/2825/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQXZyb1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [.../org/apache/hudi/utilities/sources/JsonSource.java](https://codecov.io/gh/apache/hudi/pull/2825/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvblNvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [...rg/apache/hudi/utilities/sources/CsvDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2825/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQ3N2REZTU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-10.00%)` | |\n| [...g/apache/hudi/utilities/sources/JsonDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2825/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkRGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [...apache/hudi/utilities/sources/JsonKafkaSource.java](https://codecov.io/gh/apache/hudi/pull/2825/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkthZmthU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-6.00%)` | |\n| [...pache/hudi/utilities/sources/ParquetDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2825/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUGFycXVldERGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-5.00%)` | |\n| [...lities/schema/SchemaProviderWithPostProcessor.java](https://codecov.io/gh/apache/hudi/pull/2825/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFQcm92aWRlcldpdGhQb3N0UHJvY2Vzc29yLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| ... and [461 more](https://codecov.io/gh/apache/hudi/pull/2825/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820086280/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820091027","html_url":"https://github.com/apache/hudi/pull/2821#issuecomment-820091027","issue_url":"https://api.github.com/repos/apache/hudi/issues/2821","id":820091027,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDA5MTAyNw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T04:44:59Z","updated_at":"2021-04-15T04:44:59Z","author_association":"MEMBER","body":"Can we do a `[MINOR]` tag consistent with our current processes? Happy to discuss a `HOTFIX` label on the dev list and add to docs, if one of you are interested in making the case for it.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820091027/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820108781","html_url":"https://github.com/apache/hudi/pull/2828#issuecomment-820108781","issue_url":"https://api.github.com/repos/apache/hudi/issues/2828","id":820108781,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDEwODc4MQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T05:20:15Z","updated_at":"2021-04-15T05:20:15Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2828?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2828](https://codecov.io/gh/apache/hudi/pull/2828?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (c709f11) into [master](https://codecov.io/gh/apache/hudi/commit/62bb9e10d9d2f2a9807ee46b0ed094ef2fcc89e5?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (62bb9e1) will **decrease** coverage by `43.21%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2828/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2828?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@             Coverage Diff              @@\n##             master   #2828       +/-   ##\n============================================\n- Coverage     52.60%   9.38%   -43.22%     \n+ Complexity     3709      48     -3661     \n============================================\n  Files           485      54      -431     \n  Lines         23224    1993    -21231     \n  Branches       2465     235     -2230     \n============================================\n- Hits          12216     187    -12029     \n+ Misses         9929    1793     -8136     \n+ Partials       1079      13     -1066     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `?` | `?` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `9.38% <ø> (-60.42%)` | `48.00 <ø> (-325.00)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2828?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...va/org/apache/hudi/utilities/IdentitySplitter.java](https://codecov.io/gh/apache/hudi/pull/2828/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0lkZW50aXR5U3BsaXR0ZXIuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-2.00%)` | |\n| [...va/org/apache/hudi/utilities/schema/SchemaSet.java](https://codecov.io/gh/apache/hudi/pull/2828/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFTZXQuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-3.00%)` | |\n| [...a/org/apache/hudi/utilities/sources/RowSource.java](https://codecov.io/gh/apache/hudi/pull/2828/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUm93U291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [.../org/apache/hudi/utilities/sources/AvroSource.java](https://codecov.io/gh/apache/hudi/pull/2828/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQXZyb1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [.../org/apache/hudi/utilities/sources/JsonSource.java](https://codecov.io/gh/apache/hudi/pull/2828/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvblNvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [...rg/apache/hudi/utilities/sources/CsvDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2828/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQ3N2REZTU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-10.00%)` | |\n| [...g/apache/hudi/utilities/sources/JsonDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2828/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkRGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [...apache/hudi/utilities/sources/JsonKafkaSource.java](https://codecov.io/gh/apache/hudi/pull/2828/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkthZmthU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-6.00%)` | |\n| [...pache/hudi/utilities/sources/ParquetDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2828/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUGFycXVldERGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-5.00%)` | |\n| [...lities/schema/SchemaProviderWithPostProcessor.java](https://codecov.io/gh/apache/hudi/pull/2828/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFQcm92aWRlcldpdGhQb3N0UHJvY2Vzc29yLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| ... and [462 more](https://codecov.io/gh/apache/hudi/pull/2828/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820108781/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820132727","html_url":"https://github.com/apache/hudi/pull/2828#issuecomment-820132727","issue_url":"https://api.github.com/repos/apache/hudi/issues/2828","id":820132727,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDEzMjcyNw==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T05:47:47Z","updated_at":"2021-04-15T05:47:47Z","author_association":"CONTRIBUTOR","body":"@MINCWANG Thanks for your contribution. Would you please file a jira issue to track this change?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820132727/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820136034","html_url":"https://github.com/apache/hudi/pull/2828#issuecomment-820136034","issue_url":"https://api.github.com/repos/apache/hudi/issues/2828","id":820136034,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDEzNjAzNA==","user":{"login":"minchowang","id":33626973,"node_id":"MDQ6VXNlcjMzNjI2OTcz","avatar_url":"https://avatars.githubusercontent.com/u/33626973?v=4","gravatar_id":"","url":"https://api.github.com/users/minchowang","html_url":"https://github.com/minchowang","followers_url":"https://api.github.com/users/minchowang/followers","following_url":"https://api.github.com/users/minchowang/following{/other_user}","gists_url":"https://api.github.com/users/minchowang/gists{/gist_id}","starred_url":"https://api.github.com/users/minchowang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/minchowang/subscriptions","organizations_url":"https://api.github.com/users/minchowang/orgs","repos_url":"https://api.github.com/users/minchowang/repos","events_url":"https://api.github.com/users/minchowang/events{/privacy}","received_events_url":"https://api.github.com/users/minchowang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T05:55:06Z","updated_at":"2021-04-15T05:55:06Z","author_association":"CONTRIBUTOR","body":"> @MINCWANG Thanks for your contribution. Would you please file a jira issue to track this change?\r\n\r\n@yanghua     OK, This jira address: https://issues.apache.org/jira/browse/HUDI-1797","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820136034/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820146127","html_url":"https://github.com/apache/hudi/issues/2818#issuecomment-820146127","issue_url":"https://api.github.com/repos/apache/hudi/issues/2818","id":820146127,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDE0NjEyNw==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T06:16:10Z","updated_at":"2021-04-15T06:16:10Z","author_association":"CONTRIBUTOR","body":"@ssdong Thanks for the detailed description of the problem and how to reproduce this. First, it looks like there is an issue in `MergeOnReadIncrementalRelation` that is resulting in `NoSuchElementException`. @garyli1019 Can you take a look at this one ?\r\n\r\nSecond, yes, if the commit is archived before you could `incrementally pull` the changes, you will not be able to pull the changes happening between that specific range in it. However, this should not mean you will have data loss. In this case, you will miss the intermediate changes that might have happened between few commits, but if your checkpoint has not changed, incremental pull will provide you the \"latest\" changes that are present after your current checkpoint. \r\nI do need to confirm what happens if the commit time provided is way in the past and not in the hudi timeline.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820146127/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820150010","html_url":"https://github.com/apache/hudi/issues/2787#issuecomment-820150010","issue_url":"https://api.github.com/repos/apache/hudi/issues/2787","id":820150010,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDE1MDAxMA==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T06:23:58Z","updated_at":"2021-04-15T06:23:58Z","author_association":"CONTRIBUTOR","body":"This does look like related to some files having incompatible schema. @rubenssoto\r\n1) Is this a tables boostrapped into hudi or is this a new hudi tables ?\r\n2) Is this problem repeatable or happens intermittently ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820150010/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820151588","html_url":"https://github.com/apache/hudi/issues/2797#issuecomment-820151588","issue_url":"https://api.github.com/repos/apache/hudi/issues/2797","id":820151588,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDE1MTU4OA==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T06:26:55Z","updated_at":"2021-04-15T06:27:37Z","author_association":"CONTRIBUTOR","body":"@ismailsimsek Are you saying it was fixed after you fixed the databasePath / location in your glue metastore to include `/` ? Is the `/` expected always at the end of the path ? If yes, we can probably put in that fix in hudi hive sync.\r\n\r\n@vansimonsen Can you check if this is the root cause for you ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820151588/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820153027","html_url":"https://github.com/apache/hudi/issues/2802#issuecomment-820153027","issue_url":"https://api.github.com/repos/apache/hudi/issues/2802","id":820153027,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDE1MzAyNw==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T06:29:36Z","updated_at":"2021-04-15T06:29:36Z","author_association":"CONTRIBUTOR","body":"@aditiwari01 Thanks for that explanation. Can you please add the failure message / exception that you see with the current code ? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820153027/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820155041","html_url":"https://github.com/apache/hudi/issues/2806#issuecomment-820155041","issue_url":"https://api.github.com/repos/apache/hudi/issues/2806","id":820155041,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDE1NTA0MQ==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T06:33:16Z","updated_at":"2021-04-15T06:33:16Z","author_association":"CONTRIBUTOR","body":"@tmac2100 Thanks for those details, they are very helpful to understand your job. I need one more information before I can understand the root cause, can you please put a screenshot of the \"stages\" tab of the spark application that took 16 hours ? I want to understand which stages took this much time, my hunch is this should be the spark stages related to BloomIndex in which case either a) Your bloom index is not configured correctly leading to lots of false positives and hence longer stage times b) You 20% updates are spanning 100s of partitions leading to a lot of bloom index lookups..","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820155041/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820155577","html_url":"https://github.com/apache/hudi/issues/2811#issuecomment-820155577","issue_url":"https://api.github.com/repos/apache/hudi/issues/2811","id":820155577,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDE1NTU3Nw==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T06:34:13Z","updated_at":"2021-04-15T06:34:13Z","author_association":"CONTRIBUTOR","body":"@vburenin Are you able to help out here ? Looks like a GCS related issue which you are more familiar with","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820155577/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820156418","html_url":"https://github.com/apache/hudi/issues/2812#issuecomment-820156418","issue_url":"https://api.github.com/repos/apache/hudi/issues/2812","id":820156418,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDE1NjQxOA==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T06:35:41Z","updated_at":"2021-04-15T06:35:41Z","author_association":"CONTRIBUTOR","body":"Okay, do you mind re-opening that Spark ticket and asking a question there ? Other options are to try a different Spark build to confirm that this is a spark issue and should probably go away with a different build (may be 2.4)","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820156418/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820157419","html_url":"https://github.com/apache/hudi/issues/2802#issuecomment-820157419","issue_url":"https://api.github.com/repos/apache/hudi/issues/2802","id":820157419,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDE1NzQxOQ==","user":{"login":"aditiwari01","id":16352977,"node_id":"MDQ6VXNlcjE2MzUyOTc3","avatar_url":"https://avatars.githubusercontent.com/u/16352977?v=4","gravatar_id":"","url":"https://api.github.com/users/aditiwari01","html_url":"https://github.com/aditiwari01","followers_url":"https://api.github.com/users/aditiwari01/followers","following_url":"https://api.github.com/users/aditiwari01/following{/other_user}","gists_url":"https://api.github.com/users/aditiwari01/gists{/gist_id}","starred_url":"https://api.github.com/users/aditiwari01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aditiwari01/subscriptions","organizations_url":"https://api.github.com/users/aditiwari01/orgs","repos_url":"https://api.github.com/users/aditiwari01/repos","events_url":"https://api.github.com/users/aditiwari01/events{/privacy}","received_events_url":"https://api.github.com/users/aditiwari01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T06:37:31Z","updated_at":"2021-04-15T06:37:31Z","author_association":"CONTRIBUTOR","body":"Actually we get Null pointer exceptionn when trying to get when we try to create readerSchema from writer schema and projectedFields, because the new column would present in projectedFields but not in writer schema.\r\n\r\nI'm bit busy for next couple of days. Currently we're using the fix I've mentioned. Will try to rebuild with latest code and reproduce the issue and add the exact stack here in next few days.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820157419/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820160205","html_url":"https://github.com/apache/hudi/issues/2633#issuecomment-820160205","issue_url":"https://api.github.com/repos/apache/hudi/issues/2633","id":820160205,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDE2MDIwNQ==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T06:42:44Z","updated_at":"2021-04-15T06:42:44Z","author_association":"CONTRIBUTOR","body":"I've filed a ticket here -> https://issues.apache.org/jira/browse/HUDI-1800. Let's move the discussion and solution there.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820160205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820180331","html_url":"https://github.com/apache/hudi/issues/2818#issuecomment-820180331","issue_url":"https://api.github.com/repos/apache/hudi/issues/2818","id":820180331,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDE4MDMzMQ==","user":{"login":"ssdong","id":3754011,"node_id":"MDQ6VXNlcjM3NTQwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/3754011?v=4","gravatar_id":"","url":"https://api.github.com/users/ssdong","html_url":"https://github.com/ssdong","followers_url":"https://api.github.com/users/ssdong/followers","following_url":"https://api.github.com/users/ssdong/following{/other_user}","gists_url":"https://api.github.com/users/ssdong/gists{/gist_id}","starred_url":"https://api.github.com/users/ssdong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ssdong/subscriptions","organizations_url":"https://api.github.com/users/ssdong/orgs","repos_url":"https://api.github.com/users/ssdong/repos","events_url":"https://api.github.com/users/ssdong/events{/privacy}","received_events_url":"https://api.github.com/users/ssdong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T07:17:09Z","updated_at":"2021-04-15T07:17:09Z","author_association":"CONTRIBUTOR","body":"@n3nash Thank you for getting back to me. Let me know if you need extra manpower to help fix `MergeOnReadIncrementalRelation`. :)\r\n\r\nAs for the second issue, thank you for providing extra insights into this, and I understand your point that if the checkpoint has not changed; once there is another \"latest\" change, it will surely pull that out for me incrementally given it will be on the active timeline again. However, what if the \"intermediate\" changes are supposed to the \"last\" changes to the records, and the archival puts them in an _invisible_ state? 🤔And will the checkpoint stay the same all the time? \r\nRight now, it seems like the relationship between archived/active timeline and incremental pull _requires_ the user to have a carefully controlled incremental pull interval to get all updates before it gets archived, and I wonder if that's easy to achieve? Just throwing a bunch of my thoughts and concerns, and please do let me know what you find regarding commit time provided is way in the past and not in the hudi timeline. 😅 ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820180331/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820287948","html_url":"https://github.com/apache/hudi/issues/2656#issuecomment-820287948","issue_url":"https://api.github.com/repos/apache/hudi/issues/2656","id":820287948,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDI4Nzk0OA==","user":{"login":"Kyofin","id":18548053,"node_id":"MDQ6VXNlcjE4NTQ4MDUz","avatar_url":"https://avatars.githubusercontent.com/u/18548053?v=4","gravatar_id":"","url":"https://api.github.com/users/Kyofin","html_url":"https://github.com/Kyofin","followers_url":"https://api.github.com/users/Kyofin/followers","following_url":"https://api.github.com/users/Kyofin/following{/other_user}","gists_url":"https://api.github.com/users/Kyofin/gists{/gist_id}","starred_url":"https://api.github.com/users/Kyofin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kyofin/subscriptions","organizations_url":"https://api.github.com/users/Kyofin/orgs","repos_url":"https://api.github.com/users/Kyofin/repos","events_url":"https://api.github.com/users/Kyofin/events{/privacy}","received_events_url":"https://api.github.com/users/Kyofin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T09:45:34Z","updated_at":"2021-04-15T09:45:34Z","author_association":"NONE","body":"I have the same problem. \r\nwhen i set insert operation to hudi, I expect the result has 10 records,but there is 8 records .\r\nIt just like upsert opt.\r\n```\r\n    val spark = SparkSession.builder()\r\n      .master(\"local[*]\")\r\n      .config(\"spark.serializer\", \"org.apache.spark.serializer.KryoSerializer\")\r\n      // Uses Hive SerDe, this is mandatory for MoR tables\r\n      .config(\"spark.sql.hive.convertMetastoreParquet\", \"false\")\r\n      .config(\"spark.hadoop.fs.defaultFS\", \"hdfs://hadoop-master:8020\")\r\n      .getOrCreate()\r\n\r\n    val tableName = \"hudi_archive_insert\"\r\n    val basePath = \"/tmp/hudi/\"+tableName\r\n\r\n    val inserts = List(\r\n      \"\"\"{\"id\" : 1,  \"name\": \"iteblog1\", \"age\" : 101, \"ts\" : 1, \"dt\" : \"20191212\"}\"\"\",\r\n      \"\"\"{\"id\" : 1,  \"name\": \"iteblog2\", \"age\" : 101, \"ts\" : 2, \"dt\" : \"20191212\"}\"\"\",\r\n      \"\"\"{\"id\" : 1,  \"name\": \"iteblog3\", \"age\" : 101, \"ts\" : 3, \"dt\" : \"20191212\"}\"\"\",\r\n      \"\"\"{\"id\" : 3, \"name\": \"hudi2\", \"age\" : 103, \"ts\" : 1, \"dt\" : \"20191212\"}\"\"\",\r\n      \"\"\"{\"id\" : 2, \"name\": \"iteblog_hadoop2\", \"age\" : 102, \"ts\" : 3, \"dt\" : \"20191213\"}\"\"\",\r\n      \"\"\"{\"id\" : 1, \"name\": \"flink2\", \"age\" : 102, \"ts\" : 1, \"dt\" : \"20191213\"}\"\"\"\r\n    )\r\n\r\n    insert(spark, inserts, tableName, basePath)\r\n\r\n    val inserts2 = List(\r\n      \"\"\"{\"id\" : 4,  \"name\": \"Dingding\", \"age\" : 101, \"ts\" : 1, \"dt\" : \"20191212\"}\"\"\",\r\n      \"\"\"{\"id\" : 5,  \"name\": \"Kugou\", \"age\" : 101, \"ts\" : 2, \"dt\" : \"20191212\"}\"\"\",\r\n      \"\"\"{\"id\" : 2, \"name\": \"Mumu\", \"age\" : 102, \"ts\" : 1, \"dt\" : \"20191213\"}\"\"\",\r\n      \"\"\"{\"id\" : 2, \"name\": \"Mumu2\", \"age\" : 102, \"ts\" : 2, \"dt\" : \"20191213\"}\"\"\"\r\n    )\r\n\r\n    insert(spark, inserts2, tableName, basePath)\r\n\r\n    val df = spark.read.format(\"org.apache.hudi\").load(basePath + \"/*\")\r\n    df.show()\r\n//    +-------------------+--------------------+------------------+----------------------+--------------------+---+--------+---+--------+---+\r\n//    |_hoodie_commit_time|_hoodie_commit_seqno|_hoodie_record_key|_hoodie_partition_path|   _hoodie_file_name|age|      dt| id|    name| ts|\r\n//    +-------------------+--------------------+------------------+----------------------+--------------------+---+--------+---+--------+---+\r\n//    |     20210415173137|  20210415173137_1_1|                 1|              20191212|87062f4a-1de0-416...|101|20191212|  1|iteblog3|  3|\r\n//    |     20210415173137|  20210415173137_1_3|                 1|              20191212|87062f4a-1de0-416...|101|20191212|  1|iteblog3|  3|\r\n//    |     20210415173137|  20210415173137_1_5|                 1|              20191212|87062f4a-1de0-416...|101|20191212|  1|iteblog3|  3|\r\n//    |     20210415173137|  20210415173137_1_6|                 3|              20191212|87062f4a-1de0-416...|103|20191212|  3|   hudi2|  1|\r\n//    |     20210415173144|  20210415173144_1_8|                 4|              20191212|87062f4a-1de0-416...|101|20191212|  4|Dingding|  1|\r\n//    |     20210415173144|  20210415173144_1_9|                 5|              20191212|87062f4a-1de0-416...|101|20191212|  5|   Kugou|  2|\r\n//    |     20210415173144|  20210415173144_0_7|                 2|              20191213|f93a2c86-8eda-4cc...|102|20191213|  2|   Mumu2|  2|\r\n//    |     20210415173137|  20210415173137_0_4|                 1|              20191213|f93a2c86-8eda-4cc...|102|20191213|  1|  flink2|  1|\r\n//      +-------------------+--------------------+------------------+----------------------+--------------------+---+--------+---+--------+---+\r\n\r\n    spark.stop()\r\n  }\r\n\r\n  def insert(spark: SparkSession, inserts: List[String], tableName: String, basePath: String) = {\r\n\r\n    val df = spark.read.json(spark.sparkContext.parallelize(inserts, 2))\r\n\r\n    df.write.format(\"org.apache.hudi\")\r\n      .option(DataSourceWriteOptions.PRECOMBINE_FIELD_OPT_KEY, \"ts\")\r\n      .option(DataSourceWriteOptions.RECORDKEY_FIELD_OPT_KEY, \"id\")\r\n      .option(DataSourceWriteOptions.PARTITIONPATH_FIELD_OPT_KEY, \"dt\")\r\n      .option(DataSourceWriteOptions.OPERATION_OPT_KEY, DataSourceWriteOptions.INSERT_OPERATION_OPT_VAL)\r\n      .option(HoodieWriteConfig.TABLE_NAME, tableName)\r\n      // Set this to a lower value to improve performance.\r\n      .option(\"hoodie.insert.shuffle.parallelism\", \"2\")\r\n      .mode(\"append\")\r\n      .save(basePath)\r\n\r\n  }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820287948/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820315925","html_url":"https://github.com/apache/hudi/issues/1751#issuecomment-820315925","issue_url":"https://api.github.com/repos/apache/hudi/issues/1751","id":820315925,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDMxNTkyNQ==","user":{"login":"dszakallas","id":5807322,"node_id":"MDQ6VXNlcjU4MDczMjI=","avatar_url":"https://avatars.githubusercontent.com/u/5807322?v=4","gravatar_id":"","url":"https://api.github.com/users/dszakallas","html_url":"https://github.com/dszakallas","followers_url":"https://api.github.com/users/dszakallas/followers","following_url":"https://api.github.com/users/dszakallas/following{/other_user}","gists_url":"https://api.github.com/users/dszakallas/gists{/gist_id}","starred_url":"https://api.github.com/users/dszakallas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dszakallas/subscriptions","organizations_url":"https://api.github.com/users/dszakallas/orgs","repos_url":"https://api.github.com/users/dszakallas/repos","events_url":"https://api.github.com/users/dszakallas/events{/privacy}","received_events_url":"https://api.github.com/users/dszakallas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T10:27:02Z","updated_at":"2021-04-15T11:25:01Z","author_association":"NONE","body":"I resolved the issue by deleting these two exclusions from Spark: https://github.com/apache/spark/blob/v3.0.1/pom.xml#L1692-L1699. After that calcite-core becomes part of the distribution. After that I get the following error:\r\n```\r\nSemanticException Cannot find class 'org.apache.hudi.hadoop.HoodieParquetInputFormat'\r\norg.apache.hadoop.hive.ql.parse.SemanticException: Cannot find class 'org.apache.hudi.hadoop.HoodieParquetInputFormat'\r\n\tat org.apache.hadoop.hive.ql.parse.ParseUtils.ensureClassExists(ParseUtils.java:263)\r\n\t```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820315925/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820367824","html_url":"https://github.com/apache/hudi/issues/2806#issuecomment-820367824","issue_url":"https://api.github.com/repos/apache/hudi/issues/2806","id":820367824,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDM2NzgyNA==","user":{"login":"tmac2100","id":48118940,"node_id":"MDQ6VXNlcjQ4MTE4OTQw","avatar_url":"https://avatars.githubusercontent.com/u/48118940?v=4","gravatar_id":"","url":"https://api.github.com/users/tmac2100","html_url":"https://github.com/tmac2100","followers_url":"https://api.github.com/users/tmac2100/followers","following_url":"https://api.github.com/users/tmac2100/following{/other_user}","gists_url":"https://api.github.com/users/tmac2100/gists{/gist_id}","starred_url":"https://api.github.com/users/tmac2100/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tmac2100/subscriptions","organizations_url":"https://api.github.com/users/tmac2100/orgs","repos_url":"https://api.github.com/users/tmac2100/repos","events_url":"https://api.github.com/users/tmac2100/events{/privacy}","received_events_url":"https://api.github.com/users/tmac2100/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T11:59:59Z","updated_at":"2021-04-15T11:59:59Z","author_association":"NONE","body":"@n3nash Thank you for your help.I can't transfer pictures because of company information security restrictions.\r\n1)BloomIndex is more efficient when the number of fields is smaller than when the number of fields is higher;\r\n2)The data is written to hudi by partition.\r\nThank you.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820367824/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820383022","html_url":"https://github.com/apache/hudi/pull/2831#issuecomment-820383022","issue_url":"https://api.github.com/repos/apache/hudi/issues/2831","id":820383022,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDM4MzAyMg==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T12:27:02Z","updated_at":"2021-04-15T12:27:02Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2831?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2831](https://codecov.io/gh/apache/hudi/pull/2831?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (908425d) into [master](https://codecov.io/gh/apache/hudi/commit/191470d1fc9b3596eb4da2413e8bef286ccc7135?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (191470d) will **decrease** coverage by `43.22%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2831/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2831?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@             Coverage Diff              @@\n##             master   #2831       +/-   ##\n============================================\n- Coverage     52.60%   9.38%   -43.23%     \n+ Complexity     3709      48     -3661     \n============================================\n  Files           485      54      -431     \n  Lines         23224    1993    -21231     \n  Branches       2465     235     -2230     \n============================================\n- Hits          12218     187    -12031     \n+ Misses         9928    1793     -8135     \n+ Partials       1078      13     -1065     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `?` | `?` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `9.38% <ø> (-60.42%)` | `48.00 <ø> (-325.00)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2831?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...va/org/apache/hudi/utilities/IdentitySplitter.java](https://codecov.io/gh/apache/hudi/pull/2831/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0lkZW50aXR5U3BsaXR0ZXIuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-2.00%)` | |\n| [...va/org/apache/hudi/utilities/schema/SchemaSet.java](https://codecov.io/gh/apache/hudi/pull/2831/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFTZXQuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-3.00%)` | |\n| [...a/org/apache/hudi/utilities/sources/RowSource.java](https://codecov.io/gh/apache/hudi/pull/2831/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUm93U291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [.../org/apache/hudi/utilities/sources/AvroSource.java](https://codecov.io/gh/apache/hudi/pull/2831/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQXZyb1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [.../org/apache/hudi/utilities/sources/JsonSource.java](https://codecov.io/gh/apache/hudi/pull/2831/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvblNvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [...rg/apache/hudi/utilities/sources/CsvDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2831/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQ3N2REZTU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-10.00%)` | |\n| [...g/apache/hudi/utilities/sources/JsonDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2831/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkRGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [...apache/hudi/utilities/sources/JsonKafkaSource.java](https://codecov.io/gh/apache/hudi/pull/2831/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkthZmthU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-6.00%)` | |\n| [...pache/hudi/utilities/sources/ParquetDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2831/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUGFycXVldERGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-5.00%)` | |\n| [...lities/schema/SchemaProviderWithPostProcessor.java](https://codecov.io/gh/apache/hudi/pull/2831/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFQcm92aWRlcldpdGhQb3N0UHJvY2Vzc29yLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| ... and [462 more](https://codecov.io/gh/apache/hudi/pull/2831/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820383022/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820462928","html_url":"https://github.com/apache/hudi/issues/2787#issuecomment-820462928","issue_url":"https://api.github.com/repos/apache/hudi/issues/2787","id":820462928,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDQ2MjkyOA==","user":{"login":"rubenssoto","id":36298331,"node_id":"MDQ6VXNlcjM2Mjk4MzMx","avatar_url":"https://avatars.githubusercontent.com/u/36298331?v=4","gravatar_id":"","url":"https://api.github.com/users/rubenssoto","html_url":"https://github.com/rubenssoto","followers_url":"https://api.github.com/users/rubenssoto/followers","following_url":"https://api.github.com/users/rubenssoto/following{/other_user}","gists_url":"https://api.github.com/users/rubenssoto/gists{/gist_id}","starred_url":"https://api.github.com/users/rubenssoto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rubenssoto/subscriptions","organizations_url":"https://api.github.com/users/rubenssoto/orgs","repos_url":"https://api.github.com/users/rubenssoto/repos","events_url":"https://api.github.com/users/rubenssoto/events{/privacy}","received_events_url":"https://api.github.com/users/rubenssoto/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T14:25:04Z","updated_at":"2021-04-15T14:25:04Z","author_association":"NONE","body":"Its a new Hudi table.\r\n\r\nIt happens intermittently, probably some schema mismatch I think...is there any way to know where exactly the problem or I will have to inspect the new when the problem starts to happen?\r\n\r\nthank you.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820462928/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820530141","html_url":"https://github.com/apache/hudi/issues/2811#issuecomment-820530141","issue_url":"https://api.github.com/repos/apache/hudi/issues/2811","id":820530141,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDUzMDE0MQ==","user":{"login":"vburenin","id":4350891,"node_id":"MDQ6VXNlcjQzNTA4OTE=","avatar_url":"https://avatars.githubusercontent.com/u/4350891?v=4","gravatar_id":"","url":"https://api.github.com/users/vburenin","html_url":"https://github.com/vburenin","followers_url":"https://api.github.com/users/vburenin/followers","following_url":"https://api.github.com/users/vburenin/following{/other_user}","gists_url":"https://api.github.com/users/vburenin/gists{/gist_id}","starred_url":"https://api.github.com/users/vburenin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vburenin/subscriptions","organizations_url":"https://api.github.com/users/vburenin/orgs","repos_url":"https://api.github.com/users/vburenin/repos","events_url":"https://api.github.com/users/vburenin/events{/privacy}","received_events_url":"https://api.github.com/users/vburenin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-15T15:41:14Z","updated_at":"2021-04-15T15:41:14Z","author_association":"CONTRIBUTOR","body":"It looks like core-site.xml is not visible since it didn't trigger gs:// schema handler.\r\nOne more thing though, I would recommend to upgrade google GCS connector to the latest version 2.1.x.\r\n\r\nDon't use 2.2, it won't work.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820530141/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820836368","html_url":"https://github.com/apache/hudi/pull/2833#issuecomment-820836368","issue_url":"https://api.github.com/repos/apache/hudi/issues/2833","id":820836368,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDgzNjM2OA==","user":{"login":"zhedoubushishi","id":31263084,"node_id":"MDQ6VXNlcjMxMjYzMDg0","avatar_url":"https://avatars.githubusercontent.com/u/31263084?v=4","gravatar_id":"","url":"https://api.github.com/users/zhedoubushishi","html_url":"https://github.com/zhedoubushishi","followers_url":"https://api.github.com/users/zhedoubushishi/followers","following_url":"https://api.github.com/users/zhedoubushishi/following{/other_user}","gists_url":"https://api.github.com/users/zhedoubushishi/gists{/gist_id}","starred_url":"https://api.github.com/users/zhedoubushishi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhedoubushishi/subscriptions","organizations_url":"https://api.github.com/users/zhedoubushishi/orgs","repos_url":"https://api.github.com/users/zhedoubushishi/repos","events_url":"https://api.github.com/users/zhedoubushishi/events{/privacy}","received_events_url":"https://api.github.com/users/zhedoubushishi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T01:05:32Z","updated_at":"2021-04-16T01:05:32Z","author_association":"CONTRIBUTOR","body":"@vinothchandar can you take a look when you have time to see if this is something you want to go with?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820836368/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820843182","html_url":"https://github.com/apache/hudi/pull/2814#issuecomment-820843182","issue_url":"https://api.github.com/repos/apache/hudi/issues/2814","id":820843182,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDg0MzE4Mg==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T01:29:37Z","updated_at":"2021-04-16T01:29:37Z","author_association":"CONTRIBUTOR","body":"@hj2016 Since this fix is hard to write test. Did you test it in your local env?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820843182/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820874107","html_url":"https://github.com/apache/hudi/issues/2818#issuecomment-820874107","issue_url":"https://api.github.com/repos/apache/hudi/issues/2818","id":820874107,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDg3NDEwNw==","user":{"login":"garyli1019","id":23007841,"node_id":"MDQ6VXNlcjIzMDA3ODQx","avatar_url":"https://avatars.githubusercontent.com/u/23007841?v=4","gravatar_id":"","url":"https://api.github.com/users/garyli1019","html_url":"https://github.com/garyli1019","followers_url":"https://api.github.com/users/garyli1019/followers","following_url":"https://api.github.com/users/garyli1019/following{/other_user}","gists_url":"https://api.github.com/users/garyli1019/gists{/gist_id}","starred_url":"https://api.github.com/users/garyli1019/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garyli1019/subscriptions","organizations_url":"https://api.github.com/users/garyli1019/orgs","repos_url":"https://api.github.com/users/garyli1019/repos","events_url":"https://api.github.com/users/garyli1019/events{/privacy}","received_events_url":"https://api.github.com/users/garyli1019/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T03:04:58Z","updated_at":"2021-04-16T03:04:58Z","author_association":"MEMBER","body":"@ssdong Thanks for report the issue. For the `NoSuchElementException`, please feel free to submit a fix. \r\nFor the incremental pulling form archived commits, do you think we should get the commits from the archive folder?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820874107/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820876527","html_url":"https://github.com/apache/hudi/issues/2609#issuecomment-820876527","issue_url":"https://api.github.com/repos/apache/hudi/issues/2609","id":820876527,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDg3NjUyNw==","user":{"login":"njalan","id":8622340,"node_id":"MDQ6VXNlcjg2MjIzNDA=","avatar_url":"https://avatars.githubusercontent.com/u/8622340?v=4","gravatar_id":"","url":"https://api.github.com/users/njalan","html_url":"https://github.com/njalan","followers_url":"https://api.github.com/users/njalan/followers","following_url":"https://api.github.com/users/njalan/following{/other_user}","gists_url":"https://api.github.com/users/njalan/gists{/gist_id}","starred_url":"https://api.github.com/users/njalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/njalan/subscriptions","organizations_url":"https://api.github.com/users/njalan/orgs","repos_url":"https://api.github.com/users/njalan/repos","events_url":"https://api.github.com/users/njalan/events{/privacy}","received_events_url":"https://api.github.com/users/njalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T03:13:44Z","updated_at":"2021-04-16T03:13:44Z","author_association":"NONE","body":"@tooptoop4  So is there any plan to merge it in prestosql?  \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820876527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820896412","html_url":"https://github.com/apache/hudi/pull/2835#issuecomment-820896412","issue_url":"https://api.github.com/repos/apache/hudi/issues/2835","id":820896412,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDg5NjQxMg==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T04:25:06Z","updated_at":"2021-04-16T04:25:06Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2835?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2835](https://codecov.io/gh/apache/hudi/pull/2835?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (ccdac0e) into [master](https://codecov.io/gh/apache/hudi/commit/191470d1fc9b3596eb4da2413e8bef286ccc7135?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (191470d) will **decrease** coverage by `43.22%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2835/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2835?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@             Coverage Diff              @@\n##             master   #2835       +/-   ##\n============================================\n- Coverage     52.60%   9.38%   -43.23%     \n+ Complexity     3709      48     -3661     \n============================================\n  Files           485      54      -431     \n  Lines         23224    1993    -21231     \n  Branches       2465     235     -2230     \n============================================\n- Hits          12218     187    -12031     \n+ Misses         9928    1793     -8135     \n+ Partials       1078      13     -1065     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `?` | `?` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `9.38% <ø> (-60.42%)` | `48.00 <ø> (-325.00)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2835?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...va/org/apache/hudi/utilities/IdentitySplitter.java](https://codecov.io/gh/apache/hudi/pull/2835/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0lkZW50aXR5U3BsaXR0ZXIuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-2.00%)` | |\n| [...va/org/apache/hudi/utilities/schema/SchemaSet.java](https://codecov.io/gh/apache/hudi/pull/2835/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFTZXQuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-3.00%)` | |\n| [...a/org/apache/hudi/utilities/sources/RowSource.java](https://codecov.io/gh/apache/hudi/pull/2835/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUm93U291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [.../org/apache/hudi/utilities/sources/AvroSource.java](https://codecov.io/gh/apache/hudi/pull/2835/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQXZyb1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [.../org/apache/hudi/utilities/sources/JsonSource.java](https://codecov.io/gh/apache/hudi/pull/2835/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvblNvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [...rg/apache/hudi/utilities/sources/CsvDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2835/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQ3N2REZTU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-10.00%)` | |\n| [...g/apache/hudi/utilities/sources/JsonDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2835/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkRGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [...apache/hudi/utilities/sources/JsonKafkaSource.java](https://codecov.io/gh/apache/hudi/pull/2835/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkthZmthU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-6.00%)` | |\n| [...pache/hudi/utilities/sources/ParquetDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2835/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUGFycXVldERGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-5.00%)` | |\n| [...lities/schema/SchemaProviderWithPostProcessor.java](https://codecov.io/gh/apache/hudi/pull/2835/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFQcm92aWRlcldpdGhQb3N0UHJvY2Vzc29yLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| ... and [462 more](https://codecov.io/gh/apache/hudi/pull/2835/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820896412/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820914205","html_url":"https://github.com/apache/hudi/issues/2812#issuecomment-820914205","issue_url":"https://api.github.com/repos/apache/hudi/issues/2812","id":820914205,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDkxNDIwNQ==","user":{"login":"xglv1985","id":15320045,"node_id":"MDQ6VXNlcjE1MzIwMDQ1","avatar_url":"https://avatars.githubusercontent.com/u/15320045?v=4","gravatar_id":"","url":"https://api.github.com/users/xglv1985","html_url":"https://github.com/xglv1985","followers_url":"https://api.github.com/users/xglv1985/followers","following_url":"https://api.github.com/users/xglv1985/following{/other_user}","gists_url":"https://api.github.com/users/xglv1985/gists{/gist_id}","starred_url":"https://api.github.com/users/xglv1985/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xglv1985/subscriptions","organizations_url":"https://api.github.com/users/xglv1985/orgs","repos_url":"https://api.github.com/users/xglv1985/repos","events_url":"https://api.github.com/users/xglv1985/events{/privacy}","received_events_url":"https://api.github.com/users/xglv1985/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T05:23:35Z","updated_at":"2021-04-16T05:23:35Z","author_association":"CONTRIBUTOR","body":"> Okay, do you mind re-opening that Spark ticket and asking a question there ? Other options are to try a different Spark build to confirm that this is a spark issue and should probably go away with a different build (may be 2.4)\r\n\r\nOK, I've left a message there. And I will try a different Spark version.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820914205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820927569","html_url":"https://github.com/apache/hudi/pull/2814#issuecomment-820927569","issue_url":"https://api.github.com/repos/apache/hudi/issues/2814","id":820927569,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDkyNzU2OQ==","user":{"login":"hj2016","id":18521084,"node_id":"MDQ6VXNlcjE4NTIxMDg0","avatar_url":"https://avatars.githubusercontent.com/u/18521084?v=4","gravatar_id":"","url":"https://api.github.com/users/hj2016","html_url":"https://github.com/hj2016","followers_url":"https://api.github.com/users/hj2016/followers","following_url":"https://api.github.com/users/hj2016/following{/other_user}","gists_url":"https://api.github.com/users/hj2016/gists{/gist_id}","starred_url":"https://api.github.com/users/hj2016/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hj2016/subscriptions","organizations_url":"https://api.github.com/users/hj2016/orgs","repos_url":"https://api.github.com/users/hj2016/repos","events_url":"https://api.github.com/users/hj2016/events{/privacy}","received_events_url":"https://api.github.com/users/hj2016/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T05:55:32Z","updated_at":"2021-04-16T05:55:32Z","author_association":"CONTRIBUTOR","body":"of course.\r\nBefore fixing the problem:\r\n![修复前1](https://user-images.githubusercontent.com/18521084/114977940-1ac31e80-9ebb-11eb-9634-2d8d389701b3.png)\r\n![修复前2](https://user-images.githubusercontent.com/18521084/114977949-1eef3c00-9ebb-11eb-80e5-4dca6d76b792.png)\r\nAfter fixing the problem:\r\n![image](https://user-images.githubusercontent.com/18521084/114978036-3e866480-9ebb-11eb-9737-e2d3dcede0d9.png)\r\n![image](https://user-images.githubusercontent.com/18521084/114978141-6675c800-9ebb-11eb-8992-b1c96bff08cb.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820927569/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820928266","html_url":"https://github.com/apache/hudi/pull/2814#issuecomment-820928266","issue_url":"https://api.github.com/repos/apache/hudi/issues/2814","id":820928266,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDkyODI2Ng==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T05:57:03Z","updated_at":"2021-04-16T05:57:03Z","author_association":"CONTRIBUTOR","body":"> of course.\r\n> Before fixing the problem:\r\n> ![修复前1](https://user-images.githubusercontent.com/18521084/114977940-1ac31e80-9ebb-11eb-9634-2d8d389701b3.png)\r\n> ![修复前2](https://user-images.githubusercontent.com/18521084/114977949-1eef3c00-9ebb-11eb-80e5-4dca6d76b792.png)\r\n> After fixing the problem:\r\n> ![image](https://user-images.githubusercontent.com/18521084/114978036-3e866480-9ebb-11eb-9737-e2d3dcede0d9.png)\r\n> ![image](https://user-images.githubusercontent.com/18521084/114978141-6675c800-9ebb-11eb-8992-b1c96bff08cb.png)\r\n\r\nGreat!","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820928266/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820928674","html_url":"https://github.com/apache/hudi/pull/2784#issuecomment-820928674","issue_url":"https://api.github.com/repos/apache/hudi/issues/2784","id":820928674,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDkyODY3NA==","user":{"login":"ssdong","id":3754011,"node_id":"MDQ6VXNlcjM3NTQwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/3754011?v=4","gravatar_id":"","url":"https://api.github.com/users/ssdong","html_url":"https://github.com/ssdong","followers_url":"https://api.github.com/users/ssdong/followers","following_url":"https://api.github.com/users/ssdong/following{/other_user}","gists_url":"https://api.github.com/users/ssdong/gists{/gist_id}","starred_url":"https://api.github.com/users/ssdong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ssdong/subscriptions","organizations_url":"https://api.github.com/users/ssdong/orgs","repos_url":"https://api.github.com/users/ssdong/repos","events_url":"https://api.github.com/users/ssdong/events{/privacy}","received_events_url":"https://api.github.com/users/ssdong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T05:57:58Z","updated_at":"2021-04-16T05:57:58Z","author_association":"CONTRIBUTOR","body":"@satishkotha @lw309637554 Just to share some updates, this PR fixed the following 2 issues during archival\r\n1. `Positive number of partitions required`\r\n2. `java.util.NoSuchElementException: No value present in Option`\r\n\r\nHowever, the aforementioned \r\n```\r\n// Initialize with new Hoodie timeline.\r\ninit(metaClient, getTimeline());\r\n```\r\ndoes cause\r\n`java.io.FileNotFoundException: File file:/Users/susu.dong/Dev/clustering-insert-overwrite-test/.hoodie/20210415220131.replacecommit does not exist` which is a 3rd issue during archival\r\nif we turn _off_ `\"hoodie.clean.automatic\"`, the cleaner option, which is `true` by default.\r\n\r\nTurning off cleaner is making the internally maintained timeline to be out-of-sync with the physical commit file status. The archival removes the commit files while the `init` call still references those commit files that are being removed/archived when it propagates to the `readDataFromPath` method call and throws the exception ultimately.\r\n\r\nFull stacktrace:\r\n```\r\norg.apache.hudi.exception.HoodieIOException: Could not read commit details from /Users/susu.dong/Dev/clustering-insert-overwrite-test/.hoodie/20210415220131.replacecommit\r\n  at org.apache.hudi.common.table.timeline.HoodieActiveTimeline.readDataFromPath(HoodieActiveTimeline.java:561)\r\n  at org.apache.hudi.common.table.timeline.HoodieActiveTimeline.getInstantDetails(HoodieActiveTimeline.java:225)\r\n  at org.apache.hudi.common.table.view.AbstractTableFileSystemView.lambda$resetFileGroupsReplaced$8(AbstractTableFileSystemView.java:217)\r\n  at java.base/java.util.stream.ReferencePipeline$7$1.accept(ReferencePipeline.java:271)\r\n  at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1654)\r\n  at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)\r\n  at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:474)\r\n  at java.base/java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:913)\r\n  at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)\r\n  at java.base/java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:578)\r\n  at org.apache.hudi.common.table.view.AbstractTableFileSystemView.resetFileGroupsReplaced(AbstractTableFileSystemView.java:228)\r\n  at org.apache.hudi.common.table.view.AbstractTableFileSystemView.init(AbstractTableFileSystemView.java:106)\r\n  at org.apache.hudi.common.table.view.HoodieTableFileSystemView.init(HoodieTableFileSystemView.java:106)\r\n  at org.apache.hudi.common.table.view.AbstractTableFileSystemView.reset(AbstractTableFileSystemView.java:248)\r\n  at org.apache.hudi.common.table.view.HoodieTableFileSystemView.close(HoodieTableFileSystemView.java:353)\r\n  at java.base/java.util.concurrent.ConcurrentHashMap$ValuesView.forEach(ConcurrentHashMap.java:4772)\r\n  at org.apache.hudi.common.table.view.FileSystemViewManager.close(FileSystemViewManager.java:118)\r\n  at org.apache.hudi.timeline.service.TimelineService.close(TimelineService.java:207)\r\n  at org.apache.hudi.client.embedded.EmbeddedTimelineService.stop(EmbeddedTimelineService.java:119)\r\n  at org.apache.hudi.client.AbstractHoodieClient.stopEmbeddedServerView(AbstractHoodieClient.java:94)\r\n  at org.apache.hudi.client.AbstractHoodieClient.close(AbstractHoodieClient.java:86)\r\n  at org.apache.hudi.client.AbstractHoodieWriteClient.close(AbstractHoodieWriteClient.java:1047)\r\n  at org.apache.hudi.HoodieSparkSqlWriter$.commitAndPerformPostOperations(HoodieSparkSqlWriter.scala:505)\r\n  at org.apache.hudi.HoodieSparkSqlWriter$.write(HoodieSparkSqlWriter.scala:225)\r\n  at org.apache.hudi.DefaultSource.createRelation(DefaultSource.scala:161)\r\n  at org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:46)\r\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\r\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\r\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:90)\r\n  at org.apache.spark.sql.execution.SparkPlan.$anonfun$execute$1(SparkPlan.scala:175)\r\n  at org.apache.spark.sql.execution.SparkPlan.$anonfun$executeQuery$1(SparkPlan.scala:213)\r\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\r\n  at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:210)\r\n  at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:171)\r\n  at org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:122)\r\n  at org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:121)\r\n  at org.apache.spark.sql.DataFrameWriter.$anonfun$runCommand$1(DataFrameWriter.scala:963)\r\n  at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:100)\r\n  at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:160)\r\n  at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:87)\r\n  at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:764)\r\n  at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\r\n  at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:963)\r\n  at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:415)\r\n  at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:399)\r\n  at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:288)\r\n```\r\n\r\nWe don't have to fix it in this PR, however, we do need to find a better solution without having to load the full active timeline that breaks some fundamental assumption. Is it possible for one of you to reach out to @bvaradar to get his attention on this? Thanks!","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820928674/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820931906","html_url":"https://github.com/apache/hudi/pull/2666#issuecomment-820931906","issue_url":"https://api.github.com/repos/apache/hudi/issues/2666","id":820931906,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDkzMTkwNg==","user":{"login":"liujinhui1994","id":25769285,"node_id":"MDQ6VXNlcjI1NzY5Mjg1","avatar_url":"https://avatars.githubusercontent.com/u/25769285?v=4","gravatar_id":"","url":"https://api.github.com/users/liujinhui1994","html_url":"https://github.com/liujinhui1994","followers_url":"https://api.github.com/users/liujinhui1994/followers","following_url":"https://api.github.com/users/liujinhui1994/following{/other_user}","gists_url":"https://api.github.com/users/liujinhui1994/gists{/gist_id}","starred_url":"https://api.github.com/users/liujinhui1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liujinhui1994/subscriptions","organizations_url":"https://api.github.com/users/liujinhui1994/orgs","repos_url":"https://api.github.com/users/liujinhui1994/repos","events_url":"https://api.github.com/users/liujinhui1994/events{/privacy}","received_events_url":"https://api.github.com/users/liujinhui1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T06:05:02Z","updated_at":"2021-04-16T06:05:02Z","author_association":"CONTRIBUTOR","body":"> > sorry for late turn around on reviewing this. We should definitely get this before next release.\r\n> > I am yet to review tests. but few high level thoughts on reviewing source code.\r\n> > \r\n> > * Shouldn't we check schema compatibility? what incase new incoming batch is not compatible w/ table schema w/ partial updates set to true? did we cover this scenario.\r\n> > * I see we have added support only for COW. should we throw exception if the config is set for MOR?\r\n> > * I don't have a good idea of adding sql DML support to hoodie table. But if feasible, once such support is added, do you think we can leverage this w/o duplicating the work for sql DML. for eg, \"update col1 = 'new_york' where col2= '123'\" Such partial updates should translate from sql layer to this right.\r\n> > * In tests, do verify that schema in commit metadata refers to table schema and not incoming partial schema.\r\n> \r\n> I have the same feeling, we should still use the old schema with full fields there, for new records with partial values, we can patch them up with a builtin placeholder values, and when we pre_combine the old and new, if we encounter the placeholder values, use the value from the existing record.\r\n> \r\n> In any case, to be consistent with SQL, please do not modify the schema which mess the thing up.\r\n\r\nOkay, I think of a way to support such a situation","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820931906/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820956020","html_url":"https://github.com/apache/hudi/issues/2837#issuecomment-820956020","issue_url":"https://api.github.com/repos/apache/hudi/issues/2837","id":820956020,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDk1NjAyMA==","user":{"login":"zherenyu831","id":52404525,"node_id":"MDQ6VXNlcjUyNDA0NTI1","avatar_url":"https://avatars.githubusercontent.com/u/52404525?v=4","gravatar_id":"","url":"https://api.github.com/users/zherenyu831","html_url":"https://github.com/zherenyu831","followers_url":"https://api.github.com/users/zherenyu831/followers","following_url":"https://api.github.com/users/zherenyu831/following{/other_user}","gists_url":"https://api.github.com/users/zherenyu831/gists{/gist_id}","starred_url":"https://api.github.com/users/zherenyu831/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zherenyu831/subscriptions","organizations_url":"https://api.github.com/users/zherenyu831/orgs","repos_url":"https://api.github.com/users/zherenyu831/repos","events_url":"https://api.github.com/users/zherenyu831/events{/privacy}","received_events_url":"https://api.github.com/users/zherenyu831/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T06:51:20Z","updated_at":"2021-04-16T06:51:20Z","author_association":"CONTRIBUTOR","body":"It dependent on count of cores, configuration, ratio of insert/update, storage type\r\nIMO, it is not slow","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820956020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820987025","html_url":"https://github.com/apache/hudi/issues/2837#issuecomment-820987025","issue_url":"https://api.github.com/repos/apache/hudi/issues/2837","id":820987025,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDk4NzAyNQ==","user":{"login":"liijiankang","id":42951757,"node_id":"MDQ6VXNlcjQyOTUxNzU3","avatar_url":"https://avatars.githubusercontent.com/u/42951757?v=4","gravatar_id":"","url":"https://api.github.com/users/liijiankang","html_url":"https://github.com/liijiankang","followers_url":"https://api.github.com/users/liijiankang/followers","following_url":"https://api.github.com/users/liijiankang/following{/other_user}","gists_url":"https://api.github.com/users/liijiankang/gists{/gist_id}","starred_url":"https://api.github.com/users/liijiankang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liijiankang/subscriptions","organizations_url":"https://api.github.com/users/liijiankang/orgs","repos_url":"https://api.github.com/users/liijiankang/repos","events_url":"https://api.github.com/users/liijiankang/events{/privacy}","received_events_url":"https://api.github.com/users/liijiankang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T07:45:52Z","updated_at":"2021-04-16T07:45:52Z","author_association":"NONE","body":"@zherenyu831 thanks","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820987025/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820994344","html_url":"https://github.com/apache/hudi/pull/2784#issuecomment-820994344","issue_url":"https://api.github.com/repos/apache/hudi/issues/2784","id":820994344,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMDk5NDM0NA==","user":{"login":"zherenyu831","id":52404525,"node_id":"MDQ6VXNlcjUyNDA0NTI1","avatar_url":"https://avatars.githubusercontent.com/u/52404525?v=4","gravatar_id":"","url":"https://api.github.com/users/zherenyu831","html_url":"https://github.com/zherenyu831","followers_url":"https://api.github.com/users/zherenyu831/followers","following_url":"https://api.github.com/users/zherenyu831/following{/other_user}","gists_url":"https://api.github.com/users/zherenyu831/gists{/gist_id}","starred_url":"https://api.github.com/users/zherenyu831/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zherenyu831/subscriptions","organizations_url":"https://api.github.com/users/zherenyu831/orgs","repos_url":"https://api.github.com/users/zherenyu831/repos","events_url":"https://api.github.com/users/zherenyu831/events{/privacy}","received_events_url":"https://api.github.com/users/zherenyu831/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T07:58:12Z","updated_at":"2021-04-16T07:58:12Z","author_association":"CONTRIBUTOR","body":"There is one solution:\r\nalways enable cleaner, which will help you refresh timeline 😭 ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/820994344/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821007767","html_url":"https://github.com/apache/hudi/pull/2836#issuecomment-821007767","issue_url":"https://api.github.com/repos/apache/hudi/issues/2836","id":821007767,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMTAwNzc2Nw==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T08:20:37Z","updated_at":"2021-04-16T08:20:37Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2836?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2836](https://codecov.io/gh/apache/hudi/pull/2836?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (f1319af) into [master](https://codecov.io/gh/apache/hudi/commit/b6d949b48a649acac27d5d9b91677bf2e25e9342?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (b6d949b) will **decrease** coverage by `0.00%`.\n> The diff coverage is `100.00%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2836/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2836?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2836      +/-   ##\n============================================\n- Coverage     52.60%   52.59%   -0.01%     \n+ Complexity     3709     3708       -1     \n============================================\n  Files           485      485              \n  Lines         23224    23227       +3     \n  Branches       2465     2466       +1     \n============================================\n  Hits          12216    12216              \n- Misses         9929     9933       +4     \n+ Partials       1079     1078       -1     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `40.29% <ø> (ø)` | `215.00 <ø> (ø)` | |\n| hudiclient | `∅ <ø> (∅)` | `0.00 <ø> (ø)` | |\n| hudicommon | `50.68% <100.00%> (-0.01%)` | `1976.00 <0.00> (-1.00)` | |\n| hudiflink | `56.51% <ø> (-0.04%)` | `516.00 <ø> (ø)` | |\n| hudihadoopmr | `33.33% <ø> (ø)` | `198.00 <ø> (ø)` | |\n| hudisparkdatasource | `72.06% <ø> (ø)` | `237.00 <ø> (ø)` | |\n| hudisync | `45.70% <ø> (ø)` | `131.00 <ø> (ø)` | |\n| huditimelineservice | `64.36% <ø> (ø)` | `62.00 <ø> (ø)` | |\n| hudiutilities | `69.79% <ø> (ø)` | `373.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2836?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...java/org/apache/hudi/common/fs/StorageSchemes.java](https://codecov.io/gh/apache/hudi/pull/2836/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2ZzL1N0b3JhZ2VTY2hlbWVzLmphdmE=) | `100.00% <100.00%> (ø)` | `10.00 <0.00> (ø)` | |\n| [...ache/hudi/common/fs/inline/InMemoryFileSystem.java](https://codecov.io/gh/apache/hudi/pull/2836/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2ZzL2lubGluZS9Jbk1lbW9yeUZpbGVTeXN0ZW0uamF2YQ==) | `79.31% <0.00%> (-10.35%)` | `15.00% <0.00%> (-1.00%)` | |\n| [.../hudi/table/format/cow/CopyOnWriteInputFormat.java](https://codecov.io/gh/apache/hudi/pull/2836/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS90YWJsZS9mb3JtYXQvY293L0NvcHlPbldyaXRlSW5wdXRGb3JtYXQuamF2YQ==) | `55.33% <0.00%> (-0.75%)` | `20.00% <0.00%> (ø%)` | |\n| [...e/hudi/common/table/log/HoodieLogFormatWriter.java](https://codecov.io/gh/apache/hudi/pull/2836/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9Ib29kaWVMb2dGb3JtYXRXcml0ZXIuamF2YQ==) | `79.68% <0.00%> (+1.56%)` | `26.00% <0.00%> (ø%)` | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821007767/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821029965","html_url":"https://github.com/apache/hudi/issues/2609#issuecomment-821029965","issue_url":"https://api.github.com/repos/apache/hudi/issues/2609","id":821029965,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMTAyOTk2NQ==","user":{"login":"tooptoop4","id":33283496,"node_id":"MDQ6VXNlcjMzMjgzNDk2","avatar_url":"https://avatars.githubusercontent.com/u/33283496?v=4","gravatar_id":"","url":"https://api.github.com/users/tooptoop4","html_url":"https://github.com/tooptoop4","followers_url":"https://api.github.com/users/tooptoop4/followers","following_url":"https://api.github.com/users/tooptoop4/following{/other_user}","gists_url":"https://api.github.com/users/tooptoop4/gists{/gist_id}","starred_url":"https://api.github.com/users/tooptoop4/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tooptoop4/subscriptions","organizations_url":"https://api.github.com/users/tooptoop4/orgs","repos_url":"https://api.github.com/users/tooptoop4/repos","events_url":"https://api.github.com/users/tooptoop4/events{/privacy}","received_events_url":"https://api.github.com/users/tooptoop4/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T08:57:35Z","updated_at":"2021-04-16T08:57:35Z","author_association":"NONE","body":"u can raise the PR @njalan ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821029965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821065195","html_url":"https://github.com/apache/hudi/issues/2609#issuecomment-821065195","issue_url":"https://api.github.com/repos/apache/hudi/issues/2609","id":821065195,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMTA2NTE5NQ==","user":{"login":"GaruGaru","id":6578583,"node_id":"MDQ6VXNlcjY1Nzg1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/6578583?v=4","gravatar_id":"","url":"https://api.github.com/users/GaruGaru","html_url":"https://github.com/GaruGaru","followers_url":"https://api.github.com/users/GaruGaru/followers","following_url":"https://api.github.com/users/GaruGaru/following{/other_user}","gists_url":"https://api.github.com/users/GaruGaru/gists{/gist_id}","starred_url":"https://api.github.com/users/GaruGaru/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GaruGaru/subscriptions","organizations_url":"https://api.github.com/users/GaruGaru/orgs","repos_url":"https://api.github.com/users/GaruGaru/repos","events_url":"https://api.github.com/users/GaruGaru/events{/privacy}","received_events_url":"https://api.github.com/users/GaruGaru/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T09:59:35Z","updated_at":"2021-04-16T09:59:35Z","author_association":"NONE","body":"It can be a nice idea to port changes to trinodb(prestosql) but there may be some differences in the `hive-connector` implementation ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821065195/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821072166","html_url":"https://github.com/apache/hudi/pull/2822#issuecomment-821072166","issue_url":"https://api.github.com/repos/apache/hudi/issues/2822","id":821072166,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMTA3MjE2Ng==","user":{"login":"RocMarshal","id":64569824,"node_id":"MDQ6VXNlcjY0NTY5ODI0","avatar_url":"https://avatars.githubusercontent.com/u/64569824?v=4","gravatar_id":"","url":"https://api.github.com/users/RocMarshal","html_url":"https://github.com/RocMarshal","followers_url":"https://api.github.com/users/RocMarshal/followers","following_url":"https://api.github.com/users/RocMarshal/following{/other_user}","gists_url":"https://api.github.com/users/RocMarshal/gists{/gist_id}","starred_url":"https://api.github.com/users/RocMarshal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RocMarshal/subscriptions","organizations_url":"https://api.github.com/users/RocMarshal/orgs","repos_url":"https://api.github.com/users/RocMarshal/repos","events_url":"https://api.github.com/users/RocMarshal/events{/privacy}","received_events_url":"https://api.github.com/users/RocMarshal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T10:12:53Z","updated_at":"2021-04-16T10:12:53Z","author_association":"CONTRIBUTOR","body":"rerun tests","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821072166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821076075","html_url":"https://github.com/apache/hudi/pull/2822#issuecomment-821076075","issue_url":"https://api.github.com/repos/apache/hudi/issues/2822","id":821076075,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMTA3NjA3NQ==","user":{"login":"RocMarshal","id":64569824,"node_id":"MDQ6VXNlcjY0NTY5ODI0","avatar_url":"https://avatars.githubusercontent.com/u/64569824?v=4","gravatar_id":"","url":"https://api.github.com/users/RocMarshal","html_url":"https://github.com/RocMarshal","followers_url":"https://api.github.com/users/RocMarshal/followers","following_url":"https://api.github.com/users/RocMarshal/following{/other_user}","gists_url":"https://api.github.com/users/RocMarshal/gists{/gist_id}","starred_url":"https://api.github.com/users/RocMarshal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RocMarshal/subscriptions","organizations_url":"https://api.github.com/users/RocMarshal/orgs","repos_url":"https://api.github.com/users/RocMarshal/repos","events_url":"https://api.github.com/users/RocMarshal/events{/privacy}","received_events_url":"https://api.github.com/users/RocMarshal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T10:20:09Z","updated_at":"2021-04-16T10:20:09Z","author_association":"CONTRIBUTOR","body":"@codecov-io rerun tests","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821076075/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821228266","html_url":"https://github.com/apache/hudi/pull/2722#issuecomment-821228266","issue_url":"https://api.github.com/repos/apache/hudi/issues/2722","id":821228266,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMTIyODI2Ng==","user":{"login":"lw309637554","id":8501994,"node_id":"MDQ6VXNlcjg1MDE5OTQ=","avatar_url":"https://avatars.githubusercontent.com/u/8501994?v=4","gravatar_id":"","url":"https://api.github.com/users/lw309637554","html_url":"https://github.com/lw309637554","followers_url":"https://api.github.com/users/lw309637554/followers","following_url":"https://api.github.com/users/lw309637554/following{/other_user}","gists_url":"https://api.github.com/users/lw309637554/gists{/gist_id}","starred_url":"https://api.github.com/users/lw309637554/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lw309637554/subscriptions","organizations_url":"https://api.github.com/users/lw309637554/orgs","repos_url":"https://api.github.com/users/lw309637554/repos","events_url":"https://api.github.com/users/lw309637554/events{/privacy}","received_events_url":"https://api.github.com/users/lw309637554/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T14:45:01Z","updated_at":"2021-04-16T14:45:01Z","author_association":"CONTRIBUTOR","body":"@xiarixiaoyao  hello , will review it this weekend ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821228266/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821230101","html_url":"https://github.com/apache/hudi/pull/2784#issuecomment-821230101","issue_url":"https://api.github.com/repos/apache/hudi/issues/2784","id":821230101,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMTIzMDEwMQ==","user":{"login":"lw309637554","id":8501994,"node_id":"MDQ6VXNlcjg1MDE5OTQ=","avatar_url":"https://avatars.githubusercontent.com/u/8501994?v=4","gravatar_id":"","url":"https://api.github.com/users/lw309637554","html_url":"https://github.com/lw309637554","followers_url":"https://api.github.com/users/lw309637554/followers","following_url":"https://api.github.com/users/lw309637554/following{/other_user}","gists_url":"https://api.github.com/users/lw309637554/gists{/gist_id}","starred_url":"https://api.github.com/users/lw309637554/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lw309637554/subscriptions","organizations_url":"https://api.github.com/users/lw309637554/orgs","repos_url":"https://api.github.com/users/lw309637554/repos","events_url":"https://api.github.com/users/lw309637554/events{/privacy}","received_events_url":"https://api.github.com/users/lw309637554/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T14:47:56Z","updated_at":"2021-04-16T14:47:56Z","author_association":"CONTRIBUTOR","body":"> @lw309637554 I reviewed this PR but just want to get another set of eyes. do you mind taking a pass on this?\r\nokay ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821230101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821311104","html_url":"https://github.com/apache/hudi/pull/2842#issuecomment-821311104","issue_url":"https://api.github.com/repos/apache/hudi/issues/2842","id":821311104,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMTMxMTEwNA==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T16:58:56Z","updated_at":"2021-04-16T16:58:56Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2842?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2842](https://codecov.io/gh/apache/hudi/pull/2842?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (cb8c4a9) into [master](https://codecov.io/gh/apache/hudi/commit/1d53d6e6c2d3ff967d333d87b308406c8cd6917a?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (1d53d6e) will **increase** coverage by `17.25%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2842/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2842?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@              Coverage Diff              @@\n##             master    #2842       +/-   ##\n=============================================\n+ Coverage     52.58%   69.84%   +17.25%     \n+ Complexity     3709      374     -3335     \n=============================================\n  Files           485       54      -431     \n  Lines         23227     1993    -21234     \n  Branches       2466      235     -2231     \n=============================================\n- Hits          12215     1392    -10823     \n+ Misses         9934      471     -9463     \n+ Partials       1078      130      -948     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `?` | `?` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `69.84% <ø> (ø)` | `374.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2842?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [.../common/table/log/block/HoodieLogBlockVersion.java](https://codecov.io/gh/apache/hudi/pull/2842/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9ibG9jay9Ib29kaWVMb2dCbG9ja1ZlcnNpb24uamF2YQ==) | | | |\n| [...in/java/org/apache/hudi/common/model/BaseFile.java](https://codecov.io/gh/apache/hudi/pull/2842/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL21vZGVsL0Jhc2VGaWxlLmphdmE=) | | | |\n| [.../org/apache/hudi/sink/utils/NonThrownExecutor.java](https://codecov.io/gh/apache/hudi/pull/2842/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL3V0aWxzL05vblRocm93bkV4ZWN1dG9yLmphdmE=) | | | |\n| [...g/apache/hudi/sink/partitioner/BucketAssigner.java](https://codecov.io/gh/apache/hudi/pull/2842/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL3BhcnRpdGlvbmVyL0J1Y2tldEFzc2lnbmVyLmphdmE=) | | | |\n| [...che/hudi/common/table/timeline/dto/InstantDTO.java](https://codecov.io/gh/apache/hudi/pull/2842/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL3RpbWVsaW5lL2R0by9JbnN0YW50RFRPLmphdmE=) | | | |\n| [.../apache/hudi/sink/compact/CompactionPlanEvent.java](https://codecov.io/gh/apache/hudi/pull/2842/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL2NvbXBhY3QvQ29tcGFjdGlvblBsYW5FdmVudC5qYXZh) | | | |\n| [...g/apache/hudi/common/table/log/LogReaderUtils.java](https://codecov.io/gh/apache/hudi/pull/2842/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9Mb2dSZWFkZXJVdGlscy5qYXZh) | | | |\n| [...org/apache/hudi/common/util/collection/Triple.java](https://codecov.io/gh/apache/hudi/pull/2842/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3V0aWwvY29sbGVjdGlvbi9UcmlwbGUuamF2YQ==) | | | |\n| [...java/org/apache/hudi/common/util/CleanerUtils.java](https://codecov.io/gh/apache/hudi/pull/2842/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3V0aWwvQ2xlYW5lclV0aWxzLmphdmE=) | | | |\n| [...g/apache/hudi/common/function/FunctionWrapper.java](https://codecov.io/gh/apache/hudi/pull/2842/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2Z1bmN0aW9uL0Z1bmN0aW9uV3JhcHBlci5qYXZh) | | | |\n| ... and [421 more](https://codecov.io/gh/apache/hudi/pull/2842/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821311104/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821583643","html_url":"https://github.com/apache/hudi/issues/2566#issuecomment-821583643","issue_url":"https://api.github.com/repos/apache/hudi/issues/2566","id":821583643,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMTU4MzY0Mw==","user":{"login":"jtmzheng","id":3466206,"node_id":"MDQ6VXNlcjM0NjYyMDY=","avatar_url":"https://avatars.githubusercontent.com/u/3466206?v=4","gravatar_id":"","url":"https://api.github.com/users/jtmzheng","html_url":"https://github.com/jtmzheng","followers_url":"https://api.github.com/users/jtmzheng/followers","following_url":"https://api.github.com/users/jtmzheng/following{/other_user}","gists_url":"https://api.github.com/users/jtmzheng/gists{/gist_id}","starred_url":"https://api.github.com/users/jtmzheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtmzheng/subscriptions","organizations_url":"https://api.github.com/users/jtmzheng/orgs","repos_url":"https://api.github.com/users/jtmzheng/repos","events_url":"https://api.github.com/users/jtmzheng/events{/privacy}","received_events_url":"https://api.github.com/users/jtmzheng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-16T21:55:39Z","updated_at":"2021-04-16T21:55:39Z","author_association":"NONE","body":"@nsivabalan I tried bumping to 0.8.0 in the Dockerfile provided above but I'm running into same errors. Can you reprod on your end? Thanks!","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821583643/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821748199","html_url":"https://github.com/apache/hudi/pull/2843#issuecomment-821748199","issue_url":"https://api.github.com/repos/apache/hudi/issues/2843","id":821748199,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMTc0ODE5OQ==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-17T01:54:26Z","updated_at":"2021-04-19T03:17:14Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2843?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2843](https://codecov.io/gh/apache/hudi/pull/2843?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (6e943cf) into [master](https://codecov.io/gh/apache/hudi/commit/b6d949b48a649acac27d5d9b91677bf2e25e9342?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (b6d949b) will **decrease** coverage by `0.01%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2843/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2843?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2843      +/-   ##\n============================================\n- Coverage     52.60%   52.58%   -0.02%     \n+ Complexity     3709     3708       -1     \n============================================\n  Files           485      485              \n  Lines         23224    23227       +3     \n  Branches       2465     2466       +1     \n============================================\n- Hits          12216    12214       -2     \n- Misses         9929     9934       +5     \n  Partials       1079     1079              \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `40.29% <ø> (ø)` | `215.00 <ø> (ø)` | |\n| hudiclient | `∅ <ø> (∅)` | `0.00 <ø> (ø)` | |\n| hudicommon | `50.66% <ø> (-0.03%)` | `1976.00 <ø> (-1.00)` | |\n| hudiflink | `56.51% <ø> (-0.04%)` | `516.00 <ø> (ø)` | |\n| hudihadoopmr | `33.33% <ø> (ø)` | `198.00 <ø> (ø)` | |\n| hudisparkdatasource | `72.06% <ø> (ø)` | `237.00 <ø> (ø)` | |\n| hudisync | `45.70% <ø> (ø)` | `131.00 <ø> (ø)` | |\n| huditimelineservice | `64.36% <ø> (ø)` | `62.00 <ø> (ø)` | |\n| hudiutilities | `69.79% <ø> (ø)` | `373.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2843?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...ache/hudi/common/fs/inline/InMemoryFileSystem.java](https://codecov.io/gh/apache/hudi/pull/2843/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2ZzL2lubGluZS9Jbk1lbW9yeUZpbGVTeXN0ZW0uamF2YQ==) | `79.31% <0.00%> (-10.35%)` | `15.00% <0.00%> (-1.00%)` | |\n| [.../hudi/table/format/cow/CopyOnWriteInputFormat.java](https://codecov.io/gh/apache/hudi/pull/2843/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS90YWJsZS9mb3JtYXQvY293L0NvcHlPbldyaXRlSW5wdXRGb3JtYXQuamF2YQ==) | `55.33% <0.00%> (-0.75%)` | `20.00% <0.00%> (ø%)` | |\n| [...java/org/apache/hudi/common/fs/StorageSchemes.java](https://codecov.io/gh/apache/hudi/pull/2843/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2ZzL1N0b3JhZ2VTY2hlbWVzLmphdmE=) | `100.00% <0.00%> (ø)` | `10.00% <0.00%> (ø%)` | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821748199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821755784","html_url":"https://github.com/apache/hudi/issues/2787#issuecomment-821755784","issue_url":"https://api.github.com/repos/apache/hudi/issues/2787","id":821755784,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMTc1NTc4NA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-17T03:03:41Z","updated_at":"2021-04-17T03:03:41Z","author_association":"CONTRIBUTOR","body":"Can you try enabling schema validation and we can go from there. \r\n```\r\nhoodie.avro.schema.validate\r\n```\r\nset this property to true. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821755784/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821757914","html_url":"https://github.com/apache/hudi/issues/2656#issuecomment-821757914","issue_url":"https://api.github.com/repos/apache/hudi/issues/2656","id":821757914,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMTc1NzkxNA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-17T03:23:33Z","updated_at":"2021-04-17T03:23:33Z","author_association":"CONTRIBUTOR","body":"I guess I understand what's happening. in COW, when creating a new data file, hudi reads existing data and merges w/ incoming data. From merging standpoint, partition path and record key pairs are considered unique. And so even if we insert the same batch again, new data file will not have duplicated data. One option is to create unique keys for every record as suggested by @pengzhiwei2018. \r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821757914/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821758611","html_url":"https://github.com/apache/hudi/issues/2656#issuecomment-821758611","issue_url":"https://api.github.com/repos/apache/hudi/issues/2656","id":821758611,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMTc1ODYxMQ==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-17T03:30:12Z","updated_at":"2021-04-17T03:30:12Z","author_association":"CONTRIBUTOR","body":"my bad. In latest release, we added support for allowing duplicates w/ INSERTs btw. forgot about it when I posted earlier. \r\nensure you set \"hoodie.merge.allow.duplicate.on.inserts\" to true and your operation is \"insert\". you should see duplicates if you try to ingest same batch of records again. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821758611/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821760500","html_url":"https://github.com/apache/hudi/issues/2588#issuecomment-821760500","issue_url":"https://api.github.com/repos/apache/hudi/issues/2588","id":821760500,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMTc2MDUwMA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-17T03:51:00Z","updated_at":"2021-04-17T03:51:00Z","author_association":"CONTRIBUTOR","body":"Did you file a ticket w/ EMR then? if you know the actual root cause and the fix, would be good to bring it up w/ EMR folks so that EMR can patch the fix and others can benefit. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821760500/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821761181","html_url":"https://github.com/apache/hudi/issues/2588#issuecomment-821761181","issue_url":"https://api.github.com/repos/apache/hudi/issues/2588","id":821761181,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMTc2MTE4MQ==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-17T03:58:26Z","updated_at":"2021-04-17T03:58:26Z","author_association":"CONTRIBUTOR","body":"and wrt your point about syncing hive only when required:\r\nwe might have to establish hive connection to get the schema and compare w/ latest hudi schema and to find differences in partitions. so not sure how we can avoid creating hive connections if no changes are done to schema and partitions. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821761181/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821764391","html_url":"https://github.com/apache/hudi/issues/2829#issuecomment-821764391","issue_url":"https://api.github.com/repos/apache/hudi/issues/2829","id":821764391,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMTc2NDM5MQ==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-17T04:31:56Z","updated_at":"2021-04-17T04:31:56Z","author_association":"CONTRIBUTOR","body":"@pratyakshsharma : can you take this up. related to HoodieMultiTableDeltaStreamer","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/821764391/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]