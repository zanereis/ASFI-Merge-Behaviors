[{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2096688965","html_url":"https://github.com/apache/ratis/pull/1079#issuecomment-2096688965","issue_url":"https://api.github.com/repos/apache/ratis/issues/1079","id":2096688965,"node_id":"IC_kwDOBMxbGc58-O9F","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-06T18:48:55Z","updated_at":"2024-05-06T18:48:55Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo for the review.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2096688965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2097110749","html_url":"https://github.com/apache/ratis/pull/1080#issuecomment-2097110749","issue_url":"https://api.github.com/repos/apache/ratis/issues/1080","id":2097110749,"node_id":"IC_kwDOBMxbGc58_17d","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-06T23:51:00Z","updated_at":"2024-05-06T23:51:00Z","author_association":"CONTRIBUTOR","body":"@adoroszlai , could you test if this could fix the problem?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2097110749/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2097415797","html_url":"https://github.com/apache/ratis/pull/1073#issuecomment-2097415797","issue_url":"https://api.github.com/repos/apache/ratis/issues/1073","id":2097415797,"node_id":"IC_kwDOBMxbGc59BAZ1","user":{"login":"OneSizeFitsQuorum","id":32640567,"node_id":"MDQ6VXNlcjMyNjQwNTY3","avatar_url":"https://avatars.githubusercontent.com/u/32640567?v=4","gravatar_id":"","url":"https://api.github.com/users/OneSizeFitsQuorum","html_url":"https://github.com/OneSizeFitsQuorum","followers_url":"https://api.github.com/users/OneSizeFitsQuorum/followers","following_url":"https://api.github.com/users/OneSizeFitsQuorum/following{/other_user}","gists_url":"https://api.github.com/users/OneSizeFitsQuorum/gists{/gist_id}","starred_url":"https://api.github.com/users/OneSizeFitsQuorum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OneSizeFitsQuorum/subscriptions","organizations_url":"https://api.github.com/users/OneSizeFitsQuorum/orgs","repos_url":"https://api.github.com/users/OneSizeFitsQuorum/repos","events_url":"https://api.github.com/users/OneSizeFitsQuorum/events{/privacy}","received_events_url":"https://api.github.com/users/OneSizeFitsQuorum/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-07T04:19:01Z","updated_at":"2024-05-07T04:19:01Z","author_association":"CONTRIBUTOR","body":"@szetszwo Thanks for your detailed review~","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2097415797/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2098821167","html_url":"https://github.com/apache/ratis/pull/1080#issuecomment-2098821167","issue_url":"https://api.github.com/repos/apache/ratis/issues/1080","id":2098821167,"node_id":"IC_kwDOBMxbGc59GXgv","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-07T16:10:22Z","updated_at":"2024-05-07T16:10:22Z","author_association":"CONTRIBUTOR","body":"> `Failed to close channel localhost:... in 10s` appears in 2 runs:\r\n\r\nBoth cases seem okay\r\n- split 7 iteration 5: Interrupted \r\n- split 9 iteration 1: Connection refused: localhost/127.0.0.1:15052 (network problem?)","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2098821167/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2098852246","html_url":"https://github.com/apache/ratis/pull/1080#issuecomment-2098852246","issue_url":"https://api.github.com/repos/apache/ratis/issues/1080","id":2098852246,"node_id":"IC_kwDOBMxbGc59GfGW","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-07T16:26:51Z","updated_at":"2024-05-07T16:26:51Z","author_association":"CONTRIBUTOR","body":"> [RATIS-2076](https://issues.apache.org/jira/browse/RATIS-2076) happened in 6 runs (about the same rate as previously)\r\n\r\nThere were 300 threads running.  I suspect the failures was due to slowness.  Let's try increasing the timeout.  ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2098852246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2098930047","html_url":"https://github.com/apache/ratis/pull/1081#issuecomment-2098930047","issue_url":"https://api.github.com/repos/apache/ratis/issues/1081","id":2098930047,"node_id":"IC_kwDOBMxbGc59GyF_","user":{"login":"duongkame","id":17348547,"node_id":"MDQ6VXNlcjE3MzQ4NTQ3","avatar_url":"https://avatars.githubusercontent.com/u/17348547?v=4","gravatar_id":"","url":"https://api.github.com/users/duongkame","html_url":"https://github.com/duongkame","followers_url":"https://api.github.com/users/duongkame/followers","following_url":"https://api.github.com/users/duongkame/following{/other_user}","gists_url":"https://api.github.com/users/duongkame/gists{/gist_id}","starred_url":"https://api.github.com/users/duongkame/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duongkame/subscriptions","organizations_url":"https://api.github.com/users/duongkame/orgs","repos_url":"https://api.github.com/users/duongkame/repos","events_url":"https://api.github.com/users/duongkame/events{/privacy}","received_events_url":"https://api.github.com/users/duongkame/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-07T17:12:38Z","updated_at":"2024-05-07T17:12:38Z","author_association":"CONTRIBUTOR","body":"cc. @szetszwo ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2098930047/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2099021995","html_url":"https://github.com/apache/ratis/pull/1080#issuecomment-2099021995","issue_url":"https://api.github.com/repos/apache/ratis/issues/1080","id":2099021995,"node_id":"IC_kwDOBMxbGc59HIir","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-07T18:09:37Z","updated_at":"2024-05-07T18:09:37Z","author_association":"CONTRIBUTOR","body":"> Let's try increasing the timeout.\r\n\r\nOnly 1/100 runs failed with 63490ea8:\r\nhttps://github.com/adoroszlai/ratis/actions/runs/8989894896/job/24693966187#step:6:7592","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2099021995/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2099052520","html_url":"https://github.com/apache/ratis/pull/1080#issuecomment-2099052520","issue_url":"https://api.github.com/repos/apache/ratis/issues/1080","id":2099052520,"node_id":"IC_kwDOBMxbGc59HP_o","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-07T18:27:16Z","updated_at":"2024-05-07T18:27:16Z","author_association":"CONTRIBUTOR","body":"@adoroszlai , thanks for testing and reviewing this!  Let's merge this PR first.  We can continue fixing the remaining problem on RATIS-2076.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2099052520/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2102042519","html_url":"https://github.com/apache/ratis/pull/1085#issuecomment-2102042519","issue_url":"https://api.github.com/repos/apache/ratis/issues/1085","id":2102042519,"node_id":"IC_kwDOBMxbGc59Sp-X","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-09T06:36:32Z","updated_at":"2024-05-09T06:36:32Z","author_association":"CONTRIBUTOR","body":"ping @codings-dan @szetszwo ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2102042519/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2103716573","html_url":"https://github.com/apache/ratis/pull/1085#issuecomment-2103716573","issue_url":"https://api.github.com/repos/apache/ratis/issues/1085","id":2103716573,"node_id":"IC_kwDOBMxbGc59ZCrd","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T02:04:40Z","updated_at":"2024-05-10T02:04:40Z","author_association":"CONTRIBUTOR","body":"I think https://issues.apache.org/jira/browse/RATIS-1860 meets the same issue and can fix the issue by ratis-shell.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2103716573/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2103800533","html_url":"https://github.com/apache/ratis/pull/1086#issuecomment-2103800533","issue_url":"https://api.github.com/repos/apache/ratis/issues/1086","id":2103800533,"node_id":"IC_kwDOBMxbGc59ZXLV","user":{"login":"ChenSammi","id":19790142,"node_id":"MDQ6VXNlcjE5NzkwMTQy","avatar_url":"https://avatars.githubusercontent.com/u/19790142?v=4","gravatar_id":"","url":"https://api.github.com/users/ChenSammi","html_url":"https://github.com/ChenSammi","followers_url":"https://api.github.com/users/ChenSammi/followers","following_url":"https://api.github.com/users/ChenSammi/following{/other_user}","gists_url":"https://api.github.com/users/ChenSammi/gists{/gist_id}","starred_url":"https://api.github.com/users/ChenSammi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ChenSammi/subscriptions","organizations_url":"https://api.github.com/users/ChenSammi/orgs","repos_url":"https://api.github.com/users/ChenSammi/repos","events_url":"https://api.github.com/users/ChenSammi/events{/privacy}","received_events_url":"https://api.github.com/users/ChenSammi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T03:39:17Z","updated_at":"2024-05-10T03:39:56Z","author_association":"CONTRIBUTOR","body":"@szetszwo , creating a Timer and a TimerThread for every SlidingWindow object and then closing it seems a bit inefficient.  So a static Timer is used here.  If you think this debug log is not necessary now,  I'm fine to remove it in this patch. ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2103800533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2104278359","html_url":"https://github.com/apache/ratis/pull/1082#issuecomment-2104278359","issue_url":"https://api.github.com/repos/apache/ratis/issues/1082","id":2104278359,"node_id":"IC_kwDOBMxbGc59bL1X","user":{"login":"guohao-rosicky","id":5122636,"node_id":"MDQ6VXNlcjUxMjI2MzY=","avatar_url":"https://avatars.githubusercontent.com/u/5122636?v=4","gravatar_id":"","url":"https://api.github.com/users/guohao-rosicky","html_url":"https://github.com/guohao-rosicky","followers_url":"https://api.github.com/users/guohao-rosicky/followers","following_url":"https://api.github.com/users/guohao-rosicky/following{/other_user}","gists_url":"https://api.github.com/users/guohao-rosicky/gists{/gist_id}","starred_url":"https://api.github.com/users/guohao-rosicky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guohao-rosicky/subscriptions","organizations_url":"https://api.github.com/users/guohao-rosicky/orgs","repos_url":"https://api.github.com/users/guohao-rosicky/repos","events_url":"https://api.github.com/users/guohao-rosicky/events{/privacy}","received_events_url":"https://api.github.com/users/guohao-rosicky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T09:31:46Z","updated_at":"2024-05-10T09:31:46Z","author_association":"CONTRIBUTOR","body":"+1 LGTM. Thanks @szetszwo work on this.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2104278359/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2104779232","html_url":"https://github.com/apache/ratis/pull/1082#issuecomment-2104779232","issue_url":"https://api.github.com/repos/apache/ratis/issues/1082","id":2104779232,"node_id":"IC_kwDOBMxbGc59dGHg","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T15:09:33Z","updated_at":"2024-05-10T15:09:33Z","author_association":"CONTRIBUTOR","body":"@guohao-rosicky , thanks a lots for reviewing this!","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2104779232/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2104784062","html_url":"https://github.com/apache/ratis/pull/1086#issuecomment-2104784062","issue_url":"https://api.github.com/repos/apache/ratis/issues/1086","id":2104784062,"node_id":"IC_kwDOBMxbGc59dHS-","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T15:12:37Z","updated_at":"2024-05-10T15:12:37Z","author_association":"CONTRIBUTOR","body":"@ChenSammi , please remove the debug then.  Thanks.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2104784062/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2104881007","html_url":"https://github.com/apache/ratis/pull/1089#issuecomment-2104881007","issue_url":"https://api.github.com/repos/apache/ratis/issues/1089","id":2104881007,"node_id":"IC_kwDOBMxbGc59de9v","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T16:18:21Z","updated_at":"2024-05-10T16:18:21Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo for reviewing and merging this.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2104881007/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2104882728","html_url":"https://github.com/apache/ratis/pull/1088#issuecomment-2104882728","issue_url":"https://api.github.com/repos/apache/ratis/issues/1088","id":2104882728,"node_id":"IC_kwDOBMxbGc59dfYo","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T16:19:34Z","updated_at":"2024-05-10T16:19:34Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo for reviewing and merging this.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2104882728/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2105002367","html_url":"https://github.com/apache/ratis/pull/1081#issuecomment-2105002367","issue_url":"https://api.github.com/repos/apache/ratis/issues/1081","id":2105002367,"node_id":"IC_kwDOBMxbGc59d8l_","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T17:31:30Z","updated_at":"2024-05-10T17:31:30Z","author_association":"CONTRIBUTOR","body":"@duongkame , thanks for the update!  There are some test failure with leak.  Please take a look.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2105002367/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2105049477","html_url":"https://github.com/apache/ratis/pull/1081#issuecomment-2105049477","issue_url":"https://api.github.com/repos/apache/ratis/issues/1081","id":2105049477,"node_id":"IC_kwDOBMxbGc59eIGF","user":{"login":"duongkame","id":17348547,"node_id":"MDQ6VXNlcjE3MzQ4NTQ3","avatar_url":"https://avatars.githubusercontent.com/u/17348547?v=4","gravatar_id":"","url":"https://api.github.com/users/duongkame","html_url":"https://github.com/duongkame","followers_url":"https://api.github.com/users/duongkame/followers","following_url":"https://api.github.com/users/duongkame/following{/other_user}","gists_url":"https://api.github.com/users/duongkame/gists{/gist_id}","starred_url":"https://api.github.com/users/duongkame/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duongkame/subscriptions","organizations_url":"https://api.github.com/users/duongkame/orgs","repos_url":"https://api.github.com/users/duongkame/repos","events_url":"https://api.github.com/users/duongkame/events{/privacy}","received_events_url":"https://api.github.com/users/duongkame/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T18:02:26Z","updated_at":"2024-05-10T18:02:41Z","author_association":"CONTRIBUTOR","body":"> @duongkame , thanks for the update! There are some test failure with leak. Please take a look.\r\n\r\nThe original error is test timed out after 100s. The leaks are there because GC is interrupted.\r\n\r\n```\r\n2024-05-10 16:41:31,890 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(863)) - gc interrupted.\r\n```\r\n\r\nWhen GC is not finished, LeakDetector can't finish its job. \r\n\r\n```\r\n    // GC to ensure leak detection work.\r\n    try {\r\n      RaftTestUtil.gc();\r\n    } catch (InterruptedException e) {\r\n      LOG.info(\"gc interrupted.\");\r\n    }\r\n    ReferenceCountedLeakDetector.getLeakDetector().assertNoLeaks();\r\n```","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2105049477/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2105060790","html_url":"https://github.com/apache/ratis/pull/1081#issuecomment-2105060790","issue_url":"https://api.github.com/repos/apache/ratis/issues/1081","id":2105060790,"node_id":"IC_kwDOBMxbGc59eK22","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T18:11:17Z","updated_at":"2024-05-10T18:11:17Z","author_association":"CONTRIBUTOR","body":"I see.  Let's restart the tests then.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2105060790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2105953787","html_url":"https://github.com/apache/ratis/pull/1090#issuecomment-2105953787","issue_url":"https://api.github.com/repos/apache/ratis/issues/1090","id":2105953787,"node_id":"IC_kwDOBMxbGc59hk37","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-11T16:53:34Z","updated_at":"2024-05-11T16:53:34Z","author_association":"CONTRIBUTOR","body":"@adoroszlai , thanks a lot for reviewing this!","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2105953787/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2106032715","html_url":"https://github.com/apache/ratis/pull/1081#issuecomment-2106032715","issue_url":"https://api.github.com/repos/apache/ratis/issues/1081","id":2106032715,"node_id":"IC_kwDOBMxbGc59h4JL","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-11T21:14:12Z","updated_at":"2024-05-11T21:14:12Z","author_association":"CONTRIBUTOR","body":"@duongkame , thanks for working on this!\r\n\r\n@symious , thanks for reviewing this!","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2106032715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2106343085","html_url":"https://github.com/apache/ratis/pull/1087#issuecomment-2106343085","issue_url":"https://api.github.com/repos/apache/ratis/issues/1087","id":2106343085,"node_id":"IC_kwDOBMxbGc59jD6t","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-12T18:51:55Z","updated_at":"2024-05-12T18:51:55Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo for the review.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2106343085/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2108125227","html_url":"https://github.com/apache/ratis/pull/1086#issuecomment-2108125227","issue_url":"https://api.github.com/repos/apache/ratis/issues/1086","id":2108125227,"node_id":"IC_kwDOBMxbGc59p3Ar","user":{"login":"jojochuang","id":2691807,"node_id":"MDQ6VXNlcjI2OTE4MDc=","avatar_url":"https://avatars.githubusercontent.com/u/2691807?v=4","gravatar_id":"","url":"https://api.github.com/users/jojochuang","html_url":"https://github.com/jojochuang","followers_url":"https://api.github.com/users/jojochuang/followers","following_url":"https://api.github.com/users/jojochuang/following{/other_user}","gists_url":"https://api.github.com/users/jojochuang/gists{/gist_id}","starred_url":"https://api.github.com/users/jojochuang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jojochuang/subscriptions","organizations_url":"https://api.github.com/users/jojochuang/orgs","repos_url":"https://api.github.com/users/jojochuang/repos","events_url":"https://api.github.com/users/jojochuang/events{/privacy}","received_events_url":"https://api.github.com/users/jojochuang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-13T16:14:15Z","updated_at":"2024-05-13T16:14:15Z","author_association":"CONTRIBUTOR","body":"Thanks Sammi!","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2108125227/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2109057914","html_url":"https://github.com/apache/ratis/pull/1092#issuecomment-2109057914","issue_url":"https://api.github.com/repos/apache/ratis/issues/1092","id":2109057914,"node_id":"IC_kwDOBMxbGc59tat6","user":{"login":"symious","id":14933944,"node_id":"MDQ6VXNlcjE0OTMzOTQ0","avatar_url":"https://avatars.githubusercontent.com/u/14933944?v=4","gravatar_id":"","url":"https://api.github.com/users/symious","html_url":"https://github.com/symious","followers_url":"https://api.github.com/users/symious/followers","following_url":"https://api.github.com/users/symious/following{/other_user}","gists_url":"https://api.github.com/users/symious/gists{/gist_id}","starred_url":"https://api.github.com/users/symious/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/symious/subscriptions","organizations_url":"https://api.github.com/users/symious/orgs","repos_url":"https://api.github.com/users/symious/repos","events_url":"https://api.github.com/users/symious/events{/privacy}","received_events_url":"https://api.github.com/users/symious/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-14T00:36:47Z","updated_at":"2024-05-14T00:36:47Z","author_association":"CONTRIBUTOR","body":"@szetszwo PTAL.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2109057914/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2109304942","html_url":"https://github.com/apache/ratis/pull/1082#issuecomment-2109304942","issue_url":"https://api.github.com/repos/apache/ratis/issues/1082","id":2109304942,"node_id":"IC_kwDOBMxbGc59uXBu","user":{"login":"guohao-rosicky","id":5122636,"node_id":"MDQ6VXNlcjUxMjI2MzY=","avatar_url":"https://avatars.githubusercontent.com/u/5122636?v=4","gravatar_id":"","url":"https://api.github.com/users/guohao-rosicky","html_url":"https://github.com/guohao-rosicky","followers_url":"https://api.github.com/users/guohao-rosicky/followers","following_url":"https://api.github.com/users/guohao-rosicky/following{/other_user}","gists_url":"https://api.github.com/users/guohao-rosicky/gists{/gist_id}","starred_url":"https://api.github.com/users/guohao-rosicky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guohao-rosicky/subscriptions","organizations_url":"https://api.github.com/users/guohao-rosicky/orgs","repos_url":"https://api.github.com/users/guohao-rosicky/repos","events_url":"https://api.github.com/users/guohao-rosicky/events{/privacy}","received_events_url":"https://api.github.com/users/guohao-rosicky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-14T05:18:37Z","updated_at":"2024-05-14T05:18:37Z","author_association":"CONTRIBUTOR","body":"Hi @szetszwo, Did you find anything wrong and why revert this commit?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2109304942/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2109363882","html_url":"https://github.com/apache/ratis/pull/1091#issuecomment-2109363882","issue_url":"https://api.github.com/repos/apache/ratis/issues/1091","id":2109363882,"node_id":"IC_kwDOBMxbGc59ulaq","user":{"login":"SzyWilliam","id":48054931,"node_id":"MDQ6VXNlcjQ4MDU0OTMx","avatar_url":"https://avatars.githubusercontent.com/u/48054931?v=4","gravatar_id":"","url":"https://api.github.com/users/SzyWilliam","html_url":"https://github.com/SzyWilliam","followers_url":"https://api.github.com/users/SzyWilliam/followers","following_url":"https://api.github.com/users/SzyWilliam/following{/other_user}","gists_url":"https://api.github.com/users/SzyWilliam/gists{/gist_id}","starred_url":"https://api.github.com/users/SzyWilliam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SzyWilliam/subscriptions","organizations_url":"https://api.github.com/users/SzyWilliam/orgs","repos_url":"https://api.github.com/users/SzyWilliam/repos","events_url":"https://api.github.com/users/SzyWilliam/events{/privacy}","received_events_url":"https://api.github.com/users/SzyWilliam/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-14T06:11:42Z","updated_at":"2024-05-14T06:11:42Z","author_association":"MEMBER","body":"@szetszwo, thanks for reviewing this!\r\n\r\nThe original `configurationManager` before the patch will produce another `IllegalStateException` as follows:\r\n```java\r\n2024-05-14 13:46:03,722 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(123)) - s4: Failed INSTALL_SNAPSHOT request cid=0, isHeartbeat? false\r\njava.lang.IllegalStateException\r\n\tat org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:35)\r\n\tat org.apache.ratis.server.impl.ConfigurationManager.addConfiguration(ConfigurationManager.java:68)\r\n\tat org.apache.ratis.server.impl.ServerState.setRaftConf(ServerState.java:382)\r\n\tat org.apache.ratis.server.impl.ServerState.setRaftConf(ServerState.java:375)\r\n\tat org.apache.ratis.server.impl.SnapshotInstallationHandler.installSnapshotImpl(SnapshotInstallationHandler.java:138)\r\n\tat org.apache.ratis.server.impl.SnapshotInstallationHandler.installSnapshot(SnapshotInstallationHandler.java:97)\r\n\tat org.apache.ratis.server.impl.RaftServerImpl.installSnapshot(RaftServerImpl.java:1652)\r\n\tat org.apache.ratis.server.impl.RaftServerProxy.installSnapshot(RaftServerProxy.java:674)\r\n\tat org.apache.ratis.grpc.server.GrpcServerProtocolService$2.process(GrpcServerProtocolService.java:341)\r\n\tat org.apache.ratis.grpc.server.GrpcServerProtocolService$2.process(GrpcServerProtocolService.java:338)\r\n\tat org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.process(GrpcServerProtocolService.java:106)\r\n\tat org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:174)\r\n\tat org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)\r\n\tat org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:329)\r\n\tat org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:314)\r\n\tat org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:833)\r\n\tat org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\r\n\tat org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:750)\r\n```\r\n\r\nThe event sequence that triggers the exception is as follows (a little bit tricky):\r\n1. Original raft group [A,B,C] with A as the leader.\r\n2. Leader A receives setConfiguration [A,B,C,D,E] from client. This setConf request will form a configuration change log L0 (old=[A,B,C], new=[A,B,C,D,E]).\r\n3. Leader A replicates the snapshot and logs(up to L0, which is uncommitted) to D, E. \r\n4. D and E receive L0 and they both append this configuration to the `configurationManager`. \r\n5. B and C do not receive L0 so the L0 remains uncommitted.\r\n6. Unfortunately, leader A crashes, this client request setConfiguration also fails.\r\n7. B is elected as the new leader. The first thing B comes to power is to replicate a group configuration log L1 (old=[A,B,C], new=[A,B,C]) to establish its leader authority. NOTICE this log L1 shares the same index as L0 (the first uncommited index).\r\n8. Client retries the setConfiguration [A,B,C,D,E]. B tries to append log L1 to D and E. Since D and E's `configurationManager` already contain a configuration at index L0, this new configuration L1 will be rejected and the `IllegalStateException` will be thrown.\r\n\r\nSo back to the question, I think we should not allow two confs with the same **committed** index. For the uncommitted confs, we should force it to be aligned with the current leader (just as Raft Algo will truncates those conflicting local uncommitted logs). What do you think?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2109363882/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2109482801","html_url":"https://github.com/apache/ratis/pull/1082#issuecomment-2109482801","issue_url":"https://api.github.com/repos/apache/ratis/issues/1082","id":2109482801,"node_id":"IC_kwDOBMxbGc59vCcx","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-14T07:32:12Z","updated_at":"2024-05-14T07:32:12Z","author_association":"CONTRIBUTOR","body":"@guohao-rosicky , the leader election tests seem to fail more often.  So, I have reverted this.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2109482801/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2109556803","html_url":"https://github.com/apache/ratis/pull/1072#issuecomment-2109556803","issue_url":"https://api.github.com/repos/apache/ratis/issues/1072","id":2109556803,"node_id":"IC_kwDOBMxbGc59vUhD","user":{"login":"ChenSammi","id":19790142,"node_id":"MDQ6VXNlcjE5NzkwMTQy","avatar_url":"https://avatars.githubusercontent.com/u/19790142?v=4","gravatar_id":"","url":"https://api.github.com/users/ChenSammi","html_url":"https://github.com/ChenSammi","followers_url":"https://api.github.com/users/ChenSammi/followers","following_url":"https://api.github.com/users/ChenSammi/following{/other_user}","gists_url":"https://api.github.com/users/ChenSammi/gists{/gist_id}","starred_url":"https://api.github.com/users/ChenSammi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ChenSammi/subscriptions","organizations_url":"https://api.github.com/users/ChenSammi/orgs","repos_url":"https://api.github.com/users/ChenSammi/repos","events_url":"https://api.github.com/users/ChenSammi/events{/privacy}","received_events_url":"https://api.github.com/users/ChenSammi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-14T08:14:20Z","updated_at":"2024-05-14T08:14:20Z","author_association":"CONTRIBUTOR","body":"@szetszwo ,  could you re-trigger the CI?  The failed TestSegmentedRaftLog passed locally. ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2109556803/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2110771393","html_url":"https://github.com/apache/ratis/pull/1082#issuecomment-2110771393","issue_url":"https://api.github.com/repos/apache/ratis/issues/1082","id":2110771393,"node_id":"IC_kwDOBMxbGc59z9DB","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-14T17:33:00Z","updated_at":"2024-05-14T17:33:00Z","author_association":"CONTRIBUTOR","body":"@guohao-rosicky , BTW, RATIS-2076 has fixed `LeaderElection.shutdown()`. It seems that we no longer need this change.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2110771393/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2111583010","html_url":"https://github.com/apache/ratis/pull/1093#issuecomment-2111583010","issue_url":"https://api.github.com/repos/apache/ratis/issues/1093","id":2111583010,"node_id":"IC_kwDOBMxbGc593DMi","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-15T04:56:26Z","updated_at":"2024-05-15T04:56:38Z","author_association":"CONTRIBUTOR","body":"Thanks @paliwalashish, @szetszwo, @SzyWilliam for the review.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2111583010/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2114007865","html_url":"https://github.com/apache/ratis/pull/1072#issuecomment-2114007865","issue_url":"https://api.github.com/repos/apache/ratis/issues/1072","id":2114007865,"node_id":"IC_kwDOBMxbGc5-ATM5","user":{"login":"ChenSammi","id":19790142,"node_id":"MDQ6VXNlcjE5NzkwMTQy","avatar_url":"https://avatars.githubusercontent.com/u/19790142?v=4","gravatar_id":"","url":"https://api.github.com/users/ChenSammi","html_url":"https://github.com/ChenSammi","followers_url":"https://api.github.com/users/ChenSammi/followers","following_url":"https://api.github.com/users/ChenSammi/following{/other_user}","gists_url":"https://api.github.com/users/ChenSammi/gists{/gist_id}","starred_url":"https://api.github.com/users/ChenSammi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ChenSammi/subscriptions","organizations_url":"https://api.github.com/users/ChenSammi/orgs","repos_url":"https://api.github.com/users/ChenSammi/repos","events_url":"https://api.github.com/users/ChenSammi/events{/privacy}","received_events_url":"https://api.github.com/users/ChenSammi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-16T04:36:12Z","updated_at":"2024-05-16T04:36:12Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo . ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2114007865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2116462321","html_url":"https://github.com/apache/ratis/pull/1084#issuecomment-2116462321","issue_url":"https://api.github.com/repos/apache/ratis/issues/1084","id":2116462321,"node_id":"IC_kwDOBMxbGc5-Jqbx","user":{"login":"symious","id":14933944,"node_id":"MDQ6VXNlcjE0OTMzOTQ0","avatar_url":"https://avatars.githubusercontent.com/u/14933944?v=4","gravatar_id":"","url":"https://api.github.com/users/symious","html_url":"https://github.com/symious","followers_url":"https://api.github.com/users/symious/followers","following_url":"https://api.github.com/users/symious/following{/other_user}","gists_url":"https://api.github.com/users/symious/gists{/gist_id}","starred_url":"https://api.github.com/users/symious/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/symious/subscriptions","organizations_url":"https://api.github.com/users/symious/orgs","repos_url":"https://api.github.com/users/symious/repos","events_url":"https://api.github.com/users/symious/events{/privacy}","received_events_url":"https://api.github.com/users/symious/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T01:24:01Z","updated_at":"2024-05-17T01:24:01Z","author_association":"CONTRIBUTOR","body":"@szetszwo Updated the comment, PTAL.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2116462321/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2116464922","html_url":"https://github.com/apache/ratis/pull/1084#issuecomment-2116464922","issue_url":"https://api.github.com/repos/apache/ratis/issues/1084","id":2116464922,"node_id":"IC_kwDOBMxbGc5-JrEa","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T01:27:21Z","updated_at":"2024-05-17T01:27:21Z","author_association":"CONTRIBUTOR","body":"@symious , could you also update the title?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2116464922/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2116466787","html_url":"https://github.com/apache/ratis/pull/1084#issuecomment-2116466787","issue_url":"https://api.github.com/repos/apache/ratis/issues/1084","id":2116466787,"node_id":"IC_kwDOBMxbGc5-Jrhj","user":{"login":"symious","id":14933944,"node_id":"MDQ6VXNlcjE0OTMzOTQ0","avatar_url":"https://avatars.githubusercontent.com/u/14933944?v=4","gravatar_id":"","url":"https://api.github.com/users/symious","html_url":"https://github.com/symious","followers_url":"https://api.github.com/users/symious/followers","following_url":"https://api.github.com/users/symious/following{/other_user}","gists_url":"https://api.github.com/users/symious/gists{/gist_id}","starred_url":"https://api.github.com/users/symious/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/symious/subscriptions","organizations_url":"https://api.github.com/users/symious/orgs","repos_url":"https://api.github.com/users/symious/repos","events_url":"https://api.github.com/users/symious/events{/privacy}","received_events_url":"https://api.github.com/users/symious/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T01:29:28Z","updated_at":"2024-05-17T01:29:28Z","author_association":"CONTRIBUTOR","body":"@szetszwo Updated, thanks for the review.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2116466787/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2123849300","html_url":"https://github.com/apache/ratis/pull/1097#issuecomment-2123849300","issue_url":"https://api.github.com/repos/apache/ratis/issues/1097","id":2123849300,"node_id":"IC_kwDOBMxbGc5-l15U","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-22T04:35:53Z","updated_at":"2024-05-22T04:35:53Z","author_association":"CONTRIBUTOR","body":"Passed 100 times https://github.com/szetszwo/ratis/actions/runs/9184276839","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2123849300/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2123866207","html_url":"https://github.com/apache/ratis/pull/1097#issuecomment-2123866207","issue_url":"https://api.github.com/repos/apache/ratis/issues/1097","id":2123866207,"node_id":"IC_kwDOBMxbGc5-l6Bf","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-22T04:56:07Z","updated_at":"2024-05-22T04:56:07Z","author_association":"CONTRIBUTOR","body":"With out this change, the test does fail on the master branch https://github.com/szetszwo/ratis/actions/runs/9185440159","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2123866207/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2124144153","html_url":"https://github.com/apache/ratis/pull/1082#issuecomment-2124144153","issue_url":"https://api.github.com/repos/apache/ratis/issues/1082","id":2124144153,"node_id":"IC_kwDOBMxbGc5-m94Z","user":{"login":"guohao-rosicky","id":5122636,"node_id":"MDQ6VXNlcjUxMjI2MzY=","avatar_url":"https://avatars.githubusercontent.com/u/5122636?v=4","gravatar_id":"","url":"https://api.github.com/users/guohao-rosicky","html_url":"https://github.com/guohao-rosicky","followers_url":"https://api.github.com/users/guohao-rosicky/followers","following_url":"https://api.github.com/users/guohao-rosicky/following{/other_user}","gists_url":"https://api.github.com/users/guohao-rosicky/gists{/gist_id}","starred_url":"https://api.github.com/users/guohao-rosicky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guohao-rosicky/subscriptions","organizations_url":"https://api.github.com/users/guohao-rosicky/orgs","repos_url":"https://api.github.com/users/guohao-rosicky/repos","events_url":"https://api.github.com/users/guohao-rosicky/events{/privacy}","received_events_url":"https://api.github.com/users/guohao-rosicky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-22T08:11:00Z","updated_at":"2024-05-22T08:11:00Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo. I see [RATIS-2076](https://issues.apache.org/jira/browse/RATIS-2076).","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2124144153/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2125133387","html_url":"https://github.com/apache/ratis/pull/1097#issuecomment-2125133387","issue_url":"https://api.github.com/repos/apache/ratis/issues/1097","id":2125133387,"node_id":"IC_kwDOBMxbGc5-qvZL","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-22T15:50:03Z","updated_at":"2024-05-22T15:50:03Z","author_association":"CONTRIBUTOR","body":"@adoroszlai , thanks for the review!  I have applied your suggestion.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2125133387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2125366167","html_url":"https://github.com/apache/ratis/pull/1097#issuecomment-2125366167","issue_url":"https://api.github.com/repos/apache/ratis/issues/1097","id":2125366167,"node_id":"IC_kwDOBMxbGc5-roOX","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-22T17:17:50Z","updated_at":"2024-05-22T17:17:50Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo for updating the patch.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2125366167/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2125786346","html_url":"https://github.com/apache/ratis/pull/1098#issuecomment-2125786346","issue_url":"https://api.github.com/repos/apache/ratis/issues/1098","id":2125786346,"node_id":"IC_kwDOBMxbGc5-tOzq","user":{"login":"DaveTeng0","id":109315747,"node_id":"U_kgDOBoQGow","avatar_url":"https://avatars.githubusercontent.com/u/109315747?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveTeng0","html_url":"https://github.com/DaveTeng0","followers_url":"https://api.github.com/users/DaveTeng0/followers","following_url":"https://api.github.com/users/DaveTeng0/following{/other_user}","gists_url":"https://api.github.com/users/DaveTeng0/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveTeng0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveTeng0/subscriptions","organizations_url":"https://api.github.com/users/DaveTeng0/orgs","repos_url":"https://api.github.com/users/DaveTeng0/repos","events_url":"https://api.github.com/users/DaveTeng0/events{/privacy}","received_events_url":"https://api.github.com/users/DaveTeng0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-22T21:30:00Z","updated_at":"2024-05-22T21:30:00Z","author_association":"CONTRIBUTOR","body":"cc. @szetszwo ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2125786346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2128005034","html_url":"https://github.com/apache/ratis/pull/1098#issuecomment-2128005034","issue_url":"https://api.github.com/repos/apache/ratis/issues/1098","id":2128005034,"node_id":"IC_kwDOBMxbGc5-1seq","user":{"login":"DaveTeng0","id":109315747,"node_id":"U_kgDOBoQGow","avatar_url":"https://avatars.githubusercontent.com/u/109315747?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveTeng0","html_url":"https://github.com/DaveTeng0","followers_url":"https://api.github.com/users/DaveTeng0/followers","following_url":"https://api.github.com/users/DaveTeng0/following{/other_user}","gists_url":"https://api.github.com/users/DaveTeng0/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveTeng0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveTeng0/subscriptions","organizations_url":"https://api.github.com/users/DaveTeng0/orgs","repos_url":"https://api.github.com/users/DaveTeng0/repos","events_url":"https://api.github.com/users/DaveTeng0/events{/privacy}","received_events_url":"https://api.github.com/users/DaveTeng0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-23T20:56:44Z","updated_at":"2024-05-23T20:56:44Z","author_association":"CONTRIBUTOR","body":"For reference, the reason I can't use ratis's AbstractRatisCommand and it's suite of subcommands in Ozone's shell directly is because Ozone shell uses [picocli](https://github.com/apache/ozone/blob/master/hadoop-hdds/tools/src/main/java/org/apache/hadoop/hdds/cli/OzoneAdmin.java#L26) framework, and Ratis shell uses [apache.commons.cli.CommandLine](https://github.com/apache/ratis/blob/master/ratis-shell/src/main/java/org/apache/ratis/shell/cli/sh/command/AbstractRatisCommand.java#L24-L25) framework.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2128005034/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2128016581","html_url":"https://github.com/apache/ratis/pull/1098#issuecomment-2128016581","issue_url":"https://api.github.com/repos/apache/ratis/issues/1098","id":2128016581,"node_id":"IC_kwDOBMxbGc5-1vTF","user":{"login":"DaveTeng0","id":109315747,"node_id":"U_kgDOBoQGow","avatar_url":"https://avatars.githubusercontent.com/u/109315747?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveTeng0","html_url":"https://github.com/DaveTeng0","followers_url":"https://api.github.com/users/DaveTeng0/followers","following_url":"https://api.github.com/users/DaveTeng0/following{/other_user}","gists_url":"https://api.github.com/users/DaveTeng0/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveTeng0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveTeng0/subscriptions","organizations_url":"https://api.github.com/users/DaveTeng0/orgs","repos_url":"https://api.github.com/users/DaveTeng0/repos","events_url":"https://api.github.com/users/DaveTeng0/events{/privacy}","received_events_url":"https://api.github.com/users/DaveTeng0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-23T21:04:21Z","updated_at":"2024-05-23T21:04:21Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo suggestion, I'll separate the security related features (changes of ratis-shell/src/main/java/org/apache/ratis/shell/cli/SecurityUtils.java) to another jira/PR later. I think for now Ozone shell doesn't need that part of security utility feature from the ratis side since Ozone has its own way of getting client's certificate and build ratis client on ozone's side and then pass client to methods in new utility class (ratis-shell/src/main/java/org/apache/ratis/shell/cli/RaftUtils.java) to call ratis server. ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2128016581/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2128020652","html_url":"https://github.com/apache/ratis/pull/1098#issuecomment-2128020652","issue_url":"https://api.github.com/repos/apache/ratis/issues/1098","id":2128020652,"node_id":"IC_kwDOBMxbGc5-1wSs","user":{"login":"DaveTeng0","id":109315747,"node_id":"U_kgDOBoQGow","avatar_url":"https://avatars.githubusercontent.com/u/109315747?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveTeng0","html_url":"https://github.com/DaveTeng0","followers_url":"https://api.github.com/users/DaveTeng0/followers","following_url":"https://api.github.com/users/DaveTeng0/following{/other_user}","gists_url":"https://api.github.com/users/DaveTeng0/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveTeng0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveTeng0/subscriptions","organizations_url":"https://api.github.com/users/DaveTeng0/orgs","repos_url":"https://api.github.com/users/DaveTeng0/repos","events_url":"https://api.github.com/users/DaveTeng0/events{/privacy}","received_events_url":"https://api.github.com/users/DaveTeng0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-23T21:07:26Z","updated_at":"2024-05-23T21:07:26Z","author_association":"CONTRIBUTOR","body":"Also, I'll revert changes in those subcommands of AbstractRatisCommand and keep original _processReply_ method in AbstractRatisCommand.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2128020652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2128834956","html_url":"https://github.com/apache/ratis/pull/1101#issuecomment-2128834956","issue_url":"https://api.github.com/repos/apache/ratis/issues/1101","id":2128834956,"node_id":"IC_kwDOBMxbGc5-43GM","user":{"login":"OneSizeFitsQuorum","id":32640567,"node_id":"MDQ6VXNlcjMyNjQwNTY3","avatar_url":"https://avatars.githubusercontent.com/u/32640567?v=4","gravatar_id":"","url":"https://api.github.com/users/OneSizeFitsQuorum","html_url":"https://github.com/OneSizeFitsQuorum","followers_url":"https://api.github.com/users/OneSizeFitsQuorum/followers","following_url":"https://api.github.com/users/OneSizeFitsQuorum/following{/other_user}","gists_url":"https://api.github.com/users/OneSizeFitsQuorum/gists{/gist_id}","starred_url":"https://api.github.com/users/OneSizeFitsQuorum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OneSizeFitsQuorum/subscriptions","organizations_url":"https://api.github.com/users/OneSizeFitsQuorum/orgs","repos_url":"https://api.github.com/users/OneSizeFitsQuorum/repos","events_url":"https://api.github.com/users/OneSizeFitsQuorum/events{/privacy}","received_events_url":"https://api.github.com/users/OneSizeFitsQuorum/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-24T07:52:06Z","updated_at":"2024-05-24T07:52:06Z","author_association":"CONTRIBUTOR","body":"@szetszwo PTAL","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2128834956/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2129011712","html_url":"https://github.com/apache/ratis/pull/1100#issuecomment-2129011712","issue_url":"https://api.github.com/repos/apache/ratis/issues/1100","id":2129011712,"node_id":"IC_kwDOBMxbGc5-5iQA","user":{"login":"symious","id":14933944,"node_id":"MDQ6VXNlcjE0OTMzOTQ0","avatar_url":"https://avatars.githubusercontent.com/u/14933944?v=4","gravatar_id":"","url":"https://api.github.com/users/symious","html_url":"https://github.com/symious","followers_url":"https://api.github.com/users/symious/followers","following_url":"https://api.github.com/users/symious/following{/other_user}","gists_url":"https://api.github.com/users/symious/gists{/gist_id}","starred_url":"https://api.github.com/users/symious/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/symious/subscriptions","organizations_url":"https://api.github.com/users/symious/orgs","repos_url":"https://api.github.com/users/symious/repos","events_url":"https://api.github.com/users/symious/events{/privacy}","received_events_url":"https://api.github.com/users/symious/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-24T09:04:10Z","updated_at":"2024-05-24T09:04:10Z","author_association":"CONTRIBUTOR","body":"@szetszwo Updated as the provided patch, PTAL.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2129011712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2129891965","html_url":"https://github.com/apache/ratis/pull/1099#issuecomment-2129891965","issue_url":"https://api.github.com/repos/apache/ratis/issues/1099","id":2129891965,"node_id":"IC_kwDOBMxbGc5-85J9","user":{"login":"duongkame","id":17348547,"node_id":"MDQ6VXNlcjE3MzQ4NTQ3","avatar_url":"https://avatars.githubusercontent.com/u/17348547?v=4","gravatar_id":"","url":"https://api.github.com/users/duongkame","html_url":"https://github.com/duongkame","followers_url":"https://api.github.com/users/duongkame/followers","following_url":"https://api.github.com/users/duongkame/following{/other_user}","gists_url":"https://api.github.com/users/duongkame/gists{/gist_id}","starred_url":"https://api.github.com/users/duongkame/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duongkame/subscriptions","organizations_url":"https://api.github.com/users/duongkame/orgs","repos_url":"https://api.github.com/users/duongkame/repos","events_url":"https://api.github.com/users/duongkame/events{/privacy}","received_events_url":"https://api.github.com/users/duongkame/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-24T16:02:35Z","updated_at":"2024-05-24T16:02:35Z","author_association":"CONTRIBUTOR","body":"Thanks for the review @szetszwo .","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2129891965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2130129609","html_url":"https://github.com/apache/ratis/pull/1096#issuecomment-2130129609","issue_url":"https://api.github.com/repos/apache/ratis/issues/1096","id":2130129609,"node_id":"IC_kwDOBMxbGc5-9zLJ","user":{"login":"duongkame","id":17348547,"node_id":"MDQ6VXNlcjE3MzQ4NTQ3","avatar_url":"https://avatars.githubusercontent.com/u/17348547?v=4","gravatar_id":"","url":"https://api.github.com/users/duongkame","html_url":"https://github.com/duongkame","followers_url":"https://api.github.com/users/duongkame/followers","following_url":"https://api.github.com/users/duongkame/following{/other_user}","gists_url":"https://api.github.com/users/duongkame/gists{/gist_id}","starred_url":"https://api.github.com/users/duongkame/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duongkame/subscriptions","organizations_url":"https://api.github.com/users/duongkame/orgs","repos_url":"https://api.github.com/users/duongkame/repos","events_url":"https://api.github.com/users/duongkame/events{/privacy}","received_events_url":"https://api.github.com/users/duongkame/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-24T18:25:54Z","updated_at":"2024-05-24T18:25:54Z","author_association":"CONTRIBUTOR","body":"@szetszwo can you have a look?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2130129609/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2130219305","html_url":"https://github.com/apache/ratis/pull/1100#issuecomment-2130219305","issue_url":"https://api.github.com/repos/apache/ratis/issues/1100","id":2130219305,"node_id":"IC_kwDOBMxbGc5--JEp","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-24T19:21:16Z","updated_at":"2024-05-24T19:21:16Z","author_association":"CONTRIBUTOR","body":"@symious , on a second thought, we should keep `EMPTY_ARRAY` since it is in `ratis-server-api`.  Also, let's move `PRIVATE_CACHE` inside a class and make it private; see below.  Could you file a followup JIRA and submit another pull request?\r\n```java\r\ndiff --git a/ratis-server-api/src/main/java/org/apache/ratis/server/protocol/TermIndex.java b/ratis-server-api/src/main/java/org/apache/ratis/server/protocol/TermIndex.java\r\nindex 6a9bd1cfb7..d43ec5d058 100644\r\n--- a/ratis-server-api/src/main/java/org/apache/ratis/server/protocol/TermIndex.java\r\n+++ b/ratis-server-api/src/main/java/org/apache/ratis/server/protocol/TermIndex.java\r\n@@ -29,11 +29,15 @@ import java.util.concurrent.TimeUnit;\r\n \r\n /** The term and the log index defined in the Raft consensus algorithm. */\r\n public interface TermIndex extends Comparable<TermIndex> {\r\n-  /** An LRU Cache for {@link TermIndex} instances */\r\n-  Cache<TermIndex, TermIndex> PRIVATE_CACHE = CacheBuilder.newBuilder()\r\n-      .maximumSize(1 << 16)\r\n-      .expireAfterAccess(1, TimeUnit.MINUTES)\r\n-      .build();\r\n+  class Util {\r\n+    /** An LRU Cache for {@link TermIndex} instances */\r\n+    private static final Cache<TermIndex, TermIndex> CACHE = CacheBuilder.newBuilder()\r\n+        .maximumSize(1 << 16)\r\n+        .expireAfterAccess(1, TimeUnit.MINUTES)\r\n+        .build();\r\n+  }\r\n+\r\n+  TermIndex[] EMPTY_ARRAY = {};\r\n \r\n   /** @return the term. */\r\n   long getTerm();\r\n@@ -107,7 +111,7 @@ public interface TermIndex extends Comparable<TermIndex> {\r\n       }\r\n     };\r\n     try {\r\n-      return PRIVATE_CACHE.get(key, () -> key);\r\n+      return Util.CACHE.get(key, () -> key);\r\n     } catch (ExecutionException e) {\r\n       throw new IllegalStateException(\"Failed to valueOf(\" + term + \", \" + index + \"), key=\" + key, e);\r\n     }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2130219305/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2130526440","html_url":"https://github.com/apache/ratis/pull/1096#issuecomment-2130526440","issue_url":"https://api.github.com/repos/apache/ratis/issues/1096","id":2130526440,"node_id":"IC_kwDOBMxbGc5-_UDo","user":{"login":"duongkame","id":17348547,"node_id":"MDQ6VXNlcjE3MzQ4NTQ3","avatar_url":"https://avatars.githubusercontent.com/u/17348547?v=4","gravatar_id":"","url":"https://api.github.com/users/duongkame","html_url":"https://github.com/duongkame","followers_url":"https://api.github.com/users/duongkame/followers","following_url":"https://api.github.com/users/duongkame/following{/other_user}","gists_url":"https://api.github.com/users/duongkame/gists{/gist_id}","starred_url":"https://api.github.com/users/duongkame/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duongkame/subscriptions","organizations_url":"https://api.github.com/users/duongkame/orgs","repos_url":"https://api.github.com/users/duongkame/repos","events_url":"https://api.github.com/users/duongkame/events{/privacy}","received_events_url":"https://api.github.com/users/duongkame/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-24T23:54:24Z","updated_at":"2024-05-24T23:54:24Z","author_association":"CONTRIBUTOR","body":"Thanks for merging it @szetszwo . Sorry, I have to ask for another favor, can release a snapshot version after this commit? ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2130526440/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2130574206","html_url":"https://github.com/apache/ratis/pull/1100#issuecomment-2130574206","issue_url":"https://api.github.com/repos/apache/ratis/issues/1100","id":2130574206,"node_id":"IC_kwDOBMxbGc5-_ft-","user":{"login":"symious","id":14933944,"node_id":"MDQ6VXNlcjE0OTMzOTQ0","avatar_url":"https://avatars.githubusercontent.com/u/14933944?v=4","gravatar_id":"","url":"https://api.github.com/users/symious","html_url":"https://github.com/symious","followers_url":"https://api.github.com/users/symious/followers","following_url":"https://api.github.com/users/symious/following{/other_user}","gists_url":"https://api.github.com/users/symious/gists{/gist_id}","starred_url":"https://api.github.com/users/symious/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/symious/subscriptions","organizations_url":"https://api.github.com/users/symious/orgs","repos_url":"https://api.github.com/users/symious/repos","events_url":"https://api.github.com/users/symious/events{/privacy}","received_events_url":"https://api.github.com/users/symious/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-25T00:31:02Z","updated_at":"2024-05-25T00:31:02Z","author_association":"CONTRIBUTOR","body":"Sure, for the empty areay,does that mean we shouldn't delete the public things once they are introduced in case other users' imports?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2130574206/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2130647291","html_url":"https://github.com/apache/ratis/pull/1103#issuecomment-2130647291","issue_url":"https://api.github.com/repos/apache/ratis/issues/1103","id":2130647291,"node_id":"IC_kwDOBMxbGc5-_xj7","user":{"login":"symious","id":14933944,"node_id":"MDQ6VXNlcjE0OTMzOTQ0","avatar_url":"https://avatars.githubusercontent.com/u/14933944?v=4","gravatar_id":"","url":"https://api.github.com/users/symious","html_url":"https://github.com/symious","followers_url":"https://api.github.com/users/symious/followers","following_url":"https://api.github.com/users/symious/following{/other_user}","gists_url":"https://api.github.com/users/symious/gists{/gist_id}","starred_url":"https://api.github.com/users/symious/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/symious/subscriptions","organizations_url":"https://api.github.com/users/symious/orgs","repos_url":"https://api.github.com/users/symious/repos","events_url":"https://api.github.com/users/symious/events{/privacy}","received_events_url":"https://api.github.com/users/symious/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-25T01:32:22Z","updated_at":"2024-05-25T01:32:22Z","author_association":"CONTRIBUTOR","body":"@szetszwo PTAL.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2130647291/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2130707212","html_url":"https://github.com/apache/ratis/pull/1100#issuecomment-2130707212","issue_url":"https://api.github.com/repos/apache/ratis/issues/1100","id":2130707212,"node_id":"IC_kwDOBMxbGc5_AAMM","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-25T03:05:27Z","updated_at":"2024-05-25T03:05:27Z","author_association":"CONTRIBUTOR","body":"> ... we shouldn't delete the public things once they are introduced ...\r\n\r\nWe can deprecate it first and the delete it in the next major release (e.g. 4.0.0).","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2130707212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2131264368","html_url":"https://github.com/apache/ratis/pull/1096#issuecomment-2131264368","issue_url":"https://api.github.com/repos/apache/ratis/issues/1096","id":2131264368,"node_id":"IC_kwDOBMxbGc5_CINw","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-25T13:15:08Z","updated_at":"2024-05-25T13:15:08Z","author_association":"CONTRIBUTOR","body":"@duongkame , deployed `3.1.0-640749b-SNAPSHOT`.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2131264368/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2132749185","html_url":"https://github.com/apache/ratis/pull/1105#issuecomment-2132749185","issue_url":"https://api.github.com/repos/apache/ratis/issues/1105","id":2132749185,"node_id":"IC_kwDOBMxbGc5_HyuB","user":{"login":"ivandika3","id":36403683,"node_id":"MDQ6VXNlcjM2NDAzNjgz","avatar_url":"https://avatars.githubusercontent.com/u/36403683?v=4","gravatar_id":"","url":"https://api.github.com/users/ivandika3","html_url":"https://github.com/ivandika3","followers_url":"https://api.github.com/users/ivandika3/followers","following_url":"https://api.github.com/users/ivandika3/following{/other_user}","gists_url":"https://api.github.com/users/ivandika3/gists{/gist_id}","starred_url":"https://api.github.com/users/ivandika3/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivandika3/subscriptions","organizations_url":"https://api.github.com/users/ivandika3/orgs","repos_url":"https://api.github.com/users/ivandika3/repos","events_url":"https://api.github.com/users/ivandika3/events{/privacy}","received_events_url":"https://api.github.com/users/ivandika3/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-27T06:40:45Z","updated_at":"2024-05-27T06:40:45Z","author_association":"CONTRIBUTOR","body":"cc: @smengcl @szetszwo ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2132749185/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2134190240","html_url":"https://github.com/apache/ratis/pull/1091#issuecomment-2134190240","issue_url":"https://api.github.com/repos/apache/ratis/issues/1091","id":2134190240,"node_id":"IC_kwDOBMxbGc5_NSig","user":{"login":"SzyWilliam","id":48054931,"node_id":"MDQ6VXNlcjQ4MDU0OTMx","avatar_url":"https://avatars.githubusercontent.com/u/48054931?v=4","gravatar_id":"","url":"https://api.github.com/users/SzyWilliam","html_url":"https://github.com/SzyWilliam","followers_url":"https://api.github.com/users/SzyWilliam/followers","following_url":"https://api.github.com/users/SzyWilliam/following{/other_user}","gists_url":"https://api.github.com/users/SzyWilliam/gists{/gist_id}","starred_url":"https://api.github.com/users/SzyWilliam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SzyWilliam/subscriptions","organizations_url":"https://api.github.com/users/SzyWilliam/orgs","repos_url":"https://api.github.com/users/SzyWilliam/repos","events_url":"https://api.github.com/users/SzyWilliam/events{/privacy}","received_events_url":"https://api.github.com/users/SzyWilliam/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-28T01:06:54Z","updated_at":"2024-05-28T01:06:54Z","author_association":"MEMBER","body":"@szetszwo Hi Tsz-Wo, this patch is merged and tested in IoTDB snapshot version and so far so good. I hope it could catch on board with 3.1.0, what do you think?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2134190240/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2136360048","html_url":"https://github.com/apache/ratis/pull/1105#issuecomment-2136360048","issue_url":"https://api.github.com/repos/apache/ratis/issues/1105","id":2136360048,"node_id":"IC_kwDOBMxbGc5_VkRw","user":{"login":"ivandika3","id":36403683,"node_id":"MDQ6VXNlcjM2NDAzNjgz","avatar_url":"https://avatars.githubusercontent.com/u/36403683?v=4","gravatar_id":"","url":"https://api.github.com/users/ivandika3","html_url":"https://github.com/ivandika3","followers_url":"https://api.github.com/users/ivandika3/followers","following_url":"https://api.github.com/users/ivandika3/following{/other_user}","gists_url":"https://api.github.com/users/ivandika3/gists{/gist_id}","starred_url":"https://api.github.com/users/ivandika3/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivandika3/subscriptions","organizations_url":"https://api.github.com/users/ivandika3/orgs","repos_url":"https://api.github.com/users/ivandika3/repos","events_url":"https://api.github.com/users/ivandika3/events{/privacy}","received_events_url":"https://api.github.com/users/ivandika3/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-29T01:36:01Z","updated_at":"2024-05-29T01:36:01Z","author_association":"CONTRIBUTOR","body":"@szetszwo Thank you for the review and merge. Created HDDS-10932 to remove the need for the second watch commit in case of `NotReplicatedException`, will do after Ratis 3.1.0 release.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2136360048/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2137966704","html_url":"https://github.com/apache/ratis/pull/1105#issuecomment-2137966704","issue_url":"https://api.github.com/repos/apache/ratis/issues/1105","id":2137966704,"node_id":"IC_kwDOBMxbGc5_bshw","user":{"login":"smengcl","id":50227127,"node_id":"MDQ6VXNlcjUwMjI3MTI3","avatar_url":"https://avatars.githubusercontent.com/u/50227127?v=4","gravatar_id":"","url":"https://api.github.com/users/smengcl","html_url":"https://github.com/smengcl","followers_url":"https://api.github.com/users/smengcl/followers","following_url":"https://api.github.com/users/smengcl/following{/other_user}","gists_url":"https://api.github.com/users/smengcl/gists{/gist_id}","starred_url":"https://api.github.com/users/smengcl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smengcl/subscriptions","organizations_url":"https://api.github.com/users/smengcl/orgs","repos_url":"https://api.github.com/users/smengcl/repos","events_url":"https://api.github.com/users/smengcl/events{/privacy}","received_events_url":"https://api.github.com/users/smengcl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-29T17:55:30Z","updated_at":"2024-05-29T17:55:30Z","author_association":"CONTRIBUTOR","body":"Thanks a lot @ivandika3 for working on this one!","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2137966704/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2138001402","html_url":"https://github.com/apache/ratis/pull/1104#issuecomment-2138001402","issue_url":"https://api.github.com/repos/apache/ratis/issues/1104","id":2138001402,"node_id":"IC_kwDOBMxbGc5_b0_6","user":{"login":"smengcl","id":50227127,"node_id":"MDQ6VXNlcjUwMjI3MTI3","avatar_url":"https://avatars.githubusercontent.com/u/50227127?v=4","gravatar_id":"","url":"https://api.github.com/users/smengcl","html_url":"https://github.com/smengcl","followers_url":"https://api.github.com/users/smengcl/followers","following_url":"https://api.github.com/users/smengcl/following{/other_user}","gists_url":"https://api.github.com/users/smengcl/gists{/gist_id}","starred_url":"https://api.github.com/users/smengcl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smengcl/subscriptions","organizations_url":"https://api.github.com/users/smengcl/orgs","repos_url":"https://api.github.com/users/smengcl/repos","events_url":"https://api.github.com/users/smengcl/events{/privacy}","received_events_url":"https://api.github.com/users/smengcl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-29T18:15:58Z","updated_at":"2024-05-29T18:15:58Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo for reviewing this!","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2138001402/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2138885724","html_url":"https://github.com/apache/ratis/pull/1091#issuecomment-2138885724","issue_url":"https://api.github.com/repos/apache/ratis/issues/1091","id":2138885724,"node_id":"IC_kwDOBMxbGc5_fM5c","user":{"login":"SzyWilliam","id":48054931,"node_id":"MDQ6VXNlcjQ4MDU0OTMx","avatar_url":"https://avatars.githubusercontent.com/u/48054931?v=4","gravatar_id":"","url":"https://api.github.com/users/SzyWilliam","html_url":"https://github.com/SzyWilliam","followers_url":"https://api.github.com/users/SzyWilliam/followers","following_url":"https://api.github.com/users/SzyWilliam/following{/other_user}","gists_url":"https://api.github.com/users/SzyWilliam/gists{/gist_id}","starred_url":"https://api.github.com/users/SzyWilliam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SzyWilliam/subscriptions","organizations_url":"https://api.github.com/users/SzyWilliam/orgs","repos_url":"https://api.github.com/users/SzyWilliam/repos","events_url":"https://api.github.com/users/SzyWilliam/events{/privacy}","received_events_url":"https://api.github.com/users/SzyWilliam/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-30T07:44:52Z","updated_at":"2024-05-30T07:44:52Z","author_association":"MEMBER","body":"Thanks @szetszwo very much for the reviews and resolutions.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2138885724/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2142716387","html_url":"https://github.com/apache/ratis/pull/1106#issuecomment-2142716387","issue_url":"https://api.github.com/repos/apache/ratis/issues/1106","id":2142716387,"node_id":"IC_kwDOBMxbGc5_t0Hj","user":{"login":"duongkame","id":17348547,"node_id":"MDQ6VXNlcjE3MzQ4NTQ3","avatar_url":"https://avatars.githubusercontent.com/u/17348547?v=4","gravatar_id":"","url":"https://api.github.com/users/duongkame","html_url":"https://github.com/duongkame","followers_url":"https://api.github.com/users/duongkame/followers","following_url":"https://api.github.com/users/duongkame/following{/other_user}","gists_url":"https://api.github.com/users/duongkame/gists{/gist_id}","starred_url":"https://api.github.com/users/duongkame/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duongkame/subscriptions","organizations_url":"https://api.github.com/users/duongkame/orgs","repos_url":"https://api.github.com/users/duongkame/repos","events_url":"https://api.github.com/users/duongkame/events{/privacy}","received_events_url":"https://api.github.com/users/duongkame/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-31T17:45:37Z","updated_at":"2024-05-31T17:45:37Z","author_association":"CONTRIBUTOR","body":"@szetszwo can you have a look?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2142716387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2144062303","html_url":"https://github.com/apache/ratis/pull/1106#issuecomment-2144062303","issue_url":"https://api.github.com/repos/apache/ratis/issues/1106","id":2144062303,"node_id":"IC_kwDOBMxbGc5_y8tf","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-02T23:44:52Z","updated_at":"2024-06-02T23:44:52Z","author_association":"CONTRIBUTOR","body":"@duongkame , \"This pull request is still a work in progress\".  I guess it is not the case?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2144062303/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2146359706","html_url":"https://github.com/apache/ratis/pull/1108#issuecomment-2146359706","issue_url":"https://api.github.com/repos/apache/ratis/issues/1108","id":2146359706,"node_id":"IC_kwDOBMxbGc5_7tma","user":{"login":"duongkame","id":17348547,"node_id":"MDQ6VXNlcjE3MzQ4NTQ3","avatar_url":"https://avatars.githubusercontent.com/u/17348547?v=4","gravatar_id":"","url":"https://api.github.com/users/duongkame","html_url":"https://github.com/duongkame","followers_url":"https://api.github.com/users/duongkame/followers","following_url":"https://api.github.com/users/duongkame/following{/other_user}","gists_url":"https://api.github.com/users/duongkame/gists{/gist_id}","starred_url":"https://api.github.com/users/duongkame/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duongkame/subscriptions","organizations_url":"https://api.github.com/users/duongkame/orgs","repos_url":"https://api.github.com/users/duongkame/repos","events_url":"https://api.github.com/users/duongkame/events{/privacy}","received_events_url":"https://api.github.com/users/duongkame/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-04T00:43:51Z","updated_at":"2024-06-04T00:43:51Z","author_association":"CONTRIBUTOR","body":"c.c @szetszwo ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2146359706/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2148103362","html_url":"https://github.com/apache/ratis/pull/1108#issuecomment-2148103362","issue_url":"https://api.github.com/repos/apache/ratis/issues/1108","id":2148103362,"node_id":"IC_kwDOBMxbGc6ACXTC","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-04T17:58:48Z","updated_at":"2024-06-04T17:58:48Z","author_association":"CONTRIBUTOR","body":"@duongkame , I applied the patch but still get the same IllegalStateException:\r\n```\r\n[ERROR] org.apache.ratis.grpc.TestLeaderInstallSnapshot.testInstallSnapshotLeaderSwitch(Boolean)[1]  Time elapsed: 7.474 s  <<< ERROR!\r\njava.lang.IllegalStateException: allLeaks.size = 4\r\n\tat org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:77)\r\n\tat org.apache.ratis.util.LeakDetector.assertNoLeaks(LeakDetector.java:107)\r\n\tat org.apache.ratis.server.impl.MiniRaftCluster.shutdown(MiniRaftCluster.java:869)\r\n\tat org.apache.ratis.grpc.MiniRaftClusterWithGrpc.shutdown(MiniRaftClusterWithGrpc.java:93)\r\n\tat org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:149)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2148103362/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2148105196","html_url":"https://github.com/apache/ratis/pull/1108#issuecomment-2148105196","issue_url":"https://api.github.com/repos/apache/ratis/issues/1108","id":2148105196,"node_id":"IC_kwDOBMxbGc6ACXvs","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-04T17:59:53Z","updated_at":"2024-06-04T17:59:53Z","author_association":"CONTRIBUTOR","body":"Even I have commented out `setZeroCopyEnabled(properties, true)`\r\n```java\r\ndiff --git a/ratis-grpc/src/test/java/org/apache/ratis/grpc/MiniRaftClusterWithGrpc.java b/ratis-grpc/src/test/java/org/apache/ratis/grpc/MiniRaftClusterWithGrpc.java\r\nindex bd3b137501..5c57854759 100644\r\n--- a/ratis-grpc/src/test/java/org/apache/ratis/grpc/MiniRaftClusterWithGrpc.java\r\n+++ b/ratis-grpc/src/test/java/org/apache/ratis/grpc/MiniRaftClusterWithGrpc.java\r\n@@ -77,7 +77,7 @@ public class MiniRaftClusterWithGrpc extends MiniRaftCluster.RpcBase {\r\n     Optional.ofNullable(getAddress(id, group, RaftPeer::getAdminAddress)).ifPresent(address ->\r\n         GrpcConfigKeys.Admin.setPort(properties, NetUtils.createSocketAddr(address).getPort()));\r\n     // Always run grpc integration tests with zero-copy enabled because the path of nonzero-copy is not risky.\r\n-    GrpcConfigKeys.Server.setZeroCopyEnabled(properties, true);\r\n+//    GrpcConfigKeys.Server.setZeroCopyEnabled(properties, true);\r\n     return parameters;\r\n   }\r\n \r\ndiff --git a/ratis-server/src/test/java/org/apache/ratis/InstallSnapshotFromLeaderTests.java b/ratis-server/src/test/java/org/apache/ratis/InstallSnapshotFromLeaderTests.java\r\nindex b83a7dfdd3..e83a40e89b 100644\r\n--- a/ratis-server/src/test/java/org/apache/ratis/InstallSnapshotFromLeaderTests.java\r\n+++ b/ratis-server/src/test/java/org/apache/ratis/InstallSnapshotFromLeaderTests.java\r\n@@ -95,7 +95,6 @@ public abstract class InstallSnapshotFromLeaderTests<CLUSTER extends MiniRaftClu\r\n   }\r\n \r\n   private void testMultiFileInstallSnapshot(CLUSTER cluster) throws Exception {\r\n-    try {\r\n       int i = 0;\r\n       RaftTestUtil.waitForLeader(cluster);\r\n       final RaftPeerId leaderId = cluster.getLeader().getId();\r\n@@ -131,13 +130,9 @@ public abstract class InstallSnapshotFromLeaderTests<CLUSTER extends MiniRaftClu\r\n           Assertions.assertEquals(3, info.getFiles().size());\r\n         }\r\n       }, 10, ONE_SECOND, \"check snapshot\", LOG);\r\n-    } finally {\r\n-      cluster.shutdown();\r\n-    }\r\n   }\r\n \r\n   private void testInstallSnapshotDuringLeaderSwitch(CLUSTER cluster) throws Exception {\r\n-    try {\r\n       RaftTestUtil.waitForLeader(cluster);\r\n       final RaftPeerId leaderId = cluster.getLeader().getId();\r\n \r\n@@ -192,9 +187,6 @@ public abstract class InstallSnapshotFromLeaderTests<CLUSTER extends MiniRaftClu\r\n               reply = client.io().send(new RaftTestUtil.SimpleMessage(\"final\"));\r\n         Assertions.assertTrue(reply.isSuccess());\r\n       }\r\n-    } finally {\r\n-      cluster.shutdown();\r\n-    }\r\n   }\r\n \r\n   private static class StateMachineWithMultiNestedSnapshotFile extends SimpleStateMachine4Testing {\r\n```","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2148105196/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2151006330","html_url":"https://github.com/apache/ratis/pull/1107#issuecomment-2151006330","issue_url":"https://api.github.com/repos/apache/ratis/issues/1107","id":2151006330,"node_id":"IC_kwDOBMxbGc6ANcB6","user":{"login":"smengcl","id":50227127,"node_id":"MDQ6VXNlcjUwMjI3MTI3","avatar_url":"https://avatars.githubusercontent.com/u/50227127?v=4","gravatar_id":"","url":"https://api.github.com/users/smengcl","html_url":"https://github.com/smengcl","followers_url":"https://api.github.com/users/smengcl/followers","following_url":"https://api.github.com/users/smengcl/following{/other_user}","gists_url":"https://api.github.com/users/smengcl/gists{/gist_id}","starred_url":"https://api.github.com/users/smengcl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smengcl/subscriptions","organizations_url":"https://api.github.com/users/smengcl/orgs","repos_url":"https://api.github.com/users/smengcl/repos","events_url":"https://api.github.com/users/smengcl/events{/privacy}","received_events_url":"https://api.github.com/users/smengcl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-05T21:39:44Z","updated_at":"2024-06-05T21:39:44Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo for reviewing and merging this","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2151006330/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2162241993","html_url":"https://github.com/apache/ratis/pull/1111#issuecomment-2162241993","issue_url":"https://api.github.com/repos/apache/ratis/issues/1111","id":2162241993,"node_id":"IC_kwDOBMxbGc6A4THJ","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-12T06:51:31Z","updated_at":"2024-06-12T06:51:31Z","author_association":"CONTRIBUTOR","body":"ping @szetszwo ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2162241993/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2163582121","html_url":"https://github.com/apache/ratis/pull/1098#issuecomment-2163582121","issue_url":"https://api.github.com/repos/apache/ratis/issues/1098","id":2163582121,"node_id":"IC_kwDOBMxbGc6A9aSp","user":{"login":"DaveTeng0","id":109315747,"node_id":"U_kgDOBoQGow","avatar_url":"https://avatars.githubusercontent.com/u/109315747?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveTeng0","html_url":"https://github.com/DaveTeng0","followers_url":"https://api.github.com/users/DaveTeng0/followers","following_url":"https://api.github.com/users/DaveTeng0/following{/other_user}","gists_url":"https://api.github.com/users/DaveTeng0/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveTeng0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveTeng0/subscriptions","organizations_url":"https://api.github.com/users/DaveTeng0/orgs","repos_url":"https://api.github.com/users/DaveTeng0/repos","events_url":"https://api.github.com/users/DaveTeng0/events{/privacy}","received_events_url":"https://api.github.com/users/DaveTeng0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-12T17:39:06Z","updated_at":"2024-06-12T17:39:06Z","author_association":"CONTRIBUTOR","body":"Hello guys! Changes for addressing comments have been completed. Feel free to take a final look, thanks! (cc. @szetszwo ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2163582121/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2164590297","html_url":"https://github.com/apache/ratis/pull/1112#issuecomment-2164590297","issue_url":"https://api.github.com/repos/apache/ratis/issues/1112","id":2164590297,"node_id":"IC_kwDOBMxbGc6BBQbZ","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-13T06:26:34Z","updated_at":"2024-06-13T06:26:34Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo for the review.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2164590297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2165078941","html_url":"https://github.com/apache/ratis/pull/1111#issuecomment-2165078941","issue_url":"https://api.github.com/repos/apache/ratis/issues/1111","id":2165078941,"node_id":"IC_kwDOBMxbGc6BDHud","user":{"login":"AngersZhuuuu","id":46485123,"node_id":"MDQ6VXNlcjQ2NDg1MTIz","avatar_url":"https://avatars.githubusercontent.com/u/46485123?v=4","gravatar_id":"","url":"https://api.github.com/users/AngersZhuuuu","html_url":"https://github.com/AngersZhuuuu","followers_url":"https://api.github.com/users/AngersZhuuuu/followers","following_url":"https://api.github.com/users/AngersZhuuuu/following{/other_user}","gists_url":"https://api.github.com/users/AngersZhuuuu/gists{/gist_id}","starred_url":"https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AngersZhuuuu/subscriptions","organizations_url":"https://api.github.com/users/AngersZhuuuu/orgs","repos_url":"https://api.github.com/users/AngersZhuuuu/repos","events_url":"https://api.github.com/users/AngersZhuuuu/events{/privacy}","received_events_url":"https://api.github.com/users/AngersZhuuuu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-13T09:11:18Z","updated_at":"2024-06-13T09:11:18Z","author_association":"CONTRIBUTOR","body":"@szetszwo GA passed","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2165078941/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2179829926","html_url":"https://github.com/apache/ratis/pull/1113#issuecomment-2179829926","issue_url":"https://api.github.com/repos/apache/ratis/issues/1113","id":2179829926,"node_id":"IC_kwDOBMxbGc6B7ZCm","user":{"login":"duongkame","id":17348547,"node_id":"MDQ6VXNlcjE3MzQ4NTQ3","avatar_url":"https://avatars.githubusercontent.com/u/17348547?v=4","gravatar_id":"","url":"https://api.github.com/users/duongkame","html_url":"https://github.com/duongkame","followers_url":"https://api.github.com/users/duongkame/followers","following_url":"https://api.github.com/users/duongkame/following{/other_user}","gists_url":"https://api.github.com/users/duongkame/gists{/gist_id}","starred_url":"https://api.github.com/users/duongkame/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duongkame/subscriptions","organizations_url":"https://api.github.com/users/duongkame/orgs","repos_url":"https://api.github.com/users/duongkame/repos","events_url":"https://api.github.com/users/duongkame/events{/privacy}","received_events_url":"https://api.github.com/users/duongkame/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-20T05:14:28Z","updated_at":"2024-06-20T05:14:28Z","author_association":"CONTRIBUTOR","body":"c.c @szetszwo ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2179829926/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2188243710","html_url":"https://github.com/apache/ratis/pull/1110#issuecomment-2188243710","issue_url":"https://api.github.com/repos/apache/ratis/issues/1110","id":2188243710,"node_id":"IC_kwDOBMxbGc6CbfL-","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-25T08:03:51Z","updated_at":"2024-06-25T08:03:51Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo for the review.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2188243710/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2189481632","html_url":"https://github.com/apache/ratis/pull/1108#issuecomment-2189481632","issue_url":"https://api.github.com/repos/apache/ratis/issues/1108","id":2189481632,"node_id":"IC_kwDOBMxbGc6CgNag","user":{"login":"Romok007","id":20064476,"node_id":"MDQ6VXNlcjIwMDY0NDc2","avatar_url":"https://avatars.githubusercontent.com/u/20064476?v=4","gravatar_id":"","url":"https://api.github.com/users/Romok007","html_url":"https://github.com/Romok007","followers_url":"https://api.github.com/users/Romok007/followers","following_url":"https://api.github.com/users/Romok007/following{/other_user}","gists_url":"https://api.github.com/users/Romok007/gists{/gist_id}","starred_url":"https://api.github.com/users/Romok007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Romok007/subscriptions","organizations_url":"https://api.github.com/users/Romok007/orgs","repos_url":"https://api.github.com/users/Romok007/repos","events_url":"https://api.github.com/users/Romok007/events{/privacy}","received_events_url":"https://api.github.com/users/Romok007/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-25T17:05:11Z","updated_at":"2024-06-25T17:05:11Z","author_association":"NONE","body":"Hi @duongkame, I am unable to reproduce this failing test. Can you please let me know how did you reproduce the issue https://issues.apache.org/jira/browse/RATIS-2104. I downloaded the sources from here https://github.com/apache/ratis/releases/tag/ratis-3.1.0-rc0 for reproducing the issue. I am interested to know more about the issue.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2189481632/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2196663073","html_url":"https://github.com/apache/ratis/pull/1115#issuecomment-2196663073","issue_url":"https://api.github.com/repos/apache/ratis/issues/1115","id":2196663073,"node_id":"IC_kwDOBMxbGc6C7msh","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-28T11:16:31Z","updated_at":"2024-06-28T11:16:31Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo for the review.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2196663073/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2198217278","html_url":"https://github.com/apache/ratis/pull/1118#issuecomment-2198217278","issue_url":"https://api.github.com/repos/apache/ratis/issues/1118","id":2198217278,"node_id":"IC_kwDOBMxbGc6DBiI-","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-29T14:42:03Z","updated_at":"2024-06-29T14:42:03Z","author_association":"CONTRIBUTOR","body":"Thanks @SzyWilliam for reviewing and merging this.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2198217278/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2198219992","html_url":"https://github.com/apache/ratis/pull/1114#issuecomment-2198219992","issue_url":"https://api.github.com/repos/apache/ratis/issues/1114","id":2198219992,"node_id":"IC_kwDOBMxbGc6DBizY","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-06-29T14:51:39Z","updated_at":"2024-06-29T14:55:01Z","author_association":"CONTRIBUTOR","body":"Thanks @SzyWilliam for checking this.\r\n\r\nHere are my steps:\r\n\r\n```\r\nmvn -DskipTests clean package > /dev/null\r\nfind * -name 'ratis-version.properties' | sort\r\necho # for separator line\r\ncat ratis-common/target/classes/ratis-version.properties # sample\r\n```\r\n\r\nOutput on `master`:\r\n\r\n```\r\nratis-assembly/target/classes/ratis-version.properties\r\nratis-client/target/classes/ratis-version.properties\r\nratis-common/target/classes/ratis-version.properties\r\nratis-docs/target/classes/ratis-version.properties\r\nratis-examples/target/classes/ratis-version.properties\r\nratis-grpc/target/classes/ratis-version.properties\r\nratis-metrics-api/target/classes/ratis-version.properties\r\nratis-metrics-default/target/classes/ratis-version.properties\r\nratis-metrics-dropwizard3/target/classes/ratis-version.properties\r\nratis-netty/target/classes/ratis-version.properties\r\nratis-proto/target/classes/ratis-version.properties\r\nratis-replicated-map/target/classes/ratis-version.properties\r\nratis-resource-bundle/target/classes/ratis-version.properties\r\nratis-server-api/target/classes/ratis-version.properties\r\nratis-server/target/classes/ratis-version.properties\r\nratis-shell/target/classes/ratis-version.properties\r\nratis-test/target/classes/ratis-version.properties\r\nratis-tools/target/classes/ratis-version.properties\r\ntarget/classes/ratis-version.properties\r\n\r\n#Created by build system. Do not modify\r\n#Sat Jun 29 16:40:20 CEST 2024\r\nname=Apache Ratis Common\r\nversion=3.2.0-SNAPSHOT\r\ntimestamp=1719672020675\r\nrevision=c31806dbdcf2f288c57684958447a6ddfe6fc29c\r\n```\r\n\r\nOutput with the patch:\r\n\r\n```\r\nratis-client/target/classes/ratis-version.properties\r\nratis-common/target/classes/ratis-version.properties\r\nratis-docs/target/classes/ratis-version.properties\r\nratis-examples/target/classes/ratis-version.properties\r\nratis-grpc/target/classes/ratis-version.properties\r\nratis-metrics-api/target/classes/ratis-version.properties\r\nratis-metrics-default/target/classes/ratis-version.properties\r\nratis-metrics-dropwizard3/target/classes/ratis-version.properties\r\nratis-netty/target/classes/ratis-version.properties\r\nratis-proto/target/classes/ratis-version.properties\r\nratis-replicated-map/target/classes/ratis-version.properties\r\nratis-resource-bundle/target/classes/ratis-version.properties\r\nratis-server-api/target/classes/ratis-version.properties\r\nratis-server/target/classes/ratis-version.properties\r\nratis-shell/target/classes/ratis-version.properties\r\nratis-test/target/classes/ratis-version.properties\r\nratis-tools/target/classes/ratis-version.properties\r\nsrc/main/resources/ratis-version.properties\r\n\r\n#\r\n# Licensed to the Apache Software Foundation (ASF) under one\r\n# or more contributor license agreements.  See the NOTICE file\r\n# distributed with this work for additional information\r\n# regarding copyright ownership.  The ASF licenses this file\r\n# to you under the Apache License, Version 2.0 (the\r\n# \"License\"); you may not use this file except in compliance\r\n# with the License.  You may obtain a copy of the License at\r\n#\r\n#      http://www.apache.org/licenses/LICENSE-2.0\r\n#\r\n# Unless required by applicable law or agreed to in writing, software\r\n# distributed under the License is distributed on an \"AS IS\" BASIS,\r\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n# See the License for the specific language governing permissions and\r\n# limitations under the License.\r\n#\r\nname=Apache Ratis Common\r\nversion=3.1.0-SNAPSHOT\r\nrevision=6d5c926e15aafbf542dfad573e72f6af48bf9a5a\r\n```\r\n\r\nWith the patch, we have an extra file in `src/main/resources`, which is the template for the generated files.\r\n\r\nOn `master`, there is no source file, but there are two more output files:\r\n\r\n```\r\nratis-assembly/target/classes/ratis-version.properties\r\ntarget/classes/ratis-version.properties\r\n```\r\n\r\nHowever, I don't think these are ever used, since these modules have `packaging=pom`, not `jar`.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2198219992/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2199266856","html_url":"https://github.com/apache/ratis/pull/1117#issuecomment-2199266856","issue_url":"https://api.github.com/repos/apache/ratis/issues/1117","id":2199266856,"node_id":"IC_kwDOBMxbGc6DFiYo","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-01T05:27:59Z","updated_at":"2024-07-01T05:27:59Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo for the review.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2199266856/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2199282048","html_url":"https://github.com/apache/ratis/pull/1119#issuecomment-2199282048","issue_url":"https://api.github.com/repos/apache/ratis/issues/1119","id":2199282048,"node_id":"IC_kwDOBMxbGc6DFmGA","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-01T05:41:33Z","updated_at":"2024-07-01T05:41:33Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo for the review.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2199282048/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2203374009","html_url":"https://github.com/apache/ratis/pull/1120#issuecomment-2203374009","issue_url":"https://api.github.com/repos/apache/ratis/issues/1120","id":2203374009,"node_id":"IC_kwDOBMxbGc6DVNG5","user":{"login":"SzyWilliam","id":48054931,"node_id":"MDQ6VXNlcjQ4MDU0OTMx","avatar_url":"https://avatars.githubusercontent.com/u/48054931?v=4","gravatar_id":"","url":"https://api.github.com/users/SzyWilliam","html_url":"https://github.com/SzyWilliam","followers_url":"https://api.github.com/users/SzyWilliam/followers","following_url":"https://api.github.com/users/SzyWilliam/following{/other_user}","gists_url":"https://api.github.com/users/SzyWilliam/gists{/gist_id}","starred_url":"https://api.github.com/users/SzyWilliam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SzyWilliam/subscriptions","organizations_url":"https://api.github.com/users/SzyWilliam/orgs","repos_url":"https://api.github.com/users/SzyWilliam/repos","events_url":"https://api.github.com/users/SzyWilliam/events{/privacy}","received_events_url":"https://api.github.com/users/SzyWilliam/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-02T14:29:13Z","updated_at":"2024-07-02T14:29:13Z","author_association":"MEMBER","body":"Thanks @adoroszlai for the review! There seems to be no other comments. Let's merge it.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2203374009/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2203399501","html_url":"https://github.com/apache/ratis/pull/1114#issuecomment-2203399501","issue_url":"https://api.github.com/repos/apache/ratis/issues/1114","id":2203399501,"node_id":"IC_kwDOBMxbGc6DVTVN","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-02T14:40:01Z","updated_at":"2024-07-02T14:40:01Z","author_association":"CONTRIBUTOR","body":"Thanks @SzyWilliam for reviewing and merging this.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2203399501/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2208442918","html_url":"https://github.com/apache/ratis/pull/1121#issuecomment-2208442918","issue_url":"https://api.github.com/repos/apache/ratis/issues/1121","id":2208442918,"node_id":"IC_kwDOBMxbGc6Doiom","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-04T08:48:26Z","updated_at":"2024-07-04T08:48:26Z","author_association":"CONTRIBUTOR","body":"@adoroszlai , could you also update `3.1.0.md` as below?  It is to replace `maintenance` with `minor` and break the long line.\r\n```patch\r\n+++ b/content/post/3.1.0.md\r\n@@ -18,7 +18,9 @@ linked: true\r\n \r\n [Download](https://ratis.apache.org/downloads.html)\r\n \r\n-This is a maintenance release with multiple improvements and bugfixes. See the [changes between 3.0.1 and 3.1.0](https://github.com/apache/ratis/compare/ratis-3.0.1...ratis-3.1.0) releases.\r\n+This is a minor release with multiple improvements and bugfixes.\r\n+See the [changes between 3.0.1 and 3.1.0](https://github.com/apache/ratis/compare/ratis-3.0.1...ratis-3.1.0) releases.\r\n```","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2208442918/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2209372002","html_url":"https://github.com/apache/ratis/pull/1121#issuecomment-2209372002","issue_url":"https://api.github.com/repos/apache/ratis/issues/1121","id":2209372002,"node_id":"IC_kwDOBMxbGc6DsFdi","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-04T17:17:35Z","updated_at":"2024-07-04T17:17:35Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo for the review.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2209372002/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2226739729","html_url":"https://github.com/apache/ratis/pull/204#issuecomment-2226739729","issue_url":"https://api.github.com/repos/apache/ratis/issues/204","id":2226739729,"node_id":"IC_kwDOBMxbGc6EuVoR","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-13T03:21:17Z","updated_at":"2024-07-13T03:21:44Z","author_association":"CONTRIBUTOR","body":"@amaliujia , thanks a lot for your initial work!  I will continue this pull request in https://github.com/apache/ratis/pull/1122 .","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2226739729/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2227045401","html_url":"https://github.com/apache/ratis/pull/1123#issuecomment-2227045401","issue_url":"https://api.github.com/repos/apache/ratis/issues/1123","id":2227045401,"node_id":"IC_kwDOBMxbGc6EvgQZ","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-13T18:51:29Z","updated_at":"2024-07-13T18:51:29Z","author_association":"CONTRIBUTOR","body":"Reproducibility check for javadoc works on Java 8, but fails with newer Java.  The problem is in the search index JSON files.  So it's reverted for now.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2227045401/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2228242789","html_url":"https://github.com/apache/ratis/pull/1123#issuecomment-2228242789","issue_url":"https://api.github.com/repos/apache/ratis/issues/1123","id":2228242789,"node_id":"IC_kwDOBMxbGc6E0Ell","user":{"login":"adoroszlai","id":6454655,"node_id":"MDQ6VXNlcjY0NTQ2NTU=","avatar_url":"https://avatars.githubusercontent.com/u/6454655?v=4","gravatar_id":"","url":"https://api.github.com/users/adoroszlai","html_url":"https://github.com/adoroszlai","followers_url":"https://api.github.com/users/adoroszlai/followers","following_url":"https://api.github.com/users/adoroszlai/following{/other_user}","gists_url":"https://api.github.com/users/adoroszlai/gists{/gist_id}","starred_url":"https://api.github.com/users/adoroszlai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adoroszlai/subscriptions","organizations_url":"https://api.github.com/users/adoroszlai/orgs","repos_url":"https://api.github.com/users/adoroszlai/repos","events_url":"https://api.github.com/users/adoroszlai/events{/privacy}","received_events_url":"https://api.github.com/users/adoroszlai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-15T11:06:55Z","updated_at":"2024-07-15T11:06:55Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo for the review.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2228242789/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2231447620","html_url":"https://github.com/apache/ratis/pull/1122#issuecomment-2231447620","issue_url":"https://api.github.com/repos/apache/ratis/issues/1122","id":2231447620,"node_id":"IC_kwDOBMxbGc6FATBE","user":{"login":"jojochuang","id":2691807,"node_id":"MDQ6VXNlcjI2OTE4MDc=","avatar_url":"https://avatars.githubusercontent.com/u/2691807?v=4","gravatar_id":"","url":"https://api.github.com/users/jojochuang","html_url":"https://github.com/jojochuang","followers_url":"https://api.github.com/users/jojochuang/followers","following_url":"https://api.github.com/users/jojochuang/following{/other_user}","gists_url":"https://api.github.com/users/jojochuang/gists{/gist_id}","starred_url":"https://api.github.com/users/jojochuang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jojochuang/subscriptions","organizations_url":"https://api.github.com/users/jojochuang/orgs","repos_url":"https://api.github.com/users/jojochuang/repos","events_url":"https://api.github.com/users/jojochuang/events{/privacy}","received_events_url":"https://api.github.com/users/jojochuang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-16T17:25:54Z","updated_at":"2024-07-16T17:25:54Z","author_association":"CONTRIBUTOR","body":"cc @duongkame @smengcl ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2231447620/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2232451144","html_url":"https://github.com/apache/ratis/pull/1122#issuecomment-2232451144","issue_url":"https://api.github.com/repos/apache/ratis/issues/1122","id":2232451144,"node_id":"IC_kwDOBMxbGc6FEIBI","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-17T05:31:21Z","updated_at":"2024-07-17T05:31:21Z","author_association":"CONTRIBUTOR","body":"Thanks @adoroszlai and @SzyWilliam  for reviewing this!","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2232451144/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2241066087","html_url":"https://github.com/apache/ratis/pull/1124#issuecomment-2241066087","issue_url":"https://api.github.com/repos/apache/ratis/issues/1124","id":2241066087,"node_id":"IC_kwDOBMxbGc6Fk_Rn","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-20T09:49:11Z","updated_at":"2024-07-20T09:49:11Z","author_association":"CONTRIBUTOR","body":"@weimingdiit , there is a checkstyle warning (long line).  Could you fix it?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2241066087/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2249537204","html_url":"https://github.com/apache/ratis/pull/1125#issuecomment-2249537204","issue_url":"https://api.github.com/repos/apache/ratis/issues/1125","id":2249537204,"node_id":"IC_kwDOBMxbGc6GFTa0","user":{"login":"mridulm","id":1591700,"node_id":"MDQ6VXNlcjE1OTE3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/1591700?v=4","gravatar_id":"","url":"https://api.github.com/users/mridulm","html_url":"https://github.com/mridulm","followers_url":"https://api.github.com/users/mridulm/followers","following_url":"https://api.github.com/users/mridulm/following{/other_user}","gists_url":"https://api.github.com/users/mridulm/gists{/gist_id}","starred_url":"https://api.github.com/users/mridulm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mridulm/subscriptions","organizations_url":"https://api.github.com/users/mridulm/orgs","repos_url":"https://api.github.com/users/mridulm/repos","events_url":"https://api.github.com/users/mridulm/events{/privacy}","received_events_url":"https://api.github.com/users/mridulm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-25T06:12:10Z","updated_at":"2024-07-25T06:12:10Z","author_association":"CONTRIBUTOR","body":"Verified with Apache Celeborn, which uses 3.1.0","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2249537204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2249538311","html_url":"https://github.com/apache/ratis/pull/1125#issuecomment-2249538311","issue_url":"https://api.github.com/repos/apache/ratis/issues/1125","id":2249538311,"node_id":"IC_kwDOBMxbGc6GFTsH","user":{"login":"mridulm","id":1591700,"node_id":"MDQ6VXNlcjE1OTE3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/1591700?v=4","gravatar_id":"","url":"https://api.github.com/users/mridulm","html_url":"https://github.com/mridulm","followers_url":"https://api.github.com/users/mridulm/followers","following_url":"https://api.github.com/users/mridulm/following{/other_user}","gists_url":"https://api.github.com/users/mridulm/gists{/gist_id}","starred_url":"https://api.github.com/users/mridulm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mridulm/subscriptions","organizations_url":"https://api.github.com/users/mridulm/orgs","repos_url":"https://api.github.com/users/mridulm/repos","events_url":"https://api.github.com/users/mridulm/events{/privacy}","received_events_url":"https://api.github.com/users/mridulm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-25T06:13:13Z","updated_at":"2024-07-25T06:13:13Z","author_association":"CONTRIBUTOR","body":"+CC @waitinfuture, @RexXiong","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2249538311/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2249542892","html_url":"https://github.com/apache/ratis/pull/1125#issuecomment-2249542892","issue_url":"https://api.github.com/repos/apache/ratis/issues/1125","id":2249542892,"node_id":"IC_kwDOBMxbGc6GFUzs","user":{"login":"mridulm","id":1591700,"node_id":"MDQ6VXNlcjE1OTE3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/1591700?v=4","gravatar_id":"","url":"https://api.github.com/users/mridulm","html_url":"https://github.com/mridulm","followers_url":"https://api.github.com/users/mridulm/followers","following_url":"https://api.github.com/users/mridulm/following{/other_user}","gists_url":"https://api.github.com/users/mridulm/gists{/gist_id}","starred_url":"https://api.github.com/users/mridulm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mridulm/subscriptions","organizations_url":"https://api.github.com/users/mridulm/orgs","repos_url":"https://api.github.com/users/mridulm/repos","events_url":"https://api.github.com/users/mridulm/events{/privacy}","received_events_url":"https://api.github.com/users/mridulm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-25T06:17:11Z","updated_at":"2024-07-25T06:17:11Z","author_association":"CONTRIBUTOR","body":"+CC @szetszwo based on git blame.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2249542892/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2250274426","html_url":"https://github.com/apache/ratis/pull/1125#issuecomment-2250274426","issue_url":"https://api.github.com/repos/apache/ratis/issues/1125","id":2250274426,"node_id":"IC_kwDOBMxbGc6GIHZ6","user":{"login":"mridulm","id":1591700,"node_id":"MDQ6VXNlcjE1OTE3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/1591700?v=4","gravatar_id":"","url":"https://api.github.com/users/mridulm","html_url":"https://github.com/mridulm","followers_url":"https://api.github.com/users/mridulm/followers","following_url":"https://api.github.com/users/mridulm/following{/other_user}","gists_url":"https://api.github.com/users/mridulm/gists{/gist_id}","starred_url":"https://api.github.com/users/mridulm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mridulm/subscriptions","organizations_url":"https://api.github.com/users/mridulm/orgs","repos_url":"https://api.github.com/users/mridulm/repos","events_url":"https://api.github.com/users/mridulm/events{/privacy}","received_events_url":"https://api.github.com/users/mridulm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-25T13:05:12Z","updated_at":"2024-07-25T13:05:12Z","author_association":"CONTRIBUTOR","body":"Thanks @szetszwo !","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2250274426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2257225555","html_url":"https://github.com/apache/ratis/pull/1126#issuecomment-2257225555","issue_url":"https://api.github.com/repos/apache/ratis/issues/1126","id":2257225555,"node_id":"IC_kwDOBMxbGc6GiodT","user":{"login":"duongkame","id":17348547,"node_id":"MDQ6VXNlcjE3MzQ4NTQ3","avatar_url":"https://avatars.githubusercontent.com/u/17348547?v=4","gravatar_id":"","url":"https://api.github.com/users/duongkame","html_url":"https://github.com/duongkame","followers_url":"https://api.github.com/users/duongkame/followers","following_url":"https://api.github.com/users/duongkame/following{/other_user}","gists_url":"https://api.github.com/users/duongkame/gists{/gist_id}","starred_url":"https://api.github.com/users/duongkame/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duongkame/subscriptions","organizations_url":"https://api.github.com/users/duongkame/orgs","repos_url":"https://api.github.com/users/duongkame/repos","events_url":"https://api.github.com/users/duongkame/events{/privacy}","received_events_url":"https://api.github.com/users/duongkame/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-30T00:10:59Z","updated_at":"2024-07-30T00:10:59Z","author_association":"CONTRIBUTOR","body":"cc. @szetszwo @smengcl ","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2257225555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2257322310","html_url":"https://github.com/apache/ratis/pull/1124#issuecomment-2257322310","issue_url":"https://api.github.com/repos/apache/ratis/issues/1124","id":2257322310,"node_id":"IC_kwDOBMxbGc6GjAFG","user":{"login":"weimingdiit","id":23093701,"node_id":"MDQ6VXNlcjIzMDkzNzAx","avatar_url":"https://avatars.githubusercontent.com/u/23093701?v=4","gravatar_id":"","url":"https://api.github.com/users/weimingdiit","html_url":"https://github.com/weimingdiit","followers_url":"https://api.github.com/users/weimingdiit/followers","following_url":"https://api.github.com/users/weimingdiit/following{/other_user}","gists_url":"https://api.github.com/users/weimingdiit/gists{/gist_id}","starred_url":"https://api.github.com/users/weimingdiit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weimingdiit/subscriptions","organizations_url":"https://api.github.com/users/weimingdiit/orgs","repos_url":"https://api.github.com/users/weimingdiit/repos","events_url":"https://api.github.com/users/weimingdiit/events{/privacy}","received_events_url":"https://api.github.com/users/weimingdiit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-30T02:08:07Z","updated_at":"2024-07-30T02:08:07Z","author_association":"CONTRIBUTOR","body":"> @weimingdiit , there is a checkstyle warning (long line). Could you fix it?\r\nok,  please review again","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2257322310/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2257393582","html_url":"https://github.com/apache/ratis/pull/1126#issuecomment-2257393582","issue_url":"https://api.github.com/repos/apache/ratis/issues/1126","id":2257393582,"node_id":"IC_kwDOBMxbGc6GjReu","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-30T03:37:30Z","updated_at":"2024-07-30T03:37:30Z","author_association":"CONTRIBUTOR","body":"@duongkame , instead of reverting this, how about replacing the guava Cache with a `WeakHashMap`?\r\n```java\r\ndiff --git a/ratis-server-api/src/main/java/org/apache/ratis/server/protocol/TermIndex.java b/ratis-server-api/src/main/java/org/apache/ratis/server/protocol/TermIndex.java\r\nindex a8aa670613..e3b8475fe0 100644\r\n--- a/ratis-server-api/src/main/java/org/apache/ratis/server/protocol/TermIndex.java\r\n+++ b/ratis-server-api/src/main/java/org/apache/ratis/server/protocol/TermIndex.java\r\n@@ -19,23 +19,23 @@ package org.apache.ratis.server.protocol;\r\n \r\n import org.apache.ratis.proto.RaftProtos.LogEntryProto;\r\n import org.apache.ratis.proto.RaftProtos.TermIndexProto;\r\n-import org.apache.ratis.thirdparty.com.google.common.cache.Cache;\r\n-import org.apache.ratis.thirdparty.com.google.common.cache.CacheBuilder;\r\n \r\n+import java.lang.ref.WeakReference;\r\n import java.util.Comparator;\r\n import java.util.Optional;\r\n-import java.util.concurrent.ExecutionException;\r\n-import java.util.concurrent.TimeUnit;\r\n+import java.util.WeakHashMap;\r\n \r\n /** The term and the log index defined in the Raft consensus algorithm. */\r\n public interface TermIndex extends Comparable<TermIndex> {\r\n   class Util {\r\n     /** An LRU Cache for {@link TermIndex} instances */\r\n-    private static final Cache<TermIndex, TermIndex> CACHE = CacheBuilder.newBuilder()\r\n-          .maximumSize(1 << 16)\r\n-          .expireAfterAccess(1, TimeUnit.MINUTES)\r\n-          .build();\r\n+    private static final WeakHashMap<TermIndex, WeakReference<TermIndex>> CACHE = new WeakHashMap<>();\r\n+\r\n+    private static synchronized TermIndex putIfAbsent(TermIndex termIndex) {\r\n+      return CACHE.computeIfAbsent(termIndex, WeakReference::new).get();\r\n+    }\r\n   }\r\n+\r\n   TermIndex[] EMPTY_ARRAY = {};\r\n \r\n   /** @return the term. */\r\n@@ -109,10 +109,6 @@ public interface TermIndex extends Comparable<TermIndex> {\r\n         return String.format(\"(t:%s, i:%s)\", longToString(term), longToString(index));\r\n       }\r\n     };\r\n-    try {\r\n-      return Util.CACHE.get(key, () -> key);\r\n-    } catch (ExecutionException e) {\r\n-      throw new IllegalStateException(\"Failed to valueOf(\" + term + \", \" + index + \"), key=\" + key, e);\r\n-    }\r\n+    return Util.putIfAbsent(key);\r\n   }\r\n }\r\n\\ No newline at end of file\r\n```","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2257393582/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2258740445","html_url":"https://github.com/apache/ratis/pull/1126#issuecomment-2258740445","issue_url":"https://api.github.com/repos/apache/ratis/issues/1126","id":2258740445,"node_id":"IC_kwDOBMxbGc6GoaTd","user":{"login":"duongkame","id":17348547,"node_id":"MDQ6VXNlcjE3MzQ4NTQ3","avatar_url":"https://avatars.githubusercontent.com/u/17348547?v=4","gravatar_id":"","url":"https://api.github.com/users/duongkame","html_url":"https://github.com/duongkame","followers_url":"https://api.github.com/users/duongkame/followers","following_url":"https://api.github.com/users/duongkame/following{/other_user}","gists_url":"https://api.github.com/users/duongkame/gists{/gist_id}","starred_url":"https://api.github.com/users/duongkame/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duongkame/subscriptions","organizations_url":"https://api.github.com/users/duongkame/orgs","repos_url":"https://api.github.com/users/duongkame/repos","events_url":"https://api.github.com/users/duongkame/events{/privacy}","received_events_url":"https://api.github.com/users/duongkame/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-30T16:24:37Z","updated_at":"2024-07-30T16:24:37Z","author_association":"CONTRIBUTOR","body":"> @duongkame , instead of reverting this, how about replacing the guava Cache with a `WeakHashMap`?\r\n> \r\n> ```java\r\n> diff --git a/ratis-server-api/src/main/java/org/apache/ratis/server/protocol/TermIndex.java b/ratis-server-api/src/main/java/org/apache/ratis/server/protocol/TermIndex.java\r\n> index a8aa670613..e3b8475fe0 100644\r\n> --- a/ratis-server-api/src/main/java/org/apache/ratis/server/protocol/TermIndex.java\r\n> +++ b/ratis-server-api/src/main/java/org/apache/ratis/server/protocol/TermIndex.java\r\n> @@ -19,23 +19,23 @@ package org.apache.ratis.server.protocol;\r\n>  \r\n>  import org.apache.ratis.proto.RaftProtos.LogEntryProto;\r\n>  import org.apache.ratis.proto.RaftProtos.TermIndexProto;\r\n> -import org.apache.ratis.thirdparty.com.google.common.cache.Cache;\r\n> -import org.apache.ratis.thirdparty.com.google.common.cache.CacheBuilder;\r\n>  \r\n> +import java.lang.ref.WeakReference;\r\n>  import java.util.Comparator;\r\n>  import java.util.Optional;\r\n> -import java.util.concurrent.ExecutionException;\r\n> -import java.util.concurrent.TimeUnit;\r\n> +import java.util.WeakHashMap;\r\n>  \r\n>  /** The term and the log index defined in the Raft consensus algorithm. */\r\n>  public interface TermIndex extends Comparable<TermIndex> {\r\n>    class Util {\r\n>      /** An LRU Cache for {@link TermIndex} instances */\r\n> -    private static final Cache<TermIndex, TermIndex> CACHE = CacheBuilder.newBuilder()\r\n> -          .maximumSize(1 << 16)\r\n> -          .expireAfterAccess(1, TimeUnit.MINUTES)\r\n> -          .build();\r\n> +    private static final WeakHashMap<TermIndex, WeakReference<TermIndex>> CACHE = new WeakHashMap<>();\r\n> +\r\n> +    private static synchronized TermIndex putIfAbsent(TermIndex termIndex) {\r\n> +      return CACHE.computeIfAbsent(termIndex, WeakReference::new).get();\r\n> +    }\r\n>    }\r\n> +\r\n>    TermIndex[] EMPTY_ARRAY = {};\r\n>  \r\n>    /** @return the term. */\r\n> @@ -109,10 +109,6 @@ public interface TermIndex extends Comparable<TermIndex> {\r\n>          return String.format(\"(t:%s, i:%s)\", longToString(term), longToString(index));\r\n>        }\r\n>      };\r\n> -    try {\r\n> -      return Util.CACHE.get(key, () -> key);\r\n> -    } catch (ExecutionException e) {\r\n> -      throw new IllegalStateException(\"Failed to valueOf(\" + term + \", \" + index + \"), key=\" + key, e);\r\n> -    }\r\n> +    return Util.putIfAbsent(key);\r\n>    }\r\n>  }\r\n> \\ No newline at end of file\r\n> ```\r\n\r\nI don't think we need any cache here. @szetszwo . You already create the TermIndex instance and throw it away to favor the one in the cache. How does it help?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2258740445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2258899751","html_url":"https://github.com/apache/ratis/pull/1126#issuecomment-2258899751","issue_url":"https://api.github.com/repos/apache/ratis/issues/1126","id":2258899751,"node_id":"IC_kwDOBMxbGc6GpBMn","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-30T17:55:07Z","updated_at":"2024-07-30T17:55:07Z","author_association":"CONTRIBUTOR","body":"As reported by @jojochuang in RATIS-2099, there were a lot of `TermIndex$1` objects, \r\n![](https://issues.apache.org/jira/secure/attachment/13069046/Screenshot%202024-05-22%20at%202.08.39%E2%80%AFPM.png)\r\nIt seems there are multiple objects created for the same value of `TermIndex`.  If we have a cache, we make sure there is only one object for one value.  \r\n\r\n>  You already create the TermIndex instance ...\r\n\r\nSince the instance is short live, it will be gc'ed as young gen instead of promoting to old gen.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2258899751/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2259538343","html_url":"https://github.com/apache/ratis/pull/1126#issuecomment-2259538343","issue_url":"https://api.github.com/repos/apache/ratis/issues/1126","id":2259538343,"node_id":"IC_kwDOBMxbGc6GrdGn","user":{"login":"symious","id":14933944,"node_id":"MDQ6VXNlcjE0OTMzOTQ0","avatar_url":"https://avatars.githubusercontent.com/u/14933944?v=4","gravatar_id":"","url":"https://api.github.com/users/symious","html_url":"https://github.com/symious","followers_url":"https://api.github.com/users/symious/followers","following_url":"https://api.github.com/users/symious/following{/other_user}","gists_url":"https://api.github.com/users/symious/gists{/gist_id}","starred_url":"https://api.github.com/users/symious/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/symious/subscriptions","organizations_url":"https://api.github.com/users/symious/orgs","repos_url":"https://api.github.com/users/symious/repos","events_url":"https://api.github.com/users/symious/events{/privacy}","received_events_url":"https://api.github.com/users/symious/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-31T02:51:36Z","updated_at":"2024-07-31T02:51:36Z","author_association":"CONTRIBUTOR","body":"I think the problem at the first place is there are too many annoymous classes not being GCed, not sure if it will be better if we use normal class instead of annoymous class.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2259538343/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2259576126","html_url":"https://github.com/apache/ratis/pull/1126#issuecomment-2259576126","issue_url":"https://api.github.com/repos/apache/ratis/issues/1126","id":2259576126,"node_id":"IC_kwDOBMxbGc6GrmU-","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-31T03:37:54Z","updated_at":"2024-07-31T03:37:54Z","author_association":"CONTRIBUTOR","body":"> ...  it will be better if we use normal class instead of annoymous class.\r\n\r\nIt won't help.  They are the same in the sense of gc.  Anonymous classes just don't have a name.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2259576126/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2261142824","html_url":"https://github.com/apache/ratis/pull/1126#issuecomment-2261142824","issue_url":"https://api.github.com/repos/apache/ratis/issues/1126","id":2261142824,"node_id":"IC_kwDOBMxbGc6Gxk0o","user":{"login":"duongkame","id":17348547,"node_id":"MDQ6VXNlcjE3MzQ4NTQ3","avatar_url":"https://avatars.githubusercontent.com/u/17348547?v=4","gravatar_id":"","url":"https://api.github.com/users/duongkame","html_url":"https://github.com/duongkame","followers_url":"https://api.github.com/users/duongkame/followers","following_url":"https://api.github.com/users/duongkame/following{/other_user}","gists_url":"https://api.github.com/users/duongkame/gists{/gist_id}","starred_url":"https://api.github.com/users/duongkame/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duongkame/subscriptions","organizations_url":"https://api.github.com/users/duongkame/orgs","repos_url":"https://api.github.com/users/duongkame/repos","events_url":"https://api.github.com/users/duongkame/events{/privacy}","received_events_url":"https://api.github.com/users/duongkame/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-31T18:20:42Z","updated_at":"2024-07-31T18:20:42Z","author_association":"CONTRIBUTOR","body":"> As reported by @jojochuang in [RATIS-2099](https://issues.apache.org/jira/browse/RATIS-2099), there were a lot of `TermIndex$1` objects, ![](https://camo.githubusercontent.com/8349b6152cb8dbc3535f5824cf858f5cd808b1c27c04d0975b7be0085a3a29b1/68747470733a2f2f6973737565732e6170616368652e6f72672f6a6972612f7365637572652f6174746163686d656e742f31333036393034362f53637265656e73686f74253230323032342d30352d32322532306174253230322e30382e3339254532253830254146504d2e706e67) It seems there are multiple objects created for the same value of `TermIndex`. If we have a cache, we make sure there is only one object for one value.\r\n> \r\n> > You already create the TermIndex instance ...\r\n> \r\n> Since the instance is short live, it will be gc'ed as young gen instead of promoting to old gen.\r\n\r\nWe need to identify the source of them. I believe the TermIndex instances we cache are in the RaftLog cache. And in that cache, TermIndex (term, index) instances are unique. How does deduplication/interning help to reduce the number of cached TermIndex instances?","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2261142824/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2261204481","html_url":"https://github.com/apache/ratis/pull/1126#issuecomment-2261204481","issue_url":"https://api.github.com/repos/apache/ratis/issues/1126","id":2261204481,"node_id":"IC_kwDOBMxbGc6Gxz4B","user":{"login":"szetszwo","id":907380,"node_id":"MDQ6VXNlcjkwNzM4MA==","avatar_url":"https://avatars.githubusercontent.com/u/907380?v=4","gravatar_id":"","url":"https://api.github.com/users/szetszwo","html_url":"https://github.com/szetszwo","followers_url":"https://api.github.com/users/szetszwo/followers","following_url":"https://api.github.com/users/szetszwo/following{/other_user}","gists_url":"https://api.github.com/users/szetszwo/gists{/gist_id}","starred_url":"https://api.github.com/users/szetszwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szetszwo/subscriptions","organizations_url":"https://api.github.com/users/szetszwo/orgs","repos_url":"https://api.github.com/users/szetszwo/repos","events_url":"https://api.github.com/users/szetszwo/events{/privacy}","received_events_url":"https://api.github.com/users/szetszwo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-31T18:59:57Z","updated_at":"2024-07-31T18:59:57Z","author_association":"CONTRIBUTOR","body":"> ... TermIndex (term, index) instances are unique. How does deduplication/interning help to reduce the number of cached TermIndex instances?\r\n\r\n`TermIndex` objects are created by the `valueOf(..)` methods.  In the code, we definitely are calling the `valueOf(..)` methods multiple times for the same term and index.  As you mentioned, some of the `TermIndex` objects are stored in cache so they are not gc'ed.   We may have stored the same `TermIndex` value multiple times.  Otherwise, we won't get 2.4m `TermIndex` objects in https://github.com/apache/ratis/pull/1126#issuecomment-2258899751\r\n\r\n@jojochuang , would you be able to reproduce it?  It would be great if we can test the deduplication.","reactions":{"url":"https://api.github.com/repos/apache/ratis/issues/comments/2261204481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]