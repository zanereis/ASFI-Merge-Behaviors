[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/575998436","html_url":"https://github.com/apache/iceberg/issues/358#issuecomment-575998436","issue_url":"https://api.github.com/repos/apache/iceberg/issues/358","id":575998436,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTk5ODQzNg==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-19T12:11:37Z","updated_at":"2020-01-19T12:11:37Z","author_association":"COLLABORATOR","body":"I would like to restart this job by myself upon https://github.com/apache/incubator-iceberg/pull/588. \r\n\r\nNext step are adding sequence number for manifest file in the manifest list and modifying the manifest reader.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/575998436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576301877","html_url":"https://github.com/apache/iceberg/issues/740#issuecomment-576301877","issue_url":"https://api.github.com/repos/apache/iceberg/issues/740","id":576301877,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjMwMTg3Nw==","user":{"login":"massdosage","id":29457,"node_id":"MDQ6VXNlcjI5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/29457?v=4","gravatar_id":"","url":"https://api.github.com/users/massdosage","html_url":"https://github.com/massdosage","followers_url":"https://api.github.com/users/massdosage/followers","following_url":"https://api.github.com/users/massdosage/following{/other_user}","gists_url":"https://api.github.com/users/massdosage/gists{/gist_id}","starred_url":"https://api.github.com/users/massdosage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massdosage/subscriptions","organizations_url":"https://api.github.com/users/massdosage/orgs","repos_url":"https://api.github.com/users/massdosage/repos","events_url":"https://api.github.com/users/massdosage/events{/privacy}","received_events_url":"https://api.github.com/users/massdosage/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-20T14:36:18Z","updated_at":"2020-01-20T14:36:18Z","author_association":"CONTRIBUTOR","body":"Thanks for the information on those options @rdsr. For now I've gone with option 1. - depending on `iceberg-core` instead of `iceberg-spark-runtime`. For this particular usage I don't need any of the Spark classes so it's fine. There are other issues with the spark-runtime module related to versions of Hive but this is probably a bigger issue than what I was reporting here. I guess we can close this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576301877/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576524930","html_url":"https://github.com/apache/iceberg/pull/695#issuecomment-576524930","issue_url":"https://api.github.com/repos/apache/iceberg/issues/695","id":576524930,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjUyNDkzMA==","user":{"login":"mehtaashish23","id":75326,"node_id":"MDQ6VXNlcjc1MzI2","avatar_url":"https://avatars.githubusercontent.com/u/75326?v=4","gravatar_id":"","url":"https://api.github.com/users/mehtaashish23","html_url":"https://github.com/mehtaashish23","followers_url":"https://api.github.com/users/mehtaashish23/followers","following_url":"https://api.github.com/users/mehtaashish23/following{/other_user}","gists_url":"https://api.github.com/users/mehtaashish23/gists{/gist_id}","starred_url":"https://api.github.com/users/mehtaashish23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mehtaashish23/subscriptions","organizations_url":"https://api.github.com/users/mehtaashish23/orgs","repos_url":"https://api.github.com/users/mehtaashish23/repos","events_url":"https://api.github.com/users/mehtaashish23/events{/privacy}","received_events_url":"https://api.github.com/users/mehtaashish23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-21T05:32:34Z","updated_at":"2020-01-21T05:32:34Z","author_association":"CONTRIBUTOR","body":"Guys, I was checking how this cherrypick feature is going to work, and saw a discrepancy of the current work with `ExpireSnapshots` feature. Considering that we generate a new snapshot, by cherrypicking changes of a stagedSnapshot, then this stagedSnapshot is kind of dangling i.e. not on the linked chain/list of snapshots of table, which means when this gets expires then the current implementation [0] will delete the underlying manifest and dataFiles, which can be catastrophic, since the current table actually hold reference to those dataFiles.\r\n\r\nDoes that make sense? If yes, then we can collaborate to come up with a fix, which shouldn't be a big effort. \r\n\r\n[0]: https://github.com/apache/incubator-iceberg/blob/master/core/src/main/java/org/apache/iceberg/RemoveSnapshots.java#L234 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576524930/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576543973","html_url":"https://github.com/apache/iceberg/pull/695#issuecomment-576543973","issue_url":"https://api.github.com/repos/apache/iceberg/issues/695","id":576543973,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjU0Mzk3Mw==","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-21T06:55:58Z","updated_at":"2020-01-21T06:58:26Z","author_association":"CONTRIBUTOR","body":"@mehtaashish23 Good catch! Can you raise another issue with a gist to illustrate the issue? We can take that up as a followup. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576543973/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576574659","html_url":"https://github.com/apache/iceberg/issues/179#issuecomment-576574659","issue_url":"https://api.github.com/repos/apache/iceberg/issues/179","id":576574659,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjU3NDY1OQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-21T08:37:25Z","updated_at":"2020-01-21T08:37:25Z","author_association":"CONTRIBUTOR","body":"@jerryshao, sorry for the delay. I am still not up to speed after holidays.\r\n\r\nI've started thinking about it and it would be great to leverage #315. However, the last time I checked that PR (a long time ago) I didn't see a way to split a large batch commit into multiple output streaming micro-batches. For example, if a batch job inserts a couple of TBs, you might not want to stream this out of your table in one micro-batch. That got me thinking about keeping some sort of indexing (e.g. manifest name + ordinal position of the last processed file in that manifest) to split large batches. The same logic potentially can be used if we want to stream all of the data from a batch table using Structured Streaming. I haven't thought much about this idea afterwards. Maybe, there is a better way or maybe we can start without that.\r\n\r\n@jerryshao, I'll be glad if you pick this up. Did you have any specific ideas?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576574659/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576577519","html_url":"https://github.com/apache/iceberg/issues/179#issuecomment-576577519","issue_url":"https://api.github.com/repos/apache/iceberg/issues/179","id":576577519,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjU3NzUxOQ==","user":{"login":"jerryshao","id":850797,"node_id":"MDQ6VXNlcjg1MDc5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/850797?v=4","gravatar_id":"","url":"https://api.github.com/users/jerryshao","html_url":"https://github.com/jerryshao","followers_url":"https://api.github.com/users/jerryshao/followers","following_url":"https://api.github.com/users/jerryshao/following{/other_user}","gists_url":"https://api.github.com/users/jerryshao/gists{/gist_id}","starred_url":"https://api.github.com/users/jerryshao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerryshao/subscriptions","organizations_url":"https://api.github.com/users/jerryshao/orgs","repos_url":"https://api.github.com/users/jerryshao/repos","events_url":"https://api.github.com/users/jerryshao/events{/privacy}","received_events_url":"https://api.github.com/users/jerryshao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-21T08:45:25Z","updated_at":"2020-01-21T08:45:25Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi I've already started a simple workable version of streaming read, hopes that I can share it soon. \r\n\r\nAbout batch size control, what I did currently is to control the number of files read per batch, and record them as a Spark `Offset`, so that Spark could continue from restart. I haven't sorted out all the details, I would start building a simple version first, and then refine all the details.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576577519/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576583820","html_url":"https://github.com/apache/iceberg/pull/315#issuecomment-576583820","issue_url":"https://api.github.com/repos/apache/iceberg/issues/315","id":576583820,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjU4MzgyMA==","user":{"login":"jerryshao","id":850797,"node_id":"MDQ6VXNlcjg1MDc5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/850797?v=4","gravatar_id":"","url":"https://api.github.com/users/jerryshao","html_url":"https://github.com/jerryshao","followers_url":"https://api.github.com/users/jerryshao/followers","following_url":"https://api.github.com/users/jerryshao/following{/other_user}","gists_url":"https://api.github.com/users/jerryshao/gists{/gist_id}","starred_url":"https://api.github.com/users/jerryshao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerryshao/subscriptions","organizations_url":"https://api.github.com/users/jerryshao/orgs","repos_url":"https://api.github.com/users/jerryshao/repos","events_url":"https://api.github.com/users/jerryshao/events{/privacy}","received_events_url":"https://api.github.com/users/jerryshao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-21T09:02:01Z","updated_at":"2020-01-21T09:02:01Z","author_association":"CONTRIBUTOR","body":"Hi @rdsr , would you please help to explain the question I left before? The reason why I asked this is because I'm working on streaming read support for Spark, incremental data scan is required to achieve this. \r\n\r\nTypically in Spark we choose [a, b) rather than (a, b], because for (a, b], we should treat the start snapshot \"a\" as a special case, I'm not sure why we choose (a, b], any specific reason?\r\n\r\n> Any specific reason to choose (a, b] instead of [a, b)?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576583820/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576611548","html_url":"https://github.com/apache/iceberg/pull/695#issuecomment-576611548","issue_url":"https://api.github.com/repos/apache/iceberg/issues/695","id":576611548,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjYxMTU0OA==","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-21T10:13:35Z","updated_at":"2020-01-21T10:13:35Z","author_association":"CONTRIBUTOR","body":"@rdblue took into account and tried addressing all pending review comments. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576611548/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576637947","html_url":"https://github.com/apache/iceberg/issues/179#issuecomment-576637947","issue_url":"https://api.github.com/repos/apache/iceberg/issues/179","id":576637947,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjYzNzk0Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-21T11:21:13Z","updated_at":"2020-01-21T11:21:13Z","author_association":"CONTRIBUTOR","body":"@jerryshao, that's great. Looking forward to it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576637947/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576644346","html_url":"https://github.com/apache/iceberg/issues/179#issuecomment-576644346","issue_url":"https://api.github.com/repos/apache/iceberg/issues/179","id":576644346,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjY0NDM0Ng==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-21T11:40:53Z","updated_at":"2020-01-21T11:40:53Z","author_association":"CONTRIBUTOR","body":"@jerryshao, a quick question on the comment above. Spark `Offset` has to be serialized to JSON. Are you storing files directly in that offset JSON file?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576644346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576647291","html_url":"https://github.com/apache/iceberg/issues/179#issuecomment-576647291","issue_url":"https://api.github.com/repos/apache/iceberg/issues/179","id":576647291,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjY0NzI5MQ==","user":{"login":"jerryshao","id":850797,"node_id":"MDQ6VXNlcjg1MDc5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/850797?v=4","gravatar_id":"","url":"https://api.github.com/users/jerryshao","html_url":"https://github.com/jerryshao","followers_url":"https://api.github.com/users/jerryshao/followers","following_url":"https://api.github.com/users/jerryshao/following{/other_user}","gists_url":"https://api.github.com/users/jerryshao/gists{/gist_id}","starred_url":"https://api.github.com/users/jerryshao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerryshao/subscriptions","organizations_url":"https://api.github.com/users/jerryshao/orgs","repos_url":"https://api.github.com/users/jerryshao/repos","events_url":"https://api.github.com/users/jerryshao/events{/privacy}","received_events_url":"https://api.github.com/users/jerryshao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-21T11:50:41Z","updated_at":"2020-01-21T11:50:41Z","author_association":"CONTRIBUTOR","body":"No, I will not store files directly in the offset json file, what I currently do is to store file paths, like what spark did to FileStreamSource, when the offset is loaded in, I will compare and filter out the files which are already processed. I'm currently still in prototyping, the content of `Offset` may be changed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576647291/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576827358","html_url":"https://github.com/apache/iceberg/pull/695#issuecomment-576827358","issue_url":"https://api.github.com/repos/apache/iceberg/issues/695","id":576827358,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjgyNzM1OA==","user":{"login":"mehtaashish23","id":75326,"node_id":"MDQ6VXNlcjc1MzI2","avatar_url":"https://avatars.githubusercontent.com/u/75326?v=4","gravatar_id":"","url":"https://api.github.com/users/mehtaashish23","html_url":"https://github.com/mehtaashish23","followers_url":"https://api.github.com/users/mehtaashish23/followers","following_url":"https://api.github.com/users/mehtaashish23/following{/other_user}","gists_url":"https://api.github.com/users/mehtaashish23/gists{/gist_id}","starred_url":"https://api.github.com/users/mehtaashish23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mehtaashish23/subscriptions","organizations_url":"https://api.github.com/users/mehtaashish23/orgs","repos_url":"https://api.github.com/users/mehtaashish23/repos","events_url":"https://api.github.com/users/mehtaashish23/events{/privacy}","received_events_url":"https://api.github.com/users/mehtaashish23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-21T18:56:13Z","updated_at":"2020-01-21T18:56:56Z","author_association":"CONTRIBUTOR","body":"@prodeezy logged issue https://github.com/apache/incubator-iceberg/issues/744 with gist and overview","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576827358/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576942542","html_url":"https://github.com/apache/iceberg/pull/315#issuecomment-576942542","issue_url":"https://api.github.com/repos/apache/iceberg/issues/315","id":576942542,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Njk0MjU0Mg==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-21T23:55:55Z","updated_at":"2020-01-22T03:24:13Z","author_association":"CONTRIBUTOR","body":"@jerryshao The problem with `[a,b)` is it misses data from snapshot b.  So it cannot model the problem well if a user wants to consume all new data which has arrived since he last read the table. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576942542/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576978755","html_url":"https://github.com/apache/iceberg/pull/315#issuecomment-576978755","issue_url":"https://api.github.com/repos/apache/iceberg/issues/315","id":576978755,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Njk3ODc1NQ==","user":{"login":"jerryshao","id":850797,"node_id":"MDQ6VXNlcjg1MDc5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/850797?v=4","gravatar_id":"","url":"https://api.github.com/users/jerryshao","html_url":"https://github.com/jerryshao","followers_url":"https://api.github.com/users/jerryshao/followers","following_url":"https://api.github.com/users/jerryshao/following{/other_user}","gists_url":"https://api.github.com/users/jerryshao/gists{/gist_id}","starred_url":"https://api.github.com/users/jerryshao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerryshao/subscriptions","organizations_url":"https://api.github.com/users/jerryshao/orgs","repos_url":"https://api.github.com/users/jerryshao/repos","events_url":"https://api.github.com/users/jerryshao/events{/privacy}","received_events_url":"https://api.github.com/users/jerryshao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-22T02:26:41Z","updated_at":"2020-01-22T02:26:41Z","author_association":"CONTRIBUTOR","body":"Thanks @rdsr for your explain, yes for `(a, b]` user could simply consume all new data after `b`, but how do user consume snapshot `a`, especially for a beginning snapshot?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/576978755/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577001815","html_url":"https://github.com/apache/iceberg/pull/315#issuecomment-577001815","issue_url":"https://api.github.com/repos/apache/iceberg/issues/315","id":577001815,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzAwMTgxNQ==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-22T04:27:16Z","updated_at":"2020-01-22T04:27:24Z","author_association":"CONTRIBUTOR","body":"> especially for a beginning snapshot?\r\n\r\nDo you mean running incremental for the very first time? In this scenario, I think we can simply use a normal/full tableScan after finding the latest snapshot id. Future runs can use that saved snapshot id to do incremental scans","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577001815/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577022140","html_url":"https://github.com/apache/iceberg/pull/315#issuecomment-577022140","issue_url":"https://api.github.com/repos/apache/iceberg/issues/315","id":577022140,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzAyMjE0MA==","user":{"login":"jerryshao","id":850797,"node_id":"MDQ6VXNlcjg1MDc5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/850797?v=4","gravatar_id":"","url":"https://api.github.com/users/jerryshao","html_url":"https://github.com/jerryshao","followers_url":"https://api.github.com/users/jerryshao/followers","following_url":"https://api.github.com/users/jerryshao/following{/other_user}","gists_url":"https://api.github.com/users/jerryshao/gists{/gist_id}","starred_url":"https://api.github.com/users/jerryshao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerryshao/subscriptions","organizations_url":"https://api.github.com/users/jerryshao/orgs","repos_url":"https://api.github.com/users/jerryshao/repos","events_url":"https://api.github.com/users/jerryshao/events{/privacy}","received_events_url":"https://api.github.com/users/jerryshao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-22T06:00:56Z","updated_at":"2020-01-22T06:01:15Z","author_association":"CONTRIBUTOR","body":"> Do you mean running incremental for the very first time? Do you mean running incremental for the very first time? In this scenario, I think we can simply use a normal/full tableScan after finding the latest snapshot id. Future runs can use that saved snapshot id to do incremental scans\r\n\r\nYes, that's what I mean, seems this is the only way currently.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577022140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577112103","html_url":"https://github.com/apache/iceberg/issues/732#issuecomment-577112103","issue_url":"https://api.github.com/repos/apache/iceberg/issues/732","id":577112103,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzExMjEwMw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-22T10:20:01Z","updated_at":"2020-01-22T10:20:44Z","author_association":"CONTRIBUTOR","body":"To add to the @rdblue's comment, Iceberg also looks at file-level and partition-level stats in some operations to decide if two commits are in conflict. Combined with caching of the work and cheap metadata retries, it allows us to commit concurrent changes to the same partition quickly (if operations are not in conflict).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577112103/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577428854","html_url":"https://github.com/apache/iceberg/pull/745#issuecomment-577428854","issue_url":"https://api.github.com/repos/apache/iceberg/issues/745","id":577428854,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzQyODg1NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-22T23:07:46Z","updated_at":"2020-01-22T23:07:46Z","author_association":"CONTRIBUTOR","body":"From #741, it looks like the problem this is trying to address is that you can't write to a table with a different column order than the order of the table schema.\r\n\r\nThe reason for this restriction is that Spark should be responsible for reconciling table columns with the data from a query. Spark has two different modes for doing this: by position for SQL, and by name for DataFrame writes. I think that delegating this to Spark is the right long-term solution.\r\n\r\nIn the short term, Spark 2.4 has no resolution step for v2 writes. That's why Iceberg has the current checks that it does, so that you don't corrupt a table by writing the wrong thing. I'd rather not extend the current checks if we don't need to, given that this will be handled by Spark in the next version. Is that reasonable?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577428854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577788780","html_url":"https://github.com/apache/iceberg/issues/740#issuecomment-577788780","issue_url":"https://api.github.com/repos/apache/iceberg/issues/740","id":577788780,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Nzc4ODc4MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T17:37:19Z","updated_at":"2020-01-23T17:37:19Z","author_association":"CONTRIBUTOR","body":"I'll close this. Thanks for the good discussion, @massdosage! Can you also report the other issues you've run into?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577788780/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577790319","html_url":"https://github.com/apache/iceberg/issues/740#issuecomment-577790319","issue_url":"https://api.github.com/repos/apache/iceberg/issues/740","id":577790319,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Nzc5MDMxOQ==","user":{"login":"massdosage","id":29457,"node_id":"MDQ6VXNlcjI5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/29457?v=4","gravatar_id":"","url":"https://api.github.com/users/massdosage","html_url":"https://github.com/massdosage","followers_url":"https://api.github.com/users/massdosage/followers","following_url":"https://api.github.com/users/massdosage/following{/other_user}","gists_url":"https://api.github.com/users/massdosage/gists{/gist_id}","starred_url":"https://api.github.com/users/massdosage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massdosage/subscriptions","organizations_url":"https://api.github.com/users/massdosage/orgs","repos_url":"https://api.github.com/users/massdosage/repos","events_url":"https://api.github.com/users/massdosage/events{/privacy}","received_events_url":"https://api.github.com/users/massdosage/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T17:41:19Z","updated_at":"2020-01-23T17:41:19Z","author_association":"CONTRIBUTOR","body":"If/when we find more we'll be sure to report them ;) Thanks all!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577790319/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577794161","html_url":"https://github.com/apache/iceberg/pull/738#issuecomment-577794161","issue_url":"https://api.github.com/repos/apache/iceberg/issues/738","id":577794161,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Nzc5NDE2MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T17:51:22Z","updated_at":"2020-01-23T17:51:22Z","author_association":"CONTRIBUTOR","body":"Thanks @aokolnychyi! I'll merge this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577794161/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577800307","html_url":"https://github.com/apache/iceberg/issues/697#issuecomment-577800307","issue_url":"https://api.github.com/repos/apache/iceberg/issues/697","id":577800307,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzgwMDMwNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T18:06:32Z","updated_at":"2020-01-23T18:06:32Z","author_association":"CONTRIBUTOR","body":"Merged #721. Thanks @jerryshao!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577800307/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577801877","html_url":"https://github.com/apache/iceberg/pull/688#issuecomment-577801877","issue_url":"https://api.github.com/repos/apache/iceberg/issues/688","id":577801877,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzgwMTg3Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T18:10:36Z","updated_at":"2020-01-23T18:10:36Z","author_association":"CONTRIBUTOR","body":"@shawnding, sorry that I haven't reviewed this yet. I didn't realize that you'd pushed changes. I'll put this in the queue to look at.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577801877/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577802753","html_url":"https://github.com/apache/iceberg/issues/744#issuecomment-577802753","issue_url":"https://api.github.com/repos/apache/iceberg/issues/744","id":577802753,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzgwMjc1Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T18:12:43Z","updated_at":"2020-01-23T18:12:43Z","author_association":"CONTRIBUTOR","body":"Good catch, @mehtaashish23!\r\n\r\nThe snapshot expiration code will need to detect picked snapshots and ignore them. @prodeezy, do we keep the picked snapshot ID in the summary metadata? If not, we should add it for this purpose.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577802753/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577812097","html_url":"https://github.com/apache/iceberg/pull/712#issuecomment-577812097","issue_url":"https://api.github.com/repos/apache/iceberg/issues/712","id":577812097,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzgxMjA5Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T18:29:31Z","updated_at":"2020-01-23T18:29:31Z","author_association":"CONTRIBUTOR","body":"I'm going to close this since there hasn't been an update recently. Feel free to update it to use `parseMultipartIdentifier` and reopen if you think it's still an issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577812097/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577813276","html_url":"https://github.com/apache/iceberg/pull/747#issuecomment-577813276","issue_url":"https://api.github.com/repos/apache/iceberg/issues/747","id":577813276,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzgxMzI3Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T18:32:23Z","updated_at":"2020-01-23T18:32:23Z","author_association":"CONTRIBUTOR","body":"Thanks, @rdsr!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577813276/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577813558","html_url":"https://github.com/apache/iceberg/pull/746#issuecomment-577813558","issue_url":"https://api.github.com/repos/apache/iceberg/issues/746","id":577813558,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzgxMzU1OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T18:33:02Z","updated_at":"2020-01-23T18:33:02Z","author_association":"CONTRIBUTOR","body":"Thanks for the fix, @waterlx!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577813558/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577815506","html_url":"https://github.com/apache/iceberg/pull/708#issuecomment-577815506","issue_url":"https://api.github.com/repos/apache/iceberg/issues/708","id":577815506,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzgxNTUwNg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T18:37:56Z","updated_at":"2020-01-23T18:37:56Z","author_association":"CONTRIBUTOR","body":"Thanks @Fokko! Would you mind correcting the minor issue with `DynConstructors`?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577815506/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577815896","html_url":"https://github.com/apache/iceberg/pull/716#issuecomment-577815896","issue_url":"https://api.github.com/repos/apache/iceberg/issues/716","id":577815896,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzgxNTg5Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T18:38:53Z","updated_at":"2020-01-23T18:38:53Z","author_association":"CONTRIBUTOR","body":"@shawnding, could you update the tests? I think we can get this one in soon.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577815896/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577816448","html_url":"https://github.com/apache/iceberg/pull/735#issuecomment-577816448","issue_url":"https://api.github.com/repos/apache/iceberg/issues/735","id":577816448,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzgxNjQ0OA==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T18:40:15Z","updated_at":"2020-01-23T18:40:15Z","author_association":"CONTRIBUTOR","body":"Any thoughts on the updated PR @rdblue ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577816448/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577823278","html_url":"https://github.com/apache/iceberg/pull/735#issuecomment-577823278","issue_url":"https://api.github.com/repos/apache/iceberg/issues/735","id":577823278,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzgyMzI3OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T18:55:44Z","updated_at":"2020-01-23T18:55:44Z","author_association":"CONTRIBUTOR","body":"@rdsr, thanks for the update! I think it's close, but we need to still avoid a copy. Also, I think there is a better way to update `ManifestGroup` that requires fewer changes and accomplishes the same thing -- just make it mutable.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577823278/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577872673","html_url":"https://github.com/apache/iceberg/pull/745#issuecomment-577872673","issue_url":"https://api.github.com/repos/apache/iceberg/issues/745","id":577872673,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Nzg3MjY3Mw==","user":{"login":"davrmac","id":13126392,"node_id":"MDQ6VXNlcjEzMTI2Mzky","avatar_url":"https://avatars.githubusercontent.com/u/13126392?v=4","gravatar_id":"","url":"https://api.github.com/users/davrmac","html_url":"https://github.com/davrmac","followers_url":"https://api.github.com/users/davrmac/followers","following_url":"https://api.github.com/users/davrmac/following{/other_user}","gists_url":"https://api.github.com/users/davrmac/gists{/gist_id}","starred_url":"https://api.github.com/users/davrmac/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davrmac/subscriptions","organizations_url":"https://api.github.com/users/davrmac/orgs","repos_url":"https://api.github.com/users/davrmac/repos","events_url":"https://api.github.com/users/davrmac/events{/privacy}","received_events_url":"https://api.github.com/users/davrmac/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T20:55:21Z","updated_at":"2020-01-23T20:55:21Z","author_association":"NONE","body":"Hi @rdblue, I'm working with @ravichinoy on this issue and had a couple of follow up questions:\r\n\r\n1) For the compatibility check change is your concern just about not updating a code-path that's about to be deprecated, or do you also have correctness concerns about dropping the ordering check? From my understanding of the Spark-to-Iceberg write path, Spark has already bound field names to all of the columns being written by the time it calls the IcebergSource to create a writer, and Iceberg uses those field names (and not the field order) to perform the mapping back to the corresponding fieldIds in the Iceberg schema (which it then uses to perform the rest of its compatibility checks). Are there other parts of the Iceberg write path that still depend on field order that would cause corruptions if the ordering check wasn't enforced?\r\n\r\n2) Do you have any concerns with the second half of @ravichinoy's change (i.e. switching from using the Iceberg table schema to the Spark schema when building the PartitionKey accessor)? It's less relevant if we're still enforcing that the Spark schema match the field order of the Iceberg table schema, but I believe there are still scenarios where, if the Spark schema is missing optional fields that are defined in the Iceberg table schema, the write can pass the compatibility check but build a PartitionKey accessor that fails to pull the correct fields out of each InternalRow (we can try writing a test case to prove whether or not this is actually an issue).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577872673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577878282","html_url":"https://github.com/apache/iceberg/issues/744#issuecomment-577878282","issue_url":"https://api.github.com/repos/apache/iceberg/issues/744","id":577878282,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Nzg3ODI4Mg==","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T21:10:17Z","updated_at":"2020-01-23T21:10:17Z","author_association":"CONTRIBUTOR","body":"right .. we should add it in the published snapshot's summary for other operations like ExpireSnapshots to lookup. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577878282/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577883861","html_url":"https://github.com/apache/iceberg/issues/744#issuecomment-577883861","issue_url":"https://api.github.com/repos/apache/iceberg/issues/744","id":577883861,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Nzg4Mzg2MQ==","user":{"login":"mehtaashish23","id":75326,"node_id":"MDQ6VXNlcjc1MzI2","avatar_url":"https://avatars.githubusercontent.com/u/75326?v=4","gravatar_id":"","url":"https://api.github.com/users/mehtaashish23","html_url":"https://github.com/mehtaashish23","followers_url":"https://api.github.com/users/mehtaashish23/followers","following_url":"https://api.github.com/users/mehtaashish23/following{/other_user}","gists_url":"https://api.github.com/users/mehtaashish23/gists{/gist_id}","starred_url":"https://api.github.com/users/mehtaashish23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mehtaashish23/subscriptions","organizations_url":"https://api.github.com/users/mehtaashish23/orgs","repos_url":"https://api.github.com/users/mehtaashish23/repos","events_url":"https://api.github.com/users/mehtaashish23/events{/privacy}","received_events_url":"https://api.github.com/users/mehtaashish23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T21:24:37Z","updated_at":"2020-01-23T21:24:37Z","author_association":"CONTRIBUTOR","body":"+1, I was trying to come up with a fix, but noticed, that we do track `published-wap-id` in cherrypick commit, but don't currently track the WAP's original snapshotId.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577883861/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577889902","html_url":"https://github.com/apache/iceberg/issues/744#issuecomment-577889902","issue_url":"https://api.github.com/repos/apache/iceberg/issues/744","id":577889902,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Nzg4OTkwMg==","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T21:40:51Z","updated_at":"2020-01-23T21:40:51Z","author_association":"CONTRIBUTOR","body":"@mehtaashish23  do you have a preference on what the summary property should be called?  For instance: `source-snapshot-id` ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577889902/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577891391","html_url":"https://github.com/apache/iceberg/issues/744#issuecomment-577891391","issue_url":"https://api.github.com/repos/apache/iceberg/issues/744","id":577891391,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Nzg5MTM5MQ==","user":{"login":"mehtaashish23","id":75326,"node_id":"MDQ6VXNlcjc1MzI2","avatar_url":"https://avatars.githubusercontent.com/u/75326?v=4","gravatar_id":"","url":"https://api.github.com/users/mehtaashish23","html_url":"https://github.com/mehtaashish23","followers_url":"https://api.github.com/users/mehtaashish23/followers","following_url":"https://api.github.com/users/mehtaashish23/following{/other_user}","gists_url":"https://api.github.com/users/mehtaashish23/gists{/gist_id}","starred_url":"https://api.github.com/users/mehtaashish23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mehtaashish23/subscriptions","organizations_url":"https://api.github.com/users/mehtaashish23/orgs","repos_url":"https://api.github.com/users/mehtaashish23/repos","events_url":"https://api.github.com/users/mehtaashish23/events{/privacy}","received_events_url":"https://api.github.com/users/mehtaashish23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T21:44:43Z","updated_at":"2020-01-23T21:44:43Z","author_association":"CONTRIBUTOR","body":"@prodeezy I was thinking about `cherrypick-snapshot-id`, but I wonder `source-snapshot-id` is better and extendable name. I would go with `source-snapshot-id` if no-one has any concern.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577891391/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577913730","html_url":"https://github.com/apache/iceberg/issues/744#issuecomment-577913730","issue_url":"https://api.github.com/repos/apache/iceberg/issues/744","id":577913730,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzkxMzczMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-23T22:47:12Z","updated_at":"2020-01-23T22:47:12Z","author_association":"CONTRIBUTOR","body":"Either one sounds good to me!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577913730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577945330","html_url":"https://github.com/apache/iceberg/issues/682#issuecomment-577945330","issue_url":"https://api.github.com/repos/apache/iceberg/issues/682","id":577945330,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Nzk0NTMzMA==","user":{"login":"bachar84","id":60241735,"node_id":"MDQ6VXNlcjYwMjQxNzM1","avatar_url":"https://avatars.githubusercontent.com/u/60241735?v=4","gravatar_id":"","url":"https://api.github.com/users/bachar84","html_url":"https://github.com/bachar84","followers_url":"https://api.github.com/users/bachar84/followers","following_url":"https://api.github.com/users/bachar84/following{/other_user}","gists_url":"https://api.github.com/users/bachar84/gists{/gist_id}","starred_url":"https://api.github.com/users/bachar84/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bachar84/subscriptions","organizations_url":"https://api.github.com/users/bachar84/orgs","repos_url":"https://api.github.com/users/bachar84/repos","events_url":"https://api.github.com/users/bachar84/events{/privacy}","received_events_url":"https://api.github.com/users/bachar84/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-24T00:46:12Z","updated_at":"2020-01-24T00:46:12Z","author_association":"NONE","body":"In my humble opinion, issue #327 is the roots of persecution ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577945330/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577946018","html_url":"https://github.com/apache/iceberg/pull/745#issuecomment-577946018","issue_url":"https://api.github.com/repos/apache/iceberg/issues/745","id":577946018,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Nzk0NjAxOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-24T00:49:21Z","updated_at":"2020-01-24T00:49:21Z","author_association":"CONTRIBUTOR","body":"> Do you also have correctness concerns about dropping the ordering check?\r\n\r\nI don't have correctness concerns. Handling field reordering is a requirement, and Spark recently added DDL statements to reorder fields.\r\n\r\nMainly, I wonder if it is a good idea to write data files with a column order that depends on the incoming query instead of the table's current column order. Reordering columns can change performance in Avro and it may be surprising when people look at a file in the table and see columns in an unexpected order. These aren't correctness blockers, but if this is going to be moot in the next Spark release then my thinking was that we don't need to choose what the behavior _should_ be.\r\n\r\n> Do you have any concerns with the second half of @ravichinoy's change (i.e. switching from using the Iceberg table schema to the Spark schema when building the PartitionKey accessor)?\r\n\r\nNo. And now that you mentioned your concerns, I think that's probably a good idea to use the incoming schema.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577946018/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577947321","html_url":"https://github.com/apache/iceberg/issues/744#issuecomment-577947321","issue_url":"https://api.github.com/repos/apache/iceberg/issues/744","id":577947321,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Nzk0NzMyMQ==","user":{"login":"bachar84","id":60241735,"node_id":"MDQ6VXNlcjYwMjQxNzM1","avatar_url":"https://avatars.githubusercontent.com/u/60241735?v=4","gravatar_id":"","url":"https://api.github.com/users/bachar84","html_url":"https://github.com/bachar84","followers_url":"https://api.github.com/users/bachar84/followers","following_url":"https://api.github.com/users/bachar84/following{/other_user}","gists_url":"https://api.github.com/users/bachar84/gists{/gist_id}","starred_url":"https://api.github.com/users/bachar84/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bachar84/subscriptions","organizations_url":"https://api.github.com/users/bachar84/orgs","repos_url":"https://api.github.com/users/bachar84/repos","events_url":"https://api.github.com/users/bachar84/events{/privacy}","received_events_url":"https://api.github.com/users/bachar84/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-24T00:55:24Z","updated_at":"2020-01-24T00:55:24Z","author_association":"NONE","body":"Re-write","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577947321/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577947519","html_url":"https://github.com/apache/iceberg/issues/744#issuecomment-577947519","issue_url":"https://api.github.com/repos/apache/iceberg/issues/744","id":577947519,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Nzk0NzUxOQ==","user":{"login":"bachar84","id":60241735,"node_id":"MDQ6VXNlcjYwMjQxNzM1","avatar_url":"https://avatars.githubusercontent.com/u/60241735?v=4","gravatar_id":"","url":"https://api.github.com/users/bachar84","html_url":"https://github.com/bachar84","followers_url":"https://api.github.com/users/bachar84/followers","following_url":"https://api.github.com/users/bachar84/following{/other_user}","gists_url":"https://api.github.com/users/bachar84/gists{/gist_id}","starred_url":"https://api.github.com/users/bachar84/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bachar84/subscriptions","organizations_url":"https://api.github.com/users/bachar84/orgs","repos_url":"https://api.github.com/users/bachar84/repos","events_url":"https://api.github.com/users/bachar84/events{/privacy}","received_events_url":"https://api.github.com/users/bachar84/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-24T00:56:10Z","updated_at":"2020-01-24T00:56:10Z","author_association":"NONE","body":"Re-write","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577947519/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577947971","html_url":"https://github.com/apache/iceberg/issues/682#issuecomment-577947971","issue_url":"https://api.github.com/repos/apache/iceberg/issues/682","id":577947971,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Nzk0Nzk3MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-24T00:58:08Z","updated_at":"2020-01-24T00:58:08Z","author_association":"CONTRIBUTOR","body":"> In my humble opinion, issue #327 is the roots of persecution\r\n\r\nI'm not sure I understand you. What do you mean?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577947971/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577950910","html_url":"https://github.com/apache/iceberg/pull/735#issuecomment-577950910","issue_url":"https://api.github.com/repos/apache/iceberg/issues/735","id":577950910,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Nzk1MDkxMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-24T01:11:30Z","updated_at":"2020-01-24T01:11:30Z","author_association":"CONTRIBUTOR","body":"Thanks @rdsr! Just one remaining issue with the stats column projection and I think we're ready to get this in.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577950910/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577951622","html_url":"https://github.com/apache/iceberg/pull/745#issuecomment-577951622","issue_url":"https://api.github.com/repos/apache/iceberg/issues/745","id":577951622,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Nzk1MTYyMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-24T01:14:55Z","updated_at":"2020-01-24T01:14:55Z","author_association":"CONTRIBUTOR","body":"@ravichinoy & @davrmac, I think we can get this in if we add a write config option that controls whether to do the order check, since we already have a boolean for it. We just need to pass it in from writes and then it's up to the user whether to require the same column order as the table. Does that work for you?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/577951622/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578065527","html_url":"https://github.com/apache/iceberg/pull/675#issuecomment-578065527","issue_url":"https://api.github.com/repos/apache/iceberg/issues/675","id":578065527,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODA2NTUyNw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-24T10:01:35Z","updated_at":"2020-01-24T10:01:35Z","author_association":"CONTRIBUTOR","body":"@chenjunjiedada @rdblue, I've updated the PR and got rid of reading manifests if we can inherit the snapshot id. Also, there is a feature flag now. Let me know what you think.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578065527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578076143","html_url":"https://github.com/apache/iceberg/issues/682#issuecomment-578076143","issue_url":"https://api.github.com/repos/apache/iceberg/issues/682","id":578076143,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODA3NjE0Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-24T10:33:28Z","updated_at":"2020-01-24T10:33:44Z","author_association":"CONTRIBUTOR","body":"I think `SparkFilters` already converts startsWith correctly. However, we need to update it to use new expressions for IN as it still rewrites it as OR/AND.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578076143/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578211618","html_url":"https://github.com/apache/iceberg/issues/682#issuecomment-578211618","issue_url":"https://api.github.com/repos/apache/iceberg/issues/682","id":578211618,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODIxMTYxOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-24T16:53:13Z","updated_at":"2020-01-24T16:53:13Z","author_association":"CONTRIBUTOR","body":"I agree. I opened #748 to track updating `SparkFilters`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578211618/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578252585","html_url":"https://github.com/apache/iceberg/issues/744#issuecomment-578252585","issue_url":"https://api.github.com/repos/apache/iceberg/issues/744","id":578252585,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODI1MjU4NQ==","user":{"login":"mehtaashish23","id":75326,"node_id":"MDQ6VXNlcjc1MzI2","avatar_url":"https://avatars.githubusercontent.com/u/75326?v=4","gravatar_id":"","url":"https://api.github.com/users/mehtaashish23","html_url":"https://github.com/mehtaashish23","followers_url":"https://api.github.com/users/mehtaashish23/followers","following_url":"https://api.github.com/users/mehtaashish23/following{/other_user}","gists_url":"https://api.github.com/users/mehtaashish23/gists{/gist_id}","starred_url":"https://api.github.com/users/mehtaashish23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mehtaashish23/subscriptions","organizations_url":"https://api.github.com/users/mehtaashish23/orgs","repos_url":"https://api.github.com/users/mehtaashish23/repos","events_url":"https://api.github.com/users/mehtaashish23/events{/privacy}","received_events_url":"https://api.github.com/users/mehtaashish23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-24T18:46:25Z","updated_at":"2020-01-24T18:46:25Z","author_association":"CONTRIBUTOR","body":"I was planning to do code changes for this, and the approach will be following\r\n\r\n1. If you are expiring a stagedSnapshot, then a) if its referred by a snapshot, which is part of ancestor list of current table, then the underlying data isn't deleted. b) If not then its deleted.\r\n2. If you are expiring a snapshot (say S1) which refer to another snapshot via property `source-snapshot-id` (say B1) then both of them are expired to avoid problems in future. By problem, I mean, if we don't do this, then client can expire S1 first, and then expire B1 (which will be detected as dangling, if S1 is not in Ancestor list)\r\n\r\nLet me know, if you have any concerns. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578252585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578336544","html_url":"https://github.com/apache/iceberg/issues/744#issuecomment-578336544","issue_url":"https://api.github.com/repos/apache/iceberg/issues/744","id":578336544,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODMzNjU0NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-24T23:04:52Z","updated_at":"2020-01-24T23:04:52Z","author_association":"CONTRIBUTOR","body":"@mehtaashish23, I think it is a little simpler than that because we know that snapshots will only reference older snapshots.\r\n\r\nSay I have snapshots A <- B <- C and my current table state is B. If I pick C on top of B to create D(C), then I know D must have come after D. If we also assume that the changes in C are identical to D, but with a different parent, then we can handle expiration fairly easily. First, if C is the source-snapshot-id for any known snapshot then we skip it during expiration. The same set of changes will be expired by D. Second, when we expire D, we don't need to look for C because it expired first. These rules also work regardless of the current table state and its ancestors.\r\n\r\nI think it would be okay to say that if D expires then C also expires, but it shouldn't be necessary.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578336544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578476401","html_url":"https://github.com/apache/iceberg/issues/748#issuecomment-578476401","issue_url":"https://api.github.com/repos/apache/iceberg/issues/748","id":578476401,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODQ3NjQwMQ==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-26T07:43:01Z","updated_at":"2020-01-26T20:41:01Z","author_association":"COLLABORATOR","body":"@rdblue  I have created a PR (https://github.com/apache/incubator-iceberg/pull/749) to update `SparkFilters`. \r\nAs Spark currently only supports In filter, I updated the code to convert it to iceberg IN Expression.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578476401/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578476509","html_url":"https://github.com/apache/iceberg/pull/749#issuecomment-578476509","issue_url":"https://api.github.com/repos/apache/iceberg/issues/749","id":578476509,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODQ3NjUwOQ==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-26T07:45:07Z","updated_at":"2020-01-26T07:45:07Z","author_association":"COLLABORATOR","body":"@rdblue  can you help to review it? Thanks!\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578476509/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578521150","html_url":"https://github.com/apache/iceberg/issues/751#issuecomment-578521150","issue_url":"https://api.github.com/repos/apache/iceberg/issues/751","id":578521150,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODUyMTE1MA==","user":{"login":"waterlx","id":13976495,"node_id":"MDQ6VXNlcjEzOTc2NDk1","avatar_url":"https://avatars.githubusercontent.com/u/13976495?v=4","gravatar_id":"","url":"https://api.github.com/users/waterlx","html_url":"https://github.com/waterlx","followers_url":"https://api.github.com/users/waterlx/followers","following_url":"https://api.github.com/users/waterlx/following{/other_user}","gists_url":"https://api.github.com/users/waterlx/gists{/gist_id}","starred_url":"https://api.github.com/users/waterlx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/waterlx/subscriptions","organizations_url":"https://api.github.com/users/waterlx/orgs","repos_url":"https://api.github.com/users/waterlx/repos","events_url":"https://api.github.com/users/waterlx/events{/privacy}","received_events_url":"https://api.github.com/users/waterlx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-26T16:57:14Z","updated_at":"2020-01-26T16:57:14Z","author_association":"CONTRIBUTOR","body":"@rdblue does it make any sense to you?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578521150/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578535708","html_url":"https://github.com/apache/iceberg/pull/708#issuecomment-578535708","issue_url":"https://api.github.com/repos/apache/iceberg/issues/708","id":578535708,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODUzNTcwOA==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-26T19:42:37Z","updated_at":"2020-01-26T19:42:37Z","author_association":"CONTRIBUTOR","body":"@rdblue Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578535708/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578639396","html_url":"https://github.com/apache/iceberg/pull/695#issuecomment-578639396","issue_url":"https://api.github.com/repos/apache/iceberg/issues/695","id":578639396,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODYzOTM5Ng==","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T08:23:45Z","updated_at":"2020-01-27T08:24:00Z","author_association":"CONTRIBUTOR","body":"@rdblue  I'v addressed pending comments and added the `source-snapshot-id` summary property to help with Issue#744 and related tests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578639396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578729882","html_url":"https://github.com/apache/iceberg/pull/754#issuecomment-578729882","issue_url":"https://api.github.com/repos/apache/iceberg/issues/754","id":578729882,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODcyOTg4Mg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T12:43:44Z","updated_at":"2020-01-27T12:43:44Z","author_association":"CONTRIBUTOR","body":"@rdblue @rdsr, could you guys take a look at this PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578729882/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578736827","html_url":"https://github.com/apache/iceberg/pull/752#issuecomment-578736827","issue_url":"https://api.github.com/repos/apache/iceberg/issues/752","id":578736827,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODczNjgyNw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T13:03:48Z","updated_at":"2020-01-27T13:03:48Z","author_association":"CONTRIBUTOR","body":"Thanks, @jun-he!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578736827/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578848020","html_url":"https://github.com/apache/iceberg/pull/754#issuecomment-578848020","issue_url":"https://api.github.com/repos/apache/iceberg/issues/754","id":578848020,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODg0ODAyMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T17:03:47Z","updated_at":"2020-01-27T17:03:47Z","author_association":"CONTRIBUTOR","body":"Looks good to me. Thanks for catching this!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578848020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578848464","html_url":"https://github.com/apache/iceberg/pull/754#issuecomment-578848464","issue_url":"https://api.github.com/repos/apache/iceberg/issues/754","id":578848464,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODg0ODQ2NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T17:04:37Z","updated_at":"2020-01-27T17:04:37Z","author_association":"CONTRIBUTOR","body":"As a follow-up, should we run `testConcurrentFastAppends` on Hadoop tables? Or does that pass with a local file system but fail in HDFS?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578848464/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578849672","html_url":"https://github.com/apache/iceberg/pull/754#issuecomment-578849672","issue_url":"https://api.github.com/repos/apache/iceberg/issues/754","id":578849672,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODg0OTY3Mg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T17:06:59Z","updated_at":"2020-01-27T17:06:59Z","author_association":"CONTRIBUTOR","body":"I believe there is no guarantee that `testConcurrentFastAppends` will succeed as the implementation of renames is platform-dependant. I tested manually `testConcurrentFastAppends` against HDFS and it worked.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578849672/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578872194","html_url":"https://github.com/apache/iceberg/pull/755#issuecomment-578872194","issue_url":"https://api.github.com/repos/apache/iceberg/issues/755","id":578872194,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODg3MjE5NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T17:56:19Z","updated_at":"2020-01-27T17:56:19Z","author_association":"CONTRIBUTOR","body":"Thanks, @aokolnychyi!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578872194/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578874751","html_url":"https://github.com/apache/iceberg/pull/756#issuecomment-578874751","issue_url":"https://api.github.com/repos/apache/iceberg/issues/756","id":578874751,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODg3NDc1MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T18:01:56Z","updated_at":"2020-01-27T18:01:56Z","author_association":"CONTRIBUTOR","body":"I agree, this looks good.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578874751/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578874975","html_url":"https://github.com/apache/iceberg/pull/756#issuecomment-578874975","issue_url":"https://api.github.com/repos/apache/iceberg/issues/756","id":578874975,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODg3NDk3NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T18:02:34Z","updated_at":"2020-01-27T18:02:34Z","author_association":"CONTRIBUTOR","body":"One more thing: should this be documented somewhere?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578874975/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578875422","html_url":"https://github.com/apache/iceberg/pull/743#issuecomment-578875422","issue_url":"https://api.github.com/repos/apache/iceberg/issues/743","id":578875422,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODg3NTQyMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T18:03:33Z","updated_at":"2020-01-27T18:03:33Z","author_association":"CONTRIBUTOR","body":"Thanks for working on this, @yujiantao! Could you fix the test errors? I also had a couple of minor comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578875422/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578877108","html_url":"https://github.com/apache/iceberg/pull/756#issuecomment-578877108","issue_url":"https://api.github.com/repos/apache/iceberg/issues/756","id":578877108,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODg3NzEwOA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T18:07:04Z","updated_at":"2020-01-27T18:07:04Z","author_association":"CONTRIBUTOR","body":"Yeah, I was going to add documentation to our configs in a follow-up PR as we have multiple such configs by now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578877108/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578884144","html_url":"https://github.com/apache/iceberg/pull/735#issuecomment-578884144","issue_url":"https://api.github.com/repos/apache/iceberg/issues/735","id":578884144,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODg4NDE0NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T18:23:03Z","updated_at":"2020-01-27T18:23:03Z","author_association":"CONTRIBUTOR","body":"@rdsr, looks good to me! I'll wait until tests pass and merge it.\r\n\r\nThanks for the quick update!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578884144/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578887785","html_url":"https://github.com/apache/iceberg/issues/744#issuecomment-578887785","issue_url":"https://api.github.com/repos/apache/iceberg/issues/744","id":578887785,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODg4Nzc4NQ==","user":{"login":"mehtaashish23","id":75326,"node_id":"MDQ6VXNlcjc1MzI2","avatar_url":"https://avatars.githubusercontent.com/u/75326?v=4","gravatar_id":"","url":"https://api.github.com/users/mehtaashish23","html_url":"https://github.com/mehtaashish23","followers_url":"https://api.github.com/users/mehtaashish23/followers","following_url":"https://api.github.com/users/mehtaashish23/following{/other_user}","gists_url":"https://api.github.com/users/mehtaashish23/gists{/gist_id}","starred_url":"https://api.github.com/users/mehtaashish23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mehtaashish23/subscriptions","organizations_url":"https://api.github.com/users/mehtaashish23/orgs","repos_url":"https://api.github.com/users/mehtaashish23/repos","events_url":"https://api.github.com/users/mehtaashish23/events{/privacy}","received_events_url":"https://api.github.com/users/mehtaashish23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T18:31:28Z","updated_at":"2020-01-27T18:31:28Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue for explaining. Correct me if I am wrong but, IIUC there is an API [expireSnapshotId here], which can expire any snapshot by id. So my above cases is to handle if someone uses that API to expire snapshot. For example. in your scenario, if someone used this expireSnapshotId then\r\n1) If C is marked expired, then no dataFiles are deleted, since its in some other's `source-snapshot-id`\r\n2) if D is marked expired, then C has to also marked expired. Since if we keep around C, then someone can come back again using this API to expire C, which won't be referred by anyone, as D was already expired before.\r\n\r\nDoes that make sense? For all other API i.e. `expireOlderThan` and `retainLast` I expect that C would be expired before D, and your explanation makes perfect sense in that, and my changes would handle that.\r\n\r\nThere is another API `deleteWith` with a UDF passed in, which I suppose is onus of client to maintain consistency.\r\n\r\n[expireSnapshotId here]: https://github.com/apache/incubator-iceberg/blob/master/api/src/main/java/org/apache/iceberg/ExpireSnapshots.java#L48","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578887785/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578944633","html_url":"https://github.com/apache/iceberg/pull/695#issuecomment-578944633","issue_url":"https://api.github.com/repos/apache/iceberg/issues/695","id":578944633,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODk0NDYzMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T20:46:06Z","updated_at":"2020-01-27T20:46:06Z","author_association":"CONTRIBUTOR","body":"@prodeezy, thanks for the update! I did a deeper review on the commit operations and I found a few things to fix. I opened a PR against the PR branch to help out and get this in quicker: https://github.com/rominparekh/incubator-iceberg/pull/2\r\n\r\nCan you review that?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578944633/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578989012","html_url":"https://github.com/apache/iceberg/issues/733#issuecomment-578989012","issue_url":"https://api.github.com/repos/apache/iceberg/issues/733","id":578989012,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODk4OTAxMg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-27T22:37:11Z","updated_at":"2020-01-27T22:37:11Z","author_association":"CONTRIBUTOR","body":"This was done. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/578989012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579028601","html_url":"https://github.com/apache/iceberg/pull/695#issuecomment-579028601","issue_url":"https://api.github.com/repos/apache/iceberg/issues/695","id":579028601,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTAyODYwMQ==","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-28T00:54:33Z","updated_at":"2020-01-28T00:54:33Z","author_association":"CONTRIBUTOR","body":"Merged rominparekh#2","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579028601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579036098","html_url":"https://github.com/apache/iceberg/pull/695#issuecomment-579036098","issue_url":"https://api.github.com/repos/apache/iceberg/issues/695","id":579036098,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTAzNjA5OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-28T01:25:50Z","updated_at":"2020-01-28T01:25:50Z","author_association":"CONTRIBUTOR","body":"@prodeezy, looks like there are two main causes for test failures, from the ones I looked at. First, https://github.com/apache/incubator-iceberg/pull/695/files#diff-62b86887b9d53434d54feab812bef0abR122 is wrong. It should be this instead:\r\n\r\n```java\r\n    ValidationException.check(\r\n        isCurrentAncestor(current, snapshotId),\r\n        \"Cannot roll back to snapshot, not an ancestor of the current state: %s\", snapshotId);\r\n```\r\n\r\nThe second problem is that this will now automatically fast-forward when possible instead of creating new cherry-pick snapshots. That means we have fewer than expected snapshots in some tests. Can you update the tests?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579036098/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579394142","html_url":"https://github.com/apache/iceberg/issues/744#issuecomment-579394142","issue_url":"https://api.github.com/repos/apache/iceberg/issues/744","id":579394142,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTM5NDE0Mg==","user":{"login":"mehtaashish23","id":75326,"node_id":"MDQ6VXNlcjc1MzI2","avatar_url":"https://avatars.githubusercontent.com/u/75326?v=4","gravatar_id":"","url":"https://api.github.com/users/mehtaashish23","html_url":"https://github.com/mehtaashish23","followers_url":"https://api.github.com/users/mehtaashish23/followers","following_url":"https://api.github.com/users/mehtaashish23/following{/other_user}","gists_url":"https://api.github.com/users/mehtaashish23/gists{/gist_id}","starred_url":"https://api.github.com/users/mehtaashish23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mehtaashish23/subscriptions","organizations_url":"https://api.github.com/users/mehtaashish23/orgs","repos_url":"https://api.github.com/users/mehtaashish23/repos","events_url":"https://api.github.com/users/mehtaashish23/events{/privacy}","received_events_url":"https://api.github.com/users/mehtaashish23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-28T18:40:12Z","updated_at":"2020-01-28T18:40:12Z","author_association":"CONTRIBUTOR","body":"Raised PR https://github.com/rominparekh/incubator-iceberg/pull/3 on top of feature being currently build out by @prodeezy , @rominparekh ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579394142/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579402629","html_url":"https://github.com/apache/iceberg/issues/758#issuecomment-579402629","issue_url":"https://api.github.com/repos/apache/iceberg/issues/758","id":579402629,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTQwMjYyOQ==","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-28T19:00:28Z","updated_at":"2020-01-28T19:00:28Z","author_association":"CONTRIBUTOR","body":"For more context: The file system we use doesn't provide atomicity garuntees on file rename. So when version-hint.txt is being re-written by writers, readers or other concurrent writers could see an empty version-hint file and fail with above error. To get around this the writer and readers have to retry outside of iceberg. We feel, Iceberg should be resilient on this and refresh table state and retry commit. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579402629/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579408457","html_url":"https://github.com/apache/iceberg/issues/758#issuecomment-579408457","issue_url":"https://api.github.com/repos/apache/iceberg/issues/758","id":579408457,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTQwODQ1Nw==","user":{"login":"rominparekh","id":3831468,"node_id":"MDQ6VXNlcjM4MzE0Njg=","avatar_url":"https://avatars.githubusercontent.com/u/3831468?v=4","gravatar_id":"","url":"https://api.github.com/users/rominparekh","html_url":"https://github.com/rominparekh","followers_url":"https://api.github.com/users/rominparekh/followers","following_url":"https://api.github.com/users/rominparekh/following{/other_user}","gists_url":"https://api.github.com/users/rominparekh/gists{/gist_id}","starred_url":"https://api.github.com/users/rominparekh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rominparekh/subscriptions","organizations_url":"https://api.github.com/users/rominparekh/orgs","repos_url":"https://api.github.com/users/rominparekh/repos","events_url":"https://api.github.com/users/rominparekh/events{/privacy}","received_events_url":"https://api.github.com/users/rominparekh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-28T19:14:08Z","updated_at":"2020-01-28T19:14:08Z","author_association":"CONTRIBUTOR","body":"We use ADLS file system that does not share atomic guarantees with when `overwrite = TRUE`. Here's the documentation - https://hadoop.apache.org/docs/current3/api/org/apache/hadoop/fs/adl/AdlFileSystem.html#rename-org.apache.hadoop.fs.Path-org.apache.hadoop.fs.Path-org.apache.hadoop.fs.Options.Rename...-\r\n\r\nThis is where atomic guarantees are not honored - https://github.com/apache/incubator-iceberg/blob/master/core/src/main/java/org/apache/iceberg/hadoop/HadoopTableOperations.java#L220\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579408457/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579467610","html_url":"https://github.com/apache/iceberg/issues/758#issuecomment-579467610","issue_url":"https://api.github.com/repos/apache/iceberg/issues/758","id":579467610,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTQ2NzYxMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-28T21:35:45Z","updated_at":"2020-01-28T21:35:45Z","author_association":"CONTRIBUTOR","body":"A retry framework may help you avoid problems like this one, but it does not fundamentally change the fact that using Hadoop tables on a file system without atomic rename is not safe.\r\n\r\nThe recommended solution when using a file system without atomic rename is to use a metastore catalog, like we have available in the Hive integration.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579467610/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579504298","html_url":"https://github.com/apache/iceberg/issues/744#issuecomment-579504298","issue_url":"https://api.github.com/repos/apache/iceberg/issues/744","id":579504298,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTUwNDI5OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-28T22:49:15Z","updated_at":"2020-01-28T22:53:24Z","author_association":"CONTRIBUTOR","body":"@mehtaashish23, you're right about the need to find a fix given that snapshots can be specifically expired. I'm thinking about it and will update here when I have a clearer picture of what we need to do in my head. I at least agree with your point 1, but I'm not sure that point 2 is sufficient.\r\n\r\nPart of the problem is that we need to handle expiration differently depending on the current table state at the point when the last snapshots with the same changes expires. That's because that is the last time at which the changes _could_ be used by the current table state. If the current table state contains the changes, then the deleted files should be deleted and the added files should be retained. If it doesn't contain the changes, then the added files should be removed (nothing else should reference them) and the deleted files should be left.\r\n\r\nThis gets more complicated when we consider branches of snapshots (not just a single WAP snapshot) or expiration that breaks the chain of ancestors from the current table state.\r\n\r\nOne thing I think we need to do is to add a rule that expiring any ancestor of the current state also expires the rest of the ancestors, possibly even all older snapshots.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579504298/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579541487","html_url":"https://github.com/apache/iceberg/pull/695#issuecomment-579541487","issue_url":"https://api.github.com/repos/apache/iceberg/issues/695","id":579541487,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTU0MTQ4Nw==","user":{"login":"rominparekh","id":3831468,"node_id":"MDQ6VXNlcjM4MzE0Njg=","avatar_url":"https://avatars.githubusercontent.com/u/3831468?v=4","gravatar_id":"","url":"https://api.github.com/users/rominparekh","html_url":"https://github.com/rominparekh","followers_url":"https://api.github.com/users/rominparekh/followers","following_url":"https://api.github.com/users/rominparekh/following{/other_user}","gists_url":"https://api.github.com/users/rominparekh/gists{/gist_id}","starred_url":"https://api.github.com/users/rominparekh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rominparekh/subscriptions","organizations_url":"https://api.github.com/users/rominparekh/orgs","repos_url":"https://api.github.com/users/rominparekh/repos","events_url":"https://api.github.com/users/rominparekh/events{/privacy}","received_events_url":"https://api.github.com/users/rominparekh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-29T00:43:05Z","updated_at":"2020-01-29T00:43:05Z","author_association":"CONTRIBUTOR","body":"@rdblue : I have updated the WAP workflows failing tests but there are two existing tests which seem to fail with the recent change on fast-forwarding snapshots. \r\n\r\n```scala\r\norg.apache.iceberg.spark.source.TestIcebergSourceHadoopTables > testHistoryTable FAILED\r\n    org.apache.iceberg.exceptions.CommitFailedException at TestIcebergSourceHadoopTables.java:246\r\n\r\norg.apache.iceberg.spark.source.TestIcebergSourceHadoopTables > testSnapshotsTable FAILED\r\n    org.apache.iceberg.exceptions.CommitFailedException at TestIcebergSourceHadoopTables.java:318\r\n``` \r\n\r\ncc: @prodeezy ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579541487/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579549774","html_url":"https://github.com/apache/iceberg/pull/695#issuecomment-579549774","issue_url":"https://api.github.com/repos/apache/iceberg/issues/695","id":579549774,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTU0OTc3NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-29T01:20:27Z","updated_at":"2020-01-29T01:20:27Z","author_association":"CONTRIBUTOR","body":"Thanks @rominparekh! I'll take a look at those tests. I really appreciate you fixing the others!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579549774/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579568104","html_url":"https://github.com/apache/iceberg/pull/199#issuecomment-579568104","issue_url":"https://api.github.com/repos/apache/iceberg/issues/199","id":579568104,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTU2ODEwNA==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-29T02:48:15Z","updated_at":"2020-01-29T02:48:15Z","author_association":"CONTRIBUTOR","body":"@edgarRd what's remaining in this module? Something we can help with?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579568104/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579801821","html_url":"https://github.com/apache/iceberg/issues/760#issuecomment-579801821","issue_url":"https://api.github.com/repos/apache/iceberg/issues/760","id":579801821,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTgwMTgyMQ==","user":{"login":"arina-ielchiieva","id":15086720,"node_id":"MDQ6VXNlcjE1MDg2NzIw","avatar_url":"https://avatars.githubusercontent.com/u/15086720?v=4","gravatar_id":"","url":"https://api.github.com/users/arina-ielchiieva","html_url":"https://github.com/arina-ielchiieva","followers_url":"https://api.github.com/users/arina-ielchiieva/followers","following_url":"https://api.github.com/users/arina-ielchiieva/following{/other_user}","gists_url":"https://api.github.com/users/arina-ielchiieva/gists{/gist_id}","starred_url":"https://api.github.com/users/arina-ielchiieva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arina-ielchiieva/subscriptions","organizations_url":"https://api.github.com/users/arina-ielchiieva/orgs","repos_url":"https://api.github.com/users/arina-ielchiieva/repos","events_url":"https://api.github.com/users/arina-ielchiieva/events{/privacy}","received_events_url":"https://api.github.com/users/arina-ielchiieva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-29T15:15:18Z","updated_at":"2020-01-29T15:15:18Z","author_association":"MEMBER","body":"FYI @jun-he ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579801821/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579839269","html_url":"https://github.com/apache/iceberg/pull/199#issuecomment-579839269","issue_url":"https://api.github.com/repos/apache/iceberg/issues/199","id":579839269,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTgzOTI2OQ==","user":{"login":"edgarRd","id":266670,"node_id":"MDQ6VXNlcjI2NjY3MA==","avatar_url":"https://avatars.githubusercontent.com/u/266670?v=4","gravatar_id":"","url":"https://api.github.com/users/edgarRd","html_url":"https://github.com/edgarRd","followers_url":"https://api.github.com/users/edgarRd/followers","following_url":"https://api.github.com/users/edgarRd/following{/other_user}","gists_url":"https://api.github.com/users/edgarRd/gists{/gist_id}","starred_url":"https://api.github.com/users/edgarRd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edgarRd/subscriptions","organizations_url":"https://api.github.com/users/edgarRd/orgs","repos_url":"https://api.github.com/users/edgarRd/repos","events_url":"https://api.github.com/users/edgarRd/events{/privacy}","received_events_url":"https://api.github.com/users/edgarRd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-29T16:24:38Z","updated_at":"2020-01-29T16:24:38Z","author_association":"CONTRIBUTOR","body":"Thanks for the follow up on this, @rdsr. I'm finishing the tests for this PR with the recently added column mapping changes. I'll push as soon as I get those working.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579839269/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579856168","html_url":"https://github.com/apache/iceberg/pull/199#issuecomment-579856168","issue_url":"https://api.github.com/repos/apache/iceberg/issues/199","id":579856168,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTg1NjE2OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-29T16:59:38Z","updated_at":"2020-01-29T16:59:38Z","author_association":"CONTRIBUTOR","body":"Thanks, @edgarRd! I'm looking forward to getting this working for the 0.8.0 release!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579856168/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579859948","html_url":"https://github.com/apache/iceberg/pull/750#issuecomment-579859948","issue_url":"https://api.github.com/repos/apache/iceberg/issues/750","id":579859948,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTg1OTk0OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-29T17:07:54Z","updated_at":"2020-01-29T17:07:54Z","author_association":"CONTRIBUTOR","body":"+1\r\n\r\nThanks for fixing this, @maqroll! Also, nice job fixing the review points. It is really helpful when you fix all of the instances of something (e.g. usage of `this.`) without needing to point out each one individually. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579859948/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579903297","html_url":"https://github.com/apache/iceberg/issues/758#issuecomment-579903297","issue_url":"https://api.github.com/repos/apache/iceberg/issues/758","id":579903297,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTkwMzI5Nw==","user":{"login":"mehtaashish23","id":75326,"node_id":"MDQ6VXNlcjc1MzI2","avatar_url":"https://avatars.githubusercontent.com/u/75326?v=4","gravatar_id":"","url":"https://api.github.com/users/mehtaashish23","html_url":"https://github.com/mehtaashish23","followers_url":"https://api.github.com/users/mehtaashish23/followers","following_url":"https://api.github.com/users/mehtaashish23/following{/other_user}","gists_url":"https://api.github.com/users/mehtaashish23/gists{/gist_id}","starred_url":"https://api.github.com/users/mehtaashish23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mehtaashish23/subscriptions","organizations_url":"https://api.github.com/users/mehtaashish23/orgs","repos_url":"https://api.github.com/users/mehtaashish23/repos","events_url":"https://api.github.com/users/mehtaashish23/events{/privacy}","received_events_url":"https://api.github.com/users/mehtaashish23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-29T18:48:59Z","updated_at":"2020-01-29T18:48:59Z","author_association":"CONTRIBUTOR","body":"Guys, correct me if I am wrong, I feel this doesn't look like problem with rename guarantee, its about guarantees while reading the `version-hint.text` file during read time operation (according to above stack trace) in a environment where there are many writers trying to update the table, in sequence or parallel. \r\n\r\nIIUC after doing the `rename` from `GUID.metadata.json` to `version.metadata.json`, we try to use `create with overwrite` [here] to update the version-hint.text with the current version number. The behavior of this API, is to update the content of this file in place, and during that time, if someone is reading this file might see different behavior, based on underlying filesystem guarantees i.e the file doesn't exist, or the data in the file is momentarily empty etc. \r\n\r\nI suppose, we would need retries in read path of versionHint. *Also* if above is true, then we need better documentation, around guarantees we expect w.r.t `create with overwrite` from underlying filesystem.\r\n\r\n[here]: https://github.com/apache/incubator-iceberg/blob/master/core/src/main/java/org/apache/iceberg/hadoop/HadoopTableOperations.java#L220","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/579903297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/580017618","html_url":"https://github.com/apache/iceberg/issues/758#issuecomment-580017618","issue_url":"https://api.github.com/repos/apache/iceberg/issues/758","id":580017618,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDAxNzYxOA==","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-29T23:49:00Z","updated_at":"2020-01-30T00:31:48Z","author_association":"CONTRIBUTOR","body":"@mehtaashish23  Right , the `create(path, overwrite=true)` not being atomic in ADLS is the real issue and a retry framework can help alleviate this (which we have added in to our writer/reader wrappers) but as Ryan said a retry framework won't fix things for us. Coz when adls deleted the `version_hint.txt` (while overwriting).. readers and other writers can fail with NPE or NoSuchTable errors (as illustrated in this issue's original description). \r\n\r\nOverall, We need a way to build an atomic commit. In this regard, I am currently looking into building an atomic commit operation by extending `BaseMetastoreTableOperations` ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/580017618/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/580310628","html_url":"https://github.com/apache/iceberg/pull/588#issuecomment-580310628","issue_url":"https://api.github.com/repos/apache/iceberg/issues/588","id":580310628,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDMxMDYyOA==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-30T15:36:30Z","updated_at":"2020-01-30T15:36:30Z","author_association":"COLLABORATOR","body":"@aokolnychyi, @rdblue , I updated the code with the basic inheritance feature. Could you please help to have a look? Will rebase later.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/580310628/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/580545535","html_url":"https://github.com/apache/iceberg/pull/675#issuecomment-580545535","issue_url":"https://api.github.com/repos/apache/iceberg/issues/675","id":580545535,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDU0NTUzNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-31T01:49:20Z","updated_at":"2020-01-31T01:49:20Z","author_association":"CONTRIBUTOR","body":"+1\r\n\r\nI had a few minor comments and I'd like to change the property name, but I think that this is ready to go overall. @aokolnychyi, can you make the property name change and merge?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/580545535/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/580745688","html_url":"https://github.com/apache/iceberg/pull/675#issuecomment-580745688","issue_url":"https://api.github.com/repos/apache/iceberg/issues/675","id":580745688,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDc0NTY4OA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-31T14:03:58Z","updated_at":"2020-01-31T14:03:58Z","author_association":"CONTRIBUTOR","body":"I resolved the remaining comments. I'll do some additional testing. If everything is fine, I'll merge it.\r\n\r\nLet me know if there are any other comments in the meantime.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/580745688/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/580868135","html_url":"https://github.com/apache/iceberg/pull/315#issuecomment-580868135","issue_url":"https://api.github.com/repos/apache/iceberg/issues/315","id":580868135,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDg2ODEzNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-31T19:06:02Z","updated_at":"2020-01-31T19:06:02Z","author_association":"CONTRIBUTOR","body":"@rdsr, only minor things left! Thanks for all your work on this, it's really coming together nicely.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/580868135/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581005830","html_url":"https://github.com/apache/iceberg/pull/315#issuecomment-581005830","issue_url":"https://api.github.com/repos/apache/iceberg/issues/315","id":581005830,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTAwNTgzMA==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-01T07:58:59Z","updated_at":"2020-02-01T07:58:59Z","author_association":"CONTRIBUTOR","body":"One of the commits in the PR was not cleanly applying. I had to squash all commits to a single commit and fix diff issues. This has resulted in a single commit for the PR.  Sorry about that as it may get hard to review the new changes","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581005830/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581009185","html_url":"https://github.com/apache/iceberg/issues/760#issuecomment-581009185","issue_url":"https://api.github.com/repos/apache/iceberg/issues/760","id":581009185,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTAwOTE4NQ==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-01T08:50:05Z","updated_at":"2020-02-01T08:50:05Z","author_association":"COLLABORATOR","body":"Thanks @arina-ielchiieva. \r\nI will add them to `ResidualVisitor` and double check other visitors.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581009185/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581109895","html_url":"https://github.com/apache/iceberg/pull/743#issuecomment-581109895","issue_url":"https://api.github.com/repos/apache/iceberg/issues/743","id":581109895,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTEwOTg5NQ==","user":{"login":"yujiantao","id":30738525,"node_id":"MDQ6VXNlcjMwNzM4NTI1","avatar_url":"https://avatars.githubusercontent.com/u/30738525?v=4","gravatar_id":"","url":"https://api.github.com/users/yujiantao","html_url":"https://github.com/yujiantao","followers_url":"https://api.github.com/users/yujiantao/followers","following_url":"https://api.github.com/users/yujiantao/following{/other_user}","gists_url":"https://api.github.com/users/yujiantao/gists{/gist_id}","starred_url":"https://api.github.com/users/yujiantao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yujiantao/subscriptions","organizations_url":"https://api.github.com/users/yujiantao/orgs","repos_url":"https://api.github.com/users/yujiantao/repos","events_url":"https://api.github.com/users/yujiantao/events{/privacy}","received_events_url":"https://api.github.com/users/yujiantao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-02T08:11:42Z","updated_at":"2020-02-02T08:11:42Z","author_association":"NONE","body":"@rdblue Sorry for late reply as I was on a long vocation. I have refreshed the commit.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581109895/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581180942","html_url":"https://github.com/apache/iceberg/issues/760#issuecomment-581180942","issue_url":"https://api.github.com/repos/apache/iceberg/issues/760","id":581180942,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTE4MDk0Mg==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-02T21:46:04Z","updated_at":"2020-02-02T21:46:04Z","author_association":"COLLABORATOR","body":"@arina-ielchiieva I have submitted a PR to address this issue. Thanks.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581180942/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581182311","html_url":"https://github.com/apache/iceberg/pull/315#issuecomment-581182311","issue_url":"https://api.github.com/repos/apache/iceberg/issues/315","id":581182311,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTE4MjMxMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-02T22:02:18Z","updated_at":"2020-02-02T22:02:18Z","author_association":"CONTRIBUTOR","body":"@rdsr, I'm merging this. Thanks for all your work on it!\r\n\r\nI think we do need to follow up pretty quickly with better validations for snapshot IDs passed to appendsBetween and appendsAfter. Right now, I don't think there is anything that validates that there is a range of snapshots from the start to the end -- it looks like this would use the whole ancestry of the \"to\" snapshot if \"from\" isn't an ancestor. Let's clean that up with validations, but for now I've committed this since it quite a large patch.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581182311/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581183783","html_url":"https://github.com/apache/iceberg/pull/743#issuecomment-581183783","issue_url":"https://api.github.com/repos/apache/iceberg/issues/743","id":581183783,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTE4Mzc4Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-02T22:19:01Z","updated_at":"2020-02-02T22:19:01Z","author_association":"CONTRIBUTOR","body":"Thanks @yujiantao! I caught a couple more minor things. Once those are done, we should be good to merge.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581183783/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581183953","html_url":"https://github.com/apache/iceberg/issues/764#issuecomment-581183953","issue_url":"https://api.github.com/repos/apache/iceberg/issues/764","id":581183953,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTE4Mzk1Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-02T22:21:08Z","updated_at":"2020-02-03T01:23:25Z","author_association":"CONTRIBUTOR","body":"I don't think that this necessarily needs to be public. It's an internal implementation that is not part of the public API. What are you trying to do? Can you pass a `StructLike` instead? The Iceberg generic records in org.apache.iceberg.data can be passed, so you can build a tuple of data using the generic record.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581183953/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581184156","html_url":"https://github.com/apache/iceberg/issues/761#issuecomment-581184156","issue_url":"https://api.github.com/repos/apache/iceberg/issues/761","id":581184156,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTE4NDE1Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-02T22:23:27Z","updated_at":"2020-02-02T22:23:27Z","author_association":"CONTRIBUTOR","body":"Hadoop tables cannot be used with a file system that doesn't support atomic rename. They should only be used with HDFS or a local FS, not with S3. For S3, you should be using a metastore, like Hive.\r\n\r\nYou're right that IcebergGenerics is the recommended way to read a table directly, without using an engine like Spark or Presto.\r\n\r\nIf you want to write up some documentation, that would be great! Please open a PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581184156/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581184344","html_url":"https://github.com/apache/iceberg/issues/751#issuecomment-581184344","issue_url":"https://api.github.com/repos/apache/iceberg/issues/751","id":581184344,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTE4NDM0NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-02T22:25:56Z","updated_at":"2020-02-02T22:25:56Z","author_association":"CONTRIBUTOR","body":"I think you're saying you want a purge option that deletes metadata, but not data?\r\n\r\nI'm very reluctant to add cases like this to the API. We want to keep the API small, and I think this may be specific to your use case. What about doing this in the application that creates the staging tables instead? You'd set purge=false when dropping the table and then clean up the metadata using your own code. Would that work?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581184344/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581215477","html_url":"https://github.com/apache/iceberg/issues/213#issuecomment-581215477","issue_url":"https://api.github.com/repos/apache/iceberg/issues/213","id":581215477,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTIxNTQ3Nw==","user":{"login":"edgarRd","id":266670,"node_id":"MDQ6VXNlcjI2NjY3MA==","avatar_url":"https://avatars.githubusercontent.com/u/266670?v=4","gravatar_id":"","url":"https://api.github.com/users/edgarRd","html_url":"https://github.com/edgarRd","followers_url":"https://api.github.com/users/edgarRd/followers","following_url":"https://api.github.com/users/edgarRd/following{/other_user}","gists_url":"https://api.github.com/users/edgarRd/gists{/gist_id}","starred_url":"https://api.github.com/users/edgarRd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edgarRd/subscriptions","organizations_url":"https://api.github.com/users/edgarRd/orgs","repos_url":"https://api.github.com/users/edgarRd/repos","events_url":"https://api.github.com/users/edgarRd/events{/privacy}","received_events_url":"https://api.github.com/users/edgarRd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-03T02:49:32Z","updated_at":"2020-02-03T02:49:32Z","author_association":"CONTRIBUTOR","body":"Closing this issue since it was fixed in #227 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581215477/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581219056","html_url":"https://github.com/apache/iceberg/pull/768#issuecomment-581219056","issue_url":"https://api.github.com/repos/apache/iceberg/issues/768","id":581219056,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTIxOTA1Ng==","user":{"login":"edgarRd","id":266670,"node_id":"MDQ6VXNlcjI2NjY3MA==","avatar_url":"https://avatars.githubusercontent.com/u/266670?v=4","gravatar_id":"","url":"https://api.github.com/users/edgarRd","html_url":"https://github.com/edgarRd","followers_url":"https://api.github.com/users/edgarRd/followers","following_url":"https://api.github.com/users/edgarRd/following{/other_user}","gists_url":"https://api.github.com/users/edgarRd/gists{/gist_id}","starred_url":"https://api.github.com/users/edgarRd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edgarRd/subscriptions","organizations_url":"https://api.github.com/users/edgarRd/orgs","repos_url":"https://api.github.com/users/edgarRd/repos","events_url":"https://api.github.com/users/edgarRd/events{/privacy}","received_events_url":"https://api.github.com/users/edgarRd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-03T03:12:58Z","updated_at":"2020-02-03T03:12:58Z","author_association":"CONTRIBUTOR","body":"PTAL @rdsr @rdblue  - Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581219056/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581282605","html_url":"https://github.com/apache/iceberg/pull/743#issuecomment-581282605","issue_url":"https://api.github.com/repos/apache/iceberg/issues/743","id":581282605,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTI4MjYwNQ==","user":{"login":"jerryshao","id":850797,"node_id":"MDQ6VXNlcjg1MDc5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/850797?v=4","gravatar_id":"","url":"https://api.github.com/users/jerryshao","html_url":"https://github.com/jerryshao","followers_url":"https://api.github.com/users/jerryshao/followers","following_url":"https://api.github.com/users/jerryshao/following{/other_user}","gists_url":"https://api.github.com/users/jerryshao/gists{/gist_id}","starred_url":"https://api.github.com/users/jerryshao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerryshao/subscriptions","organizations_url":"https://api.github.com/users/jerryshao/orgs","repos_url":"https://api.github.com/users/jerryshao/repos","events_url":"https://api.github.com/users/jerryshao/events{/privacy}","received_events_url":"https://api.github.com/users/jerryshao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-03T07:54:59Z","updated_at":"2020-02-03T07:54:59Z","author_association":"CONTRIBUTOR","body":"LGTM.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/581282605/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]